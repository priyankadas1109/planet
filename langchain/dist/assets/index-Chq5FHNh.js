const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/loadCognitoIdentity-CPSMfMXJ.js","assets/index-C7fojxHO.js","assets/loadSts-DoxBImBQ.js","assets/index-DnPHkz8b.js"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(i){if(i.ep)return;i.ep=!0;const a=r(i);fetch(i.href,a)}})();const f$="1jQTlXWom-pXvyP9zuTcbdluyvpb43hu2h7anxhF5qlQ",h$="A2:J",p$="AIzaSyC211F_ub1nAGr2Xv-wJGeulMg4nPzG1yE",Pj=`
  You are an expert assistant answering questions related to the data pulled from a GitHub repository.
  Use the following context to answer the query:

  Context:
  {context}

  Query:
  {query}

  Provide a detailed, accurate response based on the context provided.
  If you're unsure about something, please say so.
  If the question is unrelated to the context, please say that the question is unrelated or something
  along the lines of that
  
  Answer:
`,f4=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-8][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/i;function oc(t){return typeof t=="string"&&f4.test(t)}var Zt=[];for(var Hv=0;Hv<256;++Hv)Zt.push((Hv+256).toString(16).slice(1));function h4(t,e=0){return(Zt[t[e+0]]+Zt[t[e+1]]+Zt[t[e+2]]+Zt[t[e+3]]+"-"+Zt[t[e+4]]+Zt[t[e+5]]+"-"+Zt[t[e+6]]+Zt[t[e+7]]+"-"+Zt[t[e+8]]+Zt[t[e+9]]+"-"+Zt[t[e+10]]+Zt[t[e+11]]+Zt[t[e+12]]+Zt[t[e+13]]+Zt[t[e+14]]+Zt[t[e+15]]).toLowerCase()}var vp,p4=new Uint8Array(16);function _4(){if(!vp&&(vp=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!vp))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return vp(p4)}var y4=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);const jj={randomUUID:y4};function lr(t,e,r){if(jj.randomUUID&&!t)return jj.randomUUID();t=t||{};var n=t.random||(t.rng||_4)();return n[6]=n[6]&15|64,n[8]=n[8]&63|128,h4(n)}var u=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function VS(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function jo(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var r=function n(){return this instanceof n?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(n){var i=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(r,n,i.get?i:{enumerable:!0,get:function(){return t[n]}})}),r}var b4=function(t,e){if(typeof t!="string")throw new TypeError("Expected a string");return e=typeof e>"u"?"_":e,t.replace(/([a-z\d])([A-Z])/g,"$1"+e+"$2").replace(/([A-Z]+)([A-Z][a-z\d]+)/g,"$1"+e+"$2").toLowerCase()};const g4=VS(b4);var _$={exports:{}};const m4=/[\p{Lu}]/u,v4=/[\p{Ll}]/u,Cj=/^[\p{Lu}](?![\p{Lu}])/gu,y$=/([\p{Alpha}\p{N}_]|$)/u,b$=/[_.\- ]+/,w4=new RegExp("^"+b$.source),Mj=new RegExp(b$.source+y$.source,"gu"),Tj=new RegExp("\\d+"+y$.source,"gu"),O4=(t,e,r)=>{let n=!1,i=!1,a=!1;for(let o=0;o<t.length;o++){const s=t[o];n&&m4.test(s)?(t=t.slice(0,o)+"-"+t.slice(o),n=!1,a=i,i=!0,o++):i&&a&&v4.test(s)?(t=t.slice(0,o-1)+"-"+t.slice(o-1),a=i,i=!1,n=!0):(n=e(s)===s&&r(s)!==s,a=i,i=r(s)===s&&e(s)!==s)}return t},S4=(t,e)=>(Cj.lastIndex=0,t.replace(Cj,r=>e(r))),E4=(t,e)=>(Mj.lastIndex=0,Tj.lastIndex=0,t.replace(Mj,(r,n)=>e(n)).replace(Tj,r=>e(r))),g$=(t,e)=>{if(!(typeof t=="string"||Array.isArray(t)))throw new TypeError("Expected the input to be `string | string[]`");if(e={pascalCase:!1,preserveConsecutiveUppercase:!1,...e},Array.isArray(t)?t=t.map(a=>a.trim()).filter(a=>a.length).join("-"):t=t.trim(),t.length===0)return"";const r=e.locale===!1?a=>a.toLowerCase():a=>a.toLocaleLowerCase(e.locale),n=e.locale===!1?a=>a.toUpperCase():a=>a.toLocaleUpperCase(e.locale);return t.length===1?e.pascalCase?n(t):r(t):(t!==r(t)&&(t=O4(t,r,n)),t=t.replace(w4,""),e.preserveConsecutiveUppercase?t=S4(t,r):t=r(t),e.pascalCase&&(t=n(t.charAt(0))+t.slice(1)),E4(t,n))};_$.exports=g$;_$.exports.default=g$;function P4(t,e){return e?.[t]||g4(t)}function j4(t,e,r){const n={};for(const i in t)Object.hasOwn(t,i)&&(n[e(i,r)]=t[i]);return n}function Rj(t){return Array.isArray(t)?[...t]:{...t}}function C4(t,e){const r=Rj(t);for(const[n,i]of Object.entries(e)){const[a,...o]=n.split(".").reverse();let s=r;for(const l of o.reverse()){if(s[l]===void 0)break;s[l]=Rj(s[l]),s=s[l]}s[a]!==void 0&&(s[a]={lc:1,type:"secret",id:[i]})}return r}function m$(t){const e=Object.getPrototypeOf(t);return typeof t.lc_name=="function"&&(typeof e.lc_name!="function"||t.lc_name()!==e.lc_name())?t.lc_name():t.name}class Ea{static lc_name(){return this.name}get lc_id(){return[...this.lc_namespace,m$(this.constructor)]}get lc_secrets(){}get lc_attributes(){}get lc_aliases(){}get lc_serializable_keys(){}constructor(e,...r){Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.lc_serializable_keys!==void 0?this.lc_kwargs=Object.fromEntries(Object.entries(e||{}).filter(([n])=>this.lc_serializable_keys?.includes(n))):this.lc_kwargs=e??{}}toJSON(){if(!this.lc_serializable)return this.toJSONNotImplemented();if(this.lc_kwargs instanceof Ea||typeof this.lc_kwargs!="object"||Array.isArray(this.lc_kwargs))return this.toJSONNotImplemented();const e={},r={},n=Object.keys(this.lc_kwargs).reduce((i,a)=>(i[a]=a in this?this[a]:this.lc_kwargs[a],i),{});for(let i=Object.getPrototypeOf(this);i;i=Object.getPrototypeOf(i))Object.assign(e,Reflect.get(i,"lc_aliases",this)),Object.assign(r,Reflect.get(i,"lc_secrets",this)),Object.assign(n,Reflect.get(i,"lc_attributes",this));return Object.keys(r).forEach(i=>{let a=this,o=n;const[s,...l]=i.split(".").reverse();for(const c of l.reverse()){if(!(c in a)||a[c]===void 0)return;(!(c in o)||o[c]===void 0)&&(typeof a[c]=="object"&&a[c]!=null?o[c]={}:Array.isArray(a[c])&&(o[c]=[])),a=a[c],o=o[c]}s in a&&a[s]!==void 0&&(o[s]=o[s]||a[s])}),{lc:1,type:"constructor",id:this.lc_id,kwargs:j4(Object.keys(r).length?C4(n,r):n,P4,e)}}toJSONNotImplemented(){return{lc:1,type:"not_implemented",id:this.lc_id}}}var M4={};const T4=()=>typeof window<"u"&&typeof window.document<"u",R4=()=>typeof globalThis=="object"&&globalThis.constructor&&globalThis.constructor.name==="DedicatedWorkerGlobalScope",A4=()=>typeof window<"u"&&window.name==="nodejs"||typeof navigator<"u"&&(navigator.userAgent.includes("Node.js")||navigator.userAgent.includes("jsdom")),kS=()=>typeof Deno<"u",$4=()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"&&!kS(),I4=()=>{let t;return T4()?t="browser":$4()?t="node":R4()?t="webworker":A4()?t="jsdom":kS()?t="deno":t="other",t};let qv;async function x4(){return qv===void 0&&(qv={library:"langchain-js",runtime:I4()}),qv}function Ye(t){try{return typeof process<"u"?M4?.[t]:kS()?Deno?.env.get(t):void 0}catch{return}}class D4{}function v$(t){return"lc_prefer_streaming"in t&&t.lc_prefer_streaming}class Wc extends D4{get lc_namespace(){return["langchain_core","callbacks",this.name]}get lc_secrets(){}get lc_attributes(){}get lc_aliases(){}get lc_serializable_keys(){}static lc_name(){return this.name}get lc_id(){return[...this.lc_namespace,m$(this.constructor)]}constructor(e){super(),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"ignoreLLM",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreChain",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreAgent",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreRetriever",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreCustomEvent",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"raiseError",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"awaitHandlers",{enumerable:!0,configurable:!0,writable:!0,value:Ye("LANGCHAIN_CALLBACKS_BACKGROUND")==="false"}),this.lc_kwargs=e||{},e&&(this.ignoreLLM=e.ignoreLLM??this.ignoreLLM,this.ignoreChain=e.ignoreChain??this.ignoreChain,this.ignoreAgent=e.ignoreAgent??this.ignoreAgent,this.ignoreRetriever=e.ignoreRetriever??this.ignoreRetriever,this.ignoreCustomEvent=e.ignoreCustomEvent??this.ignoreCustomEvent,this.raiseError=e.raiseError??this.raiseError,this.awaitHandlers=this.raiseError||(e._awaitHandler??this.awaitHandlers))}copy(){return new this.constructor(this)}toJSON(){return Ea.prototype.toJSON.call(this)}toJSONNotImplemented(){return Ea.prototype.toJSONNotImplemented.call(this)}static fromMethods(e){class r extends Wc{constructor(){super(),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:lr()}),Object.assign(this,e)}}return new r}}const N4=t=>{const e=t;return e!==void 0&&typeof e.copy=="function"&&typeof e.name=="string"&&typeof e.awaitHandlers=="boolean"};var HS={exports:{}};HS.exports;(function(t){const r=(a=0)=>o=>`\x1B[${38+a};5;${o}m`,n=(a=0)=>(o,s,l)=>`\x1B[${38+a};2;${o};${s};${l}m`;function i(){const a=new Map,o={modifier:{reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],overline:[53,55],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},color:{black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],blackBright:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39]},bgColor:{bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgBlackBright:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]}};o.color.gray=o.color.blackBright,o.bgColor.bgGray=o.bgColor.bgBlackBright,o.color.grey=o.color.blackBright,o.bgColor.bgGrey=o.bgColor.bgBlackBright;for(const[s,l]of Object.entries(o)){for(const[c,d]of Object.entries(l))o[c]={open:`\x1B[${d[0]}m`,close:`\x1B[${d[1]}m`},l[c]=o[c],a.set(d[0],d[1]);Object.defineProperty(o,s,{value:l,enumerable:!1})}return Object.defineProperty(o,"codes",{value:a,enumerable:!1}),o.color.close="\x1B[39m",o.bgColor.close="\x1B[49m",o.color.ansi256=r(),o.color.ansi16m=n(),o.bgColor.ansi256=r(10),o.bgColor.ansi16m=n(10),Object.defineProperties(o,{rgbToAnsi256:{value:(s,l,c)=>s===l&&l===c?s<8?16:s>248?231:Math.round((s-8)/247*24)+232:16+36*Math.round(s/255*5)+6*Math.round(l/255*5)+Math.round(c/255*5),enumerable:!1},hexToRgb:{value:s=>{const l=/(?<colorString>[a-f\d]{6}|[a-f\d]{3})/i.exec(s.toString(16));if(!l)return[0,0,0];let{colorString:c}=l.groups;c.length===3&&(c=c.split("").map(f=>f+f).join(""));const d=Number.parseInt(c,16);return[d>>16&255,d>>8&255,d&255]},enumerable:!1},hexToAnsi256:{value:s=>o.rgbToAnsi256(...o.hexToRgb(s)),enumerable:!1}}),o}Object.defineProperty(t,"exports",{enumerable:!0,get:i})})(HS);var z4=HS.exports;const w$=VS(z4);function Gv(t,e){return t&&!Array.isArray(t)&&typeof t=="object"?t:{[e]:t}}function B4(t){return t.replace(/[-:.]/g,"")}function U4(t,e,r){const n=r.toFixed(0).slice(0,3).padStart(3,"0");return B4(`${new Date(t).toISOString().slice(0,-1)}${n}Z`)+e}function cl(t){return typeof t._addRunToRunMap=="function"}class Kc extends Wc{constructor(e){super(...arguments),Object.defineProperty(this,"runMap",{enumerable:!0,configurable:!0,writable:!0,value:new Map})}copy(){return this}stringifyError(e){return e instanceof Error?e.message+(e?.stack?`

${e.stack}`:""):typeof e=="string"?e:`${e}`}_addChildRun(e,r){e.child_runs.push(r)}_addRunToRunMap(e){const r=U4(e.start_time,e.id,e.execution_order),n={...e};if(n.parent_run_id!==void 0){const i=this.runMap.get(n.parent_run_id);i&&(this._addChildRun(i,n),i.child_execution_order=Math.max(i.child_execution_order,n.child_execution_order),n.trace_id=i.trace_id,i.dotted_order!==void 0&&(n.dotted_order=[i.dotted_order,r].join(".")))}else n.trace_id=n.id,n.dotted_order=r;return this.runMap.set(n.id,n),n}async _endTrace(e){const r=e.parent_run_id!==void 0&&this.runMap.get(e.parent_run_id);r?r.child_execution_order=Math.max(r.child_execution_order,e.child_execution_order):await this.persistRun(e),this.runMap.delete(e.id),await this.onRunUpdate?.(e)}_getExecutionOrder(e){const r=e!==void 0&&this.runMap.get(e);return r?r.child_execution_order+1:1}_createRunForLLMStart(e,r,n,i,a,o,s,l){const c=this._getExecutionOrder(i),d=Date.now(),f=s?{...a,metadata:s}:a,h={id:n,name:l??e.id[e.id.length-1],parent_run_id:i,start_time:d,serialized:e,events:[{name:"start",time:new Date(d).toISOString()}],inputs:{prompts:r},execution_order:c,child_runs:[],child_execution_order:c,run_type:"llm",extra:f??{},tags:o||[]};return this._addRunToRunMap(h)}async handleLLMStart(e,r,n,i,a,o,s,l){const c=this.runMap.get(n)??this._createRunForLLMStart(e,r,n,i,a,o,s,l);return await this.onRunCreate?.(c),await this.onLLMStart?.(c),c}_createRunForChatModelStart(e,r,n,i,a,o,s,l){const c=this._getExecutionOrder(i),d=Date.now(),f=s?{...a,metadata:s}:a,h={id:n,name:l??e.id[e.id.length-1],parent_run_id:i,start_time:d,serialized:e,events:[{name:"start",time:new Date(d).toISOString()}],inputs:{messages:r},execution_order:c,child_runs:[],child_execution_order:c,run_type:"llm",extra:f??{},tags:o||[]};return this._addRunToRunMap(h)}async handleChatModelStart(e,r,n,i,a,o,s,l){const c=this.runMap.get(n)??this._createRunForChatModelStart(e,r,n,i,a,o,s,l);return await this.onRunCreate?.(c),await this.onLLMStart?.(c),c}async handleLLMEnd(e,r,n,i,a){const o=this.runMap.get(r);if(!o||o?.run_type!=="llm")throw new Error("No LLM run to end.");return o.end_time=Date.now(),o.outputs=e,o.events.push({name:"end",time:new Date(o.end_time).toISOString()}),o.extra={...o.extra,...a},await this.onLLMEnd?.(o),await this._endTrace(o),o}async handleLLMError(e,r,n,i,a){const o=this.runMap.get(r);if(!o||o?.run_type!=="llm")throw new Error("No LLM run to end.");return o.end_time=Date.now(),o.error=this.stringifyError(e),o.events.push({name:"error",time:new Date(o.end_time).toISOString()}),o.extra={...o.extra,...a},await this.onLLMError?.(o),await this._endTrace(o),o}_createRunForChainStart(e,r,n,i,a,o,s,l){const c=this._getExecutionOrder(i),d=Date.now(),f={id:n,name:l??e.id[e.id.length-1],parent_run_id:i,start_time:d,serialized:e,events:[{name:"start",time:new Date(d).toISOString()}],inputs:r,execution_order:c,child_execution_order:c,run_type:s??"chain",child_runs:[],extra:o?{metadata:o}:{},tags:a||[]};return this._addRunToRunMap(f)}async handleChainStart(e,r,n,i,a,o,s,l){const c=this.runMap.get(n)??this._createRunForChainStart(e,r,n,i,a,o,s,l);return await this.onRunCreate?.(c),await this.onChainStart?.(c),c}async handleChainEnd(e,r,n,i,a){const o=this.runMap.get(r);if(!o)throw new Error("No chain run to end.");return o.end_time=Date.now(),o.outputs=Gv(e,"output"),o.events.push({name:"end",time:new Date(o.end_time).toISOString()}),a?.inputs!==void 0&&(o.inputs=Gv(a.inputs,"input")),await this.onChainEnd?.(o),await this._endTrace(o),o}async handleChainError(e,r,n,i,a){const o=this.runMap.get(r);if(!o)throw new Error("No chain run to end.");return o.end_time=Date.now(),o.error=this.stringifyError(e),o.events.push({name:"error",time:new Date(o.end_time).toISOString()}),a?.inputs!==void 0&&(o.inputs=Gv(a.inputs,"input")),await this.onChainError?.(o),await this._endTrace(o),o}_createRunForToolStart(e,r,n,i,a,o,s){const l=this._getExecutionOrder(i),c=Date.now(),d={id:n,name:s??e.id[e.id.length-1],parent_run_id:i,start_time:c,serialized:e,events:[{name:"start",time:new Date(c).toISOString()}],inputs:{input:r},execution_order:l,child_execution_order:l,run_type:"tool",child_runs:[],extra:o?{metadata:o}:{},tags:a||[]};return this._addRunToRunMap(d)}async handleToolStart(e,r,n,i,a,o,s){const l=this.runMap.get(n)??this._createRunForToolStart(e,r,n,i,a,o,s);return await this.onRunCreate?.(l),await this.onToolStart?.(l),l}async handleToolEnd(e,r){const n=this.runMap.get(r);if(!n||n?.run_type!=="tool")throw new Error("No tool run to end");return n.end_time=Date.now(),n.outputs={output:e},n.events.push({name:"end",time:new Date(n.end_time).toISOString()}),await this.onToolEnd?.(n),await this._endTrace(n),n}async handleToolError(e,r){const n=this.runMap.get(r);if(!n||n?.run_type!=="tool")throw new Error("No tool run to end");return n.end_time=Date.now(),n.error=this.stringifyError(e),n.events.push({name:"error",time:new Date(n.end_time).toISOString()}),await this.onToolError?.(n),await this._endTrace(n),n}async handleAgentAction(e,r){const n=this.runMap.get(r);if(!n||n?.run_type!=="chain")return;const i=n;i.actions=i.actions||[],i.actions.push(e),i.events.push({name:"agent_action",time:new Date().toISOString(),kwargs:{action:e}}),await this.onAgentAction?.(n)}async handleAgentEnd(e,r){const n=this.runMap.get(r);!n||n?.run_type!=="chain"||(n.events.push({name:"agent_end",time:new Date().toISOString(),kwargs:{action:e}}),await this.onAgentEnd?.(n))}_createRunForRetrieverStart(e,r,n,i,a,o,s){const l=this._getExecutionOrder(i),c=Date.now(),d={id:n,name:s??e.id[e.id.length-1],parent_run_id:i,start_time:c,serialized:e,events:[{name:"start",time:new Date(c).toISOString()}],inputs:{query:r},execution_order:l,child_execution_order:l,run_type:"retriever",child_runs:[],extra:o?{metadata:o}:{},tags:a||[]};return this._addRunToRunMap(d)}async handleRetrieverStart(e,r,n,i,a,o,s){const l=this.runMap.get(n)??this._createRunForRetrieverStart(e,r,n,i,a,o,s);return await this.onRunCreate?.(l),await this.onRetrieverStart?.(l),l}async handleRetrieverEnd(e,r){const n=this.runMap.get(r);if(!n||n?.run_type!=="retriever")throw new Error("No retriever run to end");return n.end_time=Date.now(),n.outputs={documents:e},n.events.push({name:"end",time:new Date(n.end_time).toISOString()}),await this.onRetrieverEnd?.(n),await this._endTrace(n),n}async handleRetrieverError(e,r){const n=this.runMap.get(r);if(!n||n?.run_type!=="retriever")throw new Error("No retriever run to end");return n.end_time=Date.now(),n.error=this.stringifyError(e),n.events.push({name:"error",time:new Date(n.end_time).toISOString()}),await this.onRetrieverError?.(n),await this._endTrace(n),n}async handleText(e,r){const n=this.runMap.get(r);!n||n?.run_type!=="chain"||(n.events.push({name:"text",time:new Date().toISOString(),kwargs:{text:e}}),await this.onText?.(n))}async handleLLMNewToken(e,r,n,i,a,o){const s=this.runMap.get(n);if(!s||s?.run_type!=="llm")throw new Error('Invalid "runId" provided to "handleLLMNewToken" callback.');return s.events.push({name:"new_token",time:new Date().toISOString(),kwargs:{token:e,idx:r,chunk:o?.chunk}}),await this.onLLMNewToken?.(s,e,{chunk:o?.chunk}),s}}function pr(t,e){return`${t.open}${e}${t.close}`}function an(t,e){try{return JSON.stringify(t,null,2)}catch{return e}}function Aj(t){return typeof t=="string"?t.trim():t==null?t:an(t,t.toString())}function Ji(t){if(!t.end_time)return"";const e=t.end_time-t.start_time;return e<1e3?`${e}ms`:`${(e/1e3).toFixed(2)}s`}const{color:Or}=w$;class $j extends Kc{constructor(){super(...arguments),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"console_callback_handler"})}persistRun(e){return Promise.resolve()}getParents(e){const r=[];let n=e;for(;n.parent_run_id;){const i=this.runMap.get(n.parent_run_id);if(i)r.push(i),n=i;else break}return r}getBreadcrumbs(e){const n=[...this.getParents(e).reverse(),e].map((i,a,o)=>{const s=`${i.execution_order}:${i.run_type}:${i.name}`;return a===o.length-1?pr(w$.bold,s):s}).join(" > ");return pr(Or.grey,n)}onChainStart(e){const r=this.getBreadcrumbs(e);console.log(`${pr(Or.green,"[chain/start]")} [${r}] Entering Chain run with input: ${an(e.inputs,"[inputs]")}`)}onChainEnd(e){const r=this.getBreadcrumbs(e);console.log(`${pr(Or.cyan,"[chain/end]")} [${r}] [${Ji(e)}] Exiting Chain run with output: ${an(e.outputs,"[outputs]")}`)}onChainError(e){const r=this.getBreadcrumbs(e);console.log(`${pr(Or.red,"[chain/error]")} [${r}] [${Ji(e)}] Chain run errored with error: ${an(e.error,"[error]")}`)}onLLMStart(e){const r=this.getBreadcrumbs(e),n="prompts"in e.inputs?{prompts:e.inputs.prompts.map(i=>i.trim())}:e.inputs;console.log(`${pr(Or.green,"[llm/start]")} [${r}] Entering LLM run with input: ${an(n,"[inputs]")}`)}onLLMEnd(e){const r=this.getBreadcrumbs(e);console.log(`${pr(Or.cyan,"[llm/end]")} [${r}] [${Ji(e)}] Exiting LLM run with output: ${an(e.outputs,"[response]")}`)}onLLMError(e){const r=this.getBreadcrumbs(e);console.log(`${pr(Or.red,"[llm/error]")} [${r}] [${Ji(e)}] LLM run errored with error: ${an(e.error,"[error]")}`)}onToolStart(e){const r=this.getBreadcrumbs(e);console.log(`${pr(Or.green,"[tool/start]")} [${r}] Entering Tool run with input: "${Aj(e.inputs.input)}"`)}onToolEnd(e){const r=this.getBreadcrumbs(e);console.log(`${pr(Or.cyan,"[tool/end]")} [${r}] [${Ji(e)}] Exiting Tool run with output: "${Aj(e.outputs?.output)}"`)}onToolError(e){const r=this.getBreadcrumbs(e);console.log(`${pr(Or.red,"[tool/error]")} [${r}] [${Ji(e)}] Tool run errored with error: ${an(e.error,"[error]")}`)}onRetrieverStart(e){const r=this.getBreadcrumbs(e);console.log(`${pr(Or.green,"[retriever/start]")} [${r}] Entering Retriever run with input: ${an(e.inputs,"[inputs]")}`)}onRetrieverEnd(e){const r=this.getBreadcrumbs(e);console.log(`${pr(Or.cyan,"[retriever/end]")} [${r}] [${Ji(e)}] Exiting Retriever run with output: ${an(e.outputs,"[outputs]")}`)}onRetrieverError(e){const r=this.getBreadcrumbs(e);console.log(`${pr(Or.red,"[retriever/error]")} [${r}] [${Ji(e)}] Retriever run errored with error: ${an(e.error,"[error]")}`)}onAgentAction(e){const r=e,n=this.getBreadcrumbs(e);console.log(`${pr(Or.blue,"[agent/action]")} [${n}] Agent selected action: ${an(r.actions[r.actions.length-1],"[action]")}`)}}function Gy(t,e){return t.lc_error_code=e,t.message=`${t.message}

Troubleshooting URL: https://js.langchain.com/docs/troubleshooting/errors/${e}/
`,t}function O$(t){return!!(t&&typeof t=="object"&&"type"in t&&t.type==="tool_call")}class F4 extends Error{constructor(e,r){super(e),Object.defineProperty(this,"output",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.output=r}}function Ij(t,e=qS){t=t.trim();const r=/```(json)?(.*)```/s.exec(t);return e(r?r[2]:t)}function qS(t){if(typeof t>"u")return null;try{return JSON.parse(t)}catch{}let e="";const r=[];let n=!1,i=!1;for(let a of t){if(n)a==='"'&&!i?n=!1:a===`
`&&!i?a="\\n":a==="\\"?i=!i:i=!1;else if(a==='"')n=!0,i=!1;else if(a==="{")r.push("}");else if(a==="[")r.push("]");else if(a==="}"||a==="]")if(r&&r[r.length-1]===a)r.pop();else return null;e+=a}n&&(e+='"');for(let a=r.length-1;a>=0;a-=1)e+=r[a];try{return JSON.parse(e)}catch{return null}}function ju(t,e){return typeof t=="string"?t===""?e:typeof e=="string"?t+e:[{type:"text",text:t},...e]:Array.isArray(e)?Wy(t,e)??[...t,...e]:e===""?t:[...t,{type:"text",text:e}]}function L4(t,e){return t==="error"||e==="error"?"error":"success"}function V4(t,e){function r(n,i){if(typeof n!="object"||n===null||n===void 0)return n;if(i>=e)return Array.isArray(n)?"[Array]":"[Object]";if(Array.isArray(n))return n.map(o=>r(o,i+1));const a={};for(const o of Object.keys(n))a[o]=r(n[o],i+1);return a}return JSON.stringify(r(t,0),null,2)}class Ai extends Ea{get lc_aliases(){return{additional_kwargs:"additional_kwargs",response_metadata:"response_metadata"}}get text(){return typeof this.content=="string"?this.content:""}getType(){return this._getType()}constructor(e,r){typeof e=="string"&&(e={content:e,additional_kwargs:r,response_metadata:{}}),e.additional_kwargs||(e.additional_kwargs={}),e.response_metadata||(e.response_metadata={}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","messages"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"content",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"additional_kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"response_metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name=e.name,this.content=e.content,this.additional_kwargs=e.additional_kwargs,this.response_metadata=e.response_metadata,this.id=e.id}toDict(){return{type:this._getType(),data:this.toJSON().kwargs}}static lc_name(){return"BaseMessage"}get _printableFields(){return{id:this.id,content:this.content,name:this.name,additional_kwargs:this.additional_kwargs,response_metadata:this.response_metadata}}_updateId(e){this.id=e,this.lc_kwargs.id=e}get[Symbol.toStringTag](){return this.constructor.lc_name()}[Symbol.for("nodejs.util.inspect.custom")](e){if(e===null)return this;const r=V4(this._printableFields,Math.max(4,e));return`${this.constructor.lc_name()} ${r}`}}function br(t,e){const r={...t};for(const[n,i]of Object.entries(e))if(r[n]==null)r[n]=i;else{if(i==null)continue;if(typeof r[n]!=typeof i||Array.isArray(r[n])!==Array.isArray(i))throw new Error(`field[${n}] already exists in the message chunk, but with a different type.`);if(typeof r[n]=="string"){if(n==="type")continue;r[n]+=i}else if(typeof r[n]=="object"&&!Array.isArray(r[n]))r[n]=br(r[n],i);else if(Array.isArray(r[n]))r[n]=Wy(r[n],i);else{if(r[n]===i)continue;console.warn(`field[${n}] already exists in this message chunk and value has unsupported type.`)}}return r}function Wy(t,e){if(!(t===void 0&&e===void 0)){if(t===void 0||e===void 0)return t||e;{const r=[...t];for(const n of e)if(typeof n=="object"&&"index"in n&&typeof n.index=="number"){const i=r.findIndex(a=>a.index===n.index);i!==-1?r[i]=br(r[i],n):r.push(n)}else{if(typeof n=="object"&&"text"in n&&n.text==="")continue;r.push(n)}return r}}}function k4(t,e){if(!t&&!e)throw new Error("Cannot merge two undefined objects.");if(!t||!e)return t||e;if(typeof t!=typeof e)throw new Error(`Cannot merge objects of different types.
Left ${typeof t}
Right ${typeof e}`);if(typeof t=="string"&&typeof e=="string")return t+e;if(Array.isArray(t)&&Array.isArray(e))return Wy(t,e);if(typeof t=="object"&&typeof e=="object")return br(t,e);if(t===e)return t;throw new Error(`Can not merge objects of different types.
Left ${t}
Right ${e}`)}class Cu extends Ai{}function H4(t){return typeof t.role=="string"}function Mu(t){return typeof t?._getType=="function"}function q4(t){return Mu(t)&&typeof t.concat=="function"}let G4=class extends Ai{static lc_name(){return"ToolMessage"}get lc_aliases(){return{tool_call_id:"tool_call_id"}}constructor(e,r,n){typeof e=="string"&&(e={content:e,name:n,tool_call_id:r}),super(e),Object.defineProperty(this,"lc_direct_tool_output",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"status",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tool_call_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"artifact",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.tool_call_id=e.tool_call_id,this.artifact=e.artifact,this.status=e.status}_getType(){return"tool"}static isInstance(e){return e._getType()==="tool"}get _printableFields(){return{...super._printableFields,tool_call_id:this.tool_call_id,artifact:this.artifact}}};class GS extends Cu{constructor(e){super(e),Object.defineProperty(this,"tool_call_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"status",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"artifact",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.tool_call_id=e.tool_call_id,this.artifact=e.artifact,this.status=e.status}static lc_name(){return"ToolMessageChunk"}_getType(){return"tool"}concat(e){return new GS({content:ju(this.content,e.content),additional_kwargs:br(this.additional_kwargs,e.additional_kwargs),response_metadata:br(this.response_metadata,e.response_metadata),artifact:k4(this.artifact,e.artifact),tool_call_id:this.tool_call_id,id:this.id??e.id,status:L4(this.status,e.status)})}get _printableFields(){return{...super._printableFields,tool_call_id:this.tool_call_id,artifact:this.artifact}}}function W4(t){const e=[],r=[];for(const n of t)if(n.function){const i=n.function.name;try{const a=JSON.parse(n.function.arguments),o={name:i||"",args:a||{},id:n.id};e.push(o)}catch{r.push({name:i,args:n.function.arguments,id:n.id,error:"Malformed args."})}}else continue;return[e,r]}class Nn extends Ai{get lc_aliases(){return{...super.lc_aliases,tool_calls:"tool_calls",invalid_tool_calls:"invalid_tool_calls"}}constructor(e,r){let n;if(typeof e=="string")n={content:e,tool_calls:[],invalid_tool_calls:[],additional_kwargs:r??{}};else{n=e;const i=n.additional_kwargs?.tool_calls,a=n.tool_calls;i!=null&&i.length>0&&(a===void 0||a.length===0)&&console.warn(["New LangChain packages are available that more efficiently handle",`tool calling.

Please upgrade your packages to versions that set`,"message tool calls. e.g., `yarn add @langchain/anthropic`,","yarn add @langchain/openai`, etc."].join(" "));try{if(i!=null&&a===void 0){const[o,s]=W4(i);n.tool_calls=o??[],n.invalid_tool_calls=s??[]}else n.tool_calls=n.tool_calls??[],n.invalid_tool_calls=n.invalid_tool_calls??[]}catch{n.tool_calls=[],n.invalid_tool_calls=[]}}super(n),Object.defineProperty(this,"tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"invalid_tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"usage_metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),typeof n!="string"&&(this.tool_calls=n.tool_calls??this.tool_calls,this.invalid_tool_calls=n.invalid_tool_calls??this.invalid_tool_calls),this.usage_metadata=n.usage_metadata}static lc_name(){return"AIMessage"}_getType(){return"ai"}get _printableFields(){return{...super._printableFields,tool_calls:this.tool_calls,invalid_tool_calls:this.invalid_tool_calls,usage_metadata:this.usage_metadata}}}function ii(t){return t._getType()==="ai"}function xj(t){return t._getType()==="ai"}class vt extends Cu{constructor(e){let r;if(typeof e=="string")r={content:e,tool_calls:[],invalid_tool_calls:[],tool_call_chunks:[]};else if(e.tool_call_chunks===void 0)r={...e,tool_calls:e.tool_calls??[],invalid_tool_calls:[],tool_call_chunks:[],usage_metadata:e.usage_metadata!==void 0?e.usage_metadata:void 0};else{const n=[],i=[];for(const a of e.tool_call_chunks){let o={};try{if(o=qS(a.args||"{}"),o===null||typeof o!="object"||Array.isArray(o))throw new Error("Malformed tool call chunk args.");n.push({name:a.name??"",args:o,id:a.id,type:"tool_call"})}catch{i.push({name:a.name,args:a.args,id:a.id,error:"Malformed args.",type:"invalid_tool_call"})}}r={...e,tool_calls:n,invalid_tool_calls:i,usage_metadata:e.usage_metadata!==void 0?e.usage_metadata:void 0}}super(r),Object.defineProperty(this,"tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"invalid_tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"tool_call_chunks",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"usage_metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.tool_call_chunks=r.tool_call_chunks??this.tool_call_chunks,this.tool_calls=r.tool_calls??this.tool_calls,this.invalid_tool_calls=r.invalid_tool_calls??this.invalid_tool_calls,this.usage_metadata=r.usage_metadata}get lc_aliases(){return{...super.lc_aliases,tool_calls:"tool_calls",invalid_tool_calls:"invalid_tool_calls",tool_call_chunks:"tool_call_chunks"}}static lc_name(){return"AIMessageChunk"}_getType(){return"ai"}get _printableFields(){return{...super._printableFields,tool_calls:this.tool_calls,tool_call_chunks:this.tool_call_chunks,invalid_tool_calls:this.invalid_tool_calls,usage_metadata:this.usage_metadata}}concat(e){const r={content:ju(this.content,e.content),additional_kwargs:br(this.additional_kwargs,e.additional_kwargs),response_metadata:br(this.response_metadata,e.response_metadata),tool_call_chunks:[],id:this.id??e.id};if(this.tool_call_chunks!==void 0||e.tool_call_chunks!==void 0){const n=Wy(this.tool_call_chunks,e.tool_call_chunks);n!==void 0&&n.length>0&&(r.tool_call_chunks=n)}if(this.usage_metadata!==void 0||e.usage_metadata!==void 0){const n={...(this.usage_metadata?.input_token_details?.audio!==void 0||e.usage_metadata?.input_token_details?.audio!==void 0)&&{audio:(this.usage_metadata?.input_token_details?.audio??0)+(e.usage_metadata?.input_token_details?.audio??0)},...(this.usage_metadata?.input_token_details?.cache_read!==void 0||e.usage_metadata?.input_token_details?.cache_read!==void 0)&&{cache_read:(this.usage_metadata?.input_token_details?.cache_read??0)+(e.usage_metadata?.input_token_details?.cache_read??0)},...(this.usage_metadata?.input_token_details?.cache_creation!==void 0||e.usage_metadata?.input_token_details?.cache_creation!==void 0)&&{cache_creation:(this.usage_metadata?.input_token_details?.cache_creation??0)+(e.usage_metadata?.input_token_details?.cache_creation??0)}},i={...(this.usage_metadata?.output_token_details?.audio!==void 0||e.usage_metadata?.output_token_details?.audio!==void 0)&&{audio:(this.usage_metadata?.output_token_details?.audio??0)+(e.usage_metadata?.output_token_details?.audio??0)},...(this.usage_metadata?.output_token_details?.reasoning!==void 0||e.usage_metadata?.output_token_details?.reasoning!==void 0)&&{reasoning:(this.usage_metadata?.output_token_details?.reasoning??0)+(e.usage_metadata?.output_token_details?.reasoning??0)}},a=this.usage_metadata??{input_tokens:0,output_tokens:0,total_tokens:0},o=e.usage_metadata??{input_tokens:0,output_tokens:0,total_tokens:0},s={input_tokens:a.input_tokens+o.input_tokens,output_tokens:a.output_tokens+o.output_tokens,total_tokens:a.total_tokens+o.total_tokens,...Object.keys(n).length>0&&{input_token_details:n},...Object.keys(i).length>0&&{output_token_details:i}};r.usage_metadata=s}return new vt(r)}}let Co=class S$ extends Ai{static lc_name(){return"ChatMessage"}static _chatMessageClass(){return S$}constructor(e,r){typeof e=="string"&&(e={content:e,role:r}),super(e),Object.defineProperty(this,"role",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.role=e.role}_getType(){return"generic"}static isInstance(e){return e._getType()==="generic"}get _printableFields(){return{...super._printableFields,role:this.role}}};class Jc extends Cu{static lc_name(){return"ChatMessageChunk"}constructor(e,r){typeof e=="string"&&(e={content:e,role:r}),super(e),Object.defineProperty(this,"role",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.role=e.role}_getType(){return"generic"}concat(e){return new Jc({content:ju(this.content,e.content),additional_kwargs:br(this.additional_kwargs,e.additional_kwargs),response_metadata:br(this.response_metadata,e.response_metadata),role:this.role,id:this.id??e.id})}get _printableFields(){return{...super._printableFields,role:this.role}}}class Ky extends Cu{static lc_name(){return"FunctionMessageChunk"}_getType(){return"function"}concat(e){return new Ky({content:ju(this.content,e.content),additional_kwargs:br(this.additional_kwargs,e.additional_kwargs),response_metadata:br(this.response_metadata,e.response_metadata),name:this.name??"",id:this.id??e.id})}}class Pa extends Ai{static lc_name(){return"HumanMessage"}_getType(){return"human"}}class Xc extends Cu{static lc_name(){return"HumanMessageChunk"}_getType(){return"human"}concat(e){return new Xc({content:ju(this.content,e.content),additional_kwargs:br(this.additional_kwargs,e.additional_kwargs),response_metadata:br(this.response_metadata,e.response_metadata),id:this.id??e.id})}}let mO=class extends Ai{static lc_name(){return"SystemMessage"}_getType(){return"system"}};class Qs extends Cu{static lc_name(){return"SystemMessageChunk"}_getType(){return"system"}concat(e){return new Qs({content:ju(this.content,e.content),additional_kwargs:br(this.additional_kwargs,e.additional_kwargs),response_metadata:br(this.response_metadata,e.response_metadata),id:this.id??e.id})}}function K4(t){return O$(t)?t:typeof t.id=="string"&&t.type==="function"&&typeof t.function=="object"&&t.function!==null&&"arguments"in t.function&&typeof t.function.arguments=="string"&&"name"in t.function&&typeof t.function.name=="string"?{id:t.id,args:JSON.parse(t.function.arguments),name:t.function.name,type:"tool_call"}:t}function J4(t){return typeof t=="object"&&t!=null&&t.lc===1&&Array.isArray(t.id)&&t.kwargs!=null&&typeof t.kwargs=="object"}function Wv(t){let e,r;if(J4(t)){const n=t.id.at(-1);n==="HumanMessage"||n==="HumanMessageChunk"?e="user":n==="AIMessage"||n==="AIMessageChunk"?e="assistant":n==="SystemMessage"||n==="SystemMessageChunk"?e="system":n==="FunctionMessage"||n==="FunctionMessageChunk"?e="function":n==="ToolMessage"||n==="ToolMessageChunk"?e="tool":e="unknown",r=t.kwargs}else{const{type:n,...i}=t;e=n,r=i}if(e==="human"||e==="user")return new Pa(r);if(e==="ai"||e==="assistant"){const{tool_calls:n,...i}=r;if(!Array.isArray(n))return new Nn(r);const a=n.map(K4);return new Nn({...i,tool_calls:a})}else{if(e==="system")return new mO(r);if(e==="developer")return new mO({...r,additional_kwargs:{...r.additional_kwargs,__openai_role__:"developer"}});if(e==="tool"&&"tool_call_id"in r)return new G4({...r,content:r.content,tool_call_id:r.tool_call_id,name:r.name});throw Gy(new Error(`Unable to coerce message from array: only human, AI, system, developer, or tool message coercion is currently supported.

Received: ${JSON.stringify(t,null,2)}`),"MESSAGE_COERCION_FAILURE")}}function ya(t){if(typeof t=="string")return new Pa(t);if(Mu(t))return t;if(Array.isArray(t)){const[e,r]=t;return Wv({type:e,content:r})}else if(H4(t)){const{role:e,...r}=t;return Wv({...r,type:e})}else return Wv(t)}function WS(t,e="Human",r="AI"){const n=[];for(const i of t){let a;if(i._getType()==="human")a=e;else if(i._getType()==="ai")a=r;else if(i._getType()==="system")a="System";else if(i._getType()==="function")a="Function";else if(i._getType()==="tool")a="Tool";else if(i._getType()==="generic")a=i.role;else throw new Error(`Got unsupported message type: ${i._getType()}`);const o=i.name?`${i.name}, `:"",s=typeof i.content=="string"?i.content:JSON.stringify(i.content,null,2);n.push(`${a}: ${o}${s}`)}return n.join(`
`)}function X4(t){const e=t._getType();if(e==="human")return new Xc({...t});if(e==="ai"){let r={...t};return"tool_calls"in r&&(r={...r,tool_call_chunks:r.tool_calls?.map(n=>({...n,type:"tool_call_chunk",index:void 0,args:JSON.stringify(n.args)}))}),new vt({...r})}else{if(e==="system")return new Qs({...t});if(e==="function")return new Ky({...t});if(Co.isInstance(t))return new Jc({...t});throw new Error("Unknown message type.")}}var Jy={exports:{}},E$={};function _n(t,e){typeof e=="boolean"&&(e={forever:e}),this._originalTimeouts=JSON.parse(JSON.stringify(t)),this._timeouts=t,this._options=e||{},this._maxRetryTime=e&&e.maxRetryTime||1/0,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._timer=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}var Z4=_n;_n.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts.slice(0)};_n.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timer&&clearTimeout(this._timer),this._timeouts=[],this._cachedTimeouts=null};_n.prototype.retry=function(t){if(this._timeout&&clearTimeout(this._timeout),!t)return!1;var e=new Date().getTime();if(t&&e-this._operationStart>=this._maxRetryTime)return this._errors.push(t),this._errors.unshift(new Error("RetryOperation timeout occurred")),!1;this._errors.push(t);var r=this._timeouts.shift();if(r===void 0)if(this._cachedTimeouts)this._errors.splice(0,this._errors.length-1),r=this._cachedTimeouts.slice(-1);else return!1;var n=this;return this._timer=setTimeout(function(){n._attempts++,n._operationTimeoutCb&&(n._timeout=setTimeout(function(){n._operationTimeoutCb(n._attempts)},n._operationTimeout),n._options.unref&&n._timeout.unref()),n._fn(n._attempts)},r),this._options.unref&&this._timer.unref(),!0};_n.prototype.attempt=function(t,e){this._fn=t,e&&(e.timeout&&(this._operationTimeout=e.timeout),e.cb&&(this._operationTimeoutCb=e.cb));var r=this;this._operationTimeoutCb&&(this._timeout=setTimeout(function(){r._operationTimeoutCb()},r._operationTimeout)),this._operationStart=new Date().getTime(),this._fn(this._attempts)};_n.prototype.try=function(t){console.log("Using RetryOperation.try() is deprecated"),this.attempt(t)};_n.prototype.start=function(t){console.log("Using RetryOperation.start() is deprecated"),this.attempt(t)};_n.prototype.start=_n.prototype.try;_n.prototype.errors=function(){return this._errors};_n.prototype.attempts=function(){return this._attempts};_n.prototype.mainError=function(){if(this._errors.length===0)return null;for(var t={},e=null,r=0,n=0;n<this._errors.length;n++){var i=this._errors[n],a=i.message,o=(t[a]||0)+1;t[a]=o,o>=r&&(e=i,r=o)}return e};(function(t){var e=Z4;t.operation=function(r){var n=t.timeouts(r);return new e(n,{forever:r&&(r.forever||r.retries===1/0),unref:r&&r.unref,maxRetryTime:r&&r.maxRetryTime})},t.timeouts=function(r){if(r instanceof Array)return[].concat(r);var n={retries:10,factor:2,minTimeout:1*1e3,maxTimeout:1/0,randomize:!1};for(var i in r)n[i]=r[i];if(n.minTimeout>n.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var a=[],o=0;o<n.retries;o++)a.push(this.createTimeout(o,n));return r&&r.forever&&!a.length&&a.push(this.createTimeout(o,n)),a.sort(function(s,l){return s-l}),a},t.createTimeout=function(r,n){var i=n.randomize?Math.random()+1:1,a=Math.round(i*Math.max(n.minTimeout,1)*Math.pow(n.factor,r));return a=Math.min(a,n.maxTimeout),a},t.wrap=function(r,n,i){if(n instanceof Array&&(i=n,n=null),!i){i=[];for(var a in r)typeof r[a]=="function"&&i.push(a)}for(var o=0;o<i.length;o++){var s=i[o],l=r[s];r[s]=function(d){var f=t.operation(n),h=Array.prototype.slice.call(arguments,1),p=h.pop();h.push(function(b){f.retry(b)||(b&&(arguments[0]=f.mainError()),p.apply(this,arguments))}),f.attempt(function(){d.apply(r,h)})}.bind(r,l),r[s].options=n}}})(E$);var Y4=E$;const Q4=Y4,e3=["Failed to fetch","NetworkError when attempting to fetch resource.","The Internet connection appears to be offline.","Network request failed"];let P$=class extends Error{constructor(e){super(),e instanceof Error?(this.originalError=e,{message:e}=e):(this.originalError=new Error(e),this.originalError.stack=this.stack),this.name="AbortError",this.message=e}};const t3=(t,e,r)=>{const n=r.retries-(e-1);return t.attemptNumber=e,t.retriesLeft=n,t},r3=t=>e3.includes(t),j$=(t,e)=>new Promise((r,n)=>{e={onFailedAttempt:()=>{},retries:10,...e};const i=Q4.operation(e);i.attempt(async a=>{try{r(await t(a))}catch(o){if(!(o instanceof Error)){n(new TypeError(`Non-error was thrown: "${o}". You should only throw errors.`));return}if(o instanceof P$)i.stop(),n(o.originalError);else if(o instanceof TypeError&&!r3(o.message))i.stop(),n(o);else{t3(o,a,e);try{await e.onFailedAttempt(o)}catch(s){n(s);return}i.retry(o)||n(i.mainError())}}})});Jy.exports=j$;Jy.exports.default=j$;Jy.exports.AbortError=P$;var n3=Jy.exports;const ry=VS(n3);var C$={},M$={exports:{}};(function(t){var e=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function i(l,c,d){this.fn=l,this.context=c,this.once=d||!1}function a(l,c,d,f,h){if(typeof d!="function")throw new TypeError("The listener must be a function");var p=new i(d,f||l,h),b=r?r+c:c;return l._events[b]?l._events[b].fn?l._events[b]=[l._events[b],p]:l._events[b].push(p):(l._events[b]=p,l._eventsCount++),l}function o(l,c){--l._eventsCount===0?l._events=new n:delete l._events[c]}function s(){this._events=new n,this._eventsCount=0}s.prototype.eventNames=function(){var c=[],d,f;if(this._eventsCount===0)return c;for(f in d=this._events)e.call(d,f)&&c.push(r?f.slice(1):f);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(d)):c},s.prototype.listeners=function(c){var d=r?r+c:c,f=this._events[d];if(!f)return[];if(f.fn)return[f.fn];for(var h=0,p=f.length,b=new Array(p);h<p;h++)b[h]=f[h].fn;return b},s.prototype.listenerCount=function(c){var d=r?r+c:c,f=this._events[d];return f?f.fn?1:f.length:0},s.prototype.emit=function(c,d,f,h,p,b){var g=r?r+c:c;if(!this._events[g])return!1;var v=this._events[g],E=arguments.length,C,S;if(v.fn){switch(v.once&&this.removeListener(c,v.fn,void 0,!0),E){case 1:return v.fn.call(v.context),!0;case 2:return v.fn.call(v.context,d),!0;case 3:return v.fn.call(v.context,d,f),!0;case 4:return v.fn.call(v.context,d,f,h),!0;case 5:return v.fn.call(v.context,d,f,h,p),!0;case 6:return v.fn.call(v.context,d,f,h,p,b),!0}for(S=1,C=new Array(E-1);S<E;S++)C[S-1]=arguments[S];v.fn.apply(v.context,C)}else{var N=v.length,D;for(S=0;S<N;S++)switch(v[S].once&&this.removeListener(c,v[S].fn,void 0,!0),E){case 1:v[S].fn.call(v[S].context);break;case 2:v[S].fn.call(v[S].context,d);break;case 3:v[S].fn.call(v[S].context,d,f);break;case 4:v[S].fn.call(v[S].context,d,f,h);break;default:if(!C)for(D=1,C=new Array(E-1);D<E;D++)C[D-1]=arguments[D];v[S].fn.apply(v[S].context,C)}}return!0},s.prototype.on=function(c,d,f){return a(this,c,d,f,!1)},s.prototype.once=function(c,d,f){return a(this,c,d,f,!0)},s.prototype.removeListener=function(c,d,f,h){var p=r?r+c:c;if(!this._events[p])return this;if(!d)return o(this,p),this;var b=this._events[p];if(b.fn)b.fn===d&&(!h||b.once)&&(!f||b.context===f)&&o(this,p);else{for(var g=0,v=[],E=b.length;g<E;g++)(b[g].fn!==d||h&&!b[g].once||f&&b[g].context!==f)&&v.push(b[g]);v.length?this._events[p]=v.length===1?v[0]:v:o(this,p)}return this},s.prototype.removeAllListeners=function(c){var d;return c?(d=r?r+c:c,this._events[d]&&o(this,d)):(this._events=new n,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=r,s.EventEmitter=s,t.exports=s})(M$);var i3=M$.exports,Xy={exports:{}},a3=(t,e)=>(e=e||(()=>{}),t.then(r=>new Promise(n=>{n(e())}).then(()=>r),r=>new Promise(n=>{n(e())}).then(()=>{throw r})));const o3=a3;class T$ extends Error{constructor(e){super(e),this.name="TimeoutError"}}const R$=(t,e,r)=>new Promise((n,i)=>{if(typeof e!="number"||e<0)throw new TypeError("Expected `milliseconds` to be a positive number");if(e===1/0){n(t);return}const a=setTimeout(()=>{if(typeof r=="function"){try{n(r())}catch(l){i(l)}return}const o=typeof r=="string"?r:`Promise timed out after ${e} milliseconds`,s=r instanceof Error?r:new T$(o);typeof t.cancel=="function"&&t.cancel(),i(s)},e);o3(t.then(n,i),()=>{clearTimeout(a)})});Xy.exports=R$;Xy.exports.default=R$;Xy.exports.TimeoutError=T$;var s3=Xy.exports,KS={},JS={};Object.defineProperty(JS,"__esModule",{value:!0});function u3(t,e,r){let n=0,i=t.length;for(;i>0;){const a=i/2|0;let o=n+a;r(t[o],e)<=0?(n=++o,i-=a+1):i=a}return n}JS.default=u3;Object.defineProperty(KS,"__esModule",{value:!0});const l3=JS;class c3{constructor(){this._queue=[]}enqueue(e,r){r=Object.assign({priority:0},r);const n={priority:r.priority,run:e};if(this.size&&this._queue[this.size-1].priority>=r.priority){this._queue.push(n);return}const i=l3.default(this._queue,n,(a,o)=>o.priority-a.priority);this._queue.splice(i,0,n)}dequeue(){const e=this._queue.shift();return e?.run}filter(e){return this._queue.filter(r=>r.priority===e.priority).map(r=>r.run)}get size(){return this._queue.length}}KS.default=c3;Object.defineProperty(C$,"__esModule",{value:!0});const d3=i3,A$=s3,f3=KS,wp=()=>{},h3=new A$.TimeoutError;class p3 extends d3{constructor(e){var r,n,i,a;if(super(),this._intervalCount=0,this._intervalEnd=0,this._pendingCount=0,this._resolveEmpty=wp,this._resolveIdle=wp,e=Object.assign({carryoverConcurrencyCount:!1,intervalCap:1/0,interval:0,concurrency:1/0,autoStart:!0,queueClass:f3.default},e),!(typeof e.intervalCap=="number"&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${(n=(r=e.intervalCap)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:""}\` (${typeof e.intervalCap})`);if(e.interval===void 0||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${(a=(i=e.interval)===null||i===void 0?void 0:i.toString())!==null&&a!==void 0?a:""}\` (${typeof e.interval})`);this._carryoverConcurrencyCount=e.carryoverConcurrencyCount,this._isIntervalIgnored=e.intervalCap===1/0||e.interval===0,this._intervalCap=e.intervalCap,this._interval=e.interval,this._queue=new e.queueClass,this._queueClass=e.queueClass,this.concurrency=e.concurrency,this._timeout=e.timeout,this._throwOnTimeout=e.throwOnTimeout===!0,this._isPaused=e.autoStart===!1}get _doesIntervalAllowAnother(){return this._isIntervalIgnored||this._intervalCount<this._intervalCap}get _doesConcurrentAllowAnother(){return this._pendingCount<this._concurrency}_next(){this._pendingCount--,this._tryToStartAnother(),this.emit("next")}_resolvePromises(){this._resolveEmpty(),this._resolveEmpty=wp,this._pendingCount===0&&(this._resolveIdle(),this._resolveIdle=wp,this.emit("idle"))}_onResumeInterval(){this._onInterval(),this._initializeIntervalIfNeeded(),this._timeoutId=void 0}_isIntervalPaused(){const e=Date.now();if(this._intervalId===void 0){const r=this._intervalEnd-e;if(r<0)this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0;else return this._timeoutId===void 0&&(this._timeoutId=setTimeout(()=>{this._onResumeInterval()},r)),!0}return!1}_tryToStartAnother(){if(this._queue.size===0)return this._intervalId&&clearInterval(this._intervalId),this._intervalId=void 0,this._resolvePromises(),!1;if(!this._isPaused){const e=!this._isIntervalPaused();if(this._doesIntervalAllowAnother&&this._doesConcurrentAllowAnother){const r=this._queue.dequeue();return r?(this.emit("active"),r(),e&&this._initializeIntervalIfNeeded(),!0):!1}}return!1}_initializeIntervalIfNeeded(){this._isIntervalIgnored||this._intervalId!==void 0||(this._intervalId=setInterval(()=>{this._onInterval()},this._interval),this._intervalEnd=Date.now()+this._interval)}_onInterval(){this._intervalCount===0&&this._pendingCount===0&&this._intervalId&&(clearInterval(this._intervalId),this._intervalId=void 0),this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0,this._processQueue()}_processQueue(){for(;this._tryToStartAnother(););}get concurrency(){return this._concurrency}set concurrency(e){if(!(typeof e=="number"&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);this._concurrency=e,this._processQueue()}async add(e,r={}){return new Promise((n,i)=>{const a=async()=>{this._pendingCount++,this._intervalCount++;try{const o=this._timeout===void 0&&r.timeout===void 0?e():A$.default(Promise.resolve(e()),r.timeout===void 0?this._timeout:r.timeout,()=>{(r.throwOnTimeout===void 0?this._throwOnTimeout:r.throwOnTimeout)&&i(h3)});n(await o)}catch(o){i(o)}this._next()};this._queue.enqueue(a,r),this._tryToStartAnother(),this.emit("add")})}async addAll(e,r){return Promise.all(e.map(async n=>this.add(n,r)))}start(){return this._isPaused?(this._isPaused=!1,this._processQueue(),this):this}pause(){this._isPaused=!0}clear(){this._queue=new this._queueClass}async onEmpty(){if(this._queue.size!==0)return new Promise(e=>{const r=this._resolveEmpty;this._resolveEmpty=()=>{r(),e()}})}async onIdle(){if(!(this._pendingCount===0&&this._queue.size===0))return new Promise(e=>{const r=this._resolveIdle;this._resolveIdle=()=>{r(),e()}})}get size(){return this._queue.size}sizeBy(e){return this._queue.filter(e).length}get pending(){return this._pendingCount}get isPaused(){return this._isPaused}get timeout(){return this._timeout}set timeout(e){this._timeout=e}}var $i=C$.default=p3;const _3=(...t)=>fetch(...t),y3=Symbol.for("ls:fetch_implementation"),Oe=()=>globalThis[y3]??_3,b3=[400,401,403,404,405,406,407,408],g3=[409];let Dj=class{constructor(e){Object.defineProperty(this,"maxConcurrency",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxRetries",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"queue",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"onFailedResponseHook",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxConcurrency=e.maxConcurrency??1/0,this.maxRetries=e.maxRetries??6,"default"in $i?this.queue=new $i.default({concurrency:this.maxConcurrency}):this.queue=new $i({concurrency:this.maxConcurrency}),this.onFailedResponseHook=e?.onFailedResponseHook}call(e,...r){const n=this.onFailedResponseHook;return this.queue.add(()=>ry(()=>e(...r).catch(i=>{throw i instanceof Error?i:new Error(i)}),{async onFailedAttempt(i){if(i.message.startsWith("Cancel")||i.message.startsWith("TimeoutError")||i.message.startsWith("AbortError")||i?.code==="ECONNABORTED")throw i;const a=i?.response,o=a?.status;if(o){if(b3.includes(+o))throw i;if(g3.includes(+o))return;n&&await n(a)}},retries:this.maxRetries,randomize:!0}),{throwOnTimeout:!0})}callWithOptions(e,r,...n){return e.signal?Promise.race([this.call(r,...n),new Promise((i,a)=>{e.signal?.addEventListener("abort",()=>{a(new Error("AbortError"))})})]):this.call(r,...n)}fetch(...e){return this.call(()=>Oe()(...e).then(r=>r.ok?r:Promise.reject(r)))}};function Nj(t){return typeof t?._getType=="function"}function zj(t){const e={type:t._getType(),data:{content:t.content}};return t?.additional_kwargs&&Object.keys(t.additional_kwargs).length>0&&(e.data.additional_kwargs={...t.additional_kwargs}),e}function xe(t,e){if(!oc(t)){const r=e!==void 0?`Invalid UUID for ${e}: ${t}`:`Invalid UUID: ${t}`;throw new Error(r)}return t}const Bj={};function $$(t){Bj[t]||(console.warn(t),Bj[t]=!0)}var vO={exports:{}};const m3="2.0.0",I$=256,v3=Number.MAX_SAFE_INTEGER||9007199254740991,w3=16,O3=I$-6,S3=["major","premajor","minor","preminor","patch","prepatch","prerelease"];var Zy={MAX_LENGTH:I$,MAX_SAFE_COMPONENT_LENGTH:w3,MAX_SAFE_BUILD_LENGTH:O3,MAX_SAFE_INTEGER:v3,RELEASE_TYPES:S3,SEMVER_SPEC_VERSION:m3,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2},Kv={};const E3=typeof process=="object"&&Kv&&Kv.NODE_DEBUG&&/\bsemver\b/i.test(Kv.NODE_DEBUG)?(...t)=>console.error("SEMVER",...t):()=>{};var Yy=E3;(function(t,e){const{MAX_SAFE_COMPONENT_LENGTH:r,MAX_SAFE_BUILD_LENGTH:n,MAX_LENGTH:i}=Zy,a=Yy;e=t.exports={};const o=e.re=[],s=e.safeRe=[],l=e.src=[],c=e.safeSrc=[],d=e.t={};let f=0;const h="[a-zA-Z0-9-]",p=[["\\s",1],["\\d",i],[h,n]],b=v=>{for(const[E,C]of p)v=v.split(`${E}*`).join(`${E}{0,${C}}`).split(`${E}+`).join(`${E}{1,${C}}`);return v},g=(v,E,C)=>{const S=b(E),N=f++;a(v,N,E),d[v]=N,l[N]=E,c[N]=S,o[N]=new RegExp(E,C?"g":void 0),s[N]=new RegExp(S,C?"g":void 0)};g("NUMERICIDENTIFIER","0|[1-9]\\d*"),g("NUMERICIDENTIFIERLOOSE","\\d+"),g("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${h}*`),g("MAINVERSION",`(${l[d.NUMERICIDENTIFIER]})\\.(${l[d.NUMERICIDENTIFIER]})\\.(${l[d.NUMERICIDENTIFIER]})`),g("MAINVERSIONLOOSE",`(${l[d.NUMERICIDENTIFIERLOOSE]})\\.(${l[d.NUMERICIDENTIFIERLOOSE]})\\.(${l[d.NUMERICIDENTIFIERLOOSE]})`),g("PRERELEASEIDENTIFIER",`(?:${l[d.NUMERICIDENTIFIER]}|${l[d.NONNUMERICIDENTIFIER]})`),g("PRERELEASEIDENTIFIERLOOSE",`(?:${l[d.NUMERICIDENTIFIERLOOSE]}|${l[d.NONNUMERICIDENTIFIER]})`),g("PRERELEASE",`(?:-(${l[d.PRERELEASEIDENTIFIER]}(?:\\.${l[d.PRERELEASEIDENTIFIER]})*))`),g("PRERELEASELOOSE",`(?:-?(${l[d.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${l[d.PRERELEASEIDENTIFIERLOOSE]})*))`),g("BUILDIDENTIFIER",`${h}+`),g("BUILD",`(?:\\+(${l[d.BUILDIDENTIFIER]}(?:\\.${l[d.BUILDIDENTIFIER]})*))`),g("FULLPLAIN",`v?${l[d.MAINVERSION]}${l[d.PRERELEASE]}?${l[d.BUILD]}?`),g("FULL",`^${l[d.FULLPLAIN]}$`),g("LOOSEPLAIN",`[v=\\s]*${l[d.MAINVERSIONLOOSE]}${l[d.PRERELEASELOOSE]}?${l[d.BUILD]}?`),g("LOOSE",`^${l[d.LOOSEPLAIN]}$`),g("GTLT","((?:<|>)?=?)"),g("XRANGEIDENTIFIERLOOSE",`${l[d.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),g("XRANGEIDENTIFIER",`${l[d.NUMERICIDENTIFIER]}|x|X|\\*`),g("XRANGEPLAIN",`[v=\\s]*(${l[d.XRANGEIDENTIFIER]})(?:\\.(${l[d.XRANGEIDENTIFIER]})(?:\\.(${l[d.XRANGEIDENTIFIER]})(?:${l[d.PRERELEASE]})?${l[d.BUILD]}?)?)?`),g("XRANGEPLAINLOOSE",`[v=\\s]*(${l[d.XRANGEIDENTIFIERLOOSE]})(?:\\.(${l[d.XRANGEIDENTIFIERLOOSE]})(?:\\.(${l[d.XRANGEIDENTIFIERLOOSE]})(?:${l[d.PRERELEASELOOSE]})?${l[d.BUILD]}?)?)?`),g("XRANGE",`^${l[d.GTLT]}\\s*${l[d.XRANGEPLAIN]}$`),g("XRANGELOOSE",`^${l[d.GTLT]}\\s*${l[d.XRANGEPLAINLOOSE]}$`),g("COERCEPLAIN",`(^|[^\\d])(\\d{1,${r}})(?:\\.(\\d{1,${r}}))?(?:\\.(\\d{1,${r}}))?`),g("COERCE",`${l[d.COERCEPLAIN]}(?:$|[^\\d])`),g("COERCEFULL",l[d.COERCEPLAIN]+`(?:${l[d.PRERELEASE]})?(?:${l[d.BUILD]})?(?:$|[^\\d])`),g("COERCERTL",l[d.COERCE],!0),g("COERCERTLFULL",l[d.COERCEFULL],!0),g("LONETILDE","(?:~>?)"),g("TILDETRIM",`(\\s*)${l[d.LONETILDE]}\\s+`,!0),e.tildeTrimReplace="$1~",g("TILDE",`^${l[d.LONETILDE]}${l[d.XRANGEPLAIN]}$`),g("TILDELOOSE",`^${l[d.LONETILDE]}${l[d.XRANGEPLAINLOOSE]}$`),g("LONECARET","(?:\\^)"),g("CARETTRIM",`(\\s*)${l[d.LONECARET]}\\s+`,!0),e.caretTrimReplace="$1^",g("CARET",`^${l[d.LONECARET]}${l[d.XRANGEPLAIN]}$`),g("CARETLOOSE",`^${l[d.LONECARET]}${l[d.XRANGEPLAINLOOSE]}$`),g("COMPARATORLOOSE",`^${l[d.GTLT]}\\s*(${l[d.LOOSEPLAIN]})$|^$`),g("COMPARATOR",`^${l[d.GTLT]}\\s*(${l[d.FULLPLAIN]})$|^$`),g("COMPARATORTRIM",`(\\s*)${l[d.GTLT]}\\s*(${l[d.LOOSEPLAIN]}|${l[d.XRANGEPLAIN]})`,!0),e.comparatorTrimReplace="$1$2$3",g("HYPHENRANGE",`^\\s*(${l[d.XRANGEPLAIN]})\\s+-\\s+(${l[d.XRANGEPLAIN]})\\s*$`),g("HYPHENRANGELOOSE",`^\\s*(${l[d.XRANGEPLAINLOOSE]})\\s+-\\s+(${l[d.XRANGEPLAINLOOSE]})\\s*$`),g("STAR","(<|>)?=?\\s*\\*"),g("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),g("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")})(vO,vO.exports);var Zc=vO.exports;const P3=Object.freeze({loose:!0}),j3=Object.freeze({}),C3=t=>t?typeof t!="object"?P3:t:j3;var XS=C3;const Uj=/^[0-9]+$/,x$=(t,e)=>{const r=Uj.test(t),n=Uj.test(e);return r&&n&&(t=+t,e=+e),t===e?0:r&&!n?-1:n&&!r?1:t<e?-1:1},M3=(t,e)=>x$(e,t);var D$={compareIdentifiers:x$,rcompareIdentifiers:M3};const Op=Yy,{MAX_LENGTH:Fj,MAX_SAFE_INTEGER:Sp}=Zy,{safeRe:Lj,safeSrc:Vj,t:Ep}=Zc,T3=XS,{compareIdentifiers:qo}=D$;let R3=class Kn{constructor(e,r){if(r=T3(r),e instanceof Kn){if(e.loose===!!r.loose&&e.includePrerelease===!!r.includePrerelease)return e;e=e.version}else if(typeof e!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>Fj)throw new TypeError(`version is longer than ${Fj} characters`);Op("SemVer",e,r),this.options=r,this.loose=!!r.loose,this.includePrerelease=!!r.includePrerelease;const n=e.trim().match(r.loose?Lj[Ep.LOOSE]:Lj[Ep.FULL]);if(!n)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>Sp||this.major<0)throw new TypeError("Invalid major version");if(this.minor>Sp||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>Sp||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map(i=>{if(/^[0-9]+$/.test(i)){const a=+i;if(a>=0&&a<Sp)return a}return i}):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(Op("SemVer.compare",this.version,this.options,e),!(e instanceof Kn)){if(typeof e=="string"&&e===this.version)return 0;e=new Kn(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof Kn||(e=new Kn(e,this.options)),qo(this.major,e.major)||qo(this.minor,e.minor)||qo(this.patch,e.patch)}comparePre(e){if(e instanceof Kn||(e=new Kn(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let r=0;do{const n=this.prerelease[r],i=e.prerelease[r];if(Op("prerelease compare",r,n,i),n===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(n===void 0)return-1;if(n===i)continue;return qo(n,i)}while(++r)}compareBuild(e){e instanceof Kn||(e=new Kn(e,this.options));let r=0;do{const n=this.build[r],i=e.build[r];if(Op("build compare",r,n,i),n===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(n===void 0)return-1;if(n===i)continue;return qo(n,i)}while(++r)}inc(e,r,n){if(e.startsWith("pre")){if(!r&&n===!1)throw new Error("invalid increment argument: identifier is empty");if(r){const i=new RegExp(`^${this.options.loose?Vj[Ep.PRERELEASELOOSE]:Vj[Ep.PRERELEASE]}$`),a=`-${r}`.match(i);if(!a||a[1]!==r)throw new Error(`invalid identifier: ${r}`)}}switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",r,n);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",r,n);break;case"prepatch":this.prerelease.length=0,this.inc("patch",r,n),this.inc("pre",r,n);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",r,n),this.inc("pre",r,n);break;case"release":if(this.prerelease.length===0)throw new Error(`version ${this.raw} is not a prerelease`);this.prerelease.length=0;break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{const i=Number(n)?1:0;if(this.prerelease.length===0)this.prerelease=[i];else{let a=this.prerelease.length;for(;--a>=0;)typeof this.prerelease[a]=="number"&&(this.prerelease[a]++,a=-2);if(a===-1){if(r===this.prerelease.join(".")&&n===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(i)}}if(r){let a=[r,i];n===!1&&(a=[r]),qo(this.prerelease[0],r)===0?isNaN(this.prerelease[1])&&(this.prerelease=a):this.prerelease=a}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}};var ZS=R3;const kj=ZS,A3=(t,e,r)=>new kj(t,r).compare(new kj(e,r));var Tu=A3;const $3=Tu,I3=(t,e,r)=>$3(t,e,r)>0;var x3=I3;const D3=Tu,N3=(t,e,r)=>D3(t,e,r)<0;var z3=N3;const B3=Tu,U3=(t,e,r)=>B3(t,e,r)===0;var F3=U3;const L3=Tu,V3=(t,e,r)=>L3(t,e,r)!==0;var k3=V3;const H3=Tu,q3=(t,e,r)=>H3(t,e,r)>=0;var G3=q3;const W3=Tu,K3=(t,e,r)=>W3(t,e,r)<=0;var J3=K3;const X3=F3,Z3=k3,Y3=x3,Q3=G3,eV=z3,tV=J3,rV=(t,e,r,n)=>{switch(e){case"===":return typeof t=="object"&&(t=t.version),typeof r=="object"&&(r=r.version),t===r;case"!==":return typeof t=="object"&&(t=t.version),typeof r=="object"&&(r=r.version),t!==r;case"":case"=":case"==":return X3(t,r,n);case"!=":return Z3(t,r,n);case">":return Y3(t,r,n);case">=":return Q3(t,r,n);case"<":return eV(t,r,n);case"<=":return tV(t,r,n);default:throw new TypeError(`Invalid operator: ${e}`)}};var nV=rV;const{safeRe:BEe,t:UEe}=Zc;class iV{constructor(){this.max=1e3,this.map=new Map}get(e){const r=this.map.get(e);if(r!==void 0)return this.map.delete(e),this.map.set(e,r),r}delete(e){return this.map.delete(e)}set(e,r){if(!this.delete(e)&&r!==void 0){if(this.map.size>=this.max){const i=this.map.keys().next().value;this.delete(i)}this.map.set(e,r)}return this}}var aV=iV,Jv,Hj;function Un(){if(Hj)return Jv;Hj=1;const t=/\s+/g;class e{constructor(A,V){if(V=i(V),A instanceof e)return A.loose===!!V.loose&&A.includePrerelease===!!V.includePrerelease?A:new e(A.raw,V);if(A instanceof a)return this.raw=A.value,this.set=[[A]],this.formatted=void 0,this;if(this.options=V,this.loose=!!V.loose,this.includePrerelease=!!V.includePrerelease,this.raw=A.trim().replace(t," "),this.set=this.raw.split("||").map(G=>this.parseRange(G.trim())).filter(G=>G.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const G=this.set[0];if(this.set=this.set.filter(J=>!g(J[0])),this.set.length===0)this.set=[G];else if(this.set.length>1){for(const J of this.set)if(J.length===1&&v(J[0])){this.set=[J];break}}}this.formatted=void 0}get range(){if(this.formatted===void 0){this.formatted="";for(let A=0;A<this.set.length;A++){A>0&&(this.formatted+="||");const V=this.set[A];for(let G=0;G<V.length;G++)G>0&&(this.formatted+=" "),this.formatted+=V[G].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(A){const G=((this.options.includePrerelease&&p)|(this.options.loose&&b))+":"+A,J=n.get(G);if(J)return J;const H=this.options.loose,Y=H?l[c.HYPHENRANGELOOSE]:l[c.HYPHENRANGE];A=A.replace(Y,te(this.options.includePrerelease)),o("hyphen replace",A),A=A.replace(l[c.COMPARATORTRIM],d),o("comparator trim",A),A=A.replace(l[c.TILDETRIM],f),o("tilde trim",A),A=A.replace(l[c.CARETTRIM],h),o("caret trim",A);let Q=A.split(" ").map(Te=>C(Te,this.options)).join(" ").split(/\s+/).map(Te=>X(Te,this.options));H&&(Q=Q.filter(Te=>(o("loose invalid filter",Te,this.options),!!Te.match(l[c.COMPARATORLOOSE])))),o("range list",Q);const le=new Map,ne=Q.map(Te=>new a(Te,this.options));for(const Te of ne){if(g(Te))return[Te];le.set(Te.value,Te)}le.size>1&&le.has("")&&le.delete("");const Ce=[...le.values()];return n.set(G,Ce),Ce}intersects(A,V){if(!(A instanceof e))throw new TypeError("a Range is required");return this.set.some(G=>E(G,V)&&A.set.some(J=>E(J,V)&&G.every(H=>J.every(Y=>H.intersects(Y,V)))))}test(A){if(!A)return!1;if(typeof A=="string")try{A=new s(A,this.options)}catch{return!1}for(let V=0;V<this.set.length;V++)if(I(this.set[V],A,this.options))return!0;return!1}}Jv=e;const r=aV,n=new r,i=XS,a=Qy(),o=Yy,s=ZS,{safeRe:l,t:c,comparatorTrimReplace:d,tildeTrimReplace:f,caretTrimReplace:h}=Zc,{FLAG_INCLUDE_PRERELEASE:p,FLAG_LOOSE:b}=Zy,g=x=>x.value==="<0.0.0-0",v=x=>x.value==="",E=(x,A)=>{let V=!0;const G=x.slice();let J=G.pop();for(;V&&G.length;)V=G.every(H=>J.intersects(H,A)),J=G.pop();return V},C=(x,A)=>(o("comp",x,A),x=Z(x,A),o("caret",x),x=N(x,A),o("tildes",x),x=re(x,A),o("xrange",x),x=ee(x,A),o("stars",x),x),S=x=>!x||x.toLowerCase()==="x"||x==="*",N=(x,A)=>x.trim().split(/\s+/).map(V=>D(V,A)).join(" "),D=(x,A)=>{const V=A.loose?l[c.TILDELOOSE]:l[c.TILDE];return x.replace(V,(G,J,H,Y,Q)=>{o("tilde",x,G,J,H,Y,Q);let le;return S(J)?le="":S(H)?le=`>=${J}.0.0 <${+J+1}.0.0-0`:S(Y)?le=`>=${J}.${H}.0 <${J}.${+H+1}.0-0`:Q?(o("replaceTilde pr",Q),le=`>=${J}.${H}.${Y}-${Q} <${J}.${+H+1}.0-0`):le=`>=${J}.${H}.${Y} <${J}.${+H+1}.0-0`,o("tilde return",le),le})},Z=(x,A)=>x.trim().split(/\s+/).map(V=>se(V,A)).join(" "),se=(x,A)=>{o("caret",x,A);const V=A.loose?l[c.CARETLOOSE]:l[c.CARET],G=A.includePrerelease?"-0":"";return x.replace(V,(J,H,Y,Q,le)=>{o("caret",x,J,H,Y,Q,le);let ne;return S(H)?ne="":S(Y)?ne=`>=${H}.0.0${G} <${+H+1}.0.0-0`:S(Q)?H==="0"?ne=`>=${H}.${Y}.0${G} <${H}.${+Y+1}.0-0`:ne=`>=${H}.${Y}.0${G} <${+H+1}.0.0-0`:le?(o("replaceCaret pr",le),H==="0"?Y==="0"?ne=`>=${H}.${Y}.${Q}-${le} <${H}.${Y}.${+Q+1}-0`:ne=`>=${H}.${Y}.${Q}-${le} <${H}.${+Y+1}.0-0`:ne=`>=${H}.${Y}.${Q}-${le} <${+H+1}.0.0-0`):(o("no pr"),H==="0"?Y==="0"?ne=`>=${H}.${Y}.${Q}${G} <${H}.${Y}.${+Q+1}-0`:ne=`>=${H}.${Y}.${Q}${G} <${H}.${+Y+1}.0-0`:ne=`>=${H}.${Y}.${Q} <${+H+1}.0.0-0`),o("caret return",ne),ne})},re=(x,A)=>(o("replaceXRanges",x,A),x.split(/\s+/).map(V=>k(V,A)).join(" ")),k=(x,A)=>{x=x.trim();const V=A.loose?l[c.XRANGELOOSE]:l[c.XRANGE];return x.replace(V,(G,J,H,Y,Q,le)=>{o("xRange",x,G,J,H,Y,Q,le);const ne=S(H),Ce=ne||S(Y),Te=Ce||S(Q),Qe=Te;return J==="="&&Qe&&(J=""),le=A.includePrerelease?"-0":"",ne?J===">"||J==="<"?G="<0.0.0-0":G="*":J&&Qe?(Ce&&(Y=0),Q=0,J===">"?(J=">=",Ce?(H=+H+1,Y=0,Q=0):(Y=+Y+1,Q=0)):J==="<="&&(J="<",Ce?H=+H+1:Y=+Y+1),J==="<"&&(le="-0"),G=`${J+H}.${Y}.${Q}${le}`):Ce?G=`>=${H}.0.0${le} <${+H+1}.0.0-0`:Te&&(G=`>=${H}.${Y}.0${le} <${H}.${+Y+1}.0-0`),o("xRange return",G),G})},ee=(x,A)=>(o("replaceStars",x,A),x.trim().replace(l[c.STAR],"")),X=(x,A)=>(o("replaceGTE0",x,A),x.trim().replace(l[A.includePrerelease?c.GTE0PRE:c.GTE0],"")),te=x=>(A,V,G,J,H,Y,Q,le,ne,Ce,Te,Qe)=>(S(G)?V="":S(J)?V=`>=${G}.0.0${x?"-0":""}`:S(H)?V=`>=${G}.${J}.0${x?"-0":""}`:Y?V=`>=${V}`:V=`>=${V}${x?"-0":""}`,S(ne)?le="":S(Ce)?le=`<${+ne+1}.0.0-0`:S(Te)?le=`<${ne}.${+Ce+1}.0-0`:Qe?le=`<=${ne}.${Ce}.${Te}-${Qe}`:x?le=`<${ne}.${Ce}.${+Te+1}-0`:le=`<=${le}`,`${V} ${le}`.trim()),I=(x,A,V)=>{for(let G=0;G<x.length;G++)if(!x[G].test(A))return!1;if(A.prerelease.length&&!V.includePrerelease){for(let G=0;G<x.length;G++)if(o(x[G].semver),x[G].semver!==a.ANY&&x[G].semver.prerelease.length>0){const J=x[G].semver;if(J.major===A.major&&J.minor===A.minor&&J.patch===A.patch)return!0}return!1}return!0};return Jv}var Xv,qj;function Qy(){if(qj)return Xv;qj=1;const t=Symbol("SemVer ANY");class e{static get ANY(){return t}constructor(d,f){if(f=r(f),d instanceof e){if(d.loose===!!f.loose)return d;d=d.value}d=d.trim().split(/\s+/).join(" "),o("comparator",d,f),this.options=f,this.loose=!!f.loose,this.parse(d),this.semver===t?this.value="":this.value=this.operator+this.semver.version,o("comp",this)}parse(d){const f=this.options.loose?n[i.COMPARATORLOOSE]:n[i.COMPARATOR],h=d.match(f);if(!h)throw new TypeError(`Invalid comparator: ${d}`);this.operator=h[1]!==void 0?h[1]:"",this.operator==="="&&(this.operator=""),h[2]?this.semver=new s(h[2],this.options.loose):this.semver=t}toString(){return this.value}test(d){if(o("Comparator.test",d,this.options.loose),this.semver===t||d===t)return!0;if(typeof d=="string")try{d=new s(d,this.options)}catch{return!1}return a(d,this.operator,this.semver,this.options)}intersects(d,f){if(!(d instanceof e))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new l(d.value,f).test(this.value):d.operator===""?d.value===""?!0:new l(this.value,f).test(d.semver):(f=r(f),f.includePrerelease&&(this.value==="<0.0.0-0"||d.value==="<0.0.0-0")||!f.includePrerelease&&(this.value.startsWith("<0.0.0")||d.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&d.operator.startsWith(">")||this.operator.startsWith("<")&&d.operator.startsWith("<")||this.semver.version===d.semver.version&&this.operator.includes("=")&&d.operator.includes("=")||a(this.semver,"<",d.semver,f)&&this.operator.startsWith(">")&&d.operator.startsWith("<")||a(this.semver,">",d.semver,f)&&this.operator.startsWith("<")&&d.operator.startsWith(">")))}}Xv=e;const r=XS,{safeRe:n,t:i}=Zc,a=nV,o=Yy,s=ZS,l=Un();return Xv}Un();Un();Un();Un();Un();Un();const oV=Qy(),{ANY:FEe}=oV;Un();Un();Un();const YS=Qy(),{ANY:LEe}=YS;new YS(">=0.0.0-0");new YS(">=0.0.0");const Zv=Zc,Gj=Zy,Wj=D$;Qy();Un();Zv.re,Zv.src,Zv.t,Gj.SEMVER_SPEC_VERSION,Gj.RELEASE_TYPES,Wj.compareIdentifiers,Wj.rcompareIdentifiers;function Xi(t){if(!t||t.split("/").length>2||t.startsWith("/")||t.endsWith("/")||t.split(":").length>2)throw new Error(`Invalid identifier format: ${t}`);const[e,r]=t.split(":"),n=r||"latest";if(e.includes("/")){const[i,a]=e.split("/",2);if(!i||!a)throw new Error(`Invalid identifier format: ${t}`);return[i,a,n]}else{if(!e)throw new Error(`Invalid identifier format: ${t}`);return["-",e,n]}}class sV extends Error{constructor(e){super(e),this.name="LangSmithConflictError"}}async function Ve(t,e,r){let n;if(t.ok){r&&(n=await t.text());return}n=await t.text();const i=`Failed to ${e}. Received status [${t.status}]: ${t.statusText}. Server response: ${n}`;throw t.status===409?new sV(i):new Error(i)}var Kj="[...]",uV={result:"[Circular]"},ny=[],As=[];const lV=new TextEncoder;function cV(){return{depthLimit:Number.MAX_SAFE_INTEGER,edgesLimit:Number.MAX_SAFE_INTEGER}}function Pp(t){return lV.encode(t)}function Lr(t,e,r,n){try{const i=JSON.stringify(t,e,r);return Pp(i)}catch(i){if(!i.message?.includes("Converting circular structure to JSON"))return console.warn("[WARNING]: LangSmith received unserializable value."),Pp("[Unserializable]");console.warn("[WARNING]: LangSmith received circular JSON. This will decrease tracer performance."),typeof n>"u"&&(n=cV()),wO(t,"",0,[],void 0,0,n);let a;try{As.length===0?a=JSON.stringify(t,e,r):a=JSON.stringify(t,dV(e),r)}catch{return Pp("[unable to serialize, circular reference is too complex to analyze]")}finally{for(;ny.length!==0;){const o=ny.pop();o.length===4?Object.defineProperty(o[0],o[1],o[3]):o[0][o[1]]=o[2]}}return Pp(a)}}function Yv(t,e,r,n){var i=Object.getOwnPropertyDescriptor(n,r);i.get!==void 0?i.configurable?(Object.defineProperty(n,r,{value:t}),ny.push([n,r,e,i])):As.push([e,r,t]):(n[r]=t,ny.push([n,r,e]))}function wO(t,e,r,n,i,a,o){a+=1;var s;if(typeof t=="object"&&t!==null){for(s=0;s<n.length;s++)if(n[s]===t){Yv(uV,t,e,i);return}if(typeof o.depthLimit<"u"&&a>o.depthLimit){Yv(Kj,t,e,i);return}if(typeof o.edgesLimit<"u"&&r+1>o.edgesLimit){Yv(Kj,t,e,i);return}if(n.push(t),Array.isArray(t))for(s=0;s<t.length;s++)wO(t[s],s,s,n,t,a,o);else{var l=Object.keys(t);for(s=0;s<l.length;s++){var c=l[s];wO(t[c],c,s,n,t,a,o)}}n.pop()}}function dV(t){return t=typeof t<"u"?t:function(e,r){return r},function(e,r){if(As.length>0)for(var n=0;n<As.length;n++){var i=As[n];if(i[1]===e&&i[0]===r){r=i[2],As.splice(n,1);break}}return t.call(this,e,r)}}function Jj(t){const e=U$(),r=EV(),n=t.extra??{},i=n.metadata;return t.extra={...n,runtime:{...e,...n?.runtime},metadata:{...r,...r.revision_id||t.revision_id?{revision_id:t.revision_id??r.revision_id}:{},...i}},t}const fV=t=>{const e=t?.toString()??pa("TRACING_SAMPLING_RATE");if(e===void 0)return;const r=parseFloat(e);if(r<0||r>1)throw new Error(`LANGSMITH_TRACING_SAMPLING_RATE must be between 0 and 1 if set. Got: ${r}`);return r},hV=t=>{const r=t.replace("http://","").replace("https://","").split("/")[0].split(":")[0];return r==="localhost"||r==="127.0.0.1"||r==="::1"};async function pV(t){const e=[];for await(const r of t)e.push(r);return e}function Qv(t){if(t!==void 0)return t.trim().replace(/^"(.*)"$/,"$1").replace(/^'(.*)'$/,"$1")}const _V=async t=>{if(t?.status===429){const e=parseInt(t.headers.get("retry-after")??"30",10)*1e3;if(e>0)return await new Promise(r=>setTimeout(r,e)),!0}return!1};function Xj(t){return typeof t=="number"?Number(t.toFixed(4)):t}class yV{constructor(){Object.defineProperty(this,"items",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"sizeBytes",{enumerable:!0,configurable:!0,writable:!0,value:0})}peek(){return this.items[0]}push(e){let r;const n=new Promise(a=>{r=a}),i=Lr(e.item).length;return this.items.push({action:e.action,payload:e.item,itemPromiseResolve:r,itemPromise:n,size:i}),this.sizeBytes+=i,n}pop(e){if(e<1)throw new Error("Number of bytes to pop off may not be less than 1.");const r=[];let n=0;for(;n+(this.peek()?.size??0)<e&&this.items.length>0;){const i=this.items.shift();i&&(r.push(i),n+=i.size,this.sizeBytes-=i.size)}if(r.length===0&&this.items.length>0){const i=this.items.shift();r.push(i),n+=i.size,this.sizeBytes-=i.size}return[r.map(i=>({action:i.action,item:i.payload})),()=>r.forEach(i=>i.itemPromiseResolve())]}}const bV=20971520,gV=2500;let N$=class OO{constructor(e={}){Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiUrl",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"webUrl",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"caller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"batchIngestCaller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"timeout_ms",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_tenantId",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"hideInputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"hideOutputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tracingSampleRate",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"filteredPostUuids",{enumerable:!0,configurable:!0,writable:!0,value:new Set}),Object.defineProperty(this,"autoBatchTracing",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"autoBatchQueue",{enumerable:!0,configurable:!0,writable:!0,value:new yV}),Object.defineProperty(this,"autoBatchTimeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"autoBatchAggregationDelayMs",{enumerable:!0,configurable:!0,writable:!0,value:250}),Object.defineProperty(this,"batchSizeBytesLimit",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fetchOptions",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"settings",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"blockOnRootRunFinalization",{enumerable:!0,configurable:!0,writable:!0,value:fo("LANGSMITH_TRACING_BACKGROUND")==="false"}),Object.defineProperty(this,"traceBatchConcurrency",{enumerable:!0,configurable:!0,writable:!0,value:5}),Object.defineProperty(this,"_serverInfo",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_getServerInfoPromise",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"manualFlushMode",{enumerable:!0,configurable:!0,writable:!0,value:!1});const r=OO.getDefaultClientConfig();if(this.tracingSampleRate=fV(e.tracingSamplingRate),this.apiUrl=Qv(e.apiUrl??r.apiUrl)??"",this.apiUrl.endsWith("/")&&(this.apiUrl=this.apiUrl.slice(0,-1)),this.apiKey=Qv(e.apiKey??r.apiKey),this.webUrl=Qv(e.webUrl??r.webUrl),this.webUrl?.endsWith("/")&&(this.webUrl=this.webUrl.slice(0,-1)),this.timeout_ms=e.timeout_ms??9e4,this.caller=new Dj(e.callerOptions??{}),this.traceBatchConcurrency=e.traceBatchConcurrency??this.traceBatchConcurrency,this.traceBatchConcurrency<1)throw new Error("Trace batch concurrency must be positive.");this.batchIngestCaller=new Dj({maxRetries:2,maxConcurrency:this.traceBatchConcurrency,...e.callerOptions??{},onFailedResponseHook:_V}),this.hideInputs=e.hideInputs??e.anonymizer??r.hideInputs,this.hideOutputs=e.hideOutputs??e.anonymizer??r.hideOutputs,this.autoBatchTracing=e.autoBatchTracing??this.autoBatchTracing,this.blockOnRootRunFinalization=e.blockOnRootRunFinalization??this.blockOnRootRunFinalization,this.batchSizeBytesLimit=e.batchSizeBytesLimit,this.fetchOptions=e.fetchOptions||{},this.manualFlushMode=e.manualFlushMode??this.manualFlushMode}static getDefaultClientConfig(){const e=pa("API_KEY"),r=pa("ENDPOINT")??"https://api.smith.langchain.com",n=pa("HIDE_INPUTS")==="true",i=pa("HIDE_OUTPUTS")==="true";return{apiUrl:r,apiKey:e,webUrl:void 0,hideInputs:n,hideOutputs:i}}getHostUrl(){return this.webUrl?this.webUrl:hV(this.apiUrl)?(this.webUrl="http://localhost:3000",this.webUrl):this.apiUrl.endsWith("/api/v1")?(this.webUrl=this.apiUrl.replace("/api/v1",""),this.webUrl):this.apiUrl.includes("/api")&&!this.apiUrl.split(".",1)[0].endsWith("api")?(this.webUrl=this.apiUrl.replace("/api",""),this.webUrl):this.apiUrl.split(".",1)[0].includes("dev")?(this.webUrl="https://dev.smith.langchain.com",this.webUrl):this.apiUrl.split(".",1)[0].includes("eu")?(this.webUrl="https://eu.smith.langchain.com",this.webUrl):this.apiUrl.split(".",1)[0].includes("beta")?(this.webUrl="https://beta.smith.langchain.com",this.webUrl):(this.webUrl="https://smith.langchain.com",this.webUrl)}get headers(){const e={"User-Agent":`langsmith-js/${z$}`};return this.apiKey&&(e["x-api-key"]=`${this.apiKey}`),e}processInputs(e){return this.hideInputs===!1?e:this.hideInputs===!0?{}:typeof this.hideInputs=="function"?this.hideInputs(e):e}processOutputs(e){return this.hideOutputs===!1?e:this.hideOutputs===!0?{}:typeof this.hideOutputs=="function"?this.hideOutputs(e):e}prepareRunCreateOrUpdateInputs(e){const r={...e};return r.inputs!==void 0&&(r.inputs=this.processInputs(r.inputs)),r.outputs!==void 0&&(r.outputs=this.processOutputs(r.outputs)),r}async _getResponse(e,r){const n=r?.toString()??"",i=`${this.apiUrl}${e}?${n}`,a=await this.caller.call(Oe(),i,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Ve(a,`Failed to fetch ${e}`),a}async _get(e,r){return(await this._getResponse(e,r)).json()}async*_getPaginated(e,r=new URLSearchParams,n){let i=Number(r.get("offset"))||0;const a=Number(r.get("limit"))||100;for(;;){r.set("offset",String(i)),r.set("limit",String(a));const o=`${this.apiUrl}${e}?${r}`,s=await this.caller.call(Oe(),o,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Ve(s,`Failed to fetch ${e}`);const l=n?n(await s.json()):await s.json();if(l.length===0||(yield l,l.length<a))break;i+=l.length}}async*_getCursorPaginatedList(e,r=null,n="POST",i="runs"){const a=r?{...r}:{};for(;;){const s=await(await this.caller.call(Oe(),`${this.apiUrl}${e}`,{method:n,headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:JSON.stringify(a)})).json();if(!s||!s[i])break;yield s[i];const l=s.cursors;if(!l||!l.next)break;a.cursor=l.next}}_shouldSample(){return this.tracingSampleRate===void 0?!0:Math.random()<this.tracingSampleRate}_filterForSampling(e,r=!1){if(this.tracingSampleRate===void 0)return e;if(r){const n=[];for(const i of e)this.filteredPostUuids.has(i.id)?this.filteredPostUuids.delete(i.id):n.push(i);return n}else{const n=[];for(const i of e){const a=i.trace_id??i.id;this.filteredPostUuids.has(a)||(i.id===a?this._shouldSample()?n.push(i):this.filteredPostUuids.add(a):n.push(i))}return n}}async _getBatchSizeLimitBytes(){const e=await this._ensureServerInfo();return this.batchSizeBytesLimit??e.batch_ingest_config?.size_limit_bytes??bV}async _getMultiPartSupport(){return(await this._ensureServerInfo()).instance_flags?.dataset_examples_multipart_enabled??!1}drainAutoBatchQueue(e){const r=[];for(;this.autoBatchQueue.items.length>0;){const[n,i]=this.autoBatchQueue.pop(e);if(!n.length){i();break}const a=this._processBatch(n,i).catch(console.error);r.push(a)}return Promise.all(r)}async _processBatch(e,r){if(!e.length){r();return}try{const n={runCreates:e.filter(a=>a.action==="create").map(a=>a.item),runUpdates:e.filter(a=>a.action==="update").map(a=>a.item)};(await this._ensureServerInfo())?.batch_ingest_config?.use_multipart_endpoint?await this.multipartIngestRuns(n):await this.batchIngestRuns(n)}finally{r()}}async processRunOperation(e){clearTimeout(this.autoBatchTimeout),this.autoBatchTimeout=void 0,e.action==="create"&&(e.item=Jj(e.item));const r=this.autoBatchQueue.push(e);if(this.manualFlushMode)return r;const n=await this._getBatchSizeLimitBytes();return this.autoBatchQueue.sizeBytes>n&&this.drainAutoBatchQueue(n),this.autoBatchQueue.items.length>0&&(this.autoBatchTimeout=setTimeout(()=>{this.autoBatchTimeout=void 0,this.drainAutoBatchQueue(n)},this.autoBatchAggregationDelayMs)),r}async _getServerInfo(){const e=await Oe()(`${this.apiUrl}/info`,{method:"GET",headers:{Accept:"application/json"},signal:AbortSignal.timeout(gV),...this.fetchOptions});return await Ve(e,"get server info"),e.json()}async _ensureServerInfo(){return this._getServerInfoPromise===void 0&&(this._getServerInfoPromise=(async()=>{if(this._serverInfo===void 0)try{this._serverInfo=await this._getServerInfo()}catch{console.warn("[WARNING]: LangSmith failed to fetch info on supported operations. Falling back to batch operations and default limits.")}return this._serverInfo??{}})()),this._getServerInfoPromise.then(e=>(this._serverInfo===void 0&&(this._getServerInfoPromise=void 0),e))}async _getSettings(){return this.settings||(this.settings=this._get("/settings")),await this.settings}async flush(){const e=await this._getBatchSizeLimitBytes();await this.drainAutoBatchQueue(e)}async createRun(e){if(!this._filterForSampling([e]).length)return;const r={...this.headers,"Content-Type":"application/json"},n=e.project_name;delete e.project_name;const i=this.prepareRunCreateOrUpdateInputs({session_name:n,...e,start_time:e.start_time??Date.now()});if(this.autoBatchTracing&&i.trace_id!==void 0&&i.dotted_order!==void 0){this.processRunOperation({action:"create",item:i}).catch(console.error);return}const a=Jj(i),o=await this.caller.call(Oe(),`${this.apiUrl}/runs`,{method:"POST",headers:r,body:Lr(a),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Ve(o,"create run",!0)}async batchIngestRuns({runCreates:e,runUpdates:r}){if(e===void 0&&r===void 0)return;let n=e?.map(s=>this.prepareRunCreateOrUpdateInputs(s))??[],i=r?.map(s=>this.prepareRunCreateOrUpdateInputs(s))??[];if(n.length>0&&i.length>0){const s=n.reduce((c,d)=>(d.id&&(c[d.id]=d),c),{}),l=[];for(const c of i)c.id!==void 0&&s[c.id]?s[c.id]={...s[c.id],...c}:l.push(c);n=Object.values(s),i=l}const a={post:n,patch:i};if(!a.post.length&&!a.patch.length)return;const o={post:[],patch:[]};for(const s of["post","patch"]){const l=s,c=a[l].reverse();let d=c.pop();for(;d!==void 0;)o[l].push(d),d=c.pop()}(o.post.length>0||o.patch.length>0)&&await this._postBatchIngestRuns(Lr(o))}async _postBatchIngestRuns(e){const r={...this.headers,"Content-Type":"application/json",Accept:"application/json"},n=await this.batchIngestCaller.call(Oe(),`${this.apiUrl}/runs/batch`,{method:"POST",headers:r,body:e,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Ve(n,"batch create run",!0)}async multipartIngestRuns({runCreates:e,runUpdates:r}){if(e===void 0&&r===void 0)return;const n={};let i=[];for(const d of e??[]){const f=this.prepareRunCreateOrUpdateInputs(d);f.id!==void 0&&f.attachments!==void 0&&(n[f.id]=f.attachments),delete f.attachments,i.push(f)}let a=[];for(const d of r??[])a.push(this.prepareRunCreateOrUpdateInputs(d));if(i.find(d=>d.trace_id===void 0||d.dotted_order===void 0)!==void 0)throw new Error('Multipart ingest requires "trace_id" and "dotted_order" to be set when creating a run');if(a.find(d=>d.trace_id===void 0||d.dotted_order===void 0)!==void 0)throw new Error('Multipart ingest requires "trace_id" and "dotted_order" to be set when updating a run');if(i.length>0&&a.length>0){const d=i.reduce((h,p)=>(p.id&&(h[p.id]=p),h),{}),f=[];for(const h of a)h.id!==void 0&&d[h.id]?d[h.id]={...d[h.id],...h}:f.push(h);i=Object.values(d),a=f}if(i.length===0&&a.length===0)return;const l=[],c=[];for(const[d,f]of[["post",i],["patch",a]])for(const h of f){const{inputs:p,outputs:b,events:g,attachments:v,...E}=h,C={inputs:p,outputs:b,events:g},S=Lr(E);c.push({name:`${d}.${E.id}`,payload:new Blob([S],{type:`application/json; length=${S.length}`})});for(const[N,D]of Object.entries(C)){if(D===void 0)continue;const Z=Lr(D);c.push({name:`${d}.${E.id}.${N}`,payload:new Blob([Z],{type:`application/json; length=${Z.length}`})})}if(E.id!==void 0){const N=n[E.id];if(N){delete n[E.id];for(const[D,Z]of Object.entries(N)){let se,re;if(Array.isArray(Z)?[se,re]=Z:(se=Z.mimeType,re=Z.data),D.includes(".")){console.warn(`Skipping attachment '${D}' for run ${E.id}: Invalid attachment name. Attachment names must not contain periods ('.'). Please rename the attachment and try again.`);continue}c.push({name:`attachment.${E.id}.${D}`,payload:new Blob([re],{type:`${se}; length=${re.byteLength}`})})}}}l.push(`trace=${E.trace_id},id=${E.id}`)}await this._sendMultipartRequest(c,l.join("; "))}async _sendMultipartRequest(e,r){try{const n="----LangSmithFormBoundary"+Math.random().toString(36).slice(2),i=[];for(const l of e)i.push(new Blob([`--${n}\r
`])),i.push(new Blob([`Content-Disposition: form-data; name="${l.name}"\r
`,`Content-Type: ${l.payload.type}\r
\r
`])),i.push(l.payload),i.push(new Blob([`\r
`]));i.push(new Blob([`--${n}--\r
`]));const o=await new Blob(i).arrayBuffer(),s=await this.batchIngestCaller.call(Oe(),`${this.apiUrl}/runs/multipart`,{method:"POST",headers:{...this.headers,"Content-Type":`multipart/form-data; boundary=${n}`},body:o,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Ve(s,"ingest multipart runs",!0)}catch(n){console.warn(`${n.message.trim()}

Context: ${r}`)}}async updateRun(e,r){xe(e),r.inputs&&(r.inputs=this.processInputs(r.inputs)),r.outputs&&(r.outputs=this.processOutputs(r.outputs));const n={...r,id:e};if(!this._filterForSampling([n],!0).length)return;if(this.autoBatchTracing&&n.trace_id!==void 0&&n.dotted_order!==void 0){if(r.end_time!==void 0&&n.parent_run_id===void 0&&this.blockOnRootRunFinalization&&!this.manualFlushMode){await this.processRunOperation({action:"update",item:n}).catch(console.error);return}else this.processRunOperation({action:"update",item:n}).catch(console.error);return}const i={...this.headers,"Content-Type":"application/json"},a=await this.caller.call(Oe(),`${this.apiUrl}/runs/${e}`,{method:"PATCH",headers:i,body:Lr(r),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Ve(a,"update run",!0)}async readRun(e,{loadChildRuns:r}={loadChildRuns:!1}){xe(e);let n=await this._get(`/runs/${e}`);return r&&n.child_run_ids&&(n=await this._loadChildRuns(n)),n}async getRunUrl({runId:e,run:r,projectOpts:n}){if(r!==void 0){let i;r.session_id?i=r.session_id:n?.projectName?i=(await this.readProject({projectName:n?.projectName})).id:n?.projectId?i=n?.projectId:i=(await this.readProject({projectName:pa("PROJECT")||"default"})).id;const a=await this._getTenantId();return`${this.getHostUrl()}/o/${a}/projects/p/${i}/r/${r.id}?poll=true`}else if(e!==void 0){const i=await this.readRun(e);if(!i.app_path)throw new Error(`Run ${e} has no app_path`);return`${this.getHostUrl()}${i.app_path}`}else throw new Error("Must provide either runId or run")}async _loadChildRuns(e){const r=await pV(this.listRuns({id:e.child_run_ids})),n={},i={};r.sort((a,o)=>(a?.dotted_order??"").localeCompare(o?.dotted_order??""));for(const a of r){if(a.parent_run_id===null||a.parent_run_id===void 0)throw new Error(`Child run ${a.id} has no parent`);a.parent_run_id in n||(n[a.parent_run_id]=[]),n[a.parent_run_id].push(a),i[a.id]=a}e.child_runs=n[e.id]||[];for(const a in n)a!==e.id&&(i[a].child_runs=n[a]);return e}async*listRuns(e){const{projectId:r,projectName:n,parentRunId:i,traceId:a,referenceExampleId:o,startTime:s,executionOrder:l,isRoot:c,runType:d,error:f,id:h,query:p,filter:b,traceFilter:g,treeFilter:v,limit:E,select:C}=e;let S=[];if(r&&(S=Array.isArray(r)?r:[r]),n){const se=Array.isArray(n)?n:[n],re=await Promise.all(se.map(k=>this.readProject({projectName:k}).then(ee=>ee.id)));S.push(...re)}const N=["app_path","child_run_ids","completion_cost","completion_tokens","dotted_order","end_time","error","events","extra","feedback_stats","first_token_time","id","inputs","name","outputs","parent_run_id","parent_run_ids","prompt_cost","prompt_tokens","reference_example_id","run_type","session_id","start_time","status","tags","total_cost","total_tokens","trace_id"],D={session:S.length?S:null,run_type:d,reference_example:o,query:p,filter:b,trace_filter:g,tree_filter:v,execution_order:l,parent_run:i,start_time:s?s.toISOString():null,error:f,id:h,limit:E,trace:a,select:C||N,is_root:c};let Z=0;for await(const se of this._getCursorPaginatedList("/runs/query",D))if(E){if(Z>=E)break;if(se.length+Z>E){yield*se.slice(0,E-Z);break}Z+=se.length,yield*se}else yield*se}async getRunStats({id:e,trace:r,parentRun:n,runType:i,projectNames:a,projectIds:o,referenceExampleIds:s,startTime:l,endTime:c,error:d,query:f,filter:h,traceFilter:p,treeFilter:b,isRoot:g,dataSourceType:v}){let E=o||[];a&&(E=[...o||[],...await Promise.all(a.map(Z=>this.readProject({projectName:Z}).then(se=>se.id)))]);const S=Object.fromEntries(Object.entries({id:e,trace:r,parent_run:n,run_type:i,session:E,reference_example:s,start_time:l,end_time:c,error:d,query:f,filter:h,trace_filter:p,tree_filter:b,is_root:g,data_source_type:v}).filter(([Z,se])=>se!==void 0));return await(await this.caller.call(Oe(),`${this.apiUrl}/runs/stats`,{method:"POST",headers:this.headers,body:JSON.stringify(S),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json()}async shareRun(e,{shareId:r}={}){const n={run_id:e,share_token:r||lr()};xe(e);const a=await(await this.caller.call(Oe(),`${this.apiUrl}/runs/${e}/share`,{method:"PUT",headers:this.headers,body:JSON.stringify(n),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json();if(a===null||!("share_token"in a))throw new Error("Invalid response from server");return`${this.getHostUrl()}/public/${a.share_token}/r`}async unshareRun(e){xe(e);const r=await this.caller.call(Oe(),`${this.apiUrl}/runs/${e}/share`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Ve(r,"unshare run",!0)}async readRunSharedLink(e){xe(e);const n=await(await this.caller.call(Oe(),`${this.apiUrl}/runs/${e}/share`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json();if(!(n===null||!("share_token"in n)))return`${this.getHostUrl()}/public/${n.share_token}/r`}async listSharedRuns(e,{runIds:r}={}){const n=new URLSearchParams({share_token:e});if(r!==void 0)for(const o of r)n.append("id",o);return xe(e),await(await this.caller.call(Oe(),`${this.apiUrl}/public/${e}/runs${n}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json()}async readDatasetSharedSchema(e,r){if(!e&&!r)throw new Error("Either datasetId or datasetName must be given");e||(e=(await this.readDataset({datasetName:r})).id),xe(e);const i=await(await this.caller.call(Oe(),`${this.apiUrl}/datasets/${e}/share`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json();return i.url=`${this.getHostUrl()}/public/${i.share_token}/d`,i}async shareDataset(e,r){if(!e&&!r)throw new Error("Either datasetId or datasetName must be given");e||(e=(await this.readDataset({datasetName:r})).id);const n={dataset_id:e};xe(e);const a=await(await this.caller.call(Oe(),`${this.apiUrl}/datasets/${e}/share`,{method:"PUT",headers:this.headers,body:JSON.stringify(n),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json();return a.url=`${this.getHostUrl()}/public/${a.share_token}/d`,a}async unshareDataset(e){xe(e);const r=await this.caller.call(Oe(),`${this.apiUrl}/datasets/${e}/share`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Ve(r,"unshare dataset",!0)}async readSharedDataset(e){return xe(e),await(await this.caller.call(Oe(),`${this.apiUrl}/public/${e}/datasets`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json()}async listSharedExamples(e,r){const n={};r?.exampleIds&&(n.id=r.exampleIds);const i=new URLSearchParams;Object.entries(n).forEach(([s,l])=>{Array.isArray(l)?l.forEach(c=>i.append(s,c)):i.append(s,l)});const a=await this.caller.call(Oe(),`${this.apiUrl}/public/${e}/examples?${i.toString()}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions}),o=await a.json();if(!a.ok)throw"detail"in o?new Error(`Failed to list shared examples.
Status: ${a.status}
Message: ${o.detail.join(`
`)}`):new Error(`Failed to list shared examples: ${a.status} ${a.statusText}`);return o.map(s=>({...s,_hostUrl:this.getHostUrl()}))}async createProject({projectName:e,description:r=null,metadata:n=null,upsert:i=!1,projectExtra:a=null,referenceDatasetId:o=null}){const s=i?"?upsert=true":"",l=`${this.apiUrl}/sessions${s}`,c=a||{};n&&(c.metadata=n);const d={name:e,extra:c,description:r};o!==null&&(d.reference_dataset_id=o);const f=await this.caller.call(Oe(),l,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(d),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Ve(f,"create project"),await f.json()}async updateProject(e,{name:r=null,description:n=null,metadata:i=null,projectExtra:a=null,endTime:o=null}){const s=`${this.apiUrl}/sessions/${e}`;let l=a;i&&(l={...l||{},metadata:i});const c={name:r,extra:l,description:n,end_time:o?new Date(o).toISOString():null},d=await this.caller.call(Oe(),s,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(c),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Ve(d,"update project"),await d.json()}async hasProject({projectId:e,projectName:r}){let n="/sessions";const i=new URLSearchParams;if(e!==void 0&&r!==void 0)throw new Error("Must provide either projectName or projectId, not both");if(e!==void 0)xe(e),n+=`/${e}`;else if(r!==void 0)i.append("name",r);else throw new Error("Must provide projectName or projectId");const a=await this.caller.call(Oe(),`${this.apiUrl}${n}?${i}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});try{const o=await a.json();return a.ok?Array.isArray(o)?o.length>0:!0:!1}catch{return!1}}async readProject({projectId:e,projectName:r,includeStats:n}){let i="/sessions";const a=new URLSearchParams;if(e!==void 0&&r!==void 0)throw new Error("Must provide either projectName or projectId, not both");if(e!==void 0)xe(e),i+=`/${e}`;else if(r!==void 0)a.append("name",r);else throw new Error("Must provide projectName or projectId");n!==void 0&&a.append("include_stats",n.toString());const o=await this._get(i,a);let s;if(Array.isArray(o)){if(o.length===0)throw new Error(`Project[id=${e}, name=${r}] not found`);s=o[0]}else s=o;return s}async getProjectUrl({projectId:e,projectName:r}){if(e===void 0&&r===void 0)throw new Error("Must provide either projectName or projectId");const n=await this.readProject({projectId:e,projectName:r}),i=await this._getTenantId();return`${this.getHostUrl()}/o/${i}/projects/p/${n.id}`}async getDatasetUrl({datasetId:e,datasetName:r}){if(e===void 0&&r===void 0)throw new Error("Must provide either datasetName or datasetId");const n=await this.readDataset({datasetId:e,datasetName:r}),i=await this._getTenantId();return`${this.getHostUrl()}/o/${i}/datasets/${n.id}`}async _getTenantId(){if(this._tenantId!==null)return this._tenantId;const e=new URLSearchParams({limit:"1"});for await(const r of this._getPaginated("/sessions",e))return this._tenantId=r[0].tenant_id,r[0].tenant_id;throw new Error("No projects found to resolve tenant.")}async*listProjects({projectIds:e,name:r,nameContains:n,referenceDatasetId:i,referenceDatasetName:a,referenceFree:o,metadata:s}={}){const l=new URLSearchParams;if(e!==void 0)for(const c of e)l.append("id",c);if(r!==void 0&&l.append("name",r),n!==void 0&&l.append("name_contains",n),i!==void 0)l.append("reference_dataset",i);else if(a!==void 0){const c=await this.readDataset({datasetName:a});l.append("reference_dataset",c.id)}o!==void 0&&l.append("reference_free",o.toString()),s!==void 0&&l.append("metadata",JSON.stringify(s));for await(const c of this._getPaginated("/sessions",l))yield*c}async deleteProject({projectId:e,projectName:r}){let n;if(e===void 0&&r===void 0)throw new Error("Must provide projectName or projectId");if(e!==void 0&&r!==void 0)throw new Error("Must provide either projectName or projectId, not both");e===void 0?n=(await this.readProject({projectName:r})).id:n=e,xe(n);const i=await this.caller.call(Oe(),`${this.apiUrl}/sessions/${n}`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Ve(i,`delete session ${n} (${r})`,!0)}async uploadCsv({csvFile:e,fileName:r,inputKeys:n,outputKeys:i,description:a,dataType:o,name:s}){const l=`${this.apiUrl}/datasets/upload`,c=new FormData;c.append("file",e,r),n.forEach(h=>{c.append("input_keys",h)}),i.forEach(h=>{c.append("output_keys",h)}),a&&c.append("description",a),o&&c.append("data_type",o),s&&c.append("name",s);const d=await this.caller.call(Oe(),l,{method:"POST",headers:this.headers,body:c,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Ve(d,"upload CSV"),await d.json()}async createDataset(e,{description:r,dataType:n,inputsSchema:i,outputsSchema:a,metadata:o}={}){const s={name:e,description:r,extra:o?{metadata:o}:void 0};n&&(s.data_type=n),i&&(s.inputs_schema_definition=i),a&&(s.outputs_schema_definition=a);const l=await this.caller.call(Oe(),`${this.apiUrl}/datasets`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(s),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Ve(l,"create dataset"),await l.json()}async readDataset({datasetId:e,datasetName:r}){let n="/datasets";const i=new URLSearchParams({limit:"1"});if(e!==void 0&&r!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");if(e!==void 0)xe(e),n+=`/${e}`;else if(r!==void 0)i.append("name",r);else throw new Error("Must provide datasetName or datasetId");const a=await this._get(n,i);let o;if(Array.isArray(a)){if(a.length===0)throw new Error(`Dataset[id=${e}, name=${r}] not found`);o=a[0]}else o=a;return o}async hasDataset({datasetId:e,datasetName:r}){try{return await this.readDataset({datasetId:e,datasetName:r}),!0}catch(n){if(n instanceof Error&&n.message.toLocaleLowerCase().includes("not found"))return!1;throw n}}async diffDatasetVersions({datasetId:e,datasetName:r,fromVersion:n,toVersion:i}){let a=e;if(a===void 0&&r===void 0)throw new Error("Must provide either datasetName or datasetId");if(a!==void 0&&r!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");a===void 0&&(a=(await this.readDataset({datasetName:r})).id);const o=new URLSearchParams({from_version:typeof n=="string"?n:n.toISOString(),to_version:typeof i=="string"?i:i.toISOString()});return await this._get(`/datasets/${a}/versions/diff`,o)}async readDatasetOpenaiFinetuning({datasetId:e,datasetName:r}){const n="/datasets";if(e===void 0)if(r!==void 0)e=(await this.readDataset({datasetName:r})).id;else throw new Error("Must provide either datasetName or datasetId");return(await(await this._getResponse(`${n}/${e}/openai_ft`)).text()).trim().split(`
`).map(s=>JSON.parse(s))}async*listDatasets({limit:e=100,offset:r=0,datasetIds:n,datasetName:i,datasetNameContains:a,metadata:o}={}){const s="/datasets",l=new URLSearchParams({limit:e.toString(),offset:r.toString()});if(n!==void 0)for(const c of n)l.append("id",c);i!==void 0&&l.append("name",i),a!==void 0&&l.append("name_contains",a),o!==void 0&&l.append("metadata",JSON.stringify(o));for await(const c of this._getPaginated(s,l))yield*c}async updateDataset(e){const{datasetId:r,datasetName:n,...i}=e;if(!r&&!n)throw new Error("Must provide either datasetName or datasetId");const a=r??(await this.readDataset({datasetName:n})).id;xe(a);const o=await this.caller.call(Oe(),`${this.apiUrl}/datasets/${a}`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(i),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Ve(o,"update dataset"),await o.json()}async updateDatasetTag(e){const{datasetId:r,datasetName:n,asOf:i,tag:a}=e;if(!r&&!n)throw new Error("Must provide either datasetName or datasetId");const o=r??(await this.readDataset({datasetName:n})).id;xe(o);const s=await this.caller.call(Oe(),`${this.apiUrl}/datasets/${o}/tags`,{method:"PUT",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify({as_of:typeof i=="string"?i:i.toISOString(),tag:a}),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Ve(s,"update dataset tags")}async deleteDataset({datasetId:e,datasetName:r}){let n="/datasets",i=e;if(e!==void 0&&r!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");if(r!==void 0&&(i=(await this.readDataset({datasetName:r})).id),i!==void 0)xe(i),n+=`/${i}`;else throw new Error("Must provide datasetName or datasetId");const a=await this.caller.call(Oe(),this.apiUrl+n,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Ve(a,`delete ${n}`),await a.json()}async indexDataset({datasetId:e,datasetName:r,tag:n}){let i=e;if(!i&&!r)throw new Error("Must provide either datasetName or datasetId");if(i&&r)throw new Error("Must provide either datasetName or datasetId, not both");i||(i=(await this.readDataset({datasetName:r})).id),xe(i);const a={tag:n},o=await this.caller.call(Oe(),`${this.apiUrl}/datasets/${i}/index`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(a),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Ve(o,"index dataset"),await o.json()}async similarExamples(e,r,n,{filter:i}={}){const a={limit:n,inputs:e};i!==void 0&&(a.filter=i),xe(r);const o=await this.caller.call(Oe(),`${this.apiUrl}/datasets/${r}/search`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(a),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Ve(o,"fetch similar examples"),(await o.json()).examples}async createExample(e,r,n){if(Zj(e)&&(r!==void 0||n!==void 0))throw new Error("Cannot provide outputs or options when using ExampleCreate object");let i=r?n?.datasetId:e.dataset_id;const a=r?n?.datasetName:e.dataset_name;if(i===void 0&&a===void 0)throw new Error("Must provide either datasetName or datasetId");if(i!==void 0&&a!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");i===void 0&&(i=(await this.readDataset({datasetName:a})).id);const o=(r?n?.createdAt:e.created_at)||new Date;let s;Zj(e)?s=e:s={inputs:e,outputs:r,created_at:o?.toISOString(),id:n?.exampleId,metadata:n?.metadata,split:n?.split,source_run_id:n?.sourceRunId,use_source_run_io:n?.useSourceRunIO,use_source_run_attachments:n?.useSourceRunAttachments,attachments:n?.attachments};const l=await this._uploadExamplesMultipart(i,[s]);return await this.readExample(l.example_ids?.[0]??lr())}async createExamples(e){if(Array.isArray(e)){if(e.length===0)return[];const C=e;let S=C[0].dataset_id;const N=C[0].dataset_name;if(S===void 0&&N===void 0)throw new Error("Must provide either datasetName or datasetId");if(S!==void 0&&N!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");S===void 0&&(S=(await this.readDataset({datasetName:N})).id);const D=await this._uploadExamplesMultipart(S,C);return await Promise.all(D.example_ids.map(se=>this.readExample(se)))}const{inputs:r,outputs:n,metadata:i,splits:a,sourceRunIds:o,useSourceRunIOs:s,useSourceRunAttachments:l,attachments:c,exampleIds:d,datasetId:f,datasetName:h}=e;if(r===void 0)throw new Error("Must provide inputs when using legacy parameters");let p=f;const b=h;if(p===void 0&&b===void 0)throw new Error("Must provide either datasetName or datasetId");if(p!==void 0&&b!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");p===void 0&&(p=(await this.readDataset({datasetName:b})).id);const g=r.map((C,S)=>({dataset_id:p,inputs:C,outputs:n?.[S],metadata:i?.[S],split:a?.[S],id:d?.[S],attachments:c?.[S],source_run_id:o?.[S],use_source_run_io:s?.[S],use_source_run_attachments:l?.[S]})),v=await this._uploadExamplesMultipart(p,g);return await Promise.all(v.example_ids.map(C=>this.readExample(C)))}async createLLMExample(e,r,n){return this.createExample({input:e},{output:r},n)}async createChatExample(e,r,n){const i=e.map(o=>Nj(o)?zj(o):o),a=Nj(r)?zj(r):r;return this.createExample({input:i},{output:a},n)}async readExample(e){xe(e);const r=`/examples/${e}`,n=await this._get(r),{attachment_urls:i,...a}=n,o=a;return i&&(o.attachments=Object.entries(i).reduce((s,[l,c])=>(s[l.slice(11)]={presigned_url:c.presigned_url,mime_type:c.mime_type},s),{})),o}async*listExamples({datasetId:e,datasetName:r,exampleIds:n,asOf:i,splits:a,inlineS3Urls:o,metadata:s,limit:l,offset:c,filter:d,includeAttachments:f}={}){let h;if(e!==void 0&&r!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");if(e!==void 0)h=e;else if(r!==void 0)h=(await this.readDataset({datasetName:r})).id;else throw new Error("Must provide a datasetName or datasetId");const p=new URLSearchParams({dataset:h}),b=i?typeof i=="string"?i:i?.toISOString():void 0;b&&p.append("as_of",b);const g=o??!0;if(p.append("inline_s3_urls",g.toString()),n!==void 0)for(const E of n)p.append("id",E);if(a!==void 0)for(const E of a)p.append("splits",E);if(s!==void 0){const E=JSON.stringify(s);p.append("metadata",E)}l!==void 0&&p.append("limit",l.toString()),c!==void 0&&p.append("offset",c.toString()),d!==void 0&&p.append("filter",d),f===!0&&["attachment_urls","outputs","metadata"].forEach(E=>p.append("select",E));let v=0;for await(const E of this._getPaginated("/examples",p)){for(const C of E){const{attachment_urls:S,...N}=C,D=N;S&&(D.attachments=Object.entries(S).reduce((Z,[se,re])=>(Z[se.slice(11)]={presigned_url:re.presigned_url,mime_type:re.mime_type||void 0},Z),{})),yield D,v++}if(l!==void 0&&v>=l)break}}async deleteExample(e){xe(e);const r=`/examples/${e}`,n=await this.caller.call(Oe(),this.apiUrl+r,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Ve(n,`delete ${r}`),await n.json()}async updateExample(e,r){let n;r?n=e:n=e.id,xe(n);let i;r?i={id:n,...r}:i=e;let a;return i.dataset_id!==void 0?a=i.dataset_id:a=(await this.readExample(n)).dataset_id,this._updateExamplesMultipart(a,[i])}async updateExamples(e){let r;return e[0].dataset_id===void 0?r=(await this.readExample(e[0].id)).dataset_id:r=e[0].dataset_id,this._updateExamplesMultipart(r,e)}async readDatasetVersion({datasetId:e,datasetName:r,asOf:n,tag:i}){let a;if(e?a=e:a=(await this.readDataset({datasetName:r})).id,xe(a),n&&i||!n&&!i)throw new Error("Exactly one of asOf and tag must be specified.");const o=new URLSearchParams;n!==void 0&&o.append("as_of",typeof n=="string"?n:n.toISOString()),i!==void 0&&o.append("tag",i);const s=await this.caller.call(Oe(),`${this.apiUrl}/datasets/${a}/version?${o.toString()}`,{method:"GET",headers:{...this.headers},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Ve(s,"read dataset version"),await s.json()}async listDatasetSplits({datasetId:e,datasetName:r,asOf:n}){let i;if(e===void 0&&r===void 0)throw new Error("Must provide dataset name or ID");if(e!==void 0&&r!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");e===void 0?i=(await this.readDataset({datasetName:r})).id:i=e,xe(i);const a=new URLSearchParams,o=n?typeof n=="string"?n:n?.toISOString():void 0;return o&&a.append("as_of",o),await this._get(`/datasets/${i}/splits`,a)}async updateDatasetSplits({datasetId:e,datasetName:r,splitName:n,exampleIds:i,remove:a=!1}){let o;if(e===void 0&&r===void 0)throw new Error("Must provide dataset name or ID");if(e!==void 0&&r!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");e===void 0?o=(await this.readDataset({datasetName:r})).id:o=e,xe(o);const s={split_name:n,examples:i.map(c=>(xe(c),c)),remove:a},l=await this.caller.call(Oe(),`${this.apiUrl}/datasets/${o}/splits`,{method:"PUT",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(s),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Ve(l,"update dataset splits",!0)}async evaluateRun(e,r,{sourceInfo:n,loadChildRuns:i,referenceExample:a}={loadChildRuns:!1}){$$("This method is deprecated and will be removed in future LangSmith versions, use `evaluate` from `langsmith/evaluation` instead.");let o;if(typeof e=="string")o=await this.readRun(e,{loadChildRuns:i});else if(typeof e=="object"&&"id"in e)o=e;else throw new Error(`Invalid run type: ${typeof e}`);o.reference_example_id!==null&&o.reference_example_id!==void 0&&(a=await this.readExample(o.reference_example_id));const s=await r.evaluateRun(o,a),[l,c]=await this._logEvaluationFeedback(s,o,n);return c[0]}async createFeedback(e,r,{score:n,value:i,correction:a,comment:o,sourceInfo:s,feedbackSourceType:l="api",sourceRunId:c,feedbackId:d,feedbackConfig:f,projectId:h,comparativeExperimentId:p}){if(!e&&!h)throw new Error("One of runId or projectId must be provided");if(e&&h)throw new Error("Only one of runId or projectId can be provided");const b={type:l??"api",metadata:s??{}};c!==void 0&&b?.metadata!==void 0&&!b.metadata.__run&&(b.metadata.__run={run_id:c}),b?.metadata!==void 0&&b.metadata.__run?.run_id!==void 0&&xe(b.metadata.__run.run_id);const g={id:d??lr(),run_id:e,key:r,score:Xj(n),value:i,correction:a,comment:o,feedback_source:b,comparative_experiment_id:p,feedbackConfig:f,session_id:h},v=`${this.apiUrl}/feedback`,E=await this.caller.call(Oe(),v,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(g),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Ve(E,"create feedback",!0),g}async updateFeedback(e,{score:r,value:n,correction:i,comment:a}){const o={};r!=null&&(o.score=Xj(r)),n!=null&&(o.value=n),i!=null&&(o.correction=i),a!=null&&(o.comment=a),xe(e);const s=await this.caller.call(Oe(),`${this.apiUrl}/feedback/${e}`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(o),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Ve(s,"update feedback",!0)}async readFeedback(e){xe(e);const r=`/feedback/${e}`;return await this._get(r)}async deleteFeedback(e){xe(e);const r=`/feedback/${e}`,n=await this.caller.call(Oe(),this.apiUrl+r,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Ve(n,`delete ${r}`),await n.json()}async*listFeedback({runIds:e,feedbackKeys:r,feedbackSourceTypes:n}={}){const i=new URLSearchParams;if(e&&i.append("run",e.join(",")),r)for(const a of r)i.append("key",a);if(n)for(const a of n)i.append("source",a);for await(const a of this._getPaginated("/feedback",i))yield*a}async createPresignedFeedbackToken(e,r,{expiration:n,feedbackConfig:i}={}){const a={run_id:e,feedback_key:r,feedback_config:i};return n?typeof n=="string"?a.expires_at=n:(n?.hours||n?.minutes||n?.days)&&(a.expires_in=n):a.expires_in={hours:3},await(await this.caller.call(Oe(),`${this.apiUrl}/feedback/tokens`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(a),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json()}async createComparativeExperiment({name:e,experimentIds:r,referenceDatasetId:n,createdAt:i,description:a,metadata:o,id:s}){if(r.length===0)throw new Error("At least one experiment is required");if(n||(n=(await this.readProject({projectId:r[0]})).reference_dataset_id),!n==null)throw new Error("A reference dataset is required");const l={id:s,name:e,experiment_ids:r,reference_dataset_id:n,description:a,created_at:(i??new Date)?.toISOString(),extra:{}};return o&&(l.extra.metadata=o),await(await this.caller.call(Oe(),`${this.apiUrl}/datasets/comparative`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(l),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json()}async*listPresignedFeedbackTokens(e){xe(e);const r=new URLSearchParams({run_id:e});for await(const n of this._getPaginated("/feedback/tokens",r))yield*n}_selectEvalResults(e){let r;return"results"in e?r=e.results:Array.isArray(e)?r=e:r=[e],r}async _logEvaluationFeedback(e,r,n){const i=this._selectEvalResults(e),a=[];for(const o of i){let s=n||{};o.evaluatorInfo&&(s={...o.evaluatorInfo,...s});let l=null;o.targetRunId?l=o.targetRunId:r&&(l=r.id),a.push(await this.createFeedback(l,o.key,{score:o.score,value:o.value,comment:o.comment,correction:o.correction,sourceInfo:s,sourceRunId:o.sourceRunId,feedbackConfig:o.feedbackConfig,feedbackSourceType:"model"}))}return[i,a]}async logEvaluationFeedback(e,r,n){const[i]=await this._logEvaluationFeedback(e,r,n);return i}async*listAnnotationQueues(e={}){const{queueIds:r,name:n,nameContains:i,limit:a}=e,o=new URLSearchParams;r&&r.forEach((l,c)=>{xe(l,`queueIds[${c}]`),o.append("ids",l)}),n&&o.append("name",n),i&&o.append("name_contains",i),o.append("limit",(a!==void 0?Math.min(a,100):100).toString());let s=0;for await(const l of this._getPaginated("/annotation-queues",o))if(yield*l,s++,a!==void 0&&s>=a)break}async createAnnotationQueue(e){const{name:r,description:n,queueId:i}=e,a={name:r,description:n,id:i||lr()},o=await this.caller.call(Oe(),`${this.apiUrl}/annotation-queues`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(Object.fromEntries(Object.entries(a).filter(([l,c])=>c!==void 0))),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Ve(o,"create annotation queue"),await o.json()}async readAnnotationQueue(e){const r=await this.listAnnotationQueues({queueIds:[e]}).next();if(r.done)throw new Error(`Annotation queue with ID ${e} not found`);return r.value}async updateAnnotationQueue(e,r){const{name:n,description:i}=r,a=await this.caller.call(Oe(),`${this.apiUrl}/annotation-queues/${xe(e,"queueId")}`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify({name:n,description:i}),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Ve(a,"update annotation queue")}async deleteAnnotationQueue(e){const r=await this.caller.call(Oe(),`${this.apiUrl}/annotation-queues/${xe(e,"queueId")}`,{method:"DELETE",headers:{...this.headers,Accept:"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Ve(r,"delete annotation queue")}async addRunsToAnnotationQueue(e,r){const n=await this.caller.call(Oe(),`${this.apiUrl}/annotation-queues/${xe(e,"queueId")}/runs`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(r.map((i,a)=>xe(i,`runIds[${a}]`).toString())),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Ve(n,"add runs to annotation queue")}async getRunFromAnnotationQueue(e,r){const n=`/annotation-queues/${xe(e,"queueId")}/run`,i=await this.caller.call(Oe(),`${this.apiUrl}${n}/${r}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Ve(i,"get run from annotation queue"),await i.json()}async deleteRunFromAnnotationQueue(e,r){const n=await this.caller.call(Oe(),`${this.apiUrl}/annotation-queues/${xe(e,"queueId")}/runs/${xe(r,"queueRunId")}`,{method:"DELETE",headers:{...this.headers,Accept:"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Ve(n,"delete run from annotation queue")}async getSizeFromAnnotationQueue(e){const r=await this.caller.call(Oe(),`${this.apiUrl}/annotation-queues/${xe(e,"queueId")}/size`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Ve(r,"get size from annotation queue"),await r.json()}async _currentTenantIsOwner(e){const r=await this._getSettings();return e=="-"||r.tenant_handle===e}async _ownerConflictError(e,r){const n=await this._getSettings();return new Error(`Cannot ${e} for another tenant.

      Current tenant: ${n.tenant_handle}

      Requested tenant: ${r}`)}async _getLatestCommitHash(e){const r=await this.caller.call(Oe(),`${this.apiUrl}/commits/${e}/?limit=1&offset=0`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions}),n=await r.json();if(!r.ok){const i=typeof n.detail=="string"?n.detail:JSON.stringify(n.detail),a=new Error(`Error ${r.status}: ${r.statusText}
${i}`);throw a.statusCode=r.status,a}if(n.commits.length!==0)return n.commits[0].commit_hash}async _likeOrUnlikePrompt(e,r){const[n,i,a]=Xi(e),o=await this.caller.call(Oe(),`${this.apiUrl}/likes/${n}/${i}`,{method:"POST",body:JSON.stringify({like:r}),headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Ve(o,`${r?"like":"unlike"} prompt`),await o.json()}async _getPromptUrl(e){const[r,n,i]=Xi(e);if(await this._currentTenantIsOwner(r)){const a=await this._getSettings();return i!=="latest"?`${this.getHostUrl()}/prompts/${n}/${i.substring(0,8)}?organizationId=${a.id}`:`${this.getHostUrl()}/prompts/${n}?organizationId=${a.id}`}else return i!=="latest"?`${this.getHostUrl()}/hub/${r}/${n}/${i.substring(0,8)}`:`${this.getHostUrl()}/hub/${r}/${n}`}async promptExists(e){return!!await this.getPrompt(e)}async likePrompt(e){return this._likeOrUnlikePrompt(e,!0)}async unlikePrompt(e){return this._likeOrUnlikePrompt(e,!1)}async*listCommits(e){for await(const r of this._getPaginated(`/commits/${e}/`,new URLSearchParams,n=>n.commits))yield*r}async*listPrompts(e){const r=new URLSearchParams;r.append("sort_field",e?.sortField??"updated_at"),r.append("sort_direction","desc"),r.append("is_archived",(!!e?.isArchived).toString()),e?.isPublic!==void 0&&r.append("is_public",e.isPublic.toString()),e?.query&&r.append("query",e.query);for await(const n of this._getPaginated("/repos",r,i=>i.repos))yield*n}async getPrompt(e){const[r,n,i]=Xi(e),a=await this.caller.call(Oe(),`${this.apiUrl}/repos/${r}/${n}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});if(a.status===404)return null;await Ve(a,"get prompt");const o=await a.json();return o.repo?o.repo:null}async createPrompt(e,r){const n=await this._getSettings();if(r?.isPublic&&!n.tenant_handle)throw new Error(`Cannot create a public prompt without first

        creating a LangChain Hub handle. 
        You can add a handle by creating a public prompt at:

        https://smith.langchain.com/prompts`);const[i,a,o]=Xi(e);if(!await this._currentTenantIsOwner(i))throw await this._ownerConflictError("create a prompt",i);const s={repo_handle:a,...r?.description&&{description:r.description},...r?.readme&&{readme:r.readme},...r?.tags&&{tags:r.tags},is_public:!!r?.isPublic},l=await this.caller.call(Oe(),`${this.apiUrl}/repos/`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(s),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Ve(l,"create prompt");const{repo:c}=await l.json();return c}async createCommit(e,r,n){if(!await this.promptExists(e))throw new Error("Prompt does not exist, you must create it first.");const[i,a,o]=Xi(e),s=n?.parentCommitHash==="latest"||!n?.parentCommitHash?await this._getLatestCommitHash(`${i}/${a}`):n?.parentCommitHash,l={manifest:JSON.parse(JSON.stringify(r)),parent_commit:s},c=await this.caller.call(Oe(),`${this.apiUrl}/commits/${i}/${a}`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(l),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Ve(c,"create commit");const d=await c.json();return this._getPromptUrl(`${i}/${a}${d.commit_hash?`:${d.commit_hash}`:""}`)}async updateExamplesMultipart(e,r=[]){return this._updateExamplesMultipart(e,r)}async _updateExamplesMultipart(e,r=[]){if(!await this._getMultiPartSupport())throw new Error("Your LangSmith version does not allow using the multipart examples endpoint, please update to the latest version.");const n=new FormData;for(const s of r){const l=s.id,c={...s.metadata&&{metadata:s.metadata},...s.split&&{split:s.split}},d=Lr(c),f=new Blob([d],{type:"application/json"});if(n.append(l,f),s.inputs){const h=Lr(s.inputs),p=new Blob([h],{type:"application/json"});n.append(`${l}.inputs`,p)}if(s.outputs){const h=Lr(s.outputs),p=new Blob([h],{type:"application/json"});n.append(`${l}.outputs`,p)}if(s.attachments)for(const[h,p]of Object.entries(s.attachments)){let b,g;Array.isArray(p)?[b,g]=p:(b=p.mimeType,g=p.data);const v=new Blob([g],{type:`${b}; length=${g.byteLength}`});n.append(`${l}.attachment.${h}`,v)}if(s.attachments_operations){const h=Lr(s.attachments_operations),p=new Blob([h],{type:"application/json"});n.append(`${l}.attachments_operations`,p)}}const i=e??r[0]?.dataset_id;return await(await this.caller.call(Oe(),`${this.apiUrl}/v1/platform/datasets/${i}/examples`,{method:"PATCH",headers:this.headers,body:n})).json()}async uploadExamplesMultipart(e,r=[]){return this._uploadExamplesMultipart(e,r)}async _uploadExamplesMultipart(e,r=[]){if(!await this._getMultiPartSupport())throw new Error("Your LangSmith version does not allow using the multipart examples endpoint, please update to the latest version.");const n=new FormData;for(const o of r){const s=(o.id??lr()).toString(),l={created_at:o.created_at,...o.metadata&&{metadata:o.metadata},...o.split&&{split:o.split},...o.source_run_id&&{source_run_id:o.source_run_id},...o.use_source_run_io&&{use_source_run_io:o.use_source_run_io},...o.use_source_run_attachments&&{use_source_run_attachments:o.use_source_run_attachments}},c=Lr(l),d=new Blob([c],{type:"application/json"});if(n.append(s,d),o.inputs){const f=Lr(o.inputs),h=new Blob([f],{type:"application/json"});n.append(`${s}.inputs`,h)}if(o.outputs){const f=Lr(o.outputs),h=new Blob([f],{type:"application/json"});n.append(`${s}.outputs`,h)}if(o.attachments)for(const[f,h]of Object.entries(o.attachments)){let p,b;Array.isArray(h)?[p,b]=h:(p=h.mimeType,b=h.data);const g=new Blob([b],{type:`${p}; length=${b.byteLength}`});n.append(`${s}.attachment.${f}`,g)}}return await(await this.caller.call(Oe(),`${this.apiUrl}/v1/platform/datasets/${e}/examples`,{method:"POST",headers:this.headers,body:n})).json()}async updatePrompt(e,r){if(!await this.promptExists(e))throw new Error("Prompt does not exist, you must create it first.");const[n,i]=Xi(e);if(!await this._currentTenantIsOwner(n))throw await this._ownerConflictError("update a prompt",n);const a={};if(r?.description!==void 0&&(a.description=r.description),r?.readme!==void 0&&(a.readme=r.readme),r?.tags!==void 0&&(a.tags=r.tags),r?.isPublic!==void 0&&(a.is_public=r.isPublic),r?.isArchived!==void 0&&(a.is_archived=r.isArchived),Object.keys(a).length===0)throw new Error("No valid update options provided");const o=await this.caller.call(Oe(),`${this.apiUrl}/repos/${n}/${i}`,{method:"PATCH",body:JSON.stringify(a),headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Ve(o,"update prompt"),o.json()}async deletePrompt(e){if(!await this.promptExists(e))throw new Error("Prompt does not exist, you must create it first.");const[r,n,i]=Xi(e);if(!await this._currentTenantIsOwner(r))throw await this._ownerConflictError("delete a prompt",r);return await(await this.caller.call(Oe(),`${this.apiUrl}/repos/${r}/${n}`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json()}async pullPromptCommit(e,r){const[n,i,a]=Xi(e),o=await this.caller.call(Oe(),`${this.apiUrl}/commits/${n}/${i}/${a}${r?.includeModel?"?include_model=true":""}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Ve(o,"pull prompt commit");const s=await o.json();return{owner:n,repo:i,commit_hash:s.commit_hash,manifest:s.manifest,examples:s.examples}}async _pullPrompt(e,r){const n=await this.pullPromptCommit(e,{includeModel:r?.includeModel});return JSON.stringify(n.manifest)}async pushPrompt(e,r){return await this.promptExists(e)?r&&Object.keys(r).some(i=>i!=="object")&&await this.updatePrompt(e,{description:r?.description,readme:r?.readme,tags:r?.tags,isPublic:r?.isPublic}):await this.createPrompt(e,{description:r?.description,readme:r?.readme,tags:r?.tags,isPublic:r?.isPublic}),r?.object?await this.createCommit(e,r?.object,{parentCommitHash:r?.parentCommitHash}):await this._getPromptUrl(e)}async clonePublicDataset(e,r={}){const{sourceApiUrl:n=this.apiUrl,datasetName:i}=r,[a,o]=this.parseTokenOrUrl(e,n),s=new OO({apiUrl:a,apiKey:"placeholder"}),l=await s.readSharedDataset(o),c=i||l.name;try{if(await this.hasDataset({datasetId:c})){console.log(`Dataset ${c} already exists in your tenant. Skipping.`);return}}catch{}const d=await s.listSharedExamples(o),f=await this.createDataset(c,{description:l.description,dataType:l.data_type||"kv",inputsSchema:l.inputs_schema_definition??void 0,outputsSchema:l.outputs_schema_definition??void 0});try{await this.createExamples({inputs:d.map(h=>h.inputs),outputs:d.flatMap(h=>h.outputs?[h.outputs]:[]),datasetId:f.id})}catch(h){throw console.error(`An error occurred while creating dataset ${c}. You should delete it manually.`),h}}parseTokenOrUrl(e,r,n=2,i="dataset"){try{return xe(e),[r,e]}catch{}try{const o=new URL(e).pathname.split("/").filter(s=>s!=="");if(o.length>=n){const s=o[o.length-n];return[r,s]}else throw new Error(`Invalid public ${i} URL: ${e}`)}catch{throw new Error(`Invalid public ${i} URL or token: ${e}`)}}awaitPendingTraceBatches(){return this.manualFlushMode?(console.warn("[WARNING]: When tracing in manual flush mode, you must call `await client.flush()` manually to submit trace batches."),Promise.resolve()):Promise.all([...this.autoBatchQueue.items.map(({itemPromise:e})=>e),this.batchIngestCaller.queue.onIdle()])}};function Zj(t){return"dataset_id"in t||"dataset_name"in t}const z$="0.3.14";var SO={};let hi;const mV=()=>typeof window<"u"&&typeof window.document<"u",vV=()=>typeof globalThis=="object"&&globalThis.constructor&&globalThis.constructor.name==="DedicatedWorkerGlobalScope",wV=()=>typeof window<"u"&&window.name==="nodejs"||typeof navigator<"u"&&(navigator.userAgent.includes("Node.js")||navigator.userAgent.includes("jsdom")),B$=()=>typeof Deno<"u",OV=()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"&&!B$(),SV=()=>hi||(mV()?hi="browser":OV()?hi="node":vV()?hi="webworker":wV()?hi="jsdom":B$()?hi="deno":hi="other",hi);let ew;function U$(){if(ew===void 0){const t=SV(),e=jV();ew={library:"langsmith",runtime:t,sdk:"langsmith-js",sdk_version:z$,...e}}return ew}function EV(){const t=PV()||{},e={},r=["LANGCHAIN_API_KEY","LANGCHAIN_ENDPOINT","LANGCHAIN_TRACING_V2","LANGCHAIN_PROJECT","LANGCHAIN_SESSION","LANGSMITH_API_KEY","LANGSMITH_ENDPOINT","LANGSMITH_TRACING_V2","LANGSMITH_PROJECT","LANGSMITH_SESSION"];for(const[n,i]of Object.entries(t))(n.startsWith("LANGCHAIN_")||n.startsWith("LANGSMITH_"))&&typeof i=="string"&&!r.includes(n)&&!n.toLowerCase().includes("key")&&!n.toLowerCase().includes("secret")&&!n.toLowerCase().includes("token")&&(n==="LANGCHAIN_REVISION_ID"?e.revision_id=i:e[n]=i);return e}function PV(){try{return typeof process<"u"&&SO?Object.entries(SO).reduce((t,[e,r])=>(t[e]=String(r),t),{}):void 0}catch{return}}function fo(t){try{return typeof process<"u"?SO?.[t]:void 0}catch{return}}function pa(t){return fo(`LANGSMITH_${t}`)||fo(`LANGCHAIN_${t}`)}let tw;function jV(){if(tw!==void 0)return tw;const t=["VERCEL_GIT_COMMIT_SHA","NEXT_PUBLIC_VERCEL_GIT_COMMIT_SHA","COMMIT_REF","RENDER_GIT_COMMIT","CI_COMMIT_SHA","CIRCLE_SHA1","CF_PAGES_COMMIT_SHA","REACT_APP_GIT_SHA","SOURCE_VERSION","GITHUB_SHA","TRAVIS_COMMIT","GIT_COMMIT","BUILD_VCS_NUMBER","bamboo_planRepository_revision","Build.SourceVersion","BITBUCKET_COMMIT","DRONE_COMMIT_SHA","SEMAPHORE_GIT_SHA","BUILDKITE_COMMIT"],e={};for(const r of t){const n=fo(r);n!==void 0&&(e[r]=n)}return tw=e,e}const CV=t=>!!["TRACING_V2","TRACING"].find(r=>pa(r)==="true"),rw=Symbol.for("lc:context_variables");function MV(t){return t.replace(/[-:.]/g,"")}function TV(t,e,r=1){const n=r.toFixed(0).slice(0,3).padStart(3,"0");return MV(`${new Date(t).toISOString().slice(0,-1)}${n}Z`)+e}class iy{constructor(e,r){Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.metadata=e,this.tags=r}static fromHeader(e){const r=e.split(",");let n={},i=[];for(const a of r){const[o,s]=a.split("="),l=decodeURIComponent(s);o==="langsmith-metadata"?n=JSON.parse(l):o==="langsmith-tags"&&(i=l.split(","))}return new iy(n,i)}toHeader(){const e=[];return this.metadata&&Object.keys(this.metadata).length>0&&e.push(`langsmith-metadata=${encodeURIComponent(JSON.stringify(this.metadata))}`),this.tags&&this.tags.length>0&&e.push(`langsmith-tags=${encodeURIComponent(this.tags.join(","))}`),e.join(",")}}class qr{constructor(e){if(Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"run_type",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"project_name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"parent_run",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"child_runs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"start_time",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"end_time",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"extra",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"error",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"serialized",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"inputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"outputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"reference_example_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"events",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"trace_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"dotted_order",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tracingEnabled",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"execution_order",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"child_execution_order",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"attachments",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),F$(e)){Object.assign(this,{...e});return}const r=qr.getDefaultConfig(),{metadata:n,...i}=e,a=i.client??qr.getSharedClient(),o={...n,...i?.extra?.metadata};if(i.extra={...i.extra,metadata:o},Object.assign(this,{...r,...i,client:a}),this.trace_id||(this.parent_run?this.trace_id=this.parent_run.trace_id??this.id:this.trace_id=this.id),this.execution_order??=1,this.child_execution_order??=1,!this.dotted_order){const s=TV(this.start_time,this.id,this.execution_order);this.parent_run?this.dotted_order=this.parent_run.dotted_order+"."+s:this.dotted_order=s}}static getDefaultConfig(){return{id:lr(),run_type:"chain",project_name:pa("PROJECT")??fo("LANGCHAIN_SESSION")??"default",child_runs:[],api_url:fo("LANGCHAIN_ENDPOINT")??"http://localhost:1984",api_key:fo("LANGCHAIN_API_KEY"),caller_options:{},start_time:Date.now(),serialized:{},inputs:{},extra:{}}}static getSharedClient(){return qr.sharedClient||(qr.sharedClient=new N$),qr.sharedClient}createChild(e){const r=this.child_execution_order+1,n=new qr({...e,parent_run:this,project_name:this.project_name,client:this.client,tracingEnabled:this.tracingEnabled,execution_order:r,child_execution_order:r});rw in this&&(n[rw]=this[rw]);const i=Symbol.for("lc:child_config"),a=e.extra?.[i]??this.extra[i];if(AV(a)){const l={...a},c=RV(l.callbacks)?l.callbacks.copy?.():void 0;c&&(Object.assign(c,{_parentRunId:n.id}),c.handlers?.find(L$)?.updateFromRunTree?.(n),l.callbacks=c),n.extra[i]=l}const o=new Set;let s=this;for(;s!=null&&!o.has(s.id);)o.add(s.id),s.child_execution_order=Math.max(s.child_execution_order,r),s=s.parent_run;return this.child_runs.push(n),n}async end(e,r,n=Date.now(),i){this.outputs=this.outputs??e,this.error=this.error??r,this.end_time=this.end_time??n,i&&Object.keys(i).length>0&&(this.extra=this.extra?{...this.extra,metadata:{...this.extra.metadata,...i}}:{metadata:i})}_convertToCreate(e,r,n=!0){const i=e.extra??{};if(i.runtime||(i.runtime={}),r)for(const[l,c]of Object.entries(r))i.runtime[l]||(i.runtime[l]=c);let a,o;return n?(o=e.parent_run?.id,a=[]):(a=e.child_runs.map(l=>this._convertToCreate(l,r,n)),o=void 0),{id:e.id,name:e.name,start_time:e.start_time,end_time:e.end_time,run_type:e.run_type,reference_example_id:e.reference_example_id,extra:i,serialized:e.serialized,error:e.error,inputs:e.inputs,outputs:e.outputs,session_name:e.project_name,child_runs:a,parent_run_id:o,trace_id:e.trace_id,dotted_order:e.dotted_order,tags:e.tags,attachments:e.attachments}}async postRun(e=!0){try{const r=U$(),n=await this._convertToCreate(this,r,!0);if(await this.client.createRun(n),!e){$$("Posting with excludeChildRuns=false is deprecated and will be removed in a future version.");for(const i of this.child_runs)await i.postRun(!1)}}catch(r){console.error(`Error in postRun for run ${this.id}:`,r)}}async patchRun(){try{const e={end_time:this.end_time,error:this.error,inputs:this.inputs,outputs:this.outputs,parent_run_id:this.parent_run?.id,reference_example_id:this.reference_example_id,extra:this.extra,events:this.events,dotted_order:this.dotted_order,trace_id:this.trace_id,tags:this.tags,attachments:this.attachments};await this.client.updateRun(this.id,e)}catch(e){console.error(`Error in patchRun for run ${this.id}`,e)}}toJSON(){return this._convertToCreate(this,void 0,!1)}addEvent(e){this.events||(this.events=[]),typeof e=="string"?this.events.push({name:"event",time:new Date().toISOString(),message:e}):this.events.push({...e,time:e.time??new Date().toISOString()})}static fromRunnableConfig(e,r){const n=e?.callbacks;let i,a,o,s=CV();if(n){const c=n?.getParentRunId?.()??"",d=n?.handlers?.find(f=>f?.name=="langchain_tracer");i=d?.getRun?.(c),a=d?.projectName,o=d?.client,s=s||!!d}return i?new qr({name:i.name,id:i.id,trace_id:i.trace_id,dotted_order:i.dotted_order,client:o,tracingEnabled:s,project_name:a,tags:[...new Set((i?.tags??[]).concat(e?.tags??[]))],extra:{metadata:{...i?.extra?.metadata,...e?.metadata}}}).createChild(r):new qr({...r,client:o,tracingEnabled:s,project_name:a})}static fromDottedOrder(e){return this.fromHeaders({"langsmith-trace":e})}static fromHeaders(e,r){const n="get"in e&&typeof e.get=="function"?{"langsmith-trace":e.get("langsmith-trace"),baggage:e.get("baggage")}:e,i=n["langsmith-trace"];if(!i||typeof i!="string")return;const a=i.trim(),o=a.split(".").map(c=>{const[d,f]=c.split("Z");return{strTime:d,time:Date.parse(d+"Z"),uuid:f}}),s=o[0].uuid,l={...r,name:r?.name??"parent",run_type:r?.run_type??"chain",start_time:r?.start_time??Date.now(),id:o.at(-1)?.uuid,trace_id:s,dotted_order:a};if(n.baggage&&typeof n.baggage=="string"){const c=iy.fromHeader(n.baggage);l.metadata=c.metadata,l.tags=c.tags}return new qr(l)}toHeaders(e){const r={"langsmith-trace":this.dotted_order,baggage:new iy(this.extra?.metadata,this.tags).toHeader()};if(e)for(const[n,i]of Object.entries(r))e.set(n,i);return r}}Object.defineProperty(qr,"sharedClient",{enumerable:!0,configurable:!0,writable:!0,value:null});function F$(t){return t!==void 0&&typeof t.createChild=="function"&&typeof t.postRun=="function"}function L$(t){return typeof t=="object"&&t!=null&&typeof t.name=="string"&&t.name==="langchain_tracer"}function Yj(t){return Array.isArray(t)&&t.some(e=>L$(e))}function RV(t){return typeof t=="object"&&t!=null&&Array.isArray(t.handlers)}function AV(t){return t!==void 0&&typeof t.callbacks=="object"&&(Yj(t.callbacks?.handlers)||Yj(t.callbacks))}let $V=class{getStore(){}run(e,r){return r()}};const nw=Symbol.for("ls:tracing_async_local_storage"),IV=new $V;let xV=class{getInstance(){return globalThis[nw]??IV}initializeGlobalInstance(e){globalThis[nw]===void 0&&(globalThis[nw]=e)}};const DV=new xV,NV=()=>{const t=DV.getInstance().getStore();if(!F$(t))throw new Error(["Could not get the current run tree.","","Please make sure you are calling this method within a traceable function and that tracing is enabled."].join(`
`));return t};function QS(t){return typeof t=="function"&&"langsmith:traceable"in t}let iw;const zV=()=>{if(iw===void 0){const t=Ye("LANGCHAIN_CALLBACKS_BACKGROUND")==="false"?{blockOnRootRunFinalization:!0}:{};iw=new N$(t)}return iw};class sc extends Kc{constructor(e={}){super(e),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"langchain_tracer"}),Object.defineProperty(this,"projectName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"exampleId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0});const{exampleId:r,projectName:n,client:i}=e;this.projectName=n??Ye("LANGCHAIN_PROJECT")??Ye("LANGCHAIN_SESSION"),this.exampleId=r,this.client=i??zV();const a=sc.getTraceableRunTree();a&&this.updateFromRunTree(a)}async _convertToCreate(e,r=void 0){return{...e,extra:{...e.extra,runtime:await x4()},child_runs:void 0,session_name:this.projectName,reference_example_id:e.parent_run_id?void 0:r}}async persistRun(e){}async onRunCreate(e){const r=await this._convertToCreate(e,this.exampleId);await this.client.createRun(r)}async onRunUpdate(e){const r={end_time:e.end_time,error:e.error,outputs:e.outputs,events:e.events,inputs:e.inputs,trace_id:e.trace_id,dotted_order:e.dotted_order,parent_run_id:e.parent_run_id,extra:e.extra};await this.client.updateRun(e.id,r)}getRun(e){return this.runMap.get(e)}updateFromRunTree(e){let r=e;const n=new Set;for(;r.parent_run&&!(n.has(r.id)||(n.add(r.id),!r.parent_run));)r=r.parent_run;n.clear();const i=[r];for(;i.length>0;){const a=i.shift();!a||n.has(a.id)||(n.add(a.id),this.runMap.set(a.id,a),a.child_runs&&i.push(...a.child_runs))}this.client=e.client??this.client,this.projectName=e.project_name??this.projectName,this.exampleId=e.reference_example_id??this.exampleId}convertToRunTree(e){const r={},n=[];for(const[i,a]of this.runMap){const o=new qr({...a,child_runs:[],parent_run:void 0,client:this.client,project_name:this.projectName,reference_example_id:this.exampleId,tracingEnabled:!0});r[i]=o,n.push([i,a.dotted_order])}n.sort((i,a)=>!i[1]||!a[1]?0:i[1].localeCompare(a[1]));for(const[i]of n){const a=this.runMap.get(i),o=r[i];if(!(!a||!o)&&a.parent_run_id){const s=r[a.parent_run_id];s&&(s.child_runs.push(o),o.parent_run=s)}}return r[e]}static getTraceableRunTree(){try{return NV()}catch{return}}}const V$=Symbol.for("ls:tracing_async_local_storage"),D_=Symbol.for("lc:context_variables"),BV=t=>{globalThis[V$]=t},Mc=()=>globalThis[V$];let uc;function UV(){const t="default"in $i?$i.default:$i;return new t({autoStart:!0,concurrency:1})}function FV(){return typeof uc>"u"&&(uc=UV()),uc}async function Lt(t,e){if(e===!0){const r=Mc();r!==void 0?await r.run(void 0,async()=>t()):await t()}else uc=FV(),uc.add(async()=>{const r=Mc();r!==void 0?await r.run(void 0,async()=>t()):await t()})}const LV=t=>!!["LANGSMITH_TRACING_V2","LANGCHAIN_TRACING_V2","LANGSMITH_TRACING","LANGCHAIN_TRACING"].find(r=>Ye(r)==="true");function k$(t){const e=Mc();return e===void 0?void 0:e.getStore()?.[D_]?.[t]}const VV=Symbol("lc:configure_hooks"),kV=()=>k$(VV)||[];function HV(t){return t?Array.isArray(t)||"name"in t?{callbacks:t}:t:{}}class qV{setHandler(e){return this.setHandlers([e])}}class eb{constructor(e,r,n,i,a,o,s,l){Object.defineProperty(this,"runId",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"handlers",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"inheritableHandlers",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"inheritableTags",{enumerable:!0,configurable:!0,writable:!0,value:a}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:o}),Object.defineProperty(this,"inheritableMetadata",{enumerable:!0,configurable:!0,writable:!0,value:s}),Object.defineProperty(this,"_parentRunId",{enumerable:!0,configurable:!0,writable:!0,value:l})}get parentRunId(){return this._parentRunId}async handleText(e){await Promise.all(this.handlers.map(r=>Lt(async()=>{try{await r.handleText?.(e,this.runId,this._parentRunId,this.tags)}catch(n){if((r.raiseError?console.error:console.warn)(`Error in handler ${r.constructor.name}, handleText: ${n}`),r.raiseError)throw n}},r.awaitHandlers)))}async handleCustomEvent(e,r,n,i,a){await Promise.all(this.handlers.map(o=>Lt(async()=>{try{await o.handleCustomEvent?.(e,r,this.runId,this.tags,this.metadata)}catch(s){if((o.raiseError?console.error:console.warn)(`Error in handler ${o.constructor.name}, handleCustomEvent: ${s}`),o.raiseError)throw s}},o.awaitHandlers)))}}class GV extends eb{getChild(e){const r=new Wt(this.runId);return r.setHandlers(this.inheritableHandlers),r.addTags(this.inheritableTags),r.addMetadata(this.inheritableMetadata),e&&r.addTags([e],!1),r}async handleRetrieverEnd(e){await Promise.all(this.handlers.map(r=>Lt(async()=>{if(!r.ignoreRetriever)try{await r.handleRetrieverEnd?.(e,this.runId,this._parentRunId,this.tags)}catch(n){if((r.raiseError?console.error:console.warn)(`Error in handler ${r.constructor.name}, handleRetriever`),r.raiseError)throw n}},r.awaitHandlers)))}async handleRetrieverError(e){await Promise.all(this.handlers.map(r=>Lt(async()=>{if(!r.ignoreRetriever)try{await r.handleRetrieverError?.(e,this.runId,this._parentRunId,this.tags)}catch(n){if((r.raiseError?console.error:console.warn)(`Error in handler ${r.constructor.name}, handleRetrieverError: ${n}`),r.raiseError)throw e}},r.awaitHandlers)))}}class Qj extends eb{async handleLLMNewToken(e,r,n,i,a,o){await Promise.all(this.handlers.map(s=>Lt(async()=>{if(!s.ignoreLLM)try{await s.handleLLMNewToken?.(e,r??{prompt:0,completion:0},this.runId,this._parentRunId,this.tags,o)}catch(l){if((s.raiseError?console.error:console.warn)(`Error in handler ${s.constructor.name}, handleLLMNewToken: ${l}`),s.raiseError)throw l}},s.awaitHandlers)))}async handleLLMError(e,r,n,i,a){await Promise.all(this.handlers.map(o=>Lt(async()=>{if(!o.ignoreLLM)try{await o.handleLLMError?.(e,this.runId,this._parentRunId,this.tags,a)}catch(s){if((o.raiseError?console.error:console.warn)(`Error in handler ${o.constructor.name}, handleLLMError: ${s}`),o.raiseError)throw s}},o.awaitHandlers)))}async handleLLMEnd(e,r,n,i,a){await Promise.all(this.handlers.map(o=>Lt(async()=>{if(!o.ignoreLLM)try{await o.handleLLMEnd?.(e,this.runId,this._parentRunId,this.tags,a)}catch(s){if((o.raiseError?console.error:console.warn)(`Error in handler ${o.constructor.name}, handleLLMEnd: ${s}`),o.raiseError)throw s}},o.awaitHandlers)))}}class WV extends eb{getChild(e){const r=new Wt(this.runId);return r.setHandlers(this.inheritableHandlers),r.addTags(this.inheritableTags),r.addMetadata(this.inheritableMetadata),e&&r.addTags([e],!1),r}async handleChainError(e,r,n,i,a){await Promise.all(this.handlers.map(o=>Lt(async()=>{if(!o.ignoreChain)try{await o.handleChainError?.(e,this.runId,this._parentRunId,this.tags,a)}catch(s){if((o.raiseError?console.error:console.warn)(`Error in handler ${o.constructor.name}, handleChainError: ${s}`),o.raiseError)throw s}},o.awaitHandlers)))}async handleChainEnd(e,r,n,i,a){await Promise.all(this.handlers.map(o=>Lt(async()=>{if(!o.ignoreChain)try{await o.handleChainEnd?.(e,this.runId,this._parentRunId,this.tags,a)}catch(s){if((o.raiseError?console.error:console.warn)(`Error in handler ${o.constructor.name}, handleChainEnd: ${s}`),o.raiseError)throw s}},o.awaitHandlers)))}async handleAgentAction(e){await Promise.all(this.handlers.map(r=>Lt(async()=>{if(!r.ignoreAgent)try{await r.handleAgentAction?.(e,this.runId,this._parentRunId,this.tags)}catch(n){if((r.raiseError?console.error:console.warn)(`Error in handler ${r.constructor.name}, handleAgentAction: ${n}`),r.raiseError)throw n}},r.awaitHandlers)))}async handleAgentEnd(e){await Promise.all(this.handlers.map(r=>Lt(async()=>{if(!r.ignoreAgent)try{await r.handleAgentEnd?.(e,this.runId,this._parentRunId,this.tags)}catch(n){if((r.raiseError?console.error:console.warn)(`Error in handler ${r.constructor.name}, handleAgentEnd: ${n}`),r.raiseError)throw n}},r.awaitHandlers)))}}class KV extends eb{getChild(e){const r=new Wt(this.runId);return r.setHandlers(this.inheritableHandlers),r.addTags(this.inheritableTags),r.addMetadata(this.inheritableMetadata),e&&r.addTags([e],!1),r}async handleToolError(e){await Promise.all(this.handlers.map(r=>Lt(async()=>{if(!r.ignoreAgent)try{await r.handleToolError?.(e,this.runId,this._parentRunId,this.tags)}catch(n){if((r.raiseError?console.error:console.warn)(`Error in handler ${r.constructor.name}, handleToolError: ${n}`),r.raiseError)throw n}},r.awaitHandlers)))}async handleToolEnd(e){await Promise.all(this.handlers.map(r=>Lt(async()=>{if(!r.ignoreAgent)try{await r.handleToolEnd?.(e,this.runId,this._parentRunId,this.tags)}catch(n){if((r.raiseError?console.error:console.warn)(`Error in handler ${r.constructor.name}, handleToolEnd: ${n}`),r.raiseError)throw n}},r.awaitHandlers)))}}class Wt extends qV{constructor(e,r){super(),Object.defineProperty(this,"handlers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"inheritableHandlers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"inheritableTags",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"inheritableMetadata",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"callback_manager"}),Object.defineProperty(this,"_parentRunId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.handlers=r?.handlers??this.handlers,this.inheritableHandlers=r?.inheritableHandlers??this.inheritableHandlers,this.tags=r?.tags??this.tags,this.inheritableTags=r?.inheritableTags??this.inheritableTags,this.metadata=r?.metadata??this.metadata,this.inheritableMetadata=r?.inheritableMetadata??this.inheritableMetadata,this._parentRunId=e}getParentRunId(){return this._parentRunId}async handleLLMStart(e,r,n=void 0,i=void 0,a=void 0,o=void 0,s=void 0,l=void 0){return Promise.all(r.map(async(c,d)=>{const f=d===0&&n?n:lr();return await Promise.all(this.handlers.map(h=>{if(!h.ignoreLLM)return cl(h)&&h._createRunForLLMStart(e,[c],f,this._parentRunId,a,this.tags,this.metadata,l),Lt(async()=>{try{await h.handleLLMStart?.(e,[c],f,this._parentRunId,a,this.tags,this.metadata,l)}catch(p){if((h.raiseError?console.error:console.warn)(`Error in handler ${h.constructor.name}, handleLLMStart: ${p}`),h.raiseError)throw p}},h.awaitHandlers)})),new Qj(f,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}))}async handleChatModelStart(e,r,n=void 0,i=void 0,a=void 0,o=void 0,s=void 0,l=void 0){return Promise.all(r.map(async(c,d)=>{const f=d===0&&n?n:lr();return await Promise.all(this.handlers.map(h=>{if(!h.ignoreLLM)return cl(h)&&h._createRunForChatModelStart(e,[c],f,this._parentRunId,a,this.tags,this.metadata,l),Lt(async()=>{try{if(h.handleChatModelStart)await h.handleChatModelStart?.(e,[c],f,this._parentRunId,a,this.tags,this.metadata,l);else if(h.handleLLMStart){const p=WS(c);await h.handleLLMStart?.(e,[p],f,this._parentRunId,a,this.tags,this.metadata,l)}}catch(p){if((h.raiseError?console.error:console.warn)(`Error in handler ${h.constructor.name}, handleLLMStart: ${p}`),h.raiseError)throw p}},h.awaitHandlers)})),new Qj(f,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}))}async handleChainStart(e,r,n=lr(),i=void 0,a=void 0,o=void 0,s=void 0){return await Promise.all(this.handlers.map(l=>{if(!l.ignoreChain)return cl(l)&&l._createRunForChainStart(e,r,n,this._parentRunId,this.tags,this.metadata,i,s),Lt(async()=>{try{await l.handleChainStart?.(e,r,n,this._parentRunId,this.tags,this.metadata,i,s)}catch(c){if((l.raiseError?console.error:console.warn)(`Error in handler ${l.constructor.name}, handleChainStart: ${c}`),l.raiseError)throw c}},l.awaitHandlers)})),new WV(n,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}async handleToolStart(e,r,n=lr(),i=void 0,a=void 0,o=void 0,s=void 0){return await Promise.all(this.handlers.map(l=>{if(!l.ignoreAgent)return cl(l)&&l._createRunForToolStart(e,r,n,this._parentRunId,this.tags,this.metadata,s),Lt(async()=>{try{await l.handleToolStart?.(e,r,n,this._parentRunId,this.tags,this.metadata,s)}catch(c){if((l.raiseError?console.error:console.warn)(`Error in handler ${l.constructor.name}, handleToolStart: ${c}`),l.raiseError)throw c}},l.awaitHandlers)})),new KV(n,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}async handleRetrieverStart(e,r,n=lr(),i=void 0,a=void 0,o=void 0,s=void 0){return await Promise.all(this.handlers.map(l=>{if(!l.ignoreRetriever)return cl(l)&&l._createRunForRetrieverStart(e,r,n,this._parentRunId,this.tags,this.metadata,s),Lt(async()=>{try{await l.handleRetrieverStart?.(e,r,n,this._parentRunId,this.tags,this.metadata,s)}catch(c){if((l.raiseError?console.error:console.warn)(`Error in handler ${l.constructor.name}, handleRetrieverStart: ${c}`),l.raiseError)throw c}},l.awaitHandlers)})),new GV(n,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}async handleCustomEvent(e,r,n,i,a){await Promise.all(this.handlers.map(o=>Lt(async()=>{if(!o.ignoreCustomEvent)try{await o.handleCustomEvent?.(e,r,n,this.tags,this.metadata)}catch(s){if((o.raiseError?console.error:console.warn)(`Error in handler ${o.constructor.name}, handleCustomEvent: ${s}`),o.raiseError)throw s}},o.awaitHandlers)))}addHandler(e,r=!0){this.handlers.push(e),r&&this.inheritableHandlers.push(e)}removeHandler(e){this.handlers=this.handlers.filter(r=>r!==e),this.inheritableHandlers=this.inheritableHandlers.filter(r=>r!==e)}setHandlers(e,r=!0){this.handlers=[],this.inheritableHandlers=[];for(const n of e)this.addHandler(n,r)}addTags(e,r=!0){this.removeTags(e),this.tags.push(...e),r&&this.inheritableTags.push(...e)}removeTags(e){this.tags=this.tags.filter(r=>!e.includes(r)),this.inheritableTags=this.inheritableTags.filter(r=>!e.includes(r))}addMetadata(e,r=!0){this.metadata={...this.metadata,...e},r&&(this.inheritableMetadata={...this.inheritableMetadata,...e})}removeMetadata(e){for(const r of Object.keys(e))delete this.metadata[r],delete this.inheritableMetadata[r]}copy(e=[],r=!0){const n=new Wt(this._parentRunId);for(const i of this.handlers){const a=this.inheritableHandlers.includes(i);n.addHandler(i,a)}for(const i of this.tags){const a=this.inheritableTags.includes(i);n.addTags([i],a)}for(const i of Object.keys(this.metadata)){const a=Object.keys(this.inheritableMetadata).includes(i);n.addMetadata({[i]:this.metadata[i]},a)}for(const i of e)n.handlers.filter(a=>a.name==="console_callback_handler").some(a=>a.name===i.name)||n.addHandler(i,r);return n}static fromHandlers(e){class r extends Wc{constructor(){super(),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:lr()}),Object.assign(this,e)}}const n=new this;return n.addHandler(new r),n}static configure(e,r,n,i,a,o,s){return this._configureSync(e,r,n,i,a,o,s)}static _configureSync(e,r,n,i,a,o,s){let l;(e||r)&&(Array.isArray(e)||!e?(l=new Wt,l.setHandlers(e?.map(ay)??[],!0)):l=e,l=l.copy(Array.isArray(r)?r.map(ay):r?.handlers,!1));const c=Ye("LANGCHAIN_VERBOSE")==="true"||s?.verbose,d=sc.getTraceableRunTree()?.tracingEnabled||LV(),f=d||(Ye("LANGCHAIN_TRACING")??!1);if(c||f){if(l||(l=new Wt),c&&!l.handlers.some(h=>h.name===$j.prototype.name)){const h=new $j;l.addHandler(h,!0)}if(f&&!l.handlers.some(h=>h.name==="langchain_tracer")&&d){const h=new sc;l.addHandler(h,!0),l._parentRunId=sc.getTraceableRunTree()?.id??l._parentRunId}}for(const{contextVar:h,inheritable:p=!0,handlerClass:b,envVar:g}of kV()){const v=g&&Ye(g)==="true"&&b;let E;const C=h!==void 0?k$(h):void 0;C&&N4(C)?E=C:v&&(E=new b({})),E!==void 0&&(l||(l=new Wt),l.handlers.some(S=>S.name===E.name)||l.addHandler(E,p))}return(n||i)&&l&&(l.addTags(n??[]),l.addTags(i??[],!1)),(a||o)&&l&&(l.addMetadata(a??{}),l.addMetadata(o??{},!1)),l}}function ay(t){return"name"in t?t:Wc.fromMethods(t)}var Ge;(function(t){t.assertEqual=i=>i;function e(i){}t.assertIs=e;function r(i){throw new Error}t.assertNever=r,t.arrayToEnum=i=>{const a={};for(const o of i)a[o]=o;return a},t.getValidEnumValues=i=>{const a=t.objectKeys(i).filter(s=>typeof i[i[s]]!="number"),o={};for(const s of a)o[s]=i[s];return t.objectValues(o)},t.objectValues=i=>t.objectKeys(i).map(function(a){return i[a]}),t.objectKeys=typeof Object.keys=="function"?i=>Object.keys(i):i=>{const a=[];for(const o in i)Object.prototype.hasOwnProperty.call(i,o)&&a.push(o);return a},t.find=(i,a)=>{for(const o of i)if(a(o))return o},t.isInteger=typeof Number.isInteger=="function"?i=>Number.isInteger(i):i=>typeof i=="number"&&isFinite(i)&&Math.floor(i)===i;function n(i,a=" | "){return i.map(o=>typeof o=="string"?`'${o}'`:o).join(a)}t.joinValues=n,t.jsonStringifyReplacer=(i,a)=>typeof a=="bigint"?a.toString():a})(Ge||(Ge={}));var oy;(function(t){t.mergeShapes=(e,r)=>({...e,...r})})(oy||(oy={}));const fe=Ge.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Qn=t=>{switch(typeof t){case"undefined":return fe.undefined;case"string":return fe.string;case"number":return isNaN(t)?fe.nan:fe.number;case"boolean":return fe.boolean;case"function":return fe.function;case"bigint":return fe.bigint;case"symbol":return fe.symbol;case"object":return Array.isArray(t)?fe.array:t===null?fe.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?fe.promise:typeof Map<"u"&&t instanceof Map?fe.map:typeof Set<"u"&&t instanceof Set?fe.set:typeof Date<"u"&&t instanceof Date?fe.date:fe.object;default:return fe.unknown}},K=Ge.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),H$=t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:");class Cr extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};const r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name="ZodError",this.issues=e}format(e){const r=e||function(a){return a.message},n={_errors:[]},i=a=>{for(const o of a.issues)if(o.code==="invalid_union")o.unionErrors.map(i);else if(o.code==="invalid_return_type")i(o.returnTypeError);else if(o.code==="invalid_arguments")i(o.argumentsError);else if(o.path.length===0)n._errors.push(r(o));else{let s=n,l=0;for(;l<o.path.length;){const c=o.path[l];l===o.path.length-1?(s[c]=s[c]||{_errors:[]},s[c]._errors.push(r(o))):s[c]=s[c]||{_errors:[]},s=s[c],l++}}};return i(this),n}static assert(e){if(!(e instanceof Cr))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Ge.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=r=>r.message){const r={},n=[];for(const i of this.issues)i.path.length>0?(r[i.path[0]]=r[i.path[0]]||[],r[i.path[0]].push(e(i))):n.push(e(i));return{formErrors:n,fieldErrors:r}}get formErrors(){return this.flatten()}}Cr.create=t=>new Cr(t);const go=(t,e)=>{let r;switch(t.code){case K.invalid_type:t.received===fe.undefined?r="Required":r=`Expected ${t.expected}, received ${t.received}`;break;case K.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(t.expected,Ge.jsonStringifyReplacer)}`;break;case K.unrecognized_keys:r=`Unrecognized key(s) in object: ${Ge.joinValues(t.keys,", ")}`;break;case K.invalid_union:r="Invalid input";break;case K.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${Ge.joinValues(t.options)}`;break;case K.invalid_enum_value:r=`Invalid enum value. Expected ${Ge.joinValues(t.options)}, received '${t.received}'`;break;case K.invalid_arguments:r="Invalid function arguments";break;case K.invalid_return_type:r="Invalid function return type";break;case K.invalid_date:r="Invalid date";break;case K.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(r=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(r=`${r} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?r=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?r=`Invalid input: must end with "${t.validation.endsWith}"`:Ge.assertNever(t.validation):t.validation!=="regex"?r=`Invalid ${t.validation}`:r="Invalid";break;case K.too_small:t.type==="array"?r=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?r=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?r=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?r=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:r="Invalid input";break;case K.too_big:t.type==="array"?r=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?r=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?r=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?r=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?r=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:r="Invalid input";break;case K.custom:r="Invalid input";break;case K.invalid_intersection_types:r="Intersection results could not be merged";break;case K.not_multiple_of:r=`Number must be a multiple of ${t.multipleOf}`;break;case K.not_finite:r="Number must be finite";break;default:r=e.defaultError,Ge.assertNever(t)}return{message:r}};let q$=go;function G$(t){q$=t}function Tc(){return q$}const Rc=t=>{const{data:e,path:r,errorMaps:n,issueData:i}=t,a=[...r,...i.path||[]],o={...i,path:a};if(i.message!==void 0)return{...i,path:a,message:i.message};let s="";const l=n.filter(c=>!!c).slice().reverse();for(const c of l)s=c(o,{data:e,defaultError:s}).message;return{...i,path:a,message:s}},W$=[];function ue(t,e){const r=Tc(),n=Rc({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,r,r===go?void 0:go].filter(i=>!!i)});t.common.issues.push(n)}class Qt{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,r){const n=[];for(const i of r){if(i.status==="aborted")return Ee;i.status==="dirty"&&e.dirty(),n.push(i.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,r){const n=[];for(const i of r){const a=await i.key,o=await i.value;n.push({key:a,value:o})}return Qt.mergeObjectSync(e,n)}static mergeObjectSync(e,r){const n={};for(const i of r){const{key:a,value:o}=i;if(a.status==="aborted"||o.status==="aborted")return Ee;a.status==="dirty"&&e.dirty(),o.status==="dirty"&&e.dirty(),a.value!=="__proto__"&&(typeof o.value<"u"||i.alwaysSet)&&(n[a.value]=o.value)}return{status:e.value,value:n}}}const Ee=Object.freeze({status:"aborted"}),oo=t=>({status:"dirty",value:t}),dr=t=>({status:"valid",value:t}),sy=t=>t.status==="aborted",uy=t=>t.status==="dirty",ja=t=>t.status==="valid",eu=t=>typeof Promise<"u"&&t instanceof Promise;function ly(t,e,r,n){if(typeof e=="function"?t!==e||!0:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return e.get(t)}function K$(t,e,r,n,i){if(typeof e=="function"?t!==e||!0:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(t,r),r}var be;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e?.message})(be||(be={}));var Jl,Xl;class oi{constructor(e,r,n,i){this._cachedPath=[],this.parent=e,this.data=r,this._path=n,this._key=i}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const eC=(t,e)=>{if(ja(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const r=new Cr(t.common.issues);return this._error=r,this._error}}};function Ie(t){if(!t)return{};const{errorMap:e,invalid_type_error:r,required_error:n,description:i}=t;if(e&&(r||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:i}:{errorMap:(o,s)=>{var l,c;const{message:d}=t;return o.code==="invalid_enum_value"?{message:d??s.defaultError}:typeof s.data>"u"?{message:(l=d??n)!==null&&l!==void 0?l:s.defaultError}:o.code!=="invalid_type"?{message:s.defaultError}:{message:(c=d??r)!==null&&c!==void 0?c:s.defaultError}},description:i}}class Ae{get description(){return this._def.description}_getType(e){return Qn(e.data)}_getOrReturnCtx(e,r){return r||{common:e.parent.common,data:e.data,parsedType:Qn(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Qt,ctx:{common:e.parent.common,data:e.data,parsedType:Qn(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const r=this._parse(e);if(eu(r))throw new Error("Synchronous parse encountered promise.");return r}_parseAsync(e){const r=this._parse(e);return Promise.resolve(r)}parse(e,r){const n=this.safeParse(e,r);if(n.success)return n.data;throw n.error}safeParse(e,r){var n;const i={common:{issues:[],async:(n=r?.async)!==null&&n!==void 0?n:!1,contextualErrorMap:r?.errorMap},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Qn(e)},a=this._parseSync({data:e,path:i.path,parent:i});return eC(i,a)}"~validate"(e){var r,n;const i={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Qn(e)};if(!this["~standard"].async)try{const a=this._parseSync({data:e,path:[],parent:i});return ja(a)?{value:a.value}:{issues:i.common.issues}}catch(a){!((n=(r=a?.message)===null||r===void 0?void 0:r.toLowerCase())===null||n===void 0)&&n.includes("encountered")&&(this["~standard"].async=!0),i.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:i}).then(a=>ja(a)?{value:a.value}:{issues:i.common.issues})}async parseAsync(e,r){const n=await this.safeParseAsync(e,r);if(n.success)return n.data;throw n.error}async safeParseAsync(e,r){const n={common:{issues:[],contextualErrorMap:r?.errorMap,async:!0},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Qn(e)},i=this._parse({data:e,path:n.path,parent:n}),a=await(eu(i)?i:Promise.resolve(i));return eC(n,a)}refine(e,r){const n=i=>typeof r=="string"||typeof r>"u"?{message:r}:typeof r=="function"?r(i):r;return this._refinement((i,a)=>{const o=e(i),s=()=>a.addIssue({code:K.custom,...n(i)});return typeof Promise<"u"&&o instanceof Promise?o.then(l=>l?!0:(s(),!1)):o?!0:(s(),!1)})}refinement(e,r){return this._refinement((n,i)=>e(n)?!0:(i.addIssue(typeof r=="function"?r(n,i):r),!1))}_refinement(e){return new Jr({schema:this,typeName:B.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:r=>this["~validate"](r)}}optional(){return hn.create(this,this._def)}nullable(){return Bi.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return fn.create(this)}promise(){return vo.create(this,this._def)}or(e){return iu.create([this,e],this._def)}and(e){return au.create(this,e,this._def)}transform(e){return new Jr({...Ie(this._def),schema:this,typeName:B.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const r=typeof e=="function"?e:()=>e;return new cu({...Ie(this._def),innerType:this,defaultValue:r,typeName:B.ZodDefault})}brand(){return new tb({typeName:B.ZodBranded,type:this,...Ie(this._def)})}catch(e){const r=typeof e=="function"?e:()=>e;return new du({...Ie(this._def),innerType:this,catchValue:r,typeName:B.ZodCatch})}describe(e){const r=this.constructor;return new r({...this._def,description:e})}pipe(e){return Ru.create(this,e)}readonly(){return fu.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const JV=/^c[^\s-]{8,}$/i,XV=/^[0-9a-z]+$/,ZV=/^[0-9A-HJKMNP-TV-Z]{26}$/i,YV=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,QV=/^[a-z0-9_-]{21}$/i,e8=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,t8=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,r8=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,n8="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let aw;const i8=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,a8=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,o8=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,s8=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,u8=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,l8=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,J$="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",c8=new RegExp(`^${J$}$`);function X$(t){let e="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`),e}function d8(t){return new RegExp(`^${X$(t)}$`)}function eE(t){let e=`${J$}T${X$(t)}`;const r=[];return r.push(t.local?"Z?":"Z"),t.offset&&r.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${r.join("|")})`,new RegExp(`^${e}$`)}function f8(t,e){return!!((e==="v4"||!e)&&i8.test(t)||(e==="v6"||!e)&&o8.test(t))}function h8(t,e){if(!e8.test(t))return!1;try{const[r]=t.split("."),n=r.replace(/-/g,"+").replace(/_/g,"/").padEnd(r.length+(4-r.length%4)%4,"="),i=JSON.parse(atob(n));return!(typeof i!="object"||i===null||!i.typ||!i.alg||e&&i.alg!==e)}catch{return!1}}function p8(t,e){return!!((e==="v4"||!e)&&a8.test(t)||(e==="v6"||!e)&&s8.test(t))}class dn extends Ae{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==fe.string){const a=this._getOrReturnCtx(e);return ue(a,{code:K.invalid_type,expected:fe.string,received:a.parsedType}),Ee}const n=new Qt;let i;for(const a of this._def.checks)if(a.kind==="min")e.data.length<a.value&&(i=this._getOrReturnCtx(e,i),ue(i,{code:K.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),n.dirty());else if(a.kind==="max")e.data.length>a.value&&(i=this._getOrReturnCtx(e,i),ue(i,{code:K.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),n.dirty());else if(a.kind==="length"){const o=e.data.length>a.value,s=e.data.length<a.value;(o||s)&&(i=this._getOrReturnCtx(e,i),o?ue(i,{code:K.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}):s&&ue(i,{code:K.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}),n.dirty())}else if(a.kind==="email")r8.test(e.data)||(i=this._getOrReturnCtx(e,i),ue(i,{validation:"email",code:K.invalid_string,message:a.message}),n.dirty());else if(a.kind==="emoji")aw||(aw=new RegExp(n8,"u")),aw.test(e.data)||(i=this._getOrReturnCtx(e,i),ue(i,{validation:"emoji",code:K.invalid_string,message:a.message}),n.dirty());else if(a.kind==="uuid")YV.test(e.data)||(i=this._getOrReturnCtx(e,i),ue(i,{validation:"uuid",code:K.invalid_string,message:a.message}),n.dirty());else if(a.kind==="nanoid")QV.test(e.data)||(i=this._getOrReturnCtx(e,i),ue(i,{validation:"nanoid",code:K.invalid_string,message:a.message}),n.dirty());else if(a.kind==="cuid")JV.test(e.data)||(i=this._getOrReturnCtx(e,i),ue(i,{validation:"cuid",code:K.invalid_string,message:a.message}),n.dirty());else if(a.kind==="cuid2")XV.test(e.data)||(i=this._getOrReturnCtx(e,i),ue(i,{validation:"cuid2",code:K.invalid_string,message:a.message}),n.dirty());else if(a.kind==="ulid")ZV.test(e.data)||(i=this._getOrReturnCtx(e,i),ue(i,{validation:"ulid",code:K.invalid_string,message:a.message}),n.dirty());else if(a.kind==="url")try{new URL(e.data)}catch{i=this._getOrReturnCtx(e,i),ue(i,{validation:"url",code:K.invalid_string,message:a.message}),n.dirty()}else a.kind==="regex"?(a.regex.lastIndex=0,a.regex.test(e.data)||(i=this._getOrReturnCtx(e,i),ue(i,{validation:"regex",code:K.invalid_string,message:a.message}),n.dirty())):a.kind==="trim"?e.data=e.data.trim():a.kind==="includes"?e.data.includes(a.value,a.position)||(i=this._getOrReturnCtx(e,i),ue(i,{code:K.invalid_string,validation:{includes:a.value,position:a.position},message:a.message}),n.dirty()):a.kind==="toLowerCase"?e.data=e.data.toLowerCase():a.kind==="toUpperCase"?e.data=e.data.toUpperCase():a.kind==="startsWith"?e.data.startsWith(a.value)||(i=this._getOrReturnCtx(e,i),ue(i,{code:K.invalid_string,validation:{startsWith:a.value},message:a.message}),n.dirty()):a.kind==="endsWith"?e.data.endsWith(a.value)||(i=this._getOrReturnCtx(e,i),ue(i,{code:K.invalid_string,validation:{endsWith:a.value},message:a.message}),n.dirty()):a.kind==="datetime"?eE(a).test(e.data)||(i=this._getOrReturnCtx(e,i),ue(i,{code:K.invalid_string,validation:"datetime",message:a.message}),n.dirty()):a.kind==="date"?c8.test(e.data)||(i=this._getOrReturnCtx(e,i),ue(i,{code:K.invalid_string,validation:"date",message:a.message}),n.dirty()):a.kind==="time"?d8(a).test(e.data)||(i=this._getOrReturnCtx(e,i),ue(i,{code:K.invalid_string,validation:"time",message:a.message}),n.dirty()):a.kind==="duration"?t8.test(e.data)||(i=this._getOrReturnCtx(e,i),ue(i,{validation:"duration",code:K.invalid_string,message:a.message}),n.dirty()):a.kind==="ip"?f8(e.data,a.version)||(i=this._getOrReturnCtx(e,i),ue(i,{validation:"ip",code:K.invalid_string,message:a.message}),n.dirty()):a.kind==="jwt"?h8(e.data,a.alg)||(i=this._getOrReturnCtx(e,i),ue(i,{validation:"jwt",code:K.invalid_string,message:a.message}),n.dirty()):a.kind==="cidr"?p8(e.data,a.version)||(i=this._getOrReturnCtx(e,i),ue(i,{validation:"cidr",code:K.invalid_string,message:a.message}),n.dirty()):a.kind==="base64"?u8.test(e.data)||(i=this._getOrReturnCtx(e,i),ue(i,{validation:"base64",code:K.invalid_string,message:a.message}),n.dirty()):a.kind==="base64url"?l8.test(e.data)||(i=this._getOrReturnCtx(e,i),ue(i,{validation:"base64url",code:K.invalid_string,message:a.message}),n.dirty()):Ge.assertNever(a);return{status:n.value,value:e.data}}_regex(e,r,n){return this.refinement(i=>e.test(i),{validation:r,code:K.invalid_string,...be.errToObj(n)})}_addCheck(e){return new dn({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...be.errToObj(e)})}url(e){return this._addCheck({kind:"url",...be.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...be.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...be.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...be.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...be.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...be.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...be.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...be.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...be.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...be.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...be.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...be.errToObj(e)})}datetime(e){var r,n;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:(r=e?.offset)!==null&&r!==void 0?r:!1,local:(n=e?.local)!==null&&n!==void 0?n:!1,...be.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof e?.precision>"u"?null:e?.precision,...be.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...be.errToObj(e)})}regex(e,r){return this._addCheck({kind:"regex",regex:e,...be.errToObj(r)})}includes(e,r){return this._addCheck({kind:"includes",value:e,position:r?.position,...be.errToObj(r?.message)})}startsWith(e,r){return this._addCheck({kind:"startsWith",value:e,...be.errToObj(r)})}endsWith(e,r){return this._addCheck({kind:"endsWith",value:e,...be.errToObj(r)})}min(e,r){return this._addCheck({kind:"min",value:e,...be.errToObj(r)})}max(e,r){return this._addCheck({kind:"max",value:e,...be.errToObj(r)})}length(e,r){return this._addCheck({kind:"length",value:e,...be.errToObj(r)})}nonempty(e){return this.min(1,be.errToObj(e))}trim(){return new dn({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new dn({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new dn({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(const r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxLength(){let e=null;for(const r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}}dn.create=t=>{var e;return new dn({checks:[],typeName:B.ZodString,coerce:(e=t?.coerce)!==null&&e!==void 0?e:!1,...Ie(t)})};function _8(t,e){const r=(t.toString().split(".")[1]||"").length,n=(e.toString().split(".")[1]||"").length,i=r>n?r:n,a=parseInt(t.toFixed(i).replace(".","")),o=parseInt(e.toFixed(i).replace(".",""));return a%o/Math.pow(10,i)}class Di extends Ae{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==fe.number){const a=this._getOrReturnCtx(e);return ue(a,{code:K.invalid_type,expected:fe.number,received:a.parsedType}),Ee}let n;const i=new Qt;for(const a of this._def.checks)a.kind==="int"?Ge.isInteger(e.data)||(n=this._getOrReturnCtx(e,n),ue(n,{code:K.invalid_type,expected:"integer",received:"float",message:a.message}),i.dirty()):a.kind==="min"?(a.inclusive?e.data<a.value:e.data<=a.value)&&(n=this._getOrReturnCtx(e,n),ue(n,{code:K.too_small,minimum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),i.dirty()):a.kind==="max"?(a.inclusive?e.data>a.value:e.data>=a.value)&&(n=this._getOrReturnCtx(e,n),ue(n,{code:K.too_big,maximum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),i.dirty()):a.kind==="multipleOf"?_8(e.data,a.value)!==0&&(n=this._getOrReturnCtx(e,n),ue(n,{code:K.not_multiple_of,multipleOf:a.value,message:a.message}),i.dirty()):a.kind==="finite"?Number.isFinite(e.data)||(n=this._getOrReturnCtx(e,n),ue(n,{code:K.not_finite,message:a.message}),i.dirty()):Ge.assertNever(a);return{status:i.value,value:e.data}}gte(e,r){return this.setLimit("min",e,!0,be.toString(r))}gt(e,r){return this.setLimit("min",e,!1,be.toString(r))}lte(e,r){return this.setLimit("max",e,!0,be.toString(r))}lt(e,r){return this.setLimit("max",e,!1,be.toString(r))}setLimit(e,r,n,i){return new Di({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:n,message:be.toString(i)}]})}_addCheck(e){return new Di({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:be.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:be.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:be.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:be.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:be.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:be.toString(r)})}finite(e){return this._addCheck({kind:"finite",message:be.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:be.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:be.toString(e)})}get minValue(){let e=null;for(const r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(const r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&Ge.isInteger(e.value))}get isFinite(){let e=null,r=null;for(const n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(r===null||n.value>r)&&(r=n.value):n.kind==="max"&&(e===null||n.value<e)&&(e=n.value)}return Number.isFinite(r)&&Number.isFinite(e)}}Di.create=t=>new Di({checks:[],typeName:B.ZodNumber,coerce:t?.coerce||!1,...Ie(t)});class Ni extends Ae{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==fe.bigint)return this._getInvalidInput(e);let n;const i=new Qt;for(const a of this._def.checks)a.kind==="min"?(a.inclusive?e.data<a.value:e.data<=a.value)&&(n=this._getOrReturnCtx(e,n),ue(n,{code:K.too_small,type:"bigint",minimum:a.value,inclusive:a.inclusive,message:a.message}),i.dirty()):a.kind==="max"?(a.inclusive?e.data>a.value:e.data>=a.value)&&(n=this._getOrReturnCtx(e,n),ue(n,{code:K.too_big,type:"bigint",maximum:a.value,inclusive:a.inclusive,message:a.message}),i.dirty()):a.kind==="multipleOf"?e.data%a.value!==BigInt(0)&&(n=this._getOrReturnCtx(e,n),ue(n,{code:K.not_multiple_of,multipleOf:a.value,message:a.message}),i.dirty()):Ge.assertNever(a);return{status:i.value,value:e.data}}_getInvalidInput(e){const r=this._getOrReturnCtx(e);return ue(r,{code:K.invalid_type,expected:fe.bigint,received:r.parsedType}),Ee}gte(e,r){return this.setLimit("min",e,!0,be.toString(r))}gt(e,r){return this.setLimit("min",e,!1,be.toString(r))}lte(e,r){return this.setLimit("max",e,!0,be.toString(r))}lt(e,r){return this.setLimit("max",e,!1,be.toString(r))}setLimit(e,r,n,i){return new Ni({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:n,message:be.toString(i)}]})}_addCheck(e){return new Ni({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:be.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:be.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:be.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:be.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:be.toString(r)})}get minValue(){let e=null;for(const r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(const r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}}Ni.create=t=>{var e;return new Ni({checks:[],typeName:B.ZodBigInt,coerce:(e=t?.coerce)!==null&&e!==void 0?e:!1,...Ie(t)})};class tu extends Ae{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==fe.boolean){const n=this._getOrReturnCtx(e);return ue(n,{code:K.invalid_type,expected:fe.boolean,received:n.parsedType}),Ee}return dr(e.data)}}tu.create=t=>new tu({typeName:B.ZodBoolean,coerce:t?.coerce||!1,...Ie(t)});class Ca extends Ae{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==fe.date){const a=this._getOrReturnCtx(e);return ue(a,{code:K.invalid_type,expected:fe.date,received:a.parsedType}),Ee}if(isNaN(e.data.getTime())){const a=this._getOrReturnCtx(e);return ue(a,{code:K.invalid_date}),Ee}const n=new Qt;let i;for(const a of this._def.checks)a.kind==="min"?e.data.getTime()<a.value&&(i=this._getOrReturnCtx(e,i),ue(i,{code:K.too_small,message:a.message,inclusive:!0,exact:!1,minimum:a.value,type:"date"}),n.dirty()):a.kind==="max"?e.data.getTime()>a.value&&(i=this._getOrReturnCtx(e,i),ue(i,{code:K.too_big,message:a.message,inclusive:!0,exact:!1,maximum:a.value,type:"date"}),n.dirty()):Ge.assertNever(a);return{status:n.value,value:new Date(e.data.getTime())}}_addCheck(e){return new Ca({...this._def,checks:[...this._def.checks,e]})}min(e,r){return this._addCheck({kind:"min",value:e.getTime(),message:be.toString(r)})}max(e,r){return this._addCheck({kind:"max",value:e.getTime(),message:be.toString(r)})}get minDate(){let e=null;for(const r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e!=null?new Date(e):null}}Ca.create=t=>new Ca({checks:[],coerce:t?.coerce||!1,typeName:B.ZodDate,...Ie(t)});class Ac extends Ae{_parse(e){if(this._getType(e)!==fe.symbol){const n=this._getOrReturnCtx(e);return ue(n,{code:K.invalid_type,expected:fe.symbol,received:n.parsedType}),Ee}return dr(e.data)}}Ac.create=t=>new Ac({typeName:B.ZodSymbol,...Ie(t)});class ru extends Ae{_parse(e){if(this._getType(e)!==fe.undefined){const n=this._getOrReturnCtx(e);return ue(n,{code:K.invalid_type,expected:fe.undefined,received:n.parsedType}),Ee}return dr(e.data)}}ru.create=t=>new ru({typeName:B.ZodUndefined,...Ie(t)});class nu extends Ae{_parse(e){if(this._getType(e)!==fe.null){const n=this._getOrReturnCtx(e);return ue(n,{code:K.invalid_type,expected:fe.null,received:n.parsedType}),Ee}return dr(e.data)}}nu.create=t=>new nu({typeName:B.ZodNull,...Ie(t)});class mo extends Ae{constructor(){super(...arguments),this._any=!0}_parse(e){return dr(e.data)}}mo.create=t=>new mo({typeName:B.ZodAny,...Ie(t)});class ma extends Ae{constructor(){super(...arguments),this._unknown=!0}_parse(e){return dr(e.data)}}ma.create=t=>new ma({typeName:B.ZodUnknown,...Ie(t)});class si extends Ae{_parse(e){const r=this._getOrReturnCtx(e);return ue(r,{code:K.invalid_type,expected:fe.never,received:r.parsedType}),Ee}}si.create=t=>new si({typeName:B.ZodNever,...Ie(t)});class $c extends Ae{_parse(e){if(this._getType(e)!==fe.undefined){const n=this._getOrReturnCtx(e);return ue(n,{code:K.invalid_type,expected:fe.void,received:n.parsedType}),Ee}return dr(e.data)}}$c.create=t=>new $c({typeName:B.ZodVoid,...Ie(t)});class fn extends Ae{_parse(e){const{ctx:r,status:n}=this._processInputParams(e),i=this._def;if(r.parsedType!==fe.array)return ue(r,{code:K.invalid_type,expected:fe.array,received:r.parsedType}),Ee;if(i.exactLength!==null){const o=r.data.length>i.exactLength.value,s=r.data.length<i.exactLength.value;(o||s)&&(ue(r,{code:o?K.too_big:K.too_small,minimum:s?i.exactLength.value:void 0,maximum:o?i.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:i.exactLength.message}),n.dirty())}if(i.minLength!==null&&r.data.length<i.minLength.value&&(ue(r,{code:K.too_small,minimum:i.minLength.value,type:"array",inclusive:!0,exact:!1,message:i.minLength.message}),n.dirty()),i.maxLength!==null&&r.data.length>i.maxLength.value&&(ue(r,{code:K.too_big,maximum:i.maxLength.value,type:"array",inclusive:!0,exact:!1,message:i.maxLength.message}),n.dirty()),r.common.async)return Promise.all([...r.data].map((o,s)=>i.type._parseAsync(new oi(r,o,r.path,s)))).then(o=>Qt.mergeArray(n,o));const a=[...r.data].map((o,s)=>i.type._parseSync(new oi(r,o,r.path,s)));return Qt.mergeArray(n,a)}get element(){return this._def.type}min(e,r){return new fn({...this._def,minLength:{value:e,message:be.toString(r)}})}max(e,r){return new fn({...this._def,maxLength:{value:e,message:be.toString(r)}})}length(e,r){return new fn({...this._def,exactLength:{value:e,message:be.toString(r)}})}nonempty(e){return this.min(1,e)}}fn.create=(t,e)=>new fn({type:t,minLength:null,maxLength:null,exactLength:null,typeName:B.ZodArray,...Ie(e)});function Ss(t){if(t instanceof Pt){const e={};for(const r in t.shape){const n=t.shape[r];e[r]=hn.create(Ss(n))}return new Pt({...t._def,shape:()=>e})}else return t instanceof fn?new fn({...t._def,type:Ss(t.element)}):t instanceof hn?hn.create(Ss(t.unwrap())):t instanceof Bi?Bi.create(Ss(t.unwrap())):t instanceof zn?zn.create(t.items.map(e=>Ss(e))):t}class Pt extends Ae{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),r=Ge.objectKeys(e);return this._cached={shape:e,keys:r}}_parse(e){if(this._getType(e)!==fe.object){const c=this._getOrReturnCtx(e);return ue(c,{code:K.invalid_type,expected:fe.object,received:c.parsedType}),Ee}const{status:n,ctx:i}=this._processInputParams(e),{shape:a,keys:o}=this._getCached(),s=[];if(!(this._def.catchall instanceof si&&this._def.unknownKeys==="strip"))for(const c in i.data)o.includes(c)||s.push(c);const l=[];for(const c of o){const d=a[c],f=i.data[c];l.push({key:{status:"valid",value:c},value:d._parse(new oi(i,f,i.path,c)),alwaysSet:c in i.data})}if(this._def.catchall instanceof si){const c=this._def.unknownKeys;if(c==="passthrough")for(const d of s)l.push({key:{status:"valid",value:d},value:{status:"valid",value:i.data[d]}});else if(c==="strict")s.length>0&&(ue(i,{code:K.unrecognized_keys,keys:s}),n.dirty());else if(c!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const c=this._def.catchall;for(const d of s){const f=i.data[d];l.push({key:{status:"valid",value:d},value:c._parse(new oi(i,f,i.path,d)),alwaysSet:d in i.data})}}return i.common.async?Promise.resolve().then(async()=>{const c=[];for(const d of l){const f=await d.key,h=await d.value;c.push({key:f,value:h,alwaysSet:d.alwaysSet})}return c}).then(c=>Qt.mergeObjectSync(n,c)):Qt.mergeObjectSync(n,l)}get shape(){return this._def.shape()}strict(e){return be.errToObj,new Pt({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(r,n)=>{var i,a,o,s;const l=(o=(a=(i=this._def).errorMap)===null||a===void 0?void 0:a.call(i,r,n).message)!==null&&o!==void 0?o:n.defaultError;return r.code==="unrecognized_keys"?{message:(s=be.errToObj(e).message)!==null&&s!==void 0?s:l}:{message:l}}}:{}})}strip(){return new Pt({...this._def,unknownKeys:"strip"})}passthrough(){return new Pt({...this._def,unknownKeys:"passthrough"})}extend(e){return new Pt({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new Pt({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:B.ZodObject})}setKey(e,r){return this.augment({[e]:r})}catchall(e){return new Pt({...this._def,catchall:e})}pick(e){const r={};return Ge.objectKeys(e).forEach(n=>{e[n]&&this.shape[n]&&(r[n]=this.shape[n])}),new Pt({...this._def,shape:()=>r})}omit(e){const r={};return Ge.objectKeys(this.shape).forEach(n=>{e[n]||(r[n]=this.shape[n])}),new Pt({...this._def,shape:()=>r})}deepPartial(){return Ss(this)}partial(e){const r={};return Ge.objectKeys(this.shape).forEach(n=>{const i=this.shape[n];e&&!e[n]?r[n]=i:r[n]=i.optional()}),new Pt({...this._def,shape:()=>r})}required(e){const r={};return Ge.objectKeys(this.shape).forEach(n=>{if(e&&!e[n])r[n]=this.shape[n];else{let a=this.shape[n];for(;a instanceof hn;)a=a._def.innerType;r[n]=a}}),new Pt({...this._def,shape:()=>r})}keyof(){return Z$(Ge.objectKeys(this.shape))}}Pt.create=(t,e)=>new Pt({shape:()=>t,unknownKeys:"strip",catchall:si.create(),typeName:B.ZodObject,...Ie(e)});Pt.strictCreate=(t,e)=>new Pt({shape:()=>t,unknownKeys:"strict",catchall:si.create(),typeName:B.ZodObject,...Ie(e)});Pt.lazycreate=(t,e)=>new Pt({shape:t,unknownKeys:"strip",catchall:si.create(),typeName:B.ZodObject,...Ie(e)});class iu extends Ae{_parse(e){const{ctx:r}=this._processInputParams(e),n=this._def.options;function i(a){for(const s of a)if(s.result.status==="valid")return s.result;for(const s of a)if(s.result.status==="dirty")return r.common.issues.push(...s.ctx.common.issues),s.result;const o=a.map(s=>new Cr(s.ctx.common.issues));return ue(r,{code:K.invalid_union,unionErrors:o}),Ee}if(r.common.async)return Promise.all(n.map(async a=>{const o={...r,common:{...r.common,issues:[]},parent:null};return{result:await a._parseAsync({data:r.data,path:r.path,parent:o}),ctx:o}})).then(i);{let a;const o=[];for(const l of n){const c={...r,common:{...r.common,issues:[]},parent:null},d=l._parseSync({data:r.data,path:r.path,parent:c});if(d.status==="valid")return d;d.status==="dirty"&&!a&&(a={result:d,ctx:c}),c.common.issues.length&&o.push(c.common.issues)}if(a)return r.common.issues.push(...a.ctx.common.issues),a.result;const s=o.map(l=>new Cr(l));return ue(r,{code:K.invalid_union,unionErrors:s}),Ee}}get options(){return this._def.options}}iu.create=(t,e)=>new iu({options:t,typeName:B.ZodUnion,...Ie(e)});const Pi=t=>t instanceof su?Pi(t.schema):t instanceof Jr?Pi(t.innerType()):t instanceof uu?[t.value]:t instanceof zi?t.options:t instanceof lu?Ge.objectValues(t.enum):t instanceof cu?Pi(t._def.innerType):t instanceof ru?[void 0]:t instanceof nu?[null]:t instanceof hn?[void 0,...Pi(t.unwrap())]:t instanceof Bi?[null,...Pi(t.unwrap())]:t instanceof tb||t instanceof fu?Pi(t.unwrap()):t instanceof du?Pi(t._def.innerType):[];class Yc extends Ae{_parse(e){const{ctx:r}=this._processInputParams(e);if(r.parsedType!==fe.object)return ue(r,{code:K.invalid_type,expected:fe.object,received:r.parsedType}),Ee;const n=this.discriminator,i=r.data[n],a=this.optionsMap.get(i);return a?r.common.async?a._parseAsync({data:r.data,path:r.path,parent:r}):a._parseSync({data:r.data,path:r.path,parent:r}):(ue(r,{code:K.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[n]}),Ee)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,r,n){const i=new Map;for(const a of r){const o=Pi(a.shape[e]);if(!o.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const s of o){if(i.has(s))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(s)}`);i.set(s,a)}}return new Yc({typeName:B.ZodDiscriminatedUnion,discriminator:e,options:r,optionsMap:i,...Ie(n)})}}function EO(t,e){const r=Qn(t),n=Qn(e);if(t===e)return{valid:!0,data:t};if(r===fe.object&&n===fe.object){const i=Ge.objectKeys(e),a=Ge.objectKeys(t).filter(s=>i.indexOf(s)!==-1),o={...t,...e};for(const s of a){const l=EO(t[s],e[s]);if(!l.valid)return{valid:!1};o[s]=l.data}return{valid:!0,data:o}}else if(r===fe.array&&n===fe.array){if(t.length!==e.length)return{valid:!1};const i=[];for(let a=0;a<t.length;a++){const o=t[a],s=e[a],l=EO(o,s);if(!l.valid)return{valid:!1};i.push(l.data)}return{valid:!0,data:i}}else return r===fe.date&&n===fe.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}class au extends Ae{_parse(e){const{status:r,ctx:n}=this._processInputParams(e),i=(a,o)=>{if(sy(a)||sy(o))return Ee;const s=EO(a.value,o.value);return s.valid?((uy(a)||uy(o))&&r.dirty(),{status:r.value,value:s.data}):(ue(n,{code:K.invalid_intersection_types}),Ee)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([a,o])=>i(a,o)):i(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}}au.create=(t,e,r)=>new au({left:t,right:e,typeName:B.ZodIntersection,...Ie(r)});class zn extends Ae{_parse(e){const{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==fe.array)return ue(n,{code:K.invalid_type,expected:fe.array,received:n.parsedType}),Ee;if(n.data.length<this._def.items.length)return ue(n,{code:K.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),Ee;!this._def.rest&&n.data.length>this._def.items.length&&(ue(n,{code:K.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),r.dirty());const a=[...n.data].map((o,s)=>{const l=this._def.items[s]||this._def.rest;return l?l._parse(new oi(n,o,n.path,s)):null}).filter(o=>!!o);return n.common.async?Promise.all(a).then(o=>Qt.mergeArray(r,o)):Qt.mergeArray(r,a)}get items(){return this._def.items}rest(e){return new zn({...this._def,rest:e})}}zn.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new zn({items:t,typeName:B.ZodTuple,rest:null,...Ie(e)})};class ou extends Ae{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==fe.object)return ue(n,{code:K.invalid_type,expected:fe.object,received:n.parsedType}),Ee;const i=[],a=this._def.keyType,o=this._def.valueType;for(const s in n.data)i.push({key:a._parse(new oi(n,s,n.path,s)),value:o._parse(new oi(n,n.data[s],n.path,s)),alwaysSet:s in n.data});return n.common.async?Qt.mergeObjectAsync(r,i):Qt.mergeObjectSync(r,i)}get element(){return this._def.valueType}static create(e,r,n){return r instanceof Ae?new ou({keyType:e,valueType:r,typeName:B.ZodRecord,...Ie(n)}):new ou({keyType:dn.create(),valueType:e,typeName:B.ZodRecord,...Ie(r)})}}class Ic extends Ae{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==fe.map)return ue(n,{code:K.invalid_type,expected:fe.map,received:n.parsedType}),Ee;const i=this._def.keyType,a=this._def.valueType,o=[...n.data.entries()].map(([s,l],c)=>({key:i._parse(new oi(n,s,n.path,[c,"key"])),value:a._parse(new oi(n,l,n.path,[c,"value"]))}));if(n.common.async){const s=new Map;return Promise.resolve().then(async()=>{for(const l of o){const c=await l.key,d=await l.value;if(c.status==="aborted"||d.status==="aborted")return Ee;(c.status==="dirty"||d.status==="dirty")&&r.dirty(),s.set(c.value,d.value)}return{status:r.value,value:s}})}else{const s=new Map;for(const l of o){const c=l.key,d=l.value;if(c.status==="aborted"||d.status==="aborted")return Ee;(c.status==="dirty"||d.status==="dirty")&&r.dirty(),s.set(c.value,d.value)}return{status:r.value,value:s}}}}Ic.create=(t,e,r)=>new Ic({valueType:e,keyType:t,typeName:B.ZodMap,...Ie(r)});class Ma extends Ae{_parse(e){const{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==fe.set)return ue(n,{code:K.invalid_type,expected:fe.set,received:n.parsedType}),Ee;const i=this._def;i.minSize!==null&&n.data.size<i.minSize.value&&(ue(n,{code:K.too_small,minimum:i.minSize.value,type:"set",inclusive:!0,exact:!1,message:i.minSize.message}),r.dirty()),i.maxSize!==null&&n.data.size>i.maxSize.value&&(ue(n,{code:K.too_big,maximum:i.maxSize.value,type:"set",inclusive:!0,exact:!1,message:i.maxSize.message}),r.dirty());const a=this._def.valueType;function o(l){const c=new Set;for(const d of l){if(d.status==="aborted")return Ee;d.status==="dirty"&&r.dirty(),c.add(d.value)}return{status:r.value,value:c}}const s=[...n.data.values()].map((l,c)=>a._parse(new oi(n,l,n.path,c)));return n.common.async?Promise.all(s).then(l=>o(l)):o(s)}min(e,r){return new Ma({...this._def,minSize:{value:e,message:be.toString(r)}})}max(e,r){return new Ma({...this._def,maxSize:{value:e,message:be.toString(r)}})}size(e,r){return this.min(e,r).max(e,r)}nonempty(e){return this.min(1,e)}}Ma.create=(t,e)=>new Ma({valueType:t,minSize:null,maxSize:null,typeName:B.ZodSet,...Ie(e)});class ho extends Ae{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:r}=this._processInputParams(e);if(r.parsedType!==fe.function)return ue(r,{code:K.invalid_type,expected:fe.function,received:r.parsedType}),Ee;function n(s,l){return Rc({data:s,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,Tc(),go].filter(c=>!!c),issueData:{code:K.invalid_arguments,argumentsError:l}})}function i(s,l){return Rc({data:s,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,Tc(),go].filter(c=>!!c),issueData:{code:K.invalid_return_type,returnTypeError:l}})}const a={errorMap:r.common.contextualErrorMap},o=r.data;if(this._def.returns instanceof vo){const s=this;return dr(async function(...l){const c=new Cr([]),d=await s._def.args.parseAsync(l,a).catch(p=>{throw c.addIssue(n(l,p)),c}),f=await Reflect.apply(o,this,d);return await s._def.returns._def.type.parseAsync(f,a).catch(p=>{throw c.addIssue(i(f,p)),c})})}else{const s=this;return dr(function(...l){const c=s._def.args.safeParse(l,a);if(!c.success)throw new Cr([n(l,c.error)]);const d=Reflect.apply(o,this,c.data),f=s._def.returns.safeParse(d,a);if(!f.success)throw new Cr([i(d,f.error)]);return f.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new ho({...this._def,args:zn.create(e).rest(ma.create())})}returns(e){return new ho({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,r,n){return new ho({args:e||zn.create([]).rest(ma.create()),returns:r||ma.create(),typeName:B.ZodFunction,...Ie(n)})}}class su extends Ae{get schema(){return this._def.getter()}_parse(e){const{ctx:r}=this._processInputParams(e);return this._def.getter()._parse({data:r.data,path:r.path,parent:r})}}su.create=(t,e)=>new su({getter:t,typeName:B.ZodLazy,...Ie(e)});class uu extends Ae{_parse(e){if(e.data!==this._def.value){const r=this._getOrReturnCtx(e);return ue(r,{received:r.data,code:K.invalid_literal,expected:this._def.value}),Ee}return{status:"valid",value:e.data}}get value(){return this._def.value}}uu.create=(t,e)=>new uu({value:t,typeName:B.ZodLiteral,...Ie(e)});function Z$(t,e){return new zi({values:t,typeName:B.ZodEnum,...Ie(e)})}class zi extends Ae{constructor(){super(...arguments),Jl.set(this,void 0)}_parse(e){if(typeof e.data!="string"){const r=this._getOrReturnCtx(e),n=this._def.values;return ue(r,{expected:Ge.joinValues(n),received:r.parsedType,code:K.invalid_type}),Ee}if(ly(this,Jl)||K$(this,Jl,new Set(this._def.values)),!ly(this,Jl).has(e.data)){const r=this._getOrReturnCtx(e),n=this._def.values;return ue(r,{received:r.data,code:K.invalid_enum_value,options:n}),Ee}return dr(e.data)}get options(){return this._def.values}get enum(){const e={};for(const r of this._def.values)e[r]=r;return e}get Values(){const e={};for(const r of this._def.values)e[r]=r;return e}get Enum(){const e={};for(const r of this._def.values)e[r]=r;return e}extract(e,r=this._def){return zi.create(e,{...this._def,...r})}exclude(e,r=this._def){return zi.create(this.options.filter(n=>!e.includes(n)),{...this._def,...r})}}Jl=new WeakMap;zi.create=Z$;class lu extends Ae{constructor(){super(...arguments),Xl.set(this,void 0)}_parse(e){const r=Ge.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(e);if(n.parsedType!==fe.string&&n.parsedType!==fe.number){const i=Ge.objectValues(r);return ue(n,{expected:Ge.joinValues(i),received:n.parsedType,code:K.invalid_type}),Ee}if(ly(this,Xl)||K$(this,Xl,new Set(Ge.getValidEnumValues(this._def.values))),!ly(this,Xl).has(e.data)){const i=Ge.objectValues(r);return ue(n,{received:n.data,code:K.invalid_enum_value,options:i}),Ee}return dr(e.data)}get enum(){return this._def.values}}Xl=new WeakMap;lu.create=(t,e)=>new lu({values:t,typeName:B.ZodNativeEnum,...Ie(e)});class vo extends Ae{unwrap(){return this._def.type}_parse(e){const{ctx:r}=this._processInputParams(e);if(r.parsedType!==fe.promise&&r.common.async===!1)return ue(r,{code:K.invalid_type,expected:fe.promise,received:r.parsedType}),Ee;const n=r.parsedType===fe.promise?r.data:Promise.resolve(r.data);return dr(n.then(i=>this._def.type.parseAsync(i,{path:r.path,errorMap:r.common.contextualErrorMap})))}}vo.create=(t,e)=>new vo({type:t,typeName:B.ZodPromise,...Ie(e)});class Jr extends Ae{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===B.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:r,ctx:n}=this._processInputParams(e),i=this._def.effect||null,a={addIssue:o=>{ue(n,o),o.fatal?r.abort():r.dirty()},get path(){return n.path}};if(a.addIssue=a.addIssue.bind(a),i.type==="preprocess"){const o=i.transform(n.data,a);if(n.common.async)return Promise.resolve(o).then(async s=>{if(r.value==="aborted")return Ee;const l=await this._def.schema._parseAsync({data:s,path:n.path,parent:n});return l.status==="aborted"?Ee:l.status==="dirty"||r.value==="dirty"?oo(l.value):l});{if(r.value==="aborted")return Ee;const s=this._def.schema._parseSync({data:o,path:n.path,parent:n});return s.status==="aborted"?Ee:s.status==="dirty"||r.value==="dirty"?oo(s.value):s}}if(i.type==="refinement"){const o=s=>{const l=i.refinement(s,a);if(n.common.async)return Promise.resolve(l);if(l instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return s};if(n.common.async===!1){const s=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return s.status==="aborted"?Ee:(s.status==="dirty"&&r.dirty(),o(s.value),{status:r.value,value:s.value})}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(s=>s.status==="aborted"?Ee:(s.status==="dirty"&&r.dirty(),o(s.value).then(()=>({status:r.value,value:s.value}))))}if(i.type==="transform")if(n.common.async===!1){const o=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!ja(o))return o;const s=i.transform(o.value,a);if(s instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:r.value,value:s}}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(o=>ja(o)?Promise.resolve(i.transform(o.value,a)).then(s=>({status:r.value,value:s})):o);Ge.assertNever(i)}}Jr.create=(t,e,r)=>new Jr({schema:t,typeName:B.ZodEffects,effect:e,...Ie(r)});Jr.createWithPreprocess=(t,e,r)=>new Jr({schema:e,effect:{type:"preprocess",transform:t},typeName:B.ZodEffects,...Ie(r)});class hn extends Ae{_parse(e){return this._getType(e)===fe.undefined?dr(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}hn.create=(t,e)=>new hn({innerType:t,typeName:B.ZodOptional,...Ie(e)});class Bi extends Ae{_parse(e){return this._getType(e)===fe.null?dr(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Bi.create=(t,e)=>new Bi({innerType:t,typeName:B.ZodNullable,...Ie(e)});class cu extends Ae{_parse(e){const{ctx:r}=this._processInputParams(e);let n=r.data;return r.parsedType===fe.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:r.path,parent:r})}removeDefault(){return this._def.innerType}}cu.create=(t,e)=>new cu({innerType:t,typeName:B.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...Ie(e)});class du extends Ae{_parse(e){const{ctx:r}=this._processInputParams(e),n={...r,common:{...r.common,issues:[]}},i=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return eu(i)?i.then(a=>({status:"valid",value:a.status==="valid"?a.value:this._def.catchValue({get error(){return new Cr(n.common.issues)},input:n.data})})):{status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new Cr(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}}du.create=(t,e)=>new du({innerType:t,typeName:B.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...Ie(e)});class xc extends Ae{_parse(e){if(this._getType(e)!==fe.nan){const n=this._getOrReturnCtx(e);return ue(n,{code:K.invalid_type,expected:fe.nan,received:n.parsedType}),Ee}return{status:"valid",value:e.data}}}xc.create=t=>new xc({typeName:B.ZodNaN,...Ie(t)});const Y$=Symbol("zod_brand");class tb extends Ae{_parse(e){const{ctx:r}=this._processInputParams(e),n=r.data;return this._def.type._parse({data:n,path:r.path,parent:r})}unwrap(){return this._def.type}}class Ru extends Ae{_parse(e){const{status:r,ctx:n}=this._processInputParams(e);if(n.common.async)return(async()=>{const a=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return a.status==="aborted"?Ee:a.status==="dirty"?(r.dirty(),oo(a.value)):this._def.out._parseAsync({data:a.value,path:n.path,parent:n})})();{const i=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return i.status==="aborted"?Ee:i.status==="dirty"?(r.dirty(),{status:"dirty",value:i.value}):this._def.out._parseSync({data:i.value,path:n.path,parent:n})}}static create(e,r){return new Ru({in:e,out:r,typeName:B.ZodPipeline})}}class fu extends Ae{_parse(e){const r=this._def.innerType._parse(e),n=i=>(ja(i)&&(i.value=Object.freeze(i.value)),i);return eu(r)?r.then(i=>n(i)):n(r)}unwrap(){return this._def.innerType}}fu.create=(t,e)=>new fu({innerType:t,typeName:B.ZodReadonly,...Ie(e)});function tC(t,e){const r=typeof t=="function"?t(e):typeof t=="string"?{message:t}:t;return typeof r=="string"?{message:r}:r}function tE(t,e={},r){return t?mo.create().superRefine((n,i)=>{var a,o;const s=t(n);if(s instanceof Promise)return s.then(l=>{var c,d;if(!l){const f=tC(e,n),h=(d=(c=f.fatal)!==null&&c!==void 0?c:r)!==null&&d!==void 0?d:!0;i.addIssue({code:"custom",...f,fatal:h})}});if(!s){const l=tC(e,n),c=(o=(a=l.fatal)!==null&&a!==void 0?a:r)!==null&&o!==void 0?o:!0;i.addIssue({code:"custom",...l,fatal:c})}}):mo.create()}const Q$={object:Pt.lazycreate};var B;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(B||(B={}));const e1=(t,e={message:`Input not instance of ${t.name}`})=>tE(r=>r instanceof t,e),rE=dn.create,nE=Di.create,t1=xc.create,r1=Ni.create,iE=tu.create,n1=Ca.create,i1=Ac.create,a1=ru.create,o1=nu.create,s1=mo.create,u1=ma.create,l1=si.create,c1=$c.create,d1=fn.create,f1=Pt.create,h1=Pt.strictCreate,p1=iu.create,_1=Yc.create,y1=au.create,b1=zn.create,g1=ou.create,m1=Ic.create,v1=Ma.create,w1=ho.create,O1=su.create,S1=uu.create,E1=zi.create,P1=lu.create,j1=vo.create,cy=Jr.create,C1=hn.create,M1=Bi.create,T1=Jr.createWithPreprocess,R1=Ru.create,A1=()=>rE().optional(),$1=()=>nE().optional(),I1=()=>iE().optional(),x1={string:t=>dn.create({...t,coerce:!0}),number:t=>Di.create({...t,coerce:!0}),boolean:t=>tu.create({...t,coerce:!0}),bigint:t=>Ni.create({...t,coerce:!0}),date:t=>Ca.create({...t,coerce:!0})},D1=Ee;var Ii=Object.freeze({__proto__:null,defaultErrorMap:go,setErrorMap:G$,getErrorMap:Tc,makeIssue:Rc,EMPTY_PATH:W$,addIssueToContext:ue,ParseStatus:Qt,INVALID:Ee,DIRTY:oo,OK:dr,isAborted:sy,isDirty:uy,isValid:ja,isAsync:eu,get util(){return Ge},get objectUtil(){return oy},ZodParsedType:fe,getParsedType:Qn,ZodType:Ae,datetimeRegex:eE,ZodString:dn,ZodNumber:Di,ZodBigInt:Ni,ZodBoolean:tu,ZodDate:Ca,ZodSymbol:Ac,ZodUndefined:ru,ZodNull:nu,ZodAny:mo,ZodUnknown:ma,ZodNever:si,ZodVoid:$c,ZodArray:fn,ZodObject:Pt,ZodUnion:iu,ZodDiscriminatedUnion:Yc,ZodIntersection:au,ZodTuple:zn,ZodRecord:ou,ZodMap:Ic,ZodSet:Ma,ZodFunction:ho,ZodLazy:su,ZodLiteral:uu,ZodEnum:zi,ZodNativeEnum:lu,ZodPromise:vo,ZodEffects:Jr,ZodTransformer:Jr,ZodOptional:hn,ZodNullable:Bi,ZodDefault:cu,ZodCatch:du,ZodNaN:xc,BRAND:Y$,ZodBranded:tb,ZodPipeline:Ru,ZodReadonly:fu,custom:tE,Schema:Ae,ZodSchema:Ae,late:Q$,get ZodFirstPartyTypeKind(){return B},coerce:x1,any:s1,array:d1,bigint:r1,boolean:iE,date:n1,discriminatedUnion:_1,effect:cy,enum:E1,function:w1,instanceof:e1,intersection:y1,lazy:O1,literal:S1,map:m1,nan:t1,nativeEnum:P1,never:l1,null:o1,nullable:M1,number:nE,object:f1,oboolean:I1,onumber:$1,optional:C1,ostring:A1,pipeline:R1,preprocess:T1,promise:j1,record:g1,set:v1,strictObject:h1,string:rE,symbol:i1,transformer:cy,tuple:b1,undefined:a1,union:p1,unknown:u1,void:c1,NEVER:D1,ZodIssueCode:K,quotelessJson:H$,ZodError:Cr});const HEe=Object.freeze(Object.defineProperty({__proto__:null,BRAND:Y$,DIRTY:oo,EMPTY_PATH:W$,INVALID:Ee,NEVER:D1,OK:dr,ParseStatus:Qt,Schema:Ae,ZodAny:mo,ZodArray:fn,ZodBigInt:Ni,ZodBoolean:tu,ZodBranded:tb,ZodCatch:du,ZodDate:Ca,ZodDefault:cu,ZodDiscriminatedUnion:Yc,ZodEffects:Jr,ZodEnum:zi,ZodError:Cr,get ZodFirstPartyTypeKind(){return B},ZodFunction:ho,ZodIntersection:au,ZodIssueCode:K,ZodLazy:su,ZodLiteral:uu,ZodMap:Ic,ZodNaN:xc,ZodNativeEnum:lu,ZodNever:si,ZodNull:nu,ZodNullable:Bi,ZodNumber:Di,ZodObject:Pt,ZodOptional:hn,ZodParsedType:fe,ZodPipeline:Ru,ZodPromise:vo,ZodReadonly:fu,ZodRecord:ou,ZodSchema:Ae,ZodSet:Ma,ZodString:dn,ZodSymbol:Ac,ZodTransformer:Jr,ZodTuple:zn,ZodType:Ae,ZodUndefined:ru,ZodUnion:iu,ZodUnknown:ma,ZodVoid:$c,addIssueToContext:ue,any:s1,array:d1,bigint:r1,boolean:iE,coerce:x1,custom:tE,date:n1,datetimeRegex:eE,default:Ii,defaultErrorMap:go,discriminatedUnion:_1,effect:cy,enum:E1,function:w1,getErrorMap:Tc,getParsedType:Qn,instanceof:e1,intersection:y1,isAborted:sy,isAsync:eu,isDirty:uy,isValid:ja,late:Q$,lazy:O1,literal:S1,makeIssue:Rc,map:m1,nan:t1,nativeEnum:P1,never:l1,null:o1,nullable:M1,number:nE,object:f1,get objectUtil(){return oy},oboolean:I1,onumber:$1,optional:C1,ostring:A1,pipeline:R1,preprocess:T1,promise:j1,quotelessJson:H$,record:g1,set:v1,setErrorMap:G$,strictObject:h1,string:rE,symbol:i1,transformer:cy,tuple:b1,undefined:a1,union:p1,unknown:u1,get util(){return Ge},void:c1,z:Ii},Symbol.toStringTag,{value:"Module"}));/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017-2022 Joachim Wester
 * MIT licensed
 */const y8=Object.prototype.hasOwnProperty;function PO(t,e){return y8.call(t,e)}function jO(t){if(Array.isArray(t)){const r=new Array(t.length);for(let n=0;n<r.length;n++)r[n]=""+n;return r}if(Object.keys)return Object.keys(t);let e=[];for(let r in t)PO(t,r)&&e.push(r);return e}function ri(t){switch(typeof t){case"object":return JSON.parse(JSON.stringify(t));case"undefined":return null;default:return t}}function CO(t){let e=0;const r=t.length;let n;for(;e<r;){if(n=t.charCodeAt(e),n>=48&&n<=57){e++;continue}return!1}return!0}function Go(t){return t.indexOf("/")===-1&&t.indexOf("~")===-1?t:t.replace(/~/g,"~0").replace(/\//g,"~1")}function b8(t){return t.replace(/~1/g,"/").replace(/~0/g,"~")}function MO(t){if(t===void 0)return!0;if(t){if(Array.isArray(t)){for(let r=0,n=t.length;r<n;r++)if(MO(t[r]))return!0}else if(typeof t=="object"){const r=jO(t),n=r.length;for(var e=0;e<n;e++)if(MO(t[r[e]]))return!0}}return!1}function rC(t,e){const r=[t];for(const n in e){const i=typeof e[n]=="object"?JSON.stringify(e[n],null,2):e[n];typeof i<"u"&&r.push(`${n}: ${i}`)}return r.join(`
`)}class g8 extends Error{constructor(e,r,n,i,a){super(rC(e,{name:r,index:n,operation:i,tree:a})),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"index",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"operation",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"tree",{enumerable:!0,configurable:!0,writable:!0,value:a}),Object.setPrototypeOf(this,new.target.prototype),this.message=rC(e,{name:r,index:n,operation:i,tree:a})}}const Dt=g8,$s={add:function(t,e,r){return t[e]=this.value,{newDocument:r}},remove:function(t,e,r){var n=t[e];return delete t[e],{newDocument:r,removed:n}},replace:function(t,e,r){var n=t[e];return t[e]=this.value,{newDocument:r,removed:n}},move:function(t,e,r){let n=TO(r,this.path);n&&(n=ri(n));const i=lc(r,{op:"remove",path:this.from}).removed;return lc(r,{op:"add",path:this.path,value:i}),{newDocument:r,removed:n}},copy:function(t,e,r){const n=TO(r,this.from);return lc(r,{op:"add",path:this.path,value:ri(n)}),{newDocument:r}},test:function(t,e,r){return{newDocument:r,test:fy(t[e],this.value)}},_get:function(t,e,r){return this.value=t[e],{newDocument:r}}};var m8={add:function(t,e,r){return CO(e)?t.splice(e,0,this.value):t[e]=this.value,{newDocument:r,index:e}},remove:function(t,e,r){var n=t.splice(e,1);return{newDocument:r,removed:n[0]}},replace:function(t,e,r){var n=t[e];return t[e]=this.value,{newDocument:r,removed:n}},move:$s.move,copy:$s.copy,test:$s.test,_get:$s._get};function TO(t,e){if(e=="")return t;var r={op:"_get",path:e};return lc(t,r),r.value}function lc(t,e,r=!1,n=!0,i=!0,a=0){if(r&&(typeof r=="function"?r(e,0,t,e.path):RO(e,0)),e.path===""){let o={newDocument:t};if(e.op==="add")return o.newDocument=e.value,o;if(e.op==="replace")return o.newDocument=e.value,o.removed=t,o;if(e.op==="move"||e.op==="copy")return o.newDocument=TO(t,e.from),e.op==="move"&&(o.removed=t),o;if(e.op==="test"){if(o.test=fy(t,e.value),o.test===!1)throw new Dt("Test operation failed","TEST_OPERATION_FAILED",a,e,t);return o.newDocument=t,o}else{if(e.op==="remove")return o.removed=t,o.newDocument=null,o;if(e.op==="_get")return e.value=t,o;if(r)throw new Dt("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",a,e,t);return o}}else{n||(t=ri(t));const s=(e.path||"").split("/");let l=t,c=1,d=s.length,f,h,p;for(typeof r=="function"?p=r:p=RO;;){if(h=s[c],h&&h.indexOf("~")!=-1&&(h=b8(h)),i&&(h=="__proto__"||h=="prototype"&&c>0&&s[c-1]=="constructor"))throw new TypeError("JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(r&&f===void 0&&(l[h]===void 0?f=s.slice(0,c).join("/"):c==d-1&&(f=e.path),f!==void 0&&p(e,0,t,f)),c++,Array.isArray(l)){if(h==="-")h=l.length;else{if(r&&!CO(h))throw new Dt("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",a,e,t);CO(h)&&(h=~~h)}if(c>=d){if(r&&e.op==="add"&&h>l.length)throw new Dt("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",a,e,t);const b=m8[e.op].call(e,l,h,t);if(b.test===!1)throw new Dt("Test operation failed","TEST_OPERATION_FAILED",a,e,t);return b}}else if(c>=d){const b=$s[e.op].call(e,l,h,t);if(b.test===!1)throw new Dt("Test operation failed","TEST_OPERATION_FAILED",a,e,t);return b}if(l=l[h],r&&c<d&&(!l||typeof l!="object"))throw new Dt("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",a,e,t)}}}function dy(t,e,r,n=!0,i=!0){if(r&&!Array.isArray(e))throw new Dt("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");n||(t=ri(t));const a=new Array(e.length);for(let o=0,s=e.length;o<s;o++)a[o]=lc(t,e[o],r,!0,i,o),t=a[o].newDocument;return a.newDocument=t,a}function RO(t,e,r,n){if(typeof t!="object"||t===null||Array.isArray(t))throw new Dt("Operation is not an object","OPERATION_NOT_AN_OBJECT",e,t,r);if($s[t.op]){if(typeof t.path!="string")throw new Dt("Operation `path` property is not a string","OPERATION_PATH_INVALID",e,t,r);if(t.path.indexOf("/")!==0&&t.path.length>0)throw new Dt('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",e,t,r);if((t.op==="move"||t.op==="copy")&&typeof t.from!="string")throw new Dt("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",e,t,r);if((t.op==="add"||t.op==="replace"||t.op==="test")&&t.value===void 0)throw new Dt("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",e,t,r);if((t.op==="add"||t.op==="replace"||t.op==="test")&&MO(t.value))throw new Dt("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",e,t,r);if(r){if(t.op=="add"){var i=t.path.split("/").length,a=n.split("/").length;if(i!==a+1&&i!==a)throw new Dt("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",e,t,r)}else if(t.op==="replace"||t.op==="remove"||t.op==="_get"){if(t.path!==n)throw new Dt("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",e,t,r)}else if(t.op==="move"||t.op==="copy"){var o={op:"_get",path:t.from,value:void 0},s=v8([o],r);if(s&&s.name==="OPERATION_PATH_UNRESOLVABLE")throw new Dt("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",e,t,r)}}}else throw new Dt("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",e,t,r)}function v8(t,e,r){try{if(!Array.isArray(t))throw new Dt("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(e)dy(ri(e),ri(t),r||!0);else{r=r||RO;for(var n=0;n<t.length;n++)r(t[n],n,e,void 0)}}catch(i){if(i instanceof Dt)return i;throw i}}function fy(t,e){if(t===e)return!0;if(t&&e&&typeof t=="object"&&typeof e=="object"){var r=Array.isArray(t),n=Array.isArray(e),i,a,o;if(r&&n){if(a=t.length,a!=e.length)return!1;for(i=a;i--!==0;)if(!fy(t[i],e[i]))return!1;return!0}if(r!=n)return!1;var s=Object.keys(t);if(a=s.length,a!==Object.keys(e).length)return!1;for(i=a;i--!==0;)if(!e.hasOwnProperty(s[i]))return!1;for(i=a;i--!==0;)if(o=s[i],!fy(t[o],e[o]))return!1;return!0}return t!==t&&e!==e}/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2013-2021 Joachim Wester
 * MIT license
 */function N1(t,e,r,n,i){if(e!==t){typeof e.toJSON=="function"&&(e=e.toJSON());for(var a=jO(e),o=jO(t),s=!1,l=o.length-1;l>=0;l--){var c=o[l],d=t[c];if(PO(e,c)&&!(e[c]===void 0&&d!==void 0&&Array.isArray(e)===!1)){var f=e[c];typeof d=="object"&&d!=null&&typeof f=="object"&&f!=null&&Array.isArray(d)===Array.isArray(f)?N1(d,f,r,n+"/"+Go(c),i):d!==f&&(i&&r.push({op:"test",path:n+"/"+Go(c),value:ri(d)}),r.push({op:"replace",path:n+"/"+Go(c),value:ri(f)}))}else Array.isArray(t)===Array.isArray(e)?(i&&r.push({op:"test",path:n+"/"+Go(c),value:ri(d)}),r.push({op:"remove",path:n+"/"+Go(c)}),s=!0):(i&&r.push({op:"test",path:n,value:t}),r.push({op:"replace",path:n,value:e}))}if(!(!s&&a.length==o.length))for(var l=0;l<a.length;l++){var c=a[l];!PO(t,c)&&e[c]!==void 0&&r.push({op:"add",path:n+"/"+Go(c),value:ri(e[c])})}}}function w8(t,e,r=!1){var n=[];return N1(t,e,n,"",r),n}class O8{getStore(){}run(e,r){return r()}enterWith(e){}}const S8=new O8,nC=Symbol.for("lc:child_config");class E8{getInstance(){return Mc()??S8}getRunnableConfig(){return this.getInstance().getStore()?.extra?.[nC]}runWithConfig(e,r,n){const i=Wt._configureSync(e?.callbacks,void 0,e?.tags,void 0,e?.metadata),a=this.getInstance(),o=a.getStore(),s=i?.getParentRunId(),l=i?.handlers?.find(d=>d?.name==="langchain_tracer");let c;return l&&s?c=l.convertToRunTree(s):n||(c=new qr({name:"<runnable_lambda>",tracingEnabled:!1})),c&&(c.extra={...c.extra,[nC]:e}),o!==void 0&&o[D_]!==void 0&&(c===void 0&&(c={}),c[D_]=o[D_]),a.run(c,r)}initializeGlobalInstance(e){Mc()===void 0&&BV(e)}}const Ta=new E8,ow=25;async function xn(t){return Wt._configureSync(t?.callbacks,void 0,t?.tags,void 0,t?.metadata)}function iC(...t){const e={};for(const r of t.filter(n=>!!n))for(const n of Object.keys(r))if(n==="metadata")e[n]={...e[n],...r[n]};else if(n==="tags"){const i=e[n]??[];e[n]=[...new Set(i.concat(r[n]??[]))]}else if(n==="configurable")e[n]={...e[n],...r[n]};else if(n==="timeout")e.timeout===void 0?e.timeout=r.timeout:r.timeout!==void 0&&(e.timeout=Math.min(e.timeout,r.timeout));else if(n==="signal")e.signal===void 0?e.signal=r.signal:r.signal!==void 0&&("any"in AbortSignal?e.signal=AbortSignal.any([e.signal,r.signal]):e.signal=r.signal);else if(n==="callbacks"){const i=e.callbacks,a=r.callbacks;if(Array.isArray(a))if(!i)e.callbacks=a;else if(Array.isArray(i))e.callbacks=i.concat(a);else{const o=i.copy();for(const s of a)o.addHandler(ay(s),!0);e.callbacks=o}else if(a)if(!i)e.callbacks=a;else if(Array.isArray(i)){const o=a.copy();for(const s of i)o.addHandler(ay(s),!0);e.callbacks=o}else e.callbacks=new Wt(a._parentRunId,{handlers:i.handlers.concat(a.handlers),inheritableHandlers:i.inheritableHandlers.concat(a.inheritableHandlers),tags:Array.from(new Set(i.tags.concat(a.tags))),inheritableTags:Array.from(new Set(i.inheritableTags.concat(a.inheritableTags))),metadata:{...i.metadata,...a.metadata}})}else{const i=n;e[i]=r[i]??e[i]}return e}const P8=new Set(["string","number","boolean"]);function Je(t){const e=Ta.getRunnableConfig();let r={tags:[],metadata:{},recursionLimit:25,runId:void 0};if(e){const{runId:n,runName:i,...a}=e;r=Object.entries(a).reduce((o,[s,l])=>(l!==void 0&&(o[s]=l),o),r)}if(t&&(r=Object.entries(t).reduce((n,[i,a])=>(a!==void 0&&(n[i]=a),n),r)),r?.configurable)for(const n of Object.keys(r.configurable))P8.has(typeof r.configurable[n])&&!r.metadata?.[n]&&(r.metadata||(r.metadata={}),r.metadata[n]=r.configurable[n]);if(r.timeout!==void 0){if(r.timeout<=0)throw new Error("Timeout must be a positive number");const n=AbortSignal.timeout(r.timeout);r.signal!==void 0?"any"in AbortSignal&&(r.signal=AbortSignal.any([r.signal,n])):r.signal=n,delete r.timeout}return r}function cr(t={},{callbacks:e,maxConcurrency:r,recursionLimit:n,runName:i,configurable:a,runId:o}={}){const s=Je(t);return e!==void 0&&(delete s.runName,s.callbacks=e),n!==void 0&&(s.recursionLimit=n),r!==void 0&&(s.maxConcurrency=r),i!==void 0&&(s.runName=i),a!==void 0&&(s.configurable={...s.configurable,...a}),o!==void 0&&delete s.runId,s}function hu(t){return t?{configurable:t.configurable,recursionLimit:t.recursionLimit,callbacks:t.callbacks,tags:t.tags,metadata:t.metadata,maxConcurrency:t.maxConcurrency,timeout:t.timeout,signal:t.signal}:void 0}async function Ra(t,e){if(e===void 0)return t;let r;return Promise.race([t.catch(n=>{if(!e?.aborted)throw n}),new Promise((n,i)=>{r=()=>{i(new Error("Aborted"))},e.addEventListener("abort",r),e.aborted&&i(new Error("Aborted"))})]).finally(()=>e.removeEventListener("abort",r))}class Tr extends ReadableStream{constructor(){super(...arguments),Object.defineProperty(this,"reader",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}ensureReader(){this.reader||(this.reader=this.getReader())}async next(){this.ensureReader();try{const e=await this.reader.read();return e.done?(this.reader.releaseLock(),{done:!0,value:void 0}):{done:!1,value:e.value}}catch(e){throw this.reader.releaseLock(),e}}async return(){if(this.ensureReader(),this.locked){const e=this.reader.cancel();this.reader.releaseLock(),await e}return{done:!0,value:void 0}}async throw(e){if(this.ensureReader(),this.locked){const r=this.reader.cancel();this.reader.releaseLock(),await r}throw e}[Symbol.asyncIterator](){return this}async[Symbol.asyncDispose](){await this.return()}static fromReadableStream(e){const r=e.getReader();return new Tr({start(n){return i();function i(){return r.read().then(({done:a,value:o})=>{if(a){n.close();return}return n.enqueue(o),i()})}},cancel(){r.releaseLock()}})}static fromAsyncGenerator(e){return new Tr({async pull(r){const{value:n,done:i}=await e.next();i&&r.close(),r.enqueue(n)},async cancel(r){await e.return(r)}})}}function z1(t,e=2){const r=Array.from({length:e},()=>[]);return r.map(async function*(i){for(;;)if(i.length===0){const a=await t.next();for(const o of r)o.push(a)}else{if(i[0].done)return;yield i.shift().value}})}function pn(t,e){if(Array.isArray(t)&&Array.isArray(e))return t.concat(e);if(typeof t=="string"&&typeof e=="string")return t+e;if(typeof t=="number"&&typeof e=="number")return t+e;if("concat"in t&&typeof t.concat=="function")return t.concat(e);if(typeof t=="object"&&typeof e=="object"){const r={...t};for(const[n,i]of Object.entries(e))n in r&&!Array.isArray(r[n])?r[n]=pn(r[n],i):r[n]=i;return r}else throw new Error(`Cannot concat ${typeof t} and ${typeof e}`)}class Au{constructor(e){Object.defineProperty(this,"generator",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"setup",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"signal",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"firstResult",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"firstResultUsed",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this.generator=e.generator,this.config=e.config,this.signal=e.signal??this.config?.signal,this.setup=new Promise((r,n)=>{Ta.runWithConfig(hu(e.config),async()=>{this.firstResult=e.generator.next(),e.startSetup?this.firstResult.then(e.startSetup).then(r,n):this.firstResult.then(i=>r(void 0),n)},!0)})}async next(...e){return this.signal?.throwIfAborted(),this.firstResultUsed?Ta.runWithConfig(hu(this.config),this.signal?async()=>Ra(this.generator.next(...e),this.signal):async()=>this.generator.next(...e),!0):(this.firstResultUsed=!0,this.firstResult)}async return(e){return this.generator.return(e)}async throw(e){return this.generator.throw(e)}[Symbol.asyncIterator](){return this}async[Symbol.asyncDispose](){await this.return()}}async function j8(t,e,r,n,...i){const a=new Au({generator:e,startSetup:r,signal:n}),o=await a.setup;return{output:t(a,o,...i),setup:o}}class da{constructor(e){Object.defineProperty(this,"ops",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.ops=e.ops??[]}concat(e){const r=this.ops.concat(e.ops),n=dy({},r);return new Dc({ops:r,state:n[n.length-1].newDocument})}}class Dc extends da{constructor(e){super(e),Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.state=e.state}concat(e){const r=this.ops.concat(e.ops),n=dy(this.state,e.ops);return new Dc({ops:r,state:n[n.length-1].newDocument})}static fromRunLogPatch(e){const r=dy({},e.ops);return new Dc({ops:e.ops,state:r[r.length-1].newDocument})}}const C8=t=>t.name==="log_stream_tracer";async function aC(t,e){if(e==="original")throw new Error("Do not assign inputs with original schema drop the key for now. When inputs are added to streamLog they should be added with standardized schema for streaming events.");const{inputs:r}=t;if(["retriever","llm","prompt"].includes(t.run_type))return r;if(!(Object.keys(r).length===1&&r?.input===""))return r.input}async function oC(t,e){const{outputs:r}=t;return e==="original"||["retriever","llm","prompt"].includes(t.run_type)?r:r!==void 0&&Object.keys(r).length===1&&r?.output!==void 0?r.output:r}function M8(t){return t!==void 0&&t.message!==void 0}class sC extends Kc{constructor(e){super({_awaitHandler:!0,...e}),Object.defineProperty(this,"autoClose",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"includeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_schemaFormat",{enumerable:!0,configurable:!0,writable:!0,value:"original"}),Object.defineProperty(this,"rootId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"keyMapByRunId",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"counterMapByRunName",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"transformStream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"writer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"receiveStream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"log_stream_tracer"}),Object.defineProperty(this,"lc_prefer_streaming",{enumerable:!0,configurable:!0,writable:!0,value:!0}),this.autoClose=e?.autoClose??!0,this.includeNames=e?.includeNames,this.includeTypes=e?.includeTypes,this.includeTags=e?.includeTags,this.excludeNames=e?.excludeNames,this.excludeTypes=e?.excludeTypes,this.excludeTags=e?.excludeTags,this._schemaFormat=e?._schemaFormat??this._schemaFormat,this.transformStream=new TransformStream,this.writer=this.transformStream.writable.getWriter(),this.receiveStream=Tr.fromReadableStream(this.transformStream.readable)}[Symbol.asyncIterator](){return this.receiveStream}async persistRun(e){}_includeRun(e){if(e.id===this.rootId)return!1;const r=e.tags??[];let n=this.includeNames===void 0&&this.includeTags===void 0&&this.includeTypes===void 0;return this.includeNames!==void 0&&(n=n||this.includeNames.includes(e.name)),this.includeTypes!==void 0&&(n=n||this.includeTypes.includes(e.run_type)),this.includeTags!==void 0&&(n=n||r.find(i=>this.includeTags?.includes(i))!==void 0),this.excludeNames!==void 0&&(n=n&&!this.excludeNames.includes(e.name)),this.excludeTypes!==void 0&&(n=n&&!this.excludeTypes.includes(e.run_type)),this.excludeTags!==void 0&&(n=n&&r.every(i=>!this.excludeTags?.includes(i))),n}async*tapOutputIterable(e,r){for await(const n of r){if(e!==this.rootId){const i=this.keyMapByRunId[e];i&&await this.writer.write(new da({ops:[{op:"add",path:`/logs/${i}/streamed_output/-`,value:n}]}))}yield n}}async onRunCreate(e){if(this.rootId===void 0&&(this.rootId=e.id,await this.writer.write(new da({ops:[{op:"replace",path:"",value:{id:e.id,name:e.name,type:e.run_type,streamed_output:[],final_output:void 0,logs:{}}}]}))),!this._includeRun(e))return;this.counterMapByRunName[e.name]===void 0&&(this.counterMapByRunName[e.name]=0),this.counterMapByRunName[e.name]+=1;const r=this.counterMapByRunName[e.name];this.keyMapByRunId[e.id]=r===1?e.name:`${e.name}:${r}`;const n={id:e.id,name:e.name,type:e.run_type,tags:e.tags??[],metadata:e.extra?.metadata??{},start_time:new Date(e.start_time).toISOString(),streamed_output:[],streamed_output_str:[],final_output:void 0,end_time:void 0};this._schemaFormat==="streaming_events"&&(n.inputs=await aC(e,this._schemaFormat)),await this.writer.write(new da({ops:[{op:"add",path:`/logs/${this.keyMapByRunId[e.id]}`,value:n}]}))}async onRunUpdate(e){try{const r=this.keyMapByRunId[e.id];if(r===void 0)return;const n=[];this._schemaFormat==="streaming_events"&&n.push({op:"replace",path:`/logs/${r}/inputs`,value:await aC(e,this._schemaFormat)}),n.push({op:"add",path:`/logs/${r}/final_output`,value:await oC(e,this._schemaFormat)}),e.end_time!==void 0&&n.push({op:"add",path:`/logs/${r}/end_time`,value:new Date(e.end_time).toISOString()});const i=new da({ops:n});await this.writer.write(i)}finally{if(e.id===this.rootId){const r=new da({ops:[{op:"replace",path:"/final_output",value:await oC(e,this._schemaFormat)}]});await this.writer.write(r),this.autoClose&&await this.writer.close()}}}async onLLMNewToken(e,r,n){const i=this.keyMapByRunId[e.id];if(i===void 0)return;const a=e.inputs.messages!==void 0;let o;a?M8(n?.chunk)?o=n?.chunk:o=new vt({id:`run-${e.id}`,content:r}):o=r;const s=new da({ops:[{op:"add",path:`/logs/${i}/streamed_output_str/-`,value:r},{op:"add",path:`/logs/${i}/streamed_output/-`,value:o}]});await this.writer.write(s)}}const hy="__run";class Ui{constructor(e){Object.defineProperty(this,"text",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"generationInfo",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.text=e.text,this.generationInfo=e.generationInfo}concat(e){return new Ui({text:this.text+e.text,generationInfo:{...this.generationInfo,...e.generationInfo}})}}class Mr extends Ui{constructor(e){super(e),Object.defineProperty(this,"message",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.message=e.message}concat(e){return new Mr({text:this.text+e.text,generationInfo:{...this.generationInfo,...e.generationInfo},message:this.message.concat(e.message)})}}function jp({name:t,serialized:e}){return t!==void 0?t:e?.name!==void 0?e.name:e?.id!==void 0&&Array.isArray(e?.id)?e.id[e.id.length-1]:"Unnamed"}const T8=t=>t.name==="event_stream_tracer";class R8 extends Kc{constructor(e){super({_awaitHandler:!0,...e}),Object.defineProperty(this,"autoClose",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"includeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"runInfoMap",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"tappedPromises",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"transformStream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"writer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"receiveStream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"event_stream_tracer"}),Object.defineProperty(this,"lc_prefer_streaming",{enumerable:!0,configurable:!0,writable:!0,value:!0}),this.autoClose=e?.autoClose??!0,this.includeNames=e?.includeNames,this.includeTypes=e?.includeTypes,this.includeTags=e?.includeTags,this.excludeNames=e?.excludeNames,this.excludeTypes=e?.excludeTypes,this.excludeTags=e?.excludeTags,this.transformStream=new TransformStream,this.writer=this.transformStream.writable.getWriter(),this.receiveStream=Tr.fromReadableStream(this.transformStream.readable)}[Symbol.asyncIterator](){return this.receiveStream}async persistRun(e){}_includeRun(e){const r=e.tags??[];let n=this.includeNames===void 0&&this.includeTags===void 0&&this.includeTypes===void 0;return this.includeNames!==void 0&&(n=n||this.includeNames.includes(e.name)),this.includeTypes!==void 0&&(n=n||this.includeTypes.includes(e.runType)),this.includeTags!==void 0&&(n=n||r.find(i=>this.includeTags?.includes(i))!==void 0),this.excludeNames!==void 0&&(n=n&&!this.excludeNames.includes(e.name)),this.excludeTypes!==void 0&&(n=n&&!this.excludeTypes.includes(e.runType)),this.excludeTags!==void 0&&(n=n&&r.every(i=>!this.excludeTags?.includes(i))),n}async*tapOutputIterable(e,r){const n=await r.next();if(n.done)return;const i=this.runInfoMap.get(e);if(i===void 0){yield n.value;return}function a(s,l){return s==="llm"&&typeof l=="string"?new Ui({text:l}):l}let o=this.tappedPromises.get(e);if(o===void 0){let s;o=new Promise(l=>{s=l}),this.tappedPromises.set(e,o);try{const l={event:`on_${i.runType}_stream`,run_id:e,name:i.name,tags:i.tags,metadata:i.metadata,data:{}};await this.send({...l,data:{chunk:a(i.runType,n.value)}},i),yield n.value;for await(const c of r)i.runType!=="tool"&&i.runType!=="retriever"&&await this.send({...l,data:{chunk:a(i.runType,c)}},i),yield c}finally{s()}}else{yield n.value;for await(const s of r)yield s}}async send(e,r){this._includeRun(r)&&await this.writer.write(e)}async sendEndEvent(e,r){const n=this.tappedPromises.get(e.run_id);n!==void 0?n.then(()=>{this.send(e,r)}):await this.send(e,r)}async onLLMStart(e){const r=jp(e),n=e.inputs.messages!==void 0?"chat_model":"llm",i={tags:e.tags??[],metadata:e.extra?.metadata??{},name:r,runType:n,inputs:e.inputs};this.runInfoMap.set(e.id,i);const a=`on_${n}_start`;await this.send({event:a,data:{input:e.inputs},name:r,tags:e.tags??[],run_id:e.id,metadata:e.extra?.metadata??{}},i)}async onLLMNewToken(e,r,n){const i=this.runInfoMap.get(e.id);let a,o;if(i===void 0)throw new Error(`onLLMNewToken: Run ID ${e.id} not found in run map.`);if(this.runInfoMap.size!==1){if(i.runType==="chat_model")o="on_chat_model_stream",n?.chunk===void 0?a=new vt({content:r,id:`run-${e.id}`}):a=n.chunk.message;else if(i.runType==="llm")o="on_llm_stream",n?.chunk===void 0?a=new Ui({text:r}):a=n.chunk;else throw new Error(`Unexpected run type ${i.runType}`);await this.send({event:o,data:{chunk:a},run_id:e.id,name:i.name,tags:i.tags,metadata:i.metadata},i)}}async onLLMEnd(e){const r=this.runInfoMap.get(e.id);this.runInfoMap.delete(e.id);let n;if(r===void 0)throw new Error(`onLLMEnd: Run ID ${e.id} not found in run map.`);const i=e.outputs?.generations;let a;if(r.runType==="chat_model"){for(const o of i??[]){if(a!==void 0)break;a=o[0]?.message}n="on_chat_model_end"}else if(r.runType==="llm")a={generations:i?.map(o=>o.map(s=>({text:s.text,generationInfo:s.generationInfo}))),llmOutput:e.outputs?.llmOutput??{}},n="on_llm_end";else throw new Error(`onLLMEnd: Unexpected run type: ${r.runType}`);await this.sendEndEvent({event:n,data:{output:a,input:r.inputs},run_id:e.id,name:r.name,tags:r.tags,metadata:r.metadata},r)}async onChainStart(e){const r=jp(e),n=e.run_type??"chain",i={tags:e.tags??[],metadata:e.extra?.metadata??{},name:r,runType:e.run_type};let a={};e.inputs.input===""&&Object.keys(e.inputs).length===1?(a={},i.inputs={}):e.inputs.input!==void 0?(a.input=e.inputs.input,i.inputs=e.inputs.input):(a.input=e.inputs,i.inputs=e.inputs),this.runInfoMap.set(e.id,i),await this.send({event:`on_${n}_start`,data:a,name:r,tags:e.tags??[],run_id:e.id,metadata:e.extra?.metadata??{}},i)}async onChainEnd(e){const r=this.runInfoMap.get(e.id);if(this.runInfoMap.delete(e.id),r===void 0)throw new Error(`onChainEnd: Run ID ${e.id} not found in run map.`);const n=`on_${e.run_type}_end`,i=e.inputs??r.inputs??{},o={output:e.outputs?.output??e.outputs,input:i};i.input&&Object.keys(i).length===1&&(o.input=i.input,r.inputs=i.input),await this.sendEndEvent({event:n,data:o,run_id:e.id,name:r.name,tags:r.tags,metadata:r.metadata??{}},r)}async onToolStart(e){const r=jp(e),n={tags:e.tags??[],metadata:e.extra?.metadata??{},name:r,runType:"tool",inputs:e.inputs??{}};this.runInfoMap.set(e.id,n),await this.send({event:"on_tool_start",data:{input:e.inputs??{}},name:r,run_id:e.id,tags:e.tags??[],metadata:e.extra?.metadata??{}},n)}async onToolEnd(e){const r=this.runInfoMap.get(e.id);if(this.runInfoMap.delete(e.id),r===void 0)throw new Error(`onToolEnd: Run ID ${e.id} not found in run map.`);if(r.inputs===void 0)throw new Error(`onToolEnd: Run ID ${e.id} is a tool call, and is expected to have traced inputs.`);const n=e.outputs?.output===void 0?e.outputs:e.outputs.output;await this.sendEndEvent({event:"on_tool_end",data:{output:n,input:r.inputs},run_id:e.id,name:r.name,tags:r.tags,metadata:r.metadata},r)}async onRetrieverStart(e){const r=jp(e),i={tags:e.tags??[],metadata:e.extra?.metadata??{},name:r,runType:"retriever",inputs:{query:e.inputs.query}};this.runInfoMap.set(e.id,i),await this.send({event:"on_retriever_start",data:{input:{query:e.inputs.query}},name:r,tags:e.tags??[],run_id:e.id,metadata:e.extra?.metadata??{}},i)}async onRetrieverEnd(e){const r=this.runInfoMap.get(e.id);if(this.runInfoMap.delete(e.id),r===void 0)throw new Error(`onRetrieverEnd: Run ID ${e.id} not found in run map.`);await this.sendEndEvent({event:"on_retriever_end",data:{output:e.outputs?.documents??e.outputs,input:r.inputs},run_id:e.id,name:r.name,tags:r.tags,metadata:r.metadata},r)}async handleCustomEvent(e,r,n){const i=this.runInfoMap.get(n);if(i===void 0)throw new Error(`handleCustomEvent: Run ID ${n} not found in run map.`);await this.send({event:"on_custom_event",run_id:n,name:e,tags:i.tags,metadata:i.metadata,data:r},i)}async finish(){const e=[...this.tappedPromises.values()];Promise.all(e).finally(()=>{this.writer.close()})}}const A8=[400,401,402,403,404,405,406,407,409],$8=t=>{if(t.message.startsWith("Cancel")||t.message.startsWith("AbortError")||t.name==="AbortError"||t?.code==="ECONNABORTED")throw t;const e=t?.response?.status??t?.status;if(e&&A8.includes(+e))throw t;if(t?.error?.code==="insufficient_quota"){const r=new Error(t?.message);throw r.name="InsufficientQuotaError",r}};class Qc{constructor(e){Object.defineProperty(this,"maxConcurrency",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxRetries",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"onFailedAttempt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"queue",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxConcurrency=e.maxConcurrency??1/0,this.maxRetries=e.maxRetries??6,this.onFailedAttempt=e.onFailedAttempt??$8;const r="default"in $i?$i.default:$i;this.queue=new r({concurrency:this.maxConcurrency})}call(e,...r){return this.queue.add(()=>ry(()=>e(...r).catch(n=>{throw n instanceof Error?n:new Error(n)}),{onFailedAttempt:this.onFailedAttempt,retries:this.maxRetries,randomize:!0}),{throwOnTimeout:!0})}callWithOptions(e,r,...n){return e.signal?Promise.race([this.call(r,...n),new Promise((i,a)=>{e.signal?.addEventListener("abort",()=>{a(new Error("AbortError"))})})]):this.call(r,...n)}fetch(...e){return this.call(()=>fetch(...e).then(r=>r.ok?r:Promise.reject(r)))}}class B1 extends Kc{constructor({config:e,onStart:r,onEnd:n,onError:i}){super({_awaitHandler:!0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"RootListenersTracer"}),Object.defineProperty(this,"rootId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"argOnStart",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"argOnEnd",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"argOnError",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.config=e,this.argOnStart=r,this.argOnEnd=n,this.argOnError=i}persistRun(e){return Promise.resolve()}async onRunCreate(e){this.rootId||(this.rootId=e.id,this.argOnStart&&await this.argOnStart(e,this.config))}async onRunUpdate(e){e.id===this.rootId&&(e.error?this.argOnError&&await this.argOnError(e,this.config):this.argOnEnd&&await this.argOnEnd(e,this.config))}}function aE(t){return t?t.lc_runnable:!1}class I8{constructor(e){Object.defineProperty(this,"includeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.includeNames=e.includeNames,this.includeTypes=e.includeTypes,this.includeTags=e.includeTags,this.excludeNames=e.excludeNames,this.excludeTypes=e.excludeTypes,this.excludeTags=e.excludeTags}includeEvent(e,r){let n=this.includeNames===void 0&&this.includeTypes===void 0&&this.includeTags===void 0;const i=e.tags??[];return this.includeNames!==void 0&&(n=n||this.includeNames.includes(e.name)),this.includeTypes!==void 0&&(n=n||this.includeTypes.includes(r)),this.includeTags!==void 0&&(n=n||i.some(a=>this.includeTags?.includes(a))),this.excludeNames!==void 0&&(n=n&&!this.excludeNames.includes(e.name)),this.excludeTypes!==void 0&&(n=n&&!this.excludeTypes.includes(r)),this.excludeTags!==void 0&&(n=n&&i.every(a=>!this.excludeTags?.includes(a))),n}}const x8=Symbol("Let zodToJsonSchema decide on which parser to use"),qEe=(t,e)=>{if(e.description)try{return{...t,...JSON.parse(e.description)}}catch{}return t},uC={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"},D8=t=>typeof t=="string"?{...uC,name:t}:{...uC,...t},N8=t=>{const e=D8(t),r=e.name!==void 0?[...e.basePath,e.definitionPath,e.name]:e.basePath;return{...e,currentPath:r,propertyPath:void 0,seen:new Map(Object.entries(e.definitions).map(([n,i])=>[i._def,{def:i._def,path:[...e.basePath,e.definitionPath,n],jsonSchema:void 0}]))}};function U1(t,e,r,n){n?.errorMessages&&r&&(t.errorMessage={...t.errorMessage,[e]:r})}function nt(t,e,r,n,i){t[e]=r,U1(t,e,n,i)}function z8(){return{}}function B8(t,e){const r={type:"array"};return t.type?._def&&t.type?._def?.typeName!==B.ZodAny&&(r.items=Xe(t.type._def,{...e,currentPath:[...e.currentPath,"items"]})),t.minLength&&nt(r,"minItems",t.minLength.value,t.minLength.message,e),t.maxLength&&nt(r,"maxItems",t.maxLength.value,t.maxLength.message,e),t.exactLength&&(nt(r,"minItems",t.exactLength.value,t.exactLength.message,e),nt(r,"maxItems",t.exactLength.value,t.exactLength.message,e)),r}function U8(t,e){const r={type:"integer",format:"int64"};if(!t.checks)return r;for(const n of t.checks)switch(n.kind){case"min":e.target==="jsonSchema7"?n.inclusive?nt(r,"minimum",n.value,n.message,e):nt(r,"exclusiveMinimum",n.value,n.message,e):(n.inclusive||(r.exclusiveMinimum=!0),nt(r,"minimum",n.value,n.message,e));break;case"max":e.target==="jsonSchema7"?n.inclusive?nt(r,"maximum",n.value,n.message,e):nt(r,"exclusiveMaximum",n.value,n.message,e):(n.inclusive||(r.exclusiveMaximum=!0),nt(r,"maximum",n.value,n.message,e));break;case"multipleOf":nt(r,"multipleOf",n.value,n.message,e);break}return r}function F8(){return{type:"boolean"}}function F1(t,e){return Xe(t.type._def,e)}const L8=(t,e)=>Xe(t.innerType._def,e);function L1(t,e,r){const n=r??e.dateStrategy;if(Array.isArray(n))return{anyOf:n.map((i,a)=>L1(t,e,i))};switch(n){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return V8(t,e)}}const V8=(t,e)=>{const r={type:"integer",format:"unix-time"};if(e.target==="openApi3")return r;for(const n of t.checks)switch(n.kind){case"min":nt(r,"minimum",n.value,n.message,e);break;case"max":nt(r,"maximum",n.value,n.message,e);break}return r};function k8(t,e){return{...Xe(t.innerType._def,e),default:t.defaultValue()}}function H8(t,e){return e.effectStrategy==="input"?Xe(t.schema._def,e):{}}function q8(t){return{type:"string",enum:Array.from(t.values)}}const G8=t=>"type"in t&&t.type==="string"?!1:"allOf"in t;function W8(t,e){const r=[Xe(t.left._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),Xe(t.right._def,{...e,currentPath:[...e.currentPath,"allOf","1"]})].filter(a=>!!a);let n=e.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0;const i=[];return r.forEach(a=>{if(G8(a))i.push(...a.allOf),a.unevaluatedProperties===void 0&&(n=void 0);else{let o=a;if("additionalProperties"in a&&a.additionalProperties===!1){const{additionalProperties:s,...l}=a;o=l}else n=void 0;i.push(o)}}),i.length?{allOf:i,...n}:void 0}function K8(t,e){const r=typeof t.value;return r!=="bigint"&&r!=="number"&&r!=="boolean"&&r!=="string"?{type:Array.isArray(t.value)?"array":"object"}:e.target==="openApi3"?{type:r==="bigint"?"integer":r,enum:[t.value]}:{type:r==="bigint"?"integer":r,const:t.value}}let sw;const mn={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(sw===void 0&&(sw=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),sw),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv4Cidr:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,ipv6Cidr:/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,base64url:/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/,jwt:/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/};function V1(t,e){const r={type:"string"};if(t.checks)for(const n of t.checks)switch(n.kind){case"min":nt(r,"minLength",typeof r.minLength=="number"?Math.max(r.minLength,n.value):n.value,n.message,e);break;case"max":nt(r,"maxLength",typeof r.maxLength=="number"?Math.min(r.maxLength,n.value):n.value,n.message,e);break;case"email":switch(e.emailStrategy){case"format:email":vn(r,"email",n.message,e);break;case"format:idn-email":vn(r,"idn-email",n.message,e);break;case"pattern:zod":_r(r,mn.email,n.message,e);break}break;case"url":vn(r,"uri",n.message,e);break;case"uuid":vn(r,"uuid",n.message,e);break;case"regex":_r(r,n.regex,n.message,e);break;case"cuid":_r(r,mn.cuid,n.message,e);break;case"cuid2":_r(r,mn.cuid2,n.message,e);break;case"startsWith":_r(r,RegExp(`^${uw(n.value,e)}`),n.message,e);break;case"endsWith":_r(r,RegExp(`${uw(n.value,e)}$`),n.message,e);break;case"datetime":vn(r,"date-time",n.message,e);break;case"date":vn(r,"date",n.message,e);break;case"time":vn(r,"time",n.message,e);break;case"duration":vn(r,"duration",n.message,e);break;case"length":nt(r,"minLength",typeof r.minLength=="number"?Math.max(r.minLength,n.value):n.value,n.message,e),nt(r,"maxLength",typeof r.maxLength=="number"?Math.min(r.maxLength,n.value):n.value,n.message,e);break;case"includes":{_r(r,RegExp(uw(n.value,e)),n.message,e);break}case"ip":{n.version!=="v6"&&vn(r,"ipv4",n.message,e),n.version!=="v4"&&vn(r,"ipv6",n.message,e);break}case"base64url":_r(r,mn.base64url,n.message,e);break;case"jwt":_r(r,mn.jwt,n.message,e);break;case"cidr":{n.version!=="v6"&&_r(r,mn.ipv4Cidr,n.message,e),n.version!=="v4"&&_r(r,mn.ipv6Cidr,n.message,e);break}case"emoji":_r(r,mn.emoji(),n.message,e);break;case"ulid":{_r(r,mn.ulid,n.message,e);break}case"base64":{switch(e.base64Strategy){case"format:binary":{vn(r,"binary",n.message,e);break}case"contentEncoding:base64":{nt(r,"contentEncoding","base64",n.message,e);break}case"pattern:zod":{_r(r,mn.base64,n.message,e);break}}break}case"nanoid":_r(r,mn.nanoid,n.message,e)}return r}function uw(t,e){return e.patternStrategy==="escape"?X8(t):t}const J8=new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");function X8(t){let e="";for(let r=0;r<t.length;r++)J8.has(t[r])||(e+="\\"),e+=t[r];return e}function vn(t,e,r,n){t.format||t.anyOf?.some(i=>i.format)?(t.anyOf||(t.anyOf=[]),t.format&&(t.anyOf.push({format:t.format,...t.errorMessage&&n.errorMessages&&{errorMessage:{format:t.errorMessage.format}}}),delete t.format,t.errorMessage&&(delete t.errorMessage.format,Object.keys(t.errorMessage).length===0&&delete t.errorMessage)),t.anyOf.push({format:e,...r&&n.errorMessages&&{errorMessage:{format:r}}})):nt(t,"format",e,r,n)}function _r(t,e,r,n){t.pattern||t.allOf?.some(i=>i.pattern)?(t.allOf||(t.allOf=[]),t.pattern&&(t.allOf.push({pattern:t.pattern,...t.errorMessage&&n.errorMessages&&{errorMessage:{pattern:t.errorMessage.pattern}}}),delete t.pattern,t.errorMessage&&(delete t.errorMessage.pattern,Object.keys(t.errorMessage).length===0&&delete t.errorMessage)),t.allOf.push({pattern:lC(e,n),...r&&n.errorMessages&&{errorMessage:{pattern:r}}})):nt(t,"pattern",lC(e,n),r,n)}function lC(t,e){if(!e.applyRegexFlags||!t.flags)return t.source;const r={i:t.flags.includes("i"),m:t.flags.includes("m"),s:t.flags.includes("s")},n=r.i?t.source.toLowerCase():t.source;let i="",a=!1,o=!1,s=!1;for(let l=0;l<n.length;l++){if(a){i+=n[l],a=!1;continue}if(r.i){if(o){if(n[l].match(/[a-z]/)){s?(i+=n[l],i+=`${n[l-2]}-${n[l]}`.toUpperCase(),s=!1):n[l+1]==="-"&&n[l+2]?.match(/[a-z]/)?(i+=n[l],s=!0):i+=`${n[l]}${n[l].toUpperCase()}`;continue}}else if(n[l].match(/[a-z]/)){i+=`[${n[l]}${n[l].toUpperCase()}]`;continue}}if(r.m){if(n[l]==="^"){i+=`(^|(?<=[\r
]))`;continue}else if(n[l]==="$"){i+=`($|(?=[\r
]))`;continue}}if(r.s&&n[l]==="."){i+=o?`${n[l]}\r
`:`[${n[l]}\r
]`;continue}i+=n[l],n[l]==="\\"?a=!0:o&&n[l]==="]"?o=!1:!o&&n[l]==="["&&(o=!0)}try{new RegExp(i)}catch{return console.warn(`Could not convert regex pattern at ${e.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),t.source}return i}function k1(t,e){if(e.target==="openAi"&&console.warn("Warning: OpenAI may not support records in schemas! Try an array of key-value pairs instead."),e.target==="openApi3"&&t.keyType?._def.typeName===B.ZodEnum)return{type:"object",required:t.keyType._def.values,properties:t.keyType._def.values.reduce((n,i)=>({...n,[i]:Xe(t.valueType._def,{...e,currentPath:[...e.currentPath,"properties",i]})??{}}),{}),additionalProperties:!1};const r={type:"object",additionalProperties:Xe(t.valueType._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??{}};if(e.target==="openApi3")return r;if(t.keyType?._def.typeName===B.ZodString&&t.keyType._def.checks?.length){const{type:n,...i}=V1(t.keyType._def,e);return{...r,propertyNames:i}}else{if(t.keyType?._def.typeName===B.ZodEnum)return{...r,propertyNames:{enum:t.keyType._def.values}};if(t.keyType?._def.typeName===B.ZodBranded&&t.keyType._def.type._def.typeName===B.ZodString&&t.keyType._def.type._def.checks?.length){const{type:n,...i}=F1(t.keyType._def,e);return{...r,propertyNames:i}}}return r}function Z8(t,e){if(e.mapStrategy==="record")return k1(t,e);const r=Xe(t.keyType._def,{...e,currentPath:[...e.currentPath,"items","items","0"]})||{},n=Xe(t.valueType._def,{...e,currentPath:[...e.currentPath,"items","items","1"]})||{};return{type:"array",maxItems:125,items:{type:"array",items:[r,n],minItems:2,maxItems:2}}}function Y8(t){const e=t.values,n=Object.keys(t.values).filter(a=>typeof e[e[a]]!="number").map(a=>e[a]),i=Array.from(new Set(n.map(a=>typeof a)));return{type:i.length===1?i[0]==="string"?"string":"number":["string","number"],enum:n}}function Q8(){return{not:{}}}function e6(t){return t.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}const py={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function t6(t,e){if(e.target==="openApi3")return cC(t,e);const r=t.options instanceof Map?Array.from(t.options.values()):t.options;if(r.every(n=>n._def.typeName in py&&(!n._def.checks||!n._def.checks.length))){const n=r.reduce((i,a)=>{const o=py[a._def.typeName];return o&&!i.includes(o)?[...i,o]:i},[]);return{type:n.length>1?n:n[0]}}else if(r.every(n=>n._def.typeName==="ZodLiteral"&&!n.description)){const n=r.reduce((i,a)=>{const o=typeof a._def.value;switch(o){case"string":case"number":case"boolean":return[...i,o];case"bigint":return[...i,"integer"];case"object":if(a._def.value===null)return[...i,"null"];case"symbol":case"undefined":case"function":default:return i}},[]);if(n.length===r.length){const i=n.filter((a,o,s)=>s.indexOf(a)===o);return{type:i.length>1?i:i[0],enum:r.reduce((a,o)=>a.includes(o._def.value)?a:[...a,o._def.value],[])}}}else if(r.every(n=>n._def.typeName==="ZodEnum"))return{type:"string",enum:r.reduce((n,i)=>[...n,...i._def.values.filter(a=>!n.includes(a))],[])};return cC(t,e)}const cC=(t,e)=>{const r=(t.options instanceof Map?Array.from(t.options.values()):t.options).map((n,i)=>Xe(n._def,{...e,currentPath:[...e.currentPath,"anyOf",`${i}`]})).filter(n=>!!n&&(!e.strictUnions||typeof n=="object"&&Object.keys(n).length>0));return r.length?{anyOf:r}:void 0};function r6(t,e){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(t.innerType._def.typeName)&&(!t.innerType._def.checks||!t.innerType._def.checks.length))return e.target==="openApi3"?{type:py[t.innerType._def.typeName],nullable:!0}:{type:[py[t.innerType._def.typeName],"null"]};if(e.target==="openApi3"){const n=Xe(t.innerType._def,{...e,currentPath:[...e.currentPath]});return n&&"$ref"in n?{allOf:[n],nullable:!0}:n&&{...n,nullable:!0}}const r=Xe(t.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","0"]});return r&&{anyOf:[r,{type:"null"}]}}function n6(t,e){const r={type:"number"};if(!t.checks)return r;for(const n of t.checks)switch(n.kind){case"int":r.type="integer",U1(r,"type",n.message,e);break;case"min":e.target==="jsonSchema7"?n.inclusive?nt(r,"minimum",n.value,n.message,e):nt(r,"exclusiveMinimum",n.value,n.message,e):(n.inclusive||(r.exclusiveMinimum=!0),nt(r,"minimum",n.value,n.message,e));break;case"max":e.target==="jsonSchema7"?n.inclusive?nt(r,"maximum",n.value,n.message,e):nt(r,"exclusiveMaximum",n.value,n.message,e):(n.inclusive||(r.exclusiveMaximum=!0),nt(r,"maximum",n.value,n.message,e));break;case"multipleOf":nt(r,"multipleOf",n.value,n.message,e);break}return r}function i6(t,e){return e.removeAdditionalStrategy==="strict"?t.catchall._def.typeName==="ZodNever"?t.unknownKeys!=="strict":Xe(t.catchall._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??!0:t.catchall._def.typeName==="ZodNever"?t.unknownKeys==="passthrough":Xe(t.catchall._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??!0}function a6(t,e){const r=e.target==="openAi",n={type:"object",...Object.entries(t.shape()).reduce((i,[a,o])=>{if(o===void 0||o._def===void 0)return i;let s=o.isOptional();s&&r&&(o instanceof hn&&(o=o._def.innerType),o.isNullable()||(o=o.nullable()),s=!1);const l=Xe(o._def,{...e,currentPath:[...e.currentPath,"properties",a],propertyPath:[...e.currentPath,"properties",a]});return l===void 0?i:{properties:{...i.properties,[a]:l},required:s?i.required:[...i.required,a]}},{properties:{},required:[]}),additionalProperties:i6(t,e)};return n.required.length||delete n.required,n}const o6=(t,e)=>{if(e.currentPath.toString()===e.propertyPath?.toString())return Xe(t.innerType._def,e);const r=Xe(t.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","1"]});return r?{anyOf:[{not:{}},r]}:{}},s6=(t,e)=>{if(e.pipeStrategy==="input")return Xe(t.in._def,e);if(e.pipeStrategy==="output")return Xe(t.out._def,e);const r=Xe(t.in._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),n=Xe(t.out._def,{...e,currentPath:[...e.currentPath,"allOf",r?"1":"0"]});return{allOf:[r,n].filter(i=>i!==void 0)}};function u6(t,e){return Xe(t.type._def,e)}function l6(t,e){const n={type:"array",uniqueItems:!0,items:Xe(t.valueType._def,{...e,currentPath:[...e.currentPath,"items"]})};return t.minSize&&nt(n,"minItems",t.minSize.value,t.minSize.message,e),t.maxSize&&nt(n,"maxItems",t.maxSize.value,t.maxSize.message,e),n}function c6(t,e){return t.rest?{type:"array",minItems:t.items.length,items:t.items.map((r,n)=>Xe(r._def,{...e,currentPath:[...e.currentPath,"items",`${n}`]})).reduce((r,n)=>n===void 0?r:[...r,n],[]),additionalItems:Xe(t.rest._def,{...e,currentPath:[...e.currentPath,"additionalItems"]})}:{type:"array",minItems:t.items.length,maxItems:t.items.length,items:t.items.map((r,n)=>Xe(r._def,{...e,currentPath:[...e.currentPath,"items",`${n}`]})).reduce((r,n)=>n===void 0?r:[...r,n],[])}}function d6(){return{not:{}}}function f6(){return{}}const h6=(t,e)=>Xe(t.innerType._def,e),p6=(t,e,r)=>{switch(e){case B.ZodString:return V1(t,r);case B.ZodNumber:return n6(t,r);case B.ZodObject:return a6(t,r);case B.ZodBigInt:return U8(t,r);case B.ZodBoolean:return F8();case B.ZodDate:return L1(t,r);case B.ZodUndefined:return d6();case B.ZodNull:return e6(r);case B.ZodArray:return B8(t,r);case B.ZodUnion:case B.ZodDiscriminatedUnion:return t6(t,r);case B.ZodIntersection:return W8(t,r);case B.ZodTuple:return c6(t,r);case B.ZodRecord:return k1(t,r);case B.ZodLiteral:return K8(t,r);case B.ZodEnum:return q8(t);case B.ZodNativeEnum:return Y8(t);case B.ZodNullable:return r6(t,r);case B.ZodOptional:return o6(t,r);case B.ZodMap:return Z8(t,r);case B.ZodSet:return l6(t,r);case B.ZodLazy:return()=>t.getter()._def;case B.ZodPromise:return u6(t,r);case B.ZodNaN:case B.ZodNever:return Q8();case B.ZodEffects:return H8(t,r);case B.ZodAny:return z8();case B.ZodUnknown:return f6();case B.ZodDefault:return k8(t,r);case B.ZodBranded:return F1(t,r);case B.ZodReadonly:return h6(t,r);case B.ZodCatch:return L8(t,r);case B.ZodPipeline:return s6(t,r);case B.ZodFunction:case B.ZodVoid:case B.ZodSymbol:return;default:return(n=>{})()}};function Xe(t,e,r=!1){const n=e.seen.get(t);if(e.override){const s=e.override?.(t,e,n,r);if(s!==x8)return s}if(n&&!r){const s=_6(n,e);if(s!==void 0)return s}const i={def:t,path:e.currentPath,jsonSchema:void 0};e.seen.set(t,i);const a=p6(t,t.typeName,e),o=typeof a=="function"?Xe(a(),e):a;if(o&&b6(t,e,o),e.postProcess){const s=e.postProcess(o,t,e);return i.jsonSchema=o,s}return i.jsonSchema=o,o}const _6=(t,e)=>{switch(e.$refStrategy){case"root":return{$ref:t.path.join("/")};case"relative":return{$ref:y6(e.currentPath,t.path)};case"none":case"seen":return t.path.length<e.currentPath.length&&t.path.every((r,n)=>e.currentPath[n]===r)?(console.warn(`Recursive reference detected at ${e.currentPath.join("/")}! Defaulting to any`),{}):e.$refStrategy==="seen"?{}:void 0}},y6=(t,e)=>{let r=0;for(;r<t.length&&r<e.length&&t[r]===e[r];r++);return[(t.length-r).toString(),...e.slice(r)].join("/")},b6=(t,e,r)=>(t.description&&(r.description=t.description,e.markdownDescription&&(r.markdownDescription=t.description)),r),ui=(t,e)=>{const r=N8(e),n=typeof e=="object"&&e.definitions?Object.entries(e.definitions).reduce((l,[c,d])=>({...l,[c]:Xe(d._def,{...r,currentPath:[...r.basePath,r.definitionPath,c]},!0)??{}}),{}):void 0,i=typeof e=="string"?e:e?.nameStrategy==="title"?void 0:e?.name,a=Xe(t._def,i===void 0?r:{...r,currentPath:[...r.basePath,r.definitionPath,i]},!1)??{},o=typeof e=="object"&&e.name!==void 0&&e.nameStrategy==="title"?e.name:void 0;o!==void 0&&(a.title=o);const s=i===void 0?n?{...a,[r.definitionPath]:n}:a:{$ref:[...r.$refStrategy==="relative"?[]:r.basePath,r.definitionPath,i].join("/"),[r.definitionPath]:{...n,[i]:a}};return r.target==="jsonSchema7"?s.$schema="http://json-schema.org/draft-07/schema#":(r.target==="jsonSchema2019-09"||r.target==="openAi")&&(s.$schema="https://json-schema.org/draft/2019-09/schema#"),r.target==="openAi"&&("anyOf"in s||"oneOf"in s||"allOf"in s||"type"in s&&Array.isArray(s.type))&&console.warn("Warning: OpenAI may not support schemas with unions as roots! Try wrapping it in an object property."),s};function lw(t){return t.replace(/[^a-zA-Z-_0-9]/g,"_")}const g6=["*","_","`"];function m6(t){let e="";for(const[r,n]of Object.entries(t))e+=`	classDef ${r} ${n};
`;return e}function v6(t,e,r){const{firstNode:n,lastNode:i,nodeColors:a,withStyles:o=!0,curveStyle:s="linear",wrapLabelNWords:l=9}=r??{};let c=o?`%%{init: {'flowchart': {'curve': '${s}'}}}%%
graph TD;
`:`graph TD;
`;if(o){const p="default",b={[p]:"{0}({1})"};n!==void 0&&(b[n]="{0}([{1}]):::first"),i!==void 0&&(b[i]="{0}([{1}]):::last");for(const[g,v]of Object.entries(t)){const E=v.name.split(":").pop()??"";let S=g6.some(D=>E.startsWith(D)&&E.endsWith(D))?`<p>${E}</p>`:E;Object.keys(v.metadata??{}).length&&(S+=`<hr/><small><em>${Object.entries(v.metadata??{}).map(([D,Z])=>`${D} = ${Z}`).join(`
`)}</em></small>`);const N=(b[g]??b[p]).replace("{0}",lw(g)).replace("{1}",S);c+=`	${N}
`}}const d={};for(const p of e){const b=p.source.split(":"),g=p.target.split(":"),v=b.filter((E,C)=>E===g[C]).join(":");d[v]||(d[v]=[]),d[v].push(p)}const f=new Set;function h(p,b){const g=p.length===1&&p[0].source===p[0].target;if(b&&!g){const v=b.split(":").pop();if(f.has(v))throw new Error(`Found duplicate subgraph '${v}' -- this likely means that you're reusing a subgraph node with the same name. Please adjust your graph to have subgraph nodes with unique names.`);f.add(v),c+=`	subgraph ${v}
`}for(const v of p){const{source:E,target:C,data:S,conditional:N}=v;let D="";if(S!==void 0){let Z=S;const se=Z.split(" ");se.length>l&&(Z=Array.from({length:Math.ceil(se.length/l)},(re,k)=>se.slice(k*l,(k+1)*l).join(" ")).join("&nbsp;<br>&nbsp;")),D=N?` -. &nbsp;${Z}&nbsp; .-> `:` -- &nbsp;${Z}&nbsp; --> `}else D=N?" -.-> ":" --> ";c+=`	${lw(E)}${D}${lw(C)};
`}for(const v in d)v.startsWith(`${b}:`)&&v!==b&&h(d[v],v);b&&!g&&(c+=`	end
`)}h(d[""]??[],"");for(const p in d)!p.includes(":")&&p!==""&&h(d[p],p);return o&&(c+=m6(a??{})),c}async function w6(t,e){let{backgroundColor:r="white"}=e??{};const n=btoa(t);r!==void 0&&(/^#(?:[0-9a-fA-F]{3}){1,2}$/.test(r)||(r=`!${r}`));const i=`https://mermaid.ink/img/${n}?bgColor=${r}`,a=await fetch(i);if(!a.ok)throw new Error(["Failed to render the graph using the Mermaid.INK API.",`Status code: ${a.status}`,`Status text: ${a.statusText}`].join(`
`));return await a.blob()}function O6(t,e){if(t!==void 0&&!oc(t))return t;if(aE(e))try{let r=e.getName();return r=r.startsWith("Runnable")?r.slice(8):r,r}catch{return e.getName()}else return e.name??"UnknownSchema"}function S6(t){return aE(t.data)?{type:"runnable",data:{id:t.data.lc_id,name:t.data.getName()}}:{type:"schema",data:{...ui(t.data.schema),title:t.data.name}}}class rb{constructor(e){Object.defineProperty(this,"nodes",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"edges",{enumerable:!0,configurable:!0,writable:!0,value:[]}),this.nodes=e?.nodes??this.nodes,this.edges=e?.edges??this.edges}toJSON(){const e={};return Object.values(this.nodes).forEach((r,n)=>{e[r.id]=oc(r.id)?n:r.id}),{nodes:Object.values(this.nodes).map(r=>({id:e[r.id],...S6(r)})),edges:this.edges.map(r=>{const n={source:e[r.source],target:e[r.target]};return typeof r.data<"u"&&(n.data=r.data),typeof r.conditional<"u"&&(n.conditional=r.conditional),n})}}addNode(e,r,n){if(r!==void 0&&this.nodes[r]!==void 0)throw new Error(`Node with id ${r} already exists`);const i=r??lr(),a={id:i,data:e,name:O6(r,e),metadata:n};return this.nodes[i]=a,a}removeNode(e){delete this.nodes[e.id],this.edges=this.edges.filter(r=>r.source!==e.id&&r.target!==e.id)}addEdge(e,r,n,i){if(this.nodes[e.id]===void 0)throw new Error(`Source node ${e.id} not in graph`);if(this.nodes[r.id]===void 0)throw new Error(`Target node ${r.id} not in graph`);const a={source:e.id,target:r.id,data:n,conditional:i};return this.edges.push(a),a}firstNode(){return dC(this)}lastNode(){return fC(this)}extend(e,r=""){let n=r;Object.values(e.nodes).map(c=>c.id).every(oc)&&(n="");const a=c=>n?`${n}:${c}`:c;Object.entries(e.nodes).forEach(([c,d])=>{this.nodes[a(c)]={...d,id:a(c)}});const o=e.edges.map(c=>({...c,source:a(c.source),target:a(c.target)}));this.edges=[...this.edges,...o];const s=e.firstNode(),l=e.lastNode();return[s?{id:a(s.id),data:s.data}:void 0,l?{id:a(l.id),data:l.data}:void 0]}trimFirstNode(){const e=this.firstNode();e&&dC(this,[e.id])&&this.removeNode(e)}trimLastNode(){const e=this.lastNode();e&&fC(this,[e.id])&&this.removeNode(e)}reid(){const e=Object.fromEntries(Object.values(this.nodes).map(i=>[i.id,i.name])),r=new Map;Object.values(e).forEach(i=>{r.set(i,(r.get(i)||0)+1)});const n=i=>{const a=e[i];return oc(i)&&r.get(a)===1?a:i};return new rb({nodes:Object.fromEntries(Object.entries(this.nodes).map(([i,a])=>[n(i),{...a,id:n(i)}])),edges:this.edges.map(i=>({...i,source:n(i.source),target:n(i.target)}))})}drawMermaid(e){const{withStyles:r,curveStyle:n,nodeColors:i={default:"fill:#f2f0ff,line-height:1.2",first:"fill-opacity:0",last:"fill:#bfb6fc"},wrapLabelNWords:a}=e??{},o=this.reid(),s=o.firstNode(),l=o.lastNode();return v6(o.nodes,o.edges,{firstNode:s?.id,lastNode:l?.id,withStyles:r,curveStyle:n,nodeColors:i,wrapLabelNWords:a})}async drawMermaidPng(e){const r=this.drawMermaid(e);return w6(r,{backgroundColor:e?.backgroundColor})}}function dC(t,e=[]){const r=new Set(t.edges.filter(i=>!e.includes(i.source)).map(i=>i.target)),n=[];for(const i of Object.values(t.nodes))!e.includes(i.id)&&!r.has(i.id)&&n.push(i);return n.length===1?n[0]:void 0}function fC(t,e=[]){const r=new Set(t.edges.filter(i=>!e.includes(i.target)).map(i=>i.source)),n=[];for(const i of Object.values(t.nodes))!e.includes(i.id)&&!r.has(i.id)&&n.push(i);return n.length===1?n[0]:void 0}function E6(t){const e=new TextEncoder,r=new ReadableStream({async start(n){for await(const i of t)n.enqueue(e.encode(`event: data
data: ${JSON.stringify(i)}

`));n.enqueue(e.encode(`event: end

`)),n.close()}});return Tr.fromReadableStream(r)}function hC(t){return typeof t=="object"&&t!==null&&typeof t[Symbol.iterator]=="function"&&typeof t.next=="function"}const P6=t=>t!=null&&typeof t=="object"&&"next"in t&&typeof t.next=="function";function AO(t){return typeof t=="object"&&t!==null&&typeof t[Symbol.asyncIterator]=="function"}function*pC(t,e){for(;;){const{value:r,done:n}=Ta.runWithConfig(hu(t),e.next.bind(e),!0);if(n)break;yield r}}async function*$O(t,e){const r=e[Symbol.asyncIterator]();for(;;){const{value:n,done:i}=await Ta.runWithConfig(hu(t),r.next.bind(e),!0);if(i)break;yield n}}function Gt(t,e){return t&&!Array.isArray(t)&&!(t instanceof Date)&&typeof t=="object"?t:{[e]:t}}class Tt extends Ea{constructor(){super(...arguments),Object.defineProperty(this,"lc_runnable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}getName(e){const r=this.name??this.constructor.lc_name()??this.constructor.name;return e?`${r}${e}`:r}bind(e){return new po({bound:this,kwargs:e,config:{}})}map(){return new _y({bound:this})}withRetry(e){return new j6({bound:this,kwargs:{},config:{},maxAttemptNumber:e?.stopAfterAttempt,...e})}withConfig(e){return new po({bound:this,config:e,kwargs:{}})}withFallbacks(e){const r=Array.isArray(e)?e:e.fallbacks;return new M6({runnable:this,fallbacks:r})}_getOptionsList(e,r=0){if(Array.isArray(e)&&e.length!==r)throw new Error(`Passed "options" must be an array with the same length as the inputs, but got ${e.length} options for ${r} inputs`);if(Array.isArray(e))return e.map(Je);if(r>1&&!Array.isArray(e)&&e.runId){console.warn("Provided runId will be used only for the first element of the batch.");const n=Object.fromEntries(Object.entries(e).filter(([i])=>i!=="runId"));return Array.from({length:r},(i,a)=>Je(a===0?e:n))}return Array.from({length:r},()=>Je(e))}async batch(e,r,n){const i=this._getOptionsList(r??{},e.length),a=i[0]?.maxConcurrency??n?.maxConcurrency,o=new Qc({maxConcurrency:a,onFailedAttempt:l=>{throw l}}),s=e.map((l,c)=>o.call(async()=>{try{return await this.invoke(l,i[c])}catch(d){if(n?.returnExceptions)return d;throw d}}));return Promise.all(s)}async*_streamIterator(e,r){yield this.invoke(e,r)}async stream(e,r){const n=Je(r),i=new Au({generator:this._streamIterator(e,n),config:n});return await i.setup,Tr.fromAsyncGenerator(i)}_separateRunnableConfigFromCallOptions(e){let r;e===void 0?r=Je(e):r=Je({callbacks:e.callbacks,tags:e.tags,metadata:e.metadata,runName:e.runName,configurable:e.configurable,recursionLimit:e.recursionLimit,maxConcurrency:e.maxConcurrency,runId:e.runId,timeout:e.timeout,signal:e.signal});const n={...e};return delete n.callbacks,delete n.tags,delete n.metadata,delete n.runName,delete n.configurable,delete n.recursionLimit,delete n.maxConcurrency,delete n.runId,delete n.timeout,delete n.signal,[r,n]}async _callWithConfig(e,r,n){const i=Je(n),o=await(await xn(i))?.handleChainStart(this.toJSON(),Gt(r,"input"),i.runId,i?.runType,void 0,void 0,i?.runName??this.getName());delete i.runId;let s;try{const l=e.call(this,r,i,o);s=await Ra(l,n?.signal)}catch(l){throw await o?.handleChainError(l),l}return await o?.handleChainEnd(Gt(s,"output")),s}async _batchWithConfig(e,r,n,i){const a=this._getOptionsList(n??{},r.length),o=await Promise.all(a.map(xn)),s=await Promise.all(o.map(async(c,d)=>{const f=await c?.handleChainStart(this.toJSON(),Gt(r[d],"input"),a[d].runId,a[d].runType,void 0,void 0,a[d].runName??this.getName());return delete a[d].runId,f}));let l;try{const c=e.call(this,r,a,s,i);l=await Ra(c,a?.[0]?.signal)}catch(c){throw await Promise.all(s.map(d=>d?.handleChainError(c))),c}return await Promise.all(s.map(c=>c?.handleChainEnd(Gt(l,"output")))),l}async*_transformStreamWithConfig(e,r,n){let i,a=!0,o,s=!0;const l=Je(n),c=await xn(l);async function*d(){for await(const h of e){if(a)if(i===void 0)i=h;else try{i=pn(i,h)}catch{i=void 0,a=!1}yield h}}let f;try{const h=await j8(r.bind(this),d(),async()=>c?.handleChainStart(this.toJSON(),{input:""},l.runId,l.runType,void 0,void 0,l.runName??this.getName()),n?.signal,l);delete l.runId,f=h.setup;const p=f?.handlers.find(T8);let b=h.output;p!==void 0&&f!==void 0&&(b=p.tapOutputIterable(f.runId,b));const g=f?.handlers.find(C8);g!==void 0&&f!==void 0&&(b=g.tapOutputIterable(f.runId,b));for await(const v of b)if(yield v,s)if(o===void 0)o=v;else try{o=pn(o,v)}catch{o=void 0,s=!1}}catch(h){throw await f?.handleChainError(h,void 0,void 0,void 0,{inputs:Gt(i,"input")}),h}await f?.handleChainEnd(o??{},void 0,void 0,void 0,{inputs:Gt(i,"input")})}getGraph(e){const r=new rb,n=r.addNode({name:`${this.getName()}Input`,schema:Ii.any()}),i=r.addNode(this),a=r.addNode({name:`${this.getName()}Output`,schema:Ii.any()});return r.addEdge(n,i),r.addEdge(i,a),r}pipe(e){return new Gr({first:this,last:so(e)})}pick(e){return this.pipe(new T6(e))}assign(e){return this.pipe(new H1(new $u({steps:e})))}async*transform(e,r){let n;for await(const i of e)n===void 0?n=i:n=pn(n,i);yield*this._streamIterator(n,Je(r))}async*streamLog(e,r,n){const i=new sC({...n,autoClose:!1,_schemaFormat:"original"}),a=Je(r);yield*this._streamLog(e,i,a)}async*_streamLog(e,r,n){const{callbacks:i}=n;if(i===void 0)n.callbacks=[r];else if(Array.isArray(i))n.callbacks=i.concat([r]);else{const l=i.copy();l.addHandler(r,!0),n.callbacks=l}const a=this.stream(e,n);async function o(){try{const l=await a;for await(const c of l){const d=new da({ops:[{op:"add",path:"/streamed_output/-",value:c}]});await r.writer.write(d)}}finally{await r.writer.close()}}const s=o();try{for await(const l of r)yield l}finally{await s}}streamEvents(e,r,n){let i;if(r.version==="v1")i=this._streamEventsV1(e,r,n);else if(r.version==="v2")i=this._streamEventsV2(e,r,n);else throw new Error('Only versions "v1" and "v2" of the schema are currently supported.');return r.encoding==="text/event-stream"?E6(i):Tr.fromAsyncGenerator(i)}async*_streamEventsV2(e,r,n){const i=new R8({...n,autoClose:!1}),a=Je(r),o=a.runId??lr();a.runId=o;const s=a.callbacks;if(s===void 0)a.callbacks=[i];else if(Array.isArray(s))a.callbacks=s.concat(i);else{const b=s.copy();b.addHandler(i,!0),a.callbacks=b}const l=new AbortController,c=this;async function d(){try{let b;r?.signal?"any"in AbortSignal?b=AbortSignal.any([l.signal,r.signal]):(b=r.signal,r.signal.addEventListener("abort",()=>{l.abort()},{once:!0})):b=l.signal;const g=await c.stream(e,{...a,signal:b}),v=i.tapOutputIterable(o,g);for await(const E of v)if(l.signal.aborted)break}finally{await i.finish()}}const f=d();let h=!1,p;try{for await(const b of i){if(!h){b.data.input=e,h=!0,p=b.run_id,yield b;continue}b.run_id===p&&b.event.endsWith("_end")&&b.data?.input&&delete b.data.input,yield b}}finally{l.abort(),await f}}async*_streamEventsV1(e,r,n){let i,a=!1;const o=Je(r),s=o.tags??[],l=o.metadata??{},c=o.runName??this.getName(),d=new sC({...n,autoClose:!1,_schemaFormat:"streaming_events"}),f=new I8({...n}),h=this._streamLog(e,d,o);for await(const b of h){if(i?i=i.concat(b):i=Dc.fromRunLogPatch(b),i.state===void 0)throw new Error('Internal error: "streamEvents" state is missing. Please open a bug report.');if(!a){a=!0;const C={...i.state},S={run_id:C.id,event:`on_${C.type}_start`,name:c,tags:s,metadata:l,data:{input:e}};f.includeEvent(S,C.type)&&(yield S)}const g=b.ops.filter(C=>C.path.startsWith("/logs/")).map(C=>C.path.split("/")[2]),v=[...new Set(g)];for(const C of v){let S,N={};const D=i.state.logs[C];if(D.end_time===void 0?D.streamed_output.length>0?S="stream":S="start":S="end",S==="start")D.inputs!==void 0&&(N.input=D.inputs);else if(S==="end")D.inputs!==void 0&&(N.input=D.inputs),N.output=D.final_output;else if(S==="stream"){const Z=D.streamed_output.length;if(Z!==1)throw new Error(`Expected exactly one chunk of streamed output, got ${Z} instead. Encountered in: "${D.name}"`);N={chunk:D.streamed_output[0]},D.streamed_output=[]}yield{event:`on_${D.type}_${S}`,name:D.name,run_id:D.id,tags:D.tags,metadata:D.metadata,data:N}}const{state:E}=i;if(E.streamed_output.length>0){const C=E.streamed_output.length;if(C!==1)throw new Error(`Expected exactly one chunk of streamed output, got ${C} instead. Encountered in: "${E.name}"`);const S={chunk:E.streamed_output[0]};E.streamed_output=[];const N={event:`on_${E.type}_stream`,run_id:E.id,tags:s,metadata:l,name:c,data:S};f.includeEvent(N,E.type)&&(yield N)}}const p=i?.state;if(p!==void 0){const b={event:`on_${p.type}_end`,name:c,run_id:p.id,tags:s,metadata:l,data:{output:p.final_output}};f.includeEvent(b,p.type)&&(yield b)}}static isRunnable(e){return aE(e)}withListeners({onStart:e,onEnd:r,onError:n}){return new po({bound:this,config:{},configFactories:[i=>({callbacks:[new B1({config:i,onStart:e,onEnd:r,onError:n})]})]})}asTool(e){return R6(this,e)}}class po extends Tt{static lc_name(){return"RunnableBinding"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"bound",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"configFactories",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.bound=e.bound,this.kwargs=e.kwargs,this.config=e.config,this.configFactories=e.configFactories}getName(e){return this.bound.getName(e)}async _mergeConfig(...e){const r=iC(this.config,...e);return iC(r,...this.configFactories?await Promise.all(this.configFactories.map(async n=>await n(r))):[])}bind(e){return new this.constructor({bound:this.bound,kwargs:{...this.kwargs,...e},config:this.config})}withConfig(e){return new this.constructor({bound:this.bound,kwargs:this.kwargs,config:{...this.config,...e}})}withRetry(e){return new this.constructor({bound:this.bound.withRetry(e),kwargs:this.kwargs,config:this.config})}async invoke(e,r){return this.bound.invoke(e,await this._mergeConfig(Je(r),this.kwargs))}async batch(e,r,n){const i=Array.isArray(r)?await Promise.all(r.map(async a=>this._mergeConfig(Je(a),this.kwargs))):await this._mergeConfig(Je(r),this.kwargs);return this.bound.batch(e,i,n)}async*_streamIterator(e,r){yield*this.bound._streamIterator(e,await this._mergeConfig(Je(r),this.kwargs))}async stream(e,r){return this.bound.stream(e,await this._mergeConfig(Je(r),this.kwargs))}async*transform(e,r){yield*this.bound.transform(e,await this._mergeConfig(Je(r),this.kwargs))}streamEvents(e,r,n){const i=this,a=async function*(){yield*i.bound.streamEvents(e,{...await i._mergeConfig(Je(r),i.kwargs),version:r.version},n)};return Tr.fromAsyncGenerator(a())}static isRunnableBinding(e){return e.bound&&Tt.isRunnable(e.bound)}withListeners({onStart:e,onEnd:r,onError:n}){return new po({bound:this.bound,kwargs:this.kwargs,config:this.config,configFactories:[i=>({callbacks:[new B1({config:i,onStart:e,onEnd:r,onError:n})]})]})}}class _y extends Tt{static lc_name(){return"RunnableEach"}constructor(e){super(e),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"bound",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.bound=e.bound}bind(e){return new _y({bound:this.bound.bind(e)})}async invoke(e,r){return this._callWithConfig(this._invoke.bind(this),e,r)}async _invoke(e,r,n){return this.bound.batch(e,cr(r,{callbacks:n?.getChild()}))}withListeners({onStart:e,onEnd:r,onError:n}){return new _y({bound:this.bound.withListeners({onStart:e,onEnd:r,onError:n})})}}class j6 extends po{static lc_name(){return"RunnableRetry"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"maxAttemptNumber",{enumerable:!0,configurable:!0,writable:!0,value:3}),Object.defineProperty(this,"onFailedAttempt",{enumerable:!0,configurable:!0,writable:!0,value:()=>{}}),this.maxAttemptNumber=e.maxAttemptNumber??this.maxAttemptNumber,this.onFailedAttempt=e.onFailedAttempt??this.onFailedAttempt}_patchConfigForRetry(e,r,n){const i=e>1?`retry:attempt:${e}`:void 0;return cr(r,{callbacks:n?.getChild(i)})}async _invoke(e,r,n){return ry(i=>super.invoke(e,this._patchConfigForRetry(i,r,n)),{onFailedAttempt:i=>this.onFailedAttempt(i,e),retries:Math.max(this.maxAttemptNumber-1,0),randomize:!0})}async invoke(e,r){return this._callWithConfig(this._invoke.bind(this),e,r)}async _batch(e,r,n,i){const a={};try{await ry(async o=>{const s=e.map((h,p)=>p).filter(h=>a[h.toString()]===void 0||a[h.toString()]instanceof Error),l=s.map(h=>e[h]),c=s.map(h=>this._patchConfigForRetry(o,r?.[h],n?.[h])),d=await super.batch(l,c,{...i,returnExceptions:!0});let f;for(let h=0;h<d.length;h+=1){const p=d[h],b=s[h];p instanceof Error&&f===void 0&&(f=p,f.input=l[h]),a[b.toString()]=p}if(f)throw f;return d},{onFailedAttempt:o=>this.onFailedAttempt(o,o.input),retries:Math.max(this.maxAttemptNumber-1,0),randomize:!0})}catch(o){if(i?.returnExceptions!==!0)throw o}return Object.keys(a).sort((o,s)=>parseInt(o,10)-parseInt(s,10)).map(o=>a[parseInt(o,10)])}async batch(e,r,n){return this._batchWithConfig(this._batch.bind(this),e,r,n)}}class Gr extends Tt{static lc_name(){return"RunnableSequence"}constructor(e){super(e),Object.defineProperty(this,"first",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"middle",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"last",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"omitSequenceTags",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),this.first=e.first,this.middle=e.middle??this.middle,this.last=e.last,this.name=e.name,this.omitSequenceTags=e.omitSequenceTags??this.omitSequenceTags}get steps(){return[this.first,...this.middle,this.last]}async invoke(e,r){const n=Je(r),a=await(await xn(n))?.handleChainStart(this.toJSON(),Gt(e,"input"),n.runId,void 0,void 0,void 0,n?.runName);delete n.runId;let o=e,s;try{const l=[this.first,...this.middle];for(let c=0;c<l.length;c+=1){const f=l[c].invoke(o,cr(n,{callbacks:a?.getChild(this.omitSequenceTags?void 0:`seq:step:${c+1}`)}));o=await Ra(f,r?.signal)}if(r?.signal?.aborted)throw new Error("Aborted");s=await this.last.invoke(o,cr(n,{callbacks:a?.getChild(this.omitSequenceTags?void 0:`seq:step:${this.steps.length}`)}))}catch(l){throw await a?.handleChainError(l),l}return await a?.handleChainEnd(Gt(s,"output")),s}async batch(e,r,n){const i=this._getOptionsList(r??{},e.length),a=await Promise.all(i.map(xn)),o=await Promise.all(a.map(async(l,c)=>{const d=await l?.handleChainStart(this.toJSON(),Gt(e[c],"input"),i[c].runId,void 0,void 0,void 0,i[c].runName);return delete i[c].runId,d}));let s=e;try{for(let l=0;l<this.steps.length;l+=1){const d=this.steps[l].batch(s,o.map((f,h)=>{const p=f?.getChild(this.omitSequenceTags?void 0:`seq:step:${l+1}`);return cr(i[h],{callbacks:p})}),n);s=await Ra(d,i[0]?.signal)}}catch(l){throw await Promise.all(o.map(c=>c?.handleChainError(l))),l}return await Promise.all(o.map(l=>l?.handleChainEnd(Gt(s,"output")))),s}async*_streamIterator(e,r){const n=await xn(r),{runId:i,...a}=r??{},o=await n?.handleChainStart(this.toJSON(),Gt(e,"input"),i,void 0,void 0,void 0,a?.runName),s=[this.first,...this.middle,this.last];let l=!0,c;async function*d(){yield e}try{let f=s[0].transform(d(),cr(a,{callbacks:o?.getChild(this.omitSequenceTags?void 0:"seq:step:1")}));for(let h=1;h<s.length;h+=1)f=await s[h].transform(f,cr(a,{callbacks:o?.getChild(this.omitSequenceTags?void 0:`seq:step:${h+1}`)}));for await(const h of f)if(r?.signal?.throwIfAborted(),yield h,l)if(c===void 0)c=h;else try{c=pn(c,h)}catch{c=void 0,l=!1}}catch(f){throw await o?.handleChainError(f),f}await o?.handleChainEnd(Gt(c,"output"))}getGraph(e){const r=new rb;let n=null;return this.steps.forEach((i,a)=>{const o=i.getGraph(e);a!==0&&o.trimFirstNode(),a!==this.steps.length-1&&o.trimLastNode(),r.extend(o);const s=o.firstNode();if(!s)throw new Error(`Runnable ${i} has no first node`);n&&r.addEdge(n,s),n=o.lastNode()}),r}pipe(e){return Gr.isRunnableSequence(e)?new Gr({first:this.first,middle:this.middle.concat([this.last,e.first,...e.middle]),last:e.last,name:this.name??e.name}):new Gr({first:this.first,middle:[...this.middle,this.last],last:so(e),name:this.name})}static isRunnableSequence(e){return Array.isArray(e.middle)&&Tt.isRunnable(e)}static from([e,...r],n){let i={};return typeof n=="string"?i.name=n:n!==void 0&&(i=n),new Gr({...i,first:so(e),middle:r.slice(0,-1).map(so),last:so(r[r.length-1])})}}class $u extends Tt{static lc_name(){return"RunnableMap"}getStepsKeys(){return Object.keys(this.steps)}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"steps",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.steps={};for(const[r,n]of Object.entries(e.steps))this.steps[r]=so(n)}static from(e){return new $u({steps:e})}async invoke(e,r){const n=Je(r),a=await(await xn(n))?.handleChainStart(this.toJSON(),{input:e},n.runId,void 0,void 0,void 0,n?.runName);delete n.runId;const o={};try{const s=Object.entries(this.steps).map(async([l,c])=>{o[l]=await c.invoke(e,cr(n,{callbacks:a?.getChild(`map:key:${l}`)}))});await Ra(Promise.all(s),r?.signal)}catch(s){throw await a?.handleChainError(s),s}return await a?.handleChainEnd(o),o}async*_transform(e,r,n){const i={...this.steps},a=z1(e,Object.keys(i).length),o=new Map(Object.entries(i).map(([s,l],c)=>{const d=l.transform(a[c],cr(n,{callbacks:r?.getChild(`map:key:${s}`)}));return[s,d.next().then(f=>({key:s,gen:d,result:f}))]}));for(;o.size;){const s=Promise.race(o.values()),{key:l,result:c,gen:d}=await Ra(s,n?.signal);o.delete(l),c.done||(yield{[l]:c.value},o.set(l,d.next().then(f=>({key:l,gen:d,result:f}))))}}transform(e,r){return this._transformStreamWithConfig(e,this._transform.bind(this),r)}async stream(e,r){async function*n(){yield e}const i=Je(r),a=new Au({generator:this.transform(n(),i),config:i});return await a.setup,Tr.fromAsyncGenerator(a)}}class oE extends Tt{constructor(e){if(super(e),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"func",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),!QS(e.func))throw new Error("RunnableTraceable requires a function that is wrapped in traceable higher-order function");this.func=e.func}async invoke(e,r){const[n]=this._getOptionsList(r??{},1),i=await xn(n),a=this.func(cr(n,{callbacks:i}),e);return Ra(a,n?.signal)}async*_streamIterator(e,r){const[n]=this._getOptionsList(r??{},1),i=await this.invoke(e,r);if(AO(i)){for await(const a of i)n?.signal?.throwIfAborted(),yield a;return}if(P6(i)){for(;;){n?.signal?.throwIfAborted();const a=i.next();if(a.done)break;yield a.value}return}yield i}static from(e){return new oE({func:e})}}function C6(t){if(QS(t))throw new Error("RunnableLambda requires a function that is not wrapped in traceable higher-order function. This shouldn't happen.")}class ed extends Tt{static lc_name(){return"RunnableLambda"}constructor(e){if(QS(e.func))return oE.from(e.func);super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"func",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),C6(e.func),this.func=e.func}static from(e){return new ed({func:e})}async _invoke(e,r,n){return new Promise((i,a)=>{const o=cr(r,{callbacks:n?.getChild(),recursionLimit:(r?.recursionLimit??ow)-1});Ta.runWithConfig(hu(o),async()=>{try{let s=await this.func(e,{...o});if(s&&Tt.isRunnable(s)){if(r?.recursionLimit===0)throw new Error("Recursion limit reached.");s=await s.invoke(e,{...o,recursionLimit:(o.recursionLimit??ow)-1})}else if(AO(s)){let l;for await(const c of $O(o,s))if(r?.signal?.throwIfAborted(),l===void 0)l=c;else try{l=pn(l,c)}catch{l=c}s=l}else if(hC(s)){let l;for(const c of pC(o,s))if(r?.signal?.throwIfAborted(),l===void 0)l=c;else try{l=pn(l,c)}catch{l=c}s=l}i(s)}catch(s){a(s)}})})}async invoke(e,r){return this._callWithConfig(this._invoke.bind(this),e,r)}async*_transform(e,r,n){let i;for await(const s of e)if(i===void 0)i=s;else try{i=pn(i,s)}catch{i=s}const a=cr(n,{callbacks:r?.getChild(),recursionLimit:(n?.recursionLimit??ow)-1}),o=await new Promise((s,l)=>{Ta.runWithConfig(hu(a),async()=>{try{const c=await this.func(i,{...a,config:a});s(c)}catch(c){l(c)}})});if(o&&Tt.isRunnable(o)){if(n?.recursionLimit===0)throw new Error("Recursion limit reached.");const s=await o.stream(i,a);for await(const l of s)yield l}else if(AO(o))for await(const s of $O(a,o))n?.signal?.throwIfAborted(),yield s;else if(hC(o))for(const s of pC(a,o))n?.signal?.throwIfAborted(),yield s;else yield o}transform(e,r){return this._transformStreamWithConfig(e,this._transform.bind(this),r)}async stream(e,r){async function*n(){yield e}const i=Je(r),a=new Au({generator:this.transform(n(),i),config:i});return await a.setup,Tr.fromAsyncGenerator(a)}}class M6 extends Tt{static lc_name(){return"RunnableWithFallbacks"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"runnable",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fallbacks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.runnable=e.runnable,this.fallbacks=e.fallbacks}*runnables(){yield this.runnable;for(const e of this.fallbacks)yield e}async invoke(e,r){const n=Je(r),i=await xn(n),{runId:a,...o}=n,s=await i?.handleChainStart(this.toJSON(),Gt(e,"input"),a,void 0,void 0,void 0,o?.runName),l=cr(o,{callbacks:s?.getChild()});return await Ta.runWithConfig(l,async()=>{let d;for(const f of this.runnables()){n?.signal?.throwIfAborted();try{const h=await f.invoke(e,l);return await s?.handleChainEnd(Gt(h,"output")),h}catch(h){d===void 0&&(d=h)}}throw d===void 0?new Error("No error stored at end of fallback."):(await s?.handleChainError(d),d)})}async*_streamIterator(e,r){const n=Je(r),i=await xn(n),{runId:a,...o}=n,s=await i?.handleChainStart(this.toJSON(),Gt(e,"input"),a,void 0,void 0,void 0,o?.runName);let l,c;for(const f of this.runnables()){n?.signal?.throwIfAborted();const h=cr(o,{callbacks:s?.getChild()});try{const p=await f.stream(e,h);c=$O(h,p);break}catch(p){l===void 0&&(l=p)}}if(c===void 0){const f=l??new Error("No error stored at end of fallback.");throw await s?.handleChainError(f),f}let d;try{for await(const f of c){yield f;try{d=d===void 0?d:pn(d,f)}catch{d=void 0}}}catch(f){throw await s?.handleChainError(f),f}await s?.handleChainEnd(Gt(d,"output"))}async batch(e,r,n){if(n?.returnExceptions)throw new Error("Not implemented.");const i=this._getOptionsList(r??{},e.length),a=await Promise.all(i.map(l=>xn(l))),o=await Promise.all(a.map(async(l,c)=>{const d=await l?.handleChainStart(this.toJSON(),Gt(e[c],"input"),i[c].runId,void 0,void 0,void 0,i[c].runName);return delete i[c].runId,d}));let s;for(const l of this.runnables()){i[0].signal?.throwIfAborted();try{const c=await l.batch(e,o.map((d,f)=>cr(i[f],{callbacks:d?.getChild()})),n);return await Promise.all(o.map((d,f)=>d?.handleChainEnd(Gt(c[f],"output")))),c}catch(c){s===void 0&&(s=c)}}throw s?(await Promise.all(o.map(l=>l?.handleChainError(s))),s):new Error("No error stored at end of fallbacks.")}}function so(t){if(typeof t=="function")return new ed({func:t});if(Tt.isRunnable(t))return t;if(!Array.isArray(t)&&typeof t=="object"){const e={};for(const[r,n]of Object.entries(t))e[r]=so(n);return new $u({steps:e})}else throw new Error(`Expected a Runnable, function or object.
Instead got an unsupported type.`)}class H1 extends Tt{static lc_name(){return"RunnableAssign"}constructor(e){e instanceof $u&&(e={mapper:e}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"mapper",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.mapper=e.mapper}async invoke(e,r){const n=await this.mapper.invoke(e,r);return{...e,...n}}async*_transform(e,r,n){const i=this.mapper.getStepsKeys(),[a,o]=z1(e),s=this.mapper.transform(o,cr(n,{callbacks:r?.getChild()})),l=s.next();for await(const c of a){if(typeof c!="object"||Array.isArray(c))throw new Error(`RunnableAssign can only be used with objects as input, got ${typeof c}`);const d=Object.fromEntries(Object.entries(c).filter(([f])=>!i.includes(f)));Object.keys(d).length>0&&(yield d)}yield(await l).value;for await(const c of s)yield c}transform(e,r){return this._transformStreamWithConfig(e,this._transform.bind(this),r)}async stream(e,r){async function*n(){yield e}const i=Je(r),a=new Au({generator:this.transform(n(),i),config:i});return await a.setup,Tr.fromAsyncGenerator(a)}}class T6 extends Tt{static lc_name(){return"RunnablePick"}constructor(e){(typeof e=="string"||Array.isArray(e))&&(e={keys:e}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"keys",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.keys=e.keys}async _pick(e){if(typeof this.keys=="string")return e[this.keys];{const r=this.keys.map(n=>[n,e[n]]).filter(n=>n[1]!==void 0);return r.length===0?void 0:Object.fromEntries(r)}}async invoke(e,r){return this._callWithConfig(this._pick.bind(this),e,r)}async*_transform(e){for await(const r of e){const n=await this._pick(r);n!==void 0&&(yield n)}}transform(e,r){return this._transformStreamWithConfig(e,this._transform.bind(this),r)}async stream(e,r){async function*n(){yield e}const i=Je(r),a=new Au({generator:this.transform(n(),i),config:i});return await a.setup,Tr.fromAsyncGenerator(a)}}class _C extends po{constructor(e){const r=Gr.from([ed.from(async n=>{let i;if(O$(n))try{i=await this.schema.parseAsync(n.args)}catch{throw new F4("Received tool input did not match expected schema",JSON.stringify(n.args))}else i=n;return i}).withConfig({runName:`${e.name}:parse_input`}),e.bound]).withConfig({runName:e.name});super({bound:r,config:e.config??{}}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"description",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"schema",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name=e.name,this.description=e.description,this.schema=e.schema}static lc_name(){return"RunnableToolLike"}}function R6(t,e){const r=e.name??t.getName(),n=e.description??e.schema?.description;return e.schema.constructor===Ii.ZodString?new _C({name:r,description:n,schema:Ii.object({input:Ii.string()}).transform(i=>i.input),bound:t}):new _C({name:r,description:n,schema:e.schema,bound:t})}class A6 extends Tt{constructor(e){super(e),Object.defineProperty(this,"callbacks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"verbose",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.callbacks=e?.callbacks,this.tags=e?.tags??[],this.metadata=e?.metadata??{},this.verbose=e?.verbose??!1}_getRelevantDocuments(e,r){throw new Error("Not implemented!")}async invoke(e,r){return this.getRelevantDocuments(e,Je(r))}async getRelevantDocuments(e,r){const n=Je(HV(r)),a=await(await Wt.configure(n.callbacks,this.callbacks,n.tags,this.tags,n.metadata,this.metadata,{verbose:this.verbose}))?.handleRetrieverStart(this.toJSON(),e,n.runId,void 0,void 0,void 0,n.runName);try{const o=await this._getRelevantDocuments(e,a);return await a?.handleRetrieverEnd(o),o}catch(o){throw await a?.handleRetrieverError(o),o}}}class cw extends A6{static lc_name(){return"VectorStoreRetriever"}get lc_namespace(){return["langchain_core","vectorstores"]}_vectorstoreType(){return this.vectorStore._vectorstoreType()}constructor(e){super(e),Object.defineProperty(this,"vectorStore",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"k",{enumerable:!0,configurable:!0,writable:!0,value:4}),Object.defineProperty(this,"searchType",{enumerable:!0,configurable:!0,writable:!0,value:"similarity"}),Object.defineProperty(this,"searchKwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"filter",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.vectorStore=e.vectorStore,this.k=e.k??this.k,this.searchType=e.searchType??this.searchType,this.filter=e.filter,e.searchType==="mmr"&&(this.searchKwargs=e.searchKwargs)}async _getRelevantDocuments(e,r){if(this.searchType==="mmr"){if(typeof this.vectorStore.maxMarginalRelevanceSearch!="function")throw new Error(`The vector store backing this retriever, ${this._vectorstoreType()} does not support max marginal relevance search.`);return this.vectorStore.maxMarginalRelevanceSearch(e,{k:this.k,filter:this.filter,...this.searchKwargs},r?.getChild("vectorstore"))}return this.vectorStore.similaritySearch(e,this.k,this.filter,r?.getChild("vectorstore"))}async addDocuments(e,r){return this.vectorStore.addDocuments(e,r)}}class $6 extends Ea{constructor(e,r){super(r),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","vectorstores",this._vectorstoreType()]}),Object.defineProperty(this,"embeddings",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.embeddings=e}async delete(e){throw new Error("Not implemented.")}async similaritySearch(e,r=4,n=void 0,i=void 0){return(await this.similaritySearchVectorWithScore(await this.embeddings.embedQuery(e),r,n)).map(o=>o[0])}async similaritySearchWithScore(e,r=4,n=void 0,i=void 0){return this.similaritySearchVectorWithScore(await this.embeddings.embedQuery(e),r,n)}static fromTexts(e,r,n,i){throw new Error("the Langchain vectorstore implementation you are using forgot to override this, please report a bug")}static fromDocuments(e,r,n){throw new Error("the Langchain vectorstore implementation you are using forgot to override this, please report a bug")}asRetriever(e,r,n,i,a,o){if(typeof e=="number")return new cw({vectorStore:this,k:e,filter:r,tags:[...i??[],this._vectorstoreType()],metadata:a,verbose:o,callbacks:n});{const s={vectorStore:this,k:e?.k,filter:e?.filter,tags:[...e?.tags??[],this._vectorstoreType()],metadata:e?.metadata,verbose:e?.verbose,callbacks:e?.callbacks,searchType:e?.searchType};return e?.searchType==="mmr"?new cw({...s,searchKwargs:e.searchKwargs}):new cw({...s})}}}let ba=class{constructor(e){Object.defineProperty(this,"pageContent",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.pageContent=e.pageContent!==void 0?e.pageContent.toString():"",this.metadata=e.metadata??{},this.id=e.id}};class I6 extends Tt{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","documents","transformers"]})}invoke(e,r){return this.transformDocuments(e)}}function x6(t,e){let r=0,n=0,i=0;for(let a=0;a<t.length;a++)r+=t[a]*e[a],n+=t[a]*t[a],i+=e[a]*e[a];return r/(Math.sqrt(n)*Math.sqrt(i))}function D6(t,e){let r=0,n=0,i=0;for(let a=0;a<t.length;a++)r+=t[a]*e[a],n+=t[a]*t[a],i+=e[a]*e[a];return r/(Math.sqrt(n)*Math.sqrt(i))}function N6(t,e,r){if(t.length===0||t[0].length===0||e.length===0||e[0].length===0)return[[]];if(t[0].length!==e[0].length)throw new Error(`Number of columns in X and Y must be the same. X has shape ${[t.length,t[0].length]} and Y has shape ${[e.length,e[0].length]}.`);return t.map(n=>e.map(i=>r(n,i)).map(i=>Number.isNaN(i)?0:i))}function yC(t,e){return N6(t,e,D6)}function z6(t,e,r=.5,n=4){if(Math.min(n,e.length)<=0)return[];const i=Array.isArray(t[0])?t:[t],a=yC(i,e)[0],o=B6(a).maxIndex,s=[e[o]],l=[o];for(;l.length<Math.min(n,e.length);){let c=-1/0,d=-1;const f=yC(e,s);a.forEach((h,p)=>{if(l.includes(p))return;const b=Math.max(...f[p]),g=r*h-(1-r)*b;g>c&&(c=g,d=p)}),s.push(e[d]),l.push(d)}return l}function B6(t){if(t.length===0)return{maxIndex:-1,maxValue:NaN};let e=t[0],r=0;for(let n=1;n<t.length;n+=1)t[n]>e&&(r=n,e=t[n]);return{maxIndex:r,maxValue:e}}class sE extends $6{_vectorstoreType(){return"memory"}constructor(e,{similarity:r,...n}={}){super(e,n),Object.defineProperty(this,"memoryVectors",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"similarity",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.similarity=r??x6}async addDocuments(e){const r=e.map(({pageContent:n})=>n);return this.addVectors(await this.embeddings.embedDocuments(r),e)}async addVectors(e,r){const n=e.map((i,a)=>({content:r[a].pageContent,embedding:i,metadata:r[a].metadata,id:r[a].id}));this.memoryVectors=this.memoryVectors.concat(n)}async _queryVectors(e,r,n){const i=o=>{if(!n)return!0;const s=new ba({metadata:o.metadata,pageContent:o.content,id:o.id});return n(s)};return this.memoryVectors.filter(i).map((o,s)=>({similarity:this.similarity(e,o.embedding),index:s,metadata:o.metadata,content:o.content,embedding:o.embedding,id:o.id})).sort((o,s)=>o.similarity>s.similarity?-1:0).slice(0,r)}async similaritySearchVectorWithScore(e,r,n){return(await this._queryVectors(e,r,n)).map(o=>[new ba({metadata:o.metadata,pageContent:o.content,id:o.id}),o.similarity])}async maxMarginalRelevanceSearch(e,r){const n=await this.embeddings.embedQuery(e),i=await this._queryVectors(n,r.fetchK??20,r.filter),a=i.map(s=>s.embedding);return z6(n,a,r.lambda,r.k).map(s=>new ba({metadata:i[s].metadata,pageContent:i[s].content,id:i[s].id}))}static async fromTexts(e,r,n,i){const a=[];for(let o=0;o<e.length;o+=1){const s=Array.isArray(r)?r[o]:r,l=new ba({pageContent:e[o],metadata:s});a.push(l)}return sE.fromDocuments(a,n,i)}static async fromDocuments(e,r,n){const i=new this(r,n);return await i.addDocuments(e),i}static async fromExistingIndex(e,r){return new this(e,r)}}const U6="modulepreload",F6=function(t){return"/"+t},bC={},va=function(e,r,n){let i=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),s=o?.nonce||o?.getAttribute("nonce");i=Promise.allSettled(r.map(l=>{if(l=F6(l),l in bC)return;bC[l]=!0;const c=l.endsWith(".css"),d=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${d}`))return;const f=document.createElement("link");if(f.rel=c?"stylesheet":U6,c||(f.as="script"),f.crossOrigin="",f.href=l,s&&f.setAttribute("nonce",s),document.head.appendChild(f),c)return new Promise((h,p)=>{f.addEventListener("load",h),f.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${l}`)))})}))}function a(o){const s=new Event("vite:preloadError",{cancelable:!0});if(s.payload=o,window.dispatchEvent(s),!s.defaultPrevented)throw o}return i.then(o=>{for(const s of o||[])s.status==="rejected"&&a(s.reason);return e().catch(a)})};class uE extends Tt{get lc_attributes(){return{partialVariables:void 0}}constructor(e){super(e),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompts",this._getPromptType()]}),Object.defineProperty(this,"inputVariables",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"outputParser",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"partialVariables",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0});const{inputVariables:r}=e;if(r.includes("stop"))throw new Error("Cannot have an input variable named 'stop', as it is used internally, please rename.");Object.assign(this,e)}async mergePartialAndUserVariables(e){const r=this.partialVariables??{},n={};for(const[a,o]of Object.entries(r))typeof o=="string"?n[a]=o:n[a]=await o();return{...n,...e}}async invoke(e,r){const n={...this.metadata,...r?.metadata},i=[...this.tags??[],...r?.tags??[]];return this._callWithConfig(a=>this.formatPromptValue(a),e,{...r,tags:i,metadata:n,runType:"prompt"})}serialize(){throw new Error("Use .toJSON() instead")}static async deserialize(e){switch(e._type){case"prompt":{const{PromptTemplate:r}=await va(async()=>{const{PromptTemplate:n}=await Promise.resolve().then(()=>vC);return{PromptTemplate:n}},void 0);return r.deserialize(e)}case void 0:{const{PromptTemplate:r}=await va(async()=>{const{PromptTemplate:n}=await Promise.resolve().then(()=>vC);return{PromptTemplate:n}},void 0);return r.deserialize({...e,_type:"prompt"})}case"few_shot":{const{FewShotPromptTemplate:r}=await va(async()=>{const{FewShotPromptTemplate:n}=await import("./few_shot-BT12jfET.js");return{FewShotPromptTemplate:n}},[]);return r.deserialize(e)}default:throw new Error(`Invalid prompt type in config: ${e._type}`)}}}class lE extends Ea{}class q1 extends lE{static lc_name(){return"StringPromptValue"}constructor(e){super({value:e}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompt_values"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.value=e}toString(){return this.value}toChatMessages(){return[new Pa(this.value)]}}class G1 extends lE{static lc_name(){return"ChatPromptValue"}constructor(e){Array.isArray(e)&&(e={messages:e}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompt_values"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"messages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.messages=e.messages}toString(){return WS(this.messages)}toChatMessages(){return this.messages}}class L6 extends lE{static lc_name(){return"ImagePromptValue"}constructor(e){"imageUrl"in e||(e={imageUrl:e}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompt_values"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"imageUrl",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.imageUrl=e.imageUrl}toString(){return this.imageUrl.url}toChatMessages(){return[new Pa({content:[{type:"image_url",image_url:{detail:this.imageUrl.detail,url:this.imageUrl.url}}]})]}}class IO extends uE{async formatPromptValue(e){const r=await this.format(e);return new q1(r)}}/*!
 * mustache.js - Logic-less {{mustache}} templates with JavaScript
 * http://github.com/janl/mustache.js
 */var V6=Object.prototype.toString,Iu=Array.isArray||function(e){return V6.call(e)==="[object Array]"};function cE(t){return typeof t=="function"}function k6(t){return Iu(t)?"array":typeof t}function dw(t){return t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function gC(t,e){return t!=null&&typeof t=="object"&&e in t}function H6(t,e){return t!=null&&typeof t!="object"&&t.hasOwnProperty&&t.hasOwnProperty(e)}var q6=RegExp.prototype.test;function G6(t,e){return q6.call(t,e)}var W6=/\S/;function K6(t){return!G6(W6,t)}var J6={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};function X6(t){return String(t).replace(/[&<>"'`=\/]/g,function(r){return J6[r]})}var Z6=/\s*/,Y6=/\s+/,mC=/\s*=/,Q6=/\s*\}/,ek=/#|\^|\/|>|\{|&|=|!/;function tk(t,e){if(!t)return[];var r=!1,n=[],i=[],a=[],o=!1,s=!1,l="",c=0;function d(){if(o&&!s)for(;a.length;)delete i[a.pop()];else a=[];o=!1,s=!1}var f,h,p;function b(re){if(typeof re=="string"&&(re=re.split(Y6,2)),!Iu(re)||re.length!==2)throw new Error("Invalid tags: "+re);f=new RegExp(dw(re[0])+"\\s*"),h=new RegExp("\\s*"+dw(re[1])),p=new RegExp("\\s*"+dw("}"+re[1]))}b(e||Rr.tags);for(var g=new td(t),v,E,C,S,N,D;!g.eos();){if(v=g.pos,C=g.scanUntil(f),C)for(var Z=0,se=C.length;Z<se;++Z)S=C.charAt(Z),K6(S)?(a.push(i.length),l+=S):(s=!0,r=!0,l+=" "),i.push(["text",S,v,v+1]),v+=1,S===`
`&&(d(),l="",c=0,r=!1);if(!g.scan(f))break;if(o=!0,E=g.scan(ek)||"name",g.scan(Z6),E==="="?(C=g.scanUntil(mC),g.scan(mC),g.scanUntil(h)):E==="{"?(C=g.scanUntil(p),g.scan(Q6),g.scanUntil(h),E="&"):C=g.scanUntil(h),!g.scan(h))throw new Error("Unclosed tag at "+g.pos);if(E==">"?N=[E,C,v,g.pos,l,c,r]:N=[E,C,v,g.pos],c++,i.push(N),E==="#"||E==="^")n.push(N);else if(E==="/"){if(D=n.pop(),!D)throw new Error('Unopened section "'+C+'" at '+v);if(D[1]!==C)throw new Error('Unclosed section "'+D[1]+'" at '+v)}else E==="name"||E==="{"||E==="&"?s=!0:E==="="&&b(C)}if(d(),D=n.pop(),D)throw new Error('Unclosed section "'+D[1]+'" at '+g.pos);return nk(rk(i))}function rk(t){for(var e=[],r,n,i=0,a=t.length;i<a;++i)r=t[i],r&&(r[0]==="text"&&n&&n[0]==="text"?(n[1]+=r[1],n[3]=r[3]):(e.push(r),n=r));return e}function nk(t){for(var e=[],r=e,n=[],i,a,o=0,s=t.length;o<s;++o)switch(i=t[o],i[0]){case"#":case"^":r.push(i),n.push(i),r=i[4]=[];break;case"/":a=n.pop(),a[5]=i[2],r=n.length>0?n[n.length-1][4]:e;break;default:r.push(i)}return e}function td(t){this.string=t,this.tail=t,this.pos=0}td.prototype.eos=function(){return this.tail===""};td.prototype.scan=function(e){var r=this.tail.match(e);if(!r||r.index!==0)return"";var n=r[0];return this.tail=this.tail.substring(n.length),this.pos+=n.length,n};td.prototype.scanUntil=function(e){var r=this.tail.search(e),n;switch(r){case-1:n=this.tail,this.tail="";break;case 0:n="";break;default:n=this.tail.substring(0,r),this.tail=this.tail.substring(r)}return this.pos+=n.length,n};function pu(t,e){this.view=t,this.cache={".":this.view},this.parent=e}pu.prototype.push=function(e){return new pu(e,this)};pu.prototype.lookup=function(e){var r=this.cache,n;if(r.hasOwnProperty(e))n=r[e];else{for(var i=this,a,o,s,l=!1;i;){if(e.indexOf(".")>0)for(a=i.view,o=e.split("."),s=0;a!=null&&s<o.length;)s===o.length-1&&(l=gC(a,o[s])||H6(a,o[s])),a=a[o[s++]];else a=i.view[e],l=gC(i.view,e);if(l){n=a;break}i=i.parent}r[e]=n}return cE(n)&&(n=n.call(this.view)),n};function gr(){this.templateCache={_cache:{},set:function(e,r){this._cache[e]=r},get:function(e){return this._cache[e]},clear:function(){this._cache={}}}}gr.prototype.clearCache=function(){typeof this.templateCache<"u"&&this.templateCache.clear()};gr.prototype.parse=function(e,r){var n=this.templateCache,i=e+":"+(r||Rr.tags).join(":"),a=typeof n<"u",o=a?n.get(i):void 0;return o==null&&(o=tk(e,r),a&&n.set(i,o)),o};gr.prototype.render=function(e,r,n,i){var a=this.getConfigTags(i),o=this.parse(e,a),s=r instanceof pu?r:new pu(r,void 0);return this.renderTokens(o,s,n,e,i)};gr.prototype.renderTokens=function(e,r,n,i,a){for(var o="",s,l,c,d=0,f=e.length;d<f;++d)c=void 0,s=e[d],l=s[0],l==="#"?c=this.renderSection(s,r,n,i,a):l==="^"?c=this.renderInverted(s,r,n,i,a):l===">"?c=this.renderPartial(s,r,n,a):l==="&"?c=this.unescapedValue(s,r):l==="name"?c=this.escapedValue(s,r,a):l==="text"&&(c=this.rawValue(s)),c!==void 0&&(o+=c);return o};gr.prototype.renderSection=function(e,r,n,i,a){var o=this,s="",l=r.lookup(e[1]);function c(h){return o.render(h,r,n,a)}if(l){if(Iu(l))for(var d=0,f=l.length;d<f;++d)s+=this.renderTokens(e[4],r.push(l[d]),n,i,a);else if(typeof l=="object"||typeof l=="string"||typeof l=="number")s+=this.renderTokens(e[4],r.push(l),n,i,a);else if(cE(l)){if(typeof i!="string")throw new Error("Cannot use higher-order sections without the original template");l=l.call(r.view,i.slice(e[3],e[5]),c),l!=null&&(s+=l)}else s+=this.renderTokens(e[4],r,n,i,a);return s}};gr.prototype.renderInverted=function(e,r,n,i,a){var o=r.lookup(e[1]);if(!o||Iu(o)&&o.length===0)return this.renderTokens(e[4],r,n,i,a)};gr.prototype.indentPartial=function(e,r,n){for(var i=r.replace(/[^ \t]/g,""),a=e.split(`
`),o=0;o<a.length;o++)a[o].length&&(o>0||!n)&&(a[o]=i+a[o]);return a.join(`
`)};gr.prototype.renderPartial=function(e,r,n,i){if(n){var a=this.getConfigTags(i),o=cE(n)?n(e[1]):n[e[1]];if(o!=null){var s=e[6],l=e[5],c=e[4],d=o;l==0&&c&&(d=this.indentPartial(o,c,s));var f=this.parse(d,a);return this.renderTokens(f,r,n,d,i)}}};gr.prototype.unescapedValue=function(e,r){var n=r.lookup(e[1]);if(n!=null)return n};gr.prototype.escapedValue=function(e,r,n){var i=this.getConfigEscape(n)||Rr.escape,a=r.lookup(e[1]);if(a!=null)return typeof a=="number"&&i===Rr.escape?String(a):i(a)};gr.prototype.rawValue=function(e){return e[1]};gr.prototype.getConfigTags=function(e){return Iu(e)?e:e&&typeof e=="object"?e.tags:void 0};gr.prototype.getConfigEscape=function(e){if(e&&typeof e=="object"&&!Iu(e))return e.escape};var Rr={name:"mustache.js",version:"4.2.0",tags:["{{","}}"],clearCache:void 0,escape:void 0,parse:void 0,render:void 0,Scanner:void 0,Context:void 0,Writer:void 0,set templateCache(t){Nc.templateCache=t},get templateCache(){return Nc.templateCache}},Nc=new gr;Rr.clearCache=function(){return Nc.clearCache()};Rr.parse=function(e,r){return Nc.parse(e,r)};Rr.render=function(e,r,n,i){if(typeof e!="string")throw new TypeError('Invalid template! Template should be a "string" but "'+k6(e)+'" was given as the first argument for mustache#render(template, view, partials)');return Nc.render(e,r,n,i)};Rr.escape=X6;Rr.Scanner=td;Rr.Context=pu;Rr.Writer=gr;function W1(){Rr.escape=t=>t}const yy=t=>{const e=t.split(""),r=[],n=(a,o)=>{for(let s=o;s<e.length;s+=1)if(a.includes(e[s]))return s;return-1};let i=0;for(;i<e.length;)if(e[i]==="{"&&i+1<e.length&&e[i+1]==="{")r.push({type:"literal",text:"{"}),i+=2;else if(e[i]==="}"&&i+1<e.length&&e[i+1]==="}")r.push({type:"literal",text:"}"}),i+=2;else if(e[i]==="{"){const a=n("}",i);if(a<0)throw new Error("Unclosed '{' in template.");r.push({type:"variable",name:e.slice(i+1,a).join("")}),i=a+1}else{if(e[i]==="}")throw new Error("Single '}' in template.");{const a=n("{}",i),o=(a<0?e.slice(i):e.slice(i,a)).join("");r.push({type:"literal",text:o}),i=a<0?e.length:a}}return r},ik=t=>t.map(e=>e[0]==="name"?{type:"variable",name:e[1].includes(".")?e[1].split(".")[0]:e[1]}:["#","&","^",">"].includes(e[0])?{type:"variable",name:e[1]}:{type:"literal",text:e[1]}),xO=t=>{W1();const e=Rr.parse(t);return ik(e)},ak=(t,e)=>yy(t).reduce((r,n)=>{if(n.type==="variable"){if(n.name in e){const i=typeof e[n.name]=="string"?e[n.name]:JSON.stringify(e[n.name]);return r+i}throw new Error(`(f-string) Missing value for input ${n.name}`)}return r+n.text},""),ok=(t,e)=>(W1(),Rr.render(t,e)),DO={"f-string":ak,mustache:ok},sk={"f-string":yy,mustache:xO},Is=(t,e,r)=>{try{return DO[e](t,r)}catch(n){throw Gy(n,"INVALID_PROMPT_INPUT")}},uk=(t,e)=>sk[e](t),K1=(t,e,r)=>{if(!(e in DO)){const n=Object.keys(DO);throw new Error(`Invalid template format. Got \`${e}\`;
                         should be one of ${n}`)}try{const n=r.reduce((i,a)=>(i[a]="foo",i),{});Array.isArray(t)?t.forEach(i=>{if(i.type==="text")Is(i.text,e,n);else if(i.type==="image_url")if(typeof i.image_url=="string")Is(i.image_url,e,n);else{const a=i.image_url.url;Is(a,e,n)}else throw new Error(`Invalid message template received. ${JSON.stringify(i,null,2)}`)}):Is(t,e,n)}catch(n){throw new Error(`Invalid prompt schema: ${n.message}`)}};class An extends IO{static lc_name(){return"PromptTemplate"}constructor(e){if(super(e),Object.defineProperty(this,"template",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"templateFormat",{enumerable:!0,configurable:!0,writable:!0,value:"f-string"}),Object.defineProperty(this,"validateTemplate",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"additionalContentFields",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),e.templateFormat==="mustache"&&e.validateTemplate===void 0&&(this.validateTemplate=!1),Object.assign(this,e),this.validateTemplate){if(this.templateFormat==="mustache")throw new Error("Mustache templates cannot be validated.");let r=this.inputVariables;this.partialVariables&&(r=r.concat(Object.keys(this.partialVariables))),K1(this.template,this.templateFormat,r)}}_getPromptType(){return"prompt"}async format(e){const r=await this.mergePartialAndUserVariables(e);return Is(this.template,this.templateFormat,r)}static fromExamples(e,r,n,i=`

`,a=""){const o=[a,...e,r].join(i);return new An({inputVariables:n,template:o})}static fromTemplate(e,r){const{templateFormat:n="f-string",...i}=r??{},a=new Set;return uk(e,n).forEach(o=>{o.type==="variable"&&a.add(o.name)}),new An({inputVariables:[...a],templateFormat:n,template:e,...i})}async partial(e){const r=this.inputVariables.filter(a=>!(a in e)),n={...this.partialVariables??{},...e},i={...this,inputVariables:r,partialVariables:n};return new An(i)}serialize(){if(this.outputParser!==void 0)throw new Error("Cannot serialize a prompt template with an output parser");return{_type:this._getPromptType(),input_variables:this.inputVariables,template:this.template,template_format:this.templateFormat}}static async deserialize(e){if(!e.template)throw new Error("Prompt template must have a template");return new An({inputVariables:e.input_variables,template:e.template,templateFormat:e.template_format})}}const vC=Object.freeze(Object.defineProperty({__proto__:null,PromptTemplate:An},Symbol.toStringTag,{value:"Module"}));class cc extends uE{static lc_name(){return"ImagePromptTemplate"}constructor(e){if(super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompts","image"]}),Object.defineProperty(this,"template",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"templateFormat",{enumerable:!0,configurable:!0,writable:!0,value:"f-string"}),Object.defineProperty(this,"validateTemplate",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"additionalContentFields",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.template=e.template,this.templateFormat=e.templateFormat??this.templateFormat,this.validateTemplate=e.validateTemplate??this.validateTemplate,this.additionalContentFields=e.additionalContentFields,this.validateTemplate){let r=this.inputVariables;this.partialVariables&&(r=r.concat(Object.keys(this.partialVariables))),K1([{type:"image_url",image_url:this.template}],this.templateFormat,r)}}_getPromptType(){return"prompt"}async partial(e){const r=this.inputVariables.filter(a=>!(a in e)),n={...this.partialVariables??{},...e},i={...this,inputVariables:r,partialVariables:n};return new cc(i)}async format(e){const r={};for(const[o,s]of Object.entries(this.template))typeof s=="string"?r[o]=Is(s,this.templateFormat,e):r[o]=s;const n=e.url||r.url,i=e.detail||r.detail;if(!n)throw new Error("Must provide either an image URL.");if(typeof n!="string")throw new Error("url must be a string.");const a={url:n};return i&&(a.detail=i),a}async formatPromptValue(e){const r=await this.format(e);return new L6(r)}}class dE extends Tt{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompts","chat"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0})}async invoke(e,r){return this._callWithConfig(n=>this.formatMessages(n),e,{...r,runType:"prompt"})}}class wC extends dE{static lc_name(){return"MessagesPlaceholder"}constructor(e){typeof e=="string"&&(e={variableName:e}),super(e),Object.defineProperty(this,"variableName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"optional",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.variableName=e.variableName,this.optional=e.optional??!1}get inputVariables(){return[this.variableName]}async formatMessages(e){const r=e[this.variableName];if(this.optional&&!r)return[];if(!r){const i=new Error(`Field "${this.variableName}" in prompt uses a MessagesPlaceholder, which expects an array of BaseMessages as an input value. Received: undefined`);throw i.name="InputFormatError",i}let n;try{Array.isArray(r)?n=r.map(ya):n=[ya(r)]}catch(i){const a=typeof r=="string"?r:JSON.stringify(r,null,2),o=new Error([`Field "${this.variableName}" in prompt uses a MessagesPlaceholder, which expects an array of BaseMessages or coerceable values as input.`,`Received value: ${a}`,`Additional message: ${i.message}`].join(`

`));throw o.name="InputFormatError",o.lc_error_code=i.lc_error_code,o}return n}}class lk extends dE{constructor(e){"prompt"in e||(e={prompt:e}),super(e),Object.defineProperty(this,"prompt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.prompt=e.prompt}get inputVariables(){return this.prompt.inputVariables}async formatMessages(e){return[await this.format(e)]}}class ck extends uE{constructor(e){super(e)}async format(e){return(await this.formatPromptValue(e)).toString()}async formatPromptValue(e){const r=await this.formatMessages(e);return new G1(r)}}class dk extends lk{static lc_name(){return"ChatMessagePromptTemplate"}constructor(e,r){"prompt"in e||(e={prompt:e,role:r}),super(e),Object.defineProperty(this,"role",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.role=e.role}async format(e){return new Co(await this.prompt.format(e),this.role)}static fromTemplate(e,r,n){return new this(An.fromTemplate(e,{templateFormat:n?.templateFormat}),r)}}class fE extends dE{static _messageClass(){throw new Error("Can not invoke _messageClass from inside _StringImageMessagePromptTemplate")}constructor(e,r){if("prompt"in e||(e={prompt:e}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompts","chat"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"inputVariables",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"additionalOptions",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"prompt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"messageClass",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"chatMessageClass",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.prompt=e.prompt,Array.isArray(this.prompt)){let n=[];this.prompt.forEach(i=>{"inputVariables"in i&&(n=n.concat(i.inputVariables))}),this.inputVariables=n}else this.inputVariables=this.prompt.inputVariables;this.additionalOptions=r??this.additionalOptions}createMessage(e){const r=this.constructor;if(r._messageClass()){const n=r._messageClass();return new n({content:e})}else if(r.chatMessageClass){const n=r.chatMessageClass();return new n({content:e,role:this.getRoleFromMessageClass(n.lc_name())})}else throw new Error("No message class defined")}getRoleFromMessageClass(e){switch(e){case"HumanMessage":return"human";case"AIMessage":return"ai";case"SystemMessage":return"system";case"ChatMessage":return"chat";default:throw new Error("Invalid message class name")}}static fromTemplate(e,r){if(typeof e=="string")return new this(An.fromTemplate(e,r));const n=[];for(const i of e)if(typeof i=="string"||typeof i=="object"&&"text"in i){let a="";typeof i=="string"?a=i:typeof i.text=="string"&&(a=i.text??"");const o={...r,...typeof i!="string"?{additionalContentFields:i}:{}};n.push(An.fromTemplate(a,o))}else if(typeof i=="object"&&"image_url"in i){let a=i.image_url??"",o,s=[];if(typeof a=="string"){let l;r?.templateFormat==="mustache"?l=xO(a):l=yy(a);const c=l.flatMap(d=>d.type==="variable"?[d.name]:[]);if((c?.length??0)>0){if(c.length>1)throw new Error(`Only one format variable allowed per image template.
Got: ${c}
From: ${a}`);s=[c[0]]}else s=[];a={url:a},o=new cc({template:a,inputVariables:s,templateFormat:r?.templateFormat,additionalContentFields:i})}else if(typeof a=="object"){if("url"in a){let l;r?.templateFormat==="mustache"?l=xO(a.url):l=yy(a.url),s=l.flatMap(c=>c.type==="variable"?[c.name]:[])}else s=[];o=new cc({template:a,inputVariables:s,templateFormat:r?.templateFormat,additionalContentFields:i})}else throw new Error("Invalid image template");n.push(o)}return new this({prompt:n,additionalOptions:r})}async format(e){if(this.prompt instanceof IO){const r=await this.prompt.format(e);return this.createMessage(r)}else{const r=[];for(const n of this.prompt){let i={};if(!("inputVariables"in n))throw new Error(`Prompt ${n} does not have inputVariables defined.`);for(const a of n.inputVariables)i||(i={[a]:e[a]}),i={...i,[a]:e[a]};if(n instanceof IO){const a=await n.format(i);let o;"additionalContentFields"in n&&(o=n.additionalContentFields),r.push({...o,type:"text",text:a})}else if(n instanceof cc){const a=await n.format(i);let o;"additionalContentFields"in n&&(o=n.additionalContentFields),r.push({...o,type:"image_url",image_url:a})}}return this.createMessage(r)}}async formatMessages(e){return[await this.format(e)]}}class J1 extends fE{static _messageClass(){return Pa}static lc_name(){return"HumanMessagePromptTemplate"}}class fk extends fE{static _messageClass(){return Nn}static lc_name(){return"AIMessagePromptTemplate"}}class hk extends fE{static _messageClass(){return mO}static lc_name(){return"SystemMessagePromptTemplate"}}function pk(t){return typeof t.formatMessages=="function"}function _k(t,e){if(pk(t)||Mu(t))return t;if(Array.isArray(t)&&t[0]==="placeholder"){const i=t[1];if(e?.templateFormat==="mustache"&&typeof i=="string"&&i.slice(0,2)==="{{"&&i.slice(-2)==="}}"){const a=i.slice(2,-2);return new wC({variableName:a,optional:!0})}else if(typeof i=="string"&&i[0]==="{"&&i[i.length-1]==="}"){const a=i.slice(1,-1);return new wC({variableName:a,optional:!0})}throw new Error(`Invalid placeholder template for format ${e?.templateFormat??'"f-string"'}: "${t[1]}". Expected a variable name surrounded by ${e?.templateFormat==="mustache"?"double":"single"} curly braces.`)}const r=ya(t);let n;if(typeof r.content=="string"?n=r.content:n=r.content.map(i=>"text"in i?{...i,text:i.text}:"image_url"in i?{...i,image_url:i.image_url}:i),r._getType()==="human")return J1.fromTemplate(n,e);if(r._getType()==="ai")return fk.fromTemplate(n,e);if(r._getType()==="system")return hk.fromTemplate(n,e);if(Co.isInstance(r))return dk.fromTemplate(r.content,r.role,e);throw new Error(`Could not coerce message prompt template from input. Received message type: "${r._getType()}".`)}function yk(t){return t.constructor.lc_name()==="MessagesPlaceholder"}class dc extends ck{static lc_name(){return"ChatPromptTemplate"}get lc_aliases(){return{promptMessages:"messages"}}constructor(e){if(super(e),Object.defineProperty(this,"promptMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"validateTemplate",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"templateFormat",{enumerable:!0,configurable:!0,writable:!0,value:"f-string"}),e.templateFormat==="mustache"&&e.validateTemplate===void 0&&(this.validateTemplate=!1),Object.assign(this,e),this.validateTemplate){const r=new Set;for(const s of this.promptMessages)if(!(s instanceof Ai))for(const l of s.inputVariables)r.add(l);const n=this.inputVariables,i=new Set(this.partialVariables?n.concat(Object.keys(this.partialVariables)):n),a=new Set([...i].filter(s=>!r.has(s)));if(a.size>0)throw new Error(`Input variables \`${[...a]}\` are not used in any of the prompt messages.`);const o=new Set([...r].filter(s=>!i.has(s)));if(o.size>0)throw new Error(`Input variables \`${[...o]}\` are used in prompt messages but not in the prompt template.`)}}_getPromptType(){return"chat"}async _parseImagePrompts(e,r){if(typeof e.content=="string")return e;const n=await Promise.all(e.content.map(async i=>{if(i.type!=="image_url")return i;let a="";typeof i.image_url=="string"?a=i.image_url:a=i.image_url.url;const s=await An.fromTemplate(a,{templateFormat:this.templateFormat}).format(r);return typeof i.image_url!="string"&&"url"in i.image_url?i.image_url.url=s:i.image_url=s,i}));return e.content=n,e}async formatMessages(e){const r=await this.mergePartialAndUserVariables(e);let n=[];for(const i of this.promptMessages)if(i instanceof Ai)n.push(await this._parseImagePrompts(i,r));else{const a=i.inputVariables.reduce((s,l)=>{if(!(l in r)&&!(yk(i)&&i.optional))throw Gy(new Error(`Missing value for input variable \`${l.toString()}\``),"INVALID_PROMPT_INPUT");return s[l]=r[l],s},{}),o=await i.formatMessages(a);n=n.concat(o)}return n}async partial(e){const r=this.inputVariables.filter(a=>!(a in e)),n={...this.partialVariables??{},...e},i={...this,inputVariables:r,partialVariables:n};return new dc(i)}static fromTemplate(e,r){const n=An.fromTemplate(e,r),i=new J1({prompt:n});return this.fromMessages([i])}static fromMessages(e,r){const n=e.reduce((o,s)=>o.concat(s instanceof dc?s.promptMessages:[_k(s,r)]),[]),i=e.reduce((o,s)=>s instanceof dc?Object.assign(o,s.partialVariables):o,Object.create(null)),a=new Set;for(const o of n)if(!(o instanceof Ai))for(const s of o.inputVariables)s in i||a.add(s);return new this({...r,inputVariables:[...a],promptMessages:n,partialVariables:i,templateFormat:r?.templateFormat})}static fromPromptMessages(e){return this.fromMessages(e)}}class li extends Tt{static lc_name(){return"RunnablePassthrough"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"func",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),e&&(this.func=e.func)}async invoke(e,r){const n=Je(r);return this.func&&await this.func(e,n),this._callWithConfig(i=>Promise.resolve(i),e,n)}async*transform(e,r){const n=Je(r);let i,a=!0;for await(const o of this._transformStreamWithConfig(e,s=>s,n))if(yield o,a)if(i===void 0)i=o;else try{i=pn(i,o)}catch{i=void 0,a=!1}this.func&&i!==void 0&&await this.func(i,n)}static assign(e){return new H1(new $u({steps:e}))}}var rd={};rd.byteLength=mk;rd.toByteArray=wk;rd.fromByteArray=Ek;var ti=[],on=[],bk=typeof Uint8Array<"u"?Uint8Array:Array,fw="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var Wo=0,gk=fw.length;Wo<gk;++Wo)ti[Wo]=fw[Wo],on[fw.charCodeAt(Wo)]=Wo;on[45]=62;on[95]=63;function X1(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=t.indexOf("=");r===-1&&(r=e);var n=r===e?0:4-r%4;return[r,n]}function mk(t){var e=X1(t),r=e[0],n=e[1];return(r+n)*3/4-n}function vk(t,e,r){return(e+r)*3/4-r}function wk(t){var e,r=X1(t),n=r[0],i=r[1],a=new bk(vk(t,n,i)),o=0,s=i>0?n-4:n,l;for(l=0;l<s;l+=4)e=on[t.charCodeAt(l)]<<18|on[t.charCodeAt(l+1)]<<12|on[t.charCodeAt(l+2)]<<6|on[t.charCodeAt(l+3)],a[o++]=e>>16&255,a[o++]=e>>8&255,a[o++]=e&255;return i===2&&(e=on[t.charCodeAt(l)]<<2|on[t.charCodeAt(l+1)]>>4,a[o++]=e&255),i===1&&(e=on[t.charCodeAt(l)]<<10|on[t.charCodeAt(l+1)]<<4|on[t.charCodeAt(l+2)]>>2,a[o++]=e>>8&255,a[o++]=e&255),a}function Ok(t){return ti[t>>18&63]+ti[t>>12&63]+ti[t>>6&63]+ti[t&63]}function Sk(t,e,r){for(var n,i=[],a=e;a<r;a+=3)n=(t[a]<<16&16711680)+(t[a+1]<<8&65280)+(t[a+2]&255),i.push(Ok(n));return i.join("")}function Ek(t){for(var e,r=t.length,n=r%3,i=[],a=16383,o=0,s=r-n;o<s;o+=a)i.push(Sk(t,o,o+a>s?s:o+a));return n===1?(e=t[r-1],i.push(ti[e>>2]+ti[e<<4&63]+"==")):n===2&&(e=(t[r-2]<<8)+t[r-1],i.push(ti[e>>10]+ti[e>>4&63]+ti[e<<2&63]+"=")),i.join("")}var Pk=Object.defineProperty,jk=(t,e,r)=>e in t?Pk(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Ck=(t,e,r)=>(jk(t,e+"",r),r);function Mk(t,e){let r=Array.from({length:t.length},(n,i)=>({start:i,end:i+1}));for(;r.length>1;){let n=null;for(let i=0;i<r.length-1;i++){const a=t.slice(r[i].start,r[i+1].end),o=e.get(a.join(","));o!=null&&(n==null||o<n[0])&&(n=[o,i])}if(n!=null){const i=n[1];r[i]={start:r[i].start,end:r[i+1].end},r.splice(i+1,1)}else break}return r}function Tk(t,e){return t.length===1?[e.get(t.join(","))]:Mk(t,e).map(r=>e.get(t.slice(r.start,r.end).join(","))).filter(r=>r!=null)}function Rk(t){return t.replace(/[\\^$*+?.()|[\]{}]/g,"\\$&")}var NO=class{specialTokens;inverseSpecialTokens;patStr;textEncoder=new TextEncoder;textDecoder=new TextDecoder("utf-8");rankMap=new Map;textMap=new Map;constructor(t,e){this.patStr=t.pat_str;const r=t.bpe_ranks.split(`
`).filter(Boolean).reduce((n,i)=>{const[a,o,...s]=i.split(" "),l=Number.parseInt(o,10);return s.forEach((c,d)=>n[c]=l+d),n},{});for(const[n,i]of Object.entries(r)){const a=rd.toByteArray(n);this.rankMap.set(a.join(","),i),this.textMap.set(i,a)}this.specialTokens={...t.special_tokens,...e},this.inverseSpecialTokens=Object.entries(this.specialTokens).reduce((n,[i,a])=>(n[a]=this.textEncoder.encode(i),n),{})}encode(t,e=[],r="all"){const n=new RegExp(this.patStr,"ug"),i=NO.specialTokenRegex(Object.keys(this.specialTokens)),a=[],o=new Set(e==="all"?Object.keys(this.specialTokens):e),s=new Set(r==="all"?Object.keys(this.specialTokens).filter(c=>!o.has(c)):r);if(s.size>0){const c=NO.specialTokenRegex([...s]),d=t.match(c);if(d!=null)throw new Error(`The text contains a special token that is not allowed: ${d[0]}`)}let l=0;for(;;){let c=null,d=l;for(;i.lastIndex=d,c=i.exec(t),!(c==null||o.has(c[0]));)d=c.index+1;const f=c?.index??t.length;for(const p of t.substring(l,f).matchAll(n)){const b=this.textEncoder.encode(p[0]),g=this.rankMap.get(b.join(","));if(g!=null){a.push(g);continue}a.push(...Tk(b,this.rankMap))}if(c==null)break;let h=this.specialTokens[c[0]];a.push(h),l=c.index+c[0].length}return a}decode(t){const e=[];let r=0;for(let a=0;a<t.length;++a){const o=t[a],s=this.textMap.get(o)??this.inverseSpecialTokens[o];s!=null&&(e.push(s),r+=s.length)}const n=new Uint8Array(r);let i=0;for(const a of e)n.set(a,i),i+=a.length;return this.textDecoder.decode(n)}},Z1=NO;Ck(Z1,"specialTokenRegex",t=>new RegExp(t.map(e=>Rk(e)).join("|"),"g"));function Ak(t){switch(t){case"gpt2":return"gpt2";case"code-cushman-001":case"code-cushman-002":case"code-davinci-001":case"code-davinci-002":case"cushman-codex":case"davinci-codex":case"davinci-002":case"text-davinci-002":case"text-davinci-003":return"p50k_base";case"code-davinci-edit-001":case"text-davinci-edit-001":return"p50k_edit";case"ada":case"babbage":case"babbage-002":case"code-search-ada-code-001":case"code-search-babbage-code-001":case"curie":case"davinci":case"text-ada-001":case"text-babbage-001":case"text-curie-001":case"text-davinci-001":case"text-search-ada-doc-001":case"text-search-babbage-doc-001":case"text-search-curie-doc-001":case"text-search-davinci-doc-001":case"text-similarity-ada-001":case"text-similarity-babbage-001":case"text-similarity-curie-001":case"text-similarity-davinci-001":return"r50k_base";case"gpt-3.5-turbo-instruct-0914":case"gpt-3.5-turbo-instruct":case"gpt-3.5-turbo-16k-0613":case"gpt-3.5-turbo-16k":case"gpt-3.5-turbo-0613":case"gpt-3.5-turbo-0301":case"gpt-3.5-turbo":case"gpt-4-32k-0613":case"gpt-4-32k-0314":case"gpt-4-32k":case"gpt-4-0613":case"gpt-4-0314":case"gpt-4":case"gpt-3.5-turbo-1106":case"gpt-35-turbo":case"gpt-4-1106-preview":case"gpt-4-vision-preview":case"gpt-3.5-turbo-0125":case"gpt-4-turbo":case"gpt-4-turbo-2024-04-09":case"gpt-4-turbo-preview":case"gpt-4-0125-preview":case"text-embedding-ada-002":case"text-embedding-3-small":case"text-embedding-3-large":return"cl100k_base";case"gpt-4o":case"gpt-4o-2024-05-13":case"gpt-4o-2024-08-06":case"gpt-4o-2024-11-20":case"gpt-4o-mini-2024-07-18":case"gpt-4o-mini":case"o1":case"o1-2024-12-17":case"o1-mini":case"o1-preview":case"o1-preview-2024-09-12":case"o1-mini-2024-09-12":case"o3-mini":case"o3-mini-2025-01-31":case"chatgpt-4o-latest":case"gpt-4o-realtime":case"gpt-4o-realtime-preview-2024-10-01":return"o200k_base";default:throw new Error("Unknown model")}}const Cp={},$k=new Qc({});async function Ik(t){return t in Cp||(Cp[t]=$k.fetch(`https://tiktoken.pages.dev/js/${t}.json`).then(e=>e.json()).then(e=>new Z1(e)).catch(e=>{throw delete Cp[t],e})),await Cp[t]}async function xk(t){return Ik(Ak(t))}class Dk extends I6{constructor(e){if(super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","document_transformers","text_splitters"]}),Object.defineProperty(this,"chunkSize",{enumerable:!0,configurable:!0,writable:!0,value:1e3}),Object.defineProperty(this,"chunkOverlap",{enumerable:!0,configurable:!0,writable:!0,value:200}),Object.defineProperty(this,"keepSeparator",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lengthFunction",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.chunkSize=e?.chunkSize??this.chunkSize,this.chunkOverlap=e?.chunkOverlap??this.chunkOverlap,this.keepSeparator=e?.keepSeparator??this.keepSeparator,this.lengthFunction=e?.lengthFunction??(r=>r.length),this.chunkOverlap>=this.chunkSize)throw new Error("Cannot have chunkOverlap >= chunkSize")}async transformDocuments(e,r={}){return this.splitDocuments(e,r)}splitOnSeparator(e,r){let n;if(r)if(this.keepSeparator){const i=r.replace(/[/\-\\^$*+?.()|[\]{}]/g,"\\$&");n=e.split(new RegExp(`(?=${i})`))}else n=e.split(r);else n=e.split("");return n.filter(i=>i!=="")}async createDocuments(e,r=[],n={}){const i=r.length>0?r:[...Array(e.length)].map(()=>({})),{chunkHeader:a="",chunkOverlapHeader:o="(cont'd) ",appendChunkOverlapHeader:s=!1}=n,l=new Array;for(let c=0;c<e.length;c+=1){const d=e[c];let f=1,h=null,p=-1;for(const b of await this.splitText(d)){let g=a;const v=d.indexOf(b,p+1);if(h===null){const N=this.numberOfNewLines(d,0,v);f+=N}else{const N=p+await this.lengthFunction(h);if(N<v){const D=this.numberOfNewLines(d,N,v);f+=D}else if(N>v){const D=this.numberOfNewLines(d,v,N);f-=D}s&&(g+=o)}const E=this.numberOfNewLines(b),C=i[c].loc&&typeof i[c].loc=="object"?{...i[c].loc}:{};C.lines={from:f,to:f+E};const S={...i[c],loc:C};g+=b,l.push(new ba({pageContent:g,metadata:S})),f+=E,h=b,p=v}}return l}numberOfNewLines(e,r,n){return(e.slice(r,n).match(/\n/g)||[]).length}async splitDocuments(e,r={}){const n=e.filter(o=>o.pageContent!==void 0),i=n.map(o=>o.pageContent),a=n.map(o=>o.metadata);return this.createDocuments(i,a,r)}joinDocs(e,r){const n=e.join(r).trim();return n===""?null:n}async mergeSplits(e,r){const n=[],i=[];let a=0;for(const s of e){const l=await this.lengthFunction(s);if(a+l+i.length*r.length>this.chunkSize&&(a>this.chunkSize&&console.warn(`Created a chunk of size ${a}, +
which is longer than the specified ${this.chunkSize}`),i.length>0)){const c=this.joinDocs(i,r);for(c!==null&&n.push(c);a>this.chunkOverlap||a+l+i.length*r.length>this.chunkSize&&a>0;)a-=await this.lengthFunction(i[0]),i.shift()}i.push(s),a+=l}const o=this.joinDocs(i,r);return o!==null&&n.push(o),n}}class by extends Dk{static lc_name(){return"RecursiveCharacterTextSplitter"}constructor(e){super(e),Object.defineProperty(this,"separators",{enumerable:!0,configurable:!0,writable:!0,value:[`

`,`
`," ",""]}),this.separators=e?.separators??this.separators,this.keepSeparator=e?.keepSeparator??!0}async _splitText(e,r){const n=[];let i=r[r.length-1],a;for(let c=0;c<r.length;c+=1){const d=r[c];if(d===""){i=d;break}if(e.includes(d)){i=d,a=r.slice(c+1);break}}const o=this.splitOnSeparator(e,i);let s=[];const l=this.keepSeparator?"":i;for(const c of o)if(await this.lengthFunction(c)<this.chunkSize)s.push(c);else{if(s.length){const d=await this.mergeSplits(s,l);n.push(...d),s=[]}if(!a)n.push(c);else{const d=await this._splitText(c,a);n.push(...d)}}if(s.length){const c=await this.mergeSplits(s,l);n.push(...c)}return n}async splitText(e){return this._splitText(e,this.separators)}static fromLanguage(e,r){return new by({...r,separators:by.getSeparatorsForLanguage(e)})}static getSeparatorsForLanguage(e){if(e==="cpp")return[`
class `,`
void `,`
int `,`
float `,`
double `,`
if `,`
for `,`
while `,`
switch `,`
case `,`

`,`
`," ",""];if(e==="go")return[`
func `,`
var `,`
const `,`
type `,`
if `,`
for `,`
switch `,`
case `,`

`,`
`," ",""];if(e==="java")return[`
class `,`
public `,`
protected `,`
private `,`
static `,`
if `,`
for `,`
while `,`
switch `,`
case `,`

`,`
`," ",""];if(e==="js")return[`
function `,`
const `,`
let `,`
var `,`
class `,`
if `,`
for `,`
while `,`
switch `,`
case `,`
default `,`

`,`
`," ",""];if(e==="php")return[`
function `,`
class `,`
if `,`
foreach `,`
while `,`
do `,`
switch `,`
case `,`

`,`
`," ",""];if(e==="proto")return[`
message `,`
service `,`
enum `,`
option `,`
import `,`
syntax `,`

`,`
`," ",""];if(e==="python")return[`
class `,`
def `,`
	def `,`

`,`
`," ",""];if(e==="rst")return[`
===
`,`
---
`,`
***
`,`
.. `,`

`,`
`," ",""];if(e==="ruby")return[`
def `,`
class `,`
if `,`
unless `,`
while `,`
for `,`
do `,`
begin `,`
rescue `,`

`,`
`," ",""];if(e==="rust")return[`
fn `,`
const `,`
let `,`
if `,`
while `,`
for `,`
loop `,`
match `,`
const `,`

`,`
`," ",""];if(e==="scala")return[`
class `,`
object `,`
def `,`
val `,`
var `,`
if `,`
for `,`
while `,`
match `,`
case `,`

`,`
`," ",""];if(e==="swift")return[`
func `,`
class `,`
struct `,`
enum `,`
if `,`
for `,`
while `,`
do `,`
switch `,`
case `,`

`,`
`," ",""];if(e==="markdown")return[`
## `,`
### `,`
#### `,`
##### `,`
###### `,"```\n\n",`

***

`,`

---

`,`

___

`,`

`,`
`," ",""];if(e==="latex")return[`
\\chapter{`,`
\\section{`,`
\\subsection{`,`
\\subsubsection{`,`
\\begin{enumerate}`,`
\\begin{itemize}`,`
\\begin{description}`,`
\\begin{list}`,`
\\begin{quote}`,`
\\begin{quotation}`,`
\\begin{verse}`,`
\\begin{verbatim}`,`
\\begin{align}`,"$$","$",`

`,`
`," ",""];if(e==="html")return["<body>","<div>","<p>","<br>","<li>","<h1>","<h2>","<h3>","<h4>","<h5>","<h6>","<span>","<table>","<tr>","<td>","<th>","<ul>","<ol>","<header>","<footer>","<nav>","<head>","<style>","<script>","<meta>","<title>"," ",""];if(e==="sol")return[`
pragma `,`
using `,`
contract `,`
interface `,`
library `,`
constructor `,`
type `,`
function `,`
event `,`
modifier `,`
error `,`
struct `,`
enum `,`
if `,`
for `,`
while `,`
do while `,`
assembly `,`

`,`
`," ",""];throw new Error(`Language ${e} is not supported.`)}}async function Nk(t,e,r){try{let n=[];if(e=="repo"){const i=t.match(/https:\/\/github\.com\/([^\/]+)\/([^\/]+)/);if(!i)throw new Error("Invalid GitHub repository URL");const a=i[1],o=i[2];n=await zk(a,o,"main",r)}else if(e=="folder"){const i=t.match(/https:\/\/github\.com\/([^\/]+)\/([^\/]+)\/tree\/([^\/]+)\/(.+)/);if(!i)throw new Error("Invalid GitHub folder URL");const a=i[1],o=i[2],s=i[3],l=i[4];n=await hE(a,o,s,l,r)}else if(e=="single"){const i=t.match(/https:\/\/github\.com\/([^\/]+)\/([^\/]+)\/blob\/([^\/]+)\/(.+)/);if(!i)throw new Error("Invalid GitHub file URL");const a=i[1],o=i[2],s=i[3],l=i[4],c=await Y1(`https://raw.githubusercontent.com/${a}/${o}/${s}/${l}`);n=[new ba({pageContent:c,metadata:{source:l}})]}return n}catch(n){return console.error("Error fetching repository contents:",n),[]}}async function hE(t,e,r,n="",i){const a=`https://api.github.com/repos/${t}/${e}/contents/${n}?ref=${r}`,o=i?{Authorization:`Bearer ${i}`}:{};try{const s=await fetch(a,{headers:o});if(!s.ok)throw new Error(`HTTP error! Status: ${s.status}`);const l=await s.json();let c=[];for(const d of l)if(d.type==="file")c.push(d);else if(d.type==="dir"){const f=await hE(t,e,r,d.path,i);c=c.concat(f)}return c}catch(s){return console.error("Error fetching repository contents:",s),[]}}async function Y1(t,e=null){const r=e?{Authorization:`Bearer ${e}`}:{};try{const n=await fetch(t,{headers:r});if(!n.ok)throw new Error(`HTTP error! Status: ${n.status}`);return await n.text()}catch(n){return console.error("Error fetching file content:",n),null}}async function zk(t,e,r,n=null){const i=await hE(t,e,r,"",n),a=[];for(const o of i)if(o.url){const s=await Y1(o.url,n);if(s){const l=JSON.parse(s),c=atob(l.content);a.push(new ba({pageContent:c,metadata:{source:o.path,url:o.html_url}}))}}return a}async function Bk(t){const e=[];for(const r of t){const n=JSON.stringify(r);e.push(new ba({pageContent:n}))}return e}const zO="RFC3986",BO={RFC1738:t=>String(t).replace(/%20/g,"+"),RFC3986:t=>String(t)},Uk="RFC1738",Fk=Array.isArray,kn=(()=>{const t=[];for(let e=0;e<256;++e)t.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return t})(),hw=1024,Lk=(t,e,r,n,i)=>{if(t.length===0)return t;let a=t;if(typeof t=="symbol"?a=Symbol.prototype.toString.call(t):typeof t!="string"&&(a=String(t)),r==="iso-8859-1")return escape(a).replace(/%u[0-9a-f]{4}/gi,function(s){return"%26%23"+parseInt(s.slice(2),16)+"%3B"});let o="";for(let s=0;s<a.length;s+=hw){const l=a.length>=hw?a.slice(s,s+hw):a,c=[];for(let d=0;d<l.length;++d){let f=l.charCodeAt(d);if(f===45||f===46||f===95||f===126||f>=48&&f<=57||f>=65&&f<=90||f>=97&&f<=122||i===Uk&&(f===40||f===41)){c[c.length]=l.charAt(d);continue}if(f<128){c[c.length]=kn[f];continue}if(f<2048){c[c.length]=kn[192|f>>6]+kn[128|f&63];continue}if(f<55296||f>=57344){c[c.length]=kn[224|f>>12]+kn[128|f>>6&63]+kn[128|f&63];continue}d+=1,f=65536+((f&1023)<<10|l.charCodeAt(d)&1023),c[c.length]=kn[240|f>>18]+kn[128|f>>12&63]+kn[128|f>>6&63]+kn[128|f&63]}o+=c.join("")}return o};function Vk(t){return!t||typeof t!="object"?!1:!!(t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer(t))}function OC(t,e){if(Fk(t)){const r=[];for(let n=0;n<t.length;n+=1)r.push(e(t[n]));return r}return e(t)}const kk=Object.prototype.hasOwnProperty,Q1={brackets(t){return String(t)+"[]"},comma:"comma",indices(t,e){return String(t)+"["+e+"]"},repeat(t){return String(t)}},Jn=Array.isArray,Hk=Array.prototype.push,eI=function(t,e){Hk.apply(t,Jn(e)?e:[e])},qk=Date.prototype.toISOString,Ft={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:Lk,encodeValuesOnly:!1,format:zO,formatter:BO[zO],indices:!1,serializeDate(t){return qk.call(t)},skipNulls:!1,strictNullHandling:!1};function Gk(t){return typeof t=="string"||typeof t=="number"||typeof t=="boolean"||typeof t=="symbol"||typeof t=="bigint"}const pw={};function tI(t,e,r,n,i,a,o,s,l,c,d,f,h,p,b,g,v,E){let C=t,S=E,N=0,D=!1;for(;(S=S.get(pw))!==void 0&&!D;){const ee=S.get(t);if(N+=1,typeof ee<"u"){if(ee===N)throw new RangeError("Cyclic object value");D=!0}typeof S.get(pw)>"u"&&(N=0)}if(typeof c=="function"?C=c(e,C):C instanceof Date?C=h?.(C):r==="comma"&&Jn(C)&&(C=OC(C,function(ee){return ee instanceof Date?h?.(ee):ee})),C===null){if(a)return l&&!g?l(e,Ft.encoder,v,"key",p):e;C=""}if(Gk(C)||Vk(C)){if(l){const ee=g?e:l(e,Ft.encoder,v,"key",p);return[b?.(ee)+"="+b?.(l(C,Ft.encoder,v,"value",p))]}return[b?.(e)+"="+b?.(String(C))]}const Z=[];if(typeof C>"u")return Z;let se;if(r==="comma"&&Jn(C))g&&l&&(C=OC(C,l)),se=[{value:C.length>0?C.join(",")||null:void 0}];else if(Jn(c))se=c;else{const ee=Object.keys(C);se=d?ee.sort(d):ee}const re=s?String(e).replace(/\./g,"%2E"):String(e),k=n&&Jn(C)&&C.length===1?re+"[]":re;if(i&&Jn(C)&&C.length===0)return k+"[]";for(let ee=0;ee<se.length;++ee){const X=se[ee],te=typeof X=="object"&&typeof X.value<"u"?X.value:C[X];if(o&&te===null)continue;const I=f&&s?X.replace(/\./g,"%2E"):X,x=Jn(C)?typeof r=="function"?r(k,I):k:k+(f?"."+I:"["+I+"]");E.set(t,N);const A=new WeakMap;A.set(pw,E),eI(Z,tI(te,x,r,n,i,a,o,s,r==="comma"&&g&&Jn(C)?null:l,c,d,f,h,p,b,g,v,A))}return Z}function Wk(t=Ft){if(typeof t.allowEmptyArrays<"u"&&typeof t.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof t.encodeDotInKeys<"u"&&typeof t.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(t.encoder!==null&&typeof t.encoder<"u"&&typeof t.encoder!="function")throw new TypeError("Encoder has to be a function.");const e=t.charset||Ft.charset;if(typeof t.charset<"u"&&t.charset!=="utf-8"&&t.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let r=zO;if(typeof t.format<"u"){if(!kk.call(BO,t.format))throw new TypeError("Unknown format option provided.");r=t.format}const n=BO[r];let i=Ft.filter;(typeof t.filter=="function"||Jn(t.filter))&&(i=t.filter);let a;if(t.arrayFormat&&t.arrayFormat in Q1?a=t.arrayFormat:"indices"in t?a=t.indices?"indices":"repeat":a=Ft.arrayFormat,"commaRoundTrip"in t&&typeof t.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");const o=typeof t.allowDots>"u"?t.encodeDotInKeys?!0:Ft.allowDots:!!t.allowDots;return{addQueryPrefix:typeof t.addQueryPrefix=="boolean"?t.addQueryPrefix:Ft.addQueryPrefix,allowDots:o,allowEmptyArrays:typeof t.allowEmptyArrays=="boolean"?!!t.allowEmptyArrays:Ft.allowEmptyArrays,arrayFormat:a,charset:e,charsetSentinel:typeof t.charsetSentinel=="boolean"?t.charsetSentinel:Ft.charsetSentinel,commaRoundTrip:!!t.commaRoundTrip,delimiter:typeof t.delimiter>"u"?Ft.delimiter:t.delimiter,encode:typeof t.encode=="boolean"?t.encode:Ft.encode,encodeDotInKeys:typeof t.encodeDotInKeys=="boolean"?t.encodeDotInKeys:Ft.encodeDotInKeys,encoder:typeof t.encoder=="function"?t.encoder:Ft.encoder,encodeValuesOnly:typeof t.encodeValuesOnly=="boolean"?t.encodeValuesOnly:Ft.encodeValuesOnly,filter:i,format:r,formatter:n,serializeDate:typeof t.serializeDate=="function"?t.serializeDate:Ft.serializeDate,skipNulls:typeof t.skipNulls=="boolean"?t.skipNulls:Ft.skipNulls,sort:typeof t.sort=="function"?t.sort:null,strictNullHandling:typeof t.strictNullHandling=="boolean"?t.strictNullHandling:Ft.strictNullHandling}}function Kk(t,e={}){let r=t;const n=Wk(e);let i,a;typeof n.filter=="function"?(a=n.filter,r=a("",r)):Jn(n.filter)&&(a=n.filter,i=a);const o=[];if(typeof r!="object"||r===null)return"";const s=Q1[n.arrayFormat],l=s==="comma"&&n.commaRoundTrip;i||(i=Object.keys(r)),n.sort&&i.sort(n.sort);const c=new WeakMap;for(let h=0;h<i.length;++h){const p=i[h];n.skipNulls&&r[p]===null||eI(o,tI(r[p],p,s,l,n.allowEmptyArrays,n.strictNullHandling,n.skipNulls,n.encodeDotInKeys,n.encode?n.encoder:null,n.filter,n.sort,n.allowDots,n.serializeDate,n.format,n.formatter,n.encodeValuesOnly,n.charset,c))}const d=o.join(n.delimiter);let f=n.addQueryPrefix===!0?"?":"";return n.charsetSentinel&&(n.charset==="iso-8859-1"?f+="utf8=%26%2310003%3B&":f+="utf8=%E2%9C%93&"),d.length>0?f+d:""}const Es="4.87.3";let SC=!1,fc,rI,nI,UO,iI,aI,oI,sI,uI;function Jk(t,e={auto:!1}){if(SC)throw new Error(`you must \`import 'openai/shims/${t.kind}'\` before importing anything else from openai`);if(fc)throw new Error(`can't \`import 'openai/shims/${t.kind}'\` after \`import 'openai/shims/${fc}'\``);SC=e.auto,fc=t.kind,rI=t.fetch,nI=t.FormData,UO=t.File,iI=t.ReadableStream,aI=t.getMultipartRequestOptions,oI=t.getDefaultAgent,sI=t.fileFromPath,uI=t.isFsReadStream}let Xk=class{constructor(e){this.body=e}get[Symbol.toStringTag](){return"MultipartBody"}};function Zk({manuallyImported:t}={}){const e=t?"You may need to use polyfills":"Add one of these imports before your first `import  from 'openai'`:\n- `import 'openai/shims/node'` (if you're running on Node)\n- `import 'openai/shims/web'` (otherwise)\n";let r,n,i,a;try{r=fetch,n=Request,i=Response,a=Headers}catch(o){throw new Error(`this environment is missing the following Web Fetch API type: ${o.message}. ${e}`)}return{kind:"web",fetch:r,Request:n,Response:i,Headers:a,FormData:typeof FormData<"u"?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${e}`)}},Blob:typeof Blob<"u"?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${e}`)}},File:typeof File<"u"?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${e}`)}},ReadableStream:typeof ReadableStream<"u"?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${e}`)}},getMultipartRequestOptions:async(o,s)=>({...s,body:new Xk(o)}),getDefaultAgent:o=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/openai/openai-node#file-uploads")},isFsReadStream:o=>!1}}fc||Jk(Zk(),{auto:!0});class ve extends Error{}let Ar=class FO extends ve{constructor(e,r,n,i){super(`${FO.makeMessage(e,r,n)}`),this.status=e,this.headers=i,this.request_id=i?.["x-request-id"],this.error=r;const a=r;this.code=a?.code,this.param=a?.param,this.type=a?.type}static makeMessage(e,r,n){const i=r?.message?typeof r.message=="string"?r.message:JSON.stringify(r.message):r?JSON.stringify(r):n;return e&&i?`${e} ${i}`:e?`${e} status code (no body)`:i||"(no status code or body)"}static generate(e,r,n,i){if(!e||!i)return new nb({message:n,cause:VO(r)});const a=r?.error;return e===400?new lI(e,a,n,i):e===401?new cI(e,a,n,i):e===403?new dI(e,a,n,i):e===404?new fI(e,a,n,i):e===409?new hI(e,a,n,i):e===422?new pI(e,a,n,i):e===429?new _I(e,a,n,i):e>=500?new yI(e,a,n,i):new FO(e,a,n,i)}},Wr=class extends Ar{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}},nb=class extends Ar{constructor({message:e,cause:r}){super(void 0,void 0,e||"Connection error.",void 0),r&&(this.cause=r)}},ib=class extends nb{constructor({message:e}={}){super({message:e??"Request timed out."})}},lI=class extends Ar{},cI=class extends Ar{},dI=class extends Ar{},fI=class extends Ar{},hI=class extends Ar{},pI=class extends Ar{},_I=class extends Ar{},yI=class extends Ar{};class bI extends ve{constructor(){super("Could not parse response content as the length limit was reached")}}class gI extends ve{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}var Mp=function(t,e,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(t,r):i?i.value=r:e.set(t,r),r},Ha=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},Vr;let ab=class{constructor(){Vr.set(this,void 0),this.buffer=new Uint8Array,Mp(this,Vr,null,"f")}decode(e){if(e==null)return[];const r=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?new TextEncoder().encode(e):e;let n=new Uint8Array(this.buffer.length+r.length);n.set(this.buffer),n.set(r,this.buffer.length),this.buffer=n;const i=[];let a;for(;(a=Yk(this.buffer,Ha(this,Vr,"f")))!=null;){if(a.carriage&&Ha(this,Vr,"f")==null){Mp(this,Vr,a.index,"f");continue}if(Ha(this,Vr,"f")!=null&&(a.index!==Ha(this,Vr,"f")+1||a.carriage)){i.push(this.decodeText(this.buffer.slice(0,Ha(this,Vr,"f")-1))),this.buffer=this.buffer.slice(Ha(this,Vr,"f")),Mp(this,Vr,null,"f");continue}const o=Ha(this,Vr,"f")!==null?a.preceding-1:a.preceding,s=this.decodeText(this.buffer.slice(0,o));i.push(s),this.buffer=this.buffer.slice(a.index),Mp(this,Vr,null,"f")}return i}decodeText(e){if(e==null)return"";if(typeof e=="string")return e;if(typeof Buffer<"u"){if(e instanceof Buffer)return e.toString();if(e instanceof Uint8Array)return Buffer.from(e).toString();throw new ve(`Unexpected: received non-Uint8Array (${e.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if(typeof TextDecoder<"u"){if(e instanceof Uint8Array||e instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(e);throw new ve(`Unexpected: received non-Uint8Array/ArrayBuffer (${e.constructor.name}) in a web platform. Please report this error.`)}throw new ve("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){return this.buffer.length?this.decode(`
`):[]}};Vr=new WeakMap;ab.NEWLINE_CHARS=new Set([`
`,"\r"]);ab.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function Yk(t,e){for(let i=e??0;i<t.length;i++){if(t[i]===10)return{preceding:i,index:i+1,carriage:!1};if(t[i]===13)return{preceding:i,index:i+1,carriage:!0}}return null}function Qk(t){for(let n=0;n<t.length-1;n++){if(t[n]===10&&t[n+1]===10||t[n]===13&&t[n+1]===13)return n+2;if(t[n]===13&&t[n+1]===10&&n+3<t.length&&t[n+2]===13&&t[n+3]===10)return n+4}return-1}function mI(t){if(t[Symbol.asyncIterator])return t;const e=t.getReader();return{async next(){try{const r=await e.read();return r?.done&&e.releaseLock(),r}catch(r){throw e.releaseLock(),r}},async return(){const r=e.cancel();return e.releaseLock(),await r,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}let zc=class Zl{constructor(e,r){this.iterator=e,this.controller=r}static fromSSEResponse(e,r){let n=!1;async function*i(){if(n)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");n=!0;let a=!1;try{for await(const o of e2(e,r))if(!a){if(o.data.startsWith("[DONE]")){a=!0;continue}if(o.event===null||o.event.startsWith("response.")){let s;try{s=JSON.parse(o.data)}catch(l){throw console.error("Could not parse message into JSON:",o.data),console.error("From chunk:",o.raw),l}if(s&&s.error)throw new Ar(void 0,s.error,void 0,void 0);yield s}else{let s;try{s=JSON.parse(o.data)}catch(l){throw console.error("Could not parse message into JSON:",o.data),console.error("From chunk:",o.raw),l}if(o.event=="error")throw new Ar(void 0,s.error,s.message,void 0);yield{event:o.event,data:s}}}a=!0}catch(o){if(o instanceof Error&&o.name==="AbortError")return;throw o}finally{a||r.abort()}}return new Zl(i,r)}static fromReadableStream(e,r){let n=!1;async function*i(){const o=new ab,s=mI(e);for await(const l of s)for(const c of o.decode(l))yield c;for(const l of o.flush())yield l}async function*a(){if(n)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");n=!0;let o=!1;try{for await(const s of i())o||s&&(yield JSON.parse(s));o=!0}catch(s){if(s instanceof Error&&s.name==="AbortError")return;throw s}finally{o||r.abort()}}return new Zl(a,r)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],r=[],n=this.iterator(),i=a=>({next:()=>{if(a.length===0){const o=n.next();e.push(o),r.push(o)}return a.shift()}});return[new Zl(()=>i(e),this.controller),new Zl(()=>i(r),this.controller)]}toReadableStream(){const e=this;let r;const n=new TextEncoder;return new iI({async start(){r=e[Symbol.asyncIterator]()},async pull(i){try{const{value:a,done:o}=await r.next();if(o)return i.close();const s=n.encode(JSON.stringify(a)+`
`);i.enqueue(s)}catch(a){i.error(a)}},async cancel(){await r.return?.()}})}};async function*e2(t,e){if(!t.body)throw e.abort(),new ve("Attempted to iterate over a response with no body");const r=new r2,n=new ab,i=mI(t.body);for await(const a of t2(i))for(const o of n.decode(a)){const s=r.decode(o);s&&(yield s)}for(const a of n.flush()){const o=r.decode(a);o&&(yield o)}}async function*t2(t){let e=new Uint8Array;for await(const r of t){if(r==null)continue;const n=r instanceof ArrayBuffer?new Uint8Array(r):typeof r=="string"?new TextEncoder().encode(r):r;let i=new Uint8Array(e.length+n.length);i.set(e),i.set(n,e.length),e=i;let a;for(;(a=Qk(e))!==-1;)yield e.slice(0,a),e=e.slice(a)}e.length>0&&(yield e)}let r2=class{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const a={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],a}if(this.chunks.push(e),e.startsWith(":"))return null;let[r,n,i]=n2(e,":");return i.startsWith(" ")&&(i=i.substring(1)),r==="event"?this.event=i:r==="data"&&this.data.push(i),null}};function n2(t,e){const r=t.indexOf(e);return r!==-1?[t.substring(0,r),e,t.substring(r+e.length)]:[t,"",""]}const vI=t=>t!=null&&typeof t=="object"&&typeof t.url=="string"&&typeof t.blob=="function",wI=t=>t!=null&&typeof t=="object"&&typeof t.name=="string"&&typeof t.lastModified=="number"&&ob(t),ob=t=>t!=null&&typeof t=="object"&&typeof t.size=="number"&&typeof t.type=="string"&&typeof t.text=="function"&&typeof t.slice=="function"&&typeof t.arrayBuffer=="function",i2=t=>wI(t)||vI(t)||uI(t);async function OI(t,e,r){if(t=await t,wI(t))return t;if(vI(t)){const i=await t.blob();e||(e=new URL(t.url).pathname.split(/[\\/]/).pop()??"unknown_file");const a=ob(i)?[await i.arrayBuffer()]:[i];return new UO(a,e,r)}const n=await a2(t);if(e||(e=s2(t)??"unknown_file"),!r?.type){const i=n[0]?.type;typeof i=="string"&&(r={...r,type:i})}return new UO(n,e,r)}async function a2(t){let e=[];if(typeof t=="string"||ArrayBuffer.isView(t)||t instanceof ArrayBuffer)e.push(t);else if(ob(t))e.push(await t.arrayBuffer());else if(u2(t))for await(const r of t)e.push(r);else throw new Error(`Unexpected data type: ${typeof t}; constructor: ${t?.constructor?.name}; props: ${o2(t)}`);return e}function o2(t){return`[${Object.getOwnPropertyNames(t).map(r=>`"${r}"`).join(", ")}]`}function s2(t){return _w(t.name)||_w(t.filename)||_w(t.path)?.split(/[\\/]/).pop()}const _w=t=>{if(typeof t=="string")return t;if(typeof Buffer<"u"&&t instanceof Buffer)return String(t)},u2=t=>t!=null&&typeof t=="object"&&typeof t[Symbol.asyncIterator]=="function",EC=t=>t&&typeof t=="object"&&t.body&&t[Symbol.toStringTag]==="MultipartBody",_u=async t=>{const e=await l2(t.body);return aI(e,t)},l2=async t=>{const e=new nI;return await Promise.all(Object.entries(t||{}).map(([r,n])=>LO(e,r,n))),e},LO=async(t,e,r)=>{if(r!==void 0){if(r==null)throw new TypeError(`Received null for "${e}"; to pass null in FormData, you must use the string 'null'`);if(typeof r=="string"||typeof r=="number"||typeof r=="boolean")t.append(e,String(r));else if(i2(r)){const n=await OI(r);t.append(e,n)}else if(Array.isArray(r))await Promise.all(r.map(n=>LO(t,e+"[]",n)));else if(typeof r=="object")await Promise.all(Object.entries(r).map(([n,i])=>LO(t,`${e}[${n}]`,i)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${r} instead`)}};var SI={},c2=function(t,e,r,n,i){if(typeof e=="function"?t!==e||!0:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(t,r),r},d2=function(t,e,r,n){if(typeof e=="function"?t!==e||!0:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},Tp;async function EI(t){const{response:e}=t;if(t.options.stream)return Ls("response",e.status,e.url,e.headers,e.body),t.options.__streamClass?t.options.__streamClass.fromSSEResponse(e,t.controller):zc.fromSSEResponse(e,t.controller);if(e.status===204)return null;if(t.options.__binaryResponse)return e;const n=e.headers.get("content-type")?.split(";")[0]?.trim();if(n?.includes("application/json")||n?.endsWith("+json")){const o=await e.json();return Ls("response",e.status,e.url,e.headers,o),PI(o,e)}const a=await e.text();return Ls("response",e.status,e.url,e.headers,a),a}function PI(t,e){return!t||typeof t!="object"||Array.isArray(t)?t:Object.defineProperty(t,"_request_id",{value:e.headers.get("x-request-id"),enumerable:!1})}let jI=class CI extends Promise{constructor(e,r=EI){super(n=>{n(null)}),this.responsePromise=e,this.parseResponse=r}_thenUnwrap(e){return new CI(this.responsePromise,async r=>PI(e(await this.parseResponse(r),r),r.response))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,r]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:r,request_id:r.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(e,r){return this.parse().then(e,r)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}},f2=class{constructor({baseURL:e,maxRetries:r=2,timeout:n=6e5,httpAgent:i,fetch:a}){this.baseURL=e,this.maxRetries=yw("maxRetries",r),this.timeout=yw("timeout",n),this.httpAgent=i,this.fetch=a??rI}authHeaders(e){return{}}defaultHeaders(e){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...g2(),...this.authHeaders(e)}}validateHeaders(e,r){}defaultIdempotencyKey(){return`stainless-node-retry-${O2()}`}get(e,r){return this.methodRequest("get",e,r)}post(e,r){return this.methodRequest("post",e,r)}patch(e,r){return this.methodRequest("patch",e,r)}put(e,r){return this.methodRequest("put",e,r)}delete(e,r){return this.methodRequest("delete",e,r)}methodRequest(e,r,n){return this.request(Promise.resolve(n).then(async i=>{const a=i&&ob(i?.body)?new DataView(await i.body.arrayBuffer()):i?.body instanceof DataView?i.body:i?.body instanceof ArrayBuffer?new DataView(i.body):i&&ArrayBuffer.isView(i?.body)?new DataView(i.body.buffer):i?.body;return{method:e,path:r,...i,body:a}}))}getAPIList(e,r,n){return this.requestAPIList(r,{method:"get",path:e,...n})}calculateContentLength(e){if(typeof e=="string"){if(typeof Buffer<"u")return Buffer.byteLength(e,"utf8").toString();if(typeof TextEncoder<"u")return new TextEncoder().encode(e).length.toString()}else if(ArrayBuffer.isView(e))return e.byteLength.toString();return null}buildRequest(e,{retryCount:r=0}={}){e={...e};const{method:n,path:i,query:a,headers:o={}}=e,s=ArrayBuffer.isView(e.body)||e.__binaryRequest&&typeof e.body=="string"?e.body:EC(e.body)?e.body.body:e.body?JSON.stringify(e.body,null,2):null,l=this.calculateContentLength(s),c=this.buildURL(i,a);"timeout"in e&&yw("timeout",e.timeout),e.timeout=e.timeout??this.timeout;const d=e.httpAgent??this.httpAgent??oI(c),f=e.timeout+1e3;typeof d?.options?.timeout=="number"&&f>(d.options.timeout??0)&&(d.options.timeout=f),this.idempotencyHeader&&n!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),o[this.idempotencyHeader]=e.idempotencyKey);const h=this.buildHeaders({options:e,headers:o,contentLength:l,retryCount:r});return{req:{method:n,...s&&{body:s},headers:h,...d&&{agent:d},signal:e.signal??null},url:c,timeout:e.timeout}}buildHeaders({options:e,headers:r,contentLength:n,retryCount:i}){const a={};n&&(a["content-length"]=n);const o=this.defaultHeaders(e);return MC(a,o),MC(a,r),EC(e.body)&&fc!=="node"&&delete a["content-type"],Rp(o,"x-stainless-retry-count")===void 0&&Rp(r,"x-stainless-retry-count")===void 0&&(a["x-stainless-retry-count"]=String(i)),Rp(o,"x-stainless-timeout")===void 0&&Rp(r,"x-stainless-timeout")===void 0&&e.timeout&&(a["x-stainless-timeout"]=String(e.timeout)),this.validateHeaders(a,r),a}async prepareOptions(e){}async prepareRequest(e,{url:r,options:n}){}parseHeaders(e){return e?Symbol.iterator in e?Object.fromEntries(Array.from(e).map(r=>[...r])):{...e}:{}}makeStatusError(e,r,n,i){return Ar.generate(e,r,n,i)}request(e,r=null){return new jI(this.makeRequest(e,r))}async makeRequest(e,r){const n=await e,i=n.maxRetries??this.maxRetries;r==null&&(r=i),await this.prepareOptions(n);const{req:a,url:o,timeout:s}=this.buildRequest(n,{retryCount:i-r});if(await this.prepareRequest(a,{url:o,options:n}),Ls("request",o,n,a.headers),n.signal?.aborted)throw new Wr;const l=new AbortController,c=await this.fetchWithTimeout(o,a,s,l).catch(VO);if(c instanceof Error){if(n.signal?.aborted)throw new Wr;if(r)return this.retryRequest(n,r);throw c.name==="AbortError"?new ib:new nb({cause:c})}const d=p2(c.headers);if(!c.ok){if(r&&this.shouldRetry(c)){const v=`retrying, ${r} attempts remaining`;return Ls(`response (error; ${v})`,c.status,o,d),this.retryRequest(n,r,d)}const f=await c.text().catch(v=>VO(v).message),h=m2(f),p=h?void 0:f;throw Ls(`response (error; ${r?"(error; no more retries left)":"(error; not retryable)"})`,c.status,o,d,p),this.makeStatusError(c.status,h,p,d)}return{response:c,options:n,controller:l}}requestAPIList(e,r){const n=this.makeRequest(r,null);return new h2(this,n,e)}buildURL(e,r){const n=w2(e)?new URL(e):new URL(this.baseURL+(this.baseURL.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),i=this.defaultQuery();return TI(i)||(r={...i,...r}),typeof r=="object"&&r&&!Array.isArray(r)&&(n.search=this.stringifyQuery(r)),n.toString()}stringifyQuery(e){return Object.entries(e).filter(([r,n])=>typeof n<"u").map(([r,n])=>{if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")return`${encodeURIComponent(r)}=${encodeURIComponent(n)}`;if(n===null)return`${encodeURIComponent(r)}=`;throw new ve(`Cannot stringify type ${typeof n}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}async fetchWithTimeout(e,r,n,i){const{signal:a,...o}=r||{};a&&a.addEventListener("abort",()=>i.abort());const s=setTimeout(()=>i.abort(),n),l={signal:i.signal,...o};return l.method&&(l.method=l.method.toUpperCase()),this.fetch.call(void 0,e,l).finally(()=>{clearTimeout(s)})}shouldRetry(e){const r=e.headers.get("x-should-retry");return r==="true"?!0:r==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,r,n){let i;const a=n?.["retry-after-ms"];if(a){const s=parseFloat(a);Number.isNaN(s)||(i=s)}const o=n?.["retry-after"];if(o&&!i){const s=parseFloat(o);Number.isNaN(s)?i=Date.parse(o)-Date.now():i=s*1e3}if(!(i&&0<=i&&i<60*1e3)){const s=e.maxRetries??this.maxRetries;i=this.calculateDefaultRetryTimeoutMillis(r,s)}return await nd(i),this.makeRequest(e,r-1)}calculateDefaultRetryTimeoutMillis(e,r){const a=r-e,o=Math.min(.5*Math.pow(2,a),8),s=1-Math.random()*.25;return o*s*1e3}getUserAgent(){return`${this.constructor.name}/JS ${Es}`}},MI=class{constructor(e,r,n,i){Tp.set(this,void 0),c2(this,Tp,e),this.options=i,this.response=r,this.body=n}hasNextPage(){return this.getPaginatedItems().length?this.nextPageInfo()!=null:!1}async getNextPage(){const e=this.nextPageInfo();if(!e)throw new ve("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");const r={...this.options};if("params"in e&&typeof r.query=="object")r.query={...r.query,...e.params};else if("url"in e){const n=[...Object.entries(r.query||{}),...e.url.searchParams.entries()];for(const[i,a]of n)e.url.searchParams.set(i,a);r.query=void 0,r.path=e.url.toString()}return await d2(this,Tp,"f").requestAPIList(this.constructor,r)}async*iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async*[(Tp=new WeakMap,Symbol.asyncIterator)](){for await(const e of this.iterPages())for(const r of e.getPaginatedItems())yield r}},h2=class extends jI{constructor(e,r,n){super(r,async i=>new n(e,i.response,await EI(i),i.options))}async*[Symbol.asyncIterator](){const e=await this;for await(const r of e)yield r}};const p2=t=>new Proxy(Object.fromEntries(t.entries()),{get(e,r){const n=r.toString();return e[n.toLowerCase()]||e[n]}}),_2={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0,__metadata:!0,__binaryRequest:!0,__binaryResponse:!0,__streamClass:!0},Kt=t=>typeof t=="object"&&t!==null&&!TI(t)&&Object.keys(t).every(e=>RI(_2,e)),y2=()=>{if(typeof Deno<"u"&&Deno.build!=null)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Es,"X-Stainless-OS":jC(Deno.build.os),"X-Stainless-Arch":PC(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:Deno.version?.deno??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Es,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":process.version};if(Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Es,"X-Stainless-OS":jC(process.platform),"X-Stainless-Arch":PC(process.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":process.version};const t=b2();return t?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Es,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${t.browser}`,"X-Stainless-Runtime-Version":t.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Es,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function b2(){if(typeof navigator>"u"||!navigator)return null;const t=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:r}of t){const n=r.exec(navigator.userAgent);if(n){const i=n[1]||0,a=n[2]||0,o=n[3]||0;return{browser:e,version:`${i}.${a}.${o}`}}}return null}const PC=t=>t==="x32"?"x32":t==="x86_64"||t==="x64"?"x64":t==="arm"?"arm":t==="aarch64"||t==="arm64"?"arm64":t?`other:${t}`:"unknown",jC=t=>(t=t.toLowerCase(),t.includes("ios")?"iOS":t==="android"?"Android":t==="darwin"?"MacOS":t==="win32"?"Windows":t==="freebsd"?"FreeBSD":t==="openbsd"?"OpenBSD":t==="linux"?"Linux":t?`Other:${t}`:"Unknown");let CC;const g2=()=>CC??(CC=y2()),m2=t=>{try{return JSON.parse(t)}catch{return}},v2=/^[a-z][a-z0-9+.-]*:/i,w2=t=>v2.test(t),nd=t=>new Promise(e=>setTimeout(e,t)),yw=(t,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new ve(`${t} must be an integer`);if(e<0)throw new ve(`${t} must be a positive integer`);return e},VO=t=>{if(t instanceof Error)return t;if(typeof t=="object"&&t!==null)try{return new Error(JSON.stringify(t))}catch{}return new Error(t)},uo=t=>{if(typeof process<"u")return SI?.[t]?.trim()??void 0;if(typeof Deno<"u")return Deno.env?.get?.(t)?.trim()};function TI(t){if(!t)return!0;for(const e in t)return!1;return!0}function RI(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function MC(t,e){for(const r in e){if(!RI(e,r))continue;const n=r.toLowerCase();if(!n)continue;const i=e[r];i===null?delete t[n]:i!==void 0&&(t[n]=i)}}const TC=new Set(["authorization","api-key"]);function Ls(t,...e){if(typeof process<"u"&&SI?.DEBUG==="true"){const r=e.map(n=>{if(!n)return n;if(n.headers){const a={...n,headers:{...n.headers}};for(const o in n.headers)TC.has(o.toLowerCase())&&(a.headers[o]="REDACTED");return a}let i=null;for(const a in n)TC.has(a.toLowerCase())&&(i??(i={...n}),i[a]="REDACTED");return i??n});console.log(`OpenAI:DEBUG:${t}`,...r)}}const O2=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{const e=Math.random()*16|0;return(t==="x"?e:e&3|8).toString(16)}),S2=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u",E2=t=>typeof t?.get=="function",Rp=(t,e)=>{const r=e.toLowerCase();if(E2(t)){const n=e[0]?.toUpperCase()+e.substring(1).replace(/([^\w])(\w)/g,(i,a,o)=>a+o.toUpperCase());for(const i of[e,r,e.toUpperCase(),n]){const a=t.get(i);if(a)return a}}for(const[n,i]of Object.entries(t))if(n.toLowerCase()===r)return Array.isArray(i)?(i.length<=1||console.warn(`Received ${i.length} entries for the ${e} header, using the first entry.`),i[0]):i};function N_(t){return t!=null&&typeof t=="object"&&!Array.isArray(t)}let pE=class extends MI{constructor(e,r,n,i){super(e,r,n,i),this.data=n.data||[],this.object=n.object}getPaginatedItems(){return this.data??[]}nextPageParams(){return null}nextPageInfo(){return null}};class $r extends MI{constructor(e,r,n,i){super(e,r,n,i),this.data=n.data||[],this.has_more=n.has_more||!1}getPaginatedItems(){return this.data??[]}hasNextPage(){return this.has_more===!1?!1:super.hasNextPage()}nextPageParams(){const e=this.nextPageInfo();if(!e)return null;if("params"in e)return e.params;const r=Object.fromEntries(e.url.searchParams);return Object.keys(r).length?r:null}nextPageInfo(){const e=this.getPaginatedItems();if(!e.length)return null;const r=e[e.length-1]?.id;return r?{params:{after:r}}:null}}let We=class{constructor(e){this._client=e}},AI=class extends We{list(e,r={},n){return Kt(r)?this.list(e,{},r):this._client.getAPIList(`/chat/completions/${e}/messages`,P2,{query:r,...n})}},sb=class extends We{constructor(){super(...arguments),this.messages=new AI(this._client)}create(e,r){return this._client.post("/chat/completions",{body:e,...r,stream:e.stream??!1})}retrieve(e,r){return this._client.get(`/chat/completions/${e}`,r)}update(e,r,n){return this._client.post(`/chat/completions/${e}`,{body:r,...n})}list(e={},r){return Kt(e)?this.list({},e):this._client.getAPIList("/chat/completions",ub,{query:e,...r})}del(e,r){return this._client.delete(`/chat/completions/${e}`,r)}};class ub extends $r{}class P2 extends $r{}sb.ChatCompletionsPage=ub;sb.Messages=AI;let lb=class extends We{constructor(){super(...arguments),this.completions=new sb(this._client)}};lb.Completions=sb;lb.ChatCompletionsPage=ub;class $I extends We{create(e,r){return this._client.post("/audio/speech",{body:e,...r,headers:{Accept:"application/octet-stream",...r?.headers},__binaryResponse:!0})}}let II=class extends We{create(e,r){return this._client.post("/audio/transcriptions",_u({body:e,...r,__metadata:{model:e.model}}))}},xI=class extends We{create(e,r){return this._client.post("/audio/translations",_u({body:e,...r,__metadata:{model:e.model}}))}},id=class extends We{constructor(){super(...arguments),this.transcriptions=new II(this._client),this.translations=new xI(this._client),this.speech=new $I(this._client)}};id.Transcriptions=II;id.Translations=xI;id.Speech=$I;let _E=class extends We{create(e,r){return this._client.post("/batches",{body:e,...r})}retrieve(e,r){return this._client.get(`/batches/${e}`,r)}list(e={},r){return Kt(e)?this.list({},e):this._client.getAPIList("/batches",yE,{query:e,...r})}cancel(e,r){return this._client.post(`/batches/${e}/cancel`,r)}};class yE extends $r{}_E.BatchesPage=yE;class bE extends We{create(e,r){return this._client.post("/assistants",{body:e,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}retrieve(e,r){return this._client.get(`/assistants/${e}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}update(e,r,n){return this._client.post(`/assistants/${e}`,{body:r,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}list(e={},r){return Kt(e)?this.list({},e):this._client.getAPIList("/assistants",gE,{query:e,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}del(e,r){return this._client.delete(`/assistants/${e}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}}class gE extends $r{}bE.AssistantsPage=gE;function RC(t){return typeof t.parse=="function"}const Vs=t=>t?.role==="assistant",DI=t=>t?.role==="function",NI=t=>t?.role==="tool";var Mn=function(t,e,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(t,r):i?i.value=r:e.set(t,r),r},jt=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},kO,z_,B_,Yl,Ql,U_,ec,ji,tc,gy,my,Ps,zI;class mE{constructor(){kO.add(this),this.controller=new AbortController,z_.set(this,void 0),B_.set(this,()=>{}),Yl.set(this,()=>{}),Ql.set(this,void 0),U_.set(this,()=>{}),ec.set(this,()=>{}),ji.set(this,{}),tc.set(this,!1),gy.set(this,!1),my.set(this,!1),Ps.set(this,!1),Mn(this,z_,new Promise((e,r)=>{Mn(this,B_,e,"f"),Mn(this,Yl,r,"f")}),"f"),Mn(this,Ql,new Promise((e,r)=>{Mn(this,U_,e,"f"),Mn(this,ec,r,"f")}),"f"),jt(this,z_,"f").catch(()=>{}),jt(this,Ql,"f").catch(()=>{})}_run(e){setTimeout(()=>{e().then(()=>{this._emitFinal(),this._emit("end")},jt(this,kO,"m",zI).bind(this))},0)}_connected(){this.ended||(jt(this,B_,"f").call(this),this._emit("connect"))}get ended(){return jt(this,tc,"f")}get errored(){return jt(this,gy,"f")}get aborted(){return jt(this,my,"f")}abort(){this.controller.abort()}on(e,r){return(jt(this,ji,"f")[e]||(jt(this,ji,"f")[e]=[])).push({listener:r}),this}off(e,r){const n=jt(this,ji,"f")[e];if(!n)return this;const i=n.findIndex(a=>a.listener===r);return i>=0&&n.splice(i,1),this}once(e,r){return(jt(this,ji,"f")[e]||(jt(this,ji,"f")[e]=[])).push({listener:r,once:!0}),this}emitted(e){return new Promise((r,n)=>{Mn(this,Ps,!0,"f"),e!=="error"&&this.once("error",n),this.once(e,r)})}async done(){Mn(this,Ps,!0,"f"),await jt(this,Ql,"f")}_emit(e,...r){if(jt(this,tc,"f"))return;e==="end"&&(Mn(this,tc,!0,"f"),jt(this,U_,"f").call(this));const n=jt(this,ji,"f")[e];if(n&&(jt(this,ji,"f")[e]=n.filter(i=>!i.once),n.forEach(({listener:i})=>i(...r))),e==="abort"){const i=r[0];!jt(this,Ps,"f")&&!n?.length&&Promise.reject(i),jt(this,Yl,"f").call(this,i),jt(this,ec,"f").call(this,i),this._emit("end");return}if(e==="error"){const i=r[0];!jt(this,Ps,"f")&&!n?.length&&Promise.reject(i),jt(this,Yl,"f").call(this,i),jt(this,ec,"f").call(this,i),this._emit("end")}}_emitFinal(){}}z_=new WeakMap,B_=new WeakMap,Yl=new WeakMap,Ql=new WeakMap,U_=new WeakMap,ec=new WeakMap,ji=new WeakMap,tc=new WeakMap,gy=new WeakMap,my=new WeakMap,Ps=new WeakMap,kO=new WeakSet,zI=function(e){if(Mn(this,gy,!0,"f"),e instanceof Error&&e.name==="AbortError"&&(e=new Wr),e instanceof Wr)return Mn(this,my,!0,"f"),this._emit("abort",e);if(e instanceof ve)return this._emit("error",e);if(e instanceof Error){const r=new ve(e.message);return r.cause=e,this._emit("error",r)}return this._emit("error",new ve(String(e)))};function j2(t,e){const r={...t};return Object.defineProperties(r,{$brand:{value:"auto-parseable-response-format",enumerable:!1},$parseRaw:{value:e,enumerable:!1}}),r}function vE(t){return t?.$brand==="auto-parseable-response-format"}function C2(t,{parser:e,callback:r}){const n={...t};return Object.defineProperties(n,{$brand:{value:"auto-parseable-tool",enumerable:!1},$parseRaw:{value:e,enumerable:!1},$callback:{value:r,enumerable:!1}}),n}function ad(t){return t?.$brand==="auto-parseable-tool"}function M2(t,e){return!e||!BI(e)?{...t,choices:t.choices.map(r=>({...r,message:{...r.message,parsed:null,...r.message.tool_calls?{tool_calls:r.message.tool_calls}:void 0}}))}:wE(t,e)}function wE(t,e){const r=t.choices.map(n=>{if(n.finish_reason==="length")throw new bI;if(n.finish_reason==="content_filter")throw new gI;return{...n,message:{...n.message,...n.message.tool_calls?{tool_calls:n.message.tool_calls?.map(i=>R2(e,i))??void 0}:void 0,parsed:n.message.content&&!n.message.refusal?T2(e,n.message.content):null}}});return{...t,choices:r}}function T2(t,e){return t.response_format?.type!=="json_schema"?null:t.response_format?.type==="json_schema"?"$parseRaw"in t.response_format?t.response_format.$parseRaw(e):JSON.parse(e):null}function R2(t,e){const r=t.tools?.find(n=>n.function?.name===e.function.name);return{...e,function:{...e.function,parsed_arguments:ad(r)?r.$parseRaw(e.function.arguments):r?.function.strict?JSON.parse(e.function.arguments):null}}}function A2(t,e){if(!t)return!1;const r=t.tools?.find(n=>n.function?.name===e.function.name);return ad(r)||r?.function.strict||!1}function BI(t){return vE(t.response_format)?!0:t.tools?.some(e=>ad(e)||e.type==="function"&&e.function.strict===!0)??!1}function $2(t){for(const e of t??[]){if(e.type!=="function")throw new ve(`Currently only \`function\` tool types support auto-parsing; Received \`${e.type}\``);if(e.function.strict!==!0)throw new ve(`The \`${e.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}var Pr=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},sr,HO,vy,qO,GO,WO,UI,KO;const AC=10;class FI extends mE{constructor(){super(...arguments),sr.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(e){this._chatCompletions.push(e),this._emit("chatCompletion",e);const r=e.choices[0]?.message;return r&&this._addMessage(r),e}_addMessage(e,r=!0){if("content"in e||(e.content=null),this.messages.push(e),r){if(this._emit("message",e),(DI(e)||NI(e))&&e.content)this._emit("functionCallResult",e.content);else if(Vs(e)&&e.function_call)this._emit("functionCall",e.function_call);else if(Vs(e)&&e.tool_calls)for(const n of e.tool_calls)n.type==="function"&&this._emit("functionCall",n.function)}}async finalChatCompletion(){await this.done();const e=this._chatCompletions[this._chatCompletions.length-1];if(!e)throw new ve("stream ended without producing a ChatCompletion");return e}async finalContent(){return await this.done(),Pr(this,sr,"m",HO).call(this)}async finalMessage(){return await this.done(),Pr(this,sr,"m",vy).call(this)}async finalFunctionCall(){return await this.done(),Pr(this,sr,"m",qO).call(this)}async finalFunctionCallResult(){return await this.done(),Pr(this,sr,"m",GO).call(this)}async totalUsage(){return await this.done(),Pr(this,sr,"m",WO).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){const e=this._chatCompletions[this._chatCompletions.length-1];e&&this._emit("finalChatCompletion",e);const r=Pr(this,sr,"m",vy).call(this);r&&this._emit("finalMessage",r);const n=Pr(this,sr,"m",HO).call(this);n&&this._emit("finalContent",n);const i=Pr(this,sr,"m",qO).call(this);i&&this._emit("finalFunctionCall",i);const a=Pr(this,sr,"m",GO).call(this);a!=null&&this._emit("finalFunctionCallResult",a),this._chatCompletions.some(o=>o.usage)&&this._emit("totalUsage",Pr(this,sr,"m",WO).call(this))}async _createChatCompletion(e,r,n){const i=n?.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort())),Pr(this,sr,"m",UI).call(this,r);const a=await e.chat.completions.create({...r,stream:!1},{...n,signal:this.controller.signal});return this._connected(),this._addChatCompletion(wE(a,r))}async _runChatCompletion(e,r,n){for(const i of r.messages)this._addMessage(i,!1);return await this._createChatCompletion(e,r,n)}async _runFunctions(e,r,n){const i="function",{function_call:a="auto",stream:o,...s}=r,l=typeof a!="string"&&a?.name,{maxChatCompletions:c=AC}=n||{},d={};for(const h of r.functions)d[h.name||h.function.name]=h;const f=r.functions.map(h=>({name:h.name||h.function.name,parameters:h.parameters,description:h.description}));for(const h of r.messages)this._addMessage(h,!1);for(let h=0;h<c;++h){const b=(await this._createChatCompletion(e,{...s,function_call:a,functions:f,messages:[...this.messages]},n)).choices[0]?.message;if(!b)throw new ve("missing message in ChatCompletion response");if(!b.function_call)return;const{name:g,arguments:v}=b.function_call,E=d[g];if(E){if(l&&l!==g){const D=`Invalid function_call: ${JSON.stringify(g)}. ${JSON.stringify(l)} requested. Please try again`;this._addMessage({role:i,name:g,content:D});continue}}else{const D=`Invalid function_call: ${JSON.stringify(g)}. Available options are: ${f.map(Z=>JSON.stringify(Z.name)).join(", ")}. Please try again`;this._addMessage({role:i,name:g,content:D});continue}let C;try{C=RC(E)?await E.parse(v):v}catch(D){this._addMessage({role:i,name:g,content:D instanceof Error?D.message:String(D)});continue}const S=await E.function(C,this),N=Pr(this,sr,"m",KO).call(this,S);if(this._addMessage({role:i,name:g,content:N}),l)return}}async _runTools(e,r,n){const i="tool",{tool_choice:a="auto",stream:o,...s}=r,l=typeof a!="string"&&a?.function?.name,{maxChatCompletions:c=AC}=n||{},d=r.tools.map(p=>{if(ad(p)){if(!p.$callback)throw new ve("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:p.$callback,name:p.function.name,description:p.function.description||"",parameters:p.function.parameters,parse:p.$parseRaw,strict:!0}}}return p}),f={};for(const p of d)p.type==="function"&&(f[p.function.name||p.function.function.name]=p.function);const h="tools"in r?d.map(p=>p.type==="function"?{type:"function",function:{name:p.function.name||p.function.function.name,parameters:p.function.parameters,description:p.function.description,strict:p.function.strict}}:p):void 0;for(const p of r.messages)this._addMessage(p,!1);for(let p=0;p<c;++p){const g=(await this._createChatCompletion(e,{...s,tool_choice:a,tools:h,messages:[...this.messages]},n)).choices[0]?.message;if(!g)throw new ve("missing message in ChatCompletion response");if(!g.tool_calls?.length)return;for(const v of g.tool_calls){if(v.type!=="function")continue;const E=v.id,{name:C,arguments:S}=v.function,N=f[C];if(N){if(l&&l!==C){const re=`Invalid tool_call: ${JSON.stringify(C)}. ${JSON.stringify(l)} requested. Please try again`;this._addMessage({role:i,tool_call_id:E,content:re});continue}}else{const re=`Invalid tool_call: ${JSON.stringify(C)}. Available options are: ${Object.keys(f).map(k=>JSON.stringify(k)).join(", ")}. Please try again`;this._addMessage({role:i,tool_call_id:E,content:re});continue}let D;try{D=RC(N)?await N.parse(S):S}catch(re){const k=re instanceof Error?re.message:String(re);this._addMessage({role:i,tool_call_id:E,content:k});continue}const Z=await N.function(D,this),se=Pr(this,sr,"m",KO).call(this,Z);if(this._addMessage({role:i,tool_call_id:E,content:se}),l)return}}}}sr=new WeakSet,HO=function(){return Pr(this,sr,"m",vy).call(this).content??null},vy=function(){let e=this.messages.length;for(;e-- >0;){const r=this.messages[e];if(Vs(r)){const{function_call:n,...i}=r,a={...i,content:r.content??null,refusal:r.refusal??null};return n&&(a.function_call=n),a}}throw new ve("stream ended without producing a ChatCompletionMessage with role=assistant")},qO=function(){for(let e=this.messages.length-1;e>=0;e--){const r=this.messages[e];if(Vs(r)&&r?.function_call)return r.function_call;if(Vs(r)&&r?.tool_calls?.length)return r.tool_calls.at(-1)?.function}},GO=function(){for(let e=this.messages.length-1;e>=0;e--){const r=this.messages[e];if(DI(r)&&r.content!=null||NI(r)&&r.content!=null&&typeof r.content=="string"&&this.messages.some(n=>n.role==="assistant"&&n.tool_calls?.some(i=>i.type==="function"&&i.id===r.tool_call_id)))return r.content}},WO=function(){const e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:r}of this._chatCompletions)r&&(e.completion_tokens+=r.completion_tokens,e.prompt_tokens+=r.prompt_tokens,e.total_tokens+=r.total_tokens);return e},UI=function(e){if(e.n!=null&&e.n>1)throw new ve("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},KO=function(e){return typeof e=="string"?e:e===void 0?"undefined":JSON.stringify(e)};class Bc extends FI{static runFunctions(e,r,n){const i=new Bc,a={...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"runFunctions"}};return i._run(()=>i._runFunctions(e,r,a)),i}static runTools(e,r,n){const i=new Bc,a={...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"runTools"}};return i._run(()=>i._runTools(e,r,a)),i}_addMessage(e,r=!0){super._addMessage(e,r),Vs(e)&&e.content&&this._emit("content",e.content)}}const LI=1,VI=2,kI=4,HI=8,qI=16,GI=32,WI=64,KI=128,JI=256,XI=KI|JI,ZI=qI|GI|XI|WI,YI=LI|VI|ZI,QI=kI|HI,I2=YI|QI,kt={STR:LI,NUM:VI,ARR:kI,OBJ:HI,NULL:qI,BOOL:GI,NAN:WI,INFINITY:KI,MINUS_INFINITY:JI,INF:XI,SPECIAL:ZI,ATOM:YI,COLLECTION:QI,ALL:I2};class x2 extends Error{}class D2 extends Error{}function N2(t,e=kt.ALL){if(typeof t!="string")throw new TypeError(`expecting str, got ${typeof t}`);if(!t.trim())throw new Error(`${t} is empty`);return z2(t.trim(),e)}const z2=(t,e)=>{const r=t.length;let n=0;const i=h=>{throw new x2(`${h} at position ${n}`)},a=h=>{throw new D2(`${h} at position ${n}`)},o=()=>(f(),n>=r&&i("Unexpected end of input"),t[n]==='"'?s():t[n]==="{"?l():t[n]==="["?c():t.substring(n,n+4)==="null"||kt.NULL&e&&r-n<4&&"null".startsWith(t.substring(n))?(n+=4,null):t.substring(n,n+4)==="true"||kt.BOOL&e&&r-n<4&&"true".startsWith(t.substring(n))?(n+=4,!0):t.substring(n,n+5)==="false"||kt.BOOL&e&&r-n<5&&"false".startsWith(t.substring(n))?(n+=5,!1):t.substring(n,n+8)==="Infinity"||kt.INFINITY&e&&r-n<8&&"Infinity".startsWith(t.substring(n))?(n+=8,1/0):t.substring(n,n+9)==="-Infinity"||kt.MINUS_INFINITY&e&&1<r-n&&r-n<9&&"-Infinity".startsWith(t.substring(n))?(n+=9,-1/0):t.substring(n,n+3)==="NaN"||kt.NAN&e&&r-n<3&&"NaN".startsWith(t.substring(n))?(n+=3,NaN):d()),s=()=>{const h=n;let p=!1;for(n++;n<r&&(t[n]!=='"'||p&&t[n-1]==="\\");)p=t[n]==="\\"?!p:!1,n++;if(t.charAt(n)=='"')try{return JSON.parse(t.substring(h,++n-Number(p)))}catch(b){a(String(b))}else if(kt.STR&e)try{return JSON.parse(t.substring(h,n-Number(p))+'"')}catch{return JSON.parse(t.substring(h,t.lastIndexOf("\\"))+'"')}i("Unterminated string literal")},l=()=>{n++,f();const h={};try{for(;t[n]!=="}";){if(f(),n>=r&&kt.OBJ&e)return h;const p=s();f(),n++;try{const b=o();Object.defineProperty(h,p,{value:b,writable:!0,enumerable:!0,configurable:!0})}catch(b){if(kt.OBJ&e)return h;throw b}f(),t[n]===","&&n++}}catch{if(kt.OBJ&e)return h;i("Expected '}' at end of object")}return n++,h},c=()=>{n++;const h=[];try{for(;t[n]!=="]";)h.push(o()),f(),t[n]===","&&n++}catch{if(kt.ARR&e)return h;i("Expected ']' at end of array")}return n++,h},d=()=>{if(n===0){t==="-"&&kt.NUM&e&&i("Not sure what '-' is");try{return JSON.parse(t)}catch(p){if(kt.NUM&e)try{return t[t.length-1]==="."?JSON.parse(t.substring(0,t.lastIndexOf("."))):JSON.parse(t.substring(0,t.lastIndexOf("e")))}catch{}a(String(p))}}const h=n;for(t[n]==="-"&&n++;t[n]&&!",]}".includes(t[n]);)n++;n==r&&!(kt.NUM&e)&&i("Unterminated number literal");try{return JSON.parse(t.substring(h,n))}catch{t.substring(h,n)==="-"&&kt.NUM&e&&i("Not sure what '-' is");try{return JSON.parse(t.substring(h,t.lastIndexOf("e")))}catch(b){a(String(b))}}},f=()=>{for(;n<r&&` 
\r	`.includes(t[n]);)n++};return o()},$C=t=>N2(t,kt.ALL^kt.NUM);var Ko=function(t,e,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(t,r):i?i.value=r:e.set(t,r),r},ot=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},Bt,pi,Jo,Zi,bw,Ap,gw,mw,vw,$p,ww,IC;class Uc extends FI{constructor(e){super(),Bt.add(this),pi.set(this,void 0),Jo.set(this,void 0),Zi.set(this,void 0),Ko(this,pi,e,"f"),Ko(this,Jo,[],"f")}get currentChatCompletionSnapshot(){return ot(this,Zi,"f")}static fromReadableStream(e){const r=new Uc(null);return r._run(()=>r._fromReadableStream(e)),r}static createChatCompletion(e,r,n){const i=new Uc(r);return i._run(()=>i._runChatCompletion(e,{...r,stream:!0},{...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"stream"}})),i}async _createChatCompletion(e,r,n){super._createChatCompletion;const i=n?.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort())),ot(this,Bt,"m",bw).call(this);const a=await e.chat.completions.create({...r,stream:!0},{...n,signal:this.controller.signal});this._connected();for await(const o of a)ot(this,Bt,"m",gw).call(this,o);if(a.controller.signal?.aborted)throw new Wr;return this._addChatCompletion(ot(this,Bt,"m",$p).call(this))}async _fromReadableStream(e,r){const n=r?.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),ot(this,Bt,"m",bw).call(this),this._connected();const i=zc.fromReadableStream(e,this.controller);let a;for await(const o of i)a&&a!==o.id&&this._addChatCompletion(ot(this,Bt,"m",$p).call(this)),ot(this,Bt,"m",gw).call(this,o),a=o.id;if(i.controller.signal?.aborted)throw new Wr;return this._addChatCompletion(ot(this,Bt,"m",$p).call(this))}[(pi=new WeakMap,Jo=new WeakMap,Zi=new WeakMap,Bt=new WeakSet,bw=function(){this.ended||Ko(this,Zi,void 0,"f")},Ap=function(r){let n=ot(this,Jo,"f")[r.index];return n||(n={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},ot(this,Jo,"f")[r.index]=n,n)},gw=function(r){if(this.ended)return;const n=ot(this,Bt,"m",IC).call(this,r);this._emit("chunk",r,n);for(const i of r.choices){const a=n.choices[i.index];i.delta.content!=null&&a.message?.role==="assistant"&&a.message?.content&&(this._emit("content",i.delta.content,a.message.content),this._emit("content.delta",{delta:i.delta.content,snapshot:a.message.content,parsed:a.message.parsed})),i.delta.refusal!=null&&a.message?.role==="assistant"&&a.message?.refusal&&this._emit("refusal.delta",{delta:i.delta.refusal,snapshot:a.message.refusal}),i.logprobs?.content!=null&&a.message?.role==="assistant"&&this._emit("logprobs.content.delta",{content:i.logprobs?.content,snapshot:a.logprobs?.content??[]}),i.logprobs?.refusal!=null&&a.message?.role==="assistant"&&this._emit("logprobs.refusal.delta",{refusal:i.logprobs?.refusal,snapshot:a.logprobs?.refusal??[]});const o=ot(this,Bt,"m",Ap).call(this,a);a.finish_reason&&(ot(this,Bt,"m",vw).call(this,a),o.current_tool_call_index!=null&&ot(this,Bt,"m",mw).call(this,a,o.current_tool_call_index));for(const s of i.delta.tool_calls??[])o.current_tool_call_index!==s.index&&(ot(this,Bt,"m",vw).call(this,a),o.current_tool_call_index!=null&&ot(this,Bt,"m",mw).call(this,a,o.current_tool_call_index)),o.current_tool_call_index=s.index;for(const s of i.delta.tool_calls??[]){const l=a.message.tool_calls?.[s.index];l?.type&&(l?.type==="function"?this._emit("tool_calls.function.arguments.delta",{name:l.function?.name,index:s.index,arguments:l.function.arguments,parsed_arguments:l.function.parsed_arguments,arguments_delta:s.function?.arguments??""}):(l?.type,void 0))}}},mw=function(r,n){if(ot(this,Bt,"m",Ap).call(this,r).done_tool_calls.has(n))return;const a=r.message.tool_calls?.[n];if(!a)throw new Error("no tool call snapshot");if(!a.type)throw new Error("tool call snapshot missing `type`");if(a.type==="function"){const o=ot(this,pi,"f")?.tools?.find(s=>s.type==="function"&&s.function.name===a.function.name);this._emit("tool_calls.function.arguments.done",{name:a.function.name,index:n,arguments:a.function.arguments,parsed_arguments:ad(o)?o.$parseRaw(a.function.arguments):o?.function.strict?JSON.parse(a.function.arguments):null})}else a.type},vw=function(r){const n=ot(this,Bt,"m",Ap).call(this,r);if(r.message.content&&!n.content_done){n.content_done=!0;const i=ot(this,Bt,"m",ww).call(this);this._emit("content.done",{content:r.message.content,parsed:i?i.$parseRaw(r.message.content):null})}r.message.refusal&&!n.refusal_done&&(n.refusal_done=!0,this._emit("refusal.done",{refusal:r.message.refusal})),r.logprobs?.content&&!n.logprobs_content_done&&(n.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:r.logprobs.content})),r.logprobs?.refusal&&!n.logprobs_refusal_done&&(n.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:r.logprobs.refusal}))},$p=function(){if(this.ended)throw new ve("stream has ended, this shouldn't happen");const r=ot(this,Zi,"f");if(!r)throw new ve("request ended without sending any chunks");return Ko(this,Zi,void 0,"f"),Ko(this,Jo,[],"f"),B2(r,ot(this,pi,"f"))},ww=function(){const r=ot(this,pi,"f")?.response_format;return vE(r)?r:null},IC=function(r){var n,i,a,o;let s=ot(this,Zi,"f");const{choices:l,...c}=r;s?Object.assign(s,c):s=Ko(this,Zi,{...c,choices:[]},"f");for(const{delta:d,finish_reason:f,index:h,logprobs:p=null,...b}of r.choices){let g=s.choices[h];if(g||(g=s.choices[h]={finish_reason:f,index:h,message:{},logprobs:p,...b}),p)if(!g.logprobs)g.logprobs=Object.assign({},p);else{const{content:Z,refusal:se,...re}=p;Object.assign(g.logprobs,re),Z&&((n=g.logprobs).content??(n.content=[]),g.logprobs.content.push(...Z)),se&&((i=g.logprobs).refusal??(i.refusal=[]),g.logprobs.refusal.push(...se))}if(f&&(g.finish_reason=f,ot(this,pi,"f")&&BI(ot(this,pi,"f")))){if(f==="length")throw new bI;if(f==="content_filter")throw new gI}if(Object.assign(g,b),!d)continue;const{content:v,refusal:E,function_call:C,role:S,tool_calls:N,...D}=d;if(Object.assign(g.message,D),E&&(g.message.refusal=(g.message.refusal||"")+E),S&&(g.message.role=S),C&&(g.message.function_call?(C.name&&(g.message.function_call.name=C.name),C.arguments&&((a=g.message.function_call).arguments??(a.arguments=""),g.message.function_call.arguments+=C.arguments)):g.message.function_call=C),v&&(g.message.content=(g.message.content||"")+v,!g.message.refusal&&ot(this,Bt,"m",ww).call(this)&&(g.message.parsed=$C(g.message.content))),N){g.message.tool_calls||(g.message.tool_calls=[]);for(const{index:Z,id:se,type:re,function:k,...ee}of N){const X=(o=g.message.tool_calls)[Z]??(o[Z]={});Object.assign(X,ee),se&&(X.id=se),re&&(X.type=re),k&&(X.function??(X.function={name:k.name??"",arguments:""})),k?.name&&(X.function.name=k.name),k?.arguments&&(X.function.arguments+=k.arguments,A2(ot(this,pi,"f"),X)&&(X.function.parsed_arguments=$C(X.function.arguments)))}}}return s},Symbol.asyncIterator)](){const e=[],r=[];let n=!1;return this.on("chunk",i=>{const a=r.shift();a?a.resolve(i):e.push(i)}),this.on("end",()=>{n=!0;for(const i of r)i.resolve(void 0);r.length=0}),this.on("abort",i=>{n=!0;for(const a of r)a.reject(i);r.length=0}),this.on("error",i=>{n=!0;for(const a of r)a.reject(i);r.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:n?{value:void 0,done:!0}:new Promise((a,o)=>r.push({resolve:a,reject:o})).then(a=>a?{value:a,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new zc(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function B2(t,e){const{id:r,choices:n,created:i,model:a,system_fingerprint:o,...s}=t,l={...s,id:r,choices:n.map(({message:c,finish_reason:d,index:f,logprobs:h,...p})=>{if(!d)throw new ve(`missing finish_reason for choice ${f}`);const{content:b=null,function_call:g,tool_calls:v,...E}=c,C=c.role;if(!C)throw new ve(`missing role for choice ${f}`);if(g){const{arguments:S,name:N}=g;if(S==null)throw new ve(`missing function_call.arguments for choice ${f}`);if(!N)throw new ve(`missing function_call.name for choice ${f}`);return{...p,message:{content:b,function_call:{arguments:S,name:N},role:C,refusal:c.refusal??null},finish_reason:d,index:f,logprobs:h}}return v?{...p,index:f,finish_reason:d,logprobs:h,message:{...E,role:C,content:b,refusal:c.refusal??null,tool_calls:v.map((S,N)=>{const{function:D,type:Z,id:se,...re}=S,{arguments:k,name:ee,...X}=D||{};if(se==null)throw new ve(`missing choices[${f}].tool_calls[${N}].id
${Ip(t)}`);if(Z==null)throw new ve(`missing choices[${f}].tool_calls[${N}].type
${Ip(t)}`);if(ee==null)throw new ve(`missing choices[${f}].tool_calls[${N}].function.name
${Ip(t)}`);if(k==null)throw new ve(`missing choices[${f}].tool_calls[${N}].function.arguments
${Ip(t)}`);return{...re,id:se,type:Z,function:{...X,name:ee,arguments:k}}})}}:{...p,message:{...E,content:b,role:C,refusal:c.refusal??null},finish_reason:d,index:f,logprobs:h}}),created:i,model:a,object:"chat.completion",...o?{system_fingerprint:o}:{}};return M2(l,e)}function Ip(t){return JSON.stringify(t)}class ks extends Uc{static fromReadableStream(e){const r=new ks(null);return r._run(()=>r._fromReadableStream(e)),r}static runFunctions(e,r,n){const i=new ks(null),a={...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"runFunctions"}};return i._run(()=>i._runFunctions(e,r,a)),i}static runTools(e,r,n){const i=new ks(r),a={...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"runTools"}};return i._run(()=>i._runTools(e,r,a)),i}}let ex=class extends We{parse(e,r){return $2(e.tools),this._client.chat.completions.create(e,{...r,headers:{...r?.headers,"X-Stainless-Helper-Method":"beta.chat.completions.parse"}})._thenUnwrap(n=>wE(n,e))}runFunctions(e,r){return e.stream?ks.runFunctions(this._client,e,r):Bc.runFunctions(this._client,e,r)}runTools(e,r){return e.stream?ks.runTools(this._client,e,r):Bc.runTools(this._client,e,r)}stream(e,r){return Uc.createChatCompletion(this._client,e,r)}},JO=class extends We{constructor(){super(...arguments),this.completions=new ex(this._client)}};(function(t){t.Completions=ex})(JO||(JO={}));class tx extends We{create(e,r){return this._client.post("/realtime/sessions",{body:e,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}}class OE extends We{constructor(){super(...arguments),this.sessions=new tx(this._client)}}OE.Sessions=tx;var me=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},Dr=function(t,e,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(t,r):i?i.value=r:e.set(t,r),r},Yt,XO,Xn,F_,Tn,lo,xs,io,wy,Hr,L_,V_,hc,rc,nc,xC,DC,NC,zC,BC,UC,FC;class $n extends mE{constructor(){super(...arguments),Yt.add(this),XO.set(this,[]),Xn.set(this,{}),F_.set(this,{}),Tn.set(this,void 0),lo.set(this,void 0),xs.set(this,void 0),io.set(this,void 0),wy.set(this,void 0),Hr.set(this,void 0),L_.set(this,void 0),V_.set(this,void 0),hc.set(this,void 0)}[(XO=new WeakMap,Xn=new WeakMap,F_=new WeakMap,Tn=new WeakMap,lo=new WeakMap,xs=new WeakMap,io=new WeakMap,wy=new WeakMap,Hr=new WeakMap,L_=new WeakMap,V_=new WeakMap,hc=new WeakMap,Yt=new WeakSet,Symbol.asyncIterator)](){const e=[],r=[];let n=!1;return this.on("event",i=>{const a=r.shift();a?a.resolve(i):e.push(i)}),this.on("end",()=>{n=!0;for(const i of r)i.resolve(void 0);r.length=0}),this.on("abort",i=>{n=!0;for(const a of r)a.reject(i);r.length=0}),this.on("error",i=>{n=!0;for(const a of r)a.reject(i);r.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:n?{value:void 0,done:!0}:new Promise((a,o)=>r.push({resolve:a,reject:o})).then(a=>a?{value:a,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(e){const r=new $n;return r._run(()=>r._fromReadableStream(e)),r}async _fromReadableStream(e,r){const n=r?.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),this._connected();const i=zc.fromReadableStream(e,this.controller);for await(const a of i)me(this,Yt,"m",rc).call(this,a);if(i.controller.signal?.aborted)throw new Wr;return this._addRun(me(this,Yt,"m",nc).call(this))}toReadableStream(){return new zc(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(e,r,n,i,a){const o=new $n;return o._run(()=>o._runToolAssistantStream(e,r,n,i,{...a,headers:{...a?.headers,"X-Stainless-Helper-Method":"stream"}})),o}async _createToolAssistantStream(e,r,n,i,a){const o=a?.signal;o&&(o.aborted&&this.controller.abort(),o.addEventListener("abort",()=>this.controller.abort()));const s={...i,stream:!0},l=await e.submitToolOutputs(r,n,s,{...a,signal:this.controller.signal});this._connected();for await(const c of l)me(this,Yt,"m",rc).call(this,c);if(l.controller.signal?.aborted)throw new Wr;return this._addRun(me(this,Yt,"m",nc).call(this))}static createThreadAssistantStream(e,r,n){const i=new $n;return i._run(()=>i._threadAssistantStream(e,r,{...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"stream"}})),i}static createAssistantStream(e,r,n,i){const a=new $n;return a._run(()=>a._runAssistantStream(e,r,n,{...i,headers:{...i?.headers,"X-Stainless-Helper-Method":"stream"}})),a}currentEvent(){return me(this,L_,"f")}currentRun(){return me(this,V_,"f")}currentMessageSnapshot(){return me(this,Tn,"f")}currentRunStepSnapshot(){return me(this,hc,"f")}async finalRunSteps(){return await this.done(),Object.values(me(this,Xn,"f"))}async finalMessages(){return await this.done(),Object.values(me(this,F_,"f"))}async finalRun(){if(await this.done(),!me(this,lo,"f"))throw Error("Final run was not received.");return me(this,lo,"f")}async _createThreadAssistantStream(e,r,n){const i=n?.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort()));const a={...r,stream:!0},o=await e.createAndRun(a,{...n,signal:this.controller.signal});this._connected();for await(const s of o)me(this,Yt,"m",rc).call(this,s);if(o.controller.signal?.aborted)throw new Wr;return this._addRun(me(this,Yt,"m",nc).call(this))}async _createAssistantStream(e,r,n,i){const a=i?.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort()));const o={...n,stream:!0},s=await e.create(r,o,{...i,signal:this.controller.signal});this._connected();for await(const l of s)me(this,Yt,"m",rc).call(this,l);if(s.controller.signal?.aborted)throw new Wr;return this._addRun(me(this,Yt,"m",nc).call(this))}static accumulateDelta(e,r){for(const[n,i]of Object.entries(r)){if(!e.hasOwnProperty(n)){e[n]=i;continue}let a=e[n];if(a==null){e[n]=i;continue}if(n==="index"||n==="type"){e[n]=i;continue}if(typeof a=="string"&&typeof i=="string")a+=i;else if(typeof a=="number"&&typeof i=="number")a+=i;else if(N_(a)&&N_(i))a=this.accumulateDelta(a,i);else if(Array.isArray(a)&&Array.isArray(i)){if(a.every(o=>typeof o=="string"||typeof o=="number")){a.push(...i);continue}for(const o of i){if(!N_(o))throw new Error(`Expected array delta entry to be an object but got: ${o}`);const s=o.index;if(s==null)throw console.error(o),new Error("Expected array delta entry to have an `index` property");if(typeof s!="number")throw new Error(`Expected array delta entry \`index\` property to be a number but got ${s}`);const l=a[s];l==null?a.push(o):a[s]=this.accumulateDelta(l,o)}continue}else throw Error(`Unhandled record type: ${n}, deltaValue: ${i}, accValue: ${a}`);e[n]=a}return e}_addRun(e){return e}async _threadAssistantStream(e,r,n){return await this._createThreadAssistantStream(r,e,n)}async _runAssistantStream(e,r,n,i){return await this._createAssistantStream(r,e,n,i)}async _runToolAssistantStream(e,r,n,i,a){return await this._createToolAssistantStream(n,e,r,i,a)}}rc=function(e){if(!this.ended)switch(Dr(this,L_,e,"f"),me(this,Yt,"m",NC).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.incomplete":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":me(this,Yt,"m",FC).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":me(this,Yt,"m",DC).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":me(this,Yt,"m",xC).call(this,e);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},nc=function(){if(this.ended)throw new ve("stream has ended, this shouldn't happen");if(!me(this,lo,"f"))throw Error("Final run has not been received");return me(this,lo,"f")},xC=function(e){const[r,n]=me(this,Yt,"m",BC).call(this,e,me(this,Tn,"f"));Dr(this,Tn,r,"f"),me(this,F_,"f")[r.id]=r;for(const i of n){const a=r.content[i.index];a?.type=="text"&&this._emit("textCreated",a.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,r),e.data.delta.content)for(const i of e.data.delta.content){if(i.type=="text"&&i.text){let a=i.text,o=r.content[i.index];if(o&&o.type=="text")this._emit("textDelta",a,o.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(i.index!=me(this,xs,"f")){if(me(this,io,"f"))switch(me(this,io,"f").type){case"text":this._emit("textDone",me(this,io,"f").text,me(this,Tn,"f"));break;case"image_file":this._emit("imageFileDone",me(this,io,"f").image_file,me(this,Tn,"f"));break}Dr(this,xs,i.index,"f")}Dr(this,io,r.content[i.index],"f")}break;case"thread.message.completed":case"thread.message.incomplete":if(me(this,xs,"f")!==void 0){const i=e.data.content[me(this,xs,"f")];if(i)switch(i.type){case"image_file":this._emit("imageFileDone",i.image_file,me(this,Tn,"f"));break;case"text":this._emit("textDone",i.text,me(this,Tn,"f"));break}}me(this,Tn,"f")&&this._emit("messageDone",e.data),Dr(this,Tn,void 0,"f")}},DC=function(e){const r=me(this,Yt,"m",zC).call(this,e);switch(Dr(this,hc,r,"f"),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":const n=e.data.delta;if(n.step_details&&n.step_details.type=="tool_calls"&&n.step_details.tool_calls&&r.step_details.type=="tool_calls")for(const a of n.step_details.tool_calls)a.index==me(this,wy,"f")?this._emit("toolCallDelta",a,r.step_details.tool_calls[a.index]):(me(this,Hr,"f")&&this._emit("toolCallDone",me(this,Hr,"f")),Dr(this,wy,a.index,"f"),Dr(this,Hr,r.step_details.tool_calls[a.index],"f"),me(this,Hr,"f")&&this._emit("toolCallCreated",me(this,Hr,"f")));this._emit("runStepDelta",e.data.delta,r);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":Dr(this,hc,void 0,"f"),e.data.step_details.type=="tool_calls"&&me(this,Hr,"f")&&(this._emit("toolCallDone",me(this,Hr,"f")),Dr(this,Hr,void 0,"f")),this._emit("runStepDone",e.data,r);break}},NC=function(e){me(this,XO,"f").push(e),this._emit("event",e)},zC=function(e){switch(e.event){case"thread.run.step.created":return me(this,Xn,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let r=me(this,Xn,"f")[e.data.id];if(!r)throw Error("Received a RunStepDelta before creation of a snapshot");let n=e.data;if(n.delta){const i=$n.accumulateDelta(r,n.delta);me(this,Xn,"f")[e.data.id]=i}return me(this,Xn,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":me(this,Xn,"f")[e.data.id]=e.data;break}if(me(this,Xn,"f")[e.data.id])return me(this,Xn,"f")[e.data.id];throw new Error("No snapshot available")},BC=function(e,r){let n=[];switch(e.event){case"thread.message.created":return[e.data,n];case"thread.message.delta":if(!r)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let i=e.data;if(i.delta.content)for(const a of i.delta.content)if(a.index in r.content){let o=r.content[a.index];r.content[a.index]=me(this,Yt,"m",UC).call(this,a,o)}else r.content[a.index]=a,n.push(a);return[r,n];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(r)return[r,n];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},UC=function(e,r){return $n.accumulateDelta(r,e)},FC=function(e){switch(Dr(this,V_,e.data,"f"),e.event){case"thread.run.created":break;case"thread.run.queued":break;case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":Dr(this,lo,e.data,"f"),me(this,Hr,"f")&&(this._emit("toolCallDone",me(this,Hr,"f")),Dr(this,Hr,void 0,"f"));break}};let SE=class extends We{create(e,r,n){return this._client.post(`/threads/${e}/messages`,{body:r,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}retrieve(e,r,n){return this._client.get(`/threads/${e}/messages/${r}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}update(e,r,n,i){return this._client.post(`/threads/${e}/messages/${r}`,{body:n,...i,headers:{"OpenAI-Beta":"assistants=v2",...i?.headers}})}list(e,r={},n){return Kt(r)?this.list(e,{},r):this._client.getAPIList(`/threads/${e}/messages`,EE,{query:r,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}del(e,r,n){return this._client.delete(`/threads/${e}/messages/${r}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}};class EE extends $r{}SE.MessagesPage=EE;class PE extends We{retrieve(e,r,n,i={},a){return Kt(i)?this.retrieve(e,r,n,{},i):this._client.get(`/threads/${e}/runs/${r}/steps/${n}`,{query:i,...a,headers:{"OpenAI-Beta":"assistants=v2",...a?.headers}})}list(e,r,n={},i){return Kt(n)?this.list(e,r,{},n):this._client.getAPIList(`/threads/${e}/runs/${r}/steps`,jE,{query:n,...i,headers:{"OpenAI-Beta":"assistants=v2",...i?.headers}})}}class jE extends $r{}PE.RunStepsPage=jE;class od extends We{constructor(){super(...arguments),this.steps=new PE(this._client)}create(e,r,n){const{include:i,...a}=r;return this._client.post(`/threads/${e}/runs`,{query:{include:i},body:a,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers},stream:r.stream??!1})}retrieve(e,r,n){return this._client.get(`/threads/${e}/runs/${r}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}update(e,r,n,i){return this._client.post(`/threads/${e}/runs/${r}`,{body:n,...i,headers:{"OpenAI-Beta":"assistants=v2",...i?.headers}})}list(e,r={},n){return Kt(r)?this.list(e,{},r):this._client.getAPIList(`/threads/${e}/runs`,CE,{query:r,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}cancel(e,r,n){return this._client.post(`/threads/${e}/runs/${r}/cancel`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}async createAndPoll(e,r,n){const i=await this.create(e,r,n);return await this.poll(e,i.id,n)}createAndStream(e,r,n){return $n.createAssistantStream(e,this._client.beta.threads.runs,r,n)}async poll(e,r,n){const i={...n?.headers,"X-Stainless-Poll-Helper":"true"};for(n?.pollIntervalMs&&(i["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const{data:a,response:o}=await this.retrieve(e,r,{...n,headers:{...n?.headers,...i}}).withResponse();switch(a.status){case"queued":case"in_progress":case"cancelling":let s=5e3;if(n?.pollIntervalMs)s=n.pollIntervalMs;else{const l=o.headers.get("openai-poll-after-ms");if(l){const c=parseInt(l);isNaN(c)||(s=c)}}await nd(s);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return a}}}stream(e,r,n){return $n.createAssistantStream(e,this._client.beta.threads.runs,r,n)}submitToolOutputs(e,r,n,i){return this._client.post(`/threads/${e}/runs/${r}/submit_tool_outputs`,{body:n,...i,headers:{"OpenAI-Beta":"assistants=v2",...i?.headers},stream:n.stream??!1})}async submitToolOutputsAndPoll(e,r,n,i){const a=await this.submitToolOutputs(e,r,n,i);return await this.poll(e,a.id,i)}submitToolOutputsStream(e,r,n,i){return $n.createToolAssistantStream(e,r,this._client.beta.threads.runs,n,i)}}class CE extends $r{}od.RunsPage=CE;od.Steps=PE;od.RunStepsPage=jE;class xu extends We{constructor(){super(...arguments),this.runs=new od(this._client),this.messages=new SE(this._client)}create(e={},r){return Kt(e)?this.create({},e):this._client.post("/threads",{body:e,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}retrieve(e,r){return this._client.get(`/threads/${e}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}update(e,r,n){return this._client.post(`/threads/${e}`,{body:r,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}del(e,r){return this._client.delete(`/threads/${e}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}createAndRun(e,r){return this._client.post("/threads/runs",{body:e,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers},stream:e.stream??!1})}async createAndRunPoll(e,r){const n=await this.createAndRun(e,r);return await this.runs.poll(n.thread_id,n.id,r)}createAndRunStream(e,r){return $n.createThreadAssistantStream(e,this._client.beta.threads,r)}}xu.Runs=od;xu.RunsPage=CE;xu.Messages=SE;xu.MessagesPage=EE;let Du=class extends We{constructor(){super(...arguments),this.realtime=new OE(this._client),this.chat=new JO(this._client),this.assistants=new bE(this._client),this.threads=new xu(this._client)}};Du.Realtime=OE;Du.Assistants=bE;Du.AssistantsPage=gE;Du.Threads=xu;let rx=class extends We{create(e,r){return this._client.post("/completions",{body:e,...r,stream:e.stream??!1})}},nx=class extends We{create(e,r){return this._client.post("/embeddings",{body:e,...r})}},ME=class extends We{create(e,r){return this._client.post("/files",_u({body:e,...r}))}retrieve(e,r){return this._client.get(`/files/${e}`,r)}list(e={},r){return Kt(e)?this.list({},e):this._client.getAPIList("/files",TE,{query:e,...r})}del(e,r){return this._client.delete(`/files/${e}`,r)}content(e,r){return this._client.get(`/files/${e}/content`,{...r,headers:{Accept:"application/binary",...r?.headers},__binaryResponse:!0})}retrieveContent(e,r){return this._client.get(`/files/${e}/content`,r)}async waitForProcessing(e,{pollInterval:r=5e3,maxWait:n=30*60*1e3}={}){const i=new Set(["processed","error","deleted"]),a=Date.now();let o=await this.retrieve(e);for(;!o.status||!i.has(o.status);)if(await nd(r),o=await this.retrieve(e),Date.now()-a>n)throw new ib({message:`Giving up on waiting for file ${e} to finish processing after ${n} milliseconds.`});return o}};class TE extends $r{}ME.FileObjectsPage=TE;class RE extends We{list(e,r={},n){return Kt(r)?this.list(e,{},r):this._client.getAPIList(`/fine_tuning/jobs/${e}/checkpoints`,AE,{query:r,...n})}}class AE extends $r{}RE.FineTuningJobCheckpointsPage=AE;class Nu extends We{constructor(){super(...arguments),this.checkpoints=new RE(this._client)}create(e,r){return this._client.post("/fine_tuning/jobs",{body:e,...r})}retrieve(e,r){return this._client.get(`/fine_tuning/jobs/${e}`,r)}list(e={},r){return Kt(e)?this.list({},e):this._client.getAPIList("/fine_tuning/jobs",$E,{query:e,...r})}cancel(e,r){return this._client.post(`/fine_tuning/jobs/${e}/cancel`,r)}listEvents(e,r={},n){return Kt(r)?this.listEvents(e,{},r):this._client.getAPIList(`/fine_tuning/jobs/${e}/events`,IE,{query:r,...n})}}class $E extends $r{}class IE extends $r{}Nu.FineTuningJobsPage=$E;Nu.FineTuningJobEventsPage=IE;Nu.Checkpoints=RE;Nu.FineTuningJobCheckpointsPage=AE;class sd extends We{constructor(){super(...arguments),this.jobs=new Nu(this._client)}}sd.Jobs=Nu;sd.FineTuningJobsPage=$E;sd.FineTuningJobEventsPage=IE;class ix extends We{createVariation(e,r){return this._client.post("/images/variations",_u({body:e,...r}))}edit(e,r){return this._client.post("/images/edits",_u({body:e,...r}))}generate(e,r){return this._client.post("/images/generations",{body:e,...r})}}let xE=class extends We{retrieve(e,r){return this._client.get(`/models/${e}`,r)}list(e){return this._client.getAPIList("/models",DE,e)}del(e,r){return this._client.delete(`/models/${e}`,r)}};class DE extends pE{}xE.ModelsPage=DE;class ax extends We{create(e,r){return this._client.post("/moderations",{body:e,...r})}}function U2(t,e){return!e||!L2(e)?{...t,output_parsed:null,output:t.output.map(r=>r.type==="function_call"?{...r,parsed_arguments:null}:r.type==="message"?{...r,content:r.content.map(n=>({...n,parsed:null}))}:r)}:ox(t,e)}function ox(t,e){const r=t.output.map(i=>{if(i.type==="function_call")return{...i,parsed_arguments:H2(e,i)};if(i.type==="message"){const a=i.content.map(o=>o.type==="output_text"?{...o,parsed:F2(e,o.text)}:o);return{...i,content:a}}return i}),n=Object.assign({},t,{output:r});return Object.getOwnPropertyDescriptor(t,"output_text")||sx(n),Object.defineProperty(n,"output_parsed",{enumerable:!0,get(){for(const i of n.output)if(i.type==="message"){for(const a of i.content)if(a.type==="output_text"&&a.parsed!==null)return a.parsed}return null}}),n}function F2(t,e){return t.text?.format?.type!=="json_schema"?null:"$parseRaw"in t.text?.format?(t.text?.format).$parseRaw(e):JSON.parse(e)}function L2(t){return!!vE(t.text?.format)}function V2(t){return t?.$brand==="auto-parseable-tool"}function k2(t,e){return t.find(r=>r.type==="function"&&r.name===e)}function H2(t,e){const r=k2(t.tools??[],e.name);return{...e,...e,parsed_arguments:V2(r)?r.$parseRaw(e.arguments):r?.strict?JSON.parse(e.arguments):null}}function sx(t){const e=[];for(const r of t.output)if(r.type==="message")for(const n of r.content)n.type==="output_text"&&e.push(n.text);t.output_text=e.join("")}class NE extends We{list(e,r={},n){return Kt(r)?this.list(e,{},r):this._client.getAPIList(`/responses/${e}/input_items`,zE,{query:r,...n})}}class zE extends $r{}NE.ResponseItemListDataPage=zE;var Xo=function(t,e,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(t,r):i?i.value=r:e.set(t,r),r},Yi=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},Zo,xp,Qi,Dp,LC,VC,kC,HC;class BE extends mE{constructor(e){super(),Zo.add(this),xp.set(this,void 0),Qi.set(this,void 0),Dp.set(this,void 0),Xo(this,xp,e,"f")}static createResponse(e,r,n){const i=new BE(r);return i._run(()=>i._createResponse(e,r,{...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"stream"}})),i}async _createResponse(e,r,n){const i=n?.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort())),Yi(this,Zo,"m",LC).call(this);const a=await e.responses.create({...r,stream:!0},{...n,signal:this.controller.signal});this._connected();for await(const o of a)Yi(this,Zo,"m",VC).call(this,o);if(a.controller.signal?.aborted)throw new Wr;return Yi(this,Zo,"m",kC).call(this)}[(xp=new WeakMap,Qi=new WeakMap,Dp=new WeakMap,Zo=new WeakSet,LC=function(){this.ended||Xo(this,Qi,void 0,"f")},VC=function(r){if(this.ended)return;const n=Yi(this,Zo,"m",HC).call(this,r);switch(this._emit("event",r),r.type){case"response.output_text.delta":{const i=n.output[r.output_index];if(!i)throw new ve(`missing output at index ${r.output_index}`);if(i.type==="message"){const a=i.content[r.content_index];if(!a)throw new ve(`missing content at index ${r.content_index}`);if(a.type!=="output_text")throw new ve(`expected content to be 'output_text', got ${a.type}`);this._emit("response.output_text.delta",{...r,snapshot:a.text})}break}case"response.function_call_arguments.delta":{const i=n.output[r.output_index];if(!i)throw new ve(`missing output at index ${r.output_index}`);i.type==="function_call"&&this._emit("response.function_call_arguments.delta",{...r,snapshot:i.arguments});break}default:this._emit(r.type,r);break}},kC=function(){if(this.ended)throw new ve("stream has ended, this shouldn't happen");const r=Yi(this,Qi,"f");if(!r)throw new ve("request ended without sending any events");Xo(this,Qi,void 0,"f");const n=q2(r,Yi(this,xp,"f"));return Xo(this,Dp,n,"f"),n},HC=function(r){let n=Yi(this,Qi,"f");if(!n){if(r.type!=="response.created")throw new ve(`When snapshot hasn't been set yet, expected 'response.created' event, got ${r.type}`);return n=Xo(this,Qi,r.response,"f"),n}switch(r.type){case"response.output_item.added":{n.output.push(r.item);break}case"response.content_part.added":{const i=n.output[r.output_index];if(!i)throw new ve(`missing output at index ${r.output_index}`);i.type==="message"&&i.content.push(r.part);break}case"response.output_text.delta":{const i=n.output[r.output_index];if(!i)throw new ve(`missing output at index ${r.output_index}`);if(i.type==="message"){const a=i.content[r.content_index];if(!a)throw new ve(`missing content at index ${r.content_index}`);if(a.type!=="output_text")throw new ve(`expected content to be 'output_text', got ${a.type}`);a.text+=r.delta}break}case"response.function_call_arguments.delta":{const i=n.output[r.output_index];if(!i)throw new ve(`missing output at index ${r.output_index}`);i.type==="function_call"&&(i.arguments+=r.delta);break}case"response.completed":{Xo(this,Qi,r.response,"f");break}}return n},Symbol.asyncIterator)](){const e=[],r=[];let n=!1;return this.on("event",i=>{const a=r.shift();a?a.resolve(i):e.push(i)}),this.on("end",()=>{n=!0;for(const i of r)i.resolve(void 0);r.length=0}),this.on("abort",i=>{n=!0;for(const a of r)a.reject(i);r.length=0}),this.on("error",i=>{n=!0;for(const a of r)a.reject(i);r.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:n?{value:void 0,done:!0}:new Promise((a,o)=>r.push({resolve:a,reject:o})).then(a=>a?{value:a,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}async finalResponse(){await this.done();const e=Yi(this,Dp,"f");if(!e)throw new ve("stream ended without producing a ChatCompletion");return e}}function q2(t,e){return U2(t,e)}class cb extends We{constructor(){super(...arguments),this.inputItems=new NE(this._client)}create(e,r){return this._client.post("/responses",{body:e,...r,stream:e.stream??!1})._thenUnwrap(n=>("object"in n&&n.object==="response"&&sx(n),n))}retrieve(e,r={},n){return Kt(r)?this.retrieve(e,{},r):this._client.get(`/responses/${e}`,{query:r,...n})}del(e,r){return this._client.delete(`/responses/${e}`,{...r,headers:{Accept:"*/*",...r?.headers}})}parse(e,r){return this._client.responses.create(e,r)._thenUnwrap(n=>ox(n,e))}stream(e,r){return BE.createResponse(this._client,e,r)}}cb.InputItems=NE;cb.ResponseItemListDataPage=zE;class ux extends We{create(e,r,n){return this._client.post(`/uploads/${e}/parts`,_u({body:r,...n}))}}class UE extends We{constructor(){super(...arguments),this.parts=new ux(this._client)}create(e,r){return this._client.post("/uploads",{body:e,...r})}cancel(e,r){return this._client.post(`/uploads/${e}/cancel`,r)}complete(e,r,n){return this._client.post(`/uploads/${e}/complete`,{body:r,...n})}}UE.Parts=ux;const G2=async t=>{const e=await Promise.allSettled(t),r=e.filter(i=>i.status==="rejected");if(r.length){for(const i of r)console.error(i.reason);throw new Error(`${r.length} promise(s) failed - see the above errors`)}const n=[];for(const i of e)i.status==="fulfilled"&&n.push(i.value);return n};class db extends We{create(e,r,n){return this._client.post(`/vector_stores/${e}/files`,{body:r,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}retrieve(e,r,n){return this._client.get(`/vector_stores/${e}/files/${r}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}update(e,r,n,i){return this._client.post(`/vector_stores/${e}/files/${r}`,{body:n,...i,headers:{"OpenAI-Beta":"assistants=v2",...i?.headers}})}list(e,r={},n){return Kt(r)?this.list(e,{},r):this._client.getAPIList(`/vector_stores/${e}/files`,fb,{query:r,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}del(e,r,n){return this._client.delete(`/vector_stores/${e}/files/${r}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}async createAndPoll(e,r,n){const i=await this.create(e,r,n);return await this.poll(e,i.id,n)}async poll(e,r,n){const i={...n?.headers,"X-Stainless-Poll-Helper":"true"};for(n?.pollIntervalMs&&(i["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const a=await this.retrieve(e,r,{...n,headers:i}).withResponse(),o=a.data;switch(o.status){case"in_progress":let s=5e3;if(n?.pollIntervalMs)s=n.pollIntervalMs;else{const l=a.response.headers.get("openai-poll-after-ms");if(l){const c=parseInt(l);isNaN(c)||(s=c)}}await nd(s);break;case"failed":case"completed":return o}}}async upload(e,r,n){const i=await this._client.files.create({file:r,purpose:"assistants"},n);return this.create(e,{file_id:i.id},n)}async uploadAndPoll(e,r,n){const i=await this.upload(e,r,n);return await this.poll(e,i.id,n)}content(e,r,n){return this._client.getAPIList(`/vector_stores/${e}/files/${r}/content`,FE,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}}class fb extends $r{}class FE extends pE{}db.VectorStoreFilesPage=fb;db.FileContentResponsesPage=FE;class lx extends We{create(e,r,n){return this._client.post(`/vector_stores/${e}/file_batches`,{body:r,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}retrieve(e,r,n){return this._client.get(`/vector_stores/${e}/file_batches/${r}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}cancel(e,r,n){return this._client.post(`/vector_stores/${e}/file_batches/${r}/cancel`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}async createAndPoll(e,r,n){const i=await this.create(e,r);return await this.poll(e,i.id,n)}listFiles(e,r,n={},i){return Kt(n)?this.listFiles(e,r,{},n):this._client.getAPIList(`/vector_stores/${e}/file_batches/${r}/files`,fb,{query:n,...i,headers:{"OpenAI-Beta":"assistants=v2",...i?.headers}})}async poll(e,r,n){const i={...n?.headers,"X-Stainless-Poll-Helper":"true"};for(n?.pollIntervalMs&&(i["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const{data:a,response:o}=await this.retrieve(e,r,{...n,headers:i}).withResponse();switch(a.status){case"in_progress":let s=5e3;if(n?.pollIntervalMs)s=n.pollIntervalMs;else{const l=o.headers.get("openai-poll-after-ms");if(l){const c=parseInt(l);isNaN(c)||(s=c)}}await nd(s);break;case"failed":case"cancelled":case"completed":return a}}}async uploadAndPoll(e,{files:r,fileIds:n=[]},i){if(r==null||r.length==0)throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");const a=i?.maxConcurrency??5,o=Math.min(a,r.length),s=this._client,l=r.values(),c=[...n];async function d(h){for(let p of h){const b=await s.files.create({file:p,purpose:"assistants"},i);c.push(b.id)}}const f=Array(o).fill(l).map(d);return await G2(f),await this.createAndPoll(e,{file_ids:c})}}class $a extends We{constructor(){super(...arguments),this.files=new db(this._client),this.fileBatches=new lx(this._client)}create(e,r){return this._client.post("/vector_stores",{body:e,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}retrieve(e,r){return this._client.get(`/vector_stores/${e}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}update(e,r,n){return this._client.post(`/vector_stores/${e}`,{body:r,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}list(e={},r){return Kt(e)?this.list({},e):this._client.getAPIList("/vector_stores",LE,{query:e,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}del(e,r){return this._client.delete(`/vector_stores/${e}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}search(e,r,n){return this._client.getAPIList(`/vector_stores/${e}/search`,VE,{body:r,method:"post",...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}}class LE extends $r{}class VE extends pE{}$a.VectorStoresPage=LE;$a.VectorStoreSearchResponsesPage=VE;$a.Files=db;$a.VectorStoreFilesPage=fb;$a.FileContentResponsesPage=FE;$a.FileBatches=lx;var W2={},cx;let De=class extends f2{constructor({baseURL:e=uo("OPENAI_BASE_URL"),apiKey:r=uo("OPENAI_API_KEY"),organization:n=uo("OPENAI_ORG_ID")??null,project:i=uo("OPENAI_PROJECT_ID")??null,...a}={}){if(r===void 0)throw new ve("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");const o={apiKey:r,organization:n,project:i,...a,baseURL:e||"https://api.openai.com/v1"};if(!o.dangerouslyAllowBrowser&&S2())throw new ve(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new OpenAI({ apiKey, dangerouslyAllowBrowser: true });

https://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety
`);super({baseURL:o.baseURL,timeout:o.timeout??6e5,httpAgent:o.httpAgent,maxRetries:o.maxRetries,fetch:o.fetch}),this.completions=new rx(this),this.chat=new lb(this),this.embeddings=new nx(this),this.files=new ME(this),this.images=new ix(this),this.audio=new id(this),this.moderations=new ax(this),this.models=new xE(this),this.fineTuning=new sd(this),this.vectorStores=new $a(this),this.beta=new Du(this),this.batches=new _E(this),this.uploads=new UE(this),this.responses=new cb(this),this._options=o,this.apiKey=r,this.organization=n,this.project=i}defaultQuery(){return this._options.defaultQuery}defaultHeaders(e){return{...super.defaultHeaders(e),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project,...this._options.defaultHeaders}}authHeaders(e){return{Authorization:`Bearer ${this.apiKey}`}}stringifyQuery(e){return Kk(e,{arrayFormat:"brackets"})}};cx=De;De.OpenAI=cx;De.DEFAULT_TIMEOUT=6e5;De.OpenAIError=ve;De.APIError=Ar;De.APIConnectionError=nb;De.APIConnectionTimeoutError=ib;De.APIUserAbortError=Wr;De.NotFoundError=fI;De.ConflictError=hI;De.RateLimitError=_I;De.BadRequestError=lI;De.AuthenticationError=cI;De.InternalServerError=yI;De.PermissionDeniedError=dI;De.UnprocessableEntityError=pI;De.toFile=OI;De.fileFromPath=sI;De.Completions=rx;De.Chat=lb;De.ChatCompletionsPage=ub;De.Embeddings=nx;De.Files=ME;De.FileObjectsPage=TE;De.Images=ix;De.Audio=id;De.Moderations=ax;De.Models=xE;De.ModelsPage=DE;De.FineTuning=sd;De.VectorStores=$a;De.VectorStoresPage=LE;De.VectorStoreSearchResponsesPage=VE;De.Beta=Du;De.Batches=_E;De.BatchesPage=yE;De.Uploads=UE;De.Responses=cb;let dx=class extends De{constructor({baseURL:e=uo("OPENAI_BASE_URL"),apiKey:r=uo("AZURE_OPENAI_API_KEY"),apiVersion:n=uo("OPENAI_API_VERSION"),endpoint:i,deployment:a,azureADTokenProvider:o,dangerouslyAllowBrowser:s,...l}={}){if(!n)throw new ve("The OPENAI_API_VERSION environment variable is missing or empty; either provide it, or instantiate the AzureOpenAI client with an apiVersion option, like new AzureOpenAI({ apiVersion: 'My API Version' }).");if(typeof o=="function"&&(s=!0),!o&&!r)throw new ve("Missing credentials. Please pass one of `apiKey` and `azureADTokenProvider`, or set the `AZURE_OPENAI_API_KEY` environment variable.");if(o&&r)throw new ve("The `apiKey` and `azureADTokenProvider` arguments are mutually exclusive; only one can be passed at a time.");if(r??(r=qC),l.defaultQuery={...l.defaultQuery,"api-version":n},e){if(i)throw new ve("baseURL and endpoint are mutually exclusive")}else{if(i||(i=W2.AZURE_OPENAI_ENDPOINT),!i)throw new ve("Must provide one of the `baseURL` or `endpoint` arguments, or the `AZURE_OPENAI_ENDPOINT` environment variable");e=`${i}/openai`}super({apiKey:r,baseURL:e,...l,...s!==void 0?{dangerouslyAllowBrowser:s}:{}}),this.apiVersion="",this._azureADTokenProvider=o,this.apiVersion=n,this.deploymentName=a}buildRequest(e,r={}){if(K2.has(e.path)&&e.method==="post"&&e.body!==void 0){if(!N_(e.body))throw new Error("Expected request body to be an object");const n=this.deploymentName||e.body.model||e.__metadata?.model;n!==void 0&&!this.baseURL.includes("/deployments")&&(e.path=`/deployments/${n}${e.path}`)}return super.buildRequest(e,r)}async _getAzureADToken(){if(typeof this._azureADTokenProvider=="function"){const e=await this._azureADTokenProvider();if(!e||typeof e!="string")throw new ve(`Expected 'azureADTokenProvider' argument to return a string but it returned ${e}`);return e}}authHeaders(e){return{}}async prepareOptions(e){if(e.headers?.["api-key"])return super.prepareOptions(e);const r=await this._getAzureADToken();if(e.headers??(e.headers={}),r)e.headers.Authorization=`Bearer ${r}`;else if(this.apiKey!==qC)e.headers["api-key"]=this.apiKey;else throw new ve("Unable to handle auth");return super.prepareOptions(e)}};const K2=new Set(["/completions","/chat/completions","/embeddings","/audio/transcriptions","/audio/translations","/audio/speech","/images/generations"]),qC="<Missing Key>";/*
 * [js-sha1]{@link https://github.com/emn178/js-sha1}
 *
 * @version 0.6.0
 * @author Chen, Yi-Cyuan [emn178@gmail.com]
 * @copyright Chen, Yi-Cyuan 2014-2017
 * @license MIT
 */var J2=typeof window=="object"?window:{},ze="0123456789abcdef".split(""),X2=[-2147483648,8388608,32768,128],wn=[24,16,8,0],Vt=[];function Bn(t){t?(Vt[0]=Vt[16]=Vt[1]=Vt[2]=Vt[3]=Vt[4]=Vt[5]=Vt[6]=Vt[7]=Vt[8]=Vt[9]=Vt[10]=Vt[11]=Vt[12]=Vt[13]=Vt[14]=Vt[15]=0,this.blocks=Vt):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.h0=1732584193,this.h1=4023233417,this.h2=2562383102,this.h3=271733878,this.h4=3285377520,this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0}Bn.prototype.update=function(t){if(!this.finalized){var e=typeof t!="string";e&&t.constructor===J2.ArrayBuffer&&(t=new Uint8Array(t));for(var r,n=0,i,a=t.length||0,o=this.blocks;n<a;){if(this.hashed&&(this.hashed=!1,o[0]=this.block,o[16]=o[1]=o[2]=o[3]=o[4]=o[5]=o[6]=o[7]=o[8]=o[9]=o[10]=o[11]=o[12]=o[13]=o[14]=o[15]=0),e)for(i=this.start;n<a&&i<64;++n)o[i>>2]|=t[n]<<wn[i++&3];else for(i=this.start;n<a&&i<64;++n)r=t.charCodeAt(n),r<128?o[i>>2]|=r<<wn[i++&3]:r<2048?(o[i>>2]|=(192|r>>6)<<wn[i++&3],o[i>>2]|=(128|r&63)<<wn[i++&3]):r<55296||r>=57344?(o[i>>2]|=(224|r>>12)<<wn[i++&3],o[i>>2]|=(128|r>>6&63)<<wn[i++&3],o[i>>2]|=(128|r&63)<<wn[i++&3]):(r=65536+((r&1023)<<10|t.charCodeAt(++n)&1023),o[i>>2]|=(240|r>>18)<<wn[i++&3],o[i>>2]|=(128|r>>12&63)<<wn[i++&3],o[i>>2]|=(128|r>>6&63)<<wn[i++&3],o[i>>2]|=(128|r&63)<<wn[i++&3]);this.lastByteIndex=i,this.bytes+=i-this.start,i>=64?(this.block=o[16],this.start=i-64,this.hash(),this.hashed=!0):this.start=i}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}};Bn.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var t=this.blocks,e=this.lastByteIndex;t[16]=this.block,t[e>>2]|=X2[e&3],this.block=t[16],e>=56&&(this.hashed||this.hash(),t[0]=this.block,t[16]=t[1]=t[2]=t[3]=t[4]=t[5]=t[6]=t[7]=t[8]=t[9]=t[10]=t[11]=t[12]=t[13]=t[14]=t[15]=0),t[14]=this.hBytes<<3|this.bytes>>>29,t[15]=this.bytes<<3,this.hash()}};Bn.prototype.hash=function(){var t=this.h0,e=this.h1,r=this.h2,n=this.h3,i=this.h4,a,o,s,l=this.blocks;for(o=16;o<80;++o)s=l[o-3]^l[o-8]^l[o-14]^l[o-16],l[o]=s<<1|s>>>31;for(o=0;o<20;o+=5)a=e&r|~e&n,s=t<<5|t>>>27,i=s+a+i+1518500249+l[o]<<0,e=e<<30|e>>>2,a=t&e|~t&r,s=i<<5|i>>>27,n=s+a+n+1518500249+l[o+1]<<0,t=t<<30|t>>>2,a=i&t|~i&e,s=n<<5|n>>>27,r=s+a+r+1518500249+l[o+2]<<0,i=i<<30|i>>>2,a=n&i|~n&t,s=r<<5|r>>>27,e=s+a+e+1518500249+l[o+3]<<0,n=n<<30|n>>>2,a=r&n|~r&i,s=e<<5|e>>>27,t=s+a+t+1518500249+l[o+4]<<0,r=r<<30|r>>>2;for(;o<40;o+=5)a=e^r^n,s=t<<5|t>>>27,i=s+a+i+1859775393+l[o]<<0,e=e<<30|e>>>2,a=t^e^r,s=i<<5|i>>>27,n=s+a+n+1859775393+l[o+1]<<0,t=t<<30|t>>>2,a=i^t^e,s=n<<5|n>>>27,r=s+a+r+1859775393+l[o+2]<<0,i=i<<30|i>>>2,a=n^i^t,s=r<<5|r>>>27,e=s+a+e+1859775393+l[o+3]<<0,n=n<<30|n>>>2,a=r^n^i,s=e<<5|e>>>27,t=s+a+t+1859775393+l[o+4]<<0,r=r<<30|r>>>2;for(;o<60;o+=5)a=e&r|e&n|r&n,s=t<<5|t>>>27,i=s+a+i-1894007588+l[o]<<0,e=e<<30|e>>>2,a=t&e|t&r|e&r,s=i<<5|i>>>27,n=s+a+n-1894007588+l[o+1]<<0,t=t<<30|t>>>2,a=i&t|i&e|t&e,s=n<<5|n>>>27,r=s+a+r-1894007588+l[o+2]<<0,i=i<<30|i>>>2,a=n&i|n&t|i&t,s=r<<5|r>>>27,e=s+a+e-1894007588+l[o+3]<<0,n=n<<30|n>>>2,a=r&n|r&i|n&i,s=e<<5|e>>>27,t=s+a+t-1894007588+l[o+4]<<0,r=r<<30|r>>>2;for(;o<80;o+=5)a=e^r^n,s=t<<5|t>>>27,i=s+a+i-899497514+l[o]<<0,e=e<<30|e>>>2,a=t^e^r,s=i<<5|i>>>27,n=s+a+n-899497514+l[o+1]<<0,t=t<<30|t>>>2,a=i^t^e,s=n<<5|n>>>27,r=s+a+r-899497514+l[o+2]<<0,i=i<<30|i>>>2,a=n^i^t,s=r<<5|r>>>27,e=s+a+e-899497514+l[o+3]<<0,n=n<<30|n>>>2,a=r^n^i,s=e<<5|e>>>27,t=s+a+t-899497514+l[o+4]<<0,r=r<<30|r>>>2;this.h0=this.h0+t<<0,this.h1=this.h1+e<<0,this.h2=this.h2+r<<0,this.h3=this.h3+n<<0,this.h4=this.h4+i<<0};Bn.prototype.hex=function(){this.finalize();var t=this.h0,e=this.h1,r=this.h2,n=this.h3,i=this.h4;return ze[t>>28&15]+ze[t>>24&15]+ze[t>>20&15]+ze[t>>16&15]+ze[t>>12&15]+ze[t>>8&15]+ze[t>>4&15]+ze[t&15]+ze[e>>28&15]+ze[e>>24&15]+ze[e>>20&15]+ze[e>>16&15]+ze[e>>12&15]+ze[e>>8&15]+ze[e>>4&15]+ze[e&15]+ze[r>>28&15]+ze[r>>24&15]+ze[r>>20&15]+ze[r>>16&15]+ze[r>>12&15]+ze[r>>8&15]+ze[r>>4&15]+ze[r&15]+ze[n>>28&15]+ze[n>>24&15]+ze[n>>20&15]+ze[n>>16&15]+ze[n>>12&15]+ze[n>>8&15]+ze[n>>4&15]+ze[n&15]+ze[i>>28&15]+ze[i>>24&15]+ze[i>>20&15]+ze[i>>16&15]+ze[i>>12&15]+ze[i>>8&15]+ze[i>>4&15]+ze[i&15]};Bn.prototype.toString=Bn.prototype.hex;Bn.prototype.digest=function(){this.finalize();var t=this.h0,e=this.h1,r=this.h2,n=this.h3,i=this.h4;return[t>>24&255,t>>16&255,t>>8&255,t&255,e>>24&255,e>>16&255,e>>8&255,e&255,r>>24&255,r>>16&255,r>>8&255,r&255,n>>24&255,n>>16&255,n>>8&255,n&255,i>>24&255,i>>16&255,i>>8&255,i&255]};Bn.prototype.array=Bn.prototype.digest;Bn.prototype.arrayBuffer=function(){this.finalize();var t=new ArrayBuffer(20),e=new DataView(t);return e.setUint32(0,this.h0),e.setUint32(4,this.h1),e.setUint32(8,this.h2),e.setUint32(12,this.h3),e.setUint32(16,this.h4),t};const Z2=t=>new Bn(!0).update(t).hex(),GC=(...t)=>Z2(t.join("_"));class Y2{}const Q2=new Map;class kE extends Y2{constructor(e){super(),Object.defineProperty(this,"cache",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.cache=e??new Map}lookup(e,r){return Promise.resolve(this.cache.get(GC(e,r))??null)}async update(e,r,n){this.cache.set(GC(e,r),n)}static global(){return new kE(Q2)}}const eH=t=>t.startsWith("gpt-3.5-turbo-16k")?"gpt-3.5-turbo-16k":t.startsWith("gpt-3.5-turbo-")?"gpt-3.5-turbo":t.startsWith("gpt-4-32k")?"gpt-4-32k":t.startsWith("gpt-4-")?"gpt-4":t.startsWith("gpt-4o")?"gpt-4o":t;function ud(t){return typeof t!="object"||!t?!1:!!("type"in t&&t.type==="function"&&"function"in t&&typeof t.function=="object"&&t.function&&"name"in t.function&&"parameters"in t.function)}const tH=()=>!1;class rH extends Tt{get lc_attributes(){return{callbacks:void 0,verbose:void 0}}constructor(e){super(e),Object.defineProperty(this,"verbose",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"callbacks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.verbose=e.verbose??tH(),this.callbacks=e.callbacks,this.tags=e.tags??[],this.metadata=e.metadata??{}}}class fx extends rH{get callKeys(){return["stop","timeout","signal","tags","metadata","callbacks"]}constructor({callbacks:e,callbackManager:r,...n}){const{cache:i,...a}=n;super({callbacks:e??r,...a}),Object.defineProperty(this,"caller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cache",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_encoding",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),typeof i=="object"?this.cache=i:i?this.cache=kE.global():this.cache=void 0,this.caller=new Qc(n??{})}async getNumTokens(e){if(typeof e!="string")return 0;let r=Math.ceil(e.length/4);if(!this._encoding)try{this._encoding=await xk("modelName"in this?eH(this.modelName):"gpt2")}catch(n){console.warn("Failed to calculate number of tokens, falling back to approximate count",n)}if(this._encoding)try{r=this._encoding.encode(e).length}catch(n){console.warn("Failed to calculate number of tokens, falling back to approximate count",n)}return r}static _convertInputToPromptValue(e){return typeof e=="string"?new q1(e):Array.isArray(e)?new G1(e.map(ya)):e}_identifyingParams(){return{}}_getSerializedCacheKeyParametersForCall({config:e,...r}){const n={...this._identifyingParams(),...r,_type:this._llmType(),_model:this._modelType()};return Object.entries(n).filter(([o,s])=>s!==void 0).map(([o,s])=>`${o}:${JSON.stringify(s)}`).sort().join(",")}serialize(){return{...this._identifyingParams(),_type:this._llmType(),_model:this._modelType()}}static async deserialize(e){throw new Error("Use .toJSON() instead")}}function yu(t){return typeof t?.parse=="function"}class un extends fx{constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","chat_models",this._llmType()]}),Object.defineProperty(this,"disableStreaming",{enumerable:!0,configurable:!0,writable:!0,value:!1})}_separateRunnableConfigFromCallOptionsCompat(e){const[r,n]=super._separateRunnableConfigFromCallOptions(e);return n.signal=r.signal,[r,n]}async invoke(e,r){const n=un._convertInputToPromptValue(e);return(await this.generatePrompt([n],r,r?.callbacks)).generations[0][0].message}async*_streamResponseChunks(e,r,n){throw new Error("Not implemented.")}async*_streamIterator(e,r){if(this._streamResponseChunks===un.prototype._streamResponseChunks||this.disableStreaming)yield this.invoke(e,r);else{const i=un._convertInputToPromptValue(e).toChatMessages(),[a,o]=this._separateRunnableConfigFromCallOptionsCompat(r),s={...a.metadata,...this.getLsParams(o)},l=await Wt.configure(a.callbacks,this.callbacks,a.tags,this.tags,s,this.metadata,{verbose:this.verbose}),c={options:o,invocation_params:this?.invocationParams(o),batch_size:1},d=await l?.handleChatModelStart(this.toJSON(),[i],a.runId,void 0,c,void 0,void 0,a.runName);let f,h;try{for await(const p of this._streamResponseChunks(i,o,d?.[0])){if(p.message.id==null){const b=d?.at(0)?.runId;b!=null&&p.message._updateId(`run-${b}`)}p.message.response_metadata={...p.generationInfo,...p.message.response_metadata},yield p.message,f?f=f.concat(p):f=p,xj(p.message)&&p.message.usage_metadata!==void 0&&(h={tokenUsage:{promptTokens:p.message.usage_metadata.input_tokens,completionTokens:p.message.usage_metadata.output_tokens,totalTokens:p.message.usage_metadata.total_tokens}})}}catch(p){throw await Promise.all((d??[]).map(b=>b?.handleLLMError(p))),p}await Promise.all((d??[]).map(p=>p?.handleLLMEnd({generations:[[f]],llmOutput:h})))}}getLsParams(e){const r=this.getName().startsWith("Chat")?this.getName().replace("Chat",""):this.getName();return{ls_model_type:"chat",ls_stop:e.stop,ls_provider:r}}async _generateUncached(e,r,n,i){const a=e.map(f=>f.map(ya));let o;if(i!==void 0&&i.length===a.length)o=i;else{const f={...n.metadata,...this.getLsParams(r)},h=await Wt.configure(n.callbacks,this.callbacks,n.tags,this.tags,f,this.metadata,{verbose:this.verbose}),p={options:r,invocation_params:this?.invocationParams(r),batch_size:1};o=await h?.handleChatModelStart(this.toJSON(),a,n.runId,void 0,p,void 0,void 0,n.runName)}const s=[],l=[];if(!!o?.[0].handlers.find(v$)&&!this.disableStreaming&&a.length===1&&this._streamResponseChunks!==un.prototype._streamResponseChunks)try{const f=await this._streamResponseChunks(a[0],r,o?.[0]);let h,p;for await(const b of f){if(b.message.id==null){const g=o?.at(0)?.runId;g!=null&&b.message._updateId(`run-${g}`)}h===void 0?h=b:h=pn(h,b),xj(b.message)&&b.message.usage_metadata!==void 0&&(p={tokenUsage:{promptTokens:b.message.usage_metadata.input_tokens,completionTokens:b.message.usage_metadata.output_tokens,totalTokens:b.message.usage_metadata.total_tokens}})}if(h===void 0)throw new Error("Received empty response from chat model call.");s.push([h]),await o?.[0].handleLLMEnd({generations:s,llmOutput:p})}catch(f){throw await o?.[0].handleLLMError(f),f}else{const f=await Promise.allSettled(a.map((h,p)=>this._generate(h,{...r,promptIndex:p},o?.[p])));await Promise.all(f.map(async(h,p)=>{if(h.status==="fulfilled"){const b=h.value;for(const g of b.generations){if(g.message.id==null){const v=o?.at(0)?.runId;v!=null&&g.message._updateId(`run-${v}`)}g.message.response_metadata={...g.generationInfo,...g.message.response_metadata}}return b.generations.length===1&&(b.generations[0].message.response_metadata={...b.llmOutput,...b.generations[0].message.response_metadata}),s[p]=b.generations,l[p]=b.llmOutput,o?.[p]?.handleLLMEnd({generations:[b.generations],llmOutput:b.llmOutput})}else return await o?.[p]?.handleLLMError(h.reason),Promise.reject(h.reason)}))}const d={generations:s,llmOutput:l.length?this._combineLLMOutput?.(...l):void 0};return Object.defineProperty(d,hy,{value:o?{runIds:o?.map(f=>f.runId)}:void 0,configurable:!0}),d}async _generateCached({messages:e,cache:r,llmStringKey:n,parsedOptions:i,handledOptions:a}){const o=e.map(v=>v.map(ya)),s={...a.metadata,...this.getLsParams(i)},l=await Wt.configure(a.callbacks,this.callbacks,a.tags,this.tags,s,this.metadata,{verbose:this.verbose}),c={options:i,invocation_params:this?.invocationParams(i),batch_size:1},d=await l?.handleChatModelStart(this.toJSON(),o,a.runId,void 0,c,void 0,void 0,a.runName),f=[],p=(await Promise.allSettled(o.map(async(v,E)=>{const C=un._convertInputToPromptValue(v).toString(),S=await r.lookup(C,n);return S==null&&f.push(E),S}))).map((v,E)=>({result:v,runManager:d?.[E]})).filter(({result:v})=>v.status==="fulfilled"&&v.value!=null||v.status==="rejected"),b=[];await Promise.all(p.map(async({result:v,runManager:E},C)=>{if(v.status==="fulfilled"){const S=v.value;return b[C]=S.map(N=>("message"in N&&Mu(N.message)&&ii(N.message)&&(N.message.usage_metadata={input_tokens:0,output_tokens:0,total_tokens:0}),N.generationInfo={...N.generationInfo,tokenUsage:{}},N)),S.length&&await E?.handleLLMNewToken(S[0].text),E?.handleLLMEnd({generations:[S]},void 0,void 0,void 0,{cached:!0})}else return await E?.handleLLMError(v.reason,void 0,void 0,void 0,{cached:!0}),Promise.reject(v.reason)}));const g={generations:b,missingPromptIndices:f,startedRunManagers:d};return Object.defineProperty(g,hy,{value:d?{runIds:d?.map(v=>v.runId)}:void 0,configurable:!0}),g}async generate(e,r,n){let i;Array.isArray(r)?i={stop:r}:i=r;const a=e.map(b=>b.map(ya)),[o,s]=this._separateRunnableConfigFromCallOptionsCompat(i);if(o.callbacks=o.callbacks??n,!this.cache)return this._generateUncached(a,s,o);const{cache:l}=this,c=this._getSerializedCacheKeyParametersForCall(s),{generations:d,missingPromptIndices:f,startedRunManagers:h}=await this._generateCached({messages:a,cache:l,llmStringKey:c,parsedOptions:s,handledOptions:o});let p={};if(f.length>0){const b=await this._generateUncached(f.map(g=>a[g]),s,o,h!==void 0?f.map(g=>h?.[g]):void 0);await Promise.all(b.generations.map(async(g,v)=>{const E=f[v];d[E]=g;const C=un._convertInputToPromptValue(a[E]).toString();return l.update(C,c,g)})),p=b.llmOutput??{}}return{generations:d,llmOutput:p}}invocationParams(e){return{}}_modelType(){return"base_chat_model"}serialize(){return{...this.invocationParams(),_type:this._llmType(),_model:this._modelType()}}async generatePrompt(e,r,n){const i=e.map(a=>a.toChatMessages());return this.generate(i,r,n)}async call(e,r,n){return(await this.generate([e.map(ya)],r,n)).generations[0][0].message}async callPrompt(e,r,n){const i=e.toChatMessages();return this.call(i,r,n)}async predictMessages(e,r,n){return this.call(e,r,n)}async predict(e,r,n){const i=new Pa(e),a=await this.call([i],r,n);if(typeof a.content!="string")throw new Error("Cannot use predict when output is not a string.");return a.content}withStructuredOutput(e,r){if(typeof this.bindTools!="function")throw new Error('Chat model must implement ".bindTools()" to use withStructuredOutput.');if(r?.strict)throw new Error('"strict" mode is not supported for this model by default.');const n=e,i=r?.name,a=n.description??"A function available to call.",o=r?.method,s=r?.includeRaw;if(o==="jsonMode")throw new Error('Base withStructuredOutput implementation only supports "functionCalling" as a method.');let l=i??"extract",c;yu(n)?c=[{type:"function",function:{name:l,description:a,parameters:ui(n)}}]:("name"in n&&(l=n.name),c=[{type:"function",function:{name:l,description:a,parameters:n}}]);const d=this.bindTools(c),f=ed.from(g=>{if(!g.tool_calls||g.tool_calls.length===0)throw new Error("No tool calls found in the response.");const v=g.tool_calls.find(E=>E.name===l);if(!v)throw new Error(`No tool call found with name ${l}.`);return v.args});if(!s)return d.pipe(f).withConfig({runName:"StructuredOutput"});const h=li.assign({parsed:(g,v)=>f.invoke(g.raw,v)}),p=li.assign({parsed:()=>null}),b=h.withFallbacks({fallbacks:[p]});return Gr.from([{raw:d},b]).withConfig({runName:"StructuredOutputRunnable"})}}class HE extends Tt{parseResultWithPrompt(e,r,n){return this.parseResult(e,n)}_baseMessageToString(e){return typeof e.content=="string"?e.content:this._baseMessageContentToString(e.content)}_baseMessageContentToString(e){return JSON.stringify(e)}async invoke(e,r){return typeof e=="string"?this._callWithConfig(async(n,i)=>this.parseResult([{text:n}],i?.callbacks),e,{...r,runType:"parser"}):this._callWithConfig(async(n,i)=>this.parseResult([{message:n,text:this._baseMessageToString(n)}],i?.callbacks),e,{...r,runType:"parser"})}}class hx extends HE{parseResult(e,r){return this.parse(e[0].text,r)}async parseWithPrompt(e,r,n){return this.parse(e,n)}_type(){throw new Error("_type not implemented")}}class bu extends Error{constructor(e,r,n,i=!1){if(super(e),Object.defineProperty(this,"llmOutput",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"observation",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"sendToLLM",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.llmOutput=r,this.observation=n,this.sendToLLM=i,i&&(n===void 0||r===void 0))throw new Error("Arguments 'observation' & 'llmOutput' are required if 'sendToLlm' is true");Gy(this,"OUTPUT_PARSING_FAILURE")}}function ZO(t,e){const r=typeof t;if(r!==typeof e)return!1;if(Array.isArray(t)){if(!Array.isArray(e))return!1;const n=t.length;if(n!==e.length)return!1;for(let i=0;i<n;i++)if(!ZO(t[i],e[i]))return!1;return!0}if(r==="object"){if(!t||!e)return t===e;const n=Object.keys(t),i=Object.keys(e);if(n.length!==i.length)return!1;for(const o of n)if(!ZO(t[o],e[o]))return!1;return!0}return t===e}class nH extends hx{async*_transform(e){for await(const r of e)typeof r=="string"?yield this.parseResult([{text:r}]):yield this.parseResult([{message:r,text:this._baseMessageToString(r)}])}async*transform(e,r){yield*this._transformStreamWithConfig(e,this._transform.bind(this),{...r,runType:"parser"})}}class px extends nH{constructor(e){super(e),Object.defineProperty(this,"diff",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this.diff=e?.diff??this.diff}async*_transform(e){let r,n;for await(const i of e){if(typeof i!="string"&&typeof i.content!="string")throw new Error("Cannot handle non-string output.");let a;if(q4(i)){if(typeof i.content!="string")throw new Error("Cannot handle non-string message output.");a=new Mr({message:i,text:i.content})}else if(Mu(i)){if(typeof i.content!="string")throw new Error("Cannot handle non-string message output.");a=new Mr({message:X4(i),text:i.content})}else a=new Ui({text:i});n===void 0?n=a:n=n.concat(a);const o=await this.parsePartialResult([n]);o!=null&&!ZO(o,r)&&(this.diff?yield this._diff(r,o):yield o,r=o)}}getFormatInstructions(){return""}}class YO extends hx{static lc_name(){return"StructuredOutputParser"}toJSON(){return this.toJSONNotImplemented()}constructor(e){super(e),Object.defineProperty(this,"schema",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","structured"]})}static fromZodSchema(e){return new this(e)}static fromNamesAndDescriptions(e){const r=Ii.object(Object.fromEntries(Object.entries(e).map(([n,i])=>[n,Ii.string().describe(i)])));return new this(r)}getFormatInstructions(){return`You must format your output as a JSON value that adheres to a given "JSON Schema" instance.

"JSON Schema" is a declarative language that allows you to annotate and validate JSON documents.

For example, the example "JSON Schema" instance {{"properties": {{"foo": {{"description": "a list of test words", "type": "array", "items": {{"type": "string"}}}}}}, "required": ["foo"]}}}}
would match an object with one required property, "foo". The "type" property specifies "foo" must be an "array", and the "description" property semantically describes it as "a list of test words". The items within "foo" must be strings.
Thus, the object {{"foo": ["bar", "baz"]}} is a well-formatted instance of this example "JSON Schema". The object {{"properties": {{"foo": ["bar", "baz"]}}}} is not well-formatted.

Your output will be parsed and type-checked according to the provided schema instance, so make sure all fields in your output match the schema exactly and there are no trailing commas!

Here is the JSON Schema instance your output must adhere to. Include the enclosing markdown codeblock:
\`\`\`json
${JSON.stringify(ui(this.schema))}
\`\`\`
`}async parse(e){try{const n=(e.includes("```")?e.trim().split(/```(?:json)?/)[1]:e.trim()).replace(/"([^"\\]*(\\.[^"\\]*)*)"/g,(i,a)=>`"${a.replace(/\n/g,"\\n")}"`).replace(/\n/g,"");return await this.schema.parseAsync(JSON.parse(n))}catch(r){throw new bu(`Failed to parse. Text: "${e}". Error: ${r}`,e)}}}class QO extends px{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","output_parsers"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0})}static lc_name(){return"JsonOutputParser"}_diff(e,r){if(r)return e?w8(e,r):[{op:"replace",path:"",value:r}]}async parsePartialResult(e){return Ij(e[0].text)}async parse(e){return Ij(e,JSON.parse)}getFormatInstructions(){return""}}function qE(t,e){if(t.function===void 0)return;let r;if(e?.partial)try{r=qS(t.function.arguments??"{}")}catch{return}else try{r=JSON.parse(t.function.arguments)}catch(i){throw new bu([`Function "${t.function.name}" arguments:`,"",t.function.arguments,"","are not valid JSON.",`Error: ${i.message}`].join(`
`))}const n={name:t.function.name,args:r,type:"tool_call"};return e?.returnId&&(n.id=t.id),n}function _x(t){if(t.id===void 0)throw new Error('All OpenAI tool calls must have an "id" field.');return{id:t.id,type:"function",function:{name:t.name,arguments:JSON.stringify(t.args)}}}function yx(t,e){return{name:t.function?.name,args:t.function?.arguments,id:t.id,error:e,type:"invalid_tool_call"}}class iH extends px{static lc_name(){return"JsonOutputToolsParser"}constructor(e){super(e),Object.defineProperty(this,"returnId",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","openai_tools"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),this.returnId=e?.returnId??this.returnId}_diff(){throw new Error("Not supported.")}async parse(){throw new Error("Not implemented.")}async parseResult(e){return await this.parsePartialResult(e,!1)}async parsePartialResult(e,r=!0){const n=e[0].message;let i;if(ii(n)&&n.tool_calls?.length?i=n.tool_calls.map(o=>{const{id:s,...l}=o;return this.returnId?{id:s,...l}:l}):n.additional_kwargs.tool_calls!==void 0&&(i=JSON.parse(JSON.stringify(n.additional_kwargs.tool_calls)).map(s=>qE(s,{returnId:this.returnId,partial:r}))),!i)return[];const a=[];for(const o of i)if(o!==void 0){const s={type:o.name,args:o.args,id:o.id};a.push(s)}return a}}class Oy extends iH{static lc_name(){return"JsonOutputKeyToolsParser"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","openai_tools"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"returnId",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"keyName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"returnSingle",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"zodSchema",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.keyName=e.keyName,this.returnSingle=e.returnSingle??this.returnSingle,this.zodSchema=e.zodSchema}async _validateResult(e){if(this.zodSchema===void 0)return e;const r=await this.zodSchema.safeParseAsync(e);if(r.success)return r.data;throw new bu(`Failed to parse. Text: "${JSON.stringify(e,null,2)}". Error: ${JSON.stringify(r.error.errors)}`,JSON.stringify(e,null,2))}async parsePartialResult(e){const n=(await super.parsePartialResult(e)).filter(a=>a.type===this.keyName);let i=n;if(n.length)return this.returnId||(i=n.map(a=>a.args)),this.returnSingle?i[0]:i}async parseResult(e){const n=(await super.parsePartialResult(e,!1)).filter(o=>o.type===this.keyName);let i=n;return n.length?(this.returnId||(i=n.map(o=>o.args)),this.returnSingle?this._validateResult(i[0]):await Promise.all(i.map(o=>this._validateResult(o)))):void 0}}const aH=Symbol("Let zodToJsonSchema decide on which parser to use"),WC={name:void 0,$refStrategy:"root",effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",nullableStrategy:"from-target",removeAdditionalStrategy:"passthrough",definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"},oH=t=>typeof t=="string"?{...WC,basePath:["#"],definitions:{},name:t}:{...WC,basePath:["#"],definitions:{},...t},eS=t=>"_def"in t?t._def:t;function sH(t){if(!t)return!0;for(const e in t)return!1;return!0}const uH=t=>{const e=oH(t),r=e.name!==void 0?[...e.basePath,e.definitionPath,e.name]:e.basePath;return{...e,currentPath:r,propertyPath:void 0,seenRefs:new Set,seen:new Map(Object.entries(e.definitions).map(([n,i])=>[eS(i),{def:eS(i),path:[...e.basePath,e.definitionPath,n],jsonSchema:void 0}]))}};function bx(t,e,r,n){n?.errorMessages&&r&&(t.errorMessage={...t.errorMessage,[e]:r})}function it(t,e,r,n,i){t[e]=r,bx(t,e,n,i)}function lH(){return{}}function cH(t,e){const r={type:"array"};return t.type?._def?.typeName!==B.ZodAny&&(r.items=Ze(t.type._def,{...e,currentPath:[...e.currentPath,"items"]})),t.minLength&&it(r,"minItems",t.minLength.value,t.minLength.message,e),t.maxLength&&it(r,"maxItems",t.maxLength.value,t.maxLength.message,e),t.exactLength&&(it(r,"minItems",t.exactLength.value,t.exactLength.message,e),it(r,"maxItems",t.exactLength.value,t.exactLength.message,e)),r}function dH(t,e){const r={type:"integer",format:"int64"};if(!t.checks)return r;for(const n of t.checks)switch(n.kind){case"min":e.target==="jsonSchema7"?n.inclusive?it(r,"minimum",n.value,n.message,e):it(r,"exclusiveMinimum",n.value,n.message,e):(n.inclusive||(r.exclusiveMinimum=!0),it(r,"minimum",n.value,n.message,e));break;case"max":e.target==="jsonSchema7"?n.inclusive?it(r,"maximum",n.value,n.message,e):it(r,"exclusiveMaximum",n.value,n.message,e):(n.inclusive||(r.exclusiveMaximum=!0),it(r,"maximum",n.value,n.message,e));break;case"multipleOf":it(r,"multipleOf",n.value,n.message,e);break}return r}function fH(){return{type:"boolean"}}function hH(t,e){return Ze(t.type._def,e)}const pH=(t,e)=>Ze(t.innerType._def,e);function gx(t,e,r){const n=r??e.dateStrategy;if(Array.isArray(n))return{anyOf:n.map((i,a)=>gx(t,e,i))};switch(n){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return _H(t,e)}}const _H=(t,e)=>{const r={type:"integer",format:"unix-time"};if(e.target==="openApi3")return r;for(const n of t.checks)switch(n.kind){case"min":it(r,"minimum",n.value,n.message,e);break;case"max":it(r,"maximum",n.value,n.message,e);break}return r};function yH(t,e){return{...Ze(t.innerType._def,e),default:t.defaultValue()}}function bH(t,e,r){return e.effectStrategy==="input"?Ze(t.schema._def,e,r):{}}function gH(t){return{type:"string",enum:[...t.values]}}const mH=t=>"type"in t&&t.type==="string"?!1:"allOf"in t;function vH(t,e){const r=[Ze(t.left._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),Ze(t.right._def,{...e,currentPath:[...e.currentPath,"allOf","1"]})].filter(a=>!!a);let n=e.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0;const i=[];return r.forEach(a=>{if(mH(a))i.push(...a.allOf),a.unevaluatedProperties===void 0&&(n=void 0);else{let o=a;if("additionalProperties"in a&&a.additionalProperties===!1){const{additionalProperties:s,...l}=a;o=l}else n=void 0;i.push(o)}}),i.length?{allOf:i,...n}:void 0}function wH(t,e){const r=typeof t.value;return r!=="bigint"&&r!=="number"&&r!=="boolean"&&r!=="string"?{type:Array.isArray(t.value)?"array":"object"}:e.target==="openApi3"?{type:r==="bigint"?"integer":r,enum:[t.value]}:{type:r==="bigint"?"integer":r,const:t.value}}let Ow;const qa={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(Ow===void 0&&(Ow=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),Ow),base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/};function mx(t,e){const r={type:"string"};function n(i){return e.patternStrategy==="escape"?OH(i):i}if(t.checks)for(const i of t.checks)switch(i.kind){case"min":it(r,"minLength",typeof r.minLength=="number"?Math.max(r.minLength,i.value):i.value,i.message,e);break;case"max":it(r,"maxLength",typeof r.maxLength=="number"?Math.min(r.maxLength,i.value):i.value,i.message,e);break;case"email":switch(e.emailStrategy){case"format:email":On(r,"email",i.message,e);break;case"format:idn-email":On(r,"idn-email",i.message,e);break;case"pattern:zod":Sn(r,qa.email,i.message,e);break}break;case"url":On(r,"uri",i.message,e);break;case"uuid":On(r,"uuid",i.message,e);break;case"regex":Sn(r,i.regex,i.message,e);break;case"cuid":Sn(r,qa.cuid,i.message,e);break;case"cuid2":Sn(r,qa.cuid2,i.message,e);break;case"startsWith":Sn(r,RegExp(`^${n(i.value)}`),i.message,e);break;case"endsWith":Sn(r,RegExp(`${n(i.value)}$`),i.message,e);break;case"datetime":On(r,"date-time",i.message,e);break;case"date":On(r,"date",i.message,e);break;case"time":On(r,"time",i.message,e);break;case"duration":On(r,"duration",i.message,e);break;case"length":it(r,"minLength",typeof r.minLength=="number"?Math.max(r.minLength,i.value):i.value,i.message,e),it(r,"maxLength",typeof r.maxLength=="number"?Math.min(r.maxLength,i.value):i.value,i.message,e);break;case"includes":{Sn(r,RegExp(n(i.value)),i.message,e);break}case"ip":{i.version!=="v6"&&On(r,"ipv4",i.message,e),i.version!=="v4"&&On(r,"ipv6",i.message,e);break}case"emoji":Sn(r,qa.emoji,i.message,e);break;case"ulid":{Sn(r,qa.ulid,i.message,e);break}case"base64":{switch(e.base64Strategy){case"format:binary":{On(r,"binary",i.message,e);break}case"contentEncoding:base64":{it(r,"contentEncoding","base64",i.message,e);break}case"pattern:zod":{Sn(r,qa.base64,i.message,e);break}}break}case"nanoid":Sn(r,qa.nanoid,i.message,e)}return r}const OH=t=>Array.from(t).map(e=>/[a-zA-Z0-9]/.test(e)?e:`\\${e}`).join(""),On=(t,e,r,n)=>{t.format||t.anyOf?.some(i=>i.format)?(t.anyOf||(t.anyOf=[]),t.format&&(t.anyOf.push({format:t.format,...t.errorMessage&&n.errorMessages&&{errorMessage:{format:t.errorMessage.format}}}),delete t.format,t.errorMessage&&(delete t.errorMessage.format,Object.keys(t.errorMessage).length===0&&delete t.errorMessage)),t.anyOf.push({format:e,...r&&n.errorMessages&&{errorMessage:{format:r}}})):it(t,"format",e,r,n)},Sn=(t,e,r,n)=>{t.pattern||t.allOf?.some(i=>i.pattern)?(t.allOf||(t.allOf=[]),t.pattern&&(t.allOf.push({pattern:t.pattern,...t.errorMessage&&n.errorMessages&&{errorMessage:{pattern:t.errorMessage.pattern}}}),delete t.pattern,t.errorMessage&&(delete t.errorMessage.pattern,Object.keys(t.errorMessage).length===0&&delete t.errorMessage)),t.allOf.push({pattern:KC(e,n),...r&&n.errorMessages&&{errorMessage:{pattern:r}}})):it(t,"pattern",KC(e,n),r,n)},KC=(t,e)=>{const r=typeof t=="function"?t():t;if(!e.applyRegexFlags||!r.flags)return r.source;const n={i:r.flags.includes("i"),m:r.flags.includes("m"),s:r.flags.includes("s")},i=n.i?r.source.toLowerCase():r.source;let a="",o=!1,s=!1,l=!1;for(let c=0;c<i.length;c++){if(o){a+=i[c],o=!1;continue}if(n.i){if(s){if(i[c].match(/[a-z]/)){l?(a+=i[c],a+=`${i[c-2]}-${i[c]}`.toUpperCase(),l=!1):i[c+1]==="-"&&i[c+2]?.match(/[a-z]/)?(a+=i[c],l=!0):a+=`${i[c]}${i[c].toUpperCase()}`;continue}}else if(i[c].match(/[a-z]/)){a+=`[${i[c]}${i[c].toUpperCase()}]`;continue}}if(n.m){if(i[c]==="^"){a+=`(^|(?<=[\r
]))`;continue}else if(i[c]==="$"){a+=`($|(?=[\r
]))`;continue}}if(n.s&&i[c]==="."){a+=s?`${i[c]}\r
`:`[${i[c]}\r
]`;continue}a+=i[c],i[c]==="\\"?o=!0:s&&i[c]==="]"?s=!1:!s&&i[c]==="["&&(s=!0)}try{const c=new RegExp(a)}catch{return console.warn(`Could not convert regex pattern at ${e.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),r.source}return a};function vx(t,e){if(e.target==="openApi3"&&t.keyType?._def.typeName===B.ZodEnum)return{type:"object",required:t.keyType._def.values,properties:t.keyType._def.values.reduce((n,i)=>({...n,[i]:Ze(t.valueType._def,{...e,currentPath:[...e.currentPath,"properties",i]})??{}}),{}),additionalProperties:!1};const r={type:"object",additionalProperties:Ze(t.valueType._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??{}};if(e.target==="openApi3")return r;if(t.keyType?._def.typeName===B.ZodString&&t.keyType._def.checks?.length){const n=Object.entries(mx(t.keyType._def,e)).reduce((i,[a,o])=>a==="type"?i:{...i,[a]:o},{});return{...r,propertyNames:n}}else if(t.keyType?._def.typeName===B.ZodEnum)return{...r,propertyNames:{enum:t.keyType._def.values}};return r}function SH(t,e){if(e.mapStrategy==="record")return vx(t,e);const r=Ze(t.keyType._def,{...e,currentPath:[...e.currentPath,"items","items","0"]})||{},n=Ze(t.valueType._def,{...e,currentPath:[...e.currentPath,"items","items","1"]})||{};return{type:"array",maxItems:125,items:{type:"array",items:[r,n],minItems:2,maxItems:2}}}function EH(t){const e=t.values,n=Object.keys(t.values).filter(a=>typeof e[e[a]]!="number").map(a=>e[a]),i=Array.from(new Set(n.map(a=>typeof a)));return{type:i.length===1?i[0]==="string"?"string":"number":["string","number"],enum:n}}function PH(){return{not:{}}}function jH(t){return t.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}const Sy={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function CH(t,e){if(e.target==="openApi3")return JC(t,e);const r=t.options instanceof Map?Array.from(t.options.values()):t.options;if(r.every(n=>n._def.typeName in Sy&&(!n._def.checks||!n._def.checks.length))){const n=r.reduce((i,a)=>{const o=Sy[a._def.typeName];return o&&!i.includes(o)?[...i,o]:i},[]);return{type:n.length>1?n:n[0]}}else if(r.every(n=>n._def.typeName==="ZodLiteral"&&!n.description)){const n=r.reduce((i,a)=>{const o=typeof a._def.value;switch(o){case"string":case"number":case"boolean":return[...i,o];case"bigint":return[...i,"integer"];case"object":if(a._def.value===null)return[...i,"null"];case"symbol":case"undefined":case"function":default:return i}},[]);if(n.length===r.length){const i=n.filter((a,o,s)=>s.indexOf(a)===o);return{type:i.length>1?i:i[0],enum:r.reduce((a,o)=>a.includes(o._def.value)?a:[...a,o._def.value],[])}}}else if(r.every(n=>n._def.typeName==="ZodEnum"))return{type:"string",enum:r.reduce((n,i)=>[...n,...i._def.values.filter(a=>!n.includes(a))],[])};return JC(t,e)}const JC=(t,e)=>{const r=(t.options instanceof Map?Array.from(t.options.values()):t.options).map((n,i)=>Ze(n._def,{...e,currentPath:[...e.currentPath,"anyOf",`${i}`]})).filter(n=>!!n&&(!e.strictUnions||typeof n=="object"&&Object.keys(n).length>0));return r.length?{anyOf:r}:void 0};function MH(t,e){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(t.innerType._def.typeName)&&(!t.innerType._def.checks||!t.innerType._def.checks.length))return e.target==="openApi3"||e.nullableStrategy==="property"?{type:Sy[t.innerType._def.typeName],nullable:!0}:{type:[Sy[t.innerType._def.typeName],"null"]};if(e.target==="openApi3"){const n=Ze(t.innerType._def,{...e,currentPath:[...e.currentPath]});return n&&"$ref"in n?{allOf:[n],nullable:!0}:n&&{...n,nullable:!0}}const r=Ze(t.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","0"]});return r&&{anyOf:[r,{type:"null"}]}}function TH(t,e){const r={type:"number"};if(!t.checks)return r;for(const n of t.checks)switch(n.kind){case"int":r.type="integer",bx(r,"type",n.message,e);break;case"min":e.target==="jsonSchema7"?n.inclusive?it(r,"minimum",n.value,n.message,e):it(r,"exclusiveMinimum",n.value,n.message,e):(n.inclusive||(r.exclusiveMinimum=!0),it(r,"minimum",n.value,n.message,e));break;case"max":e.target==="jsonSchema7"?n.inclusive?it(r,"maximum",n.value,n.message,e):it(r,"exclusiveMaximum",n.value,n.message,e):(n.inclusive||(r.exclusiveMaximum=!0),it(r,"maximum",n.value,n.message,e));break;case"multipleOf":it(r,"multipleOf",n.value,n.message,e);break}return r}function RH(t,e){return e.removeAdditionalStrategy==="strict"?t.catchall._def.typeName==="ZodNever"?t.unknownKeys!=="strict":Ze(t.catchall._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??!0:t.catchall._def.typeName==="ZodNever"?t.unknownKeys==="passthrough":Ze(t.catchall._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??!0}function AH(t,e){const r={type:"object",...Object.entries(t.shape()).reduce((n,[i,a])=>{if(a===void 0||a._def===void 0)return n;const o=Ze(a._def,{...e,currentPath:[...e.currentPath,"properties",i],propertyPath:[...e.currentPath,"properties",i]});return o===void 0?n:{properties:{...n.properties,[i]:o},required:a.isOptional()&&!e.openaiStrictMode?n.required:[...n.required,i]}},{properties:{},required:[]}),additionalProperties:RH(t,e)};return r.required.length||delete r.required,r}const $H=(t,e)=>{if(e.currentPath.toString()===e.propertyPath?.toString())return Ze(t.innerType._def,e);const r=Ze(t.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","1"]});return r?{anyOf:[{not:{}},r]}:{}},IH=(t,e)=>{if(e.pipeStrategy==="input")return Ze(t.in._def,e);if(e.pipeStrategy==="output")return Ze(t.out._def,e);const r=Ze(t.in._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),n=Ze(t.out._def,{...e,currentPath:[...e.currentPath,"allOf",r?"1":"0"]});return{allOf:[r,n].filter(i=>i!==void 0)}};function xH(t,e){return Ze(t.type._def,e)}function DH(t,e){const n={type:"array",uniqueItems:!0,items:Ze(t.valueType._def,{...e,currentPath:[...e.currentPath,"items"]})};return t.minSize&&it(n,"minItems",t.minSize.value,t.minSize.message,e),t.maxSize&&it(n,"maxItems",t.maxSize.value,t.maxSize.message,e),n}function NH(t,e){return t.rest?{type:"array",minItems:t.items.length,items:t.items.map((r,n)=>Ze(r._def,{...e,currentPath:[...e.currentPath,"items",`${n}`]})).reduce((r,n)=>n===void 0?r:[...r,n],[]),additionalItems:Ze(t.rest._def,{...e,currentPath:[...e.currentPath,"additionalItems"]})}:{type:"array",minItems:t.items.length,maxItems:t.items.length,items:t.items.map((r,n)=>Ze(r._def,{...e,currentPath:[...e.currentPath,"items",`${n}`]})).reduce((r,n)=>n===void 0?r:[...r,n],[])}}function zH(){return{not:{}}}function BH(){return{}}const UH=(t,e)=>Ze(t.innerType._def,e);function Ze(t,e,r=!1){const n=e.seen.get(t);if(e.override){const o=e.override?.(t,e,n,r);if(o!==aH)return o}if(n&&!r){const o=FH(n,e);if(o!==void 0)return"$ref"in o&&e.seenRefs.add(o.$ref),o}const i={def:t,path:e.currentPath,jsonSchema:void 0};e.seen.set(t,i);const a=VH(t,t.typeName,e,r);return a&&kH(t,e,a),i.jsonSchema=a,a}const FH=(t,e)=>{switch(e.$refStrategy){case"root":return{$ref:t.path.join("/")};case"extract-to-root":const r=t.path.slice(e.basePath.length+1).join("_");return r!==e.name&&e.nameStrategy==="duplicate-ref"&&(e.definitions[r]=t.def),{$ref:[...e.basePath,e.definitionPath,r].join("/")};case"relative":return{$ref:LH(e.currentPath,t.path)};case"none":case"seen":return t.path.length<e.currentPath.length&&t.path.every((n,i)=>e.currentPath[i]===n)?(console.warn(`Recursive reference detected at ${e.currentPath.join("/")}! Defaulting to any`),{}):e.$refStrategy==="seen"?{}:void 0}},LH=(t,e)=>{let r=0;for(;r<t.length&&r<e.length&&t[r]===e[r];r++);return[(t.length-r).toString(),...e.slice(r)].join("/")},VH=(t,e,r,n)=>{switch(e){case B.ZodString:return mx(t,r);case B.ZodNumber:return TH(t,r);case B.ZodObject:return AH(t,r);case B.ZodBigInt:return dH(t,r);case B.ZodBoolean:return fH();case B.ZodDate:return gx(t,r);case B.ZodUndefined:return zH();case B.ZodNull:return jH(r);case B.ZodArray:return cH(t,r);case B.ZodUnion:case B.ZodDiscriminatedUnion:return CH(t,r);case B.ZodIntersection:return vH(t,r);case B.ZodTuple:return NH(t,r);case B.ZodRecord:return vx(t,r);case B.ZodLiteral:return wH(t,r);case B.ZodEnum:return gH(t);case B.ZodNativeEnum:return EH(t);case B.ZodNullable:return MH(t,r);case B.ZodOptional:return $H(t,r);case B.ZodMap:return SH(t,r);case B.ZodSet:return DH(t,r);case B.ZodLazy:return Ze(t.getter()._def,r);case B.ZodPromise:return xH(t,r);case B.ZodNaN:case B.ZodNever:return PH();case B.ZodEffects:return bH(t,r,n);case B.ZodAny:return lH();case B.ZodUnknown:return BH();case B.ZodDefault:return yH(t,r);case B.ZodBranded:return hH(t,r);case B.ZodReadonly:return UH(t,r);case B.ZodCatch:return pH(t,r);case B.ZodPipeline:return IH(t,r);case B.ZodFunction:case B.ZodVoid:case B.ZodSymbol:return;default:return(i=>{})()}},kH=(t,e,r)=>(t.description&&(r.description=t.description,e.markdownDescription&&(r.markdownDescription=t.description)),r),HH=(t,e)=>{const r=uH(e),n=typeof e=="string"?e:e?.nameStrategy==="title"?void 0:e?.name,i=Ze(t._def,n===void 0?r:{...r,currentPath:[...r.basePath,r.definitionPath,n]},!1)??{},a=typeof e=="object"&&e.name!==void 0&&e.nameStrategy==="title"?e.name:void 0;a!==void 0&&(i.title=a);const o=(()=>{if(sH(r.definitions))return;const l={},c=new Set;for(let d=0;d<500;d++){const f=Object.entries(r.definitions).filter(([h])=>!c.has(h));if(f.length===0)break;for(const[h,p]of f)l[h]=Ze(eS(p),{...r,currentPath:[...r.basePath,r.definitionPath,h]},!0)??{},c.add(h)}return l})(),s=n===void 0?o?{...i,[r.definitionPath]:o}:i:r.nameStrategy==="duplicate-ref"?{...i,...o||r.seenRefs.size?{[r.definitionPath]:{...o,...r.seenRefs.size?{[n]:i}:void 0}}:void 0}:{$ref:[...r.$refStrategy==="relative"?[]:r.basePath,r.definitionPath,n].join("/"),[r.definitionPath]:{...o,[n]:i}};return r.target==="jsonSchema7"?s.$schema="http://json-schema.org/draft-07/schema#":r.target==="jsonSchema2019-09"&&(s.$schema="https://json-schema.org/draft/2019-09/schema#"),s};function wx(t,e){return HH(t,{openaiStrictMode:!0,name:e.name,nameStrategy:"duplicate-ref",$refStrategy:"extract-to-root",nullableStrategy:"property"})}function qH(t,e,r){return j2({type:"json_schema",json_schema:{...r,name:e,strict:!0,schema:wx(t,{name:e})}},n=>t.parse(JSON.parse(n)))}function GH(t){return C2({type:"function",function:{name:t.name,parameters:wx(t.parameters,{name:t.name}),strict:!0,...t.description?{description:t.description}:void 0}},{callback:t.function,parser:e=>t.parameters.parse(JSON.parse(e))})}function hb(t){const{azureOpenAIApiDeploymentName:e,azureOpenAIApiInstanceName:r,azureOpenAIApiKey:n,azureOpenAIBasePath:i,baseURL:a,azureADTokenProvider:o,azureOpenAIEndpoint:s}=t;if((n||o)&&i&&e)return`${i}/${e}`;if((n||o)&&s&&e)return`${s}/openai/deployments/${e}`;if(n||o){if(!r)throw new Error("azureOpenAIApiInstanceName is required when using azureOpenAIApiKey");if(!e)throw new Error("azureOpenAIApiDeploymentName is a required parameter when using azureOpenAIApiKey");return`https://${r}.openai.azure.com/openai/deployments/${e}`}return a}function Ox(t,e){const r=typeof e=="number"?void 0:e;return{name:t.name,description:t.description,parameters:ui(t.schema),...r?.strict!==void 0?{strict:r.strict}:{}}}function WH(t,e){let r;return zu(t)?r={type:"function",function:Ox(t)}:r=t,r}function KH(t){return t!==void 0&&Array.isArray(t.lc_namespace)}function JH(t){return t!==void 0&&Tt.isRunnable(t)&&"lc_name"in t.constructor&&typeof t.constructor.lc_name=="function"&&t.constructor.lc_name()==="RunnableToolLike"}function XH(t){return!!t&&typeof t=="object"&&"name"in t&&"schema"in t&&yu(t.schema)}function zu(t){return XH(t)||JH(t)||KH(t)}function Np(t,e){return t.lc_error_code=e,t.message=`${t.message}

Troubleshooting URL: https://js.langchain.com/docs/troubleshooting/errors/${e}/
`,t}function Ey(t){let e;return t.constructor.name===ib.name?(e=new Error(t.message),e.name="TimeoutError"):t.constructor.name===Wr.name?(e=new Error(t.message),e.name="AbortError"):t.status===400&&t.message.includes("tool_calls")?e=Np(t,"INVALID_TOOL_RESULTS"):t.status===401?e=Np(t,"MODEL_AUTHENTICATION"):t.status===429?e=Np(t,"MODEL_RATE_LIMIT"):t.status===404?e=Np(t,"MODEL_NOT_FOUND"):e=t,e}function ZH(t){if(t)return t==="any"||t==="required"?"required":t==="auto"?"auto":t==="none"?"none":typeof t=="string"?{type:"function",function:{name:t}}:t}function YH(t){return t.anyOf!==void 0&&Array.isArray(t.anyOf)}function QH(t){const e=["namespace functions {",""];for(const r of t)r.description&&e.push(`// ${r.description}`),Object.keys(r.parameters.properties??{}).length>0?(e.push(`type ${r.name} = (_: {`),e.push(Sx(r.parameters,0)),e.push("}) => any;")):e.push(`type ${r.name} = () => any;`),e.push("");return e.push("} // namespace functions"),e.join(`
`)}function Sx(t,e){const r=[];for(const[n,i]of Object.entries(t.properties??{}))i.description&&e<2&&r.push(`// ${i.description}`),t.required?.includes(n)?r.push(`${n}: ${Py(i,e)},`):r.push(`${n}?: ${Py(i,e)},`);return r.map(n=>" ".repeat(e)+n).join(`
`)}function Py(t,e){if(YH(t))return t.anyOf.map(r=>Py(r,e)).join(" | ");switch(t.type){case"string":return t.enum?t.enum.map(r=>`"${r}"`).join(" | "):"string";case"number":return t.enum?t.enum.map(r=>`${r}`).join(" | "):"number";case"integer":return t.enum?t.enum.map(r=>`${r}`).join(" | "):"number";case"boolean":return"boolean";case"null":return"null";case"object":return["{",Sx(t,e+2),"}"].join(`
`);case"array":return t.items?`${Py(t.items,e)}[]`:"any[]";default:return""}}function eq(t,e){let r;if(zu(t)){const n=GH({name:t.name,parameters:t.schema,description:t.description});n.function.parameters?r={type:n.type,function:{name:n.function.name,description:n.function.description,parameters:n.function.parameters,...e?.strict!==void 0?{strict:e.strict}:{}}}:r={type:"function",function:Ox(t,e)}}else r=t;return e?.strict!==void 0&&(r.function.strict=e.strict),r}function tq(t){return t.role!=="system"&&t.role!=="developer"&&t.role!=="assistant"&&t.role!=="user"&&t.role!=="function"&&t.role!=="tool"&&console.warn(`Unknown message role: ${t.role}`),t.role}function Ex(t){const e=t._getType();switch(e){case"system":return"system";case"ai":return"assistant";case"human":return"user";case"function":return"function";case"tool":return"tool";case"generic":{if(!Co.isInstance(t))throw new Error("Invalid generic chat message");return tq(t)}default:throw new Error(`Unknown message type: ${e}`)}}function rq(t,e,r){const n=t.tool_calls;switch(t.role){case"assistant":{const i=[],a=[];for(const l of n??[])try{i.push(qE(l,{returnId:!0}))}catch(c){a.push(yx(l,c.message))}const o={function_call:t.function_call,tool_calls:n};r!==void 0&&(o.__raw_response=e);const s={model_name:e.model,...e.system_fingerprint?{usage:{...e.usage},system_fingerprint:e.system_fingerprint}:{}};return t.audio&&(o.audio=t.audio),new Nn({content:t.content||"",tool_calls:i,invalid_tool_calls:a,additional_kwargs:o,response_metadata:s,id:e.id})}default:return new Co(t.content||"",t.role??"unknown")}}function nq(t,e,r,n){const i=t.role??r,a=t.content??"";let o;t.function_call?o={function_call:t.function_call}:t.tool_calls?o={tool_calls:t.tool_calls}:o={},n&&(o.__raw_response=e),t.audio&&(o.audio={...t.audio,index:e.choices[0].index});const s={usage:{...e.usage}};if(i==="user")return new Xc({content:a,response_metadata:s});if(i==="assistant"){const l=[];if(Array.isArray(t.tool_calls))for(const c of t.tool_calls)l.push({name:c.function?.name,args:c.function?.arguments,id:c.id,index:c.index,type:"tool_call_chunk"});return new vt({content:a,tool_call_chunks:l,additional_kwargs:o,id:e.id,response_metadata:s})}else return i==="system"?new Qs({content:a,response_metadata:s}):i==="developer"?new Qs({content:a,response_metadata:s,additional_kwargs:{__openai_role__:"developer"}}):i==="function"?new Ky({content:a,additional_kwargs:o,name:t.name,response_metadata:s}):i==="tool"?new GS({content:a,additional_kwargs:o,tool_call_id:t.tool_call_id,response_metadata:s}):new Jc({content:a,role:i,response_metadata:s})}function XC(t,e){return t.flatMap(r=>{let n=Ex(r);n==="system"&&e?.startsWith("o1")&&(n="developer");const i={role:n,content:r.content};if(r.name!=null&&(i.name=r.name),r.additional_kwargs.function_call!=null&&(i.function_call=r.additional_kwargs.function_call,i.content=null),ii(r)&&r.tool_calls?.length?(i.tool_calls=r.tool_calls.map(_x),i.content=null):(r.additional_kwargs.tool_calls!=null&&(i.tool_calls=r.additional_kwargs.tool_calls),r.tool_call_id!=null&&(i.tool_call_id=r.tool_call_id)),r.additional_kwargs.audio&&typeof r.additional_kwargs.audio=="object"&&"id"in r.additional_kwargs.audio){const a={role:"assistant",audio:{id:r.additional_kwargs.audio.id}};return[i,a]}return i})}function ZC(t,e){return ud(t)?e?.strict!==void 0?{...t,function:{...t.function,strict:e.strict}}:t:eq(t,e)}class GE extends un{static lc_name(){return"ChatOpenAI"}get callKeys(){return[...super.callKeys,"options","function_call","functions","tools","tool_choice","promptIndex","response_format","seed","reasoning_effort"]}get lc_secrets(){return{openAIApiKey:"OPENAI_API_KEY",apiKey:"OPENAI_API_KEY",azureOpenAIApiKey:"AZURE_OPENAI_API_KEY",organization:"OPENAI_ORGANIZATION"}}get lc_aliases(){return{modelName:"model",openAIApiKey:"openai_api_key",apiKey:"openai_api_key",azureOpenAIApiVersion:"azure_openai_api_version",azureOpenAIApiKey:"azure_openai_api_key",azureOpenAIApiInstanceName:"azure_openai_api_instance_name",azureOpenAIApiDeploymentName:"azure_openai_api_deployment_name"}}constructor(e,r){if(super(e??{}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"temperature",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"topP",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"frequencyPenalty",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"presencePenalty",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"n",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"logitBias",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"modelName",{enumerable:!0,configurable:!0,writable:!0,value:"gpt-3.5-turbo"}),Object.defineProperty(this,"model",{enumerable:!0,configurable:!0,writable:!0,value:"gpt-3.5-turbo"}),Object.defineProperty(this,"modelKwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stop",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stopSequences",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"user",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"streaming",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"streamUsage",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"maxTokens",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"logprobs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"topLogprobs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"openAIApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiVersion",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureADTokenProvider",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiInstanceName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiDeploymentName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIBasePath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIEndpoint",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"organization",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"__includeRawResponse",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"clientConfig",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"supportsStrictToolCalling",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"audio",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"modalities",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"reasoningEffort",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.openAIApiKey=e?.apiKey??e?.openAIApiKey??e?.configuration?.apiKey??Ye("OPENAI_API_KEY"),this.apiKey=this.openAIApiKey,this.azureOpenAIApiKey=e?.azureOpenAIApiKey??Ye("AZURE_OPENAI_API_KEY"),this.azureADTokenProvider=e?.azureADTokenProvider??void 0,!this.azureOpenAIApiKey&&!this.apiKey&&!this.azureADTokenProvider)throw new Error("OpenAI or Azure OpenAI API key or Token Provider not found");if(this.azureOpenAIApiInstanceName=e?.azureOpenAIApiInstanceName??Ye("AZURE_OPENAI_API_INSTANCE_NAME"),this.azureOpenAIApiDeploymentName=e?.azureOpenAIApiDeploymentName??Ye("AZURE_OPENAI_API_DEPLOYMENT_NAME"),this.azureOpenAIApiVersion=e?.azureOpenAIApiVersion??Ye("AZURE_OPENAI_API_VERSION"),this.azureOpenAIBasePath=e?.azureOpenAIBasePath??Ye("AZURE_OPENAI_BASE_PATH"),this.organization=e?.configuration?.organization??Ye("OPENAI_ORGANIZATION"),this.azureOpenAIEndpoint=e?.azureOpenAIEndpoint??Ye("AZURE_OPENAI_ENDPOINT"),this.modelName=e?.model??e?.modelName??this.model,this.model=this.modelName,this.modelKwargs=e?.modelKwargs??{},this.timeout=e?.timeout,this.temperature=e?.temperature??this.temperature,this.topP=e?.topP??this.topP,this.frequencyPenalty=e?.frequencyPenalty??this.frequencyPenalty,this.presencePenalty=e?.presencePenalty??this.presencePenalty,this.maxTokens=e?.maxTokens,this.logprobs=e?.logprobs,this.topLogprobs=e?.topLogprobs,this.n=e?.n??this.n,this.logitBias=e?.logitBias,this.stop=e?.stopSequences??e?.stop,this.stopSequences=this?.stop,this.user=e?.user,this.__includeRawResponse=e?.__includeRawResponse,this.audio=e?.audio,this.modalities=e?.modalities,this.reasoningEffort=e?.reasoningEffort,this.azureOpenAIApiKey||this.azureADTokenProvider){if(!this.azureOpenAIApiInstanceName&&!this.azureOpenAIBasePath&&!this.azureOpenAIEndpoint)throw new Error("Azure OpenAI API instance name not found");if(!this.azureOpenAIApiDeploymentName&&this.azureOpenAIBasePath){const n=this.azureOpenAIBasePath.split("/openai/deployments/");if(n.length===2){const[,i]=n;this.azureOpenAIApiDeploymentName=i}}if(!this.azureOpenAIApiDeploymentName)throw new Error("Azure OpenAI API deployment name not found");if(!this.azureOpenAIApiVersion)throw new Error("Azure OpenAI API version not found");this.apiKey=this.apiKey??"",this.streamUsage=!1}this.model==="o1"&&(this.disableStreaming=!0),this.streaming=e?.streaming??!1,this.streamUsage=e?.streamUsage??this.streamUsage,this.clientConfig={apiKey:this.apiKey,organization:this.organization,baseURL:r?.basePath??e?.configuration?.basePath,dangerouslyAllowBrowser:!0,defaultHeaders:r?.baseOptions?.headers??e?.configuration?.baseOptions?.headers,defaultQuery:r?.baseOptions?.params??e?.configuration?.baseOptions?.params,...r,...e?.configuration},e?.supportsStrictToolCalling!==void 0&&(this.supportsStrictToolCalling=e.supportsStrictToolCalling)}getLsParams(e){const r=this.invocationParams(e);return{ls_provider:"openai",ls_model_name:this.model,ls_model_type:"chat",ls_temperature:r.temperature??void 0,ls_max_tokens:r.max_tokens??void 0,ls_stop:e.stop}}bindTools(e,r){let n;return r?.strict!==void 0?n=r.strict:this.supportsStrictToolCalling!==void 0&&(n=this.supportsStrictToolCalling),this.bind({tools:e.map(i=>ZC(i,{strict:n})),...r})}createResponseFormat(e){return e&&e.type==="json_schema"&&e.json_schema.schema&&zp(e.json_schema.schema)?qH(e.json_schema.schema,e.json_schema.name,{description:e.json_schema.description}):e}invocationParams(e,r){let n;e?.strict!==void 0?n=e.strict:this.supportsStrictToolCalling!==void 0&&(n=this.supportsStrictToolCalling);let i={};e?.stream_options!==void 0?i={stream_options:e.stream_options}:this.streamUsage&&(this.streaming||r?.streaming)&&(i={stream_options:{include_usage:!0}});const a={model:this.model,temperature:this.temperature,top_p:this.topP,frequency_penalty:this.frequencyPenalty,presence_penalty:this.presencePenalty,max_tokens:this.maxTokens===-1?void 0:this.maxTokens,logprobs:this.logprobs,top_logprobs:this.topLogprobs,n:this.n,logit_bias:this.logitBias,stop:e?.stop??this.stopSequences,user:this.user,stream:this.streaming,functions:e?.functions,function_call:e?.function_call,tools:e?.tools?.length?e.tools.map(s=>ZC(s,{strict:n})):void 0,tool_choice:ZH(e?.tool_choice),response_format:this.createResponseFormat(e?.response_format),seed:e?.seed,...i,parallel_tool_calls:e?.parallel_tool_calls,...this.audio||e?.audio?{audio:this.audio||e?.audio}:{},...this.modalities||e?.modalities?{modalities:this.modalities||e?.modalities}:{},...this.modelKwargs};e?.prediction!==void 0&&(a.prediction=e.prediction);const o=e?.reasoning_effort??this.reasoningEffort;return o!==void 0&&(a.reasoning_effort=o),a}_identifyingParams(){return{model_name:this.model,...this.invocationParams(),...this.clientConfig}}async*_streamResponseChunks(e,r,n){const i=XC(e,this.model),a={...this.invocationParams(r,{streaming:!0}),messages:i,stream:!0};let o;const s=await this.completionWithRetry(a,r);let l;for await(const c of s){const d=c?.choices?.[0];if(c.usage&&(l=c.usage),!d)continue;const{delta:f}=d;if(!f)continue;const h=nq(f,c,o,this.__includeRawResponse);o=f.role??o;const p={prompt:r.promptIndex??0,completion:d.index??0};if(typeof h.content!="string"){console.log("[WARNING]: Received non-string content from OpenAI. This is currently not supported.");continue}const b={...p};d.finish_reason!=null&&(b.finish_reason=d.finish_reason,b.system_fingerprint=c.system_fingerprint,b.model_name=c.model),this.logprobs&&(b.logprobs=d.logprobs);const g=new Mr({message:h,text:h.content,generationInfo:b});yield g,await n?.handleLLMNewToken(g.text??"",p,void 0,void 0,void 0,{chunk:g})}if(l){const c={...l.prompt_tokens_details?.audio_tokens!==null&&{audio:l.prompt_tokens_details?.audio_tokens},...l.prompt_tokens_details?.cached_tokens!==null&&{cache_read:l.prompt_tokens_details?.cached_tokens}},d={...l.completion_tokens_details?.audio_tokens!==null&&{audio:l.completion_tokens_details?.audio_tokens},...l.completion_tokens_details?.reasoning_tokens!==null&&{reasoning:l.completion_tokens_details?.reasoning_tokens}};yield new Mr({message:new vt({content:"",response_metadata:{usage:{...l}},usage_metadata:{input_tokens:l.prompt_tokens,output_tokens:l.completion_tokens,total_tokens:l.total_tokens,...Object.keys(c).length>0&&{input_token_details:c},...Object.keys(d).length>0&&{output_token_details:d}}}),text:""})}if(r.signal?.aborted)throw new Error("AbortError")}identifyingParams(){return this._identifyingParams()}async _generate(e,r,n){const i={},a=this.invocationParams(r),o=XC(e,this.model);if(a.stream){const s=this._streamResponseChunks(e,r,n),l={};for await(const b of s){b.message.response_metadata={...b.generationInfo,...b.message.response_metadata};const g=b.generationInfo?.completion??0;l[g]===void 0?l[g]=b:l[g]=l[g].concat(b)}const c=Object.entries(l).sort(([b],[g])=>parseInt(b,10)-parseInt(g,10)).map(([b,g])=>g),{functions:d,function_call:f}=this.invocationParams(r),h=await this.getEstimatedTokenCountFromPrompt(e,d,f),p=await this.getNumTokensFromGenerations(c);return i.input_tokens=h,i.output_tokens=p,i.total_tokens=h+p,{generations:c,llmOutput:{estimatedTokenUsage:{promptTokens:i.input_tokens,completionTokens:i.output_tokens,totalTokens:i.total_tokens}}}}else{let s;r.response_format&&r.response_format.type==="json_schema"?s=await this.betaParsedCompletionWithRetry({...a,stream:!1,messages:o},{signal:r?.signal,...r?.options}):s=await this.completionWithRetry({...a,stream:!1,messages:o},{signal:r?.signal,...r?.options});const{completion_tokens:l,prompt_tokens:c,total_tokens:d,prompt_tokens_details:f,completion_tokens_details:h}=s?.usage??{};l&&(i.output_tokens=(i.output_tokens??0)+l),c&&(i.input_tokens=(i.input_tokens??0)+c),d&&(i.total_tokens=(i.total_tokens??0)+d),(f?.audio_tokens!==null||f?.cached_tokens!==null)&&(i.input_token_details={...f?.audio_tokens!==null&&{audio:f?.audio_tokens},...f?.cached_tokens!==null&&{cache_read:f?.cached_tokens}}),(h?.audio_tokens!==null||h?.reasoning_tokens!==null)&&(i.output_token_details={...h?.audio_tokens!==null&&{audio:h?.audio_tokens},...h?.reasoning_tokens!==null&&{reasoning:h?.reasoning_tokens}});const p=[];for(const b of s?.choices??[]){const v={text:b.message?.content??"",message:rq(b.message??{role:"assistant"},s,this.__includeRawResponse)};v.generationInfo={...b.finish_reason?{finish_reason:b.finish_reason}:{},...b.logprobs?{logprobs:b.logprobs}:{}},ii(v.message)&&(v.message.usage_metadata=i),v.message=new Nn(Object.fromEntries(Object.entries(v.message).filter(([E])=>!E.startsWith("lc_")))),p.push(v)}return{generations:p,llmOutput:{tokenUsage:{promptTokens:i.input_tokens,completionTokens:i.output_tokens,totalTokens:i.total_tokens}}}}}async getEstimatedTokenCountFromPrompt(e,r,n){let i=(await this.getNumTokensFromMessages(e)).totalCount;if(r&&n!=="auto"){const a=QH(r);i+=await this.getNumTokens(a),i+=9}return r&&e.find(a=>a._getType()==="system")&&(i-=4),n==="none"?i+=1:typeof n=="object"&&(i+=await this.getNumTokens(n.name)+4),i}async getNumTokensFromGenerations(e){return(await Promise.all(e.map(async n=>n.message.additional_kwargs?.function_call?(await this.getNumTokensFromMessages([n.message])).countPerMessage[0]:await this.getNumTokens(n.message.content)))).reduce((n,i)=>n+i,0)}async getNumTokensFromMessages(e){let r=0,n=0,i=0;this.model==="gpt-3.5-turbo-0301"?(n=4,i=-1):(n=3,i=1);const a=await Promise.all(e.map(async o=>{const s=await this.getNumTokens(o.content),l=await this.getNumTokens(Ex(o)),c=o.name!==void 0?i+await this.getNumTokens(o.name):0;let d=s+n+l+c;const f=o;if(f._getType()==="function"&&(d-=2),f.additional_kwargs?.function_call&&(d+=3),f?.additional_kwargs.function_call?.name&&(d+=await this.getNumTokens(f.additional_kwargs.function_call?.name)),f.additional_kwargs.function_call?.arguments)try{d+=await this.getNumTokens(JSON.stringify(JSON.parse(f.additional_kwargs.function_call?.arguments)))}catch(h){console.error("Error parsing function arguments",h,JSON.stringify(f.additional_kwargs.function_call)),d+=await this.getNumTokens(f.additional_kwargs.function_call?.arguments)}return r+=d,d}));return r+=3,{totalCount:r,countPerMessage:a}}async completionWithRetry(e,r){const n=this._getClientOptions(r);return this.caller.call(async()=>{try{return await this.client.chat.completions.create(e,n)}catch(i){throw Ey(i)}})}async betaParsedCompletionWithRetry(e,r){const n=this._getClientOptions(r);return this.caller.call(async()=>{try{return await this.client.beta.chat.completions.parse(e,n)}catch(i){throw Ey(i)}})}_getClientOptions(e){if(!this.client){const n={azureOpenAIApiDeploymentName:this.azureOpenAIApiDeploymentName,azureOpenAIApiInstanceName:this.azureOpenAIApiInstanceName,azureOpenAIApiKey:this.azureOpenAIApiKey,azureOpenAIBasePath:this.azureOpenAIBasePath,baseURL:this.clientConfig.baseURL,azureOpenAIEndpoint:this.azureOpenAIEndpoint},i=hb(n),a={...this.clientConfig,baseURL:i,timeout:this.timeout,maxRetries:0};a.baseURL||delete a.baseURL,this.client=new De(a)}const r={...this.clientConfig,...e};return this.azureOpenAIApiKey&&(r.headers={"api-key":this.azureOpenAIApiKey,...r.headers},r.query={"api-version":this.azureOpenAIApiVersion,...r.query}),r}_llmType(){return"openai"}_combineLLMOutput(...e){return e.reduce((r,n)=>(n&&n.tokenUsage&&(r.tokenUsage.completionTokens+=n.tokenUsage.completionTokens??0,r.tokenUsage.promptTokens+=n.tokenUsage.promptTokens??0,r.tokenUsage.totalTokens+=n.tokenUsage.totalTokens??0),r),{tokenUsage:{completionTokens:0,promptTokens:0,totalTokens:0}})}withStructuredOutput(e,r){let n,i,a,o;iq(e)?(n=e.schema,i=e.name,a=e.method,o=e.includeRaw):(n=e,i=r?.name,a=r?.method,o=r?.includeRaw);let s,l;if(r?.strict!==void 0&&a==="jsonMode")throw new Error("Argument `strict` is only supported for `method` = 'function_calling'");if(a==="jsonMode")s=this.bind({response_format:{type:"json_object"}}),zp(n)?l=YO.fromZodSchema(n):l=new QO;else if(a==="jsonSchema")s=this.bind({response_format:{type:"json_schema",json_schema:{name:i??"extract",description:n.description,schema:n,strict:r?.strict}}}),zp(n)?l=YO.fromZodSchema(n):l=new QO;else{let h=i??"extract";if(zp(n)){const p=ui(n);s=this.bind({tools:[{type:"function",function:{name:h,description:p.description,parameters:p}}],tool_choice:{type:"function",function:{name:h}},...r?.strict!==void 0?{strict:r.strict}:{}}),l=new Oy({returnSingle:!0,keyName:h,zodSchema:n})}else{let p;typeof n.name=="string"&&typeof n.parameters=="object"&&n.parameters!=null?(p=n,h=n.name):(h=n.title??h,p={name:h,description:n.description??"",parameters:n}),s=this.bind({tools:[{type:"function",function:p}],tool_choice:{type:"function",function:{name:h}},...r?.strict!==void 0?{strict:r.strict}:{}}),l=new Oy({returnSingle:!0,keyName:h})}}if(!o)return s.pipe(l);const c=li.assign({parsed:(h,p)=>l.invoke(h.raw,p)}),d=li.assign({parsed:()=>null}),f=c.withFallbacks({fallbacks:[d]});return Gr.from([{raw:s},f])}}function zp(t){return typeof t?.parse=="function"}function iq(t){return t!==void 0&&typeof t.schema=="object"}class aq extends GE{_llmType(){return"azure_openai"}get lc_aliases(){return{openAIApiKey:"openai_api_key",openAIApiVersion:"openai_api_version",openAIBasePath:"openai_api_base",deploymentName:"deployment_name",azureOpenAIEndpoint:"azure_endpoint",azureOpenAIApiVersion:"openai_api_version",azureOpenAIBasePath:"openai_api_base",azureOpenAIApiDeploymentName:"deployment_name"}}constructor(e){const r=e&&{...e};r&&(r.azureOpenAIApiDeploymentName=r.azureOpenAIApiDeploymentName??r.deploymentName,r.azureOpenAIApiKey=r.azureOpenAIApiKey??r.openAIApiKey,r.azureOpenAIApiVersion=r.azureOpenAIApiVersion??r.openAIApiVersion),super(r)}getLsParams(e){const r=super.getLsParams(e);return r.ls_provider="azure",r}_getClientOptions(e){if(!this.client){const n={azureOpenAIApiDeploymentName:this.azureOpenAIApiDeploymentName,azureOpenAIApiInstanceName:this.azureOpenAIApiInstanceName,azureOpenAIApiKey:this.azureOpenAIApiKey,azureOpenAIBasePath:this.azureOpenAIBasePath,azureADTokenProvider:this.azureADTokenProvider,baseURL:this.clientConfig.baseURL,azureOpenAIEndpoint:this.azureOpenAIEndpoint},i=hb(n),a={...this.clientConfig,baseURL:i,timeout:this.timeout,maxRetries:0};this.azureADTokenProvider||(a.apiKey=n.azureOpenAIApiKey),a.baseURL||delete a.baseURL,a.defaultHeaders={...a.defaultHeaders,"User-Agent":a.defaultHeaders?.["User-Agent"]?`${a.defaultHeaders["User-Agent"]}: langchainjs-azure-openai-v2`:"langchainjs-azure-openai-v2"},this.client=new dx({apiVersion:this.azureOpenAIApiVersion,azureADTokenProvider:this.azureADTokenProvider,deployment:this.azureOpenAIApiDeploymentName,...a})}const r={...this.clientConfig,...e};return this.azureOpenAIApiKey&&(r.headers={"api-key":this.azureOpenAIApiKey,...r.headers},r.query={"api-version":this.azureOpenAIApiVersion,...r.query}),r}toJSON(){const e=super.toJSON();function r(n){return typeof n=="object"&&n!=null}if(r(e)&&r(e.kwargs)){if(delete e.kwargs.azure_openai_base_path,delete e.kwargs.azure_openai_api_deployment_name,delete e.kwargs.azure_openai_api_key,delete e.kwargs.azure_openai_api_version,delete e.kwargs.azure_open_ai_base_path,!e.kwargs.azure_endpoint&&this.azureOpenAIEndpoint&&(e.kwargs.azure_endpoint=this.azureOpenAIEndpoint),!e.kwargs.azure_endpoint&&this.azureOpenAIBasePath){const n=this.azureOpenAIBasePath.split("/openai/deployments/");if(n.length===2&&n[0].startsWith("http")){const[i]=n;e.kwargs.azure_endpoint=i}}if(!e.kwargs.azure_endpoint&&this.azureOpenAIApiInstanceName&&(e.kwargs.azure_endpoint=`https://${this.azureOpenAIApiInstanceName}.openai.azure.com/`),!e.kwargs.deployment_name&&this.azureOpenAIApiDeploymentName&&(e.kwargs.deployment_name=this.azureOpenAIApiDeploymentName),!e.kwargs.deployment_name&&this.azureOpenAIBasePath){const n=this.azureOpenAIBasePath.split("/openai/deployments/");if(n.length===2){const[,i]=n;e.kwargs.deployment_name=i}}e.kwargs.azure_endpoint&&e.kwargs.deployment_name&&e.kwargs.openai_api_base&&delete e.kwargs.openai_api_base,e.kwargs.azure_openai_api_instance_name&&e.kwargs.azure_endpoint&&delete e.kwargs.azure_openai_api_instance_name}return e}}class Ds extends fx{constructor({concurrency:e,...r}){super(e?{maxConcurrency:e,...r}:r),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","llms",this._llmType()]})}async invoke(e,r){const n=Ds._convertInputToPromptValue(e);return(await this.generatePrompt([n],r,r?.callbacks)).generations[0][0].text}async*_streamResponseChunks(e,r,n){throw new Error("Not implemented.")}_separateRunnableConfigFromCallOptionsCompat(e){const[r,n]=super._separateRunnableConfigFromCallOptions(e);return n.signal=r.signal,[r,n]}async*_streamIterator(e,r){if(this._streamResponseChunks===Ds.prototype._streamResponseChunks)yield this.invoke(e,r);else{const n=Ds._convertInputToPromptValue(e),[i,a]=this._separateRunnableConfigFromCallOptionsCompat(r),o=await Wt.configure(i.callbacks,this.callbacks,i.tags,this.tags,i.metadata,this.metadata,{verbose:this.verbose}),s={options:a,invocation_params:this?.invocationParams(a),batch_size:1},l=await o?.handleLLMStart(this.toJSON(),[n.toString()],i.runId,void 0,s,void 0,void 0,i.runName);let c=new Ui({text:""});try{for await(const d of this._streamResponseChunks(n.toString(),a,l?.[0]))c?c=c.concat(d):c=d,typeof d.text=="string"&&(yield d.text)}catch(d){throw await Promise.all((l??[]).map(f=>f?.handleLLMError(d))),d}await Promise.all((l??[]).map(d=>d?.handleLLMEnd({generations:[[c]]})))}}async generatePrompt(e,r,n){const i=e.map(a=>a.toString());return this.generate(i,r,n)}invocationParams(e){return{}}_flattenLLMResult(e){const r=[];for(let n=0;n<e.generations.length;n+=1){const i=e.generations[n];if(n===0)r.push({generations:[i],llmOutput:e.llmOutput});else{const a=e.llmOutput?{...e.llmOutput,tokenUsage:{}}:void 0;r.push({generations:[i],llmOutput:a})}}return r}async _generateUncached(e,r,n,i){let a;if(i!==void 0&&i.length===e.length)a=i;else{const c=await Wt.configure(n.callbacks,this.callbacks,n.tags,this.tags,n.metadata,this.metadata,{verbose:this.verbose}),d={options:r,invocation_params:this?.invocationParams(r),batch_size:e.length};a=await c?.handleLLMStart(this.toJSON(),e,n.runId,void 0,d,void 0,void 0,n?.runName)}const o=!!a?.[0].handlers.find(v$);let s;if(o&&e.length===1&&this._streamResponseChunks!==Ds.prototype._streamResponseChunks)try{const c=await this._streamResponseChunks(e[0],r,a?.[0]);let d;for await(const f of c)d===void 0?d=f:d=pn(d,f);if(d===void 0)throw new Error("Received empty response from chat model call.");s={generations:[[d]],llmOutput:{}},await a?.[0].handleLLMEnd(s)}catch(c){throw await a?.[0].handleLLMError(c),c}else{try{s=await this._generate(e,r,a?.[0])}catch(d){throw await Promise.all((a??[]).map(f=>f?.handleLLMError(d))),d}const c=this._flattenLLMResult(s);await Promise.all((a??[]).map((d,f)=>d?.handleLLMEnd(c[f])))}const l=a?.map(c=>c.runId)||void 0;return Object.defineProperty(s,hy,{value:l?{runIds:l}:void 0,configurable:!0}),s}async _generateCached({prompts:e,cache:r,llmStringKey:n,parsedOptions:i,handledOptions:a,runId:o}){const s=await Wt.configure(a.callbacks,this.callbacks,a.tags,this.tags,a.metadata,this.metadata,{verbose:this.verbose}),l={options:i,invocation_params:this?.invocationParams(i),batch_size:e.length},c=await s?.handleLLMStart(this.toJSON(),e,o,void 0,l,void 0,void 0,a?.runName),d=[],h=(await Promise.allSettled(e.map(async(g,v)=>{const E=await r.lookup(g,n);return E==null&&d.push(v),E}))).map((g,v)=>({result:g,runManager:c?.[v]})).filter(({result:g})=>g.status==="fulfilled"&&g.value!=null||g.status==="rejected"),p=[];await Promise.all(h.map(async({result:g,runManager:v},E)=>{if(g.status==="fulfilled"){const C=g.value;return p[E]=C.map(S=>(S.generationInfo={...S.generationInfo,tokenUsage:{}},S)),C.length&&await v?.handleLLMNewToken(C[0].text),v?.handleLLMEnd({generations:[C]},void 0,void 0,void 0,{cached:!0})}else return await v?.handleLLMError(g.reason,void 0,void 0,void 0,{cached:!0}),Promise.reject(g.reason)}));const b={generations:p,missingPromptIndices:d,startedRunManagers:c};return Object.defineProperty(b,hy,{value:c?{runIds:c?.map(g=>g.runId)}:void 0,configurable:!0}),b}async generate(e,r,n){if(!Array.isArray(e))throw new Error("Argument 'prompts' is expected to be a string[]");let i;Array.isArray(r)?i={stop:r}:i=r;const[a,o]=this._separateRunnableConfigFromCallOptionsCompat(i);if(a.callbacks=a.callbacks??n,!this.cache)return this._generateUncached(e,o,a);const{cache:s}=this,l=this._getSerializedCacheKeyParametersForCall(o),{generations:c,missingPromptIndices:d,startedRunManagers:f}=await this._generateCached({prompts:e,cache:s,llmStringKey:l,parsedOptions:o,handledOptions:a,runId:a.runId});let h={};if(d.length>0){const p=await this._generateUncached(d.map(b=>e[b]),o,a,f!==void 0?d.map(b=>f?.[b]):void 0);await Promise.all(p.generations.map(async(b,g)=>{const v=d[g];return c[v]=b,s.update(e[v],l,b)})),h=p.llmOutput??{}}return{generations:c,llmOutput:h}}async call(e,r,n){const{generations:i}=await this.generate([e],r,n);return i[0][0].text}async predict(e,r,n){return this.call(e,r,n)}async predictMessages(e,r,n){const i=WS(e),a=await this.call(i,r,n);return new Nn(a)}_identifyingParams(){return{}}serialize(){return{...this._identifyingParams(),_type:this._llmType(),_model:this._modelType()}}_modelType(){return"base_llm"}}class Px extends Ds{async _generate(e,r,n){return{generations:await Promise.all(e.map((a,o)=>this._call(a,{...r,promptIndex:o},n).then(s=>[{text:s}])))}}}const WE=(t,e)=>t.reduce((r,n,i)=>{const a=Math.floor(i/e),o=r[a]||[];return r[a]=o.concat([n]),r},[]);let jx=class{constructor(e){Object.defineProperty(this,"caller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.caller=new Qc(e??{})}};class tS extends jx{constructor(e,r){const n={maxConcurrency:2,...e};super(n),Object.defineProperty(this,"modelName",{enumerable:!0,configurable:!0,writable:!0,value:"text-embedding-ada-002"}),Object.defineProperty(this,"model",{enumerable:!0,configurable:!0,writable:!0,value:"text-embedding-ada-002"}),Object.defineProperty(this,"batchSize",{enumerable:!0,configurable:!0,writable:!0,value:512}),Object.defineProperty(this,"stripNewLines",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"dimensions",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiVersion",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureADTokenProvider",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiInstanceName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiDeploymentName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIBasePath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"organization",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"clientConfig",{enumerable:!0,configurable:!0,writable:!0,value:void 0});let i=n?.apiKey??n?.openAIApiKey??Ye("OPENAI_API_KEY");const a=n?.azureOpenAIApiKey??Ye("AZURE_OPENAI_API_KEY");if(this.azureADTokenProvider=e?.azureADTokenProvider??void 0,!a&&!i&&!this.azureADTokenProvider)throw new Error("OpenAI or Azure OpenAI API key or Token Provider not found");const o=n?.azureOpenAIApiInstanceName??Ye("AZURE_OPENAI_API_INSTANCE_NAME"),s=(n?.azureOpenAIApiEmbeddingsDeploymentName||n?.azureOpenAIApiDeploymentName)??(Ye("AZURE_OPENAI_API_EMBEDDINGS_DEPLOYMENT_NAME")||Ye("AZURE_OPENAI_API_DEPLOYMENT_NAME")),l=n?.azureOpenAIApiVersion??Ye("AZURE_OPENAI_API_VERSION");if(this.azureOpenAIBasePath=n?.azureOpenAIBasePath??Ye("AZURE_OPENAI_BASE_PATH"),this.organization=n?.configuration?.organization??Ye("OPENAI_ORGANIZATION"),this.modelName=n?.model??n?.modelName??this.model,this.model=this.modelName,this.batchSize=n?.batchSize??(a?1:this.batchSize),this.stripNewLines=n?.stripNewLines??this.stripNewLines,this.timeout=n?.timeout,this.dimensions=n?.dimensions,this.azureOpenAIApiVersion=l,this.azureOpenAIApiKey=a,this.azureOpenAIApiInstanceName=o,this.azureOpenAIApiDeploymentName=s,this.azureOpenAIApiKey||this.azureADTokenProvider){if(!this.azureOpenAIApiInstanceName&&!this.azureOpenAIBasePath)throw new Error("Azure OpenAI API instance name not found");if(!this.azureOpenAIApiDeploymentName)throw new Error("Azure OpenAI API deployment name not found");if(!this.azureOpenAIApiVersion)throw new Error("Azure OpenAI API version not found");i=i??""}this.clientConfig={apiKey:i,organization:this.organization,baseURL:r?.basePath,dangerouslyAllowBrowser:!0,defaultHeaders:r?.baseOptions?.headers,defaultQuery:r?.baseOptions?.params,...r,...e?.configuration}}async embedDocuments(e){const r=WE(this.stripNewLines?e.map(o=>o.replace(/\n/g," ")):e,this.batchSize),n=r.map(o=>{const s={model:this.model,input:o};return this.dimensions&&(s.dimensions=this.dimensions),this.embeddingWithRetry(s)}),i=await Promise.all(n),a=[];for(let o=0;o<i.length;o+=1){const s=r[o],{data:l}=i[o];for(let c=0;c<s.length;c+=1)a.push(l[c].embedding)}return a}async embedQuery(e){const r={model:this.model,input:this.stripNewLines?e.replace(/\n/g," "):e};this.dimensions&&(r.dimensions=this.dimensions);const{data:n}=await this.embeddingWithRetry(r);return n[0].embedding}async embeddingWithRetry(e){if(!this.client){const n={azureOpenAIApiDeploymentName:this.azureOpenAIApiDeploymentName,azureOpenAIApiInstanceName:this.azureOpenAIApiInstanceName,azureOpenAIApiKey:this.azureOpenAIApiKey,azureOpenAIBasePath:this.azureOpenAIBasePath,baseURL:this.clientConfig.baseURL},i=hb(n),a={...this.clientConfig,baseURL:i,timeout:this.timeout,maxRetries:0};a.baseURL||delete a.baseURL,this.client=new De(a)}const r={};return this.azureOpenAIApiKey&&(r.headers={"api-key":this.azureOpenAIApiKey,...r.headers},r.query={"api-version":this.azureOpenAIApiVersion,...r.query}),this.caller.call(async()=>{try{return await this.client.embeddings.create(e,r)}catch(n){throw Ey(n)}})}}class oq extends tS{constructor(e,r){const n={...e};Object.entries(n).length&&(n.azureOpenAIApiDeploymentName=n.azureOpenAIApiDeploymentName??n.deploymentName,n.azureOpenAIApiKey=n.azureOpenAIApiKey??n.apiKey,n.azureOpenAIApiVersion=n.azureOpenAIApiVersion??n.openAIApiVersion),super(n,r)}async embeddingWithRetry(e){if(!this.client){const n={azureOpenAIApiDeploymentName:this.azureOpenAIApiDeploymentName,azureOpenAIApiInstanceName:this.azureOpenAIApiInstanceName,azureOpenAIApiKey:this.azureOpenAIApiKey,azureOpenAIBasePath:this.azureOpenAIBasePath,azureADTokenProvider:this.azureADTokenProvider,baseURL:this.clientConfig.baseURL},i=hb(n),a={...this.clientConfig,baseURL:i,timeout:this.timeout,maxRetries:0};this.azureADTokenProvider||(a.apiKey=n.azureOpenAIApiKey),a.baseURL||delete a.baseURL,a.defaultHeaders={...a.defaultHeaders,"User-Agent":a.defaultHeaders?.["User-Agent"]?`${a.defaultHeaders["User-Agent"]}: langchainjs-azure-openai-v2`:"langchainjs-azure-openai-v2"},this.client=new dx({apiVersion:this.azureOpenAIApiVersion,azureADTokenProvider:this.azureADTokenProvider,deployment:this.azureOpenAIApiDeploymentName,...a})}const r={};return this.azureOpenAIApiKey&&(r.headers={"api-key":this.azureOpenAIApiKey,...r.headers},r.query={"api-version":this.azureOpenAIApiVersion,...r.query}),this.caller.call(async()=>{try{return await this.client.embeddings.create(e,r)}catch(n){throw Ey(n)}})}}const js="0.37.0";let YC=!1,pc,Cx,rS,Mx,Tx,Rx;function sq(t,e={auto:!1}){if(YC)throw new Error(`you must \`import '@anthropic-ai/sdk/shims/${t.kind}'\` before importing anything else from @anthropic-ai/sdk`);if(pc)throw new Error(`can't \`import '@anthropic-ai/sdk/shims/${t.kind}'\` after \`import '@anthropic-ai/sdk/shims/${pc}'\``);YC=e.auto,pc=t.kind,Cx=t.fetch,rS=t.File,Mx=t.ReadableStream,Tx=t.getDefaultAgent,Rx=t.fileFromPath}let uq=class{constructor(e){this.body=e}get[Symbol.toStringTag](){return"MultipartBody"}};function lq({manuallyImported:t}={}){const e=t?"You may need to use polyfills":"Add one of these imports before your first `import  from '@anthropic-ai/sdk'`:\n- `import '@anthropic-ai/sdk/shims/node'` (if you're running on Node)\n- `import '@anthropic-ai/sdk/shims/web'` (otherwise)\n";let r,n,i,a;try{r=fetch,n=Request,i=Response,a=Headers}catch(o){throw new Error(`this environment is missing the following Web Fetch API type: ${o.message}. ${e}`)}return{kind:"web",fetch:r,Request:n,Response:i,Headers:a,FormData:typeof FormData<"u"?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${e}`)}},Blob:typeof Blob<"u"?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${e}`)}},File:typeof File<"u"?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${e}`)}},ReadableStream:typeof ReadableStream<"u"?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${e}`)}},getMultipartRequestOptions:async(o,s)=>({...s,body:new uq(o)}),getDefaultAgent:o=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/anthropics/anthropic-sdk-typescript#file-uploads")},isFsReadStream:o=>!1}}pc||sq(lq(),{auto:!0});class qe extends Error{}let Xr=class nS extends qe{constructor(e,r,n,i){super(`${nS.makeMessage(e,r,n)}`),this.status=e,this.headers=i,this.request_id=i?.["request-id"],this.error=r}static makeMessage(e,r,n){const i=r?.message?typeof r.message=="string"?r.message:JSON.stringify(r.message):r?JSON.stringify(r):n;return e&&i?`${e} ${i}`:e?`${e} status code (no body)`:i||"(no status code or body)"}static generate(e,r,n,i){if(!e||!i)return new pb({message:n,cause:iS(r)});const a=r;return e===400?new $x(e,a,n,i):e===401?new Ix(e,a,n,i):e===403?new xx(e,a,n,i):e===404?new Dx(e,a,n,i):e===409?new Nx(e,a,n,i):e===422?new zx(e,a,n,i):e===429?new Bx(e,a,n,i):e>=500?new Ux(e,a,n,i):new nS(e,a,n,i)}},In=class extends Xr{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}},pb=class extends Xr{constructor({message:e,cause:r}){super(void 0,void 0,e||"Connection error.",void 0),r&&(this.cause=r)}},Ax=class extends pb{constructor({message:e}={}){super({message:e??"Request timed out."})}},$x=class extends Xr{},Ix=class extends Xr{},xx=class extends Xr{},Dx=class extends Xr{},Nx=class extends Xr{},zx=class extends Xr{},Bx=class extends Xr{},Ux=class extends Xr{};var Bp=function(t,e,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(t,r):i?i.value=r:e.set(t,r),r},Ga=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},kr;let ld=class{constructor(){kr.set(this,void 0),this.buffer=new Uint8Array,Bp(this,kr,null,"f")}decode(e){if(e==null)return[];const r=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?new TextEncoder().encode(e):e;let n=new Uint8Array(this.buffer.length+r.length);n.set(this.buffer),n.set(r,this.buffer.length),this.buffer=n;const i=[];let a;for(;(a=cq(this.buffer,Ga(this,kr,"f")))!=null;){if(a.carriage&&Ga(this,kr,"f")==null){Bp(this,kr,a.index,"f");continue}if(Ga(this,kr,"f")!=null&&(a.index!==Ga(this,kr,"f")+1||a.carriage)){i.push(this.decodeText(this.buffer.slice(0,Ga(this,kr,"f")-1))),this.buffer=this.buffer.slice(Ga(this,kr,"f")),Bp(this,kr,null,"f");continue}const o=Ga(this,kr,"f")!==null?a.preceding-1:a.preceding,s=this.decodeText(this.buffer.slice(0,o));i.push(s),this.buffer=this.buffer.slice(a.index),Bp(this,kr,null,"f")}return i}decodeText(e){if(e==null)return"";if(typeof e=="string")return e;if(typeof Buffer<"u"){if(e instanceof Buffer)return e.toString();if(e instanceof Uint8Array)return Buffer.from(e).toString();throw new qe(`Unexpected: received non-Uint8Array (${e.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if(typeof TextDecoder<"u"){if(e instanceof Uint8Array||e instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(e);throw new qe(`Unexpected: received non-Uint8Array/ArrayBuffer (${e.constructor.name}) in a web platform. Please report this error.`)}throw new qe("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){return this.buffer.length?this.decode(`
`):[]}};kr=new WeakMap;ld.NEWLINE_CHARS=new Set([`
`,"\r"]);ld.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function cq(t,e){for(let i=e??0;i<t.length;i++){if(t[i]===10)return{preceding:i,index:i+1,carriage:!1};if(t[i]===13)return{preceding:i,index:i+1,carriage:!0}}return null}function dq(t){for(let n=0;n<t.length-1;n++){if(t[n]===10&&t[n+1]===10||t[n]===13&&t[n+1]===13)return n+2;if(t[n]===13&&t[n+1]===10&&n+3<t.length&&t[n+2]===13&&t[n+3]===10)return n+4}return-1}function KE(t){if(t[Symbol.asyncIterator])return t;const e=t.getReader();return{async next(){try{const r=await e.read();return r?.done&&e.releaseLock(),r}catch(r){throw e.releaseLock(),r}},async return(){const r=e.cancel();return e.releaseLock(),await r,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}let Fc=class ic{constructor(e,r){this.iterator=e,this.controller=r}static fromSSEResponse(e,r){let n=!1;async function*i(){if(n)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");n=!0;let a=!1;try{for await(const o of fq(e,r)){if(o.event==="completion")try{yield JSON.parse(o.data)}catch(s){throw console.error("Could not parse message into JSON:",o.data),console.error("From chunk:",o.raw),s}if(o.event==="message_start"||o.event==="message_delta"||o.event==="message_stop"||o.event==="content_block_start"||o.event==="content_block_delta"||o.event==="content_block_stop")try{yield JSON.parse(o.data)}catch(s){throw console.error("Could not parse message into JSON:",o.data),console.error("From chunk:",o.raw),s}if(o.event!=="ping"&&o.event==="error")throw Xr.generate(void 0,`SSE Error: ${o.data}`,o.data,qx(e.headers))}a=!0}catch(o){if(o instanceof Error&&o.name==="AbortError")return;throw o}finally{a||r.abort()}}return new ic(i,r)}static fromReadableStream(e,r){let n=!1;async function*i(){const o=new ld,s=KE(e);for await(const l of s)for(const c of o.decode(l))yield c;for(const l of o.flush())yield l}async function*a(){if(n)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");n=!0;let o=!1;try{for await(const s of i())o||s&&(yield JSON.parse(s));o=!0}catch(s){if(s instanceof Error&&s.name==="AbortError")return;throw s}finally{o||r.abort()}}return new ic(a,r)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],r=[],n=this.iterator(),i=a=>({next:()=>{if(a.length===0){const o=n.next();e.push(o),r.push(o)}return a.shift()}});return[new ic(()=>i(e),this.controller),new ic(()=>i(r),this.controller)]}toReadableStream(){const e=this;let r;const n=new TextEncoder;return new Mx({async start(){r=e[Symbol.asyncIterator]()},async pull(i){try{const{value:a,done:o}=await r.next();if(o)return i.close();const s=n.encode(JSON.stringify(a)+`
`);i.enqueue(s)}catch(a){i.error(a)}},async cancel(){await r.return?.()}})}};async function*fq(t,e){if(!t.body)throw e.abort(),new qe("Attempted to iterate over a response with no body");const r=new pq,n=new ld,i=KE(t.body);for await(const a of hq(i))for(const o of n.decode(a)){const s=r.decode(o);s&&(yield s)}for(const a of n.flush()){const o=r.decode(a);o&&(yield o)}}async function*hq(t){let e=new Uint8Array;for await(const r of t){if(r==null)continue;const n=r instanceof ArrayBuffer?new Uint8Array(r):typeof r=="string"?new TextEncoder().encode(r):r;let i=new Uint8Array(e.length+n.length);i.set(e),i.set(n,e.length),e=i;let a;for(;(a=dq(e))!==-1;)yield e.slice(0,a),e=e.slice(a)}e.length>0&&(yield e)}let pq=class{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const a={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],a}if(this.chunks.push(e),e.startsWith(":"))return null;let[r,n,i]=_q(e,":");return i.startsWith(" ")&&(i=i.substring(1)),r==="event"?this.event=i:r==="data"&&this.data.push(i),null}};function _q(t,e){const r=t.indexOf(e);return r!==-1?[t.substring(0,r),e,t.substring(r+e.length)]:[t,"",""]}const yq=t=>t!=null&&typeof t=="object"&&typeof t.url=="string"&&typeof t.blob=="function",bq=t=>t!=null&&typeof t=="object"&&typeof t.name=="string"&&typeof t.lastModified=="number"&&_b(t),_b=t=>t!=null&&typeof t=="object"&&typeof t.size=="number"&&typeof t.type=="string"&&typeof t.text=="function"&&typeof t.slice=="function"&&typeof t.arrayBuffer=="function";async function gq(t,e,r){if(t=await t,bq(t))return t;if(yq(t)){const i=await t.blob();e||(e=new URL(t.url).pathname.split(/[\\/]/).pop()??"unknown_file");const a=_b(i)?[await i.arrayBuffer()]:[i];return new rS(a,e,r)}const n=await mq(t);if(e||(e=wq(t)??"unknown_file"),!r?.type){const i=n[0]?.type;typeof i=="string"&&(r={...r,type:i})}return new rS(n,e,r)}async function mq(t){let e=[];if(typeof t=="string"||ArrayBuffer.isView(t)||t instanceof ArrayBuffer)e.push(t);else if(_b(t))e.push(await t.arrayBuffer());else if(Oq(t))for await(const r of t)e.push(r);else throw new Error(`Unexpected data type: ${typeof t}; constructor: ${t?.constructor?.name}; props: ${vq(t)}`);return e}function vq(t){return`[${Object.getOwnPropertyNames(t).map(r=>`"${r}"`).join(", ")}]`}function wq(t){return Sw(t.name)||Sw(t.filename)||Sw(t.path)?.split(/[\\/]/).pop()}const Sw=t=>{if(typeof t=="string")return t;if(typeof Buffer<"u"&&t instanceof Buffer)return String(t)},Oq=t=>t!=null&&typeof t=="object"&&typeof t[Symbol.asyncIterator]=="function",QC=t=>t&&typeof t=="object"&&t.body&&t[Symbol.toStringTag]==="MultipartBody";var Fx={},Sq=function(t,e,r,n,i){if(typeof e=="function"?t!==e||!0:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(t,r),r},Eq=function(t,e,r,n){if(typeof e=="function"?t!==e||!0:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},Up;async function Lx(t){const{response:e}=t;if(t.options.stream)return Hs("response",e.status,e.url,e.headers,e.body),t.options.__streamClass?t.options.__streamClass.fromSSEResponse(e,t.controller):Fc.fromSSEResponse(e,t.controller);if(e.status===204)return null;if(t.options.__binaryResponse)return e;const r=e.headers.get("content-type");if(r?.includes("application/json")||r?.includes("application/vnd.api+json")){const a=await e.json();return Hs("response",e.status,e.url,e.headers,a),Vx(a,e)}const i=await e.text();return Hs("response",e.status,e.url,e.headers,i),i}function Vx(t,e){return!t||typeof t!="object"||Array.isArray(t)?t:Object.defineProperty(t,"_request_id",{value:e.headers.get("request-id"),enumerable:!1})}let kx=class Hx extends Promise{constructor(e,r=Lx){super(n=>{n(null)}),this.responsePromise=e,this.parseResponse=r}_thenUnwrap(e){return new Hx(this.responsePromise,async r=>Vx(e(await this.parseResponse(r),r),r.response))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,r]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:r,request_id:r.headers.get("request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(e,r){return this.parse().then(e,r)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}},Pq=class{constructor({baseURL:e,maxRetries:r=2,timeout:n=6e5,httpAgent:i,fetch:a}){this.baseURL=e,this.maxRetries=Ew("maxRetries",r),this.timeout=Ew("timeout",n),this.httpAgent=i,this.fetch=a??Cx}authHeaders(e){return{}}defaultHeaders(e){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...Aq(),...this.authHeaders(e)}}validateHeaders(e,r){}defaultIdempotencyKey(){return`stainless-node-retry-${Nq()}`}get(e,r){return this.methodRequest("get",e,r)}post(e,r){return this.methodRequest("post",e,r)}patch(e,r){return this.methodRequest("patch",e,r)}put(e,r){return this.methodRequest("put",e,r)}delete(e,r){return this.methodRequest("delete",e,r)}methodRequest(e,r,n){return this.request(Promise.resolve(n).then(async i=>{const a=i&&_b(i?.body)?new DataView(await i.body.arrayBuffer()):i?.body instanceof DataView?i.body:i?.body instanceof ArrayBuffer?new DataView(i.body):i&&ArrayBuffer.isView(i?.body)?new DataView(i.body.buffer):i?.body;return{method:e,path:r,...i,body:a}}))}getAPIList(e,r,n){return this.requestAPIList(r,{method:"get",path:e,...n})}calculateContentLength(e){if(typeof e=="string"){if(typeof Buffer<"u")return Buffer.byteLength(e,"utf8").toString();if(typeof TextEncoder<"u")return new TextEncoder().encode(e).length.toString()}else if(ArrayBuffer.isView(e))return e.byteLength.toString();return null}buildRequest(e,{retryCount:r=0}={}){e={...e};const{method:n,path:i,query:a,headers:o={}}=e,s=ArrayBuffer.isView(e.body)||e.__binaryRequest&&typeof e.body=="string"?e.body:QC(e.body)?e.body.body:e.body?JSON.stringify(e.body,null,2):null,l=this.calculateContentLength(s),c=this.buildURL(i,a);"timeout"in e&&Ew("timeout",e.timeout),e.timeout=e.timeout??this.timeout;const d=e.httpAgent??this.httpAgent??Tx(c),f=e.timeout+1e3;typeof d?.options?.timeout=="number"&&f>(d.options.timeout??0)&&(d.options.timeout=f),this.idempotencyHeader&&n!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),o[this.idempotencyHeader]=e.idempotencyKey);const h=this.buildHeaders({options:e,headers:o,contentLength:l,retryCount:r});return{req:{method:n,...s&&{body:s},headers:h,...d&&{agent:d},signal:e.signal??null},url:c,timeout:e.timeout}}buildHeaders({options:e,headers:r,contentLength:n,retryCount:i}){const a={};n&&(a["content-length"]=n);const o=this.defaultHeaders(e);return nM(a,o),nM(a,r),QC(e.body)&&pc!=="node"&&delete a["content-type"],Fp(o,"x-stainless-retry-count")===void 0&&Fp(r,"x-stainless-retry-count")===void 0&&(a["x-stainless-retry-count"]=String(i)),Fp(o,"x-stainless-timeout")===void 0&&Fp(r,"x-stainless-timeout")===void 0&&e.timeout&&(a["x-stainless-timeout"]=String(e.timeout)),this.validateHeaders(a,r),a}_calculateNonstreamingTimeout(e){if(3600*e/128e3>600)throw new qe("Streaming is strongly recommended for operations that may take longer than 10 minutes. See https://github.com/anthropics/anthropic-sdk-python#streaming-responses for more details");return 600*1e3}async prepareOptions(e){}async prepareRequest(e,{url:r,options:n}){}parseHeaders(e){return e?Symbol.iterator in e?Object.fromEntries(Array.from(e).map(r=>[...r])):{...e}:{}}makeStatusError(e,r,n,i){return Xr.generate(e,r,n,i)}request(e,r=null){return new kx(this.makeRequest(e,r))}async makeRequest(e,r){const n=await e,i=n.maxRetries??this.maxRetries;r==null&&(r=i),await this.prepareOptions(n);const{req:a,url:o,timeout:s}=this.buildRequest(n,{retryCount:i-r});if(await this.prepareRequest(a,{url:o,options:n}),Hs("request",o,n,a.headers),n.signal?.aborted)throw new In;const l=new AbortController,c=await this.fetchWithTimeout(o,a,s,l).catch(iS);if(c instanceof Error){if(n.signal?.aborted)throw new In;if(r)return this.retryRequest(n,r);throw c.name==="AbortError"?new Ax:new pb({cause:c})}const d=qx(c.headers);if(!c.ok){if(r&&this.shouldRetry(c)){const v=`retrying, ${r} attempts remaining`;return Hs(`response (error; ${v})`,c.status,o,d),this.retryRequest(n,r,d)}const f=await c.text().catch(v=>iS(v).message),h=$q(f),p=h?void 0:f;throw Hs(`response (error; ${r?"(error; no more retries left)":"(error; not retryable)"})`,c.status,o,d,p),this.makeStatusError(c.status,h,p,d)}return{response:c,options:n,controller:l}}requestAPIList(e,r){const n=this.makeRequest(r,null);return new Cq(this,n,e)}buildURL(e,r){const n=xq(e)?new URL(e):new URL(this.baseURL+(this.baseURL.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),i=this.defaultQuery();return jy(i)||(r={...i,...r}),typeof r=="object"&&r&&!Array.isArray(r)&&(n.search=this.stringifyQuery(r)),n.toString()}stringifyQuery(e){return Object.entries(e).filter(([r,n])=>typeof n<"u").map(([r,n])=>{if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")return`${encodeURIComponent(r)}=${encodeURIComponent(n)}`;if(n===null)return`${encodeURIComponent(r)}=`;throw new qe(`Cannot stringify type ${typeof n}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}async fetchWithTimeout(e,r,n,i){const{signal:a,...o}=r||{};a&&a.addEventListener("abort",()=>i.abort());const s=setTimeout(()=>i.abort(),n),l={signal:i.signal,...o};l.method&&(l.method=l.method.toUpperCase());const c=60*1e3,d=setTimeout(()=>{if(l&&l?.agent?.sockets)for(const f of Object.values(l?.agent?.sockets).flat())f?.setKeepAlive&&f.setKeepAlive(!0,c)},c);return this.fetch.call(void 0,e,l).finally(()=>{clearTimeout(s),clearTimeout(d)})}shouldRetry(e){const r=e.headers.get("x-should-retry");return r==="true"?!0:r==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,r,n){let i;const a=n?.["retry-after-ms"];if(a){const s=parseFloat(a);Number.isNaN(s)||(i=s)}const o=n?.["retry-after"];if(o&&!i){const s=parseFloat(o);Number.isNaN(s)?i=Date.parse(o)-Date.now():i=s*1e3}if(!(i&&0<=i&&i<60*1e3)){const s=e.maxRetries??this.maxRetries;i=this.calculateDefaultRetryTimeoutMillis(r,s)}return await Dq(i),this.makeRequest(e,r-1)}calculateDefaultRetryTimeoutMillis(e,r){const a=r-e,o=Math.min(.5*Math.pow(2,a),8),s=1-Math.random()*.25;return o*s*1e3}getUserAgent(){return`${this.constructor.name}/JS ${js}`}};class jq{constructor(e,r,n,i){Up.set(this,void 0),Sq(this,Up,e),this.options=i,this.response=r,this.body=n}hasNextPage(){return this.getPaginatedItems().length?this.nextPageInfo()!=null:!1}async getNextPage(){const e=this.nextPageInfo();if(!e)throw new qe("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");const r={...this.options};if("params"in e&&typeof r.query=="object")r.query={...r.query,...e.params};else if("url"in e){const n=[...Object.entries(r.query||{}),...e.url.searchParams.entries()];for(const[i,a]of n)e.url.searchParams.set(i,a);r.query=void 0,r.path=e.url.toString()}return await Eq(this,Up,"f").requestAPIList(this.constructor,r)}async*iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async*[(Up=new WeakMap,Symbol.asyncIterator)](){for await(const e of this.iterPages())for(const r of e.getPaginatedItems())yield r}}let Cq=class extends kx{constructor(e,r,n){super(r,async i=>new n(e,i.response,await Lx(i),i.options))}async*[Symbol.asyncIterator](){const e=await this;for await(const r of e)yield r}};const qx=t=>new Proxy(Object.fromEntries(t.entries()),{get(e,r){const n=r.toString();return e[n.toLowerCase()]||e[n]}}),Mq={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0,__binaryRequest:!0,__binaryResponse:!0,__streamClass:!0},_a=t=>typeof t=="object"&&t!==null&&!jy(t)&&Object.keys(t).every(e=>Gx(Mq,e)),Tq=()=>{if(typeof Deno<"u"&&Deno.build!=null)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":js,"X-Stainless-OS":tM(Deno.build.os),"X-Stainless-Arch":eM(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:Deno.version?.deno??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":js,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":process.version};if(Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":js,"X-Stainless-OS":tM(process.platform),"X-Stainless-Arch":eM(process.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":process.version};const t=Rq();return t?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":js,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${t.browser}`,"X-Stainless-Runtime-Version":t.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":js,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function Rq(){if(typeof navigator>"u"||!navigator)return null;const t=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:r}of t){const n=r.exec(navigator.userAgent);if(n){const i=n[1]||0,a=n[2]||0,o=n[3]||0;return{browser:e,version:`${i}.${a}.${o}`}}}return null}const eM=t=>t==="x32"?"x32":t==="x86_64"||t==="x64"?"x64":t==="arm"?"arm":t==="aarch64"||t==="arm64"?"arm64":t?`other:${t}`:"unknown",tM=t=>(t=t.toLowerCase(),t.includes("ios")?"iOS":t==="android"?"Android":t==="darwin"?"MacOS":t==="win32"?"Windows":t==="freebsd"?"FreeBSD":t==="openbsd"?"OpenBSD":t==="linux"?"Linux":t?`Other:${t}`:"Unknown");let rM;const Aq=()=>rM??(rM=Tq()),$q=t=>{try{return JSON.parse(t)}catch{return}},Iq=/^[a-z][a-z0-9+.-]*:/i,xq=t=>Iq.test(t),Dq=t=>new Promise(e=>setTimeout(e,t)),Ew=(t,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new qe(`${t} must be an integer`);if(e<0)throw new qe(`${t} must be a positive integer`);return e},iS=t=>{if(t instanceof Error)return t;if(typeof t=="object"&&t!==null)try{return new Error(JSON.stringify(t))}catch{}return new Error(String(t))},Pw=t=>{if(typeof process<"u")return Fx?.[t]?.trim()??void 0;if(typeof Deno<"u")return Deno.env?.get?.(t)?.trim()};function jy(t){if(!t)return!0;for(const e in t)return!1;return!0}function Gx(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function nM(t,e){for(const r in e){if(!Gx(e,r))continue;const n=r.toLowerCase();if(!n)continue;const i=e[r];i===null?delete t[n]:i!==void 0&&(t[n]=i)}}function Hs(t,...e){typeof process<"u"&&Fx?.DEBUG==="true"&&console.log(`Anthropic:DEBUG:${t}`,...e)}const Nq=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{const e=Math.random()*16|0;return(t==="x"?e:e&3|8).toString(16)}),zq=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u",Bq=t=>typeof t?.get=="function",Fp=(t,e)=>{const r=e.toLowerCase();if(Bq(t)){const n=e[0]?.toUpperCase()+e.substring(1).replace(/([^\w])(\w)/g,(i,a,o)=>a+o.toUpperCase());for(const i of[e,r,e.toUpperCase(),n]){const a=t.get(i);if(a)return a}}for(const[n,i]of Object.entries(t))if(n.toLowerCase()===r)return Array.isArray(i)?(i.length<=1||console.warn(`Received ${i.length} entries for the ${e} header, using the first entry.`),i[0]):i};class yb extends jq{constructor(e,r,n,i){super(e,r,n,i),this.data=n.data||[],this.has_more=n.has_more||!1,this.first_id=n.first_id||null,this.last_id=n.last_id||null}getPaginatedItems(){return this.data??[]}hasNextPage(){return this.has_more===!1?!1:super.hasNextPage()}nextPageParams(){const e=this.nextPageInfo();if(!e)return null;if("params"in e)return e.params;const r=Object.fromEntries(e.url.searchParams);return Object.keys(r).length?r:null}nextPageInfo(){if(this.options.query?.before_id){const r=this.first_id;return r?{params:{before_id:r}}:null}const e=this.last_id;return e?{params:{after_id:e}}:null}}let Ia=class{constructor(e){this._client=e}},JE=class extends Ia{retrieve(e,r){return this._client.get(`/v1/models/${e}?beta=true`,r)}list(e={},r){return _a(e)?this.list({},e):this._client.getAPIList("/v1/models?beta=true",XE,{query:e,...r})}};class XE extends yb{}JE.BetaModelInfosPage=XE;class bb{constructor(e,r){this.iterator=e,this.controller=r}async*decoder(){const e=new ld;for await(const r of this.iterator)for(const n of e.decode(r))yield JSON.parse(n);for(const r of e.flush())yield JSON.parse(r)}[Symbol.asyncIterator](){return this.decoder()}static fromResponse(e,r){if(!e.body)throw r.abort(),new qe("Attempted to iterate over a response with no body");return new bb(KE(e.body),r)}}let ZE=class extends Ia{create(e,r){const{betas:n,...i}=e;return this._client.post("/v1/messages/batches?beta=true",{body:i,...r,headers:{"anthropic-beta":[...n??[],"message-batches-2024-09-24"].toString(),...r?.headers}})}retrieve(e,r={},n){if(_a(r))return this.retrieve(e,{},r);const{betas:i}=r;return this._client.get(`/v1/messages/batches/${e}?beta=true`,{...n,headers:{"anthropic-beta":[...i??[],"message-batches-2024-09-24"].toString(),...n?.headers}})}list(e={},r){if(_a(e))return this.list({},e);const{betas:n,...i}=e;return this._client.getAPIList("/v1/messages/batches?beta=true",YE,{query:i,...r,headers:{"anthropic-beta":[...n??[],"message-batches-2024-09-24"].toString(),...r?.headers}})}delete(e,r={},n){if(_a(r))return this.delete(e,{},r);const{betas:i}=r;return this._client.delete(`/v1/messages/batches/${e}?beta=true`,{...n,headers:{"anthropic-beta":[...i??[],"message-batches-2024-09-24"].toString(),...n?.headers}})}cancel(e,r={},n){if(_a(r))return this.cancel(e,{},r);const{betas:i}=r;return this._client.post(`/v1/messages/batches/${e}/cancel?beta=true`,{...n,headers:{"anthropic-beta":[...i??[],"message-batches-2024-09-24"].toString(),...n?.headers}})}async results(e,r={},n){if(_a(r))return this.results(e,{},r);const i=await this.retrieve(e);if(!i.results_url)throw new qe(`No batch \`results_url\`; Has it finished processing? ${i.processing_status} - ${i.id}`);const{betas:a}=r;return this._client.get(i.results_url,{...n,headers:{"anthropic-beta":[...a??[],"message-batches-2024-09-24"].toString(),Accept:"application/binary",...n?.headers},__binaryResponse:!0})._thenUnwrap((o,s)=>bb.fromResponse(s.response,s.controller))}};class YE extends yb{}ZE.BetaMessageBatchesPage=YE;const Uq=t=>{let e=0,r=[];for(;e<t.length;){let n=t[e];if(n==="\\"){e++;continue}if(n==="{"){r.push({type:"brace",value:"{"}),e++;continue}if(n==="}"){r.push({type:"brace",value:"}"}),e++;continue}if(n==="["){r.push({type:"paren",value:"["}),e++;continue}if(n==="]"){r.push({type:"paren",value:"]"}),e++;continue}if(n===":"){r.push({type:"separator",value:":"}),e++;continue}if(n===","){r.push({type:"delimiter",value:","}),e++;continue}if(n==='"'){let s="",l=!1;for(n=t[++e];n!=='"';){if(e===t.length){l=!0;break}if(n==="\\"){if(e++,e===t.length){l=!0;break}s+=n+t[e],n=t[++e]}else s+=n,n=t[++e]}n=t[++e],l||r.push({type:"string",value:s});continue}if(n&&/\s/.test(n)){e++;continue}let a=/[0-9]/;if(n&&a.test(n)||n==="-"||n==="."){let s="";for(n==="-"&&(s+=n,n=t[++e]);n&&a.test(n)||n===".";)s+=n,n=t[++e];r.push({type:"number",value:s});continue}let o=/[a-z]/i;if(n&&o.test(n)){let s="";for(;n&&o.test(n)&&e!==t.length;)s+=n,n=t[++e];if(s=="true"||s=="false"||s==="null")r.push({type:"name",value:s});else{e++;continue}continue}e++}return r},Cs=t=>{if(t.length===0)return t;let e=t[t.length-1];switch(e.type){case"separator":return t=t.slice(0,t.length-1),Cs(t);case"number":let r=e.value[e.value.length-1];if(r==="."||r==="-")return t=t.slice(0,t.length-1),Cs(t);case"string":let n=t[t.length-2];if(n?.type==="delimiter")return t=t.slice(0,t.length-1),Cs(t);if(n?.type==="brace"&&n.value==="{")return t=t.slice(0,t.length-1),Cs(t);break;case"delimiter":return t=t.slice(0,t.length-1),Cs(t)}return t},Fq=t=>{let e=[];return t.map(r=>{r.type==="brace"&&(r.value==="{"?e.push("}"):e.splice(e.lastIndexOf("}"),1)),r.type==="paren"&&(r.value==="["?e.push("]"):e.splice(e.lastIndexOf("]"),1))}),e.length>0&&e.reverse().map(r=>{r==="}"?t.push({type:"brace",value:"}"}):r==="]"&&t.push({type:"paren",value:"]"})}),t},Lq=t=>{let e="";return t.map(r=>{switch(r.type){case"string":e+='"'+r.value+'"';break;default:e+=r.value;break}}),e},Wx=t=>JSON.parse(Lq(Fq(Cs(Uq(t)))));var nr=function(t,e,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(t,r):i?i.value=r:e.set(t,r),r},Fe=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},en,ea,dl,Lp,fl,hl,Vp,pl,_i,_l,kp,Hp,Yo,qp,Gp,jw,iM,Cw,Mw,Tw,Rw,aM;const oM="__json_buf";class Cy{constructor(){en.add(this),this.messages=[],this.receivedMessages=[],ea.set(this,void 0),this.controller=new AbortController,dl.set(this,void 0),Lp.set(this,()=>{}),fl.set(this,()=>{}),hl.set(this,void 0),Vp.set(this,()=>{}),pl.set(this,()=>{}),_i.set(this,{}),_l.set(this,!1),kp.set(this,!1),Hp.set(this,!1),Yo.set(this,!1),qp.set(this,void 0),Gp.set(this,void 0),Cw.set(this,e=>{if(nr(this,kp,!0,"f"),e instanceof Error&&e.name==="AbortError"&&(e=new In),e instanceof In)return nr(this,Hp,!0,"f"),this._emit("abort",e);if(e instanceof qe)return this._emit("error",e);if(e instanceof Error){const r=new qe(e.message);return r.cause=e,this._emit("error",r)}return this._emit("error",new qe(String(e)))}),nr(this,dl,new Promise((e,r)=>{nr(this,Lp,e,"f"),nr(this,fl,r,"f")}),"f"),nr(this,hl,new Promise((e,r)=>{nr(this,Vp,e,"f"),nr(this,pl,r,"f")}),"f"),Fe(this,dl,"f").catch(()=>{}),Fe(this,hl,"f").catch(()=>{})}get response(){return Fe(this,qp,"f")}get request_id(){return Fe(this,Gp,"f")}async withResponse(){const e=await Fe(this,dl,"f");if(!e)throw new Error("Could not resolve a `Response` object");return{data:this,response:e,request_id:e.headers.get("request-id")}}static fromReadableStream(e){const r=new Cy;return r._run(()=>r._fromReadableStream(e)),r}static createMessage(e,r,n){const i=new Cy;for(const a of r.messages)i._addMessageParam(a);return i._run(()=>i._createMessage(e,{...r,stream:!0},{...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"stream"}})),i}_run(e){e().then(()=>{this._emitFinal(),this._emit("end")},Fe(this,Cw,"f"))}_addMessageParam(e){this.messages.push(e)}_addMessage(e,r=!0){this.receivedMessages.push(e),r&&this._emit("message",e)}async _createMessage(e,r,n){const i=n?.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort())),Fe(this,en,"m",Mw).call(this);const{response:a,data:o}=await e.create({...r,stream:!0},{...n,signal:this.controller.signal}).withResponse();this._connected(a);for await(const s of o)Fe(this,en,"m",Tw).call(this,s);if(o.controller.signal?.aborted)throw new In;Fe(this,en,"m",Rw).call(this)}_connected(e){this.ended||(nr(this,qp,e,"f"),nr(this,Gp,e?.headers.get("request-id"),"f"),Fe(this,Lp,"f").call(this,e),this._emit("connect"))}get ended(){return Fe(this,_l,"f")}get errored(){return Fe(this,kp,"f")}get aborted(){return Fe(this,Hp,"f")}abort(){this.controller.abort()}on(e,r){return(Fe(this,_i,"f")[e]||(Fe(this,_i,"f")[e]=[])).push({listener:r}),this}off(e,r){const n=Fe(this,_i,"f")[e];if(!n)return this;const i=n.findIndex(a=>a.listener===r);return i>=0&&n.splice(i,1),this}once(e,r){return(Fe(this,_i,"f")[e]||(Fe(this,_i,"f")[e]=[])).push({listener:r,once:!0}),this}emitted(e){return new Promise((r,n)=>{nr(this,Yo,!0,"f"),e!=="error"&&this.once("error",n),this.once(e,r)})}async done(){nr(this,Yo,!0,"f"),await Fe(this,hl,"f")}get currentMessage(){return Fe(this,ea,"f")}async finalMessage(){return await this.done(),Fe(this,en,"m",jw).call(this)}async finalText(){return await this.done(),Fe(this,en,"m",iM).call(this)}_emit(e,...r){if(Fe(this,_l,"f"))return;e==="end"&&(nr(this,_l,!0,"f"),Fe(this,Vp,"f").call(this));const n=Fe(this,_i,"f")[e];if(n&&(Fe(this,_i,"f")[e]=n.filter(i=>!i.once),n.forEach(({listener:i})=>i(...r))),e==="abort"){const i=r[0];!Fe(this,Yo,"f")&&!n?.length&&Promise.reject(i),Fe(this,fl,"f").call(this,i),Fe(this,pl,"f").call(this,i),this._emit("end");return}if(e==="error"){const i=r[0];!Fe(this,Yo,"f")&&!n?.length&&Promise.reject(i),Fe(this,fl,"f").call(this,i),Fe(this,pl,"f").call(this,i),this._emit("end")}}_emitFinal(){this.receivedMessages.at(-1)&&this._emit("finalMessage",Fe(this,en,"m",jw).call(this))}async _fromReadableStream(e,r){const n=r?.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),Fe(this,en,"m",Mw).call(this),this._connected(null);const i=Fc.fromReadableStream(e,this.controller);for await(const a of i)Fe(this,en,"m",Tw).call(this,a);if(i.controller.signal?.aborted)throw new In;Fe(this,en,"m",Rw).call(this)}[(ea=new WeakMap,dl=new WeakMap,Lp=new WeakMap,fl=new WeakMap,hl=new WeakMap,Vp=new WeakMap,pl=new WeakMap,_i=new WeakMap,_l=new WeakMap,kp=new WeakMap,Hp=new WeakMap,Yo=new WeakMap,qp=new WeakMap,Gp=new WeakMap,Cw=new WeakMap,en=new WeakSet,jw=function(){if(this.receivedMessages.length===0)throw new qe("stream ended without producing a Message with role=assistant");return this.receivedMessages.at(-1)},iM=function(){if(this.receivedMessages.length===0)throw new qe("stream ended without producing a Message with role=assistant");const r=this.receivedMessages.at(-1).content.filter(n=>n.type==="text").map(n=>n.text);if(r.length===0)throw new qe("stream ended without producing a content block with type=text");return r.join(" ")},Mw=function(){this.ended||nr(this,ea,void 0,"f")},Tw=function(r){if(this.ended)return;const n=Fe(this,en,"m",aM).call(this,r);switch(this._emit("streamEvent",r,n),r.type){case"content_block_delta":{const i=n.content.at(-1);switch(r.delta.type){case"text_delta":{i.type==="text"&&this._emit("text",r.delta.text,i.text||"");break}case"citations_delta":{i.type==="text"&&this._emit("citation",r.delta.citation,i.citations??[]);break}case"input_json_delta":{i.type==="tool_use"&&i.input&&this._emit("inputJson",r.delta.partial_json,i.input);break}case"thinking_delta":{i.type==="thinking"&&this._emit("thinking",r.delta.thinking,i.thinking);break}case"signature_delta":{i.type==="thinking"&&this._emit("signature",i.signature);break}default:r.delta}break}case"message_stop":{this._addMessageParam(n),this._addMessage(n,!0);break}case"content_block_stop":{this._emit("contentBlock",n.content.at(-1));break}case"message_start":{nr(this,ea,n,"f");break}}},Rw=function(){if(this.ended)throw new qe("stream has ended, this shouldn't happen");const r=Fe(this,ea,"f");if(!r)throw new qe("request ended without sending any chunks");return nr(this,ea,void 0,"f"),r},aM=function(r){let n=Fe(this,ea,"f");if(r.type==="message_start"){if(n)throw new qe(`Unexpected event order, got ${r.type} before receiving "message_stop"`);return r.message}if(!n)throw new qe(`Unexpected event order, got ${r.type} before "message_start"`);switch(r.type){case"message_stop":return n;case"message_delta":return n.stop_reason=r.delta.stop_reason,n.stop_sequence=r.delta.stop_sequence,n.usage.output_tokens=r.usage.output_tokens,n;case"content_block_start":return n.content.push(r.content_block),n;case"content_block_delta":{const i=n.content.at(r.index);switch(r.delta.type){case"text_delta":{i?.type==="text"&&(i.text+=r.delta.text);break}case"citations_delta":{i?.type==="text"&&(i.citations??(i.citations=[]),i.citations.push(r.delta.citation));break}case"input_json_delta":{if(i?.type==="tool_use"){let a=i[oM]||"";a+=r.delta.partial_json,Object.defineProperty(i,oM,{value:a,enumerable:!1,writable:!0}),a&&(i.input=Wx(a))}break}case"thinking_delta":{i?.type==="thinking"&&(i.thinking+=r.delta.thinking);break}case"signature_delta":{i?.type==="thinking"&&(i.signature=r.delta.signature);break}default:r.delta}return n}case"content_block_stop":return n}},Symbol.asyncIterator)](){const e=[],r=[];let n=!1;return this.on("streamEvent",i=>{const a=r.shift();a?a.resolve(i):e.push(i)}),this.on("end",()=>{n=!0;for(const i of r)i.resolve(void 0);r.length=0}),this.on("abort",i=>{n=!0;for(const a of r)a.reject(i);r.length=0}),this.on("error",i=>{n=!0;for(const a of r)a.reject(i);r.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:n?{value:void 0,done:!0}:new Promise((a,o)=>r.push({resolve:a,reject:o})).then(a=>a?{value:a,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new Fc(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}const sM={"claude-1.3":"November 6th, 2024","claude-1.3-100k":"November 6th, 2024","claude-instant-1.1":"November 6th, 2024","claude-instant-1.1-100k":"November 6th, 2024","claude-instant-1.2":"November 6th, 2024","claude-3-sonnet-20240229":"July 21st, 2025","claude-2.1":"July 21st, 2025","claude-2.0":"July 21st, 2025"};let gb=class extends Ia{constructor(){super(...arguments),this.batches=new ZE(this._client)}create(e,r){const{betas:n,...i}=e;return i.model in sM&&console.warn(`The model '${i.model}' is deprecated and will reach end-of-life on ${sM[i.model]}
Please migrate to a newer model. Visit https://docs.anthropic.com/en/docs/resources/model-deprecations for more information.`),this._client.post("/v1/messages?beta=true",{body:i,timeout:this._client._options.timeout??(i.stream?6e5:this._client._calculateNonstreamingTimeout(i.max_tokens)),...r,headers:{...n?.toString()!=null?{"anthropic-beta":n?.toString()}:void 0,...r?.headers},stream:e.stream??!1})}stream(e,r){return Cy.createMessage(this,e,r)}countTokens(e,r){const{betas:n,...i}=e;return this._client.post("/v1/messages/count_tokens?beta=true",{body:i,...r,headers:{"anthropic-beta":[...n??[],"token-counting-2024-11-01"].toString(),...r?.headers}})}};gb.Batches=ZE;gb.BetaMessageBatchesPage=YE;class cd extends Ia{constructor(){super(...arguments),this.models=new JE(this._client),this.messages=new gb(this._client)}}cd.Models=JE;cd.BetaModelInfosPage=XE;cd.Messages=gb;let Kx=class extends Ia{create(e,r){return this._client.post("/v1/complete",{body:e,timeout:this._client._options.timeout??6e5,...r,stream:e.stream??!1})}};class QE extends Ia{create(e,r){return this._client.post("/v1/messages/batches",{body:e,...r})}retrieve(e,r){return this._client.get(`/v1/messages/batches/${e}`,r)}list(e={},r){return _a(e)?this.list({},e):this._client.getAPIList("/v1/messages/batches",eP,{query:e,...r})}delete(e,r){return this._client.delete(`/v1/messages/batches/${e}`,r)}cancel(e,r){return this._client.post(`/v1/messages/batches/${e}/cancel`,r)}async results(e,r){const n=await this.retrieve(e);if(!n.results_url)throw new qe(`No batch \`results_url\`; Has it finished processing? ${n.processing_status} - ${n.id}`);return this._client.get(n.results_url,{...r,headers:{Accept:"application/binary",...r?.headers},__binaryResponse:!0})._thenUnwrap((i,a)=>bb.fromResponse(a.response,a.controller))}}class eP extends yb{}QE.MessageBatchesPage=eP;var ir=function(t,e,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(t,r):i?i.value=r:e.set(t,r),r},Le=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},tn,ta,yl,Wp,bl,gl,Kp,ml,yi,vl,Jp,Xp,Qo,Zp,Yp,Aw,uM,$w,Iw,xw,Dw,lM;const cM="__json_buf";class My{constructor(){tn.add(this),this.messages=[],this.receivedMessages=[],ta.set(this,void 0),this.controller=new AbortController,yl.set(this,void 0),Wp.set(this,()=>{}),bl.set(this,()=>{}),gl.set(this,void 0),Kp.set(this,()=>{}),ml.set(this,()=>{}),yi.set(this,{}),vl.set(this,!1),Jp.set(this,!1),Xp.set(this,!1),Qo.set(this,!1),Zp.set(this,void 0),Yp.set(this,void 0),$w.set(this,e=>{if(ir(this,Jp,!0,"f"),e instanceof Error&&e.name==="AbortError"&&(e=new In),e instanceof In)return ir(this,Xp,!0,"f"),this._emit("abort",e);if(e instanceof qe)return this._emit("error",e);if(e instanceof Error){const r=new qe(e.message);return r.cause=e,this._emit("error",r)}return this._emit("error",new qe(String(e)))}),ir(this,yl,new Promise((e,r)=>{ir(this,Wp,e,"f"),ir(this,bl,r,"f")}),"f"),ir(this,gl,new Promise((e,r)=>{ir(this,Kp,e,"f"),ir(this,ml,r,"f")}),"f"),Le(this,yl,"f").catch(()=>{}),Le(this,gl,"f").catch(()=>{})}get response(){return Le(this,Zp,"f")}get request_id(){return Le(this,Yp,"f")}async withResponse(){const e=await Le(this,yl,"f");if(!e)throw new Error("Could not resolve a `Response` object");return{data:this,response:e,request_id:e.headers.get("request-id")}}static fromReadableStream(e){const r=new My;return r._run(()=>r._fromReadableStream(e)),r}static createMessage(e,r,n){const i=new My;for(const a of r.messages)i._addMessageParam(a);return i._run(()=>i._createMessage(e,{...r,stream:!0},{...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"stream"}})),i}_run(e){e().then(()=>{this._emitFinal(),this._emit("end")},Le(this,$w,"f"))}_addMessageParam(e){this.messages.push(e)}_addMessage(e,r=!0){this.receivedMessages.push(e),r&&this._emit("message",e)}async _createMessage(e,r,n){const i=n?.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort())),Le(this,tn,"m",Iw).call(this);const{response:a,data:o}=await e.create({...r,stream:!0},{...n,signal:this.controller.signal}).withResponse();this._connected(a);for await(const s of o)Le(this,tn,"m",xw).call(this,s);if(o.controller.signal?.aborted)throw new In;Le(this,tn,"m",Dw).call(this)}_connected(e){this.ended||(ir(this,Zp,e,"f"),ir(this,Yp,e?.headers.get("request-id"),"f"),Le(this,Wp,"f").call(this,e),this._emit("connect"))}get ended(){return Le(this,vl,"f")}get errored(){return Le(this,Jp,"f")}get aborted(){return Le(this,Xp,"f")}abort(){this.controller.abort()}on(e,r){return(Le(this,yi,"f")[e]||(Le(this,yi,"f")[e]=[])).push({listener:r}),this}off(e,r){const n=Le(this,yi,"f")[e];if(!n)return this;const i=n.findIndex(a=>a.listener===r);return i>=0&&n.splice(i,1),this}once(e,r){return(Le(this,yi,"f")[e]||(Le(this,yi,"f")[e]=[])).push({listener:r,once:!0}),this}emitted(e){return new Promise((r,n)=>{ir(this,Qo,!0,"f"),e!=="error"&&this.once("error",n),this.once(e,r)})}async done(){ir(this,Qo,!0,"f"),await Le(this,gl,"f")}get currentMessage(){return Le(this,ta,"f")}async finalMessage(){return await this.done(),Le(this,tn,"m",Aw).call(this)}async finalText(){return await this.done(),Le(this,tn,"m",uM).call(this)}_emit(e,...r){if(Le(this,vl,"f"))return;e==="end"&&(ir(this,vl,!0,"f"),Le(this,Kp,"f").call(this));const n=Le(this,yi,"f")[e];if(n&&(Le(this,yi,"f")[e]=n.filter(i=>!i.once),n.forEach(({listener:i})=>i(...r))),e==="abort"){const i=r[0];!Le(this,Qo,"f")&&!n?.length&&Promise.reject(i),Le(this,bl,"f").call(this,i),Le(this,ml,"f").call(this,i),this._emit("end");return}if(e==="error"){const i=r[0];!Le(this,Qo,"f")&&!n?.length&&Promise.reject(i),Le(this,bl,"f").call(this,i),Le(this,ml,"f").call(this,i),this._emit("end")}}_emitFinal(){this.receivedMessages.at(-1)&&this._emit("finalMessage",Le(this,tn,"m",Aw).call(this))}async _fromReadableStream(e,r){const n=r?.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),Le(this,tn,"m",Iw).call(this),this._connected(null);const i=Fc.fromReadableStream(e,this.controller);for await(const a of i)Le(this,tn,"m",xw).call(this,a);if(i.controller.signal?.aborted)throw new In;Le(this,tn,"m",Dw).call(this)}[(ta=new WeakMap,yl=new WeakMap,Wp=new WeakMap,bl=new WeakMap,gl=new WeakMap,Kp=new WeakMap,ml=new WeakMap,yi=new WeakMap,vl=new WeakMap,Jp=new WeakMap,Xp=new WeakMap,Qo=new WeakMap,Zp=new WeakMap,Yp=new WeakMap,$w=new WeakMap,tn=new WeakSet,Aw=function(){if(this.receivedMessages.length===0)throw new qe("stream ended without producing a Message with role=assistant");return this.receivedMessages.at(-1)},uM=function(){if(this.receivedMessages.length===0)throw new qe("stream ended without producing a Message with role=assistant");const r=this.receivedMessages.at(-1).content.filter(n=>n.type==="text").map(n=>n.text);if(r.length===0)throw new qe("stream ended without producing a content block with type=text");return r.join(" ")},Iw=function(){this.ended||ir(this,ta,void 0,"f")},xw=function(r){if(this.ended)return;const n=Le(this,tn,"m",lM).call(this,r);switch(this._emit("streamEvent",r,n),r.type){case"content_block_delta":{const i=n.content.at(-1);switch(r.delta.type){case"text_delta":{i.type==="text"&&this._emit("text",r.delta.text,i.text||"");break}case"citations_delta":{i.type==="text"&&this._emit("citation",r.delta.citation,i.citations??[]);break}case"input_json_delta":{i.type==="tool_use"&&i.input&&this._emit("inputJson",r.delta.partial_json,i.input);break}case"thinking_delta":{i.type==="thinking"&&this._emit("thinking",r.delta.thinking,i.thinking);break}case"signature_delta":{i.type==="thinking"&&this._emit("signature",i.signature);break}default:r.delta}break}case"message_stop":{this._addMessageParam(n),this._addMessage(n,!0);break}case"content_block_stop":{this._emit("contentBlock",n.content.at(-1));break}case"message_start":{ir(this,ta,n,"f");break}}},Dw=function(){if(this.ended)throw new qe("stream has ended, this shouldn't happen");const r=Le(this,ta,"f");if(!r)throw new qe("request ended without sending any chunks");return ir(this,ta,void 0,"f"),r},lM=function(r){let n=Le(this,ta,"f");if(r.type==="message_start"){if(n)throw new qe(`Unexpected event order, got ${r.type} before receiving "message_stop"`);return r.message}if(!n)throw new qe(`Unexpected event order, got ${r.type} before "message_start"`);switch(r.type){case"message_stop":return n;case"message_delta":return n.stop_reason=r.delta.stop_reason,n.stop_sequence=r.delta.stop_sequence,n.usage.output_tokens=r.usage.output_tokens,n;case"content_block_start":return n.content.push(r.content_block),n;case"content_block_delta":{const i=n.content.at(r.index);switch(r.delta.type){case"text_delta":{i?.type==="text"&&(i.text+=r.delta.text);break}case"citations_delta":{i?.type==="text"&&(i.citations??(i.citations=[]),i.citations.push(r.delta.citation));break}case"input_json_delta":{if(i?.type==="tool_use"){let a=i[cM]||"";a+=r.delta.partial_json,Object.defineProperty(i,cM,{value:a,enumerable:!1,writable:!0}),a&&(i.input=Wx(a))}break}case"thinking_delta":{i?.type==="thinking"&&(i.thinking+=r.delta.thinking);break}case"signature_delta":{i?.type==="thinking"&&(i.signature=r.delta.signature);break}default:r.delta}return n}case"content_block_stop":return n}},Symbol.asyncIterator)](){const e=[],r=[];let n=!1;return this.on("streamEvent",i=>{const a=r.shift();a?a.resolve(i):e.push(i)}),this.on("end",()=>{n=!0;for(const i of r)i.resolve(void 0);r.length=0}),this.on("abort",i=>{n=!0;for(const a of r)a.reject(i);r.length=0}),this.on("error",i=>{n=!0;for(const a of r)a.reject(i);r.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:n?{value:void 0,done:!0}:new Promise((a,o)=>r.push({resolve:a,reject:o})).then(a=>a?{value:a,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new Fc(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}class mb extends Ia{constructor(){super(...arguments),this.batches=new QE(this._client)}create(e,r){return e.model in dM&&console.warn(`The model '${e.model}' is deprecated and will reach end-of-life on ${dM[e.model]}
Please migrate to a newer model. Visit https://docs.anthropic.com/en/docs/resources/model-deprecations for more information.`),this._client.post("/v1/messages",{body:e,timeout:this._client._options.timeout??(e.stream?6e5:this._client._calculateNonstreamingTimeout(e.max_tokens)),...r,stream:e.stream??!1})}stream(e,r){return My.createMessage(this,e,r)}countTokens(e,r){return this._client.post("/v1/messages/count_tokens",{body:e,...r})}}const dM={"claude-1.3":"November 6th, 2024","claude-1.3-100k":"November 6th, 2024","claude-instant-1.1":"November 6th, 2024","claude-instant-1.1-100k":"November 6th, 2024","claude-instant-1.2":"November 6th, 2024","claude-3-sonnet-20240229":"July 21st, 2025","claude-2.1":"July 21st, 2025","claude-2.0":"July 21st, 2025"};mb.Batches=QE;mb.MessageBatchesPage=eP;let tP=class extends Ia{retrieve(e,r){return this._client.get(`/v1/models/${e}`,r)}list(e={},r){return _a(e)?this.list({},e):this._client.getAPIList("/v1/models",rP,{query:e,...r})}};class rP extends yb{}tP.ModelInfosPage=rP;var Jx;class lt extends Pq{constructor({baseURL:e=Pw("ANTHROPIC_BASE_URL"),apiKey:r=Pw("ANTHROPIC_API_KEY")??null,authToken:n=Pw("ANTHROPIC_AUTH_TOKEN")??null,...i}={}){const a={apiKey:r,authToken:n,...i,baseURL:e||"https://api.anthropic.com"};if(!a.dangerouslyAllowBrowser&&zq())throw new qe(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new Anthropic({ apiKey, dangerouslyAllowBrowser: true });
`);super({baseURL:a.baseURL,timeout:a.timeout??6e5,httpAgent:a.httpAgent,maxRetries:a.maxRetries,fetch:a.fetch}),this.completions=new Kx(this),this.messages=new mb(this),this.models=new tP(this),this.beta=new cd(this),this._options=a,this.apiKey=r,this.authToken=n}defaultQuery(){return this._options.defaultQuery}defaultHeaders(e){return{...super.defaultHeaders(e),...this._options.dangerouslyAllowBrowser?{"anthropic-dangerous-direct-browser-access":"true"}:void 0,"anthropic-version":"2023-06-01",...this._options.defaultHeaders}}validateHeaders(e,r){if(!(this.apiKey&&e["x-api-key"])&&r["x-api-key"]!==null&&!(this.authToken&&e.authorization)&&r.authorization!==null)throw new Error('Could not resolve authentication method. Expected either apiKey or authToken to be set. Or for one of the "X-Api-Key" or "Authorization" headers to be explicitly omitted')}authHeaders(e){const r=this.apiKeyAuth(e),n=this.bearerAuth(e);return r!=null&&!jy(r)?r:n!=null&&!jy(n)?n:{}}apiKeyAuth(e){return this.apiKey==null?{}:{"X-Api-Key":this.apiKey}}bearerAuth(e){return this.authToken==null?{}:{Authorization:`Bearer ${this.authToken}`}}}Jx=lt;lt.Anthropic=Jx;lt.HUMAN_PROMPT=`

Human:`;lt.AI_PROMPT=`

Assistant:`;lt.DEFAULT_TIMEOUT=6e5;lt.AnthropicError=qe;lt.APIError=Xr;lt.APIConnectionError=pb;lt.APIConnectionTimeoutError=Ax;lt.APIUserAbortError=In;lt.NotFoundError=Dx;lt.ConflictError=Nx;lt.RateLimitError=Bx;lt.BadRequestError=$x;lt.AuthenticationError=Ix;lt.InternalServerError=Ux;lt.PermissionDeniedError=xx;lt.UnprocessableEntityError=zx;lt.toFile=gq;lt.fileFromPath=Rx;lt.Completions=Kx;lt.Messages=mb;lt.Models=tP;lt.ModelInfosPage=rP;lt.Beta=cd;const{HUMAN_PROMPT:oje,AI_PROMPT:sje}=lt;class fM extends HE{static lc_name(){return"AnthropicToolsOutputParser"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","anthropic","output_parsers"]}),Object.defineProperty(this,"returnId",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"keyName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"returnSingle",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"zodSchema",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.keyName=e.keyName,this.returnSingle=e.returnSingle??this.returnSingle,this.zodSchema=e.zodSchema}async _validateResult(e){let r=e;if(typeof e=="string")try{r=JSON.parse(e)}catch(i){throw new bu(`Failed to parse. Text: "${JSON.stringify(e,null,2)}". Error: ${JSON.stringify(i.message)}`,e)}else r=e;if(this.zodSchema===void 0)return r;const n=await this.zodSchema.safeParseAsync(r);if(n.success)return n.data;throw new bu(`Failed to parse. Text: "${JSON.stringify(e,null,2)}". Error: ${JSON.stringify(n.error.errors)}`,JSON.stringify(r,null,2))}async parseResult(e){const r=e.flatMap(a=>{const{message:o}=a;return Array.isArray(o.content)?Xx(o.content)[0]:[]});if(r[0]===void 0)throw new Error("No parseable tool calls provided to AnthropicToolsOutputParser.");const[n]=r;return await this._validateResult(n.args)}}function Xx(t){const e=[];for(const r of t)r.type==="tool_use"&&e.push({name:r.name,args:r.input,id:r.id,type:"tool_call"});return e}function Vq(t){if(t)return t==="any"?{type:"any"}:t==="auto"?{type:"auto"}:typeof t=="string"?{type:"tool",name:t}:t}function hM(t){const e=/^data:(image\/.+);base64,(.+)$/,r=t.match(e);if(r===null)throw new Error(["Anthropic only supports base64-encoded images currently.","Example: data:image/png;base64,/9j/4AAQSk..."].join(`

`));return{type:"base64",media_type:r[1]??"",data:r[2]??""}}function kq(t){const e=[];for(const r of t)if(r._getType()==="tool")if(typeof r.content=="string"){const n=e[e.length-1];n?._getType()==="human"&&Array.isArray(n.content)&&"type"in n.content[0]&&n.content[0].type==="tool_result"?n.content.push({type:"tool_result",content:r.content,tool_use_id:r.tool_call_id}):e.push(new Pa({content:[{type:"tool_result",content:r.content,tool_use_id:r.tool_call_id}]}))}else e.push(new Pa({content:[{type:"tool_result",content:aS(r.content),tool_use_id:r.tool_call_id}]}));else e.push(r);return e}function pM(t){if(t.id===void 0)throw new Error('Anthropic requires all tool calls to have an "id".');return{type:"tool_use",id:t.id,name:t.name,input:t.args}}function aS(t){const e=["tool_use","tool_result","input_json_delta"],r=["text","text_delta"];return typeof t=="string"?t:t.map(i=>{const a="cache_control"in i?i.cache_control:void 0;if(i.type==="image_url"){let o;return typeof i.image_url=="string"?o=hM(i.image_url):o=hM(i.image_url.url),{type:"image",source:o,...a?{cache_control:a}:{}}}else{if(i.type==="document")return{...i,...a?{cache_control:a}:{}};if(i.type==="thinking")return{type:"thinking",thinking:i.thinking,signature:i.signature,...a?{cache_control:a}:{}};if(i.type==="redacted_thinking")return{type:"redacted_thinking",data:i.data,...a?{cache_control:a}:{}};if(r.find(o=>o===i.type)&&"text"in i)return{type:"text",text:i.text,...a?{cache_control:a}:{}};if(e.find(o=>o===i.type)){const o={...i};if("index"in o&&delete o.index,o.type==="input_json_delta"&&(o.type="tool_use"),"input"in o)try{o.input=JSON.parse(o.input)}catch{}return{...o,...a?{cache_control:a}:{}}}else throw new Error("Unsupported message content format")}})}function _M(t){const e=kq(t);let r;e.length>0&&e[0]._getType()==="system"&&(r=t[0].content);const i=(r!==void 0?e.slice(1):e).map(a=>{let o;if(a._getType()==="human")o="user";else if(a._getType()==="ai")o="assistant";else if(a._getType()==="tool")o="user";else throw a._getType()==="system"?new Error("System messages are only permitted as the first passed message."):new Error(`Message type "${a._getType()}" is not supported.`);if(ii(a)&&a.tool_calls?.length){if(typeof a.content=="string")return a.content===""?{role:o,content:a.tool_calls.map(pM)}:{role:o,content:[{type:"text",text:a.content},...a.tool_calls.map(pM)]};{const{content:s}=a;return!a.tool_calls.every(c=>s.find(d=>(d.type==="tool_use"||d.type==="input_json_delta")&&d.id===c.id))&&console.warn('The "tool_calls" field on a message is only respected if content is a string.'),{role:o,content:aS(a.content)}}}else return{role:o,content:aS(a.content)}});return{messages:Hq(i),system:r}}function Hq(t){if(!t||t.length<=1)return t;const e=[];let r=t[0];const n=a=>typeof a=="string"?[{type:"text",text:a}]:a,i=a=>a.role!=="user"||typeof a.content=="string"?!1:Array.isArray(a.content)&&a.content.every(o=>o.type==="tool_result");for(let a=1;a<t.length;a+=1){const o=t[a];i(r)&&i(o)?r={...r,content:[...n(r.content),...n(o.content)]}:(e.push(r),r=o)}return e.push(r),e}function qq(t,e){if(t.type==="message_start"){const{content:r,usage:n,...i}=t.message,a={};for(const[d,f]of Object.entries(i))f!=null&&(a[d]=f);const{input_tokens:o,output_tokens:s,...l}=n??{},c={input_tokens:o,output_tokens:s,total_tokens:o+s,input_token_details:{cache_creation:l.cache_creation_input_tokens,cache_read:l.cache_read_input_tokens}};return{chunk:new vt({content:e.coerceContentToString?"":[],additional_kwargs:a,usage_metadata:e.streamUsage?c:void 0,response_metadata:{usage:{...l}},id:t.message.id})}}else if(t.type==="message_delta"){const r={input_tokens:0,output_tokens:t.usage.output_tokens,total_tokens:t.usage.output_tokens,input_token_details:{cache_creation:t.usage.cache_creation_input_tokens,cache_read:t.usage.cache_read_input_tokens}};return{chunk:new vt({content:e.coerceContentToString?"":[],additional_kwargs:{...t.delta},usage_metadata:e.streamUsage?r:void 0})}}else if(t.type==="content_block_start"&&["tool_use","document"].includes(t.content_block.type)){const r=t.content_block;let n;return r.type==="tool_use"?n=[{id:r.id,index:t.index,name:r.name,args:""}]:n=[],{chunk:new vt({content:e.coerceContentToString?"":[{index:t.index,...t.content_block,input:""}],additional_kwargs:{},tool_call_chunks:n})}}else if(t.type==="content_block_delta"&&["text_delta","citations_delta","thinking_delta","signature_delta"].includes(t.delta.type)){if(e.coerceContentToString&&"text"in t.delta)return{chunk:new vt({content:t.delta.text})};{const r=t.delta;return"citation"in r&&(r.citations=[r.citation],delete r.citation),r.type==="thinking_delta"||r.type==="signature_delta"?{chunk:new vt({content:[{index:t.index,...r,type:"thinking"}]})}:{chunk:new vt({content:[{index:t.index,...r,type:"text"}]})}}}else{if(t.type==="content_block_delta"&&t.delta.type==="input_json_delta")return{chunk:new vt({content:e.coerceContentToString?"":[{index:t.index,input:t.delta.partial_json,type:t.delta.type}],additional_kwargs:{},tool_call_chunks:[{index:t.index,args:t.delta.partial_json}]})};if(t.type==="content_block_start"&&t.content_block.type==="text"){const r=t.content_block?.text;if(r!==void 0)return{chunk:new vt({content:e.coerceContentToString?r:[{index:t.index,...t.content_block}],additional_kwargs:{}})}}else{if(t.type==="content_block_start"&&t.content_block.type==="redacted_thinking")return{chunk:new vt({content:e.coerceContentToString?"":[{index:t.index,...t.content_block}]})};if(t.type==="content_block_start"&&t.content_block.type==="thinking"){const r=t.content_block.thinking;return{chunk:new vt({content:e.coerceContentToString?r:[{index:t.index,...t.content_block}]})}}}}return null}function Gq(t,e){const r=e.usage,n=r!=null?{input_tokens:r.input_tokens??0,output_tokens:r.output_tokens??0,total_tokens:(r.input_tokens??0)+(r.output_tokens??0),input_token_details:{cache_creation:r.cache_creation_input_tokens,cache_read:r.cache_read_input_tokens}}:void 0;if(t.length===1&&t[0].type==="text")return[{text:t[0].text,message:new Nn({content:t[0].text,additional_kwargs:e,usage_metadata:n,response_metadata:e,id:e.id})}];{const i=Xx(t);return[{text:"",message:new Nn({content:t,additional_kwargs:e,tool_calls:i,usage_metadata:n,response_metadata:e,id:e.id})}]}}function Qp(t,e){return t.lc_error_code=e,t.message=`${t.message}

Troubleshooting URL: https://js.langchain.com/docs/troubleshooting/errors/${e}/
`,t}function yM(t){let e;return t.status===400&&t.message.includes("tool")?e=Qp(t,"INVALID_TOOL_RESULTS"):t.status===401?e=Qp(t,"MODEL_AUTHENTICATION"):t.status===404?e=Qp(t,"MODEL_NOT_FOUND"):t.status===429?e=Qp(t,"MODEL_RATE_LIMIT"):e=t,e}function Wq(t){return!!(t.tools&&t.tools.length>0)}function Kq(t){for(const e of t.messages??[])if(typeof e.content!="string"){for(const r of e.content??[])if(typeof r=="object"&&r!=null&&r.type==="document"&&typeof r.citations=="object"&&r.citations.enabled)return!0}return!1}function Jq(t){return!!(t.thinking&&t.thinking.type==="enabled")}function Xq(t){return"input_schema"in t}function Zq(t){if(typeof t.content=="string")return t.content;if(Array.isArray(t.content)&&t.content.length>=1&&"input"in t.content[0])return typeof t.content[0].input=="string"?t.content[0].input:JSON.stringify(t.content[0].input);if(Array.isArray(t.content)&&t.content.length>=1&&"text"in t.content[0])return t.content[0].text}class Yq extends un{static lc_name(){return"ChatAnthropic"}get lc_secrets(){return{anthropicApiKey:"ANTHROPIC_API_KEY",apiKey:"ANTHROPIC_API_KEY"}}get lc_aliases(){return{modelName:"model"}}constructor(e){if(super(e??{}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"anthropicApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiUrl",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"temperature",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"topK",{enumerable:!0,configurable:!0,writable:!0,value:-1}),Object.defineProperty(this,"topP",{enumerable:!0,configurable:!0,writable:!0,value:-1}),Object.defineProperty(this,"maxTokens",{enumerable:!0,configurable:!0,writable:!0,value:2048}),Object.defineProperty(this,"modelName",{enumerable:!0,configurable:!0,writable:!0,value:"claude-2.1"}),Object.defineProperty(this,"model",{enumerable:!0,configurable:!0,writable:!0,value:"claude-2.1"}),Object.defineProperty(this,"invocationKwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stopSequences",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"streaming",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"clientOptions",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"thinking",{enumerable:!0,configurable:!0,writable:!0,value:{type:"disabled"}}),Object.defineProperty(this,"batchClient",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"streamingClient",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"streamUsage",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"createClient",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.anthropicApiKey=e?.apiKey??e?.anthropicApiKey??Ye("ANTHROPIC_API_KEY"),!this.anthropicApiKey&&!e?.createClient)throw new Error("Anthropic API key not found");this.clientOptions=e?.clientOptions??{},this.apiKey=this.anthropicApiKey,this.apiUrl=e?.anthropicApiUrl,this.modelName=e?.model??e?.modelName??this.model,this.model=this.modelName,this.invocationKwargs=e?.invocationKwargs??{},this.temperature=e?.temperature??this.temperature,this.topK=e?.topK??this.topK,this.topP=e?.topP??this.topP,this.maxTokens=e?.maxTokensToSample??e?.maxTokens??this.maxTokens,this.stopSequences=e?.stopSequences??this.stopSequences,this.streaming=e?.streaming??!1,this.streamUsage=e?.streamUsage??this.streamUsage,this.thinking=e?.thinking??this.thinking,this.createClient=e?.createClient??(r=>new lt(r))}getLsParams(e){const r=this.invocationParams(e);return{ls_provider:"anthropic",ls_model_name:this.model,ls_model_type:"chat",ls_temperature:r.temperature??void 0,ls_max_tokens:r.max_tokens??void 0,ls_stop:e.stop}}formatStructuredToolToAnthropic(e){if(!(!e||!e.length))return e.map(r=>{if(Xq(r))return r;if(ud(r))return{name:r.function.name,description:r.function.description,input_schema:r.function.parameters};if(zu(r))return{name:r.name,description:r.description,input_schema:ui(r.schema)};throw new Error(`Unknown tool type passed to ChatAnthropic: ${JSON.stringify(r,null,2)}`)})}bindTools(e,r){return this.bind({tools:this.formatStructuredToolToAnthropic(e),...r})}invocationParams(e){const r=Vq(e?.tool_choice);if(this.thinking.type==="enabled"){if(this.topK!==-1)throw new Error("topK is not supported when thinking is enabled");if(this.topP!==-1)throw new Error("topP is not supported when thinking is enabled");if(this.temperature!==1)throw new Error("temperature is not supported when thinking is enabled");return{model:this.model,stop_sequences:e?.stop??this.stopSequences,stream:this.streaming,max_tokens:this.maxTokens,tools:this.formatStructuredToolToAnthropic(e?.tools),tool_choice:r,thinking:this.thinking,...this.invocationKwargs}}return{model:this.model,temperature:this.temperature,top_k:this.topK,top_p:this.topP,stop_sequences:e?.stop??this.stopSequences,stream:this.streaming,max_tokens:this.maxTokens,tools:this.formatStructuredToolToAnthropic(e?.tools),tool_choice:r,thinking:this.thinking,...this.invocationKwargs}}_identifyingParams(){return{model_name:this.model,...this.invocationParams()}}identifyingParams(){return{model_name:this.model,...this.invocationParams()}}async*_streamResponseChunks(e,r,n){const i=this.invocationParams(r),a=_M(e),o={...i,...a,stream:!0},s=!Wq(o)&&!Kq(o)&&!Jq(o),l=await this.createStreamWithRetry(o,{headers:r.headers});for await(const c of l){if(r.signal?.aborted)throw l.controller.abort(),new Error("AbortError: User aborted the request.");const d=this.streamUsage??r.streamUsage,f=qq(c,{streamUsage:d,coerceContentToString:s});if(!f)continue;const{chunk:h}=f,p=Zq(h),b=new Mr({message:new vt({content:h.content,additional_kwargs:h.additional_kwargs,tool_call_chunks:h.tool_call_chunks,usage_metadata:d?h.usage_metadata:void 0,response_metadata:h.response_metadata,id:h.id}),text:p??""});yield b,await n?.handleLLMNewToken(p??"",void 0,void 0,void 0,void 0,{chunk:b})}}async _generateNonStreaming(e,r,n){const i=await this.completionWithRetry({...r,stream:!1,..._M(e)},n),{content:a,...o}=i,s=Gq(a,o),{role:l,type:c,...d}=o;return{generations:s,llmOutput:d}}async _generate(e,r,n){if(this.stopSequences&&r.stop)throw new Error('"stopSequence" parameter found in input and default params');const i=this.invocationParams(r);if(i.stream){let a;const o=this._streamResponseChunks(e,r,n);for await(const s of o)a===void 0?a=s:a=a.concat(s);if(a===void 0)throw new Error("No chunks returned from Anthropic API.");return{generations:[{text:a.text,message:a.message}]}}else return this._generateNonStreaming(e,i,{signal:r.signal,headers:r.headers})}async createStreamWithRetry(e,r){if(!this.streamingClient){const i=this.apiUrl?{baseURL:this.apiUrl}:void 0;this.streamingClient=this.createClient({dangerouslyAllowBrowser:!0,...this.clientOptions,...i,apiKey:this.apiKey,maxRetries:0})}const n=async()=>{try{return await this.streamingClient.messages.create({...e,...this.invocationKwargs,stream:!0},r)}catch(i){throw yM(i)}};return this.caller.call(n)}async completionWithRetry(e,r){if(!this.batchClient){const i=this.apiUrl?{baseURL:this.apiUrl}:void 0;this.batchClient=this.createClient({dangerouslyAllowBrowser:!0,...this.clientOptions,...i,apiKey:this.apiKey,maxRetries:0})}const n=async()=>{try{return await this.batchClient.messages.create({...e,...this.invocationKwargs},r)}catch(i){throw yM(i)}};return this.caller.callWithOptions({signal:r.signal??void 0},n)}_llmType(){return"anthropic"}withStructuredOutput(e,r){const n=e,i=r?.name,a=r?.method,o=r?.includeRaw;if(a==="jsonMode")throw new Error('Anthropic only supports "functionCalling" as a method.');let s=i??"extract",l,c;if(yu(n)){const b=ui(n);c=[{name:s,description:b.description??"A function available to call.",input_schema:b}],l=new fM({returnSingle:!0,keyName:s,zodSchema:n})}else{let b;typeof n.name=="string"&&typeof n.description=="string"&&typeof n.input_schema=="object"&&n.input_schema!=null?(b=n,s=n.name):b={name:s,description:n.description??"",input_schema:n},c=[b],l=new fM({returnSingle:!0,keyName:s})}let d;if(this.thinking?.type==="enabled"){const b="Anthropic structured output relies on forced tool calling, which is not supported when `thinking` is enabled. This method will raise OutputParserException if tool calls are not generated. Consider disabling `thinking` or adjust your prompt to ensure the tool is called.";console.warn(b),d=this.bind({tools:c});const g=v=>{if(!v.tool_calls||v.tool_calls.length===0)throw new Error(b);return v};d=d.pipe(g)}else d=this.bind({tools:c,tool_choice:{type:"tool",name:s}});if(!o)return d.pipe(l).withConfig({runName:"ChatAnthropicStructuredOutput"});const f=li.assign({parsed:(b,g)=>l.invoke(b.raw,g)}),h=li.assign({parsed:()=>null}),p=f.withFallbacks({fallbacks:[h]});return Gr.from([{raw:d},p]).withConfig({runName:"StructuredOutputRunnable"})}}class Qq extends Yq{}class eG extends GE{static lc_name(){return"ChatFireworks"}_llmType(){return"fireworks"}get lc_secrets(){return{fireworksApiKey:"FIREWORKS_API_KEY",apiKey:"FIREWORKS_API_KEY"}}constructor(e){const r=e?.apiKey||e?.fireworksApiKey||Ye("FIREWORKS_API_KEY");if(!r)throw new Error('Fireworks API key not found. Please set the FIREWORKS_API_KEY environment variable or provide the key into "fireworksApiKey"');super({...e,model:e?.model||e?.modelName||"accounts/fireworks/models/llama-v3p1-8b-instruct",apiKey:r,configuration:{baseURL:"https://api.fireworks.ai/inference/v1"},streamUsage:!1}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"fireworksApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.fireworksApiKey=r,this.apiKey=r}getLsParams(e){const r=super.getLsParams(e);return r.ls_provider="fireworks",r}toJSON(){const e=super.toJSON();return"kwargs"in e&&typeof e.kwargs=="object"&&e.kwargs!=null&&(delete e.kwargs.openai_api_key,delete e.kwargs.configuration),e}async completionWithRetry(e,r){return delete e.frequency_penalty,delete e.presence_penalty,delete e.logit_bias,delete e.functions,e.stream===!0?super.completionWithRetry(e,r):super.completionWithRetry(e,r)}}function tG(t){return t!=null&&typeof t=="object"&&"on"in t}async function rG(t,e){if(tG(t))return new Promise(n=>{t.on("readable",()=>{let i;for(;;){if(i=t.read(),i==null){e(new Uint8Array,!0);break}e(i)}n()})});const r=t.getReader();for(;;){const n=await r.read();if(n.done){e(new Uint8Array,!0);break}e(n.value)}}function nG(t){let e,r,n,i=!1;return function(o,s){if(s){t(o,0,!0);return}e===void 0?(e=o,r=0,n=-1):e=aG(e,o);const l=e.length;let c=0;for(;r<l;){i&&(e[r]===10&&(c=++r),i=!1);let d=-1;for(;r<l&&d===-1;++r)switch(e[r]){case 58:n===-1&&(n=r-c);break;case 13:i=!0;case 10:d=r;break}if(d===-1)break;t(e.subarray(c,d),n),c=r,n=-1}c===l?e=void 0:c!==0&&(e=e.subarray(c),r-=c)}}function iG(t,e,r){let n=Nw();const i=new TextDecoder;return function(o,s,l){if(l){sG(n)||(t?.(n),n=Nw());return}if(o.length===0)t?.(n),n=Nw();else if(s>0){const c=i.decode(o.subarray(0,s)),d=s+(o[s+1]===32?2:1),f=i.decode(o.subarray(d));switch(c){case"data":n.data=n.data?n.data+`
`+f:f;break;case"event":n.event=f;break}}}}function aG(t,e){const r=new Uint8Array(t.length+e.length);return r.set(t),r.set(e,t.length),r}function Nw(){return{data:"",event:"",id:"",retry:void 0}}function oG(t){const e=new ReadableStream({async start(r){const n=iG(a=>{a.data&&r.enqueue(a.data)});await rG(t,nG((a,o,s)=>{n(a,o,s),s&&r.close()}))}});return Tr.fromReadableStream(e)}function sG(t){return t.data===""&&t.event===""&&t.id===""&&t.retry===void 0}class uG extends Px{static lc_name(){return"TogetherAI"}constructor(e){super(e),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"temperature",{enumerable:!0,configurable:!0,writable:!0,value:.7}),Object.defineProperty(this,"topP",{enumerable:!0,configurable:!0,writable:!0,value:.7}),Object.defineProperty(this,"topK",{enumerable:!0,configurable:!0,writable:!0,value:50}),Object.defineProperty(this,"modelName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"model",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"streaming",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"repetitionPenalty",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"logprobs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxTokens",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"safetyModel",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stop",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"inferenceAPIUrl",{enumerable:!0,configurable:!0,writable:!0,value:"https://api.together.xyz/inference"});const r=e.apiKey??Ye("TOGETHER_AI_API_KEY");if(!r)throw new Error("TOGETHER_AI_API_KEY not found.");if(!e.model&&!e.modelName)throw new Error("Model name is required for TogetherAI.");this.apiKey=r,this.temperature=e?.temperature??this.temperature,this.topK=e?.topK??this.topK,this.topP=e?.topP??this.topP,this.modelName=e.model??e.modelName??"",this.model=this.modelName,this.streaming=e.streaming??this.streaming,this.repetitionPenalty=e.repetitionPenalty??this.repetitionPenalty,this.logprobs=e.logprobs,this.safetyModel=e.safetyModel,this.maxTokens=e.maxTokens,this.stop=e.stop}_llmType(){return"together_ai"}constructHeaders(){return{accept:"application/json","content-type":"application/json",Authorization:`Bearer ${this.apiKey}`}}constructBody(e,r){return{model:r?.model??r?.modelName??this?.model,prompt:e,temperature:this?.temperature??r?.temperature,top_k:this?.topK??r?.topK,top_p:this?.topP??r?.topP,repetition_penalty:this?.repetitionPenalty??r?.repetitionPenalty,logprobs:this?.logprobs??r?.logprobs,stream_tokens:this?.streaming,safety_model:this?.safetyModel??r?.safetyModel,max_tokens:this?.maxTokens??r?.maxTokens,stop:this?.stop??r?.stop}}async completionWithRetry(e,r){return this.caller.call(async()=>{const n=await fetch(this.inferenceAPIUrl,{method:"POST",headers:{...this.constructHeaders()},body:JSON.stringify(this.constructBody(e,r))});if(n.status===200)return n.json();const i=await n.json();throw new Error(`Error getting prompt completion from Together AI. ${JSON.stringify(i,null,2)}`)})}async _call(e,r){const n=await this.completionWithRetry(e,r);return n.output?n.output.choices[0]?.text??"":n.choices?.[0]?.text??""}async*_streamResponseChunks(e,r,n){const i=await fetch(this.inferenceAPIUrl,{method:"POST",headers:{...this.constructHeaders()},body:JSON.stringify(this.constructBody(e,r))});if(i.status!==200){const o=await i.json();throw new Error(`Error getting prompt completion from Together AI. ${JSON.stringify(o,null,2)}`)}const a=oG(i.body);for await(const o of a)if(o!=="[DONE]"){const s=JSON.parse(o),l=new Ui({text:s.choices[0].text??""});yield l,n?.handleLLMNewToken(l.text??"")}}}var bM;(function(t){t.STRING="string",t.NUMBER="number",t.INTEGER="integer",t.BOOLEAN="boolean",t.ARRAY="array",t.OBJECT="object"})(bM||(bM={}));/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var gM;(function(t){t.LANGUAGE_UNSPECIFIED="language_unspecified",t.PYTHON="python"})(gM||(gM={}));var mM;(function(t){t.OUTCOME_UNSPECIFIED="outcome_unspecified",t.OUTCOME_OK="outcome_ok",t.OUTCOME_FAILED="outcome_failed",t.OUTCOME_DEADLINE_EXCEEDED="outcome_deadline_exceeded"})(mM||(mM={}));/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vM=["user","model","function","system"];var wM;(function(t){t.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",t.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",t.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",t.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",t.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT"})(wM||(wM={}));var OM;(function(t){t.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE"})(OM||(OM={}));var SM;(function(t){t.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",t.NEGLIGIBLE="NEGLIGIBLE",t.LOW="LOW",t.MEDIUM="MEDIUM",t.HIGH="HIGH"})(SM||(SM={}));var EM;(function(t){t.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",t.SAFETY="SAFETY",t.OTHER="OTHER"})(EM||(EM={}));var _c;(function(t){t.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",t.STOP="STOP",t.MAX_TOKENS="MAX_TOKENS",t.SAFETY="SAFETY",t.RECITATION="RECITATION",t.LANGUAGE="LANGUAGE",t.OTHER="OTHER"})(_c||(_c={}));var PM;(function(t){t.TASK_TYPE_UNSPECIFIED="TASK_TYPE_UNSPECIFIED",t.RETRIEVAL_QUERY="RETRIEVAL_QUERY",t.RETRIEVAL_DOCUMENT="RETRIEVAL_DOCUMENT",t.SEMANTIC_SIMILARITY="SEMANTIC_SIMILARITY",t.CLASSIFICATION="CLASSIFICATION",t.CLUSTERING="CLUSTERING"})(PM||(PM={}));var Ns;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.AUTO="AUTO",t.ANY="ANY",t.NONE="NONE"})(Ns||(Ns={}));var jM;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(jM||(jM={}));/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jr extends Error{constructor(e){super(`[GoogleGenerativeAI Error]: ${e}`)}}class es extends jr{constructor(e,r){super(e),this.response=r}}class Zx extends jr{constructor(e,r,n,i){super(e),this.status=r,this.statusText=n,this.errorDetails=i}}class wa extends jr{}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lG="https://generativelanguage.googleapis.com",cG="v1beta",dG="0.21.0",fG="genai-js";var wo;(function(t){t.GENERATE_CONTENT="generateContent",t.STREAM_GENERATE_CONTENT="streamGenerateContent",t.COUNT_TOKENS="countTokens",t.EMBED_CONTENT="embedContent",t.BATCH_EMBED_CONTENTS="batchEmbedContents"})(wo||(wo={}));class hG{constructor(e,r,n,i,a){this.model=e,this.task=r,this.apiKey=n,this.stream=i,this.requestOptions=a}toString(){var e,r;const n=((e=this.requestOptions)===null||e===void 0?void 0:e.apiVersion)||cG;let a=`${((r=this.requestOptions)===null||r===void 0?void 0:r.baseUrl)||lG}/${n}/${this.model}:${this.task}`;return this.stream&&(a+="?alt=sse"),a}}function pG(t){const e=[];return t?.apiClient&&e.push(t.apiClient),e.push(`${fG}/${dG}`),e.join(" ")}async function _G(t){var e;const r=new Headers;r.append("Content-Type","application/json"),r.append("x-goog-api-client",pG(t.requestOptions)),r.append("x-goog-api-key",t.apiKey);let n=(e=t.requestOptions)===null||e===void 0?void 0:e.customHeaders;if(n){if(!(n instanceof Headers))try{n=new Headers(n)}catch(i){throw new wa(`unable to convert customHeaders value ${JSON.stringify(n)} to Headers: ${i.message}`)}for(const[i,a]of n.entries()){if(i==="x-goog-api-key")throw new wa(`Cannot set reserved header name ${i}`);if(i==="x-goog-api-client")throw new wa(`Header name ${i} can only be set using the apiClient field`);r.append(i,a)}}return r}async function yG(t,e,r,n,i,a){const o=new hG(t,e,r,n,a);return{url:o.toString(),fetchOptions:Object.assign(Object.assign({},vG(a)),{method:"POST",headers:await _G(o),body:i})}}async function dd(t,e,r,n,i,a={},o=fetch){const{url:s,fetchOptions:l}=await yG(t,e,r,n,i,a);return bG(s,l,o)}async function bG(t,e,r=fetch){let n;try{n=await r(t,e)}catch(i){gG(i,t)}return n.ok||await mG(n,t),n}function gG(t,e){let r=t;throw t instanceof Zx||t instanceof wa||(r=new jr(`Error fetching from ${e.toString()}: ${t.message}`),r.stack=t.stack),r}async function mG(t,e){let r="",n;try{const i=await t.json();r=i.error.message,i.error.details&&(r+=` ${JSON.stringify(i.error.details)}`,n=i.error.details)}catch{}throw new Zx(`Error fetching from ${e.toString()}: [${t.status} ${t.statusText}] ${r}`,t.status,t.statusText,n)}function vG(t){const e={};if(t?.signal!==void 0||t?.timeout>=0){const r=new AbortController;t?.timeout>=0&&setTimeout(()=>r.abort(),t.timeout),t?.signal&&t.signal.addEventListener("abort",()=>{r.abort()}),e.signal=r.signal}return e}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nP(t){return t.text=()=>{if(t.candidates&&t.candidates.length>0){if(t.candidates.length>1&&console.warn(`This response had ${t.candidates.length} candidates. Returning text from the first candidate only. Access response.candidates directly to use the other candidates.`),k_(t.candidates[0]))throw new es(`${fa(t)}`,t);return wG(t)}else if(t.promptFeedback)throw new es(`Text not available. ${fa(t)}`,t);return""},t.functionCall=()=>{if(t.candidates&&t.candidates.length>0){if(t.candidates.length>1&&console.warn(`This response had ${t.candidates.length} candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates.`),k_(t.candidates[0]))throw new es(`${fa(t)}`,t);return console.warn("response.functionCall() is deprecated. Use response.functionCalls() instead."),CM(t)[0]}else if(t.promptFeedback)throw new es(`Function call not available. ${fa(t)}`,t)},t.functionCalls=()=>{if(t.candidates&&t.candidates.length>0){if(t.candidates.length>1&&console.warn(`This response had ${t.candidates.length} candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates.`),k_(t.candidates[0]))throw new es(`${fa(t)}`,t);return CM(t)}else if(t.promptFeedback)throw new es(`Function call not available. ${fa(t)}`,t)},t}function wG(t){var e,r,n,i;const a=[];if(!((r=(e=t.candidates)===null||e===void 0?void 0:e[0].content)===null||r===void 0)&&r.parts)for(const o of(i=(n=t.candidates)===null||n===void 0?void 0:n[0].content)===null||i===void 0?void 0:i.parts)o.text&&a.push(o.text),o.executableCode&&a.push("\n```"+o.executableCode.language+`
`+o.executableCode.code+"\n```\n"),o.codeExecutionResult&&a.push("\n```\n"+o.codeExecutionResult.output+"\n```\n");return a.length>0?a.join(""):""}function CM(t){var e,r,n,i;const a=[];if(!((r=(e=t.candidates)===null||e===void 0?void 0:e[0].content)===null||r===void 0)&&r.parts)for(const o of(i=(n=t.candidates)===null||n===void 0?void 0:n[0].content)===null||i===void 0?void 0:i.parts)o.functionCall&&a.push(o.functionCall);if(a.length>0)return a}const OG=[_c.RECITATION,_c.SAFETY,_c.LANGUAGE];function k_(t){return!!t.finishReason&&OG.includes(t.finishReason)}function fa(t){var e,r,n;let i="";if((!t.candidates||t.candidates.length===0)&&t.promptFeedback)i+="Response was blocked",!((e=t.promptFeedback)===null||e===void 0)&&e.blockReason&&(i+=` due to ${t.promptFeedback.blockReason}`),!((r=t.promptFeedback)===null||r===void 0)&&r.blockReasonMessage&&(i+=`: ${t.promptFeedback.blockReasonMessage}`);else if(!((n=t.candidates)===null||n===void 0)&&n[0]){const a=t.candidates[0];k_(a)&&(i+=`Candidate was blocked due to ${a.finishReason}`,a.finishMessage&&(i+=`: ${a.finishMessage}`))}return i}function Lc(t){return this instanceof Lc?(this.v=t,this):new Lc(t)}function SG(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(t,e||[]),i,a=[];return i={},o("next"),o("throw"),o("return"),i[Symbol.asyncIterator]=function(){return this},i;function o(h){n[h]&&(i[h]=function(p){return new Promise(function(b,g){a.push([h,p,b,g])>1||s(h,p)})})}function s(h,p){try{l(n[h](p))}catch(b){f(a[0][3],b)}}function l(h){h.value instanceof Lc?Promise.resolve(h.value.v).then(c,d):f(a[0][2],h)}function c(h){s("next",h)}function d(h){s("throw",h)}function f(h,p){h(p),a.shift(),a.length&&s(a[0][0],a[0][1])}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MM=/^data\: (.*)(?:\n\n|\r\r|\r\n\r\n)/;function EG(t){const e=t.body.pipeThrough(new TextDecoderStream("utf8",{fatal:!0})),r=CG(e),[n,i]=r.tee();return{stream:jG(n),response:PG(i)}}async function PG(t){const e=[],r=t.getReader();for(;;){const{done:n,value:i}=await r.read();if(n)return nP(MG(e));e.push(i)}}function jG(t){return SG(this,arguments,function*(){const r=t.getReader();for(;;){const{value:n,done:i}=yield Lc(r.read());if(i)break;yield yield Lc(nP(n))}})}function CG(t){const e=t.getReader();return new ReadableStream({start(n){let i="";return a();function a(){return e.read().then(({value:o,done:s})=>{if(s){if(i.trim()){n.error(new jr("Failed to parse stream"));return}n.close();return}i+=o;let l=i.match(MM),c;for(;l;){try{c=JSON.parse(l[1])}catch{n.error(new jr(`Error parsing JSON response: "${l[1]}"`));return}n.enqueue(c),i=i.substring(l[0].length),l=i.match(MM)}return a()})}}})}function MG(t){const e=t[t.length-1],r={promptFeedback:e?.promptFeedback};for(const n of t){if(n.candidates)for(const i of n.candidates){const a=i.index;if(r.candidates||(r.candidates=[]),r.candidates[a]||(r.candidates[a]={index:i.index}),r.candidates[a].citationMetadata=i.citationMetadata,r.candidates[a].groundingMetadata=i.groundingMetadata,r.candidates[a].finishReason=i.finishReason,r.candidates[a].finishMessage=i.finishMessage,r.candidates[a].safetyRatings=i.safetyRatings,i.content&&i.content.parts){r.candidates[a].content||(r.candidates[a].content={role:i.content.role||"user",parts:[]});const o={};for(const s of i.content.parts)s.text&&(o.text=s.text),s.functionCall&&(o.functionCall=s.functionCall),s.executableCode&&(o.executableCode=s.executableCode),s.codeExecutionResult&&(o.codeExecutionResult=s.codeExecutionResult),Object.keys(o).length===0&&(o.text=""),r.candidates[a].content.parts.push(o)}}n.usageMetadata&&(r.usageMetadata=n.usageMetadata)}return r}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Yx(t,e,r,n){const i=await dd(e,wo.STREAM_GENERATE_CONTENT,t,!0,JSON.stringify(r),n);return EG(i)}async function Qx(t,e,r,n){const a=await(await dd(e,wo.GENERATE_CONTENT,t,!1,JSON.stringify(r),n)).json();return{response:nP(a)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eD(t){if(t!=null){if(typeof t=="string")return{role:"system",parts:[{text:t}]};if(t.text)return{role:"system",parts:[t]};if(t.parts)return t.role?t:{role:"system",parts:t.parts}}}function Vc(t){let e=[];if(typeof t=="string")e=[{text:t}];else for(const r of t)typeof r=="string"?e.push({text:r}):e.push(r);return TG(e)}function TG(t){const e={role:"user",parts:[]},r={role:"function",parts:[]};let n=!1,i=!1;for(const a of t)"functionResponse"in a?(r.parts.push(a),i=!0):(e.parts.push(a),n=!0);if(n&&i)throw new jr("Within a single message, FunctionResponse cannot be mixed with other type of part in the request for sending chat message.");if(!n&&!i)throw new jr("No content is provided for sending chat message.");return n?e:r}function RG(t,e){var r;let n={model:e?.model,generationConfig:e?.generationConfig,safetySettings:e?.safetySettings,tools:e?.tools,toolConfig:e?.toolConfig,systemInstruction:e?.systemInstruction,cachedContent:(r=e?.cachedContent)===null||r===void 0?void 0:r.name,contents:[]};const i=t.generateContentRequest!=null;if(t.contents){if(i)throw new wa("CountTokensRequest must have one of contents or generateContentRequest, not both.");n.contents=t.contents}else if(i)n=Object.assign(Object.assign({},n),t.generateContentRequest);else{const a=Vc(t);n.contents=[a]}return{generateContentRequest:n}}function TM(t){let e;return t.contents?e=t:e={contents:[Vc(t)]},t.systemInstruction&&(e.systemInstruction=eD(t.systemInstruction)),e}function AG(t){return typeof t=="string"||Array.isArray(t)?{content:Vc(t)}:t}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RM=["text","inlineData","functionCall","functionResponse","executableCode","codeExecutionResult"],$G={user:["text","inlineData"],function:["functionResponse"],model:["text","functionCall","executableCode","codeExecutionResult"],system:["text"]};function IG(t){let e=!1;for(const r of t){const{role:n,parts:i}=r;if(!e&&n!=="user")throw new jr(`First content should be with role 'user', got ${n}`);if(!vM.includes(n))throw new jr(`Each item should include role field. Got ${n} but valid roles are: ${JSON.stringify(vM)}`);if(!Array.isArray(i))throw new jr("Content should have 'parts' property with an array of Parts");if(i.length===0)throw new jr("Each Content should have at least one part");const a={text:0,inlineData:0,functionCall:0,functionResponse:0,fileData:0,executableCode:0,codeExecutionResult:0};for(const s of i)for(const l of RM)l in s&&(a[l]+=1);const o=$G[n];for(const s of RM)if(!o.includes(s)&&a[s]>0)throw new jr(`Content with role '${n}' can't contain '${s}' part`);e=!0}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AM="SILENT_ERROR";class xG{constructor(e,r,n,i={}){this.model=r,this.params=n,this._requestOptions=i,this._history=[],this._sendPromise=Promise.resolve(),this._apiKey=e,n?.history&&(IG(n.history),this._history=n.history)}async getHistory(){return await this._sendPromise,this._history}async sendMessage(e,r={}){var n,i,a,o,s,l;await this._sendPromise;const c=Vc(e),d={safetySettings:(n=this.params)===null||n===void 0?void 0:n.safetySettings,generationConfig:(i=this.params)===null||i===void 0?void 0:i.generationConfig,tools:(a=this.params)===null||a===void 0?void 0:a.tools,toolConfig:(o=this.params)===null||o===void 0?void 0:o.toolConfig,systemInstruction:(s=this.params)===null||s===void 0?void 0:s.systemInstruction,cachedContent:(l=this.params)===null||l===void 0?void 0:l.cachedContent,contents:[...this._history,c]},f=Object.assign(Object.assign({},this._requestOptions),r);let h;return this._sendPromise=this._sendPromise.then(()=>Qx(this._apiKey,this.model,d,f)).then(p=>{var b;if(p.response.candidates&&p.response.candidates.length>0){this._history.push(c);const g=Object.assign({parts:[],role:"model"},(b=p.response.candidates)===null||b===void 0?void 0:b[0].content);this._history.push(g)}else{const g=fa(p.response);g&&console.warn(`sendMessage() was unsuccessful. ${g}. Inspect response object for details.`)}h=p}),await this._sendPromise,h}async sendMessageStream(e,r={}){var n,i,a,o,s,l;await this._sendPromise;const c=Vc(e),d={safetySettings:(n=this.params)===null||n===void 0?void 0:n.safetySettings,generationConfig:(i=this.params)===null||i===void 0?void 0:i.generationConfig,tools:(a=this.params)===null||a===void 0?void 0:a.tools,toolConfig:(o=this.params)===null||o===void 0?void 0:o.toolConfig,systemInstruction:(s=this.params)===null||s===void 0?void 0:s.systemInstruction,cachedContent:(l=this.params)===null||l===void 0?void 0:l.cachedContent,contents:[...this._history,c]},f=Object.assign(Object.assign({},this._requestOptions),r),h=Yx(this._apiKey,this.model,d,f);return this._sendPromise=this._sendPromise.then(()=>h).catch(p=>{throw new Error(AM)}).then(p=>p.response).then(p=>{if(p.candidates&&p.candidates.length>0){this._history.push(c);const b=Object.assign({},p.candidates[0].content);b.role||(b.role="model"),this._history.push(b)}else{const b=fa(p);b&&console.warn(`sendMessageStream() was unsuccessful. ${b}. Inspect response object for details.`)}}).catch(p=>{p.message!==AM&&console.error(p)}),h}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function DG(t,e,r,n){return(await dd(e,wo.COUNT_TOKENS,t,!1,JSON.stringify(r),n)).json()}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function NG(t,e,r,n){return(await dd(e,wo.EMBED_CONTENT,t,!1,JSON.stringify(r),n)).json()}async function zG(t,e,r,n){const i=r.requests.map(o=>Object.assign(Object.assign({},o),{model:e}));return(await dd(e,wo.BATCH_EMBED_CONTENTS,t,!1,JSON.stringify({requests:i}),n)).json()}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $M{constructor(e,r,n={}){this.apiKey=e,this._requestOptions=n,r.model.includes("/")?this.model=r.model:this.model=`models/${r.model}`,this.generationConfig=r.generationConfig||{},this.safetySettings=r.safetySettings||[],this.tools=r.tools,this.toolConfig=r.toolConfig,this.systemInstruction=eD(r.systemInstruction),this.cachedContent=r.cachedContent}async generateContent(e,r={}){var n;const i=TM(e),a=Object.assign(Object.assign({},this._requestOptions),r);return Qx(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(n=this.cachedContent)===null||n===void 0?void 0:n.name},i),a)}async generateContentStream(e,r={}){var n;const i=TM(e),a=Object.assign(Object.assign({},this._requestOptions),r);return Yx(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(n=this.cachedContent)===null||n===void 0?void 0:n.name},i),a)}startChat(e){var r;return new xG(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(r=this.cachedContent)===null||r===void 0?void 0:r.name},e),this._requestOptions)}async countTokens(e,r={}){const n=RG(e,{model:this.model,generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:this.cachedContent}),i=Object.assign(Object.assign({},this._requestOptions),r);return DG(this.apiKey,this.model,n,i)}async embedContent(e,r={}){const n=AG(e),i=Object.assign(Object.assign({},this._requestOptions),r);return NG(this.apiKey,this.model,n,i)}async batchEmbedContents(e,r={}){const n=Object.assign(Object.assign({},this._requestOptions),r);return zG(this.apiKey,this.model,e,n)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IM{constructor(e){this.apiKey=e}getGenerativeModel(e,r){if(!e.model)throw new jr("Must provide a model name. Example: genai.getGenerativeModel({ model: 'my-model-name' })");return new $M(this.apiKey,e,r)}getGenerativeModelFromCachedContent(e,r,n){if(!e.name)throw new wa("Cached content must contain a `name` field.");if(!e.model)throw new wa("Cached content must contain a `model` field.");const i=["model","systemInstruction"];for(const o of i)if(r?.[o]&&e[o]&&r?.[o]!==e[o]){if(o==="model"){const s=r.model.startsWith("models/")?r.model.replace("models/",""):r.model,l=e.model.startsWith("models/")?e.model.replace("models/",""):e.model;if(s===l)continue}throw new wa(`Different value for "${o}" specified in modelParams (${r[o]}) and cachedContent (${e[o]})`)}const a=Object.assign(Object.assign({},r),{model:e.model,tools:e.tools,toolConfig:e.toolConfig,systemInstruction:e.systemInstruction,cachedContent:e});return new $M(this.apiKey,a,n)}}function kc(t){if(typeof t=="object"&&t!==null){const e={...t};"additionalProperties"in e&&delete e.additionalProperties,"$schema"in e&&delete e.$schema;for(const r in e)r in e&&(Array.isArray(e[r])?e[r]=e[r].map(kc):typeof e[r]=="object"&&e[r]!==null&&(e[r]=kc(e[r])));return e}return t}function tD(t){const e=kc(ui(t)),{$schema:r,...n}=e;return n}function BG(t){const e=kc(t),{$schema:r,...n}=e;return n}function UG(t){const e=t._getType();return Co.isInstance(t)?t.role:e==="tool"?e:t.name??e}function FG(t){switch(t){case"ai":case"model":return"model";case"system":return"system";case"human":return"user";case"tool":case"function":return"function";default:throw new Error(`Unknown / unsupported author: ${t}`)}}function LG(t){if("mimeType"in t&&"data"in t)return{inlineData:{mimeType:t.mimeType,data:t.data}};if("mimeType"in t&&"fileUri"in t)return{fileData:{mimeType:t.mimeType,fileUri:t.fileUri}};throw new Error("Invalid media content")}function VG(t,e){if(typeof t.content=="string"&&t.content!=="")return[{text:t.content}];let r=[],n=[],i=[];return"tool_calls"in t&&Array.isArray(t.tool_calls)&&t.tool_calls.length>0?r=t.tool_calls.map(a=>({functionCall:{name:a.name,args:a.args}})):t.getType()==="tool"&&t.name&&t.content?n=[{functionResponse:{name:t.name,response:t.content}}]:Array.isArray(t.content)&&(i=t.content.map(a=>{if(a.type==="text")return{text:a.text};if(a.type==="executableCode")return{executableCode:a.executableCode};if(a.type==="codeExecutionResult")return{codeExecutionResult:a.codeExecutionResult};if(a.type==="image_url"){if(!e)throw new Error("This model does not support images");let o;if(typeof a.image_url=="string")o=a.image_url;else if(typeof a.image_url=="object"&&"url"in a.image_url)o=a.image_url.url;else throw new Error("Please provide image as base64 encoded data URL");const[s,l]=o.split(",");if(!s.startsWith("data:"))throw new Error("Please provide image as base64 encoded data URL");const[c,d]=s.replace(/^data:/,"").split(";");if(d!=="base64")throw new Error("Please provide image as base64 encoded data URL");return{inlineData:{data:l,mimeType:c}}}else{if(a.type==="media")return LG(a);if(a.type==="tool_use")return{functionCall:{name:a.name,args:a.input}};if(a.type?.includes("/")&&a.type.split("/").length===2&&"data"in a&&typeof a.data=="string")return{inlineData:{mimeType:a.type,data:a.data}}}throw new Error(`Unknown content type ${a.type}`)})),[...i,...r,...n]}function xM(t,e,r=!1){return t.reduce((n,i,a)=>{if(!Mu(i))throw new Error("Unsupported message input");const o=UG(i);if(o==="system"&&a!==0)throw new Error("System message should be the first one");const s=FG(o),l=n.content[n.content.length];if(!n.mergeWithPreviousContent&&l&&l.role===s)throw new Error("Google Generative AI requires alternate messages between authors");const c=VG(i,e);if(n.mergeWithPreviousContent){const h=n.content[n.content.length-1];if(!h)throw new Error("There was a problem parsing your system message. Please try a prompt without one.");return h.parts.push(...c),{mergeWithPreviousContent:!1,content:n.content}}let d=s;(d==="function"||d==="system"&&!r)&&(d="user");const f={role:d,parts:c};return{mergeWithPreviousContent:o==="system"&&!r,content:[...n.content,f]}},{content:[],mergeWithPreviousContent:!1}).content}function kG(t,e){if(!t.candidates||t.candidates.length===0||!t.candidates[0])return{generations:[],llmOutput:{filters:t.promptFeedback}};const r=t.functionCalls(),[n]=t.candidates,{content:i,...a}=n;let o;i?.parts.length===1&&i.parts[0].text?o=i.parts[0].text:o=i.parts.map(c=>"text"in c?{type:"text",text:c.text}:"executableCode"in c?{type:"executableCode",executableCode:c.executableCode}:"codeExecutionResult"in c?{type:"codeExecutionResult",codeExecutionResult:c.codeExecutionResult}:c);let s="";return typeof o=="string"?s=o:"text"in o[0]&&(s=o[0].text),{generations:[{text:s,message:new Nn({content:o,tool_calls:r?.map(c=>({...c,type:"tool_call"})),additional_kwargs:{...a},usage_metadata:e?.usageMetadata}),generationInfo:a}],llmOutput:{tokenUsage:{promptTokens:e?.usageMetadata?.input_tokens,completionTokens:e?.usageMetadata?.output_tokens,totalTokens:e?.usageMetadata?.total_tokens}}}}function HG(t,e){if(!t.candidates||t.candidates.length===0)return null;const r=t.functionCalls(),[n]=t.candidates,{content:i,...a}=n;let o;i?.parts&&i.parts.every(c=>"text"in c)?o=i.parts.map(c=>c.text).join(""):i.parts&&(o=i.parts.map(c=>"text"in c?{type:"text",text:c.text}:"executableCode"in c?{type:"executableCode",executableCode:c.executableCode}:"codeExecutionResult"in c?{type:"codeExecutionResult",codeExecutionResult:c.codeExecutionResult}:c));let s="";o&&typeof o=="string"?s=o:o&&typeof o=="object"&&"text"in o[0]&&(s=o[0].text);const l=[];return r&&l.push(...r.map(c=>({...c,args:JSON.stringify(c.args),index:e.index,type:"tool_call_chunk"}))),new Mr({text:s,message:new vt({content:o||"",name:i?i.role:void 0,tool_call_chunks:l,additional_kwargs:{},usage_metadata:e.usageMetadata}),generationInfo:a})}function qG(t){return t.every(e=>"functionDeclarations"in e&&Array.isArray(e.functionDeclarations))?t:[{functionDeclarations:t.map(e=>{if(zu(e)){const r=tD(e.schema);return{name:e.name,description:e.description,parameters:r}}return ud(e)?{name:e.function.name,description:e.function.description??"A function available to call.",parameters:BG(e.function.parameters)}:e})}]}class DM extends HE{static lc_name(){return"GoogleGenerativeAIToolsOutputParser"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","google_genai","output_parsers"]}),Object.defineProperty(this,"returnId",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"keyName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"returnSingle",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"zodSchema",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.keyName=e.keyName,this.returnSingle=e.returnSingle??this.returnSingle,this.zodSchema=e.zodSchema}async _validateResult(e){if(this.zodSchema===void 0)return e;const r=await this.zodSchema.safeParseAsync(e);if(r.success)return r.data;throw new bu(`Failed to parse. Text: "${JSON.stringify(e,null,2)}". Error: ${JSON.stringify(r.error.errors)}`,JSON.stringify(e,null,2))}async parseResult(e){const r=e.flatMap(a=>{const{message:o}=a;return!("tool_calls"in o)||!Array.isArray(o.tool_calls)?[]:o.tool_calls});if(r[0]===void 0)throw new Error("No parseable tool calls provided to GoogleGenerativeAIToolsOutputParser.");const[n]=r;return await this._validateResult(n.args)}}function NM(t,e){const r=GG(t),n=KG(r,e);return{tools:r,toolConfig:n}}function GG(t){let e=[];const r=[];return t.forEach(i=>{if(zu(i)){const[a]=qG([i]);a.functionDeclarations&&e.push(...a.functionDeclarations)}else if(ud(i)){const{functionDeclarations:a}=WG(i);if(a)e.push(...a);else throw new Error("Failed to convert OpenAI structured tool to GenerativeAI tool")}else r.push(i)}),r.find(i=>"functionDeclarations"in i)?r.map(i=>{if(e?.length>0&&"functionDeclarations"in i){const a={functionDeclarations:[...i.functionDeclarations||[],...e]};return e=[],a}return i}):[...r,...e.length>0?[{functionDeclarations:e}]:[]]}function WG(t){return{functionDeclarations:[{name:t.function.name,description:t.function.description,parameters:kc(t.function.parameters)}]}}function KG(t,e){if(!t.length||!e)return;const{toolChoice:r,allowedFunctionNames:n}=e,i={any:Ns.ANY,auto:Ns.AUTO,none:Ns.NONE};if(r&&["any","auto","none"].includes(r))return{functionCallingConfig:{mode:i[r]??"MODE_UNSPECIFIED",allowedFunctionNames:n}};if(typeof r=="string"||n)return{functionCallingConfig:{mode:Ns.ANY,allowedFunctionNames:[...n??[],...r&&typeof r=="string"?[r]:[]]}}}class JG extends un{static lc_name(){return"ChatGoogleGenerativeAI"}get lc_secrets(){return{apiKey:"GOOGLE_API_KEY"}}get lc_aliases(){return{apiKey:"google_api_key"}}get _isMultimodalModel(){return this.model.includes("vision")||this.model.startsWith("gemini-1.5")||this.model.startsWith("gemini-2")}constructor(e){if(super(e??{}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","chat_models","google_genai"]}),Object.defineProperty(this,"modelName",{enumerable:!0,configurable:!0,writable:!0,value:"gemini-pro"}),Object.defineProperty(this,"model",{enumerable:!0,configurable:!0,writable:!0,value:"gemini-pro"}),Object.defineProperty(this,"temperature",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxOutputTokens",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"topP",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"topK",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stopSequences",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"safetySettings",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"streaming",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"streamUsage",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"convertSystemMessageToHumanContent",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.modelName=e?.model?.replace(/^models\//,"")??e?.modelName?.replace(/^models\//,"")??this.model,this.model=this.modelName,this.maxOutputTokens=e?.maxOutputTokens??this.maxOutputTokens,this.maxOutputTokens&&this.maxOutputTokens<0)throw new Error("`maxOutputTokens` must be a positive integer");if(this.temperature=e?.temperature??this.temperature,this.temperature&&(this.temperature<0||this.temperature>2))throw new Error("`temperature` must be in the range of [0.0,2.0]");if(this.topP=e?.topP??this.topP,this.topP&&this.topP<0)throw new Error("`topP` must be a positive integer");if(this.topP&&this.topP>1)throw new Error("`topP` must be below 1.");if(this.topK=e?.topK??this.topK,this.topK&&this.topK<0)throw new Error("`topK` must be a positive integer");if(this.stopSequences=e?.stopSequences??this.stopSequences,this.apiKey=e?.apiKey??Ye("GOOGLE_API_KEY"),!this.apiKey)throw new Error("Please set an API key for Google GenerativeAI in the environment variable GOOGLE_API_KEY or in the `apiKey` field of the ChatGoogleGenerativeAI constructor");if(this.safetySettings=e?.safetySettings??this.safetySettings,this.safetySettings&&this.safetySettings.length>0&&new Set(this.safetySettings.map(n=>n.category)).size!==this.safetySettings.length)throw new Error("The categories in `safetySettings` array must be unique");this.streaming=e?.streaming??this.streaming,this.client=new IM(this.apiKey).getGenerativeModel({model:this.model,safetySettings:this.safetySettings,generationConfig:{candidateCount:1,stopSequences:this.stopSequences,maxOutputTokens:this.maxOutputTokens,temperature:this.temperature,topP:this.topP,topK:this.topK,...e?.json?{responseMimeType:"application/json"}:{}}},{apiVersion:e?.apiVersion,baseUrl:e?.baseUrl}),this.streamUsage=e?.streamUsage??this.streamUsage}useCachedContent(e,r,n){this.apiKey&&(this.client=new IM(this.apiKey).getGenerativeModelFromCachedContent(e,r,n))}get useSystemInstruction(){return typeof this.convertSystemMessageToHumanContent=="boolean"?!this.convertSystemMessageToHumanContent:this.computeUseSystemInstruction}get computeUseSystemInstruction(){return this.modelName==="gemini-1.0-pro-001"||this.modelName.startsWith("gemini-pro-vision")||this.modelName.startsWith("gemini-1.0-pro-vision")?!1:this.modelName!=="gemini-pro"}getLsParams(e){return{ls_provider:"google_genai",ls_model_name:this.model,ls_model_type:"chat",ls_temperature:this.client.generationConfig.temperature,ls_max_tokens:this.client.generationConfig.maxOutputTokens,ls_stop:e.stop}}_combineLLMOutput(){return[]}_llmType(){return"googlegenerativeai"}bindTools(e,r){return this.bind({tools:NM(e)?.tools,...r})}invocationParams(e){const r=e?.tools?.length?NM(e.tools,{toolChoice:e.tool_choice,allowedFunctionNames:e.allowedFunctionNames}):void 0;return{...r?.tools?{tools:r.tools}:{},...r?.toolConfig?{toolConfig:r.toolConfig}:{}}}async _generate(e,r,n){const i=xM(e,this._isMultimodalModel,this.useSystemInstruction);let a=i;if(i[0].role==="system"){const[d]=i;this.client.systemInstruction=d,a=i.slice(1)}const o=this.invocationParams(r);if(this.streaming){const d={},f=this._streamResponseChunks(e,r,n),h={};for await(const b of f){const g=b.generationInfo?.completion??0;h[g]===void 0?h[g]=b:h[g]=h[g].concat(b)}return{generations:Object.entries(h).sort(([b],[g])=>parseInt(b,10)-parseInt(g,10)).map(([b,g])=>g),llmOutput:{estimatedTokenUsage:d}}}const s=await this.completionWithRetry({...o,contents:a});let l;if("usageMetadata"in s.response){const d=s.response.usageMetadata;l={input_tokens:d.promptTokenCount??0,output_tokens:d.candidatesTokenCount??0,total_tokens:d.totalTokenCount??0}}const c=kG(s.response,{usageMetadata:l});return await n?.handleLLMNewToken(c.generations[0].text??""),c}async*_streamResponseChunks(e,r,n){const i=xM(e,this._isMultimodalModel,this.useSystemInstruction);let a=i;if(i[0].role==="system"){const[f]=i;this.client.systemInstruction=f,a=i.slice(1)}const s={...this.invocationParams(r),contents:a},l=await this.caller.callWithOptions({signal:r?.signal},async()=>{const{stream:f}=await this.client.generateContentStream(s);return f});let c,d=0;for await(const f of l){if("usageMetadata"in f&&this.streamUsage!==!1&&r.streamUsage!==!1){const p=f.usageMetadata;if(!c)c={input_tokens:p.promptTokenCount??0,output_tokens:p.candidatesTokenCount??0,total_tokens:p.totalTokenCount??0};else{const b=(p.candidatesTokenCount??0)-c.output_tokens;c={input_tokens:0,output_tokens:b,total_tokens:b}}}const h=HG(f,{usageMetadata:c,index:d});d+=1,h&&(yield h,await n?.handleLLMNewToken(h.text??""))}}async completionWithRetry(e,r){return this.caller.callWithOptions({signal:r?.signal},async()=>{try{return await this.client.generateContent(e)}catch(n){throw n.message?.includes("400 Bad Request")&&(n.status=400),n}})}withStructuredOutput(e,r){const n=e,i=r?.name,a=r?.method,o=r?.includeRaw;if(a==="jsonMode")throw new Error('ChatGoogleGenerativeAI only supports "functionCalling" as a method.');let s=i??"extract",l,c;if(yu(n)){const b=tD(n);c=[{functionDeclarations:[{name:s,description:b.description??"A function available to call.",parameters:b}]}],l=new DM({returnSingle:!0,keyName:s,zodSchema:n})}else{let b;typeof n.name=="string"&&typeof n.parameters=="object"&&n.parameters!=null?(b=n,s=n.name):b={name:s,description:n.description??"",parameters:n},c=[{functionDeclarations:[b]}],l=new DM({returnSingle:!0,keyName:s})}const d=this.bind({tools:c,tool_choice:s});if(!o)return d.pipe(l).withConfig({runName:"ChatGoogleGenerativeAIStructuredOutput"});const f=li.assign({parsed:(b,g)=>l.invoke(b.raw,g)}),h=li.assign({parsed:()=>null}),p=f.withFallbacks({fallbacks:[h]});return Gr.from([{raw:d},p]).withConfig({runName:"StructuredOutputRunnable"})}}var rD={},Vi={},nD={},iD={},iP={},aD={};Object.defineProperty(aD,"__esModule",{value:!0});var vb={};Object.defineProperty(vb,"__esModule",{value:!0});vb.V2ChatStreamRequestSafetyMode=void 0;vb.V2ChatStreamRequestSafetyMode={Contextual:"CONTEXTUAL",Strict:"STRICT",Off:"OFF"};var wb={};Object.defineProperty(wb,"__esModule",{value:!0});wb.V2ChatStreamRequestToolChoice=void 0;wb.V2ChatStreamRequestToolChoice={Required:"REQUIRED",None:"NONE"};var oD={};Object.defineProperty(oD,"__esModule",{value:!0});var Ob={};Object.defineProperty(Ob,"__esModule",{value:!0});Ob.V2ChatRequestSafetyMode=void 0;Ob.V2ChatRequestSafetyMode={Contextual:"CONTEXTUAL",Strict:"STRICT",Off:"OFF"};var Sb={};Object.defineProperty(Sb,"__esModule",{value:!0});Sb.V2ChatRequestToolChoice=void 0;Sb.V2ChatRequestToolChoice={Required:"REQUIRED",None:"NONE"};var Eb={};Object.defineProperty(Eb,"__esModule",{value:!0});Eb.V2EmbedRequestTruncate=void 0;Eb.V2EmbedRequestTruncate={None:"NONE",Start:"START",End:"END"};var sD={};Object.defineProperty(sD,"__esModule",{value:!0});var uD={};Object.defineProperty(uD,"__esModule",{value:!0});var lD={};Object.defineProperty(lD,"__esModule",{value:!0});(function(t){var e=u&&u.__createBinding||(Object.create?function(n,i,a,o){o===void 0&&(o=a);var s=Object.getOwnPropertyDescriptor(i,a);(!s||("get"in s?!i.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return i[a]}}),Object.defineProperty(n,o,s)}:function(n,i,a,o){o===void 0&&(o=a),n[o]=i[a]}),r=u&&u.__exportStar||function(n,i){for(var a in n)a!=="default"&&!Object.prototype.hasOwnProperty.call(i,a)&&e(i,n,a)};Object.defineProperty(t,"__esModule",{value:!0}),r(aD,t),r(vb,t),r(wb,t),r(oD,t),r(Ob,t),r(Sb,t),r(Eb,t),r(sD,t),r(uD,t),r(lD,t)})(iP);var cD={},aP={};Object.defineProperty(aP,"__esModule",{value:!0});(function(t){var e=u&&u.__createBinding||(Object.create?function(n,i,a,o){o===void 0&&(o=a);var s=Object.getOwnPropertyDescriptor(i,a);(!s||("get"in s?!i.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return i[a]}}),Object.defineProperty(n,o,s)}:function(n,i,a,o){o===void 0&&(o=a),n[o]=i[a]}),r=u&&u.__exportStar||function(n,i){for(var a in n)a!=="default"&&!Object.prototype.hasOwnProperty.call(i,a)&&e(i,n,a)};Object.defineProperty(t,"__esModule",{value:!0}),r(aP,t)})(cD);(function(t){var e=u&&u.__createBinding||(Object.create?function(n,i,a,o){o===void 0&&(o=a);var s=Object.getOwnPropertyDescriptor(i,a);(!s||("get"in s?!i.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return i[a]}}),Object.defineProperty(n,o,s)}:function(n,i,a,o){o===void 0&&(o=a),n[o]=i[a]}),r=u&&u.__exportStar||function(n,i){for(var a in n)a!=="default"&&!Object.prototype.hasOwnProperty.call(i,a)&&e(i,n,a)};Object.defineProperty(t,"__esModule",{value:!0}),r(iP,t),r(cD,t)})(iD);var dD={},oP={},Pb={};Object.defineProperty(Pb,"__esModule",{value:!0});Pb.CreateEmbedJobRequestTruncate=void 0;Pb.CreateEmbedJobRequestTruncate={Start:"START",End:"END"};(function(t){var e=u&&u.__createBinding||(Object.create?function(n,i,a,o){o===void 0&&(o=a);var s=Object.getOwnPropertyDescriptor(i,a);(!s||("get"in s?!i.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return i[a]}}),Object.defineProperty(n,o,s)}:function(n,i,a,o){o===void 0&&(o=a),n[o]=i[a]}),r=u&&u.__exportStar||function(n,i){for(var a in n)a!=="default"&&!Object.prototype.hasOwnProperty.call(i,a)&&e(i,n,a)};Object.defineProperty(t,"__esModule",{value:!0}),r(Pb,t)})(oP);var fD={},sP={};Object.defineProperty(sP,"__esModule",{value:!0});(function(t){var e=u&&u.__createBinding||(Object.create?function(n,i,a,o){o===void 0&&(o=a);var s=Object.getOwnPropertyDescriptor(i,a);(!s||("get"in s?!i.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return i[a]}}),Object.defineProperty(n,o,s)}:function(n,i,a,o){o===void 0&&(o=a),n[o]=i[a]}),r=u&&u.__exportStar||function(n,i){for(var a in n)a!=="default"&&!Object.prototype.hasOwnProperty.call(i,a)&&e(i,n,a)};Object.defineProperty(t,"__esModule",{value:!0}),r(sP,t)})(fD);(function(t){var e=u&&u.__createBinding||(Object.create?function(n,i,a,o){o===void 0&&(o=a);var s=Object.getOwnPropertyDescriptor(i,a);(!s||("get"in s?!i.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return i[a]}}),Object.defineProperty(n,o,s)}:function(n,i,a,o){o===void 0&&(o=a),n[o]=i[a]}),r=u&&u.__exportStar||function(n,i){for(var a in n)a!=="default"&&!Object.prototype.hasOwnProperty.call(i,a)&&e(i,n,a)};Object.defineProperty(t,"__esModule",{value:!0}),r(oP,t),r(fD,t)})(dD);var hD={},uP={},pD={};Object.defineProperty(pD,"__esModule",{value:!0});var _D={};Object.defineProperty(_D,"__esModule",{value:!0});var yD={};Object.defineProperty(yD,"__esModule",{value:!0});var bD={};Object.defineProperty(bD,"__esModule",{value:!0});var gD={};Object.defineProperty(gD,"__esModule",{value:!0});(function(t){var e=u&&u.__createBinding||(Object.create?function(n,i,a,o){o===void 0&&(o=a);var s=Object.getOwnPropertyDescriptor(i,a);(!s||("get"in s?!i.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return i[a]}}),Object.defineProperty(n,o,s)}:function(n,i,a,o){o===void 0&&(o=a),n[o]=i[a]}),r=u&&u.__exportStar||function(n,i){for(var a in n)a!=="default"&&!Object.prototype.hasOwnProperty.call(i,a)&&e(i,n,a)};Object.defineProperty(t,"__esModule",{value:!0}),r(pD,t),r(_D,t),r(yD,t),r(bD,t),r(gD,t)})(uP);var mD={},lP={};Object.defineProperty(lP,"__esModule",{value:!0});(function(t){var e=u&&u.__createBinding||(Object.create?function(n,i,a,o){o===void 0&&(o=a);var s=Object.getOwnPropertyDescriptor(i,a);(!s||("get"in s?!i.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return i[a]}}),Object.defineProperty(n,o,s)}:function(n,i,a,o){o===void 0&&(o=a),n[o]=i[a]}),r=u&&u.__exportStar||function(n,i){for(var a in n)a!=="default"&&!Object.prototype.hasOwnProperty.call(i,a)&&e(i,n,a)};Object.defineProperty(t,"__esModule",{value:!0}),r(lP,t)})(mD);(function(t){var e=u&&u.__createBinding||(Object.create?function(n,i,a,o){o===void 0&&(o=a);var s=Object.getOwnPropertyDescriptor(i,a);(!s||("get"in s?!i.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return i[a]}}),Object.defineProperty(n,o,s)}:function(n,i,a,o){o===void 0&&(o=a),n[o]=i[a]}),r=u&&u.__exportStar||function(n,i){for(var a in n)a!=="default"&&!Object.prototype.hasOwnProperty.call(i,a)&&e(i,n,a)};Object.defineProperty(t,"__esModule",{value:!0}),r(uP,t),r(mD,t)})(hD);var vD={},wD={},OD={},cP={},jb={};Object.defineProperty(jb,"__esModule",{value:!0});jb.BaseType=void 0;jb.BaseType={BaseTypeUnspecified:"BASE_TYPE_UNSPECIFIED",BaseTypeGenerative:"BASE_TYPE_GENERATIVE",BaseTypeClassification:"BASE_TYPE_CLASSIFICATION",BaseTypeRerank:"BASE_TYPE_RERANK",BaseTypeChat:"BASE_TYPE_CHAT"};var Cb={};Object.defineProperty(Cb,"__esModule",{value:!0});Cb.Strategy=void 0;Cb.Strategy={StrategyUnspecified:"STRATEGY_UNSPECIFIED",StrategyVanilla:"STRATEGY_VANILLA",StrategyTfew:"STRATEGY_TFEW"};var SD={};Object.defineProperty(SD,"__esModule",{value:!0});var Mb={};Object.defineProperty(Mb,"__esModule",{value:!0});Mb.LoraTargetModules=void 0;Mb.LoraTargetModules={LoraTargetModulesUnspecified:"LORA_TARGET_MODULES_UNSPECIFIED",LoraTargetModulesQv:"LORA_TARGET_MODULES_QV",LoraTargetModulesQkvo:"LORA_TARGET_MODULES_QKVO",LoraTargetModulesQkvoFfn:"LORA_TARGET_MODULES_QKVO_FFN"};var ED={};Object.defineProperty(ED,"__esModule",{value:!0});var PD={};Object.defineProperty(PD,"__esModule",{value:!0});var jD={};Object.defineProperty(jD,"__esModule",{value:!0});var Tb={};Object.defineProperty(Tb,"__esModule",{value:!0});Tb.Status=void 0;Tb.Status={StatusUnspecified:"STATUS_UNSPECIFIED",StatusFinetuning:"STATUS_FINETUNING",StatusDeployingApi:"STATUS_DEPLOYING_API",StatusReady:"STATUS_READY",StatusFailed:"STATUS_FAILED",StatusDeleted:"STATUS_DELETED",StatusTemporarilyOffline:"STATUS_TEMPORARILY_OFFLINE",StatusPaused:"STATUS_PAUSED",StatusQueued:"STATUS_QUEUED"};var CD={};Object.defineProperty(CD,"__esModule",{value:!0});var MD={};Object.defineProperty(MD,"__esModule",{value:!0});var TD={};Object.defineProperty(TD,"__esModule",{value:!0});var RD={};Object.defineProperty(RD,"__esModule",{value:!0});var AD={};Object.defineProperty(AD,"__esModule",{value:!0});var $D={};Object.defineProperty($D,"__esModule",{value:!0});var ID={};Object.defineProperty(ID,"__esModule",{value:!0});var xD={};Object.defineProperty(xD,"__esModule",{value:!0});var DD={};Object.defineProperty(DD,"__esModule",{value:!0});var ND={};Object.defineProperty(ND,"__esModule",{value:!0});(function(t){var e=u&&u.__createBinding||(Object.create?function(n,i,a,o){o===void 0&&(o=a);var s=Object.getOwnPropertyDescriptor(i,a);(!s||("get"in s?!i.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return i[a]}}),Object.defineProperty(n,o,s)}:function(n,i,a,o){o===void 0&&(o=a),n[o]=i[a]}),r=u&&u.__exportStar||function(n,i){for(var a in n)a!=="default"&&!Object.prototype.hasOwnProperty.call(i,a)&&e(i,n,a)};Object.defineProperty(t,"__esModule",{value:!0}),r(jb,t),r(Cb,t),r(SD,t),r(Mb,t),r(ED,t),r(PD,t),r(jD,t),r(Tb,t),r(CD,t),r(MD,t),r(TD,t),r(RD,t),r(AD,t),r($D,t),r(ID,t),r(xD,t),r(DD,t),r(ND,t)})(cP);(function(t){var e=u&&u.__createBinding||(Object.create?function(n,i,a,o){o===void 0&&(o=a);var s=Object.getOwnPropertyDescriptor(i,a);(!s||("get"in s?!i.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return i[a]}}),Object.defineProperty(n,o,s)}:function(n,i,a,o){o===void 0&&(o=a),n[o]=i[a]}),r=u&&u.__exportStar||function(n,i){for(var a in n)a!=="default"&&!Object.prototype.hasOwnProperty.call(i,a)&&e(i,n,a)};Object.defineProperty(t,"__esModule",{value:!0}),r(cP,t)})(OD);(function(t){var e=u&&u.__createBinding||(Object.create?function(a,o,s,l){l===void 0&&(l=s);var c=Object.getOwnPropertyDescriptor(o,s);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(a,l,c)}:function(a,o,s,l){l===void 0&&(l=s),a[l]=o[s]}),r=u&&u.__setModuleDefault||(Object.create?function(a,o){Object.defineProperty(a,"default",{enumerable:!0,value:o})}:function(a,o){a.default=o}),n=u&&u.__importStar||function(a){if(a&&a.__esModule)return a;var o={};if(a!=null)for(var s in a)s!=="default"&&Object.prototype.hasOwnProperty.call(a,s)&&e(o,a,s);return r(o,a),o},i=u&&u.__exportStar||function(a,o){for(var s in a)s!=="default"&&!Object.prototype.hasOwnProperty.call(o,s)&&e(o,a,s)};Object.defineProperty(t,"__esModule",{value:!0}),t.finetuning=void 0,t.finetuning=n(OD),i(cP,t)})(wD);var zD={},dP={};Object.defineProperty(dP,"__esModule",{value:!0});(function(t){var e=u&&u.__createBinding||(Object.create?function(n,i,a,o){o===void 0&&(o=a);var s=Object.getOwnPropertyDescriptor(i,a);(!s||("get"in s?!i.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return i[a]}}),Object.defineProperty(n,o,s)}:function(n,i,a,o){o===void 0&&(o=a),n[o]=i[a]}),r=u&&u.__exportStar||function(n,i){for(var a in n)a!=="default"&&!Object.prototype.hasOwnProperty.call(i,a)&&e(i,n,a)};Object.defineProperty(t,"__esModule",{value:!0}),r(dP,t)})(zD);(function(t){var e=u&&u.__createBinding||(Object.create?function(n,i,a,o){o===void 0&&(o=a);var s=Object.getOwnPropertyDescriptor(i,a);(!s||("get"in s?!i.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return i[a]}}),Object.defineProperty(n,o,s)}:function(n,i,a,o){o===void 0&&(o=a),n[o]=i[a]}),r=u&&u.__exportStar||function(n,i){for(var a in n)a!=="default"&&!Object.prototype.hasOwnProperty.call(i,a)&&e(i,n,a)};Object.defineProperty(t,"__esModule",{value:!0}),r(wD,t),r(zD,t)})(vD);var BD={},UD={},fP={};Object.defineProperty(fP,"__esModule",{value:!0});(function(t){var e=u&&u.__createBinding||(Object.create?function(n,i,a,o){o===void 0&&(o=a);var s=Object.getOwnPropertyDescriptor(i,a);(!s||("get"in s?!i.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return i[a]}}),Object.defineProperty(n,o,s)}:function(n,i,a,o){o===void 0&&(o=a),n[o]=i[a]}),r=u&&u.__exportStar||function(n,i){for(var a in n)a!=="default"&&!Object.prototype.hasOwnProperty.call(i,a)&&e(i,n,a)};Object.defineProperty(t,"__esModule",{value:!0}),r(fP,t)})(UD);(function(t){var e=u&&u.__createBinding||(Object.create?function(n,i,a,o){o===void 0&&(o=a);var s=Object.getOwnPropertyDescriptor(i,a);(!s||("get"in s?!i.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return i[a]}}),Object.defineProperty(n,o,s)}:function(n,i,a,o){o===void 0&&(o=a),n[o]=i[a]}),r=u&&u.__exportStar||function(n,i){for(var a in n)a!=="default"&&!Object.prototype.hasOwnProperty.call(i,a)&&e(i,n,a)};Object.defineProperty(t,"__esModule",{value:!0}),r(UD,t)})(BD);var FD={},LD={},hP={};Object.defineProperty(hP,"__esModule",{value:!0});(function(t){var e=u&&u.__createBinding||(Object.create?function(n,i,a,o){o===void 0&&(o=a);var s=Object.getOwnPropertyDescriptor(i,a);(!s||("get"in s?!i.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return i[a]}}),Object.defineProperty(n,o,s)}:function(n,i,a,o){o===void 0&&(o=a),n[o]=i[a]}),r=u&&u.__exportStar||function(n,i){for(var a in n)a!=="default"&&!Object.prototype.hasOwnProperty.call(i,a)&&e(i,n,a)};Object.defineProperty(t,"__esModule",{value:!0}),r(hP,t)})(LD);(function(t){var e=u&&u.__createBinding||(Object.create?function(n,i,a,o){o===void 0&&(o=a);var s=Object.getOwnPropertyDescriptor(i,a);(!s||("get"in s?!i.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return i[a]}}),Object.defineProperty(n,o,s)}:function(n,i,a,o){o===void 0&&(o=a),n[o]=i[a]}),r=u&&u.__exportStar||function(n,i){for(var a in n)a!=="default"&&!Object.prototype.hasOwnProperty.call(i,a)&&e(i,n,a)};Object.defineProperty(t,"__esModule",{value:!0}),r(LD,t)})(FD);(function(t){var e=u&&u.__createBinding||(Object.create?function(a,o,s,l){l===void 0&&(l=s);var c=Object.getOwnPropertyDescriptor(o,s);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(a,l,c)}:function(a,o,s,l){l===void 0&&(l=s),a[l]=o[s]}),r=u&&u.__setModuleDefault||(Object.create?function(a,o){Object.defineProperty(a,"default",{enumerable:!0,value:o})}:function(a,o){a.default=o}),n=u&&u.__importStar||function(a){if(a&&a.__esModule)return a;var o={};if(a!=null)for(var s in a)s!=="default"&&Object.prototype.hasOwnProperty.call(a,s)&&e(o,a,s);return r(o,a),o},i=u&&u.__exportStar||function(a,o){for(var s in a)s!=="default"&&!Object.prototype.hasOwnProperty.call(o,s)&&e(o,a,s)};Object.defineProperty(t,"__esModule",{value:!0}),t.models=t.connectors=t.finetuning=t.datasets=t.embedJobs=t.v2=void 0,t.v2=n(iD),i(iP,t),t.embedJobs=n(dD),i(oP,t),t.datasets=n(hD),i(uP,t),t.finetuning=n(vD),t.connectors=n(BD),t.models=n(FD),i(aP,t),i(sP,t),i(lP,t),i(fP,t),i(hP,t),i(dP,t)})(nD);var VD={},Rb={};Object.defineProperty(Rb,"__esModule",{value:!0});Rb.ChatStreamRequestPromptTruncation=void 0;Rb.ChatStreamRequestPromptTruncation={Off:"OFF",Auto:"AUTO",AutoPreserveOrder:"AUTO_PRESERVE_ORDER"};var Ab={};Object.defineProperty(Ab,"__esModule",{value:!0});Ab.ChatStreamRequestCitationQuality=void 0;Ab.ChatStreamRequestCitationQuality={Fast:"fast",Accurate:"accurate",Off:"off"};var kD={};Object.defineProperty(kD,"__esModule",{value:!0});var $b={};Object.defineProperty($b,"__esModule",{value:!0});$b.ChatStreamRequestSafetyMode=void 0;$b.ChatStreamRequestSafetyMode={Contextual:"CONTEXTUAL",Strict:"STRICT",None:"NONE"};var Ib={};Object.defineProperty(Ib,"__esModule",{value:!0});Ib.ChatRequestPromptTruncation=void 0;Ib.ChatRequestPromptTruncation={Off:"OFF",Auto:"AUTO",AutoPreserveOrder:"AUTO_PRESERVE_ORDER"};var xb={};Object.defineProperty(xb,"__esModule",{value:!0});xb.ChatRequestCitationQuality=void 0;xb.ChatRequestCitationQuality={Fast:"fast",Accurate:"accurate",Off:"off"};var HD={};Object.defineProperty(HD,"__esModule",{value:!0});var Db={};Object.defineProperty(Db,"__esModule",{value:!0});Db.ChatRequestSafetyMode=void 0;Db.ChatRequestSafetyMode={Contextual:"CONTEXTUAL",Strict:"STRICT",None:"NONE"};var Nb={};Object.defineProperty(Nb,"__esModule",{value:!0});Nb.GenerateStreamRequestTruncate=void 0;Nb.GenerateStreamRequestTruncate={None:"NONE",Start:"START",End:"END"};var zb={};Object.defineProperty(zb,"__esModule",{value:!0});zb.GenerateStreamRequestReturnLikelihoods=void 0;zb.GenerateStreamRequestReturnLikelihoods={Generation:"GENERATION",All:"ALL",None:"NONE"};var Bb={};Object.defineProperty(Bb,"__esModule",{value:!0});Bb.GenerateRequestTruncate=void 0;Bb.GenerateRequestTruncate={None:"NONE",Start:"START",End:"END"};var Ub={};Object.defineProperty(Ub,"__esModule",{value:!0});Ub.GenerateRequestReturnLikelihoods=void 0;Ub.GenerateRequestReturnLikelihoods={Generation:"GENERATION",All:"ALL",None:"NONE"};var Fb={};Object.defineProperty(Fb,"__esModule",{value:!0});Fb.EmbedRequestTruncate=void 0;Fb.EmbedRequestTruncate={None:"NONE",Start:"START",End:"END"};var qD={};Object.defineProperty(qD,"__esModule",{value:!0});var GD={};Object.defineProperty(GD,"__esModule",{value:!0});var WD={};Object.defineProperty(WD,"__esModule",{value:!0});var KD={};Object.defineProperty(KD,"__esModule",{value:!0});var JD={};Object.defineProperty(JD,"__esModule",{value:!0});var Lb={};Object.defineProperty(Lb,"__esModule",{value:!0});Lb.ClassifyRequestTruncate=void 0;Lb.ClassifyRequestTruncate={None:"NONE",Start:"START",End:"END"};var XD={};Object.defineProperty(XD,"__esModule",{value:!0});var Vb={};Object.defineProperty(Vb,"__esModule",{value:!0});Vb.ClassifyResponseClassificationsItemClassificationType=void 0;Vb.ClassifyResponseClassificationsItemClassificationType={SingleLabel:"single-label",MultiLabel:"multi-label"};var ZD={};Object.defineProperty(ZD,"__esModule",{value:!0});var YD={};Object.defineProperty(YD,"__esModule",{value:!0});var kb={};Object.defineProperty(kb,"__esModule",{value:!0});kb.SummarizeRequestLength=void 0;kb.SummarizeRequestLength={Short:"short",Medium:"medium",Long:"long"};var Hb={};Object.defineProperty(Hb,"__esModule",{value:!0});Hb.SummarizeRequestFormat=void 0;Hb.SummarizeRequestFormat={Paragraph:"paragraph",Bullets:"bullets"};var qb={};Object.defineProperty(qb,"__esModule",{value:!0});qb.SummarizeRequestExtractiveness=void 0;qb.SummarizeRequestExtractiveness={Low:"low",Medium:"medium",High:"high"};var QD={};Object.defineProperty(QD,"__esModule",{value:!0});var eN={};Object.defineProperty(eN,"__esModule",{value:!0});var tN={};Object.defineProperty(tN,"__esModule",{value:!0});var rN={};Object.defineProperty(rN,"__esModule",{value:!0});var nN={};Object.defineProperty(nN,"__esModule",{value:!0});var iN={};Object.defineProperty(iN,"__esModule",{value:!0});var aN={};Object.defineProperty(aN,"__esModule",{value:!0});var oN={};Object.defineProperty(oN,"__esModule",{value:!0});var sN={};Object.defineProperty(sN,"__esModule",{value:!0});var uN={};Object.defineProperty(uN,"__esModule",{value:!0});var lN={};Object.defineProperty(lN,"__esModule",{value:!0});var cN={};Object.defineProperty(cN,"__esModule",{value:!0});var dN={};Object.defineProperty(dN,"__esModule",{value:!0});var fN={};Object.defineProperty(fN,"__esModule",{value:!0});var hN={};Object.defineProperty(hN,"__esModule",{value:!0});var pN={};Object.defineProperty(pN,"__esModule",{value:!0});var Gb={};Object.defineProperty(Gb,"__esModule",{value:!0});Gb.ChatCitationType=void 0;Gb.ChatCitationType={TextContent:"TEXT_CONTENT",Plan:"PLAN"};var _N={};Object.defineProperty(_N,"__esModule",{value:!0});var yN={};Object.defineProperty(yN,"__esModule",{value:!0});var bN={};Object.defineProperty(bN,"__esModule",{value:!0});var gN={};Object.defineProperty(gN,"__esModule",{value:!0});var Wb={};Object.defineProperty(Wb,"__esModule",{value:!0});Wb.FinishReason=void 0;Wb.FinishReason={Complete:"COMPLETE",StopSequence:"STOP_SEQUENCE",Error:"ERROR",ErrorToxic:"ERROR_TOXIC",ErrorLimit:"ERROR_LIMIT",UserCancel:"USER_CANCEL",MaxTokens:"MAX_TOKENS"};var mN={};Object.defineProperty(mN,"__esModule",{value:!0});var vN={};Object.defineProperty(vN,"__esModule",{value:!0});var wN={};Object.defineProperty(wN,"__esModule",{value:!0});var ON={};Object.defineProperty(ON,"__esModule",{value:!0});var SN={};Object.defineProperty(SN,"__esModule",{value:!0});var EN={};Object.defineProperty(EN,"__esModule",{value:!0});var PN={};Object.defineProperty(PN,"__esModule",{value:!0});var jN={};Object.defineProperty(jN,"__esModule",{value:!0});var CN={};Object.defineProperty(CN,"__esModule",{value:!0});var MN={};Object.defineProperty(MN,"__esModule",{value:!0});var TN={};Object.defineProperty(TN,"__esModule",{value:!0});var RN={};Object.defineProperty(RN,"__esModule",{value:!0});var Kb={};Object.defineProperty(Kb,"__esModule",{value:!0});Kb.ChatStreamEndEventFinishReason=void 0;Kb.ChatStreamEndEventFinishReason={Complete:"COMPLETE",ErrorLimit:"ERROR_LIMIT",MaxTokens:"MAX_TOKENS",Error:"ERROR",ErrorToxic:"ERROR_TOXIC"};var AN={};Object.defineProperty(AN,"__esModule",{value:!0});var $N={};Object.defineProperty($N,"__esModule",{value:!0});var IN={};Object.defineProperty(IN,"__esModule",{value:!0});var xN={};Object.defineProperty(xN,"__esModule",{value:!0});var DN={};Object.defineProperty(DN,"__esModule",{value:!0});var NN={};Object.defineProperty(NN,"__esModule",{value:!0});var zN={};Object.defineProperty(zN,"__esModule",{value:!0});var BN={};Object.defineProperty(BN,"__esModule",{value:!0});var UN={};Object.defineProperty(UN,"__esModule",{value:!0});var FN={};Object.defineProperty(FN,"__esModule",{value:!0});var LN={};Object.defineProperty(LN,"__esModule",{value:!0});var VN={};Object.defineProperty(VN,"__esModule",{value:!0});var kN={};Object.defineProperty(kN,"__esModule",{value:!0});var HN={};Object.defineProperty(HN,"__esModule",{value:!0});var qN={};Object.defineProperty(qN,"__esModule",{value:!0});var GN={};Object.defineProperty(GN,"__esModule",{value:!0});var Jb={};Object.defineProperty(Jb,"__esModule",{value:!0});Jb.CitationType=void 0;Jb.CitationType={TextContent:"TEXT_CONTENT",Plan:"PLAN"};var WN={};Object.defineProperty(WN,"__esModule",{value:!0});var KN={};Object.defineProperty(KN,"__esModule",{value:!0});var JN={};Object.defineProperty(JN,"__esModule",{value:!0});var XN={};Object.defineProperty(XN,"__esModule",{value:!0});var ZN={};Object.defineProperty(ZN,"__esModule",{value:!0});var YN={};Object.defineProperty(YN,"__esModule",{value:!0});var QN={};Object.defineProperty(QN,"__esModule",{value:!0});var ez={};Object.defineProperty(ez,"__esModule",{value:!0});var tz={};Object.defineProperty(tz,"__esModule",{value:!0});var rz={};Object.defineProperty(rz,"__esModule",{value:!0});var nz={};Object.defineProperty(nz,"__esModule",{value:!0});var iz={};Object.defineProperty(iz,"__esModule",{value:!0});var az={};Object.defineProperty(az,"__esModule",{value:!0});var oz={};Object.defineProperty(oz,"__esModule",{value:!0});var sz={};Object.defineProperty(sz,"__esModule",{value:!0});var uz={};Object.defineProperty(uz,"__esModule",{value:!0});var Xb={};Object.defineProperty(Xb,"__esModule",{value:!0});Xb.CitationOptionsMode=void 0;Xb.CitationOptionsMode={Fast:"FAST",Accurate:"ACCURATE",Off:"OFF"};var lz={};Object.defineProperty(lz,"__esModule",{value:!0});var cz={};Object.defineProperty(cz,"__esModule",{value:!0});var dz={};Object.defineProperty(dz,"__esModule",{value:!0});var fz={};Object.defineProperty(fz,"__esModule",{value:!0});var Zb={};Object.defineProperty(Zb,"__esModule",{value:!0});Zb.ChatFinishReason=void 0;Zb.ChatFinishReason={Complete:"COMPLETE",StopSequence:"STOP_SEQUENCE",MaxTokens:"MAX_TOKENS",ToolCall:"TOOL_CALL",Error:"ERROR"};var hz={};Object.defineProperty(hz,"__esModule",{value:!0});var pz={};Object.defineProperty(pz,"__esModule",{value:!0});var _z={};Object.defineProperty(_z,"__esModule",{value:!0});var yz={};Object.defineProperty(yz,"__esModule",{value:!0});var bz={};Object.defineProperty(bz,"__esModule",{value:!0});var gz={};Object.defineProperty(gz,"__esModule",{value:!0});var mz={};Object.defineProperty(mz,"__esModule",{value:!0});var vz={};Object.defineProperty(vz,"__esModule",{value:!0});var wz={};Object.defineProperty(wz,"__esModule",{value:!0});var Oz={};Object.defineProperty(Oz,"__esModule",{value:!0});var Sz={};Object.defineProperty(Sz,"__esModule",{value:!0});var Ez={};Object.defineProperty(Ez,"__esModule",{value:!0});var Pz={};Object.defineProperty(Pz,"__esModule",{value:!0});var jz={};Object.defineProperty(jz,"__esModule",{value:!0});var Cz={};Object.defineProperty(Cz,"__esModule",{value:!0});var Mz={};Object.defineProperty(Mz,"__esModule",{value:!0});var Tz={};Object.defineProperty(Tz,"__esModule",{value:!0});var Rz={};Object.defineProperty(Rz,"__esModule",{value:!0});var Az={};Object.defineProperty(Az,"__esModule",{value:!0});var $z={};Object.defineProperty($z,"__esModule",{value:!0});var Iz={};Object.defineProperty(Iz,"__esModule",{value:!0});var xz={};Object.defineProperty(xz,"__esModule",{value:!0});var Dz={};Object.defineProperty(Dz,"__esModule",{value:!0});var Nz={};Object.defineProperty(Nz,"__esModule",{value:!0});var zz={};Object.defineProperty(zz,"__esModule",{value:!0});var Bz={};Object.defineProperty(Bz,"__esModule",{value:!0});var Uz={};Object.defineProperty(Uz,"__esModule",{value:!0});var Fz={};Object.defineProperty(Fz,"__esModule",{value:!0});var Lz={};Object.defineProperty(Lz,"__esModule",{value:!0});var Vz={};Object.defineProperty(Vz,"__esModule",{value:!0});var kz={};Object.defineProperty(kz,"__esModule",{value:!0});var Hz={};Object.defineProperty(Hz,"__esModule",{value:!0});var qz={};Object.defineProperty(qz,"__esModule",{value:!0});var Gz={};Object.defineProperty(Gz,"__esModule",{value:!0});var Wz={};Object.defineProperty(Wz,"__esModule",{value:!0});var Kz={};Object.defineProperty(Kz,"__esModule",{value:!0});var Jz={};Object.defineProperty(Jz,"__esModule",{value:!0});var Xz={};Object.defineProperty(Xz,"__esModule",{value:!0});var Zz={};Object.defineProperty(Zz,"__esModule",{value:!0});var Yz={};Object.defineProperty(Yz,"__esModule",{value:!0});var Qz={};Object.defineProperty(Qz,"__esModule",{value:!0});var eB={};Object.defineProperty(eB,"__esModule",{value:!0});var tB={};Object.defineProperty(tB,"__esModule",{value:!0});var rB={};Object.defineProperty(rB,"__esModule",{value:!0});var nB={};Object.defineProperty(nB,"__esModule",{value:!0});var iB={};Object.defineProperty(iB,"__esModule",{value:!0});var aB={};Object.defineProperty(aB,"__esModule",{value:!0});var oB={};Object.defineProperty(oB,"__esModule",{value:!0});var sB={};Object.defineProperty(sB,"__esModule",{value:!0});var Yb={};Object.defineProperty(Yb,"__esModule",{value:!0});Yb.EmbedInputType=void 0;Yb.EmbedInputType={SearchDocument:"search_document",SearchQuery:"search_query",Classification:"classification",Clustering:"clustering",Image:"image"};var Qb={};Object.defineProperty(Qb,"__esModule",{value:!0});Qb.EmbeddingType=void 0;Qb.EmbeddingType={Float:"float",Int8:"int8",Uint8:"uint8",Binary:"binary",Ubinary:"ubinary"};var uB={};Object.defineProperty(uB,"__esModule",{value:!0});var lB={};Object.defineProperty(lB,"__esModule",{value:!0});var cB={};Object.defineProperty(cB,"__esModule",{value:!0});var dB={};Object.defineProperty(dB,"__esModule",{value:!0});var eg={};Object.defineProperty(eg,"__esModule",{value:!0});eg.EmbedJobStatus=void 0;eg.EmbedJobStatus={Processing:"processing",Complete:"complete",Cancelling:"cancelling",Cancelled:"cancelled",Failed:"failed"};var tg={};Object.defineProperty(tg,"__esModule",{value:!0});tg.EmbedJobTruncate=void 0;tg.EmbedJobTruncate={Start:"START",End:"END"};var fB={};Object.defineProperty(fB,"__esModule",{value:!0});var hB={};Object.defineProperty(hB,"__esModule",{value:!0});var pB={};Object.defineProperty(pB,"__esModule",{value:!0});var _B={};Object.defineProperty(_B,"__esModule",{value:!0});var yB={};Object.defineProperty(yB,"__esModule",{value:!0});var rg={};Object.defineProperty(rg,"__esModule",{value:!0});rg.DatasetValidationStatus=void 0;rg.DatasetValidationStatus={Unknown:"unknown",Queued:"queued",Processing:"processing",Failed:"failed",Validated:"validated",Skipped:"skipped"};var ng={};Object.defineProperty(ng,"__esModule",{value:!0});ng.DatasetType=void 0;ng.DatasetType={EmbedInput:"embed-input",EmbedResult:"embed-result",ClusterResult:"cluster-result",ClusterOutliers:"cluster-outliers",RerankerFinetuneInput:"reranker-finetune-input",SingleLabelClassificationFinetuneInput:"single-label-classification-finetune-input",ChatFinetuneInput:"chat-finetune-input",MultiLabelClassificationFinetuneInput:"multi-label-classification-finetune-input"};var bB={};Object.defineProperty(bB,"__esModule",{value:!0});var gB={};Object.defineProperty(gB,"__esModule",{value:!0});var mB={};Object.defineProperty(mB,"__esModule",{value:!0});var vB={};Object.defineProperty(vB,"__esModule",{value:!0});var wB={};Object.defineProperty(wB,"__esModule",{value:!0});var OB={};Object.defineProperty(OB,"__esModule",{value:!0});var SB={};Object.defineProperty(SB,"__esModule",{value:!0});var EB={};Object.defineProperty(EB,"__esModule",{value:!0});var PB={};Object.defineProperty(PB,"__esModule",{value:!0});var jB={};Object.defineProperty(jB,"__esModule",{value:!0});var CB={};Object.defineProperty(CB,"__esModule",{value:!0});var MB={};Object.defineProperty(MB,"__esModule",{value:!0});var ig={};Object.defineProperty(ig,"__esModule",{value:!0});ig.ConnectorAuthStatus=void 0;ig.ConnectorAuthStatus={Valid:"valid",Expired:"expired"};var TB={};Object.defineProperty(TB,"__esModule",{value:!0});var RB={};Object.defineProperty(RB,"__esModule",{value:!0});var AB={};Object.defineProperty(AB,"__esModule",{value:!0});var ag={};Object.defineProperty(ag,"__esModule",{value:!0});ag.AuthTokenType=void 0;ag.AuthTokenType={Bearer:"bearer",Basic:"basic",Noscheme:"noscheme"};var $B={};Object.defineProperty($B,"__esModule",{value:!0});var IB={};Object.defineProperty(IB,"__esModule",{value:!0});var xB={};Object.defineProperty(xB,"__esModule",{value:!0});var DB={};Object.defineProperty(DB,"__esModule",{value:!0});var NB={};Object.defineProperty(NB,"__esModule",{value:!0});var zB={};Object.defineProperty(zB,"__esModule",{value:!0});var og={};Object.defineProperty(og,"__esModule",{value:!0});og.CompatibleEndpoint=void 0;og.CompatibleEndpoint={Chat:"chat",Embed:"embed",Classify:"classify",Summarize:"summarize",Rerank:"rerank",Rate:"rate",Generate:"generate"};var BB={};Object.defineProperty(BB,"__esModule",{value:!0});var UB={};Object.defineProperty(UB,"__esModule",{value:!0});(function(t){var e=u&&u.__createBinding||(Object.create?function(n,i,a,o){o===void 0&&(o=a);var s=Object.getOwnPropertyDescriptor(i,a);(!s||("get"in s?!i.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return i[a]}}),Object.defineProperty(n,o,s)}:function(n,i,a,o){o===void 0&&(o=a),n[o]=i[a]}),r=u&&u.__exportStar||function(n,i){for(var a in n)a!=="default"&&!Object.prototype.hasOwnProperty.call(i,a)&&e(i,n,a)};Object.defineProperty(t,"__esModule",{value:!0}),r(Rb,t),r(Ab,t),r(kD,t),r($b,t),r(Ib,t),r(xb,t),r(HD,t),r(Db,t),r(Nb,t),r(zb,t),r(Bb,t),r(Ub,t),r(Fb,t),r(qD,t),r(GD,t),r(WD,t),r(KD,t),r(JD,t),r(Lb,t),r(XD,t),r(Vb,t),r(ZD,t),r(YD,t),r(kb,t),r(Hb,t),r(qb,t),r(QD,t),r(eN,t),r(tN,t),r(rN,t),r(nN,t),r(iN,t),r(aN,t),r(oN,t),r(sN,t),r(uN,t),r(lN,t),r(cN,t),r(dN,t),r(fN,t),r(hN,t),r(pN,t),r(Gb,t),r(_N,t),r(yN,t),r(bN,t),r(gN,t),r(Wb,t),r(mN,t),r(vN,t),r(wN,t),r(ON,t),r(SN,t),r(EN,t),r(PN,t),r(jN,t),r(CN,t),r(MN,t),r(TN,t),r(RN,t),r(Kb,t),r(AN,t),r($N,t),r(IN,t),r(xN,t),r(DN,t),r(NN,t),r(zN,t),r(BN,t),r(UN,t),r(FN,t),r(LN,t),r(VN,t),r(kN,t),r(HN,t),r(qN,t),r(GN,t),r(Jb,t),r(WN,t),r(KN,t),r(JN,t),r(XN,t),r(ZN,t),r(YN,t),r(QN,t),r(ez,t),r(tz,t),r(rz,t),r(nz,t),r(iz,t),r(az,t),r(oz,t),r(sz,t),r(uz,t),r(Xb,t),r(lz,t),r(cz,t),r(dz,t),r(fz,t),r(Zb,t),r(hz,t),r(pz,t),r(_z,t),r(yz,t),r(bz,t),r(gz,t),r(mz,t),r(vz,t),r(wz,t),r(Oz,t),r(Sz,t),r(Ez,t),r(Pz,t),r(jz,t),r(Cz,t),r(Mz,t),r(Tz,t),r(Rz,t),r(Az,t),r($z,t),r(Iz,t),r(xz,t),r(Dz,t),r(Nz,t),r(zz,t),r(Bz,t),r(Uz,t),r(Fz,t),r(Lz,t),r(Vz,t),r(kz,t),r(Hz,t),r(qz,t),r(Gz,t),r(Wz,t),r(Kz,t),r(Jz,t),r(Xz,t),r(Zz,t),r(Yz,t),r(Qz,t),r(eB,t),r(tB,t),r(rB,t),r(nB,t),r(iB,t),r(aB,t),r(oB,t),r(sB,t),r(Yb,t),r(Qb,t),r(uB,t),r(lB,t),r(cB,t),r(dB,t),r(eg,t),r(tg,t),r(fB,t),r(hB,t),r(pB,t),r(_B,t),r(yB,t),r(rg,t),r(ng,t),r(bB,t),r(gB,t),r(mB,t),r(vB,t),r(wB,t),r(OB,t),r(SB,t),r(EB,t),r(PB,t),r(jB,t),r(CB,t),r(MB,t),r(ig,t),r(TB,t),r(RB,t),r(AB,t),r(ag,t),r($B,t),r(IB,t),r(xB,t),r(DB,t),r(NB,t),r(zB,t),r(og,t),r(BB,t),r(UB,t)})(VD);var FB={},sg={},Rt={},ug={};Object.defineProperty(ug,"__esModule",{value:!0});ug.CohereError=void 0;class pP extends Error{constructor({message:e,statusCode:r,body:n}){super(XG({message:e,statusCode:r,body:n})),Object.setPrototypeOf(this,pP.prototype),r!=null&&(this.statusCode=r),n!==void 0&&(this.body=n)}}ug.CohereError=pP;function XG({message:t,statusCode:e,body:r}){let n=[];return t!=null&&n.push(t),e!=null&&n.push(`Status code: ${e.toString()}`),r!=null&&n.push(`Body: ${JSON.stringify(r,void 0,2)}`),n.join(`
`)}var lg={};Object.defineProperty(lg,"__esModule",{value:!0});lg.CohereTimeoutError=void 0;class _P extends Error{constructor(e){super(e),Object.setPrototypeOf(this,_P.prototype)}}lg.CohereTimeoutError=_P;(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.CohereTimeoutError=t.CohereError=void 0;var e=ug;Object.defineProperty(t,"CohereError",{enumerable:!0,get:function(){return e.CohereError}});var r=lg;Object.defineProperty(t,"CohereTimeoutError",{enumerable:!0,get:function(){return r.CohereTimeoutError}})})(Rt);var ZG=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),YG=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),QG=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&ZG(e,t,r);return YG(e,t),e};Object.defineProperty(sg,"__esModule",{value:!0});sg.BadRequestError=void 0;const e9=QG(Rt);let t9=class LB extends e9.CohereError{constructor(e){super({message:"BadRequestError",statusCode:400,body:e}),Object.setPrototypeOf(this,LB.prototype)}};sg.BadRequestError=t9;var cg={},r9=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),n9=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i9=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&r9(e,t,r);return n9(e,t),e};Object.defineProperty(cg,"__esModule",{value:!0});cg.UnauthorizedError=void 0;const a9=i9(Rt);class yP extends a9.CohereError{constructor(e){super({message:"UnauthorizedError",statusCode:401,body:e}),Object.setPrototypeOf(this,yP.prototype)}}cg.UnauthorizedError=yP;var dg={},o9=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),s9=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),u9=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&o9(e,t,r);return s9(e,t),e};Object.defineProperty(dg,"__esModule",{value:!0});dg.ForbiddenError=void 0;const l9=u9(Rt);class bP extends l9.CohereError{constructor(e){super({message:"ForbiddenError",statusCode:403,body:e}),Object.setPrototypeOf(this,bP.prototype)}}dg.ForbiddenError=bP;var fg={},c9=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),d9=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),f9=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&c9(e,t,r);return d9(e,t),e};Object.defineProperty(fg,"__esModule",{value:!0});fg.NotFoundError=void 0;const h9=f9(Rt);let p9=class VB extends h9.CohereError{constructor(e){super({message:"NotFoundError",statusCode:404,body:e}),Object.setPrototypeOf(this,VB.prototype)}};fg.NotFoundError=p9;var hg={},_9=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),y9=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),b9=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&_9(e,t,r);return y9(e,t),e};Object.defineProperty(hg,"__esModule",{value:!0});hg.UnprocessableEntityError=void 0;const g9=b9(Rt);let m9=class kB extends g9.CohereError{constructor(e){super({message:"UnprocessableEntityError",statusCode:422,body:e}),Object.setPrototypeOf(this,kB.prototype)}};hg.UnprocessableEntityError=m9;var pg={},v9=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),w9=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),O9=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&v9(e,t,r);return w9(e,t),e};Object.defineProperty(pg,"__esModule",{value:!0});pg.TooManyRequestsError=void 0;const S9=O9(Rt);class gP extends S9.CohereError{constructor(e){super({message:"TooManyRequestsError",statusCode:429,body:e}),Object.setPrototypeOf(this,gP.prototype)}}pg.TooManyRequestsError=gP;var _g={},E9=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),P9=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),j9=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&E9(e,t,r);return P9(e,t),e};Object.defineProperty(_g,"__esModule",{value:!0});_g.InvalidTokenError=void 0;const C9=j9(Rt);class mP extends C9.CohereError{constructor(e){super({message:"InvalidTokenError",statusCode:498,body:e}),Object.setPrototypeOf(this,mP.prototype)}}_g.InvalidTokenError=mP;var yg={},M9=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),T9=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),R9=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&M9(e,t,r);return T9(e,t),e};Object.defineProperty(yg,"__esModule",{value:!0});yg.ClientClosedRequestError=void 0;const A9=R9(Rt);class vP extends A9.CohereError{constructor(e){super({message:"ClientClosedRequestError",statusCode:499,body:e}),Object.setPrototypeOf(this,vP.prototype)}}yg.ClientClosedRequestError=vP;var bg={},$9=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),I9=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),x9=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&$9(e,t,r);return I9(e,t),e};Object.defineProperty(bg,"__esModule",{value:!0});bg.InternalServerError=void 0;const D9=x9(Rt);let N9=class HB extends D9.CohereError{constructor(e){super({message:"InternalServerError",statusCode:500,body:e}),Object.setPrototypeOf(this,HB.prototype)}};bg.InternalServerError=N9;var gg={},z9=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),B9=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),U9=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&z9(e,t,r);return B9(e,t),e};Object.defineProperty(gg,"__esModule",{value:!0});gg.NotImplementedError=void 0;const F9=U9(Rt);class wP extends F9.CohereError{constructor(e){super({message:"NotImplementedError",statusCode:501,body:e}),Object.setPrototypeOf(this,wP.prototype)}}gg.NotImplementedError=wP;var mg={},L9=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),V9=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),k9=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&L9(e,t,r);return V9(e,t),e};Object.defineProperty(mg,"__esModule",{value:!0});mg.ServiceUnavailableError=void 0;const H9=k9(Rt);class OP extends H9.CohereError{constructor(e){super({message:"ServiceUnavailableError",statusCode:503,body:e}),Object.setPrototypeOf(this,OP.prototype)}}mg.ServiceUnavailableError=OP;var vg={},q9=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),G9=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),W9=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&q9(e,t,r);return G9(e,t),e};Object.defineProperty(vg,"__esModule",{value:!0});vg.GatewayTimeoutError=void 0;const K9=W9(Rt);class SP extends K9.CohereError{constructor(e){super({message:"GatewayTimeoutError",statusCode:504,body:e}),Object.setPrototypeOf(this,SP.prototype)}}vg.GatewayTimeoutError=SP;(function(t){var e=u&&u.__createBinding||(Object.create?function(n,i,a,o){o===void 0&&(o=a);var s=Object.getOwnPropertyDescriptor(i,a);(!s||("get"in s?!i.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return i[a]}}),Object.defineProperty(n,o,s)}:function(n,i,a,o){o===void 0&&(o=a),n[o]=i[a]}),r=u&&u.__exportStar||function(n,i){for(var a in n)a!=="default"&&!Object.prototype.hasOwnProperty.call(i,a)&&e(i,n,a)};Object.defineProperty(t,"__esModule",{value:!0}),r(sg,t),r(cg,t),r(dg,t),r(fg,t),r(hg,t),r(pg,t),r(_g,t),r(yg,t),r(bg,t),r(gg,t),r(mg,t),r(vg,t)})(FB);var qB={},GB={};Object.defineProperty(GB,"__esModule",{value:!0});(function(t){var e=u&&u.__createBinding||(Object.create?function(n,i,a,o){o===void 0&&(o=a);var s=Object.getOwnPropertyDescriptor(i,a);(!s||("get"in s?!i.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return i[a]}}),Object.defineProperty(n,o,s)}:function(n,i,a,o){o===void 0&&(o=a),n[o]=i[a]}),r=u&&u.__exportStar||function(n,i){for(var a in n)a!=="default"&&!Object.prototype.hasOwnProperty.call(i,a)&&e(i,n,a)};Object.defineProperty(t,"__esModule",{value:!0}),r(GB,t)})(qB);(function(t){var e=u&&u.__createBinding||(Object.create?function(n,i,a,o){o===void 0&&(o=a);var s=Object.getOwnPropertyDescriptor(i,a);(!s||("get"in s?!i.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return i[a]}}),Object.defineProperty(n,o,s)}:function(n,i,a,o){o===void 0&&(o=a),n[o]=i[a]}),r=u&&u.__exportStar||function(n,i){for(var a in n)a!=="default"&&!Object.prototype.hasOwnProperty.call(i,a)&&e(i,n,a)};Object.defineProperty(t,"__esModule",{value:!0}),r(nD,t),r(VD,t),r(FB,t),r(qB,t)})(Vi);var wg={},EP={};function J9(t,e,r,n){function i(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function s(d){try{c(n.next(d))}catch(f){o(f)}}function l(d){try{c(n.throw(d))}catch(f){o(f)}}function c(d){d.done?a(d.value):i(d.value).then(s,l)}c((n=n.apply(t,e||[])).next())})}function X9(t,e){var r={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,i,a,o=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return o.next=s(0),o.throw=s(1),o.return=s(2),typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(c){return function(d){return l([c,d])}}function l(c){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,c[0]&&(r=0)),r;)try{if(n=1,i&&(a=c[0]&2?i.return:c[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,c[1])).done)return a;switch(i=0,a&&(c=[c[0]&2,a.value]),c[0]){case 0:case 1:a=c;break;case 4:return r.label++,{value:c[1],done:!1};case 5:r.label++,i=c[1],c=[0];continue;case 7:c=r.ops.pop(),r.trys.pop();continue;default:if(a=r.trys,!(a=a.length>0&&a[a.length-1])&&(c[0]===6||c[0]===2)){r=0;continue}if(c[0]===3&&(!a||c[1]>a[0]&&c[1]<a[3])){r.label=c[1];break}if(c[0]===6&&r.label<a[1]){r.label=a[1],a=c;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(c);break}a[2]&&r.ops.pop(),r.trys.pop();continue}c=e.call(t,r)}catch(d){c=[6,d],i=0}finally{n=a=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}var sn=64,Z9=32,Y9=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Q9=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],e5=Math.pow(2,53)-1,H_=function(){function t(){this.state=Int32Array.from(Q9),this.temp=new Int32Array(64),this.buffer=new Uint8Array(64),this.bufferLength=0,this.bytesHashed=0,this.finished=!1}return t.prototype.update=function(e){if(this.finished)throw new Error("Attempted to update an already finished hash.");var r=0,n=e.byteLength;if(this.bytesHashed+=n,this.bytesHashed*8>e5)throw new Error("Cannot hash more than 2^53 - 1 bits");for(;n>0;)this.buffer[this.bufferLength++]=e[r++],n--,this.bufferLength===sn&&(this.hashBuffer(),this.bufferLength=0)},t.prototype.digest=function(){if(!this.finished){var e=this.bytesHashed*8,r=new DataView(this.buffer.buffer,this.buffer.byteOffset,this.buffer.byteLength),n=this.bufferLength;if(r.setUint8(this.bufferLength++,128),n%sn>=sn-8){for(var i=this.bufferLength;i<sn;i++)r.setUint8(i,0);this.hashBuffer(),this.bufferLength=0}for(var i=this.bufferLength;i<sn-8;i++)r.setUint8(i,0);r.setUint32(sn-8,Math.floor(e/4294967296),!0),r.setUint32(sn-4,e),this.hashBuffer(),this.finished=!0}for(var a=new Uint8Array(Z9),i=0;i<8;i++)a[i*4]=this.state[i]>>>24&255,a[i*4+1]=this.state[i]>>>16&255,a[i*4+2]=this.state[i]>>>8&255,a[i*4+3]=this.state[i]>>>0&255;return a},t.prototype.hashBuffer=function(){for(var e=this,r=e.buffer,n=e.state,i=n[0],a=n[1],o=n[2],s=n[3],l=n[4],c=n[5],d=n[6],f=n[7],h=0;h<sn;h++){if(h<16)this.temp[h]=(r[h*4]&255)<<24|(r[h*4+1]&255)<<16|(r[h*4+2]&255)<<8|r[h*4+3]&255;else{var p=this.temp[h-2],b=(p>>>17|p<<15)^(p>>>19|p<<13)^p>>>10;p=this.temp[h-15];var g=(p>>>7|p<<25)^(p>>>18|p<<14)^p>>>3;this.temp[h]=(b+this.temp[h-7]|0)+(g+this.temp[h-16]|0)}var v=(((l>>>6|l<<26)^(l>>>11|l<<21)^(l>>>25|l<<7))+(l&c^~l&d)|0)+(f+(Y9[h]+this.temp[h]|0)|0)|0,E=((i>>>2|i<<30)^(i>>>13|i<<19)^(i>>>22|i<<10))+(i&a^i&o^a&o)|0;f=d,d=c,c=l,l=s+v|0,s=o,o=a,a=i,i=v+E|0}n[0]+=i,n[1]+=a,n[2]+=o,n[3]+=s,n[4]+=l,n[5]+=c,n[6]+=d,n[7]+=f},t}();const t5=t=>new TextEncoder().encode(t);var r5=typeof Buffer<"u"&&Buffer.from?function(t){return Buffer.from(t,"utf8")}:t5;function WB(t){return t instanceof Uint8Array?t:typeof t=="string"?r5(t):ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(t)}function n5(t){return typeof t=="string"?t.length===0:t.byteLength===0}var i5=function(){function t(e){this.secret=e,this.hash=new H_,this.reset()}return t.prototype.update=function(e){if(!(n5(e)||this.error))try{this.hash.update(WB(e))}catch(r){this.error=r}},t.prototype.digestSync=function(){if(this.error)throw this.error;return this.outer?(this.outer.finished||this.outer.update(this.hash.digest()),this.outer.digest()):this.hash.digest()},t.prototype.digest=function(){return J9(this,void 0,void 0,function(){return X9(this,function(e){return[2,this.digestSync()]})})},t.prototype.reset=function(){if(this.hash=new H_,this.secret){this.outer=new H_;var e=a5(this.secret),r=new Uint8Array(sn);r.set(e);for(var n=0;n<sn;n++)e[n]^=54,r[n]^=92;this.hash.update(e),this.outer.update(r);for(var n=0;n<e.byteLength;n++)e[n]=0}},t}();function a5(t){var e=WB(t);if(e.byteLength>sn){var r=new H_;r.update(e),e=r.digest()}var n=new Uint8Array(sn);return n.set(e),n}const o5=Object.freeze(Object.defineProperty({__proto__:null,Sha256:i5},Symbol.toStringTag,{value:"Module"})),s5=jo(o5);class PP extends Error{constructor(e,r=!0){let n,i=!0;typeof r=="boolean"?(n=void 0,i=r):r!=null&&typeof r=="object"&&(n=r.logger,i=r.tryNextLink??!0),super(e),this.name="ProviderError",this.tryNextLink=i,Object.setPrototypeOf(this,PP.prototype),n?.debug?.(`@smithy/property-provider ${i?"->":"(!)"} ${e}`)}static from(e,r=!0){return Object.assign(new this(e.message,r),e)}}class Kr extends PP{constructor(e,r=!0){super(e,r),this.name="CredentialsProviderError",Object.setPrototypeOf(this,Kr.prototype)}}function KB(t){return Promise.all(Object.keys(t).reduce((e,r)=>{const n=t[r];return typeof n=="string"?e.push([r,n]):e.push(n().then(i=>[r,i])),e},[])).then(e=>e.reduce((r,[n,i])=>(r[n]=i,r),{}))}function JB(t){return async e=>{t.logger?.debug("@aws-sdk/credential-provider-cognito-identity - fromCognitoIdentity");const{GetCredentialsForIdentityCommand:r,CognitoIdentityClient:n}=await va(async()=>{const{GetCredentialsForIdentityCommand:c,CognitoIdentityClient:d}=await import("./loadCognitoIdentity-CPSMfMXJ.js");return{GetCredentialsForIdentityCommand:c,CognitoIdentityClient:d}},__vite__mapDeps([0,1])),i=c=>t.clientConfig?.[c]??t.parentClientConfig?.[c]??e?.callerClientConfig?.[c],{Credentials:{AccessKeyId:a=u5(t.logger),Expiration:o,SecretKey:s=c5(t.logger),SessionToken:l}=l5(t.logger)}=await(t.client??new n(Object.assign({},t.clientConfig??{},{region:i("region"),profile:i("profile")}))).send(new r({CustomRoleArn:t.customRoleArn,IdentityId:t.identityId,Logins:t.logins?await KB(t.logins):void 0}));return{identityId:t.identityId,accessKeyId:a,secretAccessKey:s,sessionToken:l,expiration:o}}}function u5(t){throw new Kr("Response from Amazon Cognito contained no access key ID",{logger:t})}function l5(t){throw new Kr("Response from Amazon Cognito contained no credentials",{logger:t})}function c5(t){throw new Kr("Response from Amazon Cognito contained no secret key",{logger:t})}const zw="IdentityIds";class d5{dbName;constructor(e="aws:cognito-identity-ids"){this.dbName=e}getItem(e){return this.withObjectStore("readonly",r=>{const n=r.get(e);return new Promise(i=>{n.onerror=()=>i(null),n.onsuccess=()=>i(n.result?n.result.value:null)})}).catch(()=>null)}removeItem(e){return this.withObjectStore("readwrite",r=>{const n=r.delete(e);return new Promise((i,a)=>{n.onerror=()=>a(n.error),n.onsuccess=()=>i()})})}setItem(e,r){return this.withObjectStore("readwrite",n=>{const i=n.put({id:e,value:r});return new Promise((a,o)=>{i.onerror=()=>o(i.error),i.onsuccess=()=>a()})})}getDb(){const e=self.indexedDB.open(this.dbName,1);return new Promise((r,n)=>{e.onsuccess=()=>{r(e.result)},e.onerror=()=>{n(e.error)},e.onblocked=()=>{n(new Error("Unable to access DB"))},e.onupgradeneeded=()=>{const i=e.result;i.onerror=()=>{n(new Error("Failed to create object store"))},i.createObjectStore(zw,{keyPath:"id"})}})}withObjectStore(e,r){return this.getDb().then(n=>{const i=n.transaction(zw,e);return i.oncomplete=()=>n.close(),new Promise((a,o)=>{i.onerror=()=>o(i.error),a(r(i.objectStore(zw)))}).catch(a=>{throw n.close(),a})})}}class f5{store;constructor(e={}){this.store=e}getItem(e){return e in this.store?this.store[e]:null}removeItem(e){delete this.store[e]}setItem(e,r){this.store[e]=r}}const h5=new f5;function p5(){return typeof self=="object"&&self.indexedDB?new d5:typeof window=="object"&&window.localStorage?window.localStorage:h5}function _5({accountId:t,cache:e=p5(),client:r,clientConfig:n,customRoleArn:i,identityPoolId:a,logins:o,userIdentifier:s=!o||Object.keys(o).length===0?"ANONYMOUS":void 0,logger:l,parentClientConfig:c}){l?.debug("@aws-sdk/credential-provider-cognito-identity - fromCognitoIdentity");const d=s?`aws:cognito-identity-credentials:${a}:${s}`:void 0;let f=async h=>{const{GetIdCommand:p,CognitoIdentityClient:b}=await va(async()=>{const{GetIdCommand:C,CognitoIdentityClient:S}=await import("./loadCognitoIdentity-CPSMfMXJ.js");return{GetIdCommand:C,CognitoIdentityClient:S}},__vite__mapDeps([0,1])),g=C=>n?.[C]??c?.[C]??h?.callerClientConfig?.[C],v=r??new b(Object.assign({},n??{},{region:g("region"),profile:g("profile")}));let E=d&&await e.getItem(d);if(!E){const{IdentityId:C=y5(l)}=await v.send(new p({AccountId:t,IdentityPoolId:a,Logins:o?await KB(o):void 0}));E=C,d&&Promise.resolve(e.setItem(d,E)).catch(()=>{})}return f=JB({client:v,customRoleArn:i,logins:o,identityId:E}),f(h)};return h=>f(h).catch(async p=>{throw d&&Promise.resolve(e.removeItem(d)).catch(()=>{}),p})}function y5(t){throw new Kr("Response from Amazon Cognito contained no identity ID",{logger:t})}const b5=t=>JB({...t}),g5=t=>_5({...t});var zM;(function(t){t.HEADER="header",t.QUERY="query"})(zM||(zM={}));var BM;(function(t){t.HEADER="header",t.QUERY="query"})(BM||(BM={}));var UM;(function(t){t.HTTP="http",t.HTTPS="https"})(UM||(UM={}));var FM;(function(t){t.MD5="md5",t.CRC32="crc32",t.CRC32C="crc32c",t.SHA1="sha1",t.SHA256="sha256"})(FM||(FM={}));var LM;(function(t){t[t.HEADER=0]="HEADER",t[t.TRAILER=1]="TRAILER"})(LM||(LM={}));var VM;(function(t){t.PROFILE="profile",t.SSO_SESSION="sso-session",t.SERVICES="services"})(VM||(VM={}));var kM;(function(t){t.HTTP_0_9="http/0.9",t.HTTP_1_0="http/1.0",t.TDS_8_0="tds/8.0"})(kM||(kM={}));let HM=class{constructor(e){this.statusCode=e.statusCode,this.reason=e.reason,this.headers=e.headers||{},this.body=e.body}static isInstance(e){if(!e)return!1;const r=e;return typeof r.statusCode=="number"&&typeof r.headers=="object"}};const Bw=t=>encodeURIComponent(t).replace(/[!'()*]/g,m5),m5=t=>`%${t.charCodeAt(0).toString(16).toUpperCase()}`;function v5(t){const e=[];for(let r of Object.keys(t).sort()){const n=t[r];if(r=Bw(r),Array.isArray(n))for(let i=0,a=n.length;i<a;i++)e.push(`${r}=${Bw(n[i])}`);else{let i=r;(n||typeof n=="string")&&(i+=`=${Bw(n)}`),e.push(i)}}return e.join("&")}function qM(t,e){return new Request(t,e)}function w5(t=0){return new Promise((e,r)=>{t&&setTimeout(()=>{const n=new Error(`Request did not complete within ${t} ms`);n.name="TimeoutError",r(n)},t)})}const Uw={supported:void 0};class jP{static create(e){return typeof e?.handle=="function"?e:new jP(e)}constructor(e){typeof e=="function"?this.configProvider=e().then(r=>r||{}):(this.config=e??{},this.configProvider=Promise.resolve(this.config)),Uw.supported===void 0&&(Uw.supported=typeof Request<"u"&&"keepalive"in qM("https://[::1]"))}destroy(){}async handle(e,{abortSignal:r}={}){this.config||(this.config=await this.configProvider);const n=this.config.requestTimeout,i=this.config.keepAlive===!0,a=this.config.credentials;if(r?.aborted){const E=new Error("Request aborted");return E.name="AbortError",Promise.reject(E)}let o=e.path;const s=v5(e.query||{});s&&(o+=`?${s}`),e.fragment&&(o+=`#${e.fragment}`);let l="";if(e.username!=null||e.password!=null){const E=e.username??"",C=e.password??"";l=`${E}:${C}@`}const{port:c,method:d}=e,f=`${e.protocol}//${l}${e.hostname}${c?`:${c}`:""}${o}`,h=d==="GET"||d==="HEAD"?void 0:e.body,p={body:h,headers:new Headers(e.headers),method:d,credentials:a};this.config?.cache&&(p.cache=this.config.cache),h&&(p.duplex="half"),typeof AbortController<"u"&&(p.signal=r),Uw.supported&&(p.keepalive=i),typeof this.config.requestInit=="function"&&Object.assign(p,this.config.requestInit(e));let b=()=>{};const g=qM(f,p),v=[fetch(g).then(E=>{const C=E.headers,S={};for(const D of C.entries())S[D[0]]=D[1];return E.body!=null?{response:new HM({headers:S,reason:E.statusText,statusCode:E.status,body:E.body})}:E.blob().then(D=>({response:new HM({headers:S,reason:E.statusText,statusCode:E.status,body:D})}))}),w5(n)];return r&&v.push(new Promise((E,C)=>{const S=()=>{const N=new Error("Request aborted");N.name="AbortError",C(N)};if(typeof r.addEventListener=="function"){const N=r;N.addEventListener("abort",S,{once:!0}),b=()=>N.removeEventListener("abort",S)}else r.onabort=S})),Promise.race(v).finally(b)}updateHttpClientConfig(e,r){this.config=void 0,this.configProvider=this.configProvider.then(n=>(n[e]=r,n))}httpHandlerConfigs(){return this.config??{}}}const Aa={},Bu=new Array(64);for(let t=0,e=65,r=90;t+e<=r;t++){const n=String.fromCharCode(t+e);Aa[n]=t,Bu[t]=n}for(let t=0,e=97,r=122;t+e<=r;t++){const n=String.fromCharCode(t+e),i=t+26;Aa[n]=i,Bu[i]=n}for(let t=0;t<10;t++){Aa[t.toString(10)]=t+52;const e=t.toString(10),r=t+52;Aa[e]=r,Bu[r]=e}Aa["+"]=62;Bu[62]="+";Aa["/"]=63;Bu[63]="/";const qs=6,yc=8,O5=63,S5=t=>{let e=t.length/4*3;t.slice(-2)==="=="?e-=2:t.slice(-1)==="="&&e--;const r=new ArrayBuffer(e),n=new DataView(r);for(let i=0;i<t.length;i+=4){let a=0,o=0;for(let c=i,d=i+3;c<=d;c++)if(t[c]!=="="){if(!(t[c]in Aa))throw new TypeError(`Invalid character ${t[c]} in base64 string.`);a|=Aa[t[c]]<<(d-c)*qs,o+=qs}else a>>=qs;const s=i/4*3;a>>=o%yc;const l=Math.floor(o/yc);for(let c=0;c<l;c++){const d=(l-c-1)*yc;n.setUint8(s+c,(a&255<<d)>>d)}}return new Uint8Array(r)},E5=t=>new TextEncoder().encode(t);function P5(t){let e;typeof t=="string"?e=E5(t):e=t;const r=typeof e=="object"&&typeof e.length=="number",n=typeof e=="object"&&typeof e.byteOffset=="number"&&typeof e.byteLength=="number";if(!r&&!n)throw new Error("@smithy/util-base64: toBase64 encoder function only accepts string | Uint8Array.");let i="";for(let a=0;a<e.length;a+=3){let o=0,s=0;for(let c=a,d=Math.min(a+3,e.length);c<d;c++)o|=e[c]<<(d-c-1)*yc,s+=yc;const l=Math.ceil(s/qs);o<<=l*qs-s;for(let c=1;c<=l;c++){const d=(l-c)*qs;i+=Bu[(o&O5<<d)>>d]}i+="==".slice(0,4-l)}return i}const j5=async t=>typeof Blob=="function"&&t instanceof Blob||t.constructor?.name==="Blob"?Blob.prototype.arrayBuffer!==void 0?new Uint8Array(await t.arrayBuffer()):C5(t):M5(t);async function C5(t){const e=await T5(t),r=S5(e);return new Uint8Array(r)}async function M5(t){const e=[],r=t.getReader();let n=!1,i=0;for(;!n;){const{done:s,value:l}=await r.read();l&&(e.push(l),i+=l.length),n=s}const a=new Uint8Array(i);let o=0;for(const s of e)a.set(s,o),o+=s.length;return a}function T5(t){return new Promise((e,r)=>{const n=new FileReader;n.onloadend=()=>{if(n.readyState!==2)return r(new Error("Reader aborted too early"));const i=n.result??"",a=i.indexOf(","),o=a>-1?a+1:i.length;e(i.substring(o))},n.onabort=()=>r(new Error("Read aborted")),n.onerror=()=>r(n.error),n.readAsDataURL(t)})}const R5="169.254.170.2",A5="169.254.170.23",$5="[fd00:ec2::23]",I5=(t,e)=>{if(t.protocol!=="https:"&&!(t.hostname===R5||t.hostname===A5||t.hostname===$5)){if(t.hostname.includes("[")){if(t.hostname==="[::1]"||t.hostname==="[0000:0000:0000:0000:0000:0000:0000:0001]")return}else{if(t.hostname==="localhost")return;const r=t.hostname.split("."),n=i=>{const a=parseInt(i,10);return 0<=a&&a<=255};if(r[0]==="127"&&n(r[1])&&n(r[2])&&n(r[3])&&r.length===4)return}throw new Kr(`URL not accepted. It must either be HTTPS or match one of the following:
  - loopback CIDR 127.0.0.0/8 or [::1/128]
  - ECS container host 169.254.170.2
  - EKS container host 169.254.170.23 or [fd00:ec2::23]`,{logger:e})}};let x5=class oS{constructor(e){this.method=e.method||"GET",this.hostname=e.hostname||"localhost",this.port=e.port,this.query=e.query||{},this.headers=e.headers||{},this.body=e.body,this.protocol=e.protocol?e.protocol.slice(-1)!==":"?`${e.protocol}:`:e.protocol:"https:",this.path=e.path?e.path.charAt(0)!=="/"?`/${e.path}`:e.path:"/",this.username=e.username,this.password=e.password,this.fragment=e.fragment}static clone(e){const r=new oS({...e,headers:{...e.headers}});return r.query&&(r.query=D5(r.query)),r}static isInstance(e){if(!e)return!1;const r=e;return"method"in r&&"protocol"in r&&"hostname"in r&&"path"in r&&typeof r.query=="object"&&typeof r.headers=="object"}clone(){return oS.clone(this)}};function D5(t){return Object.keys(t).reduce((e,r)=>{const n=t[r];return{...e,[r]:Array.isArray(n)?[...n]:n}},{})}const N5=t=>{if(typeof t=="string")return t;if(typeof t!="object"||typeof t.byteOffset!="number"||typeof t.byteLength!="number")throw new Error("@smithy/util-utf8: toUtf8 encoder function only accepts string | Uint8Array.");return new TextDecoder("utf-8").decode(t)},GM=t=>typeof ReadableStream=="function"&&(t?.constructor?.name===ReadableStream.name||t instanceof ReadableStream),XB={},sS={};for(let t=0;t<256;t++){let e=t.toString(16).toLowerCase();e.length===1&&(e=`0${e}`),XB[t]=e,sS[e]=t}function lje(t){if(t.length%2!==0)throw new Error("Hex encoded strings must have an even number length");const e=new Uint8Array(t.length/2);for(let r=0;r<t.length;r+=2){const n=t.slice(r,r+2).toLowerCase();if(n in sS)e[r/2]=sS[n];else throw new Error(`Cannot decode unrecognized sequence ${n} as hexadecimal`)}return e}function z5(t){let e="";for(let r=0;r<t.byteLength;r++)e+=XB[t[r]];return e}const WM="The stream has already been transformed.",B5=t=>{if(!KM(t)&&!GM(t)){const i=t?.__proto__?.constructor?.name||t;throw new Error(`Unexpected stream implementation, expect Blob or ReadableStream, got ${i}`)}let e=!1;const r=async()=>{if(e)throw new Error(WM);return e=!0,await j5(t)},n=i=>{if(typeof i.stream!="function")throw new Error(`Cannot transform payload Blob to web stream. Please make sure the Blob.stream() is polyfilled.
If you are using React Native, this API is not yet supported, see: https://react-native.canny.io/feature-requests/p/fetch-streaming-body`);return i.stream()};return Object.assign(t,{transformToByteArray:r,transformToString:async i=>{const a=await r();if(i==="base64")return P5(a);if(i==="hex")return z5(a);if(i===void 0||i==="utf8"||i==="utf-8")return N5(a);if(typeof TextDecoder=="function")return new TextDecoder(i).decode(a);throw new Error("TextDecoder is not available, please make sure polyfill is provided.")},transformToWebStream:()=>{if(e)throw new Error(WM);if(e=!0,KM(t))return n(t);if(GM(t))return t;throw new Error(`Cannot transform payload to web stream, got ${t}`)}})},KM=t=>typeof Blob=="function"&&t instanceof Blob,uS=t=>{if(t!=null){if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return String(e)!==String(t)&&QB.warn(YB(`Expected number but observed string: ${t}`)),e}if(typeof t=="number")return t;throw new TypeError(`Expected number, got ${typeof t}: ${t}`)}},U5=Math.ceil(2**127*(2-2**-23)),JM=t=>{const e=uS(t);if(e!==void 0&&!Number.isNaN(e)&&e!==1/0&&e!==-1/0&&Math.abs(e)>U5)throw new TypeError(`Expected 32-bit float, got ${t}`);return e},F5=t=>{if(t!=null){if(Number.isInteger(t)&&!Number.isNaN(t))return t;throw new TypeError(`Expected integer, got ${typeof t}: ${t}`)}},XM=t=>CP(t,32),ZM=t=>CP(t,16),YM=t=>CP(t,8),CP=(t,e)=>{const r=F5(t);if(r!==void 0&&L5(r,e)!==r)throw new TypeError(`Expected ${e}-bit integer, got ${t}`);return r},L5=(t,e)=>{switch(e){case 32:return Int32Array.of(t)[0];case 16:return Int16Array.of(t)[0];case 8:return Int8Array.of(t)[0]}},cje=(t,e)=>{if(t==null)throw new TypeError("Expected a non-null value");return t},dje=t=>{if(t!=null){if(typeof t=="string")return t;if(["boolean","number","bigint"].includes(typeof t))return QB.warn(YB(`Expected string, got ${typeof t}: ${t}`)),String(t);throw new TypeError(`Expected string, got ${typeof t}: ${t}`)}},V5=t=>uS(typeof t=="string"?fd(t):t),k5=t=>JM(typeof t=="string"?fd(t):t),H5=/(-?(?:0|[1-9]\d*)(?:\.\d+)?(?:[eE][+-]?\d+)?)|(-?Infinity)|(NaN)/g,fd=t=>{const e=t.match(H5);if(e===null||e[0].length!==t.length)throw new TypeError("Expected real number, got implicit NaN");return parseFloat(t)},fje=t=>XM(typeof t=="string"?fd(t):t),ZB=t=>ZM(typeof t=="string"?fd(t):t),q5=t=>YM(typeof t=="string"?fd(t):t),YB=t=>String(new TypeError(t).stack||t).split(`
`).slice(0,5).filter(e=>!e.includes("stackTraceWarning")).join(`
`),QB={warn:console.warn},G5=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],W5=new RegExp(/^(\d{4})-(\d{2})-(\d{2})[tT](\d{2}):(\d{2}):(\d{2})(?:\.(\d+))?[zZ]$/),K5=t=>{if(t==null)return;if(typeof t!="string")throw new TypeError("RFC-3339 date-times must be expressed as strings");const e=W5.exec(t);if(!e)throw new TypeError("Invalid RFC-3339 date-time value");const[r,n,i,a,o,s,l,c]=e,d=ZB(MP(n)),f=_o(i,"month",1,12),h=_o(a,"day",1,31);return eU(d,f,h,{hours:o,minutes:s,seconds:l,fractionalMilliseconds:c})},J5=new RegExp(/^(\d{4})-(\d{2})-(\d{2})[tT](\d{2}):(\d{2}):(\d{2})(?:\.(\d+))?(([-+]\d{2}\:\d{2})|[zZ])$/),hje=t=>{if(t==null)return;if(typeof t!="string")throw new TypeError("RFC-3339 date-times must be expressed as strings");const e=J5.exec(t);if(!e)throw new TypeError("Invalid RFC-3339 date-time value");const[r,n,i,a,o,s,l,c,d]=e,f=ZB(MP(n)),h=_o(i,"month",1,12),p=_o(a,"day",1,31),b=eU(f,h,p,{hours:o,minutes:s,seconds:l,fractionalMilliseconds:c});return d.toUpperCase()!="Z"&&b.setTime(b.getTime()-eW(d)),b},pje=t=>{if(t==null)return;let e;if(typeof t=="number")e=t;else if(typeof t=="string")e=V5(t);else if(typeof t=="object"&&t.tag===1)e=t.value;else throw new TypeError("Epoch timestamps must be expressed as floating point numbers or their string representation");if(Number.isNaN(e)||e===1/0||e===-1/0)throw new TypeError("Epoch timestamps must be valid, non-Infinite, non-NaN numerics");return new Date(Math.round(e*1e3))},eU=(t,e,r,n)=>{const i=e-1;return Z5(t,i,r),new Date(Date.UTC(t,i,r,_o(n.hours,"hour",0,23),_o(n.minutes,"minute",0,59),_o(n.seconds,"seconds",0,60),Q5(n.fractionalMilliseconds)))},X5=[31,28,31,30,31,30,31,31,30,31,30,31],Z5=(t,e,r)=>{let n=X5[e];if(e===1&&Y5(t)&&(n=29),r>n)throw new TypeError(`Invalid day for ${G5[e]} in ${t}: ${r}`)},Y5=t=>t%4===0&&(t%100!==0||t%400===0),_o=(t,e,r,n)=>{const i=q5(MP(t));if(i<r||i>n)throw new TypeError(`${e} must be between ${r} and ${n}, inclusive`);return i},Q5=t=>t==null?0:k5("0."+t)*1e3,eW=t=>{const e=t[0];let r=1;if(e=="+")r=1;else if(e=="-")r=-1;else throw new TypeError(`Offset direction, ${e}, must be "+" or "-"`);const n=Number(t.substring(1,3)),i=Number(t.substring(4,6));return r*(n*60+i)*60*1e3},MP=t=>{let e=0;for(;e<t.length-1&&t.charAt(e)==="0";)e++;return e===0?t:t.slice(e)};function tW(t){return new x5({protocol:t.protocol,hostname:t.hostname,port:Number(t.port),path:t.pathname,query:Array.from(t.searchParams.entries()).reduce((e,[r,n])=>(e[r]=n,e),{}),fragment:t.hash})}async function rW(t,e){const n=await B5(t.body).transformToString();if(t.statusCode===200){const i=JSON.parse(n);if(typeof i.AccessKeyId!="string"||typeof i.SecretAccessKey!="string"||typeof i.Token!="string"||typeof i.Expiration!="string")throw new Kr("HTTP credential provider response not of the required format, an object matching: { AccessKeyId: string, SecretAccessKey: string, Token: string, Expiration: string(rfc3339) }",{logger:e});return{accessKeyId:i.AccessKeyId,secretAccessKey:i.SecretAccessKey,sessionToken:i.Token,expiration:K5(i.Expiration)}}if(t.statusCode>=400&&t.statusCode<500){let i={};try{i=JSON.parse(n)}catch{}throw Object.assign(new Kr(`Server responded with status: ${t.statusCode}`,{logger:e}),{Code:i.Code,Message:i.Message})}throw new Kr(`Server responded with status: ${t.statusCode}`,{logger:e})}const nW=(t,e,r)=>async()=>{for(let n=0;n<e;++n)try{return await t()}catch{await new Promise(a=>setTimeout(a,r))}return await t()},iW=(t={})=>{t.logger?.debug("@aws-sdk/credential-provider-http - fromHttp");let e;const r=t.credentialsFullUri;if(r)e=r;else throw new Kr("No HTTP credential provider host provided.",{logger:t.logger});const n=new URL(e);I5(n,t.logger);const i=new jP;return nW(async()=>{const a=tW(n);t.authorizationToken&&(a.headers.Authorization=t.authorizationToken);const o=await i.handle(a);return rW(o.response)},t.maxRetries??3,t.timeout??1e3)},aW=(t,e)=>(r,n)=>async i=>{const{response:a}=await r(i);try{const o=await e(a,t);return{response:a,output:o}}catch(o){if(Object.defineProperty(o,"$response",{value:a}),!("$metadata"in o)){const s="Deserialization error: to see the raw response, inspect the hidden field {error}.$response on this object.";try{o.message+=`
  `+s}catch{!n.logger||n.logger?.constructor?.name==="NoOpLogger"?console.warn(s):n.logger?.warn?.(s)}typeof o.$responseBodyText<"u"&&o.$response&&(o.$response.body=o.$responseBodyText)}throw o}},oW=(t,e)=>(r,n)=>async i=>{const a=n.endpointV2?.url&&t.urlParser?async()=>t.urlParser(n.endpointV2.url):t.endpoint;if(!a)throw new Error("No valid endpoint provider available.");const o=await e(i.input,{...t,endpoint:a});return r({...i,request:o})},sW={name:"deserializerMiddleware",step:"deserialize",tags:["DESERIALIZER"],override:!0},tU={name:"serializerMiddleware",step:"serialize",tags:["SERIALIZER"],override:!0};function _je(t,e,r){return{applyToStack:n=>{n.add(aW(t,r),sW),n.add(oW(t,e),tU)}}}tU.name;const uW=t=>{if(typeof t=="function")return t;const e=Promise.resolve(t);return()=>e},lW="us-east-1",cW=(t,e)=>{let r;return async(n={})=>{const{callerClientConfig:i}=n,a=t.logger??i?.logger;a?.debug("@aws-sdk/credential-providers - fromTemporaryCredentials (STS)");const o={...t.params,RoleSessionName:t.params.RoleSessionName??"aws-sdk-js-"+Date.now()};if(o?.SerialNumber){if(!t.mfaCodeProvider)throw new Kr("Temporary credential requires multi-factor authentication, but no MFA code callback was provided.",{tryNextLink:!1,logger:a});o.TokenCode=await t.mfaCodeProvider(o?.SerialNumber)}const{AssumeRoleCommand:s,STSClient:l}=await va(async()=>{const{AssumeRoleCommand:d,STSClient:f}=await import("./loadSts-DoxBImBQ.js").then(h=>h.l);return{AssumeRoleCommand:d,STSClient:f}},__vite__mapDeps([2,1]));if(!r){const d=typeof e=="function"?e():void 0,f=[t.masterCredentials,t.clientConfig?.credentials,void i?.credentials,i?.credentialDefaultProvider?.(),d];let h="STS client default credentials";if(f[0])h="options.masterCredentials";else if(f[1])h="options.clientConfig.credentials";else{if(f[2])throw h="caller client's credentials",new Error("fromTemporaryCredentials recursion in callerClientConfig.credentials");f[3]?h="caller client's credentialDefaultProvider":f[4]&&(h="AWS SDK default credentials")}const p=[t.clientConfig?.region,i?.region,lW];let b="default partition's default region";p[0]?b="options.clientConfig.region":p[1]&&(b="caller client's region");const g=[QM(t.clientConfig?.requestHandler),QM(i?.requestHandler)];let v="STS default requestHandler";g[0]?v="options.clientConfig.requestHandler":g[1]&&(v="caller client's requestHandler"),a?.debug?.(`@aws-sdk/credential-providers - fromTemporaryCredentials STS client init with ${b}=${await uW(e_(p))()}, ${h}, ${v}.`),r=new l({...t.clientConfig,credentials:e_(f),logger:a,profile:t.clientConfig?.profile??i?.profile,region:e_(p),requestHandler:e_(g)})}if(t.clientPlugins)for(const d of t.clientPlugins)r.middlewareStack.use(d);const{Credentials:c}=await r.send(new s(o));if(!c||!c.AccessKeyId||!c.SecretAccessKey)throw new Kr(`Invalid response from STS.assumeRole call with role ${o.RoleArn}`,{logger:a});return{accessKeyId:c.AccessKeyId,secretAccessKey:c.SecretAccessKey,sessionToken:c.SessionToken,expiration:c.Expiration,credentialScope:c.CredentialScope}}},QM=t=>t?.metadata?.handlerProtocol==="h2"?void 0:t,e_=t=>{for(const e of t)if(e!==void 0)return e},dW={},fW=Object.freeze(Object.defineProperty({__proto__:null,default:dW},Symbol.toStringTag,{value:"Module"})),hW=t=>async e=>{t.logger?.debug("@aws-sdk/credential-provider-web-identity - fromWebToken");const{roleArn:r,roleSessionName:n,webIdentityToken:i,providerId:a,policyArns:o,policy:s,durationSeconds:l}=t;let{roleAssumerWithWebIdentity:c}=t;if(!c){const{getDefaultRoleAssumerWithWebIdentity:d}=await va(async()=>{const{getDefaultRoleAssumerWithWebIdentity:f}=await import("./index-DnPHkz8b.js");return{getDefaultRoleAssumerWithWebIdentity:f}},__vite__mapDeps([3,2,1]));c=d({...t.clientConfig,credentialProviderLogger:t.logger,parentClientConfig:{...e?.callerClientConfig,...t.parentClientConfig}},t.clientPlugins)}return c({RoleArn:r,RoleSessionName:n??`aws-sdk-js-session-${Date.now()}`,WebIdentityToken:i,ProviderId:a,PolicyArns:o,Policy:s,DurationSeconds:l})},pW=t=>hW({...t}),_W=Object.freeze(Object.defineProperty({__proto__:null,fromCognitoIdentity:b5,fromCognitoIdentityPool:g5,fromHttp:iW,fromTemporaryCredentials:cW,fromWebToken:pW},Symbol.toStringTag,{value:"Module"})),yW=jo(_W);var eT;(function(t){t.HEADER="header",t.QUERY="query"})(eT||(eT={}));var tT;(function(t){t.HTTP="http",t.HTTPS="https"})(tT||(tT={}));var lS;(function(t){t[t.HEADER=0]="HEADER",t[t.TRAILER=1]="TRAILER"})(lS||(lS={}));var rT;(function(t){t.HTTP_0_9="http/0.9",t.HTTP_1_0="http/1.0",t.TDS_8_0="tds/8.0"})(rT||(rT={}));class bW{constructor({name:e,kind:r=lS.HEADER,values:n=[]}){this.name=e,this.kind=r,this.values=n}add(e){this.values.push(e)}set(e){this.values=e}remove(e){this.values=this.values.filter(r=>r!==e)}toString(){return this.values.map(e=>e.includes(",")||e.includes(" ")?`"${e}"`:e).join(", ")}get(){return this.values}}class gW{constructor({fields:e=[],encoding:r="utf-8"}){this.entries={},e.forEach(this.setField.bind(this)),this.encoding=r}setField(e){this.entries[e.name.toLowerCase()]=e}getField(e){return this.entries[e.toLowerCase()]}removeField(e){delete this.entries[e.toLowerCase()]}getByType(e){return Object.values(this.entries).filter(r=>r.kind===e)}}class TP{constructor(e){this.method=e.method||"GET",this.hostname=e.hostname||"localhost",this.port=e.port,this.query=e.query||{},this.headers=e.headers||{},this.body=e.body,this.protocol=e.protocol?e.protocol.slice(-1)!==":"?`${e.protocol}:`:e.protocol:"https:",this.path=e.path?e.path.charAt(0)!=="/"?`/${e.path}`:e.path:"/",this.username=e.username,this.password=e.password,this.fragment=e.fragment}static isInstance(e){if(!e)return!1;const r=e;return"method"in r&&"protocol"in r&&"hostname"in r&&"path"in r&&typeof r.query=="object"&&typeof r.headers=="object"}clone(){const e=new TP({...this,headers:{...this.headers}});return e.query&&(e.query=mW(e.query)),e}}function mW(t){return Object.keys(t).reduce((e,r)=>{const n=t[r];return{...e,[r]:Array.isArray(n)?[...n]:n}},{})}class vW{constructor(e){this.statusCode=e.statusCode,this.reason=e.reason,this.headers=e.headers||{},this.body=e.body}static isInstance(e){if(!e)return!1;const r=e;return typeof r.statusCode=="number"&&typeof r.headers=="object"}}function wW(t){return/^[a-z0-9][a-z0-9\.\-]*[a-z0-9]$/.test(t)}const OW=Object.freeze(Object.defineProperty({__proto__:null,Field:bW,Fields:gW,HttpRequest:TP,HttpResponse:vW,isValidHostname:wW},Symbol.toStringTag,{value:"Module"})),SW=jo(OW);var Fw={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var cS=function(t,e){return cS=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},cS(t,e)};function EW(t,e){cS(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var dS=function(){return dS=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},dS.apply(this,arguments)};function PW(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function jW(t,e,r,n){var i=arguments.length,a=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,r):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(t,e,r,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(i<3?o(a):i>3?o(e,r,a):o(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a}function CW(t,e){return function(r,n){e(r,n,t)}}function MW(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function TW(t,e,r,n){function i(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function s(d){try{c(n.next(d))}catch(f){o(f)}}function l(d){try{c(n.throw(d))}catch(f){o(f)}}function c(d){d.done?a(d.value):i(d.value).then(s,l)}c((n=n.apply(t,e||[])).next())})}function RW(t,e){var r={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,i,a,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(c){return function(d){return l([c,d])}}function l(c){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(a=c[0]&2?i.return:c[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,c[1])).done)return a;switch(i=0,a&&(c=[c[0]&2,a.value]),c[0]){case 0:case 1:a=c;break;case 4:return r.label++,{value:c[1],done:!1};case 5:r.label++,i=c[1],c=[0];continue;case 7:c=r.ops.pop(),r.trys.pop();continue;default:if(a=r.trys,!(a=a.length>0&&a[a.length-1])&&(c[0]===6||c[0]===2)){r=0;continue}if(c[0]===3&&(!a||c[1]>a[0]&&c[1]<a[3])){r.label=c[1];break}if(c[0]===6&&r.label<a[1]){r.label=a[1],a=c;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(c);break}a[2]&&r.ops.pop(),r.trys.pop();continue}c=e.call(t,r)}catch(d){c=[6,d],i=0}finally{n=a=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}function AW(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}function $W(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function fS(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function rU(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,a=[],o;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(s){o={error:s}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return a}function IW(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(rU(arguments[e]));return t}function xW(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),i=0,e=0;e<r;e++)for(var a=arguments[e],o=0,s=a.length;o<s;o++,i++)n[i]=a[o];return n}function Hc(t){return this instanceof Hc?(this.v=t,this):new Hc(t)}function DW(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(t,e||[]),i,a=[];return i={},o("next"),o("throw"),o("return"),i[Symbol.asyncIterator]=function(){return this},i;function o(h){n[h]&&(i[h]=function(p){return new Promise(function(b,g){a.push([h,p,b,g])>1||s(h,p)})})}function s(h,p){try{l(n[h](p))}catch(b){f(a[0][3],b)}}function l(h){h.value instanceof Hc?Promise.resolve(h.value.v).then(c,d):f(a[0][2],h)}function c(h){s("next",h)}function d(h){s("throw",h)}function f(h,p){h(p),a.shift(),a.length&&s(a[0][0],a[0][1])}}function NW(t){var e,r;return e={},n("next"),n("throw",function(i){throw i}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(i,a){e[i]=t[i]?function(o){return(r=!r)?{value:Hc(t[i](o)),done:i==="return"}:a?a(o):o}:a}}function zW(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof fS=="function"?fS(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(a){r[a]=t[a]&&function(o){return new Promise(function(s,l){o=t[a](o),i(s,l,o.done,o.value)})}}function i(a,o,s,l){Promise.resolve(l).then(function(c){a({value:c,done:s})},o)}}function BW(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function UW(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function FW(t){return t&&t.__esModule?t:{default:t}}function LW(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function VW(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}const kW=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return dS},__asyncDelegator:NW,__asyncGenerator:DW,__asyncValues:zW,__await:Hc,__awaiter:TW,__classPrivateFieldGet:LW,__classPrivateFieldSet:VW,__createBinding:AW,__decorate:jW,__exportStar:$W,__extends:EW,__generator:RW,__importDefault:FW,__importStar:UW,__makeTemplateObject:BW,__metadata:MW,__param:CW,__read:rU,__rest:PW,__spread:IW,__spreadArrays:xW,__values:fS},Symbol.toStringTag,{value:"Module"})),nU=jo(kW);var RP={},Og={};const HW=t=>{const e=[];for(let r=0,n=t.length;r<n;r++){const i=t.charCodeAt(r);if(i<128)e.push(i);else if(i<2048)e.push(i>>6|192,i&63|128);else if(r+1<t.length&&(i&64512)===55296&&(t.charCodeAt(r+1)&64512)===56320){const a=65536+((i&1023)<<10)+(t.charCodeAt(++r)&1023);e.push(a>>18|240,a>>12&63|128,a>>6&63|128,a&63|128)}else e.push(i>>12|224,i>>6&63|128,i&63|128)}return Uint8Array.from(e)},qW=t=>{let e="";for(let r=0,n=t.length;r<n;r++){const i=t[r];if(i<128)e+=String.fromCharCode(i);else if(192<=i&&i<224){const a=t[++r];e+=String.fromCharCode((i&31)<<6|a&63)}else if(240<=i&&i<365){const o="%"+[i,t[++r],t[++r],t[++r]].map(s=>s.toString(16)).join("%");e+=decodeURIComponent(o)}else e+=String.fromCharCode((i&15)<<12|(t[++r]&63)<<6|t[++r]&63)}return e};function GW(t){return new TextEncoder().encode(t)}function WW(t){return new TextDecoder("utf-8").decode(t)}const KW=t=>typeof TextEncoder=="function"?GW(t):HW(t),JW=t=>typeof TextDecoder=="function"?WW(t):qW(t),XW=Object.freeze(Object.defineProperty({__proto__:null,fromUtf8:KW,toUtf8:JW},Symbol.toStringTag,{value:"Module"})),ZW=jo(XW);Object.defineProperty(Og,"__esModule",{value:!0});Og.convertToBuffer=void 0;var YW=ZW,QW=typeof Buffer<"u"&&Buffer.from?function(t){return Buffer.from(t,"utf8")}:YW.fromUtf8;function eK(t){return t instanceof Uint8Array?t:typeof t=="string"?QW(t):ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(t)}Og.convertToBuffer=eK;var Sg={};Object.defineProperty(Sg,"__esModule",{value:!0});Sg.isEmptyData=void 0;function tK(t){return typeof t=="string"?t.length===0:t.byteLength===0}Sg.isEmptyData=tK;var Eg={};Object.defineProperty(Eg,"__esModule",{value:!0});Eg.numToUint8=void 0;function rK(t){return new Uint8Array([(t&4278190080)>>24,(t&16711680)>>16,(t&65280)>>8,t&255])}Eg.numToUint8=rK;var Pg={};Object.defineProperty(Pg,"__esModule",{value:!0});Pg.uint32ArrayFrom=void 0;function nK(t){if(!Uint32Array.from){for(var e=new Uint32Array(t.length),r=0;r<t.length;)e[r]=t[r],r+=1;return e}return Uint32Array.from(t)}Pg.uint32ArrayFrom=nK;(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.uint32ArrayFrom=t.numToUint8=t.isEmptyData=t.convertToBuffer=void 0;var e=Og;Object.defineProperty(t,"convertToBuffer",{enumerable:!0,get:function(){return e.convertToBuffer}});var r=Sg;Object.defineProperty(t,"isEmptyData",{enumerable:!0,get:function(){return r.isEmptyData}});var n=Eg;Object.defineProperty(t,"numToUint8",{enumerable:!0,get:function(){return n.numToUint8}});var i=Pg;Object.defineProperty(t,"uint32ArrayFrom",{enumerable:!0,get:function(){return i.uint32ArrayFrom}})})(RP);var wl={},nT;function iK(){if(nT)return wl;nT=1,Object.defineProperty(wl,"__esModule",{value:!0}),wl.AwsCrc32=void 0;var t=nU,e=RP,r=iU(),n=function(){function i(){this.crc32=new r.Crc32}return i.prototype.update=function(a){(0,e.isEmptyData)(a)||this.crc32.update((0,e.convertToBuffer)(a))},i.prototype.digest=function(){return t.__awaiter(this,void 0,void 0,function(){return t.__generator(this,function(a){return[2,(0,e.numToUint8)(this.crc32.digest())]})})},i.prototype.reset=function(){this.crc32=new r.Crc32},i}();return wl.AwsCrc32=n,wl}var iT;function iU(){return iT||(iT=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.AwsCrc32=t.Crc32=t.crc32=void 0;var e=nU,r=RP;function n(l){return new i().update(l).digest()}t.crc32=n;var i=function(){function l(){this.checksum=4294967295}return l.prototype.update=function(c){var d,f;try{for(var h=e.__values(c),p=h.next();!p.done;p=h.next()){var b=p.value;this.checksum=this.checksum>>>8^o[(this.checksum^b)&255]}}catch(g){d={error:g}}finally{try{p&&!p.done&&(f=h.return)&&f.call(h)}finally{if(d)throw d.error}}return this},l.prototype.digest=function(){return(this.checksum^4294967295)>>>0},l}();t.Crc32=i;var a=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],o=(0,r.uint32ArrayFrom)(a),s=iK();Object.defineProperty(t,"AwsCrc32",{enumerable:!0,get:function(){return s.AwsCrc32}})}(Fw)),Fw}iU();const aU={},hS={};for(let t=0;t<256;t++){let e=t.toString(16).toLowerCase();e.length===1&&(e=`0${e}`),aU[t]=e,hS[e]=t}function aK(t){if(t.length%2!==0)throw new Error("Hex encoded strings must have an even number length");const e=new Uint8Array(t.length/2);for(let r=0;r<t.length;r+=2){const n=t.slice(r,r+2).toLowerCase();if(n in hS)e[r/2]=hS[n];else throw new Error(`Cannot decode unrecognized sequence ${n} as hexadecimal`)}return e}function ln(t){let e="";for(let r=0;r<t.byteLength;r++)e+=aU[t[r]];return e}class bc{constructor(e){if(this.bytes=e,e.byteLength!==8)throw new Error("Int64 buffers must be exactly 8 bytes")}static fromNumber(e){if(e>9223372036854776e3||e<-9223372036854776e3)throw new Error(`${e} is too large (or, if negative, too small) to represent as an Int64`);const r=new Uint8Array(8);for(let n=7,i=Math.abs(Math.round(e));n>-1&&i>0;n--,i/=256)r[n]=i;return e<0&&aT(r),new bc(r)}valueOf(){const e=this.bytes.slice(0),r=e[0]&128;return r&&aT(e),parseInt(ln(e),16)*(r?-1:1)}toString(){return String(this.valueOf())}}function aT(t){for(let e=0;e<8;e++)t[e]^=255;for(let e=7;e>-1&&(t[e]++,t[e]===0);e--);}class oK{constructor(e,r){this.toUtf8=e,this.fromUtf8=r}format(e){const r=[];for(const a of Object.keys(e)){const o=this.fromUtf8(a);r.push(Uint8Array.from([o.byteLength]),o,this.formatHeaderValue(e[a]))}const n=new Uint8Array(r.reduce((a,o)=>a+o.byteLength,0));let i=0;for(const a of r)n.set(a,i),i+=a.byteLength;return n}formatHeaderValue(e){switch(e.type){case"boolean":return Uint8Array.from([e.value?0:1]);case"byte":return Uint8Array.from([2,e.value]);case"short":const r=new DataView(new ArrayBuffer(3));return r.setUint8(0,3),r.setInt16(1,e.value,!1),new Uint8Array(r.buffer);case"integer":const n=new DataView(new ArrayBuffer(5));return n.setUint8(0,4),n.setInt32(1,e.value,!1),new Uint8Array(n.buffer);case"long":const i=new Uint8Array(9);return i[0]=5,i.set(e.value.bytes,1),i;case"binary":const a=new DataView(new ArrayBuffer(3+e.value.byteLength));a.setUint8(0,6),a.setUint16(1,e.value.byteLength,!1);const o=new Uint8Array(a.buffer);return o.set(e.value,3),o;case"string":const s=this.fromUtf8(e.value),l=new DataView(new ArrayBuffer(3+s.byteLength));l.setUint8(0,7),l.setUint16(1,s.byteLength,!1);const c=new Uint8Array(l.buffer);return c.set(s,3),c;case"timestamp":const d=new Uint8Array(9);return d[0]=8,d.set(bc.fromNumber(e.value.valueOf()).bytes,1),d;case"uuid":if(!_K.test(e.value))throw new Error(`Invalid UUID received: ${e.value}`);const f=new Uint8Array(17);return f[0]=9,f.set(aK(e.value.replace(/\-/g,"")),1),f}}parse(e){const r={};let n=0;for(;n<e.byteLength;){const i=e.getUint8(n++),a=this.toUtf8(new Uint8Array(e.buffer,e.byteOffset+n,i));switch(n+=i,e.getUint8(n++)){case 0:r[a]={type:sT,value:!0};break;case 1:r[a]={type:sT,value:!1};break;case 2:r[a]={type:sK,value:e.getInt8(n++)};break;case 3:r[a]={type:uK,value:e.getInt16(n,!1)},n+=2;break;case 4:r[a]={type:lK,value:e.getInt32(n,!1)},n+=4;break;case 5:r[a]={type:cK,value:new bc(new Uint8Array(e.buffer,e.byteOffset+n,8))},n+=8;break;case 6:const o=e.getUint16(n,!1);n+=2,r[a]={type:dK,value:new Uint8Array(e.buffer,e.byteOffset+n,o)},n+=o;break;case 7:const s=e.getUint16(n,!1);n+=2,r[a]={type:fK,value:this.toUtf8(new Uint8Array(e.buffer,e.byteOffset+n,s))},n+=s;break;case 8:r[a]={type:hK,value:new Date(new bc(new Uint8Array(e.buffer,e.byteOffset+n,8)).valueOf())},n+=8;break;case 9:const l=new Uint8Array(e.buffer,e.byteOffset+n,16);n+=16,r[a]={type:pK,value:`${ln(l.subarray(0,4))}-${ln(l.subarray(4,6))}-${ln(l.subarray(6,8))}-${ln(l.subarray(8,10))}-${ln(l.subarray(10))}`};break;default:throw new Error("Unrecognized header type tag")}}return r}}var oT;(function(t){t[t.boolTrue=0]="boolTrue",t[t.boolFalse=1]="boolFalse",t[t.byte=2]="byte",t[t.short=3]="short",t[t.integer=4]="integer",t[t.long=5]="long",t[t.byteArray=6]="byteArray",t[t.string=7]="string",t[t.timestamp=8]="timestamp",t[t.uuid=9]="uuid"})(oT||(oT={}));const sT="boolean",sK="byte",uK="short",lK="integer",cK="long",dK="binary",fK="string",hK="timestamp",pK="uuid",_K=/^[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}$/,uT=t=>{if(typeof t=="function")return t;const e=Promise.resolve(t);return()=>e},oU=t=>new TextEncoder().encode(t),gc=t=>typeof t=="string"?oU(t):ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(t),yK=t=>new TextDecoder("utf-8").decode(t),bK="X-Amz-Algorithm",gK="X-Amz-Credential",sU="X-Amz-Date",mK="X-Amz-SignedHeaders",vK="X-Amz-Expires",uU="X-Amz-Signature",lU="X-Amz-Security-Token",cU="authorization",dU=sU.toLowerCase(),wK="date",OK=[cU,dU,wK],SK=uU.toLowerCase(),pS="x-amz-content-sha256",EK=lU.toLowerCase(),PK={authorization:!0,"cache-control":!0,connection:!0,expect:!0,from:!0,"keep-alive":!0,"max-forwards":!0,pragma:!0,referer:!0,te:!0,trailer:!0,"transfer-encoding":!0,upgrade:!0,"user-agent":!0,"x-amzn-trace-id":!0},jK=/^proxy-/,CK=/^sec-/,Lw="AWS4-HMAC-SHA256",MK="AWS4-HMAC-SHA256-PAYLOAD",TK="UNSIGNED-PAYLOAD",RK=50,fU="aws4_request",AK=60*60*24*7,zs={},q_=[],G_=(t,e,r)=>`${t}/${e}/${r}/${fU}`,hU=async(t,e,r,n,i)=>{const a=await lT(t,e.secretAccessKey,e.accessKeyId),o=`${r}:${n}:${i}:${ln(a)}:${e.sessionToken}`;if(o in zs)return zs[o];for(q_.push(o);q_.length>RK;)delete zs[q_.shift()];let s=`AWS4${e.secretAccessKey}`;for(const l of[r,n,i,fU])s=await lT(t,s,l);return zs[o]=s},$K=()=>{q_.length=0,Object.keys(zs).forEach(t=>{delete zs[t]})},lT=(t,e,r)=>{const n=new t(e);return n.update(gc(r)),n.digest()},_S=({headers:t},e,r)=>{const n={};for(const i of Object.keys(t).sort()){if(t[i]==null)continue;const a=i.toLowerCase();(a in PK||e?.has(a)||jK.test(a)||CK.test(a))&&(!r||r&&!r.has(a))||(n[a]=t[i].trim().replace(/\s+/g," "))}return n},t_=t=>encodeURIComponent(t).replace(/[!'()*]/g,IK),IK=t=>`%${t.charCodeAt(0).toString(16).toUpperCase()}`,pU=({query:t={}})=>{const e=[],r={};for(const n of Object.keys(t).sort()){if(n.toLowerCase()===SK)continue;e.push(n);const i=t[n];typeof i=="string"?r[n]=`${t_(n)}=${t_(i)}`:Array.isArray(i)&&(r[n]=i.slice(0).sort().reduce((a,o)=>a.concat([`${t_(n)}=${t_(o)}`]),[]).join("&"))}return e.map(n=>r[n]).filter(n=>n).join("&")},xK=t=>typeof ArrayBuffer=="function"&&t instanceof ArrayBuffer||Object.prototype.toString.call(t)==="[object ArrayBuffer]",W_=async({headers:t,body:e},r)=>{for(const n of Object.keys(t))if(n.toLowerCase()===pS)return t[n];if(e==null)return"e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855";if(typeof e=="string"||ArrayBuffer.isView(e)||xK(e)){const n=new r;return n.update(gc(e)),ln(await n.digest())}return TK},DK=(t,e)=>{t=t.toLowerCase();for(const r of Object.keys(e))if(t===r.toLowerCase())return!0;return!1},_U=({headers:t,query:e,...r})=>({...r,headers:{...t},query:e?NK(e):void 0}),NK=t=>Object.keys(t).reduce((e,r)=>{const n=t[r];return{...e,[r]:Array.isArray(n)?[...n]:n}},{}),yU=(t,e={})=>{const{headers:r,query:n={}}=typeof t.clone=="function"?t.clone():_U(t);for(const i of Object.keys(r)){const a=i.toLowerCase();a.slice(0,6)==="x-amz-"&&!e.unhoistableHeaders?.has(a)&&(n[i]=r[i],delete r[i])}return{...t,headers:r,query:n}},yS=t=>{t=typeof t.clone=="function"?t.clone():_U(t);for(const e of Object.keys(t.headers))OK.indexOf(e.toLowerCase())>-1&&delete t.headers[e];return t},zK=t=>BK(t).toISOString().replace(/\.\d{3}Z$/,"Z"),BK=t=>typeof t=="number"?new Date(t*1e3):typeof t=="string"?Number(t)?new Date(Number(t)*1e3):new Date(t):t;class UK{constructor({applyChecksum:e,credentials:r,region:n,service:i,sha256:a,uriEscapePath:o=!0}){this.headerMarshaller=new oK(yK,oU),this.service=i,this.sha256=a,this.uriEscapePath=o,this.applyChecksum=typeof e=="boolean"?e:!0,this.regionProvider=uT(n),this.credentialProvider=uT(r)}async presign(e,r={}){const{signingDate:n=new Date,expiresIn:i=3600,unsignableHeaders:a,unhoistableHeaders:o,signableHeaders:s,signingRegion:l,signingService:c}=r,d=await this.credentialProvider();this.validateResolvedCredentials(d);const f=l??await this.regionProvider(),{longDate:h,shortDate:p}=r_(n);if(i>AK)return Promise.reject("Signature version 4 presigned URLs must have an expiration date less than one week in the future");const b=G_(p,f,c??this.service),g=yU(yS(e),{unhoistableHeaders:o});d.sessionToken&&(g.query[lU]=d.sessionToken),g.query[bK]=Lw,g.query[gK]=`${d.accessKeyId}/${b}`,g.query[sU]=h,g.query[vK]=i.toString(10);const v=_S(g,a,s);return g.query[mK]=cT(v),g.query[uU]=await this.getSignature(h,b,this.getSigningKey(d,f,p,c),this.createCanonicalRequest(g,v,await W_(e,this.sha256))),g}async sign(e,r){return typeof e=="string"?this.signString(e,r):e.headers&&e.payload?this.signEvent(e,r):e.message?this.signMessage(e,r):this.signRequest(e,r)}async signEvent({headers:e,payload:r},{signingDate:n=new Date,priorSignature:i,signingRegion:a,signingService:o}){const s=a??await this.regionProvider(),{shortDate:l,longDate:c}=r_(n),d=G_(l,s,o??this.service),f=await W_({headers:{},body:r},this.sha256),h=new this.sha256;h.update(e);const p=ln(await h.digest()),b=[MK,c,d,i,p,f].join(`
`);return this.signString(b,{signingDate:n,signingRegion:s,signingService:o})}async signMessage(e,{signingDate:r=new Date,signingRegion:n,signingService:i}){return this.signEvent({headers:this.headerMarshaller.format(e.message.headers),payload:e.message.body},{signingDate:r,signingRegion:n,signingService:i,priorSignature:e.priorSignature}).then(o=>({message:e.message,signature:o}))}async signString(e,{signingDate:r=new Date,signingRegion:n,signingService:i}={}){const a=await this.credentialProvider();this.validateResolvedCredentials(a);const o=n??await this.regionProvider(),{shortDate:s}=r_(r),l=new this.sha256(await this.getSigningKey(a,o,s,i));return l.update(gc(e)),ln(await l.digest())}async signRequest(e,{signingDate:r=new Date,signableHeaders:n,unsignableHeaders:i,signingRegion:a,signingService:o}={}){const s=await this.credentialProvider();this.validateResolvedCredentials(s);const l=a??await this.regionProvider(),c=yS(e),{longDate:d,shortDate:f}=r_(r),h=G_(f,l,o??this.service);c.headers[dU]=d,s.sessionToken&&(c.headers[EK]=s.sessionToken);const p=await W_(c,this.sha256);!DK(pS,c.headers)&&this.applyChecksum&&(c.headers[pS]=p);const b=_S(c,i,n),g=await this.getSignature(d,h,this.getSigningKey(s,l,f,o),this.createCanonicalRequest(c,b,p));return c.headers[cU]=`${Lw} Credential=${s.accessKeyId}/${h}, SignedHeaders=${cT(b)}, Signature=${g}`,c}createCanonicalRequest(e,r,n){const i=Object.keys(r).sort();return`${e.method}
${this.getCanonicalPath(e)}
${pU(e)}
${i.map(a=>`${a}:${r[a]}`).join(`
`)}

${i.join(";")}
${n}`}async createStringToSign(e,r,n){const i=new this.sha256;i.update(gc(n));const a=await i.digest();return`${Lw}
${e}
${r}
${ln(a)}`}getCanonicalPath({path:e}){if(this.uriEscapePath){const r=[];for(const a of e.split("/"))a?.length!==0&&a!=="."&&(a===".."?r.pop():r.push(a));const n=`${e?.startsWith("/")?"/":""}${r.join("/")}${r.length>0&&e?.endsWith("/")?"/":""}`;return encodeURIComponent(n).replace(/%2F/g,"/")}return e}async getSignature(e,r,n,i){const a=await this.createStringToSign(e,r,i),o=new this.sha256(await n);return o.update(gc(a)),ln(await o.digest())}getSigningKey(e,r,n,i){return hU(this.sha256,e,n,r,i||this.service)}validateResolvedCredentials(e){if(typeof e!="object"||typeof e.accessKeyId!="string"||typeof e.secretAccessKey!="string")throw new Error("Resolved credential object is not valid")}}const r_=t=>{const e=zK(t).replace(/[\-:]/g,"");return{longDate:e,shortDate:e.slice(0,8)}},cT=t=>Object.keys(t).sort().join(";"),FK=Object.freeze(Object.defineProperty({__proto__:null,SignatureV4:UK,clearCredentialCache:$K,createScope:G_,getCanonicalHeaders:_S,getCanonicalQuery:pU,getPayloadHash:W_,getSigningKey:hU,moveHeadersToQuery:yU,prepareRequest:yS},Symbol.toStringTag,{value:"Module"})),LK=jo(FK);var bU={exports:{}},Vw={exports:{}},ki={},AP={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */AP.read=function(t,e,r,n,i){var a,o,s=i*8-n-1,l=(1<<s)-1,c=l>>1,d=-7,f=r?i-1:0,h=r?-1:1,p=t[e+f];for(f+=h,a=p&(1<<-d)-1,p>>=-d,d+=s;d>0;a=a*256+t[e+f],f+=h,d-=8);for(o=a&(1<<-d)-1,a>>=-d,d+=n;d>0;o=o*256+t[e+f],f+=h,d-=8);if(a===0)a=1-c;else{if(a===l)return o?NaN:(p?-1:1)*(1/0);o=o+Math.pow(2,n),a=a-c}return(p?-1:1)*o*Math.pow(2,a-n)};AP.write=function(t,e,r,n,i,a){var o,s,l,c=a*8-i-1,d=(1<<c)-1,f=d>>1,h=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:a-1,b=n?1:-1,g=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,o=d):(o=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-o))<1&&(o--,l*=2),o+f>=1?e+=h/l:e+=h*Math.pow(2,1-f),e*l>=2&&(o++,l/=2),o+f>=d?(s=0,o=d):o+f>=1?(s=(e*l-1)*Math.pow(2,i),o=o+f):(s=e*Math.pow(2,f-1)*Math.pow(2,i),o=0));i>=8;t[r+p]=s&255,p+=b,s/=256,i-=8);for(o=o<<i|s,c+=i;c>0;t[r+p]=o&255,p+=b,o/=256,c-=8);t[r+p-b]|=g*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(t){const e=rd,r=AP,n=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=s,t.SlowBuffer=C,t.INSPECT_MAX_BYTES=50;const i=2147483647;t.kMaxLength=i,s.TYPED_ARRAY_SUPPORT=a(),!s.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function a(){try{const m=new Uint8Array(1),_={foo:function(){return 42}};return Object.setPrototypeOf(_,Uint8Array.prototype),Object.setPrototypeOf(m,_),m.foo()===42}catch{return!1}}Object.defineProperty(s.prototype,"parent",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.buffer}}),Object.defineProperty(s.prototype,"offset",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.byteOffset}});function o(m){if(m>i)throw new RangeError('The value "'+m+'" is invalid for option "size"');const _=new Uint8Array(m);return Object.setPrototypeOf(_,s.prototype),_}function s(m,_,y){if(typeof m=="number"){if(typeof _=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return f(m)}return l(m,_,y)}s.poolSize=8192;function l(m,_,y){if(typeof m=="string")return h(m,_);if(ArrayBuffer.isView(m))return b(m);if(m==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof m);if(we(m,ArrayBuffer)||m&&we(m.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(we(m,SharedArrayBuffer)||m&&we(m.buffer,SharedArrayBuffer)))return g(m,_,y);if(typeof m=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const O=m.valueOf&&m.valueOf();if(O!=null&&O!==m)return s.from(O,_,y);const M=v(m);if(M)return M;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof m[Symbol.toPrimitive]=="function")return s.from(m[Symbol.toPrimitive]("string"),_,y);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof m)}s.from=function(m,_,y){return l(m,_,y)},Object.setPrototypeOf(s.prototype,Uint8Array.prototype),Object.setPrototypeOf(s,Uint8Array);function c(m){if(typeof m!="number")throw new TypeError('"size" argument must be of type number');if(m<0)throw new RangeError('The value "'+m+'" is invalid for option "size"')}function d(m,_,y){return c(m),m<=0?o(m):_!==void 0?typeof y=="string"?o(m).fill(_,y):o(m).fill(_):o(m)}s.alloc=function(m,_,y){return d(m,_,y)};function f(m){return c(m),o(m<0?0:E(m)|0)}s.allocUnsafe=function(m){return f(m)},s.allocUnsafeSlow=function(m){return f(m)};function h(m,_){if((typeof _!="string"||_==="")&&(_="utf8"),!s.isEncoding(_))throw new TypeError("Unknown encoding: "+_);const y=S(m,_)|0;let O=o(y);const M=O.write(m,_);return M!==y&&(O=O.slice(0,M)),O}function p(m){const _=m.length<0?0:E(m.length)|0,y=o(_);for(let O=0;O<_;O+=1)y[O]=m[O]&255;return y}function b(m){if(we(m,Uint8Array)){const _=new Uint8Array(m);return g(_.buffer,_.byteOffset,_.byteLength)}return p(m)}function g(m,_,y){if(_<0||m.byteLength<_)throw new RangeError('"offset" is outside of buffer bounds');if(m.byteLength<_+(y||0))throw new RangeError('"length" is outside of buffer bounds');let O;return _===void 0&&y===void 0?O=new Uint8Array(m):y===void 0?O=new Uint8Array(m,_):O=new Uint8Array(m,_,y),Object.setPrototypeOf(O,s.prototype),O}function v(m){if(s.isBuffer(m)){const _=E(m.length)|0,y=o(_);return y.length===0||m.copy(y,0,0,_),y}if(m.length!==void 0)return typeof m.length!="number"||Yr(m.length)?o(0):p(m);if(m.type==="Buffer"&&Array.isArray(m.data))return p(m.data)}function E(m){if(m>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return m|0}function C(m){return+m!=m&&(m=0),s.alloc(+m)}s.isBuffer=function(_){return _!=null&&_._isBuffer===!0&&_!==s.prototype},s.compare=function(_,y){if(we(_,Uint8Array)&&(_=s.from(_,_.offset,_.byteLength)),we(y,Uint8Array)&&(y=s.from(y,y.offset,y.byteLength)),!s.isBuffer(_)||!s.isBuffer(y))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(_===y)return 0;let O=_.length,M=y.length;for(let $=0,L=Math.min(O,M);$<L;++$)if(_[$]!==y[$]){O=_[$],M=y[$];break}return O<M?-1:M<O?1:0},s.isEncoding=function(_){switch(String(_).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},s.concat=function(_,y){if(!Array.isArray(_))throw new TypeError('"list" argument must be an Array of Buffers');if(_.length===0)return s.alloc(0);let O;if(y===void 0)for(y=0,O=0;O<_.length;++O)y+=_[O].length;const M=s.allocUnsafe(y);let $=0;for(O=0;O<_.length;++O){let L=_[O];if(we(L,Uint8Array))$+L.length>M.length?(s.isBuffer(L)||(L=s.from(L)),L.copy(M,$)):Uint8Array.prototype.set.call(M,L,$);else if(s.isBuffer(L))L.copy(M,$);else throw new TypeError('"list" argument must be an Array of Buffers');$+=L.length}return M};function S(m,_){if(s.isBuffer(m))return m.length;if(ArrayBuffer.isView(m)||we(m,ArrayBuffer))return m.byteLength;if(typeof m!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof m);const y=m.length,O=arguments.length>2&&arguments[2]===!0;if(!O&&y===0)return 0;let M=!1;for(;;)switch(_){case"ascii":case"latin1":case"binary":return y;case"utf8":case"utf-8":return pe(m).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return y*2;case"hex":return y>>>1;case"base64":return tt(m).length;default:if(M)return O?-1:pe(m).length;_=(""+_).toLowerCase(),M=!0}}s.byteLength=S;function N(m,_,y){let O=!1;if((_===void 0||_<0)&&(_=0),_>this.length||((y===void 0||y>this.length)&&(y=this.length),y<=0)||(y>>>=0,_>>>=0,y<=_))return"";for(m||(m="utf8");;)switch(m){case"hex":return H(this,_,y);case"utf8":case"utf-8":return x(this,_,y);case"ascii":return G(this,_,y);case"latin1":case"binary":return J(this,_,y);case"base64":return I(this,_,y);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Y(this,_,y);default:if(O)throw new TypeError("Unknown encoding: "+m);m=(m+"").toLowerCase(),O=!0}}s.prototype._isBuffer=!0;function D(m,_,y){const O=m[_];m[_]=m[y],m[y]=O}s.prototype.swap16=function(){const _=this.length;if(_%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let y=0;y<_;y+=2)D(this,y,y+1);return this},s.prototype.swap32=function(){const _=this.length;if(_%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let y=0;y<_;y+=4)D(this,y,y+3),D(this,y+1,y+2);return this},s.prototype.swap64=function(){const _=this.length;if(_%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let y=0;y<_;y+=8)D(this,y,y+7),D(this,y+1,y+6),D(this,y+2,y+5),D(this,y+3,y+4);return this},s.prototype.toString=function(){const _=this.length;return _===0?"":arguments.length===0?x(this,0,_):N.apply(this,arguments)},s.prototype.toLocaleString=s.prototype.toString,s.prototype.equals=function(_){if(!s.isBuffer(_))throw new TypeError("Argument must be a Buffer");return this===_?!0:s.compare(this,_)===0},s.prototype.inspect=function(){let _="";const y=t.INSPECT_MAX_BYTES;return _=this.toString("hex",0,y).replace(/(.{2})/g,"$1 ").trim(),this.length>y&&(_+=" ... "),"<Buffer "+_+">"},n&&(s.prototype[n]=s.prototype.inspect),s.prototype.compare=function(_,y,O,M,$){if(we(_,Uint8Array)&&(_=s.from(_,_.offset,_.byteLength)),!s.isBuffer(_))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof _);if(y===void 0&&(y=0),O===void 0&&(O=_?_.length:0),M===void 0&&(M=0),$===void 0&&($=this.length),y<0||O>_.length||M<0||$>this.length)throw new RangeError("out of range index");if(M>=$&&y>=O)return 0;if(M>=$)return-1;if(y>=O)return 1;if(y>>>=0,O>>>=0,M>>>=0,$>>>=0,this===_)return 0;let L=$-M,Ne=O-y;const wt=Math.min(L,Ne),dt=this.slice(M,$),Ot=_.slice(y,O);for(let et=0;et<wt;++et)if(dt[et]!==Ot[et]){L=dt[et],Ne=Ot[et];break}return L<Ne?-1:Ne<L?1:0};function Z(m,_,y,O,M){if(m.length===0)return-1;if(typeof y=="string"?(O=y,y=0):y>2147483647?y=2147483647:y<-2147483648&&(y=-2147483648),y=+y,Yr(y)&&(y=M?0:m.length-1),y<0&&(y=m.length+y),y>=m.length){if(M)return-1;y=m.length-1}else if(y<0)if(M)y=0;else return-1;if(typeof _=="string"&&(_=s.from(_,O)),s.isBuffer(_))return _.length===0?-1:se(m,_,y,O,M);if(typeof _=="number")return _=_&255,typeof Uint8Array.prototype.indexOf=="function"?M?Uint8Array.prototype.indexOf.call(m,_,y):Uint8Array.prototype.lastIndexOf.call(m,_,y):se(m,[_],y,O,M);throw new TypeError("val must be string, number or Buffer")}function se(m,_,y,O,M){let $=1,L=m.length,Ne=_.length;if(O!==void 0&&(O=String(O).toLowerCase(),O==="ucs2"||O==="ucs-2"||O==="utf16le"||O==="utf-16le")){if(m.length<2||_.length<2)return-1;$=2,L/=2,Ne/=2,y/=2}function wt(Ot,et){return $===1?Ot[et]:Ot.readUInt16BE(et*$)}let dt;if(M){let Ot=-1;for(dt=y;dt<L;dt++)if(wt(m,dt)===wt(_,Ot===-1?0:dt-Ot)){if(Ot===-1&&(Ot=dt),dt-Ot+1===Ne)return Ot*$}else Ot!==-1&&(dt-=dt-Ot),Ot=-1}else for(y+Ne>L&&(y=L-Ne),dt=y;dt>=0;dt--){let Ot=!0;for(let et=0;et<Ne;et++)if(wt(m,dt+et)!==wt(_,et)){Ot=!1;break}if(Ot)return dt}return-1}s.prototype.includes=function(_,y,O){return this.indexOf(_,y,O)!==-1},s.prototype.indexOf=function(_,y,O){return Z(this,_,y,O,!0)},s.prototype.lastIndexOf=function(_,y,O){return Z(this,_,y,O,!1)};function re(m,_,y,O){y=Number(y)||0;const M=m.length-y;O?(O=Number(O),O>M&&(O=M)):O=M;const $=_.length;O>$/2&&(O=$/2);let L;for(L=0;L<O;++L){const Ne=parseInt(_.substr(L*2,2),16);if(Yr(Ne))return L;m[y+L]=Ne}return L}function k(m,_,y,O){return wr(pe(_,m.length-y),m,y,O)}function ee(m,_,y,O){return wr(ut(_),m,y,O)}function X(m,_,y,O){return wr(tt(_),m,y,O)}function te(m,_,y,O){return wr(_t(_,m.length-y),m,y,O)}s.prototype.write=function(_,y,O,M){if(y===void 0)M="utf8",O=this.length,y=0;else if(O===void 0&&typeof y=="string")M=y,O=this.length,y=0;else if(isFinite(y))y=y>>>0,isFinite(O)?(O=O>>>0,M===void 0&&(M="utf8")):(M=O,O=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const $=this.length-y;if((O===void 0||O>$)&&(O=$),_.length>0&&(O<0||y<0)||y>this.length)throw new RangeError("Attempt to write outside buffer bounds");M||(M="utf8");let L=!1;for(;;)switch(M){case"hex":return re(this,_,y,O);case"utf8":case"utf-8":return k(this,_,y,O);case"ascii":case"latin1":case"binary":return ee(this,_,y,O);case"base64":return X(this,_,y,O);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return te(this,_,y,O);default:if(L)throw new TypeError("Unknown encoding: "+M);M=(""+M).toLowerCase(),L=!0}},s.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function I(m,_,y){return _===0&&y===m.length?e.fromByteArray(m):e.fromByteArray(m.slice(_,y))}function x(m,_,y){y=Math.min(m.length,y);const O=[];let M=_;for(;M<y;){const $=m[M];let L=null,Ne=$>239?4:$>223?3:$>191?2:1;if(M+Ne<=y){let wt,dt,Ot,et;switch(Ne){case 1:$<128&&(L=$);break;case 2:wt=m[M+1],(wt&192)===128&&(et=($&31)<<6|wt&63,et>127&&(L=et));break;case 3:wt=m[M+1],dt=m[M+2],(wt&192)===128&&(dt&192)===128&&(et=($&15)<<12|(wt&63)<<6|dt&63,et>2047&&(et<55296||et>57343)&&(L=et));break;case 4:wt=m[M+1],dt=m[M+2],Ot=m[M+3],(wt&192)===128&&(dt&192)===128&&(Ot&192)===128&&(et=($&15)<<18|(wt&63)<<12|(dt&63)<<6|Ot&63,et>65535&&et<1114112&&(L=et))}}L===null?(L=65533,Ne=1):L>65535&&(L-=65536,O.push(L>>>10&1023|55296),L=56320|L&1023),O.push(L),M+=Ne}return V(O)}const A=4096;function V(m){const _=m.length;if(_<=A)return String.fromCharCode.apply(String,m);let y="",O=0;for(;O<_;)y+=String.fromCharCode.apply(String,m.slice(O,O+=A));return y}function G(m,_,y){let O="";y=Math.min(m.length,y);for(let M=_;M<y;++M)O+=String.fromCharCode(m[M]&127);return O}function J(m,_,y){let O="";y=Math.min(m.length,y);for(let M=_;M<y;++M)O+=String.fromCharCode(m[M]);return O}function H(m,_,y){const O=m.length;(!_||_<0)&&(_=0),(!y||y<0||y>O)&&(y=O);let M="";for(let $=_;$<y;++$)M+=ul[m[$]];return M}function Y(m,_,y){const O=m.slice(_,y);let M="";for(let $=0;$<O.length-1;$+=2)M+=String.fromCharCode(O[$]+O[$+1]*256);return M}s.prototype.slice=function(_,y){const O=this.length;_=~~_,y=y===void 0?O:~~y,_<0?(_+=O,_<0&&(_=0)):_>O&&(_=O),y<0?(y+=O,y<0&&(y=0)):y>O&&(y=O),y<_&&(y=_);const M=this.subarray(_,y);return Object.setPrototypeOf(M,s.prototype),M};function Q(m,_,y){if(m%1!==0||m<0)throw new RangeError("offset is not uint");if(m+_>y)throw new RangeError("Trying to access beyond buffer length")}s.prototype.readUintLE=s.prototype.readUIntLE=function(_,y,O){_=_>>>0,y=y>>>0,O||Q(_,y,this.length);let M=this[_],$=1,L=0;for(;++L<y&&($*=256);)M+=this[_+L]*$;return M},s.prototype.readUintBE=s.prototype.readUIntBE=function(_,y,O){_=_>>>0,y=y>>>0,O||Q(_,y,this.length);let M=this[_+--y],$=1;for(;y>0&&($*=256);)M+=this[_+--y]*$;return M},s.prototype.readUint8=s.prototype.readUInt8=function(_,y){return _=_>>>0,y||Q(_,1,this.length),this[_]},s.prototype.readUint16LE=s.prototype.readUInt16LE=function(_,y){return _=_>>>0,y||Q(_,2,this.length),this[_]|this[_+1]<<8},s.prototype.readUint16BE=s.prototype.readUInt16BE=function(_,y){return _=_>>>0,y||Q(_,2,this.length),this[_]<<8|this[_+1]},s.prototype.readUint32LE=s.prototype.readUInt32LE=function(_,y){return _=_>>>0,y||Q(_,4,this.length),(this[_]|this[_+1]<<8|this[_+2]<<16)+this[_+3]*16777216},s.prototype.readUint32BE=s.prototype.readUInt32BE=function(_,y){return _=_>>>0,y||Q(_,4,this.length),this[_]*16777216+(this[_+1]<<16|this[_+2]<<8|this[_+3])},s.prototype.readBigUInt64LE=Vn(function(_){_=_>>>0,T(_,"offset");const y=this[_],O=this[_+7];(y===void 0||O===void 0)&&R(_,this.length-8);const M=y+this[++_]*2**8+this[++_]*2**16+this[++_]*2**24,$=this[++_]+this[++_]*2**8+this[++_]*2**16+O*2**24;return BigInt(M)+(BigInt($)<<BigInt(32))}),s.prototype.readBigUInt64BE=Vn(function(_){_=_>>>0,T(_,"offset");const y=this[_],O=this[_+7];(y===void 0||O===void 0)&&R(_,this.length-8);const M=y*2**24+this[++_]*2**16+this[++_]*2**8+this[++_],$=this[++_]*2**24+this[++_]*2**16+this[++_]*2**8+O;return(BigInt(M)<<BigInt(32))+BigInt($)}),s.prototype.readIntLE=function(_,y,O){_=_>>>0,y=y>>>0,O||Q(_,y,this.length);let M=this[_],$=1,L=0;for(;++L<y&&($*=256);)M+=this[_+L]*$;return $*=128,M>=$&&(M-=Math.pow(2,8*y)),M},s.prototype.readIntBE=function(_,y,O){_=_>>>0,y=y>>>0,O||Q(_,y,this.length);let M=y,$=1,L=this[_+--M];for(;M>0&&($*=256);)L+=this[_+--M]*$;return $*=128,L>=$&&(L-=Math.pow(2,8*y)),L},s.prototype.readInt8=function(_,y){return _=_>>>0,y||Q(_,1,this.length),this[_]&128?(255-this[_]+1)*-1:this[_]},s.prototype.readInt16LE=function(_,y){_=_>>>0,y||Q(_,2,this.length);const O=this[_]|this[_+1]<<8;return O&32768?O|4294901760:O},s.prototype.readInt16BE=function(_,y){_=_>>>0,y||Q(_,2,this.length);const O=this[_+1]|this[_]<<8;return O&32768?O|4294901760:O},s.prototype.readInt32LE=function(_,y){return _=_>>>0,y||Q(_,4,this.length),this[_]|this[_+1]<<8|this[_+2]<<16|this[_+3]<<24},s.prototype.readInt32BE=function(_,y){return _=_>>>0,y||Q(_,4,this.length),this[_]<<24|this[_+1]<<16|this[_+2]<<8|this[_+3]},s.prototype.readBigInt64LE=Vn(function(_){_=_>>>0,T(_,"offset");const y=this[_],O=this[_+7];(y===void 0||O===void 0)&&R(_,this.length-8);const M=this[_+4]+this[_+5]*2**8+this[_+6]*2**16+(O<<24);return(BigInt(M)<<BigInt(32))+BigInt(y+this[++_]*2**8+this[++_]*2**16+this[++_]*2**24)}),s.prototype.readBigInt64BE=Vn(function(_){_=_>>>0,T(_,"offset");const y=this[_],O=this[_+7];(y===void 0||O===void 0)&&R(_,this.length-8);const M=(y<<24)+this[++_]*2**16+this[++_]*2**8+this[++_];return(BigInt(M)<<BigInt(32))+BigInt(this[++_]*2**24+this[++_]*2**16+this[++_]*2**8+O)}),s.prototype.readFloatLE=function(_,y){return _=_>>>0,y||Q(_,4,this.length),r.read(this,_,!0,23,4)},s.prototype.readFloatBE=function(_,y){return _=_>>>0,y||Q(_,4,this.length),r.read(this,_,!1,23,4)},s.prototype.readDoubleLE=function(_,y){return _=_>>>0,y||Q(_,8,this.length),r.read(this,_,!0,52,8)},s.prototype.readDoubleBE=function(_,y){return _=_>>>0,y||Q(_,8,this.length),r.read(this,_,!1,52,8)};function le(m,_,y,O,M,$){if(!s.isBuffer(m))throw new TypeError('"buffer" argument must be a Buffer instance');if(_>M||_<$)throw new RangeError('"value" argument is out of bounds');if(y+O>m.length)throw new RangeError("Index out of range")}s.prototype.writeUintLE=s.prototype.writeUIntLE=function(_,y,O,M){if(_=+_,y=y>>>0,O=O>>>0,!M){const Ne=Math.pow(2,8*O)-1;le(this,_,y,O,Ne,0)}let $=1,L=0;for(this[y]=_&255;++L<O&&($*=256);)this[y+L]=_/$&255;return y+O},s.prototype.writeUintBE=s.prototype.writeUIntBE=function(_,y,O,M){if(_=+_,y=y>>>0,O=O>>>0,!M){const Ne=Math.pow(2,8*O)-1;le(this,_,y,O,Ne,0)}let $=O-1,L=1;for(this[y+$]=_&255;--$>=0&&(L*=256);)this[y+$]=_/L&255;return y+O},s.prototype.writeUint8=s.prototype.writeUInt8=function(_,y,O){return _=+_,y=y>>>0,O||le(this,_,y,1,255,0),this[y]=_&255,y+1},s.prototype.writeUint16LE=s.prototype.writeUInt16LE=function(_,y,O){return _=+_,y=y>>>0,O||le(this,_,y,2,65535,0),this[y]=_&255,this[y+1]=_>>>8,y+2},s.prototype.writeUint16BE=s.prototype.writeUInt16BE=function(_,y,O){return _=+_,y=y>>>0,O||le(this,_,y,2,65535,0),this[y]=_>>>8,this[y+1]=_&255,y+2},s.prototype.writeUint32LE=s.prototype.writeUInt32LE=function(_,y,O){return _=+_,y=y>>>0,O||le(this,_,y,4,4294967295,0),this[y+3]=_>>>24,this[y+2]=_>>>16,this[y+1]=_>>>8,this[y]=_&255,y+4},s.prototype.writeUint32BE=s.prototype.writeUInt32BE=function(_,y,O){return _=+_,y=y>>>0,O||le(this,_,y,4,4294967295,0),this[y]=_>>>24,this[y+1]=_>>>16,this[y+2]=_>>>8,this[y+3]=_&255,y+4};function ne(m,_,y,O,M){Se(_,O,M,m,y,7);let $=Number(_&BigInt(4294967295));m[y++]=$,$=$>>8,m[y++]=$,$=$>>8,m[y++]=$,$=$>>8,m[y++]=$;let L=Number(_>>BigInt(32)&BigInt(4294967295));return m[y++]=L,L=L>>8,m[y++]=L,L=L>>8,m[y++]=L,L=L>>8,m[y++]=L,y}function Ce(m,_,y,O,M){Se(_,O,M,m,y,7);let $=Number(_&BigInt(4294967295));m[y+7]=$,$=$>>8,m[y+6]=$,$=$>>8,m[y+5]=$,$=$>>8,m[y+4]=$;let L=Number(_>>BigInt(32)&BigInt(4294967295));return m[y+3]=L,L=L>>8,m[y+2]=L,L=L>>8,m[y+1]=L,L=L>>8,m[y]=L,y+8}s.prototype.writeBigUInt64LE=Vn(function(_,y=0){return ne(this,_,y,BigInt(0),BigInt("0xffffffffffffffff"))}),s.prototype.writeBigUInt64BE=Vn(function(_,y=0){return Ce(this,_,y,BigInt(0),BigInt("0xffffffffffffffff"))}),s.prototype.writeIntLE=function(_,y,O,M){if(_=+_,y=y>>>0,!M){const wt=Math.pow(2,8*O-1);le(this,_,y,O,wt-1,-wt)}let $=0,L=1,Ne=0;for(this[y]=_&255;++$<O&&(L*=256);)_<0&&Ne===0&&this[y+$-1]!==0&&(Ne=1),this[y+$]=(_/L>>0)-Ne&255;return y+O},s.prototype.writeIntBE=function(_,y,O,M){if(_=+_,y=y>>>0,!M){const wt=Math.pow(2,8*O-1);le(this,_,y,O,wt-1,-wt)}let $=O-1,L=1,Ne=0;for(this[y+$]=_&255;--$>=0&&(L*=256);)_<0&&Ne===0&&this[y+$+1]!==0&&(Ne=1),this[y+$]=(_/L>>0)-Ne&255;return y+O},s.prototype.writeInt8=function(_,y,O){return _=+_,y=y>>>0,O||le(this,_,y,1,127,-128),_<0&&(_=255+_+1),this[y]=_&255,y+1},s.prototype.writeInt16LE=function(_,y,O){return _=+_,y=y>>>0,O||le(this,_,y,2,32767,-32768),this[y]=_&255,this[y+1]=_>>>8,y+2},s.prototype.writeInt16BE=function(_,y,O){return _=+_,y=y>>>0,O||le(this,_,y,2,32767,-32768),this[y]=_>>>8,this[y+1]=_&255,y+2},s.prototype.writeInt32LE=function(_,y,O){return _=+_,y=y>>>0,O||le(this,_,y,4,2147483647,-2147483648),this[y]=_&255,this[y+1]=_>>>8,this[y+2]=_>>>16,this[y+3]=_>>>24,y+4},s.prototype.writeInt32BE=function(_,y,O){return _=+_,y=y>>>0,O||le(this,_,y,4,2147483647,-2147483648),_<0&&(_=4294967295+_+1),this[y]=_>>>24,this[y+1]=_>>>16,this[y+2]=_>>>8,this[y+3]=_&255,y+4},s.prototype.writeBigInt64LE=Vn(function(_,y=0){return ne(this,_,y,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),s.prototype.writeBigInt64BE=Vn(function(_,y=0){return Ce(this,_,y,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function Te(m,_,y,O,M,$){if(y+O>m.length)throw new RangeError("Index out of range");if(y<0)throw new RangeError("Index out of range")}function Qe(m,_,y,O,M){return _=+_,y=y>>>0,M||Te(m,_,y,4),r.write(m,_,y,O,23,4),y+4}s.prototype.writeFloatLE=function(_,y,O){return Qe(this,_,y,!0,O)},s.prototype.writeFloatBE=function(_,y,O){return Qe(this,_,y,!1,O)};function U(m,_,y,O,M){return _=+_,y=y>>>0,M||Te(m,_,y,8),r.write(m,_,y,O,52,8),y+8}s.prototype.writeDoubleLE=function(_,y,O){return U(this,_,y,!0,O)},s.prototype.writeDoubleBE=function(_,y,O){return U(this,_,y,!1,O)},s.prototype.copy=function(_,y,O,M){if(!s.isBuffer(_))throw new TypeError("argument should be a Buffer");if(O||(O=0),!M&&M!==0&&(M=this.length),y>=_.length&&(y=_.length),y||(y=0),M>0&&M<O&&(M=O),M===O||_.length===0||this.length===0)return 0;if(y<0)throw new RangeError("targetStart out of bounds");if(O<0||O>=this.length)throw new RangeError("Index out of range");if(M<0)throw new RangeError("sourceEnd out of bounds");M>this.length&&(M=this.length),_.length-y<M-O&&(M=_.length-y+O);const $=M-O;return this===_&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(y,O,M):Uint8Array.prototype.set.call(_,this.subarray(O,M),y),$},s.prototype.fill=function(_,y,O,M){if(typeof _=="string"){if(typeof y=="string"?(M=y,y=0,O=this.length):typeof O=="string"&&(M=O,O=this.length),M!==void 0&&typeof M!="string")throw new TypeError("encoding must be a string");if(typeof M=="string"&&!s.isEncoding(M))throw new TypeError("Unknown encoding: "+M);if(_.length===1){const L=_.charCodeAt(0);(M==="utf8"&&L<128||M==="latin1")&&(_=L)}}else typeof _=="number"?_=_&255:typeof _=="boolean"&&(_=Number(_));if(y<0||this.length<y||this.length<O)throw new RangeError("Out of range index");if(O<=y)return this;y=y>>>0,O=O===void 0?this.length:O>>>0,_||(_=0);let $;if(typeof _=="number")for($=y;$<O;++$)this[$]=_;else{const L=s.isBuffer(_)?_:s.from(_,M),Ne=L.length;if(Ne===0)throw new TypeError('The value "'+_+'" is invalid for argument "value"');for($=0;$<O-y;++$)this[$+y]=L[$%Ne]}return this};const ie={};function F(m,_,y){ie[m]=class extends y{constructor(){super(),Object.defineProperty(this,"message",{value:_.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${m}]`,this.stack,delete this.name}get code(){return m}set code(M){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:M,writable:!0})}toString(){return`${this.name} [${m}]: ${this.message}`}}}F("ERR_BUFFER_OUT_OF_BOUNDS",function(m){return m?`${m} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),F("ERR_INVALID_ARG_TYPE",function(m,_){return`The "${m}" argument must be of type number. Received type ${typeof _}`},TypeError),F("ERR_OUT_OF_RANGE",function(m,_,y){let O=`The value of "${m}" is out of range.`,M=y;return Number.isInteger(y)&&Math.abs(y)>2**32?M=W(String(y)):typeof y=="bigint"&&(M=String(y),(y>BigInt(2)**BigInt(32)||y<-(BigInt(2)**BigInt(32)))&&(M=W(M)),M+="n"),O+=` It must be ${_}. Received ${M}`,O},RangeError);function W(m){let _="",y=m.length;const O=m[0]==="-"?1:0;for(;y>=O+4;y-=3)_=`_${m.slice(y-3,y)}${_}`;return`${m.slice(0,y)}${_}`}function de(m,_,y){T(_,"offset"),(m[_]===void 0||m[_+y]===void 0)&&R(_,m.length-(y+1))}function Se(m,_,y,O,M,$){if(m>y||m<_){const L=typeof _=="bigint"?"n":"";let Ne;throw _===0||_===BigInt(0)?Ne=`>= 0${L} and < 2${L} ** ${($+1)*8}${L}`:Ne=`>= -(2${L} ** ${($+1)*8-1}${L}) and < 2 ** ${($+1)*8-1}${L}`,new ie.ERR_OUT_OF_RANGE("value",Ne,m)}de(O,M,$)}function T(m,_){if(typeof m!="number")throw new ie.ERR_INVALID_ARG_TYPE(_,"number",m)}function R(m,_,y){throw Math.floor(m)!==m?(T(m,y),new ie.ERR_OUT_OF_RANGE("offset","an integer",m)):_<0?new ie.ERR_BUFFER_OUT_OF_BOUNDS:new ie.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${_}`,m)}const q=/[^+/0-9A-Za-z-_]/g;function ge(m){if(m=m.split("=")[0],m=m.trim().replace(q,""),m.length<2)return"";for(;m.length%4!==0;)m=m+"=";return m}function pe(m,_){_=_||1/0;let y;const O=m.length;let M=null;const $=[];for(let L=0;L<O;++L){if(y=m.charCodeAt(L),y>55295&&y<57344){if(!M){if(y>56319){(_-=3)>-1&&$.push(239,191,189);continue}else if(L+1===O){(_-=3)>-1&&$.push(239,191,189);continue}M=y;continue}if(y<56320){(_-=3)>-1&&$.push(239,191,189),M=y;continue}y=(M-55296<<10|y-56320)+65536}else M&&(_-=3)>-1&&$.push(239,191,189);if(M=null,y<128){if((_-=1)<0)break;$.push(y)}else if(y<2048){if((_-=2)<0)break;$.push(y>>6|192,y&63|128)}else if(y<65536){if((_-=3)<0)break;$.push(y>>12|224,y>>6&63|128,y&63|128)}else if(y<1114112){if((_-=4)<0)break;$.push(y>>18|240,y>>12&63|128,y>>6&63|128,y&63|128)}else throw new Error("Invalid code point")}return $}function ut(m){const _=[];for(let y=0;y<m.length;++y)_.push(m.charCodeAt(y)&255);return _}function _t(m,_){let y,O,M;const $=[];for(let L=0;L<m.length&&!((_-=2)<0);++L)y=m.charCodeAt(L),O=y>>8,M=y%256,$.push(M),$.push(O);return $}function tt(m){return e.toByteArray(ge(m))}function wr(m,_,y,O){let M;for(M=0;M<O&&!(M+y>=_.length||M>=m.length);++M)_[M+y]=m[M];return M}function we(m,_){return m instanceof _||m!=null&&m.constructor!=null&&m.constructor.name!=null&&m.constructor.name===_.name}function Yr(m){return m!==m}const ul=function(){const m="0123456789abcdef",_=new Array(256);for(let y=0;y<16;++y){const O=y*16;for(let M=0;M<16;++M)_[O+M]=m[y]+m[M]}return _}();function Vn(m){return typeof BigInt>"u"?Bv:m}function Bv(){throw new Error("BigInt not supported")}})(ki);let VK=class extends Error{constructor(e){if(!Array.isArray(e))throw new TypeError(`Expected input to be an Array, got ${typeof e}`);let r="";for(let n=0;n<e.length;n++)r+=`    ${e[n].stack}
`;super(r),this.name="AggregateError",this.errors=e}};var Mt={AggregateError:VK,ArrayIsArray(t){return Array.isArray(t)},ArrayPrototypeIncludes(t,e){return t.includes(e)},ArrayPrototypeIndexOf(t,e){return t.indexOf(e)},ArrayPrototypeJoin(t,e){return t.join(e)},ArrayPrototypeMap(t,e){return t.map(e)},ArrayPrototypePop(t,e){return t.pop(e)},ArrayPrototypePush(t,e){return t.push(e)},ArrayPrototypeSlice(t,e,r){return t.slice(e,r)},Error,FunctionPrototypeCall(t,e,...r){return t.call(e,...r)},FunctionPrototypeSymbolHasInstance(t,e){return Function.prototype[Symbol.hasInstance].call(t,e)},MathFloor:Math.floor,Number,NumberIsInteger:Number.isInteger,NumberIsNaN:Number.isNaN,NumberMAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER,NumberMIN_SAFE_INTEGER:Number.MIN_SAFE_INTEGER,NumberParseInt:Number.parseInt,ObjectDefineProperties(t,e){return Object.defineProperties(t,e)},ObjectDefineProperty(t,e,r){return Object.defineProperty(t,e,r)},ObjectGetOwnPropertyDescriptor(t,e){return Object.getOwnPropertyDescriptor(t,e)},ObjectKeys(t){return Object.keys(t)},ObjectSetPrototypeOf(t,e){return Object.setPrototypeOf(t,e)},Promise,PromisePrototypeCatch(t,e){return t.catch(e)},PromisePrototypeThen(t,e,r){return t.then(e,r)},PromiseReject(t){return Promise.reject(t)},PromiseResolve(t){return Promise.resolve(t)},ReflectApply:Reflect.apply,RegExpPrototypeTest(t,e){return t.test(e)},SafeSet:Set,String,StringPrototypeSlice(t,e,r){return t.slice(e,r)},StringPrototypeToLowerCase(t){return t.toLowerCase()},StringPrototypeToUpperCase(t){return t.toUpperCase()},StringPrototypeTrim(t){return t.trim()},Symbol,SymbolFor:Symbol.for,SymbolAsyncIterator:Symbol.asyncIterator,SymbolHasInstance:Symbol.hasInstance,SymbolIterator:Symbol.iterator,SymbolDispose:Symbol.dispose||Symbol("Symbol.dispose"),SymbolAsyncDispose:Symbol.asyncDispose||Symbol("Symbol.asyncDispose"),TypedArrayPrototypeSet(t,e,r){return t.set(e,r)},Boolean,Uint8Array},gU={exports:{}},mU={format(t,...e){return t.replace(/%([sdifj])/g,function(...[r,n]){const i=e.shift();return n==="f"?i.toFixed(6):n==="j"?JSON.stringify(i):n==="s"&&typeof i=="object"?`${i.constructor!==Object?i.constructor.name:""} {}`.trim():i.toString()})},inspect(t){switch(typeof t){case"string":if(t.includes("'"))if(t.includes('"')){if(!t.includes("`")&&!t.includes("${"))return`\`${t}\``}else return`"${t}"`;return`'${t}'`;case"number":return isNaN(t)?"NaN":Object.is(t,-0)?String(t):t;case"bigint":return`${String(t)}n`;case"boolean":case"undefined":return String(t);case"object":return"{}"}}};const{format:kK,inspect:Ty}=mU,{AggregateError:HK}=Mt,qK=globalThis.AggregateError||HK,GK=Symbol("kIsNodeError"),WK=["string","function","number","object","Function","Object","boolean","bigint","symbol"],KK=/^([A-Z][a-z0-9]*)+$/,JK="__node_internal_",jg={};function yo(t,e){if(!t)throw new jg.ERR_INTERNAL_ASSERTION(e)}function dT(t){let e="",r=t.length;const n=t[0]==="-"?1:0;for(;r>=n+4;r-=3)e=`_${t.slice(r-3,r)}${e}`;return`${t.slice(0,r)}${e}`}function XK(t,e,r){if(typeof e=="function")return yo(e.length<=r.length,`Code: ${t}; The provided arguments length (${r.length}) does not match the required ones (${e.length}).`),e(...r);const n=(e.match(/%[dfijoOs]/g)||[]).length;return yo(n===r.length,`Code: ${t}; The provided arguments length (${r.length}) does not match the required ones (${n}).`),r.length===0?e:kK(e,...r)}function er(t,e,r){r||(r=Error);class n extends r{constructor(...a){super(XK(t,e,a))}toString(){return`${this.name} [${t}]: ${this.message}`}}Object.defineProperties(n.prototype,{name:{value:r.name,writable:!0,enumerable:!1,configurable:!0},toString:{value(){return`${this.name} [${t}]: ${this.message}`},writable:!0,enumerable:!1,configurable:!0}}),n.prototype.code=t,n.prototype[GK]=!0,jg[t]=n}function fT(t){const e=JK+t.name;return Object.defineProperty(t,"name",{value:e}),t}function ZK(t,e){if(t&&e&&t!==e){if(Array.isArray(e.errors))return e.errors.push(t),e;const r=new qK([e,t],e.message);return r.code=e.code,r}return t||e}let YK=class extends Error{constructor(e="The operation was aborted",r=void 0){if(r!==void 0&&typeof r!="object")throw new jg.ERR_INVALID_ARG_TYPE("options","Object",r);super(e,r),this.code="ABORT_ERR",this.name="AbortError"}};er("ERR_ASSERTION","%s",Error);er("ERR_INVALID_ARG_TYPE",(t,e,r)=>{yo(typeof t=="string","'name' must be a string"),Array.isArray(e)||(e=[e]);let n="The ";t.endsWith(" argument")?n+=`${t} `:n+=`"${t}" ${t.includes(".")?"property":"argument"} `,n+="must be ";const i=[],a=[],o=[];for(const l of e)yo(typeof l=="string","All expected entries have to be of type string"),WK.includes(l)?i.push(l.toLowerCase()):KK.test(l)?a.push(l):(yo(l!=="object",'The value "object" should be written as "Object"'),o.push(l));if(a.length>0){const l=i.indexOf("object");l!==-1&&(i.splice(i,l,1),a.push("Object"))}if(i.length>0){switch(i.length){case 1:n+=`of type ${i[0]}`;break;case 2:n+=`one of type ${i[0]} or ${i[1]}`;break;default:{const l=i.pop();n+=`one of type ${i.join(", ")}, or ${l}`}}(a.length>0||o.length>0)&&(n+=" or ")}if(a.length>0){switch(a.length){case 1:n+=`an instance of ${a[0]}`;break;case 2:n+=`an instance of ${a[0]} or ${a[1]}`;break;default:{const l=a.pop();n+=`an instance of ${a.join(", ")}, or ${l}`}}o.length>0&&(n+=" or ")}switch(o.length){case 0:break;case 1:o[0].toLowerCase()!==o[0]&&(n+="an "),n+=`${o[0]}`;break;case 2:n+=`one of ${o[0]} or ${o[1]}`;break;default:{const l=o.pop();n+=`one of ${o.join(", ")}, or ${l}`}}if(r==null)n+=`. Received ${r}`;else if(typeof r=="function"&&r.name)n+=`. Received function ${r.name}`;else if(typeof r=="object"){var s;if((s=r.constructor)!==null&&s!==void 0&&s.name)n+=`. Received an instance of ${r.constructor.name}`;else{const l=Ty(r,{depth:-1});n+=`. Received ${l}`}}else{let l=Ty(r,{colors:!1});l.length>25&&(l=`${l.slice(0,25)}...`),n+=`. Received type ${typeof r} (${l})`}return n},TypeError);er("ERR_INVALID_ARG_VALUE",(t,e,r="is invalid")=>{let n=Ty(e);return n.length>128&&(n=n.slice(0,128)+"..."),`The ${t.includes(".")?"property":"argument"} '${t}' ${r}. Received ${n}`},TypeError);er("ERR_INVALID_RETURN_VALUE",(t,e,r)=>{var n;const i=r!=null&&(n=r.constructor)!==null&&n!==void 0&&n.name?`instance of ${r.constructor.name}`:`type ${typeof r}`;return`Expected ${t} to be returned from the "${e}" function but got ${i}.`},TypeError);er("ERR_MISSING_ARGS",(...t)=>{yo(t.length>0,"At least one arg needs to be specified");let e;const r=t.length;switch(t=(Array.isArray(t)?t:[t]).map(n=>`"${n}"`).join(" or "),r){case 1:e+=`The ${t[0]} argument`;break;case 2:e+=`The ${t[0]} and ${t[1]} arguments`;break;default:{const n=t.pop();e+=`The ${t.join(", ")}, and ${n} arguments`}break}return`${e} must be specified`},TypeError);er("ERR_OUT_OF_RANGE",(t,e,r)=>{yo(e,'Missing "range" argument');let n;if(Number.isInteger(r)&&Math.abs(r)>2**32)n=dT(String(r));else if(typeof r=="bigint"){n=String(r);const i=BigInt(2)**BigInt(32);(r>i||r<-i)&&(n=dT(n)),n+="n"}else n=Ty(r);return`The value of "${t}" is out of range. It must be ${e}. Received ${n}`},RangeError);er("ERR_MULTIPLE_CALLBACK","Callback called multiple times",Error);er("ERR_METHOD_NOT_IMPLEMENTED","The %s method is not implemented",Error);er("ERR_STREAM_ALREADY_FINISHED","Cannot call %s after a stream was finished",Error);er("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable",Error);er("ERR_STREAM_DESTROYED","Cannot call %s after a stream was destroyed",Error);er("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError);er("ERR_STREAM_PREMATURE_CLOSE","Premature close",Error);er("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF",Error);er("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event",Error);er("ERR_STREAM_WRITE_AFTER_END","write after end",Error);er("ERR_UNKNOWN_ENCODING","Unknown encoding: %s",TypeError);var mr={AbortError:YK,aggregateTwoErrors:fT(ZK),hideStackFrames:fT,codes:jg},Ol={exports:{}},hT;function qc(){if(hT)return Ol.exports;hT=1;const{AbortController:t,AbortSignal:e}=typeof self<"u"?self:typeof window<"u"?window:void 0;return Ol.exports=t,Ol.exports.AbortSignal=e,Ol.exports.default=t,Ol.exports}var $P={exports:{}},Gs=typeof Reflect=="object"?Reflect:null,pT=Gs&&typeof Gs.apply=="function"?Gs.apply:function(e,r,n){return Function.prototype.apply.call(e,r,n)},K_;Gs&&typeof Gs.ownKeys=="function"?K_=Gs.ownKeys:Object.getOwnPropertySymbols?K_=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:K_=function(e){return Object.getOwnPropertyNames(e)};function QK(t){console&&console.warn&&console.warn(t)}var vU=Number.isNaN||function(e){return e!==e};function st(){st.init.call(this)}$P.exports=st;$P.exports.once=nJ;st.EventEmitter=st;st.prototype._events=void 0;st.prototype._eventsCount=0;st.prototype._maxListeners=void 0;var _T=10;function Cg(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(st,"defaultMaxListeners",{enumerable:!0,get:function(){return _T},set:function(t){if(typeof t!="number"||t<0||vU(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");_T=t}});st.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};st.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||vU(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function wU(t){return t._maxListeners===void 0?st.defaultMaxListeners:t._maxListeners}st.prototype.getMaxListeners=function(){return wU(this)};st.prototype.emit=function(e){for(var r=[],n=1;n<arguments.length;n++)r.push(arguments[n]);var i=e==="error",a=this._events;if(a!==void 0)i=i&&a.error===void 0;else if(!i)return!1;if(i){var o;if(r.length>0&&(o=r[0]),o instanceof Error)throw o;var s=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw s.context=o,s}var l=a[e];if(l===void 0)return!1;if(typeof l=="function")pT(l,this,r);else for(var c=l.length,d=jU(l,c),n=0;n<c;++n)pT(d[n],this,r);return!0};function OU(t,e,r,n){var i,a,o;if(Cg(r),a=t._events,a===void 0?(a=t._events=Object.create(null),t._eventsCount=0):(a.newListener!==void 0&&(t.emit("newListener",e,r.listener?r.listener:r),a=t._events),o=a[e]),o===void 0)o=a[e]=r,++t._eventsCount;else if(typeof o=="function"?o=a[e]=n?[r,o]:[o,r]:n?o.unshift(r):o.push(r),i=wU(t),i>0&&o.length>i&&!o.warned){o.warned=!0;var s=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");s.name="MaxListenersExceededWarning",s.emitter=t,s.type=e,s.count=o.length,QK(s)}return t}st.prototype.addListener=function(e,r){return OU(this,e,r,!1)};st.prototype.on=st.prototype.addListener;st.prototype.prependListener=function(e,r){return OU(this,e,r,!0)};function eJ(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function SU(t,e,r){var n={fired:!1,wrapFn:void 0,target:t,type:e,listener:r},i=eJ.bind(n);return i.listener=r,n.wrapFn=i,i}st.prototype.once=function(e,r){return Cg(r),this.on(e,SU(this,e,r)),this};st.prototype.prependOnceListener=function(e,r){return Cg(r),this.prependListener(e,SU(this,e,r)),this};st.prototype.removeListener=function(e,r){var n,i,a,o,s;if(Cg(r),i=this._events,i===void 0)return this;if(n=i[e],n===void 0)return this;if(n===r||n.listener===r)--this._eventsCount===0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||r));else if(typeof n!="function"){for(a=-1,o=n.length-1;o>=0;o--)if(n[o]===r||n[o].listener===r){s=n[o].listener,a=o;break}if(a<0)return this;a===0?n.shift():tJ(n,a),n.length===1&&(i[e]=n[0]),i.removeListener!==void 0&&this.emit("removeListener",e,s||r)}return this};st.prototype.off=st.prototype.removeListener;st.prototype.removeAllListeners=function(e){var r,n,i;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[e]),this;if(arguments.length===0){var a=Object.keys(n),o;for(i=0;i<a.length;++i)o=a[i],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(r=n[e],typeof r=="function")this.removeListener(e,r);else if(r!==void 0)for(i=r.length-1;i>=0;i--)this.removeListener(e,r[i]);return this};function EU(t,e,r){var n=t._events;if(n===void 0)return[];var i=n[e];return i===void 0?[]:typeof i=="function"?r?[i.listener||i]:[i]:r?rJ(i):jU(i,i.length)}st.prototype.listeners=function(e){return EU(this,e,!0)};st.prototype.rawListeners=function(e){return EU(this,e,!1)};st.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):PU.call(t,e)};st.prototype.listenerCount=PU;function PU(t){var e=this._events;if(e!==void 0){var r=e[t];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}st.prototype.eventNames=function(){return this._eventsCount>0?K_(this._events):[]};function jU(t,e){for(var r=new Array(e),n=0;n<e;++n)r[n]=t[n];return r}function tJ(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function rJ(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}function nJ(t,e){return new Promise(function(r,n){function i(o){t.removeListener(e,a),n(o)}function a(){typeof t.removeListener=="function"&&t.removeListener("error",i),r([].slice.call(arguments))}CU(t,e,a,{once:!0}),e!=="error"&&iJ(t,i,{once:!0})})}function iJ(t,e,r){typeof t.on=="function"&&CU(t,"error",e,r)}function CU(t,e,r,n){if(typeof t.on=="function")n.once?t.once(e,r):t.on(e,r);else if(typeof t.addEventListener=="function")t.addEventListener(e,function i(a){n.once&&t.removeEventListener(e,i),r(a)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}var Mg=$P.exports;(function(t){const e=ki,{format:r,inspect:n}=mU,{codes:{ERR_INVALID_ARG_TYPE:i}}=mr,{kResistStopPropagation:a,AggregateError:o,SymbolDispose:s}=Mt,l=globalThis.AbortSignal||qc().AbortSignal,c=globalThis.AbortController||qc().AbortController,d=Object.getPrototypeOf(async function(){}).constructor,f=globalThis.Blob||e.Blob,h=typeof f<"u"?function(v){return v instanceof f}:function(v){return!1},p=(g,v)=>{if(g!==void 0&&(g===null||typeof g!="object"||!("aborted"in g)))throw new i(v,"AbortSignal",g)},b=(g,v)=>{if(typeof g!="function")throw new i(v,"Function",g)};t.exports={AggregateError:o,kEmptyObject:Object.freeze({}),once(g){let v=!1;return function(...E){v||(v=!0,g.apply(this,E))}},createDeferredPromise:function(){let g,v;return{promise:new Promise((C,S)=>{g=C,v=S}),resolve:g,reject:v}},promisify(g){return new Promise((v,E)=>{g((C,...S)=>C?E(C):v(...S))})},debuglog(){return function(){}},format:r,inspect:n,types:{isAsyncFunction(g){return g instanceof d},isArrayBufferView(g){return ArrayBuffer.isView(g)}},isBlob:h,deprecate(g,v){return g},addAbortListener:Mg.addAbortListener||function(v,E){if(v===void 0)throw new i("signal","AbortSignal",v);p(v,"signal"),b(E,"listener");let C;return v.aborted?queueMicrotask(()=>E()):(v.addEventListener("abort",E,{__proto__:null,once:!0,[a]:!0}),C=()=>{v.removeEventListener("abort",E)}),{__proto__:null,[s](){var S;(S=C)===null||S===void 0||S()}}},AbortSignalAny:l.any||function(v){if(v.length===1)return v[0];const E=new c,C=()=>E.abort();return v.forEach(S=>{p(S,"signals"),S.addEventListener("abort",C,{once:!0})}),E.signal.addEventListener("abort",()=>{v.forEach(S=>S.removeEventListener("abort",C))},{once:!0}),E.signal}},t.exports.promisify.custom=Symbol.for("nodejs.util.promisify.custom")})(gU);var Ir=gU.exports,IP={};const{ArrayIsArray:MU,ArrayPrototypeIncludes:aJ,ArrayPrototypeJoin:oJ,ArrayPrototypeMap:sJ,NumberIsInteger:xP,NumberIsNaN:mje,NumberMAX_SAFE_INTEGER:uJ,NumberMIN_SAFE_INTEGER:lJ,NumberParseInt:vje,ObjectPrototypeHasOwnProperty:cJ,RegExpPrototypeExec:wje,String:dJ,StringPrototypeToUpperCase:Oje,StringPrototypeTrim:Sje}=Mt,{hideStackFrames:yn,codes:{ERR_SOCKET_BAD_PORT:Eje,ERR_INVALID_ARG_TYPE:bn,ERR_INVALID_ARG_VALUE:TU,ERR_OUT_OF_RANGE:gu,ERR_UNKNOWN_SIGNAL:Pje}}=mr,{normalizeEncoding:jje}=Ir,{isAsyncFunction:fJ,isArrayBufferView:hJ}=Ir.types,pJ=yn((t,e,r=lJ,n=uJ)=>{if(typeof t!="number")throw new bn(e,"number",t);if(!xP(t))throw new gu(e,"an integer",t);if(t<r||t>n)throw new gu(e,`>= ${r} && <= ${n}`,t)});yn((t,e,r=-2147483648,n=2147483647)=>{if(typeof t!="number")throw new bn(e,"number",t);if(!xP(t))throw new gu(e,"an integer",t);if(t<r||t>n)throw new gu(e,`>= ${r} && <= ${n}`,t)});yn((t,e,r=!1)=>{if(typeof t!="number")throw new bn(e,"number",t);if(!xP(t))throw new gu(e,"an integer",t);const n=r?1:0,i=4294967295;if(t<n||t>i)throw new gu(e,`>= ${n} && <= ${i}`,t)});yn((t,e,r)=>{if(!aJ(r,t)){const i="must be one of: "+oJ(sJ(r,a=>typeof a=="string"?`'${a}'`:dJ(a)),", ");throw new TU(e,t,i)}});function _J(t,e){if(typeof t!="boolean")throw new bn(e,"boolean",t)}function kw(t,e,r){return t==null||!cJ(t,e)?r:t[e]}const yJ=yn((t,e,r=null)=>{const n=kw(r,"allowArray",!1),i=kw(r,"allowFunction",!1);if(!kw(r,"nullable",!1)&&t===null||!n&&MU(t)||typeof t!="object"&&(!i||typeof t!="function"))throw new bn(e,"Object",t)});yn((t,e)=>{if(t!=null&&typeof t!="object"&&typeof t!="function")throw new bn(e,"a dictionary",t)});yn((t,e,r=0)=>{if(!MU(t))throw new bn(e,"Array",t);if(t.length<r){const n=`must be longer than ${r}`;throw new TU(e,t,n)}});yn((t,e="buffer")=>{if(!hJ(t))throw new bn(e,["Buffer","TypedArray","DataView"],t)});const bJ=yn((t,e)=>{if(t!==void 0&&(t===null||typeof t!="object"||!("aborted"in t)))throw new bn(e,"AbortSignal",t)}),gJ=yn((t,e)=>{if(typeof t!="function")throw new bn(e,"Function",t)});yn((t,e)=>{if(typeof t!="function"||fJ(t))throw new bn(e,"Function",t)});yn((t,e)=>{if(t!==void 0)throw new bn(e,"undefined",t)});var hd={validateBoolean:_J,validateFunction:gJ,validateInteger:pJ,validateObject:yJ,validateAbortSignal:bJ},DP={exports:{}},RU={exports:{}},It=RU.exports={},Zn,Yn;function bS(){throw new Error("setTimeout has not been defined")}function gS(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?Zn=setTimeout:Zn=bS}catch{Zn=bS}try{typeof clearTimeout=="function"?Yn=clearTimeout:Yn=gS}catch{Yn=gS}})();function AU(t){if(Zn===setTimeout)return setTimeout(t,0);if((Zn===bS||!Zn)&&setTimeout)return Zn=setTimeout,setTimeout(t,0);try{return Zn(t,0)}catch{try{return Zn.call(null,t,0)}catch{return Zn.call(this,t,0)}}}function mJ(t){if(Yn===clearTimeout)return clearTimeout(t);if((Yn===gS||!Yn)&&clearTimeout)return Yn=clearTimeout,clearTimeout(t);try{return Yn(t)}catch{try{return Yn.call(null,t)}catch{return Yn.call(this,t)}}}var Ri=[],Ws=!1,co,J_=-1;function vJ(){!Ws||!co||(Ws=!1,co.length?Ri=co.concat(Ri):J_=-1,Ri.length&&$U())}function $U(){if(!Ws){var t=AU(vJ);Ws=!0;for(var e=Ri.length;e;){for(co=Ri,Ri=[];++J_<e;)co&&co[J_].run();J_=-1,e=Ri.length}co=null,Ws=!1,mJ(t)}}It.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];Ri.push(new IU(t,e)),Ri.length===1&&!Ws&&AU($U)};function IU(t,e){this.fun=t,this.array=e}IU.prototype.run=function(){this.fun.apply(null,this.array)};It.title="browser";It.browser=!0;It.env={};It.argv=[];It.version="";It.versions={};function Hi(){}It.on=Hi;It.addListener=Hi;It.once=Hi;It.off=Hi;It.removeListener=Hi;It.removeAllListeners=Hi;It.emit=Hi;It.prependListener=Hi;It.prependOnceListener=Hi;It.listeners=function(t){return[]};It.binding=function(t){throw new Error("process.binding is not supported")};It.cwd=function(){return"/"};It.chdir=function(t){throw new Error("process.chdir is not supported")};It.umask=function(){return 0};var Mo=RU.exports;const{SymbolAsyncIterator:yT,SymbolIterator:bT,SymbolFor:To}=Mt,xU=To("nodejs.stream.destroyed"),wJ=To("nodejs.stream.errored"),gT=To("nodejs.stream.readable"),mT=To("nodejs.stream.writable"),OJ=To("nodejs.stream.disturbed"),SJ=To("nodejs.webstream.isClosedPromise"),EJ=To("nodejs.webstream.controllerErrorFunction");function NP(t,e=!1){var r;return!!(t&&typeof t.pipe=="function"&&typeof t.on=="function"&&(!e||typeof t.pause=="function"&&typeof t.resume=="function")&&(!t._writableState||((r=t._readableState)===null||r===void 0?void 0:r.readable)!==!1)&&(!t._writableState||t._readableState))}function Tg(t){var e;return!!(t&&typeof t.write=="function"&&typeof t.on=="function"&&(!t._readableState||((e=t._writableState)===null||e===void 0?void 0:e.writable)!==!1))}function PJ(t){return!!(t&&typeof t.pipe=="function"&&t._readableState&&typeof t.on=="function"&&typeof t.write=="function")}function di(t){return t&&(t._readableState||t._writableState||typeof t.write=="function"&&typeof t.on=="function"||typeof t.pipe=="function"&&typeof t.on=="function")}function DU(t){return!!(t&&!di(t)&&typeof t.pipeThrough=="function"&&typeof t.getReader=="function"&&typeof t.cancel=="function")}function NU(t){return!!(t&&!di(t)&&typeof t.getWriter=="function"&&typeof t.abort=="function")}function zU(t){return!!(t&&!di(t)&&typeof t.readable=="object"&&typeof t.writable=="object")}function jJ(t){return DU(t)||NU(t)||zU(t)}function CJ(t,e){return t==null?!1:e===!0?typeof t[yT]=="function":e===!1?typeof t[bT]=="function":typeof t[yT]=="function"||typeof t[bT]=="function"}function Rg(t){if(!di(t))return null;const e=t._writableState,r=t._readableState,n=e||r;return!!(t.destroyed||t[xU]||n!=null&&n.destroyed)}function MJ(t){if(!Tg(t))return null;if(t.writableEnded===!0)return!0;const e=t._writableState;return e!=null&&e.errored?!1:typeof e?.ended!="boolean"?null:e.ended}function TJ(t,e){if(!Tg(t))return null;if(t.writableFinished===!0)return!0;const r=t._writableState;return r!=null&&r.errored?!1:typeof r?.finished!="boolean"?null:!!(r.finished||e===!1&&r.ended===!0&&r.length===0)}function BU(t,e){if(!NP(t))return null;const r=t._readableState;return r!=null&&r.errored?!1:typeof r?.endEmitted!="boolean"?null:!!(r.endEmitted||e===!1&&r.ended===!0&&r.length===0)}function UU(t){return t&&t[gT]!=null?t[gT]:typeof t?.readable!="boolean"?null:Rg(t)?!1:NP(t)&&t.readable&&!BU(t)}function FU(t){return t&&t[mT]!=null?t[mT]:typeof t?.writable!="boolean"?null:Rg(t)?!1:Tg(t)&&t.writable&&!MJ(t)}function RJ(t,e){return di(t)?Rg(t)?!0:!(e?.readable!==!1&&UU(t)||e?.writable!==!1&&FU(t)):null}function AJ(t){var e,r;return di(t)?t.writableErrored?t.writableErrored:(e=(r=t._writableState)===null||r===void 0?void 0:r.errored)!==null&&e!==void 0?e:null:null}function $J(t){var e,r;return di(t)?t.readableErrored?t.readableErrored:(e=(r=t._readableState)===null||r===void 0?void 0:r.errored)!==null&&e!==void 0?e:null:null}function IJ(t){if(!di(t))return null;if(typeof t.closed=="boolean")return t.closed;const e=t._writableState,r=t._readableState;return typeof e?.closed=="boolean"||typeof r?.closed=="boolean"?e?.closed||r?.closed:typeof t._closed=="boolean"&&LU(t)?t._closed:null}function LU(t){return typeof t._closed=="boolean"&&typeof t._defaultKeepAlive=="boolean"&&typeof t._removedConnection=="boolean"&&typeof t._removedContLen=="boolean"}function xJ(t){return typeof t._sent100=="boolean"&&LU(t)}function DJ(t){var e;return typeof t._consuming=="boolean"&&typeof t._dumped=="boolean"&&((e=t.req)===null||e===void 0?void 0:e.upgradeOrConnect)===void 0}function NJ(t){if(!di(t))return null;const e=t._writableState,r=t._readableState,n=e||r;return!n&&xJ(t)||!!(n&&n.autoDestroy&&n.emitClose&&n.closed===!1)}function zJ(t){var e;return!!(t&&((e=t[OJ])!==null&&e!==void 0?e:t.readableDidRead||t.readableAborted))}function BJ(t){var e,r,n,i,a,o,s,l,c,d;return!!(t&&((e=(r=(n=(i=(a=(o=t[wJ])!==null&&o!==void 0?o:t.readableErrored)!==null&&a!==void 0?a:t.writableErrored)!==null&&i!==void 0?i:(s=t._readableState)===null||s===void 0?void 0:s.errorEmitted)!==null&&n!==void 0?n:(l=t._writableState)===null||l===void 0?void 0:l.errorEmitted)!==null&&r!==void 0?r:(c=t._readableState)===null||c===void 0?void 0:c.errored)!==null&&e!==void 0?e:!((d=t._writableState)===null||d===void 0)&&d.errored))}var qi={isDestroyed:Rg,kIsDestroyed:xU,isDisturbed:zJ,isErrored:BJ,isReadable:UU,kIsClosedPromise:SJ,kControllerErrorFunction:EJ,isClosed:IJ,isDuplexNodeStream:PJ,isFinished:RJ,isIterable:CJ,isReadableNodeStream:NP,isReadableStream:DU,isReadableFinished:BU,isReadableErrored:$J,isNodeStream:di,isWebStream:jJ,isWritable:FU,isWritableNodeStream:Tg,isWritableStream:NU,isWritableFinished:TJ,isWritableErrored:AJ,isServerRequest:DJ,willEmitClose:NJ,isTransformStream:zU};const ha=Mo,{AbortError:VU,codes:UJ}=mr,{ERR_INVALID_ARG_TYPE:FJ,ERR_STREAM_PREMATURE_CLOSE:vT}=UJ,{kEmptyObject:mS,once:vS}=Ir,{validateAbortSignal:LJ,validateFunction:VJ,validateObject:kJ,validateBoolean:HJ}=hd,{Promise:qJ,PromisePrototypeThen:GJ,SymbolDispose:kU}=Mt,{isClosed:WJ,isReadable:wT,isReadableNodeStream:Hw,isReadableStream:KJ,isReadableFinished:OT,isReadableErrored:ST,isWritable:ET,isWritableNodeStream:PT,isWritableStream:JJ,isWritableFinished:jT,isWritableErrored:CT,isNodeStream:XJ,willEmitClose:ZJ,kIsClosedPromise:YJ}=qi;let Ks;function QJ(t){return t.setHeader&&typeof t.abort=="function"}const wS=()=>{};function HU(t,e,r){var n,i;if(arguments.length===2?(r=e,e=mS):e==null?e=mS:kJ(e,"options"),VJ(r,"callback"),LJ(e.signal,"options.signal"),r=vS(r),KJ(t)||JJ(t))return eX(t,e,r);if(!XJ(t))throw new FJ("stream",["ReadableStream","WritableStream","Stream"],t);const a=(n=e.readable)!==null&&n!==void 0?n:Hw(t),o=(i=e.writable)!==null&&i!==void 0?i:PT(t),s=t._writableState,l=t._readableState,c=()=>{t.writable||h()};let d=ZJ(t)&&Hw(t)===a&&PT(t)===o,f=jT(t,!1);const h=()=>{f=!0,t.destroyed&&(d=!1),!(d&&(!t.readable||a))&&(!a||p)&&r.call(t)};let p=OT(t,!1);const b=()=>{p=!0,t.destroyed&&(d=!1),!(d&&(!t.writable||o))&&(!o||f)&&r.call(t)},g=D=>{r.call(t,D)};let v=WJ(t);const E=()=>{v=!0;const D=CT(t)||ST(t);if(D&&typeof D!="boolean")return r.call(t,D);if(a&&!p&&Hw(t,!0)&&!OT(t,!1))return r.call(t,new vT);if(o&&!f&&!jT(t,!1))return r.call(t,new vT);r.call(t)},C=()=>{v=!0;const D=CT(t)||ST(t);if(D&&typeof D!="boolean")return r.call(t,D);r.call(t)},S=()=>{t.req.on("finish",h)};QJ(t)?(t.on("complete",h),d||t.on("abort",E),t.req?S():t.on("request",S)):o&&!s&&(t.on("end",c),t.on("close",c)),!d&&typeof t.aborted=="boolean"&&t.on("aborted",E),t.on("end",b),t.on("finish",h),e.error!==!1&&t.on("error",g),t.on("close",E),v?ha.nextTick(E):s!=null&&s.errorEmitted||l!=null&&l.errorEmitted?d||ha.nextTick(C):(!a&&(!d||wT(t))&&(f||ET(t)===!1)||!o&&(!d||ET(t))&&(p||wT(t)===!1)||l&&t.req&&t.aborted)&&ha.nextTick(C);const N=()=>{r=wS,t.removeListener("aborted",E),t.removeListener("complete",h),t.removeListener("abort",E),t.removeListener("request",S),t.req&&t.req.removeListener("finish",h),t.removeListener("end",c),t.removeListener("close",c),t.removeListener("finish",h),t.removeListener("end",b),t.removeListener("error",g),t.removeListener("close",E)};if(e.signal&&!v){const D=()=>{const Z=r;N(),Z.call(t,new VU(void 0,{cause:e.signal.reason}))};if(e.signal.aborted)ha.nextTick(D);else{Ks=Ks||Ir.addAbortListener;const Z=Ks(e.signal,D),se=r;r=vS((...re)=>{Z[kU](),se.apply(t,re)})}}return N}function eX(t,e,r){let n=!1,i=wS;if(e.signal)if(i=()=>{n=!0,r.call(t,new VU(void 0,{cause:e.signal.reason}))},e.signal.aborted)ha.nextTick(i);else{Ks=Ks||Ir.addAbortListener;const o=Ks(e.signal,i),s=r;r=vS((...l)=>{o[kU](),s.apply(t,l)})}const a=(...o)=>{n||ha.nextTick(()=>r.apply(t,o))};return GJ(t[YJ].promise,a,a),wS}function tX(t,e){var r;let n=!1;return e===null&&(e=mS),(r=e)!==null&&r!==void 0&&r.cleanup&&(HJ(e.cleanup,"cleanup"),n=e.cleanup),new qJ((i,a)=>{const o=HU(t,e,s=>{n&&o(),s?a(s):i()})})}DP.exports=HU;DP.exports.finished=tX;var xa=DP.exports;const ai=Mo,{aggregateTwoErrors:rX,codes:{ERR_MULTIPLE_CALLBACK:nX},AbortError:iX}=mr,{Symbol:qU}=Mt,{kIsDestroyed:aX,isDestroyed:oX,isFinished:sX,isServerRequest:uX}=qi,GU=qU("kDestroy"),OS=qU("kConstruct");function WU(t,e,r){t&&(t.stack,e&&!e.errored&&(e.errored=t),r&&!r.errored&&(r.errored=t))}function lX(t,e){const r=this._readableState,n=this._writableState,i=n||r;return n!=null&&n.destroyed||r!=null&&r.destroyed?(typeof e=="function"&&e(),this):(WU(t,n,r),n&&(n.destroyed=!0),r&&(r.destroyed=!0),i.constructed?MT(this,t,e):this.once(GU,function(a){MT(this,rX(a,t),e)}),this)}function MT(t,e,r){let n=!1;function i(a){if(n)return;n=!0;const o=t._readableState,s=t._writableState;WU(a,s,o),s&&(s.closed=!0),o&&(o.closed=!0),typeof r=="function"&&r(a),a?ai.nextTick(cX,t,a):ai.nextTick(KU,t)}try{t._destroy(e||null,i)}catch(a){i(a)}}function cX(t,e){SS(t,e),KU(t)}function KU(t){const e=t._readableState,r=t._writableState;r&&(r.closeEmitted=!0),e&&(e.closeEmitted=!0),(r!=null&&r.emitClose||e!=null&&e.emitClose)&&t.emit("close")}function SS(t,e){const r=t._readableState,n=t._writableState;n!=null&&n.errorEmitted||r!=null&&r.errorEmitted||(n&&(n.errorEmitted=!0),r&&(r.errorEmitted=!0),t.emit("error",e))}function dX(){const t=this._readableState,e=this._writableState;t&&(t.constructed=!0,t.closed=!1,t.closeEmitted=!1,t.destroyed=!1,t.errored=null,t.errorEmitted=!1,t.reading=!1,t.ended=t.readable===!1,t.endEmitted=t.readable===!1),e&&(e.constructed=!0,e.destroyed=!1,e.closed=!1,e.closeEmitted=!1,e.errored=null,e.errorEmitted=!1,e.finalCalled=!1,e.prefinished=!1,e.ended=e.writable===!1,e.ending=e.writable===!1,e.finished=e.writable===!1)}function ES(t,e,r){const n=t._readableState,i=t._writableState;if(i!=null&&i.destroyed||n!=null&&n.destroyed)return this;n!=null&&n.autoDestroy||i!=null&&i.autoDestroy?t.destroy(e):e&&(e.stack,i&&!i.errored&&(i.errored=e),n&&!n.errored&&(n.errored=e),r?ai.nextTick(SS,t,e):SS(t,e))}function fX(t,e){if(typeof t._construct!="function")return;const r=t._readableState,n=t._writableState;r&&(r.constructed=!1),n&&(n.constructed=!1),t.once(OS,e),!(t.listenerCount(OS)>1)&&ai.nextTick(hX,t)}function hX(t){let e=!1;function r(n){if(e){ES(t,n??new nX);return}e=!0;const i=t._readableState,a=t._writableState,o=a||i;i&&(i.constructed=!0),a&&(a.constructed=!0),o.destroyed?t.emit(GU,n):n?ES(t,n,!0):ai.nextTick(pX,t)}try{t._construct(n=>{ai.nextTick(r,n)})}catch(n){ai.nextTick(r,n)}}function pX(t){t.emit(OS)}function TT(t){return t?.setHeader&&typeof t.abort=="function"}function JU(t){t.emit("close")}function _X(t,e){t.emit("error",e),ai.nextTick(JU,t)}function yX(t,e){!t||oX(t)||(!e&&!sX(t)&&(e=new iX),uX(t)?(t.socket=null,t.destroy(e)):TT(t)?t.abort():TT(t.req)?t.req.abort():typeof t.destroy=="function"?t.destroy(e):typeof t.close=="function"?t.close():e?ai.nextTick(_X,t,e):ai.nextTick(JU,t),t.destroyed||(t[aX]=!0))}var Uu={construct:fX,destroyer:yX,destroy:lX,undestroy:dX,errorOrDestroy:ES};const{ArrayIsArray:bX,ObjectSetPrototypeOf:XU}=Mt,{EventEmitter:Ag}=Mg;function $g(t){Ag.call(this,t)}XU($g.prototype,Ag.prototype);XU($g,Ag);$g.prototype.pipe=function(t,e){const r=this;function n(d){t.writable&&t.write(d)===!1&&r.pause&&r.pause()}r.on("data",n);function i(){r.readable&&r.resume&&r.resume()}t.on("drain",i),!t._isStdio&&(!e||e.end!==!1)&&(r.on("end",o),r.on("close",s));let a=!1;function o(){a||(a=!0,t.end())}function s(){a||(a=!0,typeof t.destroy=="function"&&t.destroy())}function l(d){c(),Ag.listenerCount(this,"error")===0&&this.emit("error",d)}PS(r,"error",l),PS(t,"error",l);function c(){r.removeListener("data",n),t.removeListener("drain",i),r.removeListener("end",o),r.removeListener("close",s),r.removeListener("error",l),t.removeListener("error",l),r.removeListener("end",c),r.removeListener("close",c),t.removeListener("close",c)}return r.on("end",c),r.on("close",c),t.on("close",c),t.emit("pipe",r),t};function PS(t,e,r){if(typeof t.prependListener=="function")return t.prependListener(e,r);!t._events||!t._events[e]?t.on(e,r):bX(t._events[e])?t._events[e].unshift(r):t._events[e]=[r,t._events[e]]}var zP={Stream:$g,prependListener:PS},ZU={exports:{}};(function(t){const{SymbolDispose:e}=Mt,{AbortError:r,codes:n}=mr,{isNodeStream:i,isWebStream:a,kControllerErrorFunction:o}=qi,s=xa,{ERR_INVALID_ARG_TYPE:l}=n;let c;const d=(f,h)=>{if(typeof f!="object"||!("aborted"in f))throw new l(h,"AbortSignal",f)};t.exports.addAbortSignal=function(h,p){if(d(h,"signal"),!i(p)&&!a(p))throw new l("stream",["ReadableStream","WritableStream","Stream"],p);return t.exports.addAbortSignalNoValidate(h,p)},t.exports.addAbortSignalNoValidate=function(f,h){if(typeof f!="object"||!("aborted"in f))return h;const p=i(h)?()=>{h.destroy(new r(void 0,{cause:f.reason}))}:()=>{h[o](new r(void 0,{cause:f.reason}))};if(f.aborted)p();else{c=c||Ir.addAbortListener;const b=c(f,p);s(h,b[e])}return h}})(ZU);var Ig=ZU.exports;const{StringPrototypeSlice:RT,SymbolIterator:gX,TypedArrayPrototypeSet:n_,Uint8Array:mX}=Mt,{Buffer:qw}=ki,{inspect:vX}=Ir;var wX=class{constructor(){this.head=null,this.tail=null,this.length=0}push(e){const r={data:e,next:null};this.length>0?this.tail.next=r:this.head=r,this.tail=r,++this.length}unshift(e){const r={data:e,next:this.head};this.length===0&&(this.tail=r),this.head=r,++this.length}shift(){if(this.length===0)return;const e=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,e}clear(){this.head=this.tail=null,this.length=0}join(e){if(this.length===0)return"";let r=this.head,n=""+r.data;for(;(r=r.next)!==null;)n+=e+r.data;return n}concat(e){if(this.length===0)return qw.alloc(0);const r=qw.allocUnsafe(e>>>0);let n=this.head,i=0;for(;n;)n_(r,n.data,i),i+=n.data.length,n=n.next;return r}consume(e,r){const n=this.head.data;if(e<n.length){const i=n.slice(0,e);return this.head.data=n.slice(e),i}return e===n.length?this.shift():r?this._getString(e):this._getBuffer(e)}first(){return this.head.data}*[gX](){for(let e=this.head;e;e=e.next)yield e.data}_getString(e){let r="",n=this.head,i=0;do{const a=n.data;if(e>a.length)r+=a,e-=a.length;else{e===a.length?(r+=a,++i,n.next?this.head=n.next:this.head=this.tail=null):(r+=RT(a,0,e),this.head=n,n.data=RT(a,e));break}++i}while((n=n.next)!==null);return this.length-=i,r}_getBuffer(e){const r=qw.allocUnsafe(e),n=e;let i=this.head,a=0;do{const o=i.data;if(e>o.length)n_(r,o,n-e),e-=o.length;else{e===o.length?(n_(r,o,n-e),++a,i.next?this.head=i.next:this.head=this.tail=null):(n_(r,new mX(o.buffer,o.byteOffset,e),n-e),this.head=i,i.data=o.slice(e));break}++a}while((i=i.next)!==null);return this.length-=a,r}[Symbol.for("nodejs.util.inspect.custom")](e,r){return vX(this,{...r,depth:0,customInspect:!1})}};const{MathFloor:OX,NumberIsInteger:SX}=Mt,{validateInteger:EX}=hd,{ERR_INVALID_ARG_VALUE:PX}=mr.codes;let YU=16*1024,QU=16;function jX(t,e,r){return t.highWaterMark!=null?t.highWaterMark:e?t[r]:null}function eF(t){return t?QU:YU}function CX(t,e){EX(e,"value",0),t?QU=e:YU=e}function MX(t,e,r,n){const i=jX(e,n,r);if(i!=null){if(!SX(i)||i<0){const a=n?`options.${r}`:"options.highWaterMark";throw new PX(a,i)}return OX(i)}return eF(t.objectMode)}var xg={getHighWaterMark:MX,getDefaultHighWaterMark:eF,setDefaultHighWaterMark:CX},tF={},jS={exports:{}};/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */(function(t,e){var r=ki,n=r.Buffer;function i(o,s){for(var l in o)s[l]=o[l]}n.from&&n.alloc&&n.allocUnsafe&&n.allocUnsafeSlow?t.exports=r:(i(r,e),e.Buffer=a);function a(o,s,l){return n(o,s,l)}a.prototype=Object.create(n.prototype),i(n,a),a.from=function(o,s,l){if(typeof o=="number")throw new TypeError("Argument must not be a number");return n(o,s,l)},a.alloc=function(o,s,l){if(typeof o!="number")throw new TypeError("Argument must be a number");var c=n(o);return s!==void 0?typeof l=="string"?c.fill(s,l):c.fill(s):c.fill(0),c},a.allocUnsafe=function(o){if(typeof o!="number")throw new TypeError("Argument must be a number");return n(o)},a.allocUnsafeSlow=function(o){if(typeof o!="number")throw new TypeError("Argument must be a number");return r.SlowBuffer(o)}})(jS,jS.exports);var TX=jS.exports,BP=TX.Buffer,AT=BP.isEncoding||function(t){switch(t=""+t,t&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function RX(t){if(!t)return"utf8";for(var e;;)switch(t){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return t;default:if(e)return;t=(""+t).toLowerCase(),e=!0}}function AX(t){var e=RX(t);if(typeof e!="string"&&(BP.isEncoding===AT||!AT(t)))throw new Error("Unknown encoding: "+t);return e||t}tF.StringDecoder=pd;function pd(t){this.encoding=AX(t);var e;switch(this.encoding){case"utf16le":this.text=zX,this.end=BX,e=4;break;case"utf8":this.fillLast=xX,e=4;break;case"base64":this.text=UX,this.end=FX,e=3;break;default:this.write=LX,this.end=VX;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=BP.allocUnsafe(e)}pd.prototype.write=function(t){if(t.length===0)return"";var e,r;if(this.lastNeed){if(e=this.fillLast(t),e===void 0)return"";r=this.lastNeed,this.lastNeed=0}else r=0;return r<t.length?e?e+this.text(t,r):this.text(t,r):e||""};pd.prototype.end=NX;pd.prototype.text=DX;pd.prototype.fillLast=function(t){if(this.lastNeed<=t.length)return t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,t.length),this.lastNeed-=t.length};function Gw(t){return t<=127?0:t>>5===6?2:t>>4===14?3:t>>3===30?4:t>>6===2?-1:-2}function $X(t,e,r){var n=e.length-1;if(n<r)return 0;var i=Gw(e[n]);return i>=0?(i>0&&(t.lastNeed=i-1),i):--n<r||i===-2?0:(i=Gw(e[n]),i>=0?(i>0&&(t.lastNeed=i-2),i):--n<r||i===-2?0:(i=Gw(e[n]),i>=0?(i>0&&(i===2?i=0:t.lastNeed=i-3),i):0))}function IX(t,e,r){if((e[0]&192)!==128)return t.lastNeed=0,"";if(t.lastNeed>1&&e.length>1){if((e[1]&192)!==128)return t.lastNeed=1,"";if(t.lastNeed>2&&e.length>2&&(e[2]&192)!==128)return t.lastNeed=2,""}}function xX(t){var e=this.lastTotal-this.lastNeed,r=IX(this,t);if(r!==void 0)return r;if(this.lastNeed<=t.length)return t.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,e,0,t.length),this.lastNeed-=t.length}function DX(t,e){var r=$X(this,t,e);if(!this.lastNeed)return t.toString("utf8",e);this.lastTotal=r;var n=t.length-(r-this.lastNeed);return t.copy(this.lastChar,0,n),t.toString("utf8",e,n)}function NX(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+"":e}function zX(t,e){if((t.length-e)%2===0){var r=t.toString("utf16le",e);if(r){var n=r.charCodeAt(r.length-1);if(n>=55296&&n<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1],r.slice(0,-1)}return r}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=t[t.length-1],t.toString("utf16le",e,t.length-1)}function BX(t){var e=t&&t.length?this.write(t):"";if(this.lastNeed){var r=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,r)}return e}function UX(t,e){var r=(t.length-e)%3;return r===0?t.toString("base64",e):(this.lastNeed=3-r,this.lastTotal=3,r===1?this.lastChar[0]=t[t.length-1]:(this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1]),t.toString("base64",e,t.length-r))}function FX(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function LX(t){return t.toString(this.encoding)}function VX(t){return t&&t.length?this.write(t):""}const $T=Mo,{PromisePrototypeThen:kX,SymbolAsyncIterator:IT,SymbolIterator:xT}=Mt,{Buffer:HX}=ki,{ERR_INVALID_ARG_TYPE:qX,ERR_STREAM_NULL_VALUES:GX}=mr.codes;function WX(t,e,r){let n;if(typeof e=="string"||e instanceof HX)return new t({objectMode:!0,...r,read(){this.push(e),this.push(null)}});let i;if(e&&e[IT])i=!0,n=e[IT]();else if(e&&e[xT])i=!1,n=e[xT]();else throw new qX("iterable",["Iterable"],e);const a=new t({objectMode:!0,highWaterMark:1,...r});let o=!1;a._read=function(){o||(o=!0,l())},a._destroy=function(c,d){kX(s(c),()=>$T.nextTick(d,c),f=>$T.nextTick(d,f||c))};async function s(c){const d=c!=null,f=typeof n.throw=="function";if(d&&f){const{value:h,done:p}=await n.throw(c);if(await h,p)return}if(typeof n.return=="function"){const{value:h}=await n.return();await h}}async function l(){for(;;){try{const{value:c,done:d}=i?await n.next():n.next();if(d)a.push(null);else{const f=c&&typeof c.then=="function"?await c:c;if(f===null)throw o=!1,new GX;if(a.push(f))continue;o=!1}}catch(c){a.destroy(c)}break}}return a}var rF=WX,Ww,DT;function Dg(){if(DT)return Ww;DT=1;const t=Mo,{ArrayPrototypeIndexOf:e,NumberIsInteger:r,NumberIsNaN:n,NumberParseInt:i,ObjectDefineProperties:a,ObjectKeys:o,ObjectSetPrototypeOf:s,Promise:l,SafeSet:c,SymbolAsyncDispose:d,SymbolAsyncIterator:f,Symbol:h}=Mt;Ww=we,we.ReadableState=wr;const{EventEmitter:p}=Mg,{Stream:b,prependListener:g}=zP,{Buffer:v}=ki,{addAbortSignal:E}=Ig,C=xa;let S=Ir.debuglog("stream",w=>{S=w});const N=wX,D=Uu,{getHighWaterMark:Z,getDefaultHighWaterMark:se}=xg,{aggregateTwoErrors:re,codes:{ERR_INVALID_ARG_TYPE:k,ERR_METHOD_NOT_IMPLEMENTED:ee,ERR_OUT_OF_RANGE:X,ERR_STREAM_PUSH_AFTER_EOF:te,ERR_STREAM_UNSHIFT_AFTER_END_EVENT:I},AbortError:x}=mr,{validateObject:A}=hd,V=h("kPaused"),{StringDecoder:G}=tF,J=rF;s(we.prototype,b.prototype),s(we,b);const H=()=>{},{errorOrDestroy:Y}=D,Q=1,le=2,ne=4,Ce=8,Te=16,Qe=32,U=64,ie=128,F=256,W=512,de=1024,Se=2048,T=4096,R=8192,q=16384,ge=32768,pe=65536,ut=1<<17,_t=1<<18;function tt(w){return{enumerable:!1,get(){return(this.state&w)!==0},set(j){j?this.state|=w:this.state&=~w}}}a(wr.prototype,{objectMode:tt(Q),ended:tt(le),endEmitted:tt(ne),reading:tt(Ce),constructed:tt(Te),sync:tt(Qe),needReadable:tt(U),emittedReadable:tt(ie),readableListening:tt(F),resumeScheduled:tt(W),errorEmitted:tt(de),emitClose:tt(Se),autoDestroy:tt(T),destroyed:tt(R),closed:tt(q),closeEmitted:tt(ge),multiAwaitDrain:tt(pe),readingMore:tt(ut),dataEmitted:tt(_t)});function wr(w,j,ae){typeof ae!="boolean"&&(ae=j instanceof Fi()),this.state=Se|T|Te|Qe,w&&w.objectMode&&(this.state|=Q),ae&&w&&w.readableObjectMode&&(this.state|=Q),this.highWaterMark=w?Z(this,w,"readableHighWaterMark",ae):se(!1),this.buffer=new N,this.length=0,this.pipes=[],this.flowing=null,this[V]=null,w&&w.emitClose===!1&&(this.state&=-2049),w&&w.autoDestroy===!1&&(this.state&=-4097),this.errored=null,this.defaultEncoding=w&&w.defaultEncoding||"utf8",this.awaitDrainWriters=null,this.decoder=null,this.encoding=null,w&&w.encoding&&(this.decoder=new G(w.encoding),this.encoding=w.encoding)}function we(w){if(!(this instanceof we))return new we(w);const j=this instanceof Fi();this._readableState=new wr(w,this,j),w&&(typeof w.read=="function"&&(this._read=w.read),typeof w.destroy=="function"&&(this._destroy=w.destroy),typeof w.construct=="function"&&(this._construct=w.construct),w.signal&&!j&&E(w.signal,this)),b.call(this,w),D.construct(this,()=>{this._readableState.needReadable&&M(this,this._readableState)})}we.prototype.destroy=D.destroy,we.prototype._undestroy=D.undestroy,we.prototype._destroy=function(w,j){j(w)},we.prototype[p.captureRejectionSymbol]=function(w){this.destroy(w)},we.prototype[d]=function(){let w;return this.destroyed||(w=this.readableEnded?null:new x,this.destroy(w)),new l((j,ae)=>C(this,oe=>oe&&oe!==w?ae(oe):j(null)))},we.prototype.push=function(w,j){return Yr(this,w,j,!1)},we.prototype.unshift=function(w,j){return Yr(this,w,j,!0)};function Yr(w,j,ae,oe){S("readableAddChunk",j);const _e=w._readableState;let rr;if(_e.state&Q||(typeof j=="string"?(ae=ae||_e.defaultEncoding,_e.encoding!==ae&&(oe&&_e.encoding?j=v.from(j,ae).toString(_e.encoding):(j=v.from(j,ae),ae=""))):j instanceof v?ae="":b._isUint8Array(j)?(j=b._uint8ArrayToBuffer(j),ae=""):j!=null&&(rr=new k("chunk",["string","Buffer","Uint8Array"],j))),rr)Y(w,rr);else if(j===null)_e.state&=-9,_(w,_e);else if(_e.state&Q||j&&j.length>0)if(oe)if(_e.state&ne)Y(w,new I);else{if(_e.destroyed||_e.errored)return!1;ul(w,_e,j,!0)}else if(_e.ended)Y(w,new te);else{if(_e.destroyed||_e.errored)return!1;_e.state&=-9,_e.decoder&&!ae?(j=_e.decoder.write(j),_e.objectMode||j.length!==0?ul(w,_e,j,!1):M(w,_e)):ul(w,_e,j,!1)}else oe||(_e.state&=-9,M(w,_e));return!_e.ended&&(_e.length<_e.highWaterMark||_e.length===0)}function ul(w,j,ae,oe){j.flowing&&j.length===0&&!j.sync&&w.listenerCount("data")>0?(j.state&pe?j.awaitDrainWriters.clear():j.awaitDrainWriters=null,j.dataEmitted=!0,w.emit("data",ae)):(j.length+=j.objectMode?1:ae.length,oe?j.buffer.unshift(ae):j.buffer.push(ae),j.state&U&&y(w)),M(w,j)}we.prototype.isPaused=function(){const w=this._readableState;return w[V]===!0||w.flowing===!1},we.prototype.setEncoding=function(w){const j=new G(w);this._readableState.decoder=j,this._readableState.encoding=this._readableState.decoder.encoding;const ae=this._readableState.buffer;let oe="";for(const _e of ae)oe+=j.write(_e);return ae.clear(),oe!==""&&ae.push(oe),this._readableState.length=oe.length,this};const Vn=1073741824;function Bv(w){if(w>Vn)throw new X("size","<= 1GiB",w);return w--,w|=w>>>1,w|=w>>>2,w|=w>>>4,w|=w>>>8,w|=w>>>16,w++,w}function m(w,j){return w<=0||j.length===0&&j.ended?0:j.state&Q?1:n(w)?j.flowing&&j.length?j.buffer.first().length:j.length:w<=j.length?w:j.ended?j.length:0}we.prototype.read=function(w){S("read",w),w===void 0?w=NaN:r(w)||(w=i(w,10));const j=this._readableState,ae=w;if(w>j.highWaterMark&&(j.highWaterMark=Bv(w)),w!==0&&(j.state&=-129),w===0&&j.needReadable&&((j.highWaterMark!==0?j.length>=j.highWaterMark:j.length>0)||j.ended))return S("read: emitReadable",j.length,j.ended),j.length===0&&j.ended?Uv(this):y(this),null;if(w=m(w,j),w===0&&j.ended)return j.length===0&&Uv(this),null;let oe=(j.state&U)!==0;if(S("need readable",oe),(j.length===0||j.length-w<j.highWaterMark)&&(oe=!0,S("length less than watermark",oe)),j.ended||j.reading||j.destroyed||j.errored||!j.constructed)oe=!1,S("reading, ended or constructing",oe);else if(oe){S("do read"),j.state|=Ce|Qe,j.length===0&&(j.state|=U);try{this._read(j.highWaterMark)}catch(rr){Y(this,rr)}j.state&=-33,j.reading||(w=m(ae,j))}let _e;return w>0?_e=mj(w,j):_e=null,_e===null?(j.needReadable=j.length<=j.highWaterMark,w=0):(j.length-=w,j.multiAwaitDrain?j.awaitDrainWriters.clear():j.awaitDrainWriters=null),j.length===0&&(j.ended||(j.needReadable=!0),ae!==w&&j.ended&&Uv(this)),_e!==null&&!j.errorEmitted&&!j.closeEmitted&&(j.dataEmitted=!0,this.emit("data",_e)),_e};function _(w,j){if(S("onEofChunk"),!j.ended){if(j.decoder){const ae=j.decoder.end();ae&&ae.length&&(j.buffer.push(ae),j.length+=j.objectMode?1:ae.length)}j.ended=!0,j.sync?y(w):(j.needReadable=!1,j.emittedReadable=!0,O(w))}}function y(w){const j=w._readableState;S("emitReadable",j.needReadable,j.emittedReadable),j.needReadable=!1,j.emittedReadable||(S("emitReadable",j.flowing),j.emittedReadable=!0,t.nextTick(O,w))}function O(w){const j=w._readableState;S("emitReadable_",j.destroyed,j.length,j.ended),!j.destroyed&&!j.errored&&(j.length||j.ended)&&(w.emit("readable"),j.emittedReadable=!1),j.needReadable=!j.flowing&&!j.ended&&j.length<=j.highWaterMark,et(w)}function M(w,j){!j.readingMore&&j.constructed&&(j.readingMore=!0,t.nextTick($,w,j))}function $(w,j){for(;!j.reading&&!j.ended&&(j.length<j.highWaterMark||j.flowing&&j.length===0);){const ae=j.length;if(S("maybeReadMore read 0"),w.read(0),ae===j.length)break}j.readingMore=!1}we.prototype._read=function(w){throw new ee("_read()")},we.prototype.pipe=function(w,j){const ae=this,oe=this._readableState;oe.pipes.length===1&&(oe.multiAwaitDrain||(oe.multiAwaitDrain=!0,oe.awaitDrainWriters=new c(oe.awaitDrainWriters?[oe.awaitDrainWriters]:[]))),oe.pipes.push(w),S("pipe count=%d opts=%j",oe.pipes.length,j);const rr=(!j||j.end!==!1)&&w!==t.stdout&&w!==t.stderr?wj:ll;oe.endEmitted?t.nextTick(rr):ae.once("end",rr),w.on("unpipe",Qr);function Qr(ka,fi){S("onunpipe"),ka===ae&&fi&&fi.hasUnpiped===!1&&(fi.hasUnpiped=!0,d4())}function wj(){S("onend"),w.end()}let Va,Oj=!1;function d4(){S("cleanup"),w.removeListener("close",Vv),w.removeListener("finish",kv),Va&&w.removeListener("drain",Va),w.removeListener("error",Lv),w.removeListener("unpipe",Qr),ae.removeListener("end",wj),ae.removeListener("end",ll),ae.removeListener("data",Ej),Oj=!0,Va&&oe.awaitDrainWriters&&(!w._writableState||w._writableState.needDrain)&&Va()}function Sj(){Oj||(oe.pipes.length===1&&oe.pipes[0]===w?(S("false write response, pause",0),oe.awaitDrainWriters=w,oe.multiAwaitDrain=!1):oe.pipes.length>1&&oe.pipes.includes(w)&&(S("false write response, pause",oe.awaitDrainWriters.size),oe.awaitDrainWriters.add(w)),ae.pause()),Va||(Va=L(ae,w),w.on("drain",Va))}ae.on("data",Ej);function Ej(ka){S("ondata");const fi=w.write(ka);S("dest.write",fi),fi===!1&&Sj()}function Lv(ka){if(S("onerror",ka),ll(),w.removeListener("error",Lv),w.listenerCount("error")===0){const fi=w._writableState||w._readableState;fi&&!fi.errorEmitted?Y(w,ka):w.emit("error",ka)}}g(w,"error",Lv);function Vv(){w.removeListener("finish",kv),ll()}w.once("close",Vv);function kv(){S("onfinish"),w.removeListener("close",Vv),ll()}w.once("finish",kv);function ll(){S("unpipe"),ae.unpipe(w)}return w.emit("pipe",ae),w.writableNeedDrain===!0?Sj():oe.flowing||(S("pipe resume"),ae.resume()),w};function L(w,j){return function(){const oe=w._readableState;oe.awaitDrainWriters===j?(S("pipeOnDrain",1),oe.awaitDrainWriters=null):oe.multiAwaitDrain&&(S("pipeOnDrain",oe.awaitDrainWriters.size),oe.awaitDrainWriters.delete(j)),(!oe.awaitDrainWriters||oe.awaitDrainWriters.size===0)&&w.listenerCount("data")&&w.resume()}}we.prototype.unpipe=function(w){const j=this._readableState,ae={hasUnpiped:!1};if(j.pipes.length===0)return this;if(!w){const _e=j.pipes;j.pipes=[],this.pause();for(let rr=0;rr<_e.length;rr++)_e[rr].emit("unpipe",this,{hasUnpiped:!1});return this}const oe=e(j.pipes,w);return oe===-1?this:(j.pipes.splice(oe,1),j.pipes.length===0&&this.pause(),w.emit("unpipe",this,ae),this)},we.prototype.on=function(w,j){const ae=b.prototype.on.call(this,w,j),oe=this._readableState;return w==="data"?(oe.readableListening=this.listenerCount("readable")>0,oe.flowing!==!1&&this.resume()):w==="readable"&&!oe.endEmitted&&!oe.readableListening&&(oe.readableListening=oe.needReadable=!0,oe.flowing=!1,oe.emittedReadable=!1,S("on readable",oe.length,oe.reading),oe.length?y(this):oe.reading||t.nextTick(wt,this)),ae},we.prototype.addListener=we.prototype.on,we.prototype.removeListener=function(w,j){const ae=b.prototype.removeListener.call(this,w,j);return w==="readable"&&t.nextTick(Ne,this),ae},we.prototype.off=we.prototype.removeListener,we.prototype.removeAllListeners=function(w){const j=b.prototype.removeAllListeners.apply(this,arguments);return(w==="readable"||w===void 0)&&t.nextTick(Ne,this),j};function Ne(w){const j=w._readableState;j.readableListening=w.listenerCount("readable")>0,j.resumeScheduled&&j[V]===!1?j.flowing=!0:w.listenerCount("data")>0?w.resume():j.readableListening||(j.flowing=null)}function wt(w){S("readable nexttick read 0"),w.read(0)}we.prototype.resume=function(){const w=this._readableState;return w.flowing||(S("resume"),w.flowing=!w.readableListening,dt(this,w)),w[V]=!1,this};function dt(w,j){j.resumeScheduled||(j.resumeScheduled=!0,t.nextTick(Ot,w,j))}function Ot(w,j){S("resume",j.reading),j.reading||w.read(0),j.resumeScheduled=!1,w.emit("resume"),et(w),j.flowing&&!j.reading&&w.read(0)}we.prototype.pause=function(){return S("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(S("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState[V]=!0,this};function et(w){const j=w._readableState;for(S("flow",j.flowing);j.flowing&&w.read()!==null;);}we.prototype.wrap=function(w){let j=!1;w.on("data",oe=>{!this.push(oe)&&w.pause&&(j=!0,w.pause())}),w.on("end",()=>{this.push(null)}),w.on("error",oe=>{Y(this,oe)}),w.on("close",()=>{this.destroy()}),w.on("destroy",()=>{this.destroy()}),this._read=()=>{j&&w.resume&&(j=!1,w.resume())};const ae=o(w);for(let oe=1;oe<ae.length;oe++){const _e=ae[oe];this[_e]===void 0&&typeof w[_e]=="function"&&(this[_e]=w[_e].bind(w))}return this},we.prototype[f]=function(){return gj(this)},we.prototype.iterator=function(w){return w!==void 0&&A(w,"options"),gj(this,w)};function gj(w,j){typeof w.read!="function"&&(w=we.wrap(w,{objectMode:!0}));const ae=u4(w,j);return ae.stream=w,ae}async function*u4(w,j){let ae=H;function oe(Qr){this===w?(ae(),ae=H):ae=Qr}w.on("readable",oe);let _e;const rr=C(w,{writable:!1},Qr=>{_e=Qr?re(_e,Qr):null,ae(),ae=H});try{for(;;){const Qr=w.destroyed?null:w.read();if(Qr!==null)yield Qr;else{if(_e)throw _e;if(_e===null)return;await new l(oe)}}}catch(Qr){throw _e=re(_e,Qr),_e}finally{(_e||j?.destroyOnReturn!==!1)&&(_e===void 0||w._readableState.autoDestroy)?D.destroyer(w,null):(w.off("readable",oe),rr())}}a(we.prototype,{readable:{__proto__:null,get(){const w=this._readableState;return!!w&&w.readable!==!1&&!w.destroyed&&!w.errorEmitted&&!w.endEmitted},set(w){this._readableState&&(this._readableState.readable=!!w)}},readableDidRead:{__proto__:null,enumerable:!1,get:function(){return this._readableState.dataEmitted}},readableAborted:{__proto__:null,enumerable:!1,get:function(){return!!(this._readableState.readable!==!1&&(this._readableState.destroyed||this._readableState.errored)&&!this._readableState.endEmitted)}},readableHighWaterMark:{__proto__:null,enumerable:!1,get:function(){return this._readableState.highWaterMark}},readableBuffer:{__proto__:null,enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}},readableFlowing:{__proto__:null,enumerable:!1,get:function(){return this._readableState.flowing},set:function(w){this._readableState&&(this._readableState.flowing=w)}},readableLength:{__proto__:null,enumerable:!1,get(){return this._readableState.length}},readableObjectMode:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.objectMode:!1}},readableEncoding:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.encoding:null}},errored:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.errored:null}},closed:{__proto__:null,get(){return this._readableState?this._readableState.closed:!1}},destroyed:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.destroyed:!1},set(w){this._readableState&&(this._readableState.destroyed=w)}},readableEnded:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.endEmitted:!1}}}),a(wr.prototype,{pipesCount:{__proto__:null,get(){return this.pipes.length}},paused:{__proto__:null,get(){return this[V]!==!1},set(w){this[V]=!!w}}}),we._fromList=mj;function mj(w,j){if(j.length===0)return null;let ae;return j.objectMode?ae=j.buffer.shift():!w||w>=j.length?(j.decoder?ae=j.buffer.join(""):j.buffer.length===1?ae=j.buffer.first():ae=j.buffer.concat(j.length),j.buffer.clear()):ae=j.buffer.consume(w,j.decoder),ae}function Uv(w){const j=w._readableState;S("endReadable",j.endEmitted),j.endEmitted||(j.ended=!0,t.nextTick(l4,j,w))}function l4(w,j){if(S("endReadableNT",w.endEmitted,w.length),!w.errored&&!w.closeEmitted&&!w.endEmitted&&w.length===0){if(w.endEmitted=!0,j.emit("end"),j.writable&&j.allowHalfOpen===!1)t.nextTick(c4,j);else if(w.autoDestroy){const ae=j._writableState;(!ae||ae.autoDestroy&&(ae.finished||ae.writable===!1))&&j.destroy()}}}function c4(w){w.writable&&!w.writableEnded&&!w.destroyed&&w.end()}we.from=function(w,j){return J(we,w,j)};let Fv;function vj(){return Fv===void 0&&(Fv={}),Fv}return we.fromWeb=function(w,j){return vj().newStreamReadableFromReadableStream(w,j)},we.toWeb=function(w,j){return vj().newReadableStreamFromStreamReadable(w,j)},we.wrap=function(w,j){var ae,oe;return new we({objectMode:(ae=(oe=w.readableObjectMode)!==null&&oe!==void 0?oe:w.objectMode)!==null&&ae!==void 0?ae:!0,...j,destroy(_e,rr){D.destroyer(w,_e),rr(_e)}}).wrap(w)},Ww}var Kw,NT;function UP(){if(NT)return Kw;NT=1;const t=Mo,{ArrayPrototypeSlice:e,Error:r,FunctionPrototypeSymbolHasInstance:n,ObjectDefineProperty:i,ObjectDefineProperties:a,ObjectSetPrototypeOf:o,StringPrototypeToLowerCase:s,Symbol:l,SymbolHasInstance:c}=Mt;Kw=A,A.WritableState=I;const{EventEmitter:d}=Mg,f=zP.Stream,{Buffer:h}=ki,p=Uu,{addAbortSignal:b}=Ig,{getHighWaterMark:g,getDefaultHighWaterMark:v}=xg,{ERR_INVALID_ARG_TYPE:E,ERR_METHOD_NOT_IMPLEMENTED:C,ERR_MULTIPLE_CALLBACK:S,ERR_STREAM_CANNOT_PIPE:N,ERR_STREAM_DESTROYED:D,ERR_STREAM_ALREADY_FINISHED:Z,ERR_STREAM_NULL_VALUES:se,ERR_STREAM_WRITE_AFTER_END:re,ERR_UNKNOWN_ENCODING:k}=mr.codes,{errorOrDestroy:ee}=p;o(A.prototype,f.prototype),o(A,f);function X(){}const te=l("kOnFinished");function I(T,R,q){typeof q!="boolean"&&(q=R instanceof Fi()),this.objectMode=!!(T&&T.objectMode),q&&(this.objectMode=this.objectMode||!!(T&&T.writableObjectMode)),this.highWaterMark=T?g(this,T,"writableHighWaterMark",q):v(!1),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;const ge=!!(T&&T.decodeStrings===!1);this.decodeStrings=!ge,this.defaultEncoding=T&&T.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=Y.bind(void 0,R),this.writecb=null,this.writelen=0,this.afterWriteTickInfo=null,x(this),this.pendingcb=0,this.constructed=!0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!T||T.emitClose!==!1,this.autoDestroy=!T||T.autoDestroy!==!1,this.errored=null,this.closed=!1,this.closeEmitted=!1,this[te]=[]}function x(T){T.buffered=[],T.bufferedIndex=0,T.allBuffers=!0,T.allNoop=!0}I.prototype.getBuffer=function(){return e(this.buffered,this.bufferedIndex)},i(I.prototype,"bufferedRequestCount",{__proto__:null,get(){return this.buffered.length-this.bufferedIndex}});function A(T){const R=this instanceof Fi();if(!R&&!n(A,this))return new A(T);this._writableState=new I(T,this,R),T&&(typeof T.write=="function"&&(this._write=T.write),typeof T.writev=="function"&&(this._writev=T.writev),typeof T.destroy=="function"&&(this._destroy=T.destroy),typeof T.final=="function"&&(this._final=T.final),typeof T.construct=="function"&&(this._construct=T.construct),T.signal&&b(T.signal,this)),f.call(this,T),p.construct(this,()=>{const q=this._writableState;q.writing||Ce(this,q),ie(this,q)})}i(A,c,{__proto__:null,value:function(T){return n(this,T)?!0:this!==A?!1:T&&T._writableState instanceof I}}),A.prototype.pipe=function(){ee(this,new N)};function V(T,R,q,ge){const pe=T._writableState;if(typeof q=="function")ge=q,q=pe.defaultEncoding;else{if(!q)q=pe.defaultEncoding;else if(q!=="buffer"&&!h.isEncoding(q))throw new k(q);typeof ge!="function"&&(ge=X)}if(R===null)throw new se;if(!pe.objectMode)if(typeof R=="string")pe.decodeStrings!==!1&&(R=h.from(R,q),q="buffer");else if(R instanceof h)q="buffer";else if(f._isUint8Array(R))R=f._uint8ArrayToBuffer(R),q="buffer";else throw new E("chunk",["string","Buffer","Uint8Array"],R);let ut;return pe.ending?ut=new re:pe.destroyed&&(ut=new D("write")),ut?(t.nextTick(ge,ut),ee(T,ut,!0),ut):(pe.pendingcb++,G(T,pe,R,q,ge))}A.prototype.write=function(T,R,q){return V(this,T,R,q)===!0},A.prototype.cork=function(){this._writableState.corked++},A.prototype.uncork=function(){const T=this._writableState;T.corked&&(T.corked--,T.writing||Ce(this,T))},A.prototype.setDefaultEncoding=function(R){if(typeof R=="string"&&(R=s(R)),!h.isEncoding(R))throw new k(R);return this._writableState.defaultEncoding=R,this};function G(T,R,q,ge,pe){const ut=R.objectMode?1:q.length;R.length+=ut;const _t=R.length<R.highWaterMark;return _t||(R.needDrain=!0),R.writing||R.corked||R.errored||!R.constructed?(R.buffered.push({chunk:q,encoding:ge,callback:pe}),R.allBuffers&&ge!=="buffer"&&(R.allBuffers=!1),R.allNoop&&pe!==X&&(R.allNoop=!1)):(R.writelen=ut,R.writecb=pe,R.writing=!0,R.sync=!0,T._write(q,ge,R.onwrite),R.sync=!1),_t&&!R.errored&&!R.destroyed}function J(T,R,q,ge,pe,ut,_t){R.writelen=ge,R.writecb=_t,R.writing=!0,R.sync=!0,R.destroyed?R.onwrite(new D("write")):q?T._writev(pe,R.onwrite):T._write(pe,ut,R.onwrite),R.sync=!1}function H(T,R,q,ge){--R.pendingcb,ge(q),ne(R),ee(T,q)}function Y(T,R){const q=T._writableState,ge=q.sync,pe=q.writecb;if(typeof pe!="function"){ee(T,new S);return}q.writing=!1,q.writecb=null,q.length-=q.writelen,q.writelen=0,R?(R.stack,q.errored||(q.errored=R),T._readableState&&!T._readableState.errored&&(T._readableState.errored=R),ge?t.nextTick(H,T,q,R,pe):H(T,q,R,pe)):(q.buffered.length>q.bufferedIndex&&Ce(T,q),ge?q.afterWriteTickInfo!==null&&q.afterWriteTickInfo.cb===pe?q.afterWriteTickInfo.count++:(q.afterWriteTickInfo={count:1,cb:pe,stream:T,state:q},t.nextTick(Q,q.afterWriteTickInfo)):le(T,q,1,pe))}function Q({stream:T,state:R,count:q,cb:ge}){return R.afterWriteTickInfo=null,le(T,R,q,ge)}function le(T,R,q,ge){for(!R.ending&&!T.destroyed&&R.length===0&&R.needDrain&&(R.needDrain=!1,T.emit("drain"));q-- >0;)R.pendingcb--,ge();R.destroyed&&ne(R),ie(T,R)}function ne(T){if(T.writing)return;for(let pe=T.bufferedIndex;pe<T.buffered.length;++pe){var R;const{chunk:ut,callback:_t}=T.buffered[pe],tt=T.objectMode?1:ut.length;T.length-=tt,_t((R=T.errored)!==null&&R!==void 0?R:new D("write"))}const q=T[te].splice(0);for(let pe=0;pe<q.length;pe++){var ge;q[pe]((ge=T.errored)!==null&&ge!==void 0?ge:new D("end"))}x(T)}function Ce(T,R){if(R.corked||R.bufferProcessing||R.destroyed||!R.constructed)return;const{buffered:q,bufferedIndex:ge,objectMode:pe}=R,ut=q.length-ge;if(!ut)return;let _t=ge;if(R.bufferProcessing=!0,ut>1&&T._writev){R.pendingcb-=ut-1;const tt=R.allNoop?X:we=>{for(let Yr=_t;Yr<q.length;++Yr)q[Yr].callback(we)},wr=R.allNoop&&_t===0?q:e(q,_t);wr.allBuffers=R.allBuffers,J(T,R,!0,R.length,wr,"",tt),x(R)}else{do{const{chunk:tt,encoding:wr,callback:we}=q[_t];q[_t++]=null;const Yr=pe?1:tt.length;J(T,R,!1,Yr,tt,wr,we)}while(_t<q.length&&!R.writing);_t===q.length?x(R):_t>256?(q.splice(0,_t),R.bufferedIndex=0):R.bufferedIndex=_t}R.bufferProcessing=!1}A.prototype._write=function(T,R,q){if(this._writev)this._writev([{chunk:T,encoding:R}],q);else throw new C("_write()")},A.prototype._writev=null,A.prototype.end=function(T,R,q){const ge=this._writableState;typeof T=="function"?(q=T,T=null,R=null):typeof R=="function"&&(q=R,R=null);let pe;if(T!=null){const ut=V(this,T,R);ut instanceof r&&(pe=ut)}return ge.corked&&(ge.corked=1,this.uncork()),pe||(!ge.errored&&!ge.ending?(ge.ending=!0,ie(this,ge,!0),ge.ended=!0):ge.finished?pe=new Z("end"):ge.destroyed&&(pe=new D("end"))),typeof q=="function"&&(pe||ge.finished?t.nextTick(q,pe):ge[te].push(q)),this};function Te(T){return T.ending&&!T.destroyed&&T.constructed&&T.length===0&&!T.errored&&T.buffered.length===0&&!T.finished&&!T.writing&&!T.errorEmitted&&!T.closeEmitted}function Qe(T,R){let q=!1;function ge(pe){if(q){ee(T,pe??S());return}if(q=!0,R.pendingcb--,pe){const ut=R[te].splice(0);for(let _t=0;_t<ut.length;_t++)ut[_t](pe);ee(T,pe,R.sync)}else Te(R)&&(R.prefinished=!0,T.emit("prefinish"),R.pendingcb++,t.nextTick(F,T,R))}R.sync=!0,R.pendingcb++;try{T._final(ge)}catch(pe){ge(pe)}R.sync=!1}function U(T,R){!R.prefinished&&!R.finalCalled&&(typeof T._final=="function"&&!R.destroyed?(R.finalCalled=!0,Qe(T,R)):(R.prefinished=!0,T.emit("prefinish")))}function ie(T,R,q){Te(R)&&(U(T,R),R.pendingcb===0&&(q?(R.pendingcb++,t.nextTick((ge,pe)=>{Te(pe)?F(ge,pe):pe.pendingcb--},T,R)):Te(R)&&(R.pendingcb++,F(T,R))))}function F(T,R){R.pendingcb--,R.finished=!0;const q=R[te].splice(0);for(let ge=0;ge<q.length;ge++)q[ge]();if(T.emit("finish"),R.autoDestroy){const ge=T._readableState;(!ge||ge.autoDestroy&&(ge.endEmitted||ge.readable===!1))&&T.destroy()}}a(A.prototype,{closed:{__proto__:null,get(){return this._writableState?this._writableState.closed:!1}},destroyed:{__proto__:null,get(){return this._writableState?this._writableState.destroyed:!1},set(T){this._writableState&&(this._writableState.destroyed=T)}},writable:{__proto__:null,get(){const T=this._writableState;return!!T&&T.writable!==!1&&!T.destroyed&&!T.errored&&!T.ending&&!T.ended},set(T){this._writableState&&(this._writableState.writable=!!T)}},writableFinished:{__proto__:null,get(){return this._writableState?this._writableState.finished:!1}},writableObjectMode:{__proto__:null,get(){return this._writableState?this._writableState.objectMode:!1}},writableBuffer:{__proto__:null,get(){return this._writableState&&this._writableState.getBuffer()}},writableEnded:{__proto__:null,get(){return this._writableState?this._writableState.ending:!1}},writableNeedDrain:{__proto__:null,get(){const T=this._writableState;return T?!T.destroyed&&!T.ending&&T.needDrain:!1}},writableHighWaterMark:{__proto__:null,get(){return this._writableState&&this._writableState.highWaterMark}},writableCorked:{__proto__:null,get(){return this._writableState?this._writableState.corked:0}},writableLength:{__proto__:null,get(){return this._writableState&&this._writableState.length}},errored:{__proto__:null,enumerable:!1,get(){return this._writableState?this._writableState.errored:null}},writableAborted:{__proto__:null,enumerable:!1,get:function(){return!!(this._writableState.writable!==!1&&(this._writableState.destroyed||this._writableState.errored)&&!this._writableState.finished)}}});const W=p.destroy;A.prototype.destroy=function(T,R){const q=this._writableState;return!q.destroyed&&(q.bufferedIndex<q.buffered.length||q[te].length)&&t.nextTick(ne,q),W.call(this,T,R),this},A.prototype._undestroy=p.undestroy,A.prototype._destroy=function(T,R){R(T)},A.prototype[d.captureRejectionSymbol]=function(T){this.destroy(T)};let de;function Se(){return de===void 0&&(de={}),de}return A.fromWeb=function(T,R){return Se().newStreamWritableFromWritableStream(T,R)},A.toWeb=function(T){return Se().newWritableStreamFromStreamWritable(T)},Kw}var Jw,zT;function KX(){if(zT)return Jw;zT=1;const t=Mo,e=ki,{isReadable:r,isWritable:n,isIterable:i,isNodeStream:a,isReadableNodeStream:o,isWritableNodeStream:s,isDuplexNodeStream:l,isReadableStream:c,isWritableStream:d}=qi,f=xa,{AbortError:h,codes:{ERR_INVALID_ARG_TYPE:p,ERR_INVALID_RETURN_VALUE:b}}=mr,{destroyer:g}=Uu,v=Fi(),E=Dg(),C=UP(),{createDeferredPromise:S}=Ir,N=rF,D=globalThis.Blob||e.Blob,Z=typeof D<"u"?function(I){return I instanceof D}:function(I){return!1},se=globalThis.AbortController||qc().AbortController,{FunctionPrototypeCall:re}=Mt;class k extends v{constructor(I){super(I),I?.readable===!1&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),I?.writable===!1&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)}}Jw=function te(I,x){if(l(I))return I;if(o(I))return X({readable:I});if(s(I))return X({writable:I});if(a(I))return X({writable:!1,readable:!1});if(c(I))return X({readable:E.fromWeb(I)});if(d(I))return X({writable:C.fromWeb(I)});if(typeof I=="function"){const{value:V,write:G,final:J,destroy:H}=ee(I);if(i(V))return N(k,V,{objectMode:!0,write:G,final:J,destroy:H});const Y=V?.then;if(typeof Y=="function"){let Q;const le=re(Y,V,ne=>{if(ne!=null)throw new b("nully","body",ne)},ne=>{g(Q,ne)});return Q=new k({objectMode:!0,readable:!1,write:G,final(ne){J(async()=>{try{await le,t.nextTick(ne,null)}catch(Ce){t.nextTick(ne,Ce)}})},destroy:H})}throw new b("Iterable, AsyncIterable or AsyncFunction",x,V)}if(Z(I))return te(I.arrayBuffer());if(i(I))return N(k,I,{objectMode:!0,writable:!1});if(c(I?.readable)&&d(I?.writable))return k.fromWeb(I);if(typeof I?.writable=="object"||typeof I?.readable=="object"){const V=I!=null&&I.readable?o(I?.readable)?I?.readable:te(I.readable):void 0,G=I!=null&&I.writable?s(I?.writable)?I?.writable:te(I.writable):void 0;return X({readable:V,writable:G})}const A=I?.then;if(typeof A=="function"){let V;return re(A,I,G=>{G!=null&&V.push(G),V.push(null)},G=>{g(V,G)}),V=new k({objectMode:!0,writable:!1,read(){}})}throw new p(x,["Blob","ReadableStream","WritableStream","Stream","Iterable","AsyncIterable","Function","{ readable, writable } pair","Promise"],I)};function ee(te){let{promise:I,resolve:x}=S();const A=new se,V=A.signal;return{value:te(async function*(){for(;;){const J=I;I=null;const{chunk:H,done:Y,cb:Q}=await J;if(t.nextTick(Q),Y)return;if(V.aborted)throw new h(void 0,{cause:V.reason});({promise:I,resolve:x}=S()),yield H}}(),{signal:V}),write(J,H,Y){const Q=x;x=null,Q({chunk:J,done:!1,cb:Y})},final(J){const H=x;x=null,H({done:!0,cb:J})},destroy(J,H){A.abort(),H(J)}}}function X(te){const I=te.readable&&typeof te.readable.read!="function"?E.wrap(te.readable):te.readable,x=te.writable;let A=!!r(I),V=!!n(x),G,J,H,Y,Q;function le(ne){const Ce=Y;Y=null,Ce?Ce(ne):ne&&Q.destroy(ne)}return Q=new k({readableObjectMode:!!(I!=null&&I.readableObjectMode),writableObjectMode:!!(x!=null&&x.writableObjectMode),readable:A,writable:V}),V&&(f(x,ne=>{V=!1,ne&&g(I,ne),le(ne)}),Q._write=function(ne,Ce,Te){x.write(ne,Ce)?Te():G=Te},Q._final=function(ne){x.end(),J=ne},x.on("drain",function(){if(G){const ne=G;G=null,ne()}}),x.on("finish",function(){if(J){const ne=J;J=null,ne()}})),A&&(f(I,ne=>{A=!1,ne&&g(I,ne),le(ne)}),I.on("readable",function(){if(H){const ne=H;H=null,ne()}}),I.on("end",function(){Q.push(null)}),Q._read=function(){for(;;){const ne=I.read();if(ne===null){H=Q._read;return}if(!Q.push(ne))return}}),Q._destroy=function(ne,Ce){!ne&&Y!==null&&(ne=new h),H=null,G=null,J=null,Y===null?Ce(ne):(Y=Ce,g(x,ne),g(I,ne))},Q}return Jw}var Xw,BT;function Fi(){if(BT)return Xw;BT=1;const{ObjectDefineProperties:t,ObjectGetOwnPropertyDescriptor:e,ObjectKeys:r,ObjectSetPrototypeOf:n}=Mt;Xw=o;const i=Dg(),a=UP();n(o.prototype,i.prototype),n(o,i);{const d=r(a.prototype);for(let f=0;f<d.length;f++){const h=d[f];o.prototype[h]||(o.prototype[h]=a.prototype[h])}}function o(d){if(!(this instanceof o))return new o(d);i.call(this,d),a.call(this,d),d?(this.allowHalfOpen=d.allowHalfOpen!==!1,d.readable===!1&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),d.writable===!1&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)):this.allowHalfOpen=!0}t(o.prototype,{writable:{__proto__:null,...e(a.prototype,"writable")},writableHighWaterMark:{__proto__:null,...e(a.prototype,"writableHighWaterMark")},writableObjectMode:{__proto__:null,...e(a.prototype,"writableObjectMode")},writableBuffer:{__proto__:null,...e(a.prototype,"writableBuffer")},writableLength:{__proto__:null,...e(a.prototype,"writableLength")},writableFinished:{__proto__:null,...e(a.prototype,"writableFinished")},writableCorked:{__proto__:null,...e(a.prototype,"writableCorked")},writableEnded:{__proto__:null,...e(a.prototype,"writableEnded")},writableNeedDrain:{__proto__:null,...e(a.prototype,"writableNeedDrain")},destroyed:{__proto__:null,get(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set(d){this._readableState&&this._writableState&&(this._readableState.destroyed=d,this._writableState.destroyed=d)}}});let s;function l(){return s===void 0&&(s={}),s}o.fromWeb=function(d,f){return l().newStreamDuplexFromReadableWritablePair(d,f)},o.toWeb=function(d){return l().newReadableWritablePairFromDuplex(d)};let c;return o.from=function(d){return c||(c=KX()),c(d,"body")},Xw}const{ObjectSetPrototypeOf:nF,Symbol:JX}=Mt;var iF=Li;const{ERR_METHOD_NOT_IMPLEMENTED:XX}=mr.codes,FP=Fi(),{getHighWaterMark:ZX}=xg;nF(Li.prototype,FP.prototype);nF(Li,FP);const mc=JX("kCallback");function Li(t){if(!(this instanceof Li))return new Li(t);const e=t?ZX(this,t,"readableHighWaterMark",!0):null;e===0&&(t={...t,highWaterMark:null,readableHighWaterMark:e,writableHighWaterMark:t.writableHighWaterMark||0}),FP.call(this,t),this._readableState.sync=!1,this[mc]=null,t&&(typeof t.transform=="function"&&(this._transform=t.transform),typeof t.flush=="function"&&(this._flush=t.flush)),this.on("prefinish",YX)}function CS(t){typeof this._flush=="function"&&!this.destroyed?this._flush((e,r)=>{if(e){t?t(e):this.destroy(e);return}r!=null&&this.push(r),this.push(null),t&&t()}):(this.push(null),t&&t())}function YX(){this._final!==CS&&CS.call(this)}Li.prototype._final=CS;Li.prototype._transform=function(t,e,r){throw new XX("_transform()")};Li.prototype._write=function(t,e,r){const n=this._readableState,i=this._writableState,a=n.length;this._transform(t,e,(o,s)=>{if(o){r(o);return}s!=null&&this.push(s),i.ended||a===n.length||n.length<n.highWaterMark?r():this[mc]=r})};Li.prototype._read=function(){if(this[mc]){const t=this[mc];this[mc]=null,t()}};const{ObjectSetPrototypeOf:aF}=Mt;var oF=mu;const LP=iF;aF(mu.prototype,LP.prototype);aF(mu,LP);function mu(t){if(!(this instanceof mu))return new mu(t);LP.call(this,t)}mu.prototype._transform=function(t,e,r){r(null,t)};const ac=Mo,{ArrayIsArray:QX,Promise:e7,SymbolAsyncIterator:t7,SymbolDispose:r7}=Mt,Ry=xa,{once:n7}=Ir,i7=Uu,UT=Fi(),{aggregateTwoErrors:a7,codes:{ERR_INVALID_ARG_TYPE:MS,ERR_INVALID_RETURN_VALUE:Zw,ERR_MISSING_ARGS:o7,ERR_STREAM_DESTROYED:s7,ERR_STREAM_PREMATURE_CLOSE:u7},AbortError:l7}=mr,{validateFunction:c7,validateAbortSignal:d7}=hd,{isIterable:to,isReadable:Yw,isReadableNodeStream:X_,isNodeStream:FT,isTransformStream:Ms,isWebStream:f7,isReadableStream:Qw,isReadableFinished:h7}=qi,p7=globalThis.AbortController||qc().AbortController;let e0,t0,r0;function LT(t,e,r){let n=!1;t.on("close",()=>{n=!0});const i=Ry(t,{readable:e,writable:r},a=>{n=!a});return{destroy:a=>{n||(n=!0,i7.destroyer(t,a||new s7("pipe")))},cleanup:i}}function _7(t){return c7(t[t.length-1],"streams[stream.length - 1]"),t.pop()}function n0(t){if(to(t))return t;if(X_(t))return y7(t);throw new MS("val",["Readable","Iterable","AsyncIterable"],t)}async function*y7(t){t0||(t0=Dg()),yield*t0.prototype[t7].call(t)}async function i_(t,e,r,{end:n}){let i,a=null;const o=c=>{if(c&&(i=c),a){const d=a;a=null,d()}},s=()=>new e7((c,d)=>{i?d(i):a=()=>{i?d(i):c()}});e.on("drain",o);const l=Ry(e,{readable:!1},o);try{e.writableNeedDrain&&await s();for await(const c of t)e.write(c)||await s();n&&(e.end(),await s()),r()}catch(c){r(i!==c?a7(i,c):c)}finally{l(),e.off("drain",o)}}async function i0(t,e,r,{end:n}){Ms(e)&&(e=e.writable);const i=e.getWriter();try{for await(const a of t)await i.ready,i.write(a).catch(()=>{});await i.ready,n&&await i.close(),r()}catch(a){try{await i.abort(a),r(a)}catch(o){r(o)}}}function b7(...t){return sF(t,n7(_7(t)))}function sF(t,e,r){if(t.length===1&&QX(t[0])&&(t=t[0]),t.length<2)throw new o7("streams");const n=new p7,i=n.signal,a=r?.signal,o=[];d7(a,"options.signal");function s(){b(new l7)}r0=r0||Ir.addAbortListener;let l;a&&(l=r0(a,s));let c,d;const f=[];let h=0;function p(C){b(C,--h===0)}function b(C,S){var N;if(C&&(!c||c.code==="ERR_STREAM_PREMATURE_CLOSE")&&(c=C),!(!c&&!S)){for(;f.length;)f.shift()(c);(N=l)===null||N===void 0||N[r7](),n.abort(),S&&(c||o.forEach(D=>D()),ac.nextTick(e,c,d))}}let g;for(let C=0;C<t.length;C++){const S=t[C],N=C<t.length-1,D=C>0,Z=N||r?.end!==!1,se=C===t.length-1;if(FT(S)){let re=function(k){k&&k.name!=="AbortError"&&k.code!=="ERR_STREAM_PREMATURE_CLOSE"&&p(k)};if(Z){const{destroy:k,cleanup:ee}=LT(S,N,D);f.push(k),Yw(S)&&se&&o.push(ee)}S.on("error",re),Yw(S)&&se&&o.push(()=>{S.removeListener("error",re)})}if(C===0)if(typeof S=="function"){if(g=S({signal:i}),!to(g))throw new Zw("Iterable, AsyncIterable or Stream","source",g)}else to(S)||X_(S)||Ms(S)?g=S:g=UT.from(S);else if(typeof S=="function"){if(Ms(g)){var v;g=n0((v=g)===null||v===void 0?void 0:v.readable)}else g=n0(g);if(g=S(g,{signal:i}),N){if(!to(g,!0))throw new Zw("AsyncIterable",`transform[${C-1}]`,g)}else{var E;e0||(e0=oF);const re=new e0({objectMode:!0}),k=(E=g)===null||E===void 0?void 0:E.then;if(typeof k=="function")h++,k.call(g,te=>{d=te,te!=null&&re.write(te),Z&&re.end(),ac.nextTick(p)},te=>{re.destroy(te),ac.nextTick(p,te)});else if(to(g,!0))h++,i_(g,re,p,{end:Z});else if(Qw(g)||Ms(g)){const te=g.readable||g;h++,i_(te,re,p,{end:Z})}else throw new Zw("AsyncIterable or Promise","destination",g);g=re;const{destroy:ee,cleanup:X}=LT(g,!1,!0);f.push(ee),se&&o.push(X)}}else if(FT(S)){if(X_(g)){h+=2;const re=g7(g,S,p,{end:Z});Yw(S)&&se&&o.push(re)}else if(Ms(g)||Qw(g)){const re=g.readable||g;h++,i_(re,S,p,{end:Z})}else if(to(g))h++,i_(g,S,p,{end:Z});else throw new MS("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],g);g=S}else if(f7(S)){if(X_(g))h++,i0(n0(g),S,p,{end:Z});else if(Qw(g)||to(g))h++,i0(g,S,p,{end:Z});else if(Ms(g))h++,i0(g.readable,S,p,{end:Z});else throw new MS("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],g);g=S}else g=UT.from(S)}return(i!=null&&i.aborted||a!=null&&a.aborted)&&ac.nextTick(s),g}function g7(t,e,r,{end:n}){let i=!1;if(e.on("close",()=>{i||r(new u7)}),t.pipe(e,{end:!1}),n){let a=function(){i=!0,e.end()};h7(t)?ac.nextTick(a):t.once("end",a)}else r();return Ry(t,{readable:!0,writable:!1},a=>{const o=t._readableState;a&&a.code==="ERR_STREAM_PREMATURE_CLOSE"&&o&&o.ended&&!o.errored&&!o.errorEmitted?t.once("end",r).once("error",r):r(a)}),Ry(e,{readable:!1,writable:!0},r)}var VP={pipelineImpl:sF,pipeline:b7};const{pipeline:m7}=VP,a_=Fi(),{destroyer:v7}=Uu,{isNodeStream:o_,isReadable:VT,isWritable:kT,isWebStream:a0,isTransformStream:Wa,isWritableStream:HT,isReadableStream:qT}=qi,{AbortError:w7,codes:{ERR_INVALID_ARG_VALUE:GT,ERR_MISSING_ARGS:O7}}=mr,S7=xa;var uF=function(...e){if(e.length===0)throw new O7("streams");if(e.length===1)return a_.from(e[0]);const r=[...e];if(typeof e[0]=="function"&&(e[0]=a_.from(e[0])),typeof e[e.length-1]=="function"){const p=e.length-1;e[p]=a_.from(e[p])}for(let p=0;p<e.length;++p)if(!(!o_(e[p])&&!a0(e[p]))){if(p<e.length-1&&!(VT(e[p])||qT(e[p])||Wa(e[p])))throw new GT(`streams[${p}]`,r[p],"must be readable");if(p>0&&!(kT(e[p])||HT(e[p])||Wa(e[p])))throw new GT(`streams[${p}]`,r[p],"must be writable")}let n,i,a,o,s;function l(p){const b=o;o=null,b?b(p):p?s.destroy(p):!h&&!f&&s.destroy()}const c=e[0],d=m7(e,l),f=!!(kT(c)||HT(c)||Wa(c)),h=!!(VT(d)||qT(d)||Wa(d));if(s=new a_({writableObjectMode:!!(c!=null&&c.writableObjectMode),readableObjectMode:!!(d!=null&&d.readableObjectMode),writable:f,readable:h}),f){if(o_(c))s._write=function(b,g,v){c.write(b,g)?v():n=v},s._final=function(b){c.end(),i=b},c.on("drain",function(){if(n){const b=n;n=null,b()}});else if(a0(c)){const g=(Wa(c)?c.writable:c).getWriter();s._write=async function(v,E,C){try{await g.ready,g.write(v).catch(()=>{}),C()}catch(S){C(S)}},s._final=async function(v){try{await g.ready,g.close().catch(()=>{}),i=v}catch(E){v(E)}}}const p=Wa(d)?d.readable:d;S7(p,()=>{if(i){const b=i;i=null,b()}})}if(h){if(o_(d))d.on("readable",function(){if(a){const p=a;a=null,p()}}),d.on("end",function(){s.push(null)}),s._read=function(){for(;;){const p=d.read();if(p===null){a=s._read;return}if(!s.push(p))return}};else if(a0(d)){const b=(Wa(d)?d.readable:d).getReader();s._read=async function(){for(;;)try{const{value:g,done:v}=await b.read();if(!s.push(g))return;if(v){s.push(null);return}}catch{return}}}}return s._destroy=function(p,b){!p&&o!==null&&(p=new w7),a=null,n=null,i=null,o===null?b(p):(o=b,o_(d)&&v7(d,p))},s};const E7=globalThis.AbortController||qc().AbortController,{codes:{ERR_INVALID_ARG_VALUE:P7,ERR_INVALID_ARG_TYPE:_d,ERR_MISSING_ARGS:j7,ERR_OUT_OF_RANGE:C7},AbortError:ci}=mr,{validateAbortSignal:Ro,validateInteger:WT,validateObject:Ao}=hd,M7=Mt.Symbol("kWeak"),T7=Mt.Symbol("kResistStopPropagation"),{finished:R7}=xa,A7=uF,{addAbortSignalNoValidate:$7}=Ig,{isWritable:I7,isNodeStream:x7}=qi,{deprecate:D7}=Ir,{ArrayPrototypePush:N7,Boolean:z7,MathFloor:KT,Number:B7,NumberIsNaN:U7,Promise:JT,PromiseReject:XT,PromiseResolve:F7,PromisePrototypeThen:ZT,Symbol:lF}=Mt,Ay=lF("kEmpty"),YT=lF("kEof");function L7(t,e){if(e!=null&&Ao(e,"options"),e?.signal!=null&&Ro(e.signal,"options.signal"),x7(t)&&!I7(t))throw new P7("stream",t,"must be writable");const r=A7(this,t);return e!=null&&e.signal&&$7(e.signal,r),r}function Ng(t,e){if(typeof t!="function")throw new _d("fn",["Function","AsyncFunction"],t);e!=null&&Ao(e,"options"),e?.signal!=null&&Ro(e.signal,"options.signal");let r=1;e?.concurrency!=null&&(r=KT(e.concurrency));let n=r-1;return e?.highWaterMark!=null&&(n=KT(e.highWaterMark)),WT(r,"options.concurrency",1),WT(n,"options.highWaterMark",0),n+=r,async function*(){const a=Ir.AbortSignalAny([e?.signal].filter(z7)),o=this,s=[],l={signal:a};let c,d,f=!1,h=0;function p(){f=!0,b()}function b(){h-=1,g()}function g(){d&&!f&&h<r&&s.length<n&&(d(),d=null)}async function v(){try{for await(let E of o){if(f)return;if(a.aborted)throw new ci;try{if(E=t(E,l),E===Ay)continue;E=F7(E)}catch(C){E=XT(C)}h+=1,ZT(E,b,p),s.push(E),c&&(c(),c=null),!f&&(s.length>=n||h>=r)&&await new JT(C=>{d=C})}s.push(YT)}catch(E){const C=XT(E);ZT(C,b,p),s.push(C)}finally{f=!0,c&&(c(),c=null)}}v();try{for(;;){for(;s.length>0;){const E=await s[0];if(E===YT)return;if(a.aborted)throw new ci;E!==Ay&&(yield E),s.shift(),g()}await new JT(E=>{c=E})}}finally{f=!0,d&&(d(),d=null)}}.call(this)}function V7(t=void 0){return t!=null&&Ao(t,"options"),t?.signal!=null&&Ro(t.signal,"options.signal"),async function*(){let r=0;for await(const i of this){var n;if(t!=null&&(n=t.signal)!==null&&n!==void 0&&n.aborted)throw new ci({cause:t.signal.reason});yield[r++,i]}}.call(this)}async function cF(t,e=void 0){for await(const r of kP.call(this,t,e))return!0;return!1}async function k7(t,e=void 0){if(typeof t!="function")throw new _d("fn",["Function","AsyncFunction"],t);return!await cF.call(this,async(...r)=>!await t(...r),e)}async function H7(t,e){for await(const r of kP.call(this,t,e))return r}async function q7(t,e){if(typeof t!="function")throw new _d("fn",["Function","AsyncFunction"],t);async function r(n,i){return await t(n,i),Ay}for await(const n of Ng.call(this,r,e));}function kP(t,e){if(typeof t!="function")throw new _d("fn",["Function","AsyncFunction"],t);async function r(n,i){return await t(n,i)?n:Ay}return Ng.call(this,r,e)}class G7 extends j7{constructor(){super("reduce"),this.message="Reduce of an empty stream requires an initial value"}}async function W7(t,e,r){var n;if(typeof t!="function")throw new _d("reducer",["Function","AsyncFunction"],t);r!=null&&Ao(r,"options"),r?.signal!=null&&Ro(r.signal,"options.signal");let i=arguments.length>1;if(r!=null&&(n=r.signal)!==null&&n!==void 0&&n.aborted){const c=new ci(void 0,{cause:r.signal.reason});throw this.once("error",()=>{}),await R7(this.destroy(c)),c}const a=new E7,o=a.signal;if(r!=null&&r.signal){const c={once:!0,[M7]:this,[T7]:!0};r.signal.addEventListener("abort",()=>a.abort(),c)}let s=!1;try{for await(const c of this){var l;if(s=!0,r!=null&&(l=r.signal)!==null&&l!==void 0&&l.aborted)throw new ci;i?e=await t(e,c,{signal:o}):(e=c,i=!0)}if(!s&&!i)throw new G7}finally{a.abort()}return e}async function K7(t){t!=null&&Ao(t,"options"),t?.signal!=null&&Ro(t.signal,"options.signal");const e=[];for await(const n of this){var r;if(t!=null&&(r=t.signal)!==null&&r!==void 0&&r.aborted)throw new ci(void 0,{cause:t.signal.reason});N7(e,n)}return e}function J7(t,e){const r=Ng.call(this,t,e);return async function*(){for await(const i of r)yield*i}.call(this)}function dF(t){if(t=B7(t),U7(t))return 0;if(t<0)throw new C7("number",">= 0",t);return t}function X7(t,e=void 0){return e!=null&&Ao(e,"options"),e?.signal!=null&&Ro(e.signal,"options.signal"),t=dF(t),async function*(){var n;if(e!=null&&(n=e.signal)!==null&&n!==void 0&&n.aborted)throw new ci;for await(const a of this){var i;if(e!=null&&(i=e.signal)!==null&&i!==void 0&&i.aborted)throw new ci;t--<=0&&(yield a)}}.call(this)}function Z7(t,e=void 0){return e!=null&&Ao(e,"options"),e?.signal!=null&&Ro(e.signal,"options.signal"),t=dF(t),async function*(){var n;if(e!=null&&(n=e.signal)!==null&&n!==void 0&&n.aborted)throw new ci;for await(const a of this){var i;if(e!=null&&(i=e.signal)!==null&&i!==void 0&&i.aborted)throw new ci;if(t-- >0&&(yield a),t<=0)return}}.call(this)}IP.streamReturningOperators={asIndexedPairs:D7(V7,"readable.asIndexedPairs will be removed in a future version."),drop:X7,filter:kP,flatMap:J7,map:Ng,take:Z7,compose:L7};IP.promiseReturningOperators={every:k7,forEach:q7,reduce:W7,toArray:K7,some:cF,find:H7};var o0,QT;function fF(){if(QT)return o0;QT=1;const{ArrayPrototypePop:t,Promise:e}=Mt,{isIterable:r,isNodeStream:n,isWebStream:i}=qi,{pipelineImpl:a}=VP,{finished:o}=xa;hF();function s(...l){return new e((c,d)=>{let f,h;const p=l[l.length-1];if(p&&typeof p=="object"&&!n(p)&&!r(p)&&!i(p)){const b=t(l);f=b.signal,h=b.end}a(l,(b,g)=>{b?d(b):c(g)},{signal:f,end:h})})}return o0={finished:o,pipeline:s},o0}var eR;function hF(){if(eR)return Vw.exports;eR=1;const{Buffer:t}=ki,{ObjectDefineProperty:e,ObjectKeys:r,ReflectApply:n}=Mt,{promisify:{custom:i}}=Ir,{streamReturningOperators:a,promiseReturningOperators:o}=IP,{codes:{ERR_ILLEGAL_CONSTRUCTOR:s}}=mr,l=uF,{setDefaultHighWaterMark:c,getDefaultHighWaterMark:d}=xg,{pipeline:f}=VP,{destroyer:h}=Uu,p=xa,b=fF(),g=qi,v=Vw.exports=zP.Stream;v.isDestroyed=g.isDestroyed,v.isDisturbed=g.isDisturbed,v.isErrored=g.isErrored,v.isReadable=g.isReadable,v.isWritable=g.isWritable,v.Readable=Dg();for(const C of r(a)){let N=function(...D){if(new.target)throw s();return v.Readable.from(n(S,this,D))};const S=a[C];e(N,"name",{__proto__:null,value:S.name}),e(N,"length",{__proto__:null,value:S.length}),e(v.Readable.prototype,C,{__proto__:null,value:N,enumerable:!1,configurable:!0,writable:!0})}for(const C of r(o)){let N=function(...D){if(new.target)throw s();return n(S,this,D)};const S=o[C];e(N,"name",{__proto__:null,value:S.name}),e(N,"length",{__proto__:null,value:S.length}),e(v.Readable.prototype,C,{__proto__:null,value:N,enumerable:!1,configurable:!0,writable:!0})}v.Writable=UP(),v.Duplex=Fi(),v.Transform=iF,v.PassThrough=oF,v.pipeline=f;const{addAbortSignal:E}=Ig;return v.addAbortSignal=E,v.finished=p,v.destroy=h,v.compose=l,v.setDefaultHighWaterMark=c,v.getDefaultHighWaterMark=d,e(v,"promises",{__proto__:null,configurable:!0,enumerable:!0,get(){return b}}),e(f,i,{__proto__:null,enumerable:!0,get(){return b.pipeline}}),e(p,i,{__proto__:null,enumerable:!0,get(){return b.finished}}),v.Stream=v,v._isUint8Array=function(S){return S instanceof Uint8Array},v._uint8ArrayToBuffer=function(S){return t.from(S.buffer,S.byteOffset,S.byteLength)},Vw.exports}(function(t){const e=hF(),r=fF(),n=e.Readable.destroy;t.exports=e.Readable,t.exports._uint8ArrayToBuffer=e._uint8ArrayToBuffer,t.exports._isUint8Array=e._isUint8Array,t.exports.isDisturbed=e.isDisturbed,t.exports.isErrored=e.isErrored,t.exports.isReadable=e.isReadable,t.exports.Readable=e.Readable,t.exports.Writable=e.Writable,t.exports.Duplex=e.Duplex,t.exports.Transform=e.Transform,t.exports.PassThrough=e.PassThrough,t.exports.addAbortSignal=e.addAbortSignal,t.exports.finished=e.finished,t.exports.destroy=e.destroy,t.exports.destroy=n,t.exports.pipeline=e.pipeline,t.exports.compose=e.compose,Object.defineProperty(e,"promises",{configurable:!0,enumerable:!0,get(){return r}}),t.exports.Stream=e.Stream,t.exports.default=t.exports})(bU);var $y=bU.exports,P={},pF={},vu={},zg={},Fu=TypeError;const Y7=jo(fW);var HP=typeof Map=="function"&&Map.prototype,s0=Object.getOwnPropertyDescriptor&&HP?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,Iy=HP&&s0&&typeof s0.get=="function"?s0.get:null,tR=HP&&Map.prototype.forEach,qP=typeof Set=="function"&&Set.prototype,u0=Object.getOwnPropertyDescriptor&&qP?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,xy=qP&&u0&&typeof u0.get=="function"?u0.get:null,rR=qP&&Set.prototype.forEach,Q7=typeof WeakMap=="function"&&WeakMap.prototype,vc=Q7?WeakMap.prototype.has:null,eZ=typeof WeakSet=="function"&&WeakSet.prototype,wc=eZ?WeakSet.prototype.has:null,tZ=typeof WeakRef=="function"&&WeakRef.prototype,nR=tZ?WeakRef.prototype.deref:null,rZ=Boolean.prototype.valueOf,nZ=Object.prototype.toString,iZ=Function.prototype.toString,aZ=String.prototype.match,GP=String.prototype.slice,ga=String.prototype.replace,oZ=String.prototype.toUpperCase,iR=String.prototype.toLowerCase,_F=RegExp.prototype.test,aR=Array.prototype.concat,ei=Array.prototype.join,sZ=Array.prototype.slice,oR=Math.floor,TS=typeof BigInt=="function"?BigInt.prototype.valueOf:null,l0=Object.getOwnPropertySymbols,RS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,wu=typeof Symbol=="function"&&typeof Symbol.iterator=="object",Oc=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===wu||!0)?Symbol.toStringTag:null,yF=Object.prototype.propertyIsEnumerable,sR=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(t){return t.__proto__}:null);function uR(t,e){if(t===1/0||t===-1/0||t!==t||t&&t>-1e3&&t<1e3||_F.call(/e/,e))return e;var r=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof t=="number"){var n=t<0?-oR(-t):oR(t);if(n!==t){var i=String(n),a=GP.call(e,i.length+1);return ga.call(i,r,"$&_")+"."+ga.call(ga.call(a,/([0-9]{3})/g,"$&_"),/_$/,"")}}return ga.call(e,r,"$&_")}var AS=Y7,lR=AS.custom,cR=mF(lR)?lR:null,bF={__proto__:null,double:'"',single:"'"},uZ={__proto__:null,double:/(["\\])/g,single:/(['\\])/g},Bg=function t(e,r,n,i){var a=r||{};if(Ci(a,"quoteStyle")&&!Ci(bF,a.quoteStyle))throw new TypeError('option "quoteStyle" must be "single" or "double"');if(Ci(a,"maxStringLength")&&(typeof a.maxStringLength=="number"?a.maxStringLength<0&&a.maxStringLength!==1/0:a.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var o=Ci(a,"customInspect")?a.customInspect:!0;if(typeof o!="boolean"&&o!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(Ci(a,"indent")&&a.indent!==null&&a.indent!=="	"&&!(parseInt(a.indent,10)===a.indent&&a.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(Ci(a,"numericSeparator")&&typeof a.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var s=a.numericSeparator;if(typeof e>"u")return"undefined";if(e===null)return"null";if(typeof e=="boolean")return e?"true":"false";if(typeof e=="string")return wF(e,a);if(typeof e=="number"){if(e===0)return 1/0/e>0?"0":"-0";var l=String(e);return s?uR(e,l):l}if(typeof e=="bigint"){var c=String(e)+"n";return s?uR(e,c):c}var d=typeof a.depth>"u"?5:a.depth;if(typeof n>"u"&&(n=0),n>=d&&d>0&&typeof e=="object")return $S(e)?"[Array]":"[Object]";var f=jZ(a,n);if(typeof i>"u")i=[];else if(vF(i,e)>=0)return"[Circular]";function h(I,x,A){if(x&&(i=sZ.call(i),i.push(x)),A){var V={depth:a.depth};return Ci(a,"quoteStyle")&&(V.quoteStyle=a.quoteStyle),t(I,V,n+1,i)}return t(I,a,n+1,i)}if(typeof e=="function"&&!dR(e)){var p=bZ(e),b=s_(e,h);return"[Function"+(p?": "+p:" (anonymous)")+"]"+(b.length>0?" { "+ei.call(b,", ")+" }":"")}if(mF(e)){var g=wu?ga.call(String(e),/^(Symbol\(.*\))_[^)]*$/,"$1"):RS.call(e);return typeof e=="object"&&!wu?Sl(g):g}if(SZ(e)){for(var v="<"+iR.call(String(e.nodeName)),E=e.attributes||[],C=0;C<E.length;C++)v+=" "+E[C].name+"="+gF(lZ(E[C].value),"double",a);return v+=">",e.childNodes&&e.childNodes.length&&(v+="..."),v+="</"+iR.call(String(e.nodeName))+">",v}if($S(e)){if(e.length===0)return"[]";var S=s_(e,h);return f&&!PZ(S)?"["+IS(S,f)+"]":"[ "+ei.call(S,", ")+" ]"}if(dZ(e)){var N=s_(e,h);return!("cause"in Error.prototype)&&"cause"in e&&!yF.call(e,"cause")?"{ ["+String(e)+"] "+ei.call(aR.call("[cause]: "+h(e.cause),N),", ")+" }":N.length===0?"["+String(e)+"]":"{ ["+String(e)+"] "+ei.call(N,", ")+" }"}if(typeof e=="object"&&o){if(cR&&typeof e[cR]=="function"&&AS)return AS(e,{depth:d-n});if(o!=="symbol"&&typeof e.inspect=="function")return e.inspect()}if(gZ(e)){var D=[];return tR&&tR.call(e,function(I,x){D.push(h(x,e,!0)+" => "+h(I,e))}),fR("Map",Iy.call(e),D,f)}if(wZ(e)){var Z=[];return rR&&rR.call(e,function(I){Z.push(h(I,e))}),fR("Set",xy.call(e),Z,f)}if(mZ(e))return c0("WeakMap");if(OZ(e))return c0("WeakSet");if(vZ(e))return c0("WeakRef");if(hZ(e))return Sl(h(Number(e)));if(_Z(e))return Sl(h(TS.call(e)));if(pZ(e))return Sl(rZ.call(e));if(fZ(e))return Sl(h(String(e)));if(typeof window<"u"&&e===window)return"{ [object Window] }";if(typeof globalThis<"u"&&e===globalThis||typeof u<"u"&&e===u)return"{ [object globalThis] }";if(!cZ(e)&&!dR(e)){var se=s_(e,h),re=sR?sR(e)===Object.prototype:e instanceof Object||e.constructor===Object,k=e instanceof Object?"":"null prototype",ee=!re&&Oc&&Object(e)===e&&Oc in e?GP.call(Da(e),8,-1):k?"Object":"",X=re||typeof e.constructor!="function"?"":e.constructor.name?e.constructor.name+" ":"",te=X+(ee||k?"["+ei.call(aR.call([],ee||[],k||[]),": ")+"] ":"");return se.length===0?te+"{}":f?te+"{"+IS(se,f)+"}":te+"{ "+ei.call(se,", ")+" }"}return String(e)};function gF(t,e,r){var n=r.quoteStyle||e,i=bF[n];return i+t+i}function lZ(t){return ga.call(String(t),/"/g,"&quot;")}function $o(t){return!Oc||!(typeof t=="object"&&(Oc in t||typeof t[Oc]<"u"))}function $S(t){return Da(t)==="[object Array]"&&$o(t)}function cZ(t){return Da(t)==="[object Date]"&&$o(t)}function dR(t){return Da(t)==="[object RegExp]"&&$o(t)}function dZ(t){return Da(t)==="[object Error]"&&$o(t)}function fZ(t){return Da(t)==="[object String]"&&$o(t)}function hZ(t){return Da(t)==="[object Number]"&&$o(t)}function pZ(t){return Da(t)==="[object Boolean]"&&$o(t)}function mF(t){if(wu)return t&&typeof t=="object"&&t instanceof Symbol;if(typeof t=="symbol")return!0;if(!t||typeof t!="object"||!RS)return!1;try{return RS.call(t),!0}catch{}return!1}function _Z(t){if(!t||typeof t!="object"||!TS)return!1;try{return TS.call(t),!0}catch{}return!1}var yZ=Object.prototype.hasOwnProperty||function(t){return t in this};function Ci(t,e){return yZ.call(t,e)}function Da(t){return nZ.call(t)}function bZ(t){if(t.name)return t.name;var e=aZ.call(iZ.call(t),/^function\s*([\w$]+)/);return e?e[1]:null}function vF(t,e){if(t.indexOf)return t.indexOf(e);for(var r=0,n=t.length;r<n;r++)if(t[r]===e)return r;return-1}function gZ(t){if(!Iy||!t||typeof t!="object")return!1;try{Iy.call(t);try{xy.call(t)}catch{return!0}return t instanceof Map}catch{}return!1}function mZ(t){if(!vc||!t||typeof t!="object")return!1;try{vc.call(t,vc);try{wc.call(t,wc)}catch{return!0}return t instanceof WeakMap}catch{}return!1}function vZ(t){if(!nR||!t||typeof t!="object")return!1;try{return nR.call(t),!0}catch{}return!1}function wZ(t){if(!xy||!t||typeof t!="object")return!1;try{xy.call(t);try{Iy.call(t)}catch{return!0}return t instanceof Set}catch{}return!1}function OZ(t){if(!wc||!t||typeof t!="object")return!1;try{wc.call(t,wc);try{vc.call(t,vc)}catch{return!0}return t instanceof WeakSet}catch{}return!1}function SZ(t){return!t||typeof t!="object"?!1:typeof HTMLElement<"u"&&t instanceof HTMLElement?!0:typeof t.nodeName=="string"&&typeof t.getAttribute=="function"}function wF(t,e){if(t.length>e.maxStringLength){var r=t.length-e.maxStringLength,n="... "+r+" more character"+(r>1?"s":"");return wF(GP.call(t,0,e.maxStringLength),e)+n}var i=uZ[e.quoteStyle||"single"];i.lastIndex=0;var a=ga.call(ga.call(t,i,"\\$1"),/[\x00-\x1f]/g,EZ);return gF(a,"single",e)}function EZ(t){var e=t.charCodeAt(0),r={8:"b",9:"t",10:"n",12:"f",13:"r"}[e];return r?"\\"+r:"\\x"+(e<16?"0":"")+oZ.call(e.toString(16))}function Sl(t){return"Object("+t+")"}function c0(t){return t+" { ? }"}function fR(t,e,r,n){var i=n?IS(r,n):ei.call(r,", ");return t+" ("+e+") {"+i+"}"}function PZ(t){for(var e=0;e<t.length;e++)if(vF(t[e],`
`)>=0)return!1;return!0}function jZ(t,e){var r;if(t.indent==="	")r="	";else if(typeof t.indent=="number"&&t.indent>0)r=ei.call(Array(t.indent+1)," ");else return null;return{base:r,prev:ei.call(Array(e+1),r)}}function IS(t,e){if(t.length===0)return"";var r=`
`+e.prev+e.base;return r+ei.call(t,","+r)+`
`+e.prev}function s_(t,e){var r=$S(t),n=[];if(r){n.length=t.length;for(var i=0;i<t.length;i++)n[i]=Ci(t,i)?e(t[i],t):""}var a=typeof l0=="function"?l0(t):[],o;if(wu){o={};for(var s=0;s<a.length;s++)o["$"+a[s]]=a[s]}for(var l in t)Ci(t,l)&&(r&&String(Number(l))===l&&l<t.length||wu&&o["$"+l]instanceof Symbol||(_F.call(/[^\w$]/,l)?n.push(e(l,t)+": "+e(t[l],t)):n.push(l+": "+e(t[l],t))));if(typeof l0=="function")for(var c=0;c<a.length;c++)yF.call(t,a[c])&&n.push("["+e(a[c])+"]: "+e(t[a[c]],t));return n}var CZ=Bg,MZ=Fu,Ug=function(t,e,r){for(var n=t,i;(i=n.next)!=null;n=i)if(i.key===e)return n.next=i.next,r||(i.next=t.next,t.next=i),i},TZ=function(t,e){if(t){var r=Ug(t,e);return r&&r.value}},RZ=function(t,e,r){var n=Ug(t,e);n?n.value=r:t.next={key:e,next:t.next,value:r}},AZ=function(t,e){return t?!!Ug(t,e):!1},$Z=function(t,e){if(t)return Ug(t,e,!0)},IZ=function(){var e,r={assert:function(n){if(!r.has(n))throw new MZ("Side channel does not contain "+CZ(n))},delete:function(n){var i=e&&e.next,a=$Z(e,n);return a&&i&&i===a&&(e=void 0),!!a},get:function(n){return TZ(e,n)},has:function(n){return AZ(e,n)},set:function(n,i){e||(e={next:void 0}),RZ(e,n,i)}};return r},OF=Object,xZ=Error,DZ=EvalError,NZ=RangeError,zZ=ReferenceError,BZ=SyntaxError,UZ=URIError,FZ=Math.abs,LZ=Math.floor,VZ=Math.max,kZ=Math.min,HZ=Math.pow,qZ=Math.round,GZ=Number.isNaN||function(e){return e!==e},WZ=GZ,KZ=function(e){return WZ(e)||e===0?e:e<0?-1:1},JZ=Object.getOwnPropertyDescriptor,Z_=JZ;if(Z_)try{Z_([],"length")}catch{Z_=null}var SF=Z_,Y_=Object.defineProperty||!1;if(Y_)try{Y_({},"a",{value:1})}catch{Y_=!1}var XZ=Y_,d0,hR;function ZZ(){return hR||(hR=1,d0=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},r=Symbol("test"),n=Object(r);if(typeof r=="string"||Object.prototype.toString.call(r)!=="[object Symbol]"||Object.prototype.toString.call(n)!=="[object Symbol]")return!1;var i=42;e[r]=i;for(var a in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var o=Object.getOwnPropertySymbols(e);if(o.length!==1||o[0]!==r||!Object.prototype.propertyIsEnumerable.call(e,r))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var s=Object.getOwnPropertyDescriptor(e,r);if(s.value!==i||s.enumerable!==!0)return!1}return!0}),d0}var f0,pR;function YZ(){if(pR)return f0;pR=1;var t=typeof Symbol<"u"&&Symbol,e=ZZ();return f0=function(){return typeof t!="function"||typeof Symbol!="function"||typeof t("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:e()},f0}var h0,_R;function EF(){return _R||(_R=1,h0=typeof Reflect<"u"&&Reflect.getPrototypeOf||null),h0}var p0,yR;function PF(){if(yR)return p0;yR=1;var t=OF;return p0=t.getPrototypeOf||null,p0}var QZ="Function.prototype.bind called on incompatible ",eY=Object.prototype.toString,tY=Math.max,rY="[object Function]",bR=function(e,r){for(var n=[],i=0;i<e.length;i+=1)n[i]=e[i];for(var a=0;a<r.length;a+=1)n[a+e.length]=r[a];return n},nY=function(e,r){for(var n=[],i=r,a=0;i<e.length;i+=1,a+=1)n[a]=e[i];return n},iY=function(t,e){for(var r="",n=0;n<t.length;n+=1)r+=t[n],n+1<t.length&&(r+=e);return r},aY=function(e){var r=this;if(typeof r!="function"||eY.apply(r)!==rY)throw new TypeError(QZ+r);for(var n=nY(arguments,1),i,a=function(){if(this instanceof i){var d=r.apply(this,bR(n,arguments));return Object(d)===d?d:this}return r.apply(e,bR(n,arguments))},o=tY(0,r.length-n.length),s=[],l=0;l<o;l++)s[l]="$"+l;if(i=Function("binder","return function ("+iY(s,",")+"){ return binder.apply(this,arguments); }")(a),r.prototype){var c=function(){};c.prototype=r.prototype,i.prototype=new c,c.prototype=null}return i},oY=aY,Fg=Function.prototype.bind||oY,WP=Function.prototype.call,_0,gR;function jF(){return gR||(gR=1,_0=Function.prototype.apply),_0}var sY=typeof Reflect<"u"&&Reflect&&Reflect.apply,uY=Fg,lY=jF(),cY=WP,dY=sY,fY=dY||uY.call(cY,lY),hY=Fg,pY=Fu,_Y=WP,yY=fY,CF=function(e){if(e.length<1||typeof e[0]!="function")throw new pY("a function is required");return yY(hY,_Y,e)},y0,mR;function bY(){if(mR)return y0;mR=1;var t=CF,e=SF,r;try{r=[].__proto__===Array.prototype}catch(o){if(!o||typeof o!="object"||!("code"in o)||o.code!=="ERR_PROTO_ACCESS")throw o}var n=!!r&&e&&e(Object.prototype,"__proto__"),i=Object,a=i.getPrototypeOf;return y0=n&&typeof n.get=="function"?t([n.get]):typeof a=="function"?function(s){return a(s==null?s:i(s))}:!1,y0}var b0,vR;function gY(){if(vR)return b0;vR=1;var t=EF(),e=PF(),r=bY();return b0=t?function(i){return t(i)}:e?function(i){if(!i||typeof i!="object"&&typeof i!="function")throw new TypeError("getProto: not an object");return e(i)}:r?function(i){return r(i)}:null,b0}var g0,wR;function mY(){if(wR)return g0;wR=1;var t=Function.prototype.call,e=Object.prototype.hasOwnProperty,r=Fg;return g0=r.call(t,e),g0}var He,vY=OF,wY=xZ,OY=DZ,SY=NZ,EY=zZ,Ou=BZ,Js=Fu,PY=UZ,jY=FZ,CY=LZ,MY=VZ,TY=kZ,RY=HZ,AY=qZ,$Y=KZ,MF=Function,m0=function(t){try{return MF('"use strict"; return ('+t+").constructor;")()}catch{}},Gc=SF,IY=XZ,v0=function(){throw new Js},xY=Gc?function(){try{return arguments.callee,v0}catch{try{return Gc(arguments,"callee").get}catch{return v0}}}():v0,ts=YZ()(),qt=gY(),DY=PF(),NY=EF(),TF=jF(),yd=WP,Ts={},zY=typeof Uint8Array>"u"||!qt?He:qt(Uint8Array),bo={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?He:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?He:ArrayBuffer,"%ArrayIteratorPrototype%":ts&&qt?qt([][Symbol.iterator]()):He,"%AsyncFromSyncIteratorPrototype%":He,"%AsyncFunction%":Ts,"%AsyncGenerator%":Ts,"%AsyncGeneratorFunction%":Ts,"%AsyncIteratorPrototype%":Ts,"%Atomics%":typeof Atomics>"u"?He:Atomics,"%BigInt%":typeof BigInt>"u"?He:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?He:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?He:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?He:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":wY,"%eval%":eval,"%EvalError%":OY,"%Float16Array%":typeof Float16Array>"u"?He:Float16Array,"%Float32Array%":typeof Float32Array>"u"?He:Float32Array,"%Float64Array%":typeof Float64Array>"u"?He:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?He:FinalizationRegistry,"%Function%":MF,"%GeneratorFunction%":Ts,"%Int8Array%":typeof Int8Array>"u"?He:Int8Array,"%Int16Array%":typeof Int16Array>"u"?He:Int16Array,"%Int32Array%":typeof Int32Array>"u"?He:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":ts&&qt?qt(qt([][Symbol.iterator]())):He,"%JSON%":typeof JSON=="object"?JSON:He,"%Map%":typeof Map>"u"?He:Map,"%MapIteratorPrototype%":typeof Map>"u"||!ts||!qt?He:qt(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":vY,"%Object.getOwnPropertyDescriptor%":Gc,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?He:Promise,"%Proxy%":typeof Proxy>"u"?He:Proxy,"%RangeError%":SY,"%ReferenceError%":EY,"%Reflect%":typeof Reflect>"u"?He:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?He:Set,"%SetIteratorPrototype%":typeof Set>"u"||!ts||!qt?He:qt(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?He:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":ts&&qt?qt(""[Symbol.iterator]()):He,"%Symbol%":ts?Symbol:He,"%SyntaxError%":Ou,"%ThrowTypeError%":xY,"%TypedArray%":zY,"%TypeError%":Js,"%Uint8Array%":typeof Uint8Array>"u"?He:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?He:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?He:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?He:Uint32Array,"%URIError%":PY,"%WeakMap%":typeof WeakMap>"u"?He:WeakMap,"%WeakRef%":typeof WeakRef>"u"?He:WeakRef,"%WeakSet%":typeof WeakSet>"u"?He:WeakSet,"%Function.prototype.call%":yd,"%Function.prototype.apply%":TF,"%Object.defineProperty%":IY,"%Object.getPrototypeOf%":DY,"%Math.abs%":jY,"%Math.floor%":CY,"%Math.max%":MY,"%Math.min%":TY,"%Math.pow%":RY,"%Math.round%":AY,"%Math.sign%":$Y,"%Reflect.getPrototypeOf%":NY};if(qt)try{null.error}catch(t){var BY=qt(qt(t));bo["%Error.prototype%"]=BY}var UY=function t(e){var r;if(e==="%AsyncFunction%")r=m0("async function () {}");else if(e==="%GeneratorFunction%")r=m0("function* () {}");else if(e==="%AsyncGeneratorFunction%")r=m0("async function* () {}");else if(e==="%AsyncGenerator%"){var n=t("%AsyncGeneratorFunction%");n&&(r=n.prototype)}else if(e==="%AsyncIteratorPrototype%"){var i=t("%AsyncGenerator%");i&&qt&&(r=qt(i.prototype))}return bo[e]=r,r},OR={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},bd=Fg,Dy=mY(),FY=bd.call(yd,Array.prototype.concat),LY=bd.call(TF,Array.prototype.splice),SR=bd.call(yd,String.prototype.replace),Ny=bd.call(yd,String.prototype.slice),VY=bd.call(yd,RegExp.prototype.exec),kY=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,HY=/\\(\\)?/g,qY=function(e){var r=Ny(e,0,1),n=Ny(e,-1);if(r==="%"&&n!=="%")throw new Ou("invalid intrinsic syntax, expected closing `%`");if(n==="%"&&r!=="%")throw new Ou("invalid intrinsic syntax, expected opening `%`");var i=[];return SR(e,kY,function(a,o,s,l){i[i.length]=s?SR(l,HY,"$1"):o||a}),i},GY=function(e,r){var n=e,i;if(Dy(OR,n)&&(i=OR[n],n="%"+i[0]+"%"),Dy(bo,n)){var a=bo[n];if(a===Ts&&(a=UY(n)),typeof a>"u"&&!r)throw new Js("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:i,name:n,value:a}}throw new Ou("intrinsic "+e+" does not exist!")},KP=function(e,r){if(typeof e!="string"||e.length===0)throw new Js("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof r!="boolean")throw new Js('"allowMissing" argument must be a boolean');if(VY(/^%?[^%]*%?$/,e)===null)throw new Ou("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var n=qY(e),i=n.length>0?n[0]:"",a=GY("%"+i+"%",r),o=a.name,s=a.value,l=!1,c=a.alias;c&&(i=c[0],LY(n,FY([0,1],c)));for(var d=1,f=!0;d<n.length;d+=1){var h=n[d],p=Ny(h,0,1),b=Ny(h,-1);if((p==='"'||p==="'"||p==="`"||b==='"'||b==="'"||b==="`")&&p!==b)throw new Ou("property names with quotes must have matching quotes");if((h==="constructor"||!f)&&(l=!0),i+="."+h,o="%"+i+"%",Dy(bo,o))s=bo[o];else if(s!=null){if(!(h in s)){if(!r)throw new Js("base intrinsic for "+e+" exists, but the property is not available.");return}if(Gc&&d+1>=n.length){var g=Gc(s,h);f=!!g,f&&"get"in g&&!("originalValue"in g.get)?s=g.get:s=s[h]}else f=Dy(s,h),s=s[h];f&&!l&&(bo[o]=s)}}return s},RF=KP,AF=CF,WY=AF([RF("%String.prototype.indexOf%")]),$F=function(e,r){var n=RF(e,!!r);return typeof n=="function"&&WY(e,".prototype.")>-1?AF([n]):n},KY=KP,gd=$F,JY=Bg,XY=Fu,ER=KY("%Map%",!0),ZY=gd("Map.prototype.get",!0),YY=gd("Map.prototype.set",!0),QY=gd("Map.prototype.has",!0),eQ=gd("Map.prototype.delete",!0),tQ=gd("Map.prototype.size",!0),IF=!!ER&&function(){var e,r={assert:function(n){if(!r.has(n))throw new XY("Side channel does not contain "+JY(n))},delete:function(n){if(e){var i=eQ(e,n);return tQ(e)===0&&(e=void 0),i}return!1},get:function(n){if(e)return ZY(e,n)},has:function(n){return e?QY(e,n):!1},set:function(n,i){e||(e=new ER),YY(e,n,i)}};return r},rQ=KP,Lg=$F,nQ=Bg,u_=IF,iQ=Fu,rs=rQ("%WeakMap%",!0),aQ=Lg("WeakMap.prototype.get",!0),oQ=Lg("WeakMap.prototype.set",!0),sQ=Lg("WeakMap.prototype.has",!0),uQ=Lg("WeakMap.prototype.delete",!0),lQ=rs?function(){var e,r,n={assert:function(i){if(!n.has(i))throw new iQ("Side channel does not contain "+nQ(i))},delete:function(i){if(rs&&i&&(typeof i=="object"||typeof i=="function")){if(e)return uQ(e,i)}else if(u_&&r)return r.delete(i);return!1},get:function(i){return rs&&i&&(typeof i=="object"||typeof i=="function")&&e?aQ(e,i):r&&r.get(i)},has:function(i){return rs&&i&&(typeof i=="object"||typeof i=="function")&&e?sQ(e,i):!!r&&r.has(i)},set:function(i,a){rs&&i&&(typeof i=="object"||typeof i=="function")?(e||(e=new rs),oQ(e,i,a)):u_&&(r||(r=u_()),r.set(i,a))}};return n}:u_,cQ=Fu,dQ=Bg,fQ=IZ,hQ=IF,pQ=lQ,_Q=pQ||hQ||fQ,yQ=function(){var e,r={assert:function(n){if(!r.has(n))throw new cQ("Side channel does not contain "+dQ(n))},delete:function(n){return!!e&&e.delete(n)},get:function(n){return e&&e.get(n)},has:function(n){return!!e&&e.has(n)},set:function(n,i){e||(e=_Q()),e.set(n,i)}};return r},bQ=String.prototype.replace,gQ=/%20/g,w0={RFC1738:"RFC1738",RFC3986:"RFC3986"},JP={default:w0.RFC3986,formatters:{RFC1738:function(t){return bQ.call(t,gQ,"+")},RFC3986:function(t){return String(t)}},RFC1738:w0.RFC1738,RFC3986:w0.RFC3986},mQ=JP,O0=Object.prototype.hasOwnProperty,ao=Array.isArray,Hn=function(){for(var t=[],e=0;e<256;++e)t.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return t}(),vQ=function(e){for(;e.length>1;){var r=e.pop(),n=r.obj[r.prop];if(ao(n)){for(var i=[],a=0;a<n.length;++a)typeof n[a]<"u"&&i.push(n[a]);r.obj[r.prop]=i}}},xF=function(e,r){for(var n=r&&r.plainObjects?Object.create(null):{},i=0;i<e.length;++i)typeof e[i]<"u"&&(n[i]=e[i]);return n},wQ=function t(e,r,n){if(!r)return e;if(typeof r!="object"){if(ao(e))e.push(r);else if(e&&typeof e=="object")(n&&(n.plainObjects||n.allowPrototypes)||!O0.call(Object.prototype,r))&&(e[r]=!0);else return[e,r];return e}if(!e||typeof e!="object")return[e].concat(r);var i=e;return ao(e)&&!ao(r)&&(i=xF(e,n)),ao(e)&&ao(r)?(r.forEach(function(a,o){if(O0.call(e,o)){var s=e[o];s&&typeof s=="object"&&a&&typeof a=="object"?e[o]=t(s,a,n):e.push(a)}else e[o]=a}),e):Object.keys(r).reduce(function(a,o){var s=r[o];return O0.call(a,o)?a[o]=t(a[o],s,n):a[o]=s,a},i)},OQ=function(e,r){return Object.keys(r).reduce(function(n,i){return n[i]=r[i],n},e)},SQ=function(t,e,r){var n=t.replace(/\+/g," ");if(r==="iso-8859-1")return n.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(n)}catch{return n}},EQ=function(e,r,n,i,a){if(e.length===0)return e;var o=e;if(typeof e=="symbol"?o=Symbol.prototype.toString.call(e):typeof e!="string"&&(o=String(e)),n==="iso-8859-1")return escape(o).replace(/%u[0-9a-f]{4}/gi,function(d){return"%26%23"+parseInt(d.slice(2),16)+"%3B"});for(var s="",l=0;l<o.length;++l){var c=o.charCodeAt(l);if(c===45||c===46||c===95||c===126||c>=48&&c<=57||c>=65&&c<=90||c>=97&&c<=122||a===mQ.RFC1738&&(c===40||c===41)){s+=o.charAt(l);continue}if(c<128){s=s+Hn[c];continue}if(c<2048){s=s+(Hn[192|c>>6]+Hn[128|c&63]);continue}if(c<55296||c>=57344){s=s+(Hn[224|c>>12]+Hn[128|c>>6&63]+Hn[128|c&63]);continue}l+=1,c=65536+((c&1023)<<10|o.charCodeAt(l)&1023),s+=Hn[240|c>>18]+Hn[128|c>>12&63]+Hn[128|c>>6&63]+Hn[128|c&63]}return s},PQ=function(e){for(var r=[{obj:{o:e},prop:"o"}],n=[],i=0;i<r.length;++i)for(var a=r[i],o=a.obj[a.prop],s=Object.keys(o),l=0;l<s.length;++l){var c=s[l],d=o[c];typeof d=="object"&&d!==null&&n.indexOf(d)===-1&&(r.push({obj:o,prop:c}),n.push(d))}return vQ(r),e},jQ=function(e){return Object.prototype.toString.call(e)==="[object RegExp]"},CQ=function(e){return!e||typeof e!="object"?!1:!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},MQ=function(e,r){return[].concat(e,r)},TQ=function(e,r){if(ao(e)){for(var n=[],i=0;i<e.length;i+=1)n.push(r(e[i]));return n}return r(e)},DF={arrayToObject:xF,assign:OQ,combine:MQ,compact:PQ,decode:SQ,encode:EQ,isBuffer:CQ,isRegExp:jQ,maybeMap:TQ,merge:wQ},NF=yQ,Q_=DF,Sc=JP,RQ=Object.prototype.hasOwnProperty,PR={brackets:function(e){return e+"[]"},comma:"comma",indices:function(e,r){return e+"["+r+"]"},repeat:function(e){return e}},Mi=Array.isArray,AQ=Array.prototype.push,zF=function(t,e){AQ.apply(t,Mi(e)?e:[e])},$Q=Date.prototype.toISOString,jR=Sc.default,ur={addQueryPrefix:!1,allowDots:!1,charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encoder:Q_.encode,encodeValuesOnly:!1,format:jR,formatter:Sc.formatters[jR],indices:!1,serializeDate:function(e){return $Q.call(e)},skipNulls:!1,strictNullHandling:!1},IQ=function(e){return typeof e=="string"||typeof e=="number"||typeof e=="boolean"||typeof e=="symbol"||typeof e=="bigint"},S0={},xQ=function t(e,r,n,i,a,o,s,l,c,d,f,h,p,b,g,v){for(var E=e,C=v,S=0,N=!1;(C=C.get(S0))!==void 0&&!N;){var D=C.get(e);if(S+=1,typeof D<"u"){if(D===S)throw new RangeError("Cyclic object value");N=!0}typeof C.get(S0)>"u"&&(S=0)}if(typeof l=="function"?E=l(r,E):E instanceof Date?E=f(E):n==="comma"&&Mi(E)&&(E=Q_.maybeMap(E,function(V){return V instanceof Date?f(V):V})),E===null){if(a)return s&&!b?s(r,ur.encoder,g,"key",h):r;E=""}if(IQ(E)||Q_.isBuffer(E)){if(s){var Z=b?r:s(r,ur.encoder,g,"key",h);return[p(Z)+"="+p(s(E,ur.encoder,g,"value",h))]}return[p(r)+"="+p(String(E))]}var se=[];if(typeof E>"u")return se;var re;if(n==="comma"&&Mi(E))b&&s&&(E=Q_.maybeMap(E,s)),re=[{value:E.length>0?E.join(",")||null:void 0}];else if(Mi(l))re=l;else{var k=Object.keys(E);re=c?k.sort(c):k}for(var ee=i&&Mi(E)&&E.length===1?r+"[]":r,X=0;X<re.length;++X){var te=re[X],I=typeof te=="object"&&typeof te.value<"u"?te.value:E[te];if(!(o&&I===null)){var x=Mi(E)?typeof n=="function"?n(ee,te):ee:ee+(d?"."+te:"["+te+"]");v.set(e,S);var A=NF();A.set(S0,v),zF(se,t(I,x,n,i,a,o,n==="comma"&&b&&Mi(E)?null:s,l,c,d,f,h,p,b,g,A))}}return se},DQ=function(e){if(!e)return ur;if(e.encoder!==null&&typeof e.encoder<"u"&&typeof e.encoder!="function")throw new TypeError("Encoder has to be a function.");var r=e.charset||ur.charset;if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var n=Sc.default;if(typeof e.format<"u"){if(!RQ.call(Sc.formatters,e.format))throw new TypeError("Unknown format option provided.");n=e.format}var i=Sc.formatters[n],a=ur.filter;return(typeof e.filter=="function"||Mi(e.filter))&&(a=e.filter),{addQueryPrefix:typeof e.addQueryPrefix=="boolean"?e.addQueryPrefix:ur.addQueryPrefix,allowDots:typeof e.allowDots>"u"?ur.allowDots:!!e.allowDots,charset:r,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:ur.charsetSentinel,delimiter:typeof e.delimiter>"u"?ur.delimiter:e.delimiter,encode:typeof e.encode=="boolean"?e.encode:ur.encode,encoder:typeof e.encoder=="function"?e.encoder:ur.encoder,encodeValuesOnly:typeof e.encodeValuesOnly=="boolean"?e.encodeValuesOnly:ur.encodeValuesOnly,filter:a,format:n,formatter:i,serializeDate:typeof e.serializeDate=="function"?e.serializeDate:ur.serializeDate,skipNulls:typeof e.skipNulls=="boolean"?e.skipNulls:ur.skipNulls,sort:typeof e.sort=="function"?e.sort:null,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:ur.strictNullHandling}},NQ=function(t,e){var r=t,n=DQ(e),i,a;typeof n.filter=="function"?(a=n.filter,r=a("",r)):Mi(n.filter)&&(a=n.filter,i=a);var o=[];if(typeof r!="object"||r===null)return"";var s;e&&e.arrayFormat in PR?s=e.arrayFormat:e&&"indices"in e?s=e.indices?"indices":"repeat":s="indices";var l=PR[s];if(e&&"commaRoundTrip"in e&&typeof e.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var c=l==="comma"&&e&&e.commaRoundTrip;i||(i=Object.keys(r)),n.sort&&i.sort(n.sort);for(var d=NF(),f=0;f<i.length;++f){var h=i[f];n.skipNulls&&r[h]===null||zF(o,xQ(r[h],h,l,c,n.strictNullHandling,n.skipNulls,n.encode?n.encoder:null,n.filter,n.sort,n.allowDots,n.serializeDate,n.format,n.formatter,n.encodeValuesOnly,n.charset,d))}var p=o.join(n.delimiter),b=n.addQueryPrefix===!0?"?":"";return n.charsetSentinel&&(n.charset==="iso-8859-1"?b+="utf8=%26%2310003%3B&":b+="utf8=%E2%9C%93&"),p.length>0?b+p:""},Su=DF,xS=Object.prototype.hasOwnProperty,zQ=Array.isArray,Ht={allowDots:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decoder:Su.decode,delimiter:"&",depth:5,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},BQ=function(t){return t.replace(/&#(\d+);/g,function(e,r){return String.fromCharCode(parseInt(r,10))})},BF=function(t,e){return t&&typeof t=="string"&&e.comma&&t.indexOf(",")>-1?t.split(","):t},UQ="utf8=%26%2310003%3B",FQ="utf8=%E2%9C%93",LQ=function(e,r){var n={__proto__:null},i=r.ignoreQueryPrefix?e.replace(/^\?/,""):e,a=r.parameterLimit===1/0?void 0:r.parameterLimit,o=i.split(r.delimiter,a),s=-1,l,c=r.charset;if(r.charsetSentinel)for(l=0;l<o.length;++l)o[l].indexOf("utf8=")===0&&(o[l]===FQ?c="utf-8":o[l]===UQ&&(c="iso-8859-1"),s=l,l=o.length);for(l=0;l<o.length;++l)if(l!==s){var d=o[l],f=d.indexOf("]="),h=f===-1?d.indexOf("="):f+1,p,b;h===-1?(p=r.decoder(d,Ht.decoder,c,"key"),b=r.strictNullHandling?null:""):(p=r.decoder(d.slice(0,h),Ht.decoder,c,"key"),b=Su.maybeMap(BF(d.slice(h+1),r),function(g){return r.decoder(g,Ht.decoder,c,"value")})),b&&r.interpretNumericEntities&&c==="iso-8859-1"&&(b=BQ(b)),d.indexOf("[]=")>-1&&(b=zQ(b)?[b]:b),xS.call(n,p)?n[p]=Su.combine(n[p],b):n[p]=b}return n},VQ=function(t,e,r,n){for(var i=n?e:BF(e,r),a=t.length-1;a>=0;--a){var o,s=t[a];if(s==="[]"&&r.parseArrays)o=[].concat(i);else{o=r.plainObjects?Object.create(null):{};var l=s.charAt(0)==="["&&s.charAt(s.length-1)==="]"?s.slice(1,-1):s,c=parseInt(l,10);!r.parseArrays&&l===""?o={0:i}:!isNaN(c)&&s!==l&&String(c)===l&&c>=0&&r.parseArrays&&c<=r.arrayLimit?(o=[],o[c]=i):l!=="__proto__"&&(o[l]=i)}i=o}return i},kQ=function(e,r,n,i){if(e){var a=n.allowDots?e.replace(/\.([^.[]+)/g,"[$1]"):e,o=/(\[[^[\]]*])/,s=/(\[[^[\]]*])/g,l=n.depth>0&&o.exec(a),c=l?a.slice(0,l.index):a,d=[];if(c){if(!n.plainObjects&&xS.call(Object.prototype,c)&&!n.allowPrototypes)return;d.push(c)}for(var f=0;n.depth>0&&(l=s.exec(a))!==null&&f<n.depth;){if(f+=1,!n.plainObjects&&xS.call(Object.prototype,l[1].slice(1,-1))&&!n.allowPrototypes)return;d.push(l[1])}return l&&d.push("["+a.slice(l.index)+"]"),VQ(d,r,n,i)}},HQ=function(e){if(!e)return Ht;if(e.decoder!==null&&e.decoder!==void 0&&typeof e.decoder!="function")throw new TypeError("Decoder has to be a function.");if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var r=typeof e.charset>"u"?Ht.charset:e.charset;return{allowDots:typeof e.allowDots>"u"?Ht.allowDots:!!e.allowDots,allowPrototypes:typeof e.allowPrototypes=="boolean"?e.allowPrototypes:Ht.allowPrototypes,allowSparse:typeof e.allowSparse=="boolean"?e.allowSparse:Ht.allowSparse,arrayLimit:typeof e.arrayLimit=="number"?e.arrayLimit:Ht.arrayLimit,charset:r,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:Ht.charsetSentinel,comma:typeof e.comma=="boolean"?e.comma:Ht.comma,decoder:typeof e.decoder=="function"?e.decoder:Ht.decoder,delimiter:typeof e.delimiter=="string"||Su.isRegExp(e.delimiter)?e.delimiter:Ht.delimiter,depth:typeof e.depth=="number"||e.depth===!1?+e.depth:Ht.depth,ignoreQueryPrefix:e.ignoreQueryPrefix===!0,interpretNumericEntities:typeof e.interpretNumericEntities=="boolean"?e.interpretNumericEntities:Ht.interpretNumericEntities,parameterLimit:typeof e.parameterLimit=="number"?e.parameterLimit:Ht.parameterLimit,parseArrays:e.parseArrays!==!1,plainObjects:typeof e.plainObjects=="boolean"?e.plainObjects:Ht.plainObjects,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:Ht.strictNullHandling}},qQ=function(t,e){var r=HQ(e);if(t===""||t===null||typeof t>"u")return r.plainObjects?Object.create(null):{};for(var n=typeof t=="string"?LQ(t,r):t,i=r.plainObjects?Object.create(null):{},a=Object.keys(n),o=0;o<a.length;++o){var s=a[o],l=kQ(s,n[s],r,typeof t=="string");i=Su.merge(i,l,r)}return r.allowSparse===!0?i:Su.compact(i)},GQ=NQ,WQ=qQ,KQ=JP,JQ={formats:KQ,parse:WQ,stringify:GQ},XQ=u&&u.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(zg,"__esModule",{value:!0});zg.createRequestUrl=void 0;const ZQ=XQ(JQ);function YQ(t,e){return Object.keys(e??{}).length>0?`${t}?${ZQ.default.stringify(e,{arrayFormat:"repeat"})}`:t}zg.createRequestUrl=YQ;var Vg={},Lu={},kg={},E0,P0,j0,C0,M0;Object.defineProperty(kg,"__esModule",{value:!0});kg.RUNTIME=void 0;const QQ=typeof window<"u"&&typeof window.document<"u",eee=typeof self=="object"&&typeof self?.importScripts=="function"&&(((E0=self.constructor)===null||E0===void 0?void 0:E0.name)==="DedicatedWorkerGlobalScope"||((P0=self.constructor)===null||P0===void 0?void 0:P0.name)==="ServiceWorkerGlobalScope"||((j0=self.constructor)===null||j0===void 0?void 0:j0.name)==="SharedWorkerGlobalScope"),UF=typeof Deno<"u"&&typeof Deno.version<"u"&&typeof Deno.version.deno<"u",FF=typeof Bun<"u"&&typeof Bun.version<"u",tee=typeof process<"u"&&!!process.version&&!!(!((C0=process.versions)===null||C0===void 0)&&C0.node)&&!UF&&!FF,ree=typeof navigator<"u"&&navigator?.product==="ReactNative",nee=typeof globalThis<"u"&&((M0=globalThis?.navigator)===null||M0===void 0?void 0:M0.userAgent)==="Cloudflare-Workers";kg.RUNTIME=iee();function iee(){return QQ?{type:"browser",version:window.navigator.userAgent}:nee?{type:"workerd"}:eee?{type:"web-worker"}:UF?{type:"deno",version:Deno.version.deno}:FF?{type:"bun",version:Bun.version}:tee?{type:"node",version:process.versions.node,parsedVersion:Number(process.versions.node.split(".")[0])}:ree?{type:"react-native"}:{type:"unknown"}}(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.RUNTIME=void 0;var e=kg;Object.defineProperty(t,"RUNTIME",{enumerable:!0,get:function(){return e.RUNTIME}})})(Lu);var l_={exports:{}},CR;function MR(){return CR||(CR=1,function(t,e){var r=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof u<"u")return u;throw new Error("unable to locate global object")},n=r();t.exports=e=n.fetch,n.fetch&&(e.default=n.fetch.bind(n)),e.Headers=n.Headers,e.Request=n.Request,e.Response=n.Response}(l_,l_.exports)),l_.exports}var aee=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),oee=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),TR=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&aee(e,t,r);return oee(e,t),e},see=u&&u.__awaiter||function(t,e,r,n){function i(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function s(d){try{c(n.next(d))}catch(f){o(f)}}function l(d){try{c(n.throw(d))}catch(f){o(f)}}function c(d){d.done?a(d.value):i(d.value).then(s,l)}c((n=n.apply(t,e||[])).next())})};Object.defineProperty(Vg,"__esModule",{value:!0});Vg.getFetchFn=void 0;const c_=Lu;function uee(){return see(this,void 0,void 0,function*(){return c_.RUNTIME.type==="node"&&c_.RUNTIME.parsedVersion!=null&&c_.RUNTIME.parsedVersion>=18?fetch:c_.RUNTIME.type==="node"?(yield Promise.resolve().then(()=>TR(MR()))).default:typeof fetch=="function"?fetch:(yield Promise.resolve().then(()=>TR(MR()))).default})}Vg.getFetchFn=uee;var Hg={},lee=u&&u.__awaiter||function(t,e,r,n){function i(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function s(d){try{c(n.next(d))}catch(f){o(f)}}function l(d){try{c(n.throw(d))}catch(f){o(f)}}function c(d){d.done?a(d.value):i(d.value).then(s,l)}c((n=n.apply(t,e||[])).next())})};Object.defineProperty(Hg,"__esModule",{value:!0});Hg.getRequestBody=void 0;function cee({body:t,type:e}){return lee(this,void 0,void 0,function*(){return e.includes("json")?JSON.stringify(t):t})}Hg.getRequestBody=cee;var qg={},Gg={},El={},RR;function dee(){if(RR)return El;RR=1;var t=u&&u.__awaiter||function(r,n,i,a){function o(s){return s instanceof i?s:new i(function(l){l(s)})}return new(i||(i=Promise))(function(s,l){function c(h){try{f(a.next(h))}catch(p){l(p)}}function d(h){try{f(a.throw(h))}catch(p){l(p)}}function f(h){h.done?s(h.value):o(h.value).then(c,d)}f((a=a.apply(r,n||[])).next())})};Object.defineProperty(El,"__esModule",{value:!0}),El.Node18UniversalStreamWrapper=void 0;let e=class ro{constructor(n){this.readableStream=n,this.reader=this.readableStream.getReader(),this.events={data:[],end:[],error:[],readable:[],close:[],pause:[],resume:[]},this.paused=!1,this.resumeCallback=null,this.encoding=null}on(n,i){var a;(a=this.events[n])===null||a===void 0||a.push(i)}off(n,i){var a;this.events[n]=(a=this.events[n])===null||a===void 0?void 0:a.filter(o=>o!==i)}pipe(n){return this.on("data",i=>t(this,void 0,void 0,function*(){if(n instanceof ro)n._write(i);else if(n instanceof WritableStream){const a=n.getWriter();a.write(i).then(()=>a.releaseLock())}else n.write(i)})),this.on("end",()=>t(this,void 0,void 0,function*(){n instanceof ro?n._end():n instanceof WritableStream?n.getWriter().close():n.end()})),this.on("error",i=>t(this,void 0,void 0,function*(){n instanceof ro?n._error(i):n instanceof WritableStream?n.getWriter().abort(i):n.destroy(i)})),this._startReading(),n}pipeTo(n){return this.pipe(n)}unpipe(n){this.off("data",i=>t(this,void 0,void 0,function*(){if(n instanceof ro)n._write(i);else if(n instanceof WritableStream){const a=n.getWriter();a.write(i).then(()=>a.releaseLock())}else n.write(i)})),this.off("end",()=>t(this,void 0,void 0,function*(){n instanceof ro?n._end():n instanceof WritableStream?n.getWriter().close():n.end()})),this.off("error",i=>t(this,void 0,void 0,function*(){n instanceof ro?n._error(i):n instanceof WritableStream?n.getWriter().abort(i):n.destroy(i)}))}destroy(n){this.reader.cancel(n).then(()=>{this._emit("close")}).catch(i=>{this._emit("error",i)})}pause(){this.paused=!0,this._emit("pause")}resume(){this.paused&&(this.paused=!1,this._emit("resume"),this.resumeCallback&&(this.resumeCallback(),this.resumeCallback=null))}get isPaused(){return this.paused}read(){return t(this,void 0,void 0,function*(){this.paused&&(yield new Promise(a=>{this.resumeCallback=a}));const{done:n,value:i}=yield this.reader.read();if(!n)return i})}setEncoding(n){this.encoding=n}text(){return t(this,void 0,void 0,function*(){const n=[];for(;;){const{done:a,value:o}=yield this.reader.read();if(a)break;o&&n.push(o)}return new TextDecoder(this.encoding||"utf-8").decode(yield new Blob(n).arrayBuffer())})}json(){return t(this,void 0,void 0,function*(){const n=yield this.text();return JSON.parse(n)})}_write(n){this._emit("data",n)}_end(){this._emit("end")}_error(n){this._emit("error",n)}_emit(n,i){if(this.events[n])for(const a of this.events[n]||[])a(i)}_startReading(){return t(this,void 0,void 0,function*(){try{for(this._emit("readable");;){this.paused&&(yield new Promise(a=>{this.resumeCallback=a}));const{done:n,value:i}=yield this.reader.read();if(n){this._emit("end"),this._emit("close");break}i&&this._emit("data",i)}}catch(n){this._emit("error",n)}})}[Symbol.asyncIterator](){return{next:()=>t(this,void 0,void 0,function*(){this.paused&&(yield new Promise(a=>{this.resumeCallback=a}));const{done:n,value:i}=yield this.reader.read();return n?{done:!0,value:void 0}:{done:!1,value:i}}),[Symbol.asyncIterator](){return this}}}};return El.Node18UniversalStreamWrapper=e,El}var Pl={},AR;function fee(){if(AR)return Pl;AR=1;var t=u&&u.__awaiter||function(r,n,i,a){function o(s){return s instanceof i?s:new i(function(l){l(s)})}return new(i||(i=Promise))(function(s,l){function c(h){try{f(a.next(h))}catch(p){l(p)}}function d(h){try{f(a.throw(h))}catch(p){l(p)}}function f(h){h.done?s(h.value):o(h.value).then(c,d)}f((a=a.apply(r,n||[])).next())})};Object.defineProperty(Pl,"__esModule",{value:!0}),Pl.UndiciStreamWrapper=void 0;let e=class no{constructor(n){this.readableStream=n,this.reader=this.readableStream.getReader(),this.events={data:[],end:[],error:[],readable:[],close:[],pause:[],resume:[]},this.paused=!1,this.resumeCallback=null,this.encoding=null}on(n,i){var a;(a=this.events[n])===null||a===void 0||a.push(i)}off(n,i){var a;this.events[n]=(a=this.events[n])===null||a===void 0?void 0:a.filter(o=>o!==i)}pipe(n){return this.on("data",i=>{if(n instanceof no)n._write(i);else{const a=n.getWriter();a.write(i).then(()=>a.releaseLock())}}),this.on("end",()=>{n instanceof no?n._end():n.getWriter().close()}),this.on("error",i=>{n instanceof no?n._error(i):n.getWriter().abort(i)}),this._startReading(),n}pipeTo(n){return this.pipe(n)}unpipe(n){this.off("data",i=>{if(n instanceof no)n._write(i);else{const a=n.getWriter();a.write(i).then(()=>a.releaseLock())}}),this.off("end",()=>{n instanceof no?n._end():n.getWriter().close()}),this.off("error",i=>{n instanceof no?n._error(i):n.getWriter().abort(i)})}destroy(n){this.reader.cancel(n).then(()=>{this._emit("close")}).catch(i=>{this._emit("error",i)})}pause(){this.paused=!0,this._emit("pause")}resume(){this.paused&&(this.paused=!1,this._emit("resume"),this.resumeCallback&&(this.resumeCallback(),this.resumeCallback=null))}get isPaused(){return this.paused}read(){return t(this,void 0,void 0,function*(){this.paused&&(yield new Promise(a=>{this.resumeCallback=a}));const{done:n,value:i}=yield this.reader.read();if(!n)return i})}setEncoding(n){this.encoding=n}text(){return t(this,void 0,void 0,function*(){const n=[];for(;;){const{done:a,value:o}=yield this.reader.read();if(a)break;o&&n.push(o)}return new TextDecoder(this.encoding||"utf-8").decode(yield new Blob(n).arrayBuffer())})}json(){return t(this,void 0,void 0,function*(){const n=yield this.text();return JSON.parse(n)})}_write(n){this._emit("data",n)}_end(){this._emit("end")}_error(n){this._emit("error",n)}_emit(n,i){if(this.events[n])for(const a of this.events[n]||[])a(i)}_startReading(){return t(this,void 0,void 0,function*(){try{for(this._emit("readable");;){this.paused&&(yield new Promise(a=>{this.resumeCallback=a}));const{done:n,value:i}=yield this.reader.read();if(n){this._emit("end"),this._emit("close");break}i&&this._emit("data",i)}}catch(n){this._emit("error",n)}})}[Symbol.asyncIterator](){return{next:()=>t(this,void 0,void 0,function*(){this.paused&&(yield new Promise(a=>{this.resumeCallback=a}));const{done:n,value:i}=yield this.reader.read();return n?{done:!0,value:void 0}:{done:!1,value:i}}),[Symbol.asyncIterator](){return this}}}};return Pl.UndiciStreamWrapper=e,Pl}var jl={},$R;function hee(){if($R)return jl;$R=1;var t=u&&u.__awaiter||function(n,i,a,o){function s(l){return l instanceof a?l:new a(function(c){c(l)})}return new(a||(a=Promise))(function(l,c){function d(p){try{h(o.next(p))}catch(b){c(b)}}function f(p){try{h(o.throw(p))}catch(b){c(b)}}function h(p){p.done?l(p.value):s(p.value).then(d,f)}h((o=o.apply(n,i||[])).next())})},e=u&&u.__asyncValues||function(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=n[Symbol.asyncIterator],a;return i?i.call(n):(n=typeof __values=="function"?__values(n):n[Symbol.iterator](),a={},o("next"),o("throw"),o("return"),a[Symbol.asyncIterator]=function(){return this},a);function o(l){a[l]=n[l]&&function(c){return new Promise(function(d,f){c=n[l](c),s(d,f,c.done,c.value)})}}function s(l,c,d,f){Promise.resolve(f).then(function(h){l({value:h,done:d})},c)}};Object.defineProperty(jl,"__esModule",{value:!0}),jl.NodePre18StreamWrapper=void 0;let r=class{constructor(i){this.readableStream=i}on(i,a){this.readableStream.on(i,a)}off(i,a){this.readableStream.off(i,a)}pipe(i){return this.readableStream.pipe(i),i}pipeTo(i){return this.pipe(i)}unpipe(i){i?this.readableStream.unpipe(i):this.readableStream.unpipe()}destroy(i){this.readableStream.destroy(i)}pause(){this.readableStream.pause()}resume(){this.readableStream.resume()}get isPaused(){return this.readableStream.isPaused()}read(){return t(this,void 0,void 0,function*(){return new Promise((i,a)=>{const o=this.readableStream.read();o?i(o):(this.readableStream.once("readable",()=>{const s=this.readableStream.read();i(s)}),this.readableStream.once("error",a))})})}setEncoding(i){this.readableStream.setEncoding(i),this.encoding=i}text(){var i,a;return t(this,void 0,void 0,function*(){const o=[],s=new TextEncoder;this.readableStream.setEncoding(this.encoding||"utf-8");try{for(var l=e(this.readableStream),c;c=yield l.next(),!c.done;){const f=c.value;o.push(s.encode(f))}}catch(f){i={error:f}}finally{try{c&&!c.done&&(a=l.return)&&(yield a.call(l))}finally{if(i)throw i.error}}return new TextDecoder(this.encoding||"utf-8").decode(Buffer.concat(o))})}json(){return t(this,void 0,void 0,function*(){const i=yield this.text();return JSON.parse(i)})}[Symbol.asyncIterator](){const a=this.readableStream[Symbol.asyncIterator]();return{next(){return t(this,void 0,void 0,function*(){const{value:o,done:s}=yield a.next();return{value:o,done:s}})},[Symbol.asyncIterator](){return this}}}};return jl.NodePre18StreamWrapper=r,jl}var pee=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),_ee=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),T0=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&pee(e,t,r);return _ee(e,t),e},yee=u&&u.__awaiter||function(t,e,r,n){function i(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function s(d){try{c(n.next(d))}catch(f){o(f)}}function l(d){try{c(n.throw(d))}catch(f){o(f)}}function c(d){d.done?a(d.value):i(d.value).then(s,l)}c((n=n.apply(t,e||[])).next())})};Object.defineProperty(Gg,"__esModule",{value:!0});Gg.chooseStreamWrapper=void 0;const d_=Lu;function bee(t){return yee(this,void 0,void 0,function*(){return d_.RUNTIME.type==="node"&&d_.RUNTIME.parsedVersion!=null&&d_.RUNTIME.parsedVersion>=18?new(yield Promise.resolve().then(()=>T0(dee()))).Node18UniversalStreamWrapper(t):d_.RUNTIME.type!=="node"&&typeof fetch=="function"?new(yield Promise.resolve().then(()=>T0(fee()))).UndiciStreamWrapper(t):new(yield Promise.resolve().then(()=>T0(hee()))).NodePre18StreamWrapper(t)})}Gg.chooseStreamWrapper=bee;var gee=u&&u.__awaiter||function(t,e,r,n){function i(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function s(d){try{c(n.next(d))}catch(f){o(f)}}function l(d){try{c(n.throw(d))}catch(f){o(f)}}function c(d){d.done?a(d.value):i(d.value).then(s,l)}c((n=n.apply(t,e||[])).next())})};Object.defineProperty(qg,"__esModule",{value:!0});qg.getResponseBody=void 0;const mee=Gg;function vee(t,e){return gee(this,void 0,void 0,function*(){if(t.body!=null&&e==="blob")return yield t.blob();if(t.body!=null&&e==="arrayBuffer")return yield t.arrayBuffer();if(t.body!=null&&e==="sse")return t.body;if(t.body!=null&&e==="streaming")return(0,mee.chooseStreamWrapper)(t.body);if(t.body!=null&&e==="text")return yield t.text();{const r=yield t.text();if(r.length>0)try{return JSON.parse(r)}catch{return{ok:!1,error:{reason:"non-json",statusCode:t.status,rawBody:r}}}else return}})}qg.getResponseBody=vee;var Wg={},Eu={};Object.defineProperty(Eu,"__esModule",{value:!0});Eu.anySignal=Eu.getTimeoutSignal=void 0;const wee="timeout";function Oee(t){const e=new AbortController,r=setTimeout(()=>e.abort(wee),t);return{signal:e.signal,abortId:r}}Eu.getTimeoutSignal=Oee;function See(...t){const e=t.length===1&&Array.isArray(t[0])?t[0]:t,r=new AbortController;for(const n of e){if(n.aborted){r.abort(n?.reason);break}n.addEventListener("abort",()=>r.abort(n?.reason),{signal:r.signal})}return r.signal}Eu.anySignal=See;var Eee=u&&u.__awaiter||function(t,e,r,n){function i(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function s(d){try{c(n.next(d))}catch(f){o(f)}}function l(d){try{c(n.throw(d))}catch(f){o(f)}}function c(d){d.done?a(d.value):i(d.value).then(s,l)}c((n=n.apply(t,e||[])).next())})};Object.defineProperty(Wg,"__esModule",{value:!0});Wg.makeRequest=void 0;const IR=Eu,Pee=(t,e,r,n,i,a,o,s,l)=>Eee(void 0,void 0,void 0,function*(){const c=[];let d;if(a!=null){const{signal:p,abortId:b}=(0,IR.getTimeoutSignal)(a);d=b,c.push(p)}o!=null&&c.push(o);let f=(0,IR.anySignal)(c);const h=yield t(e,{method:r,headers:n,body:i,signal:f,credentials:s?"include":void 0,duplex:l});return d!=null&&clearTimeout(d),h});Wg.makeRequest=Pee;var Kg={},jee=u&&u.__awaiter||function(t,e,r,n){function i(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function s(d){try{c(n.next(d))}catch(f){o(f)}}function l(d){try{c(n.throw(d))}catch(f){o(f)}}function c(d){d.done?a(d.value):i(d.value).then(s,l)}c((n=n.apply(t,e||[])).next())})};Object.defineProperty(Kg,"__esModule",{value:!0});Kg.requestWithRetries=void 0;const Cee=1e3,Mee=6e4,Tee=2,Ree=.2;function Aee(t){const e=1+(Math.random()*2-1)*Ree;return t*e}function $ee(t,e=Tee){return jee(this,void 0,void 0,function*(){let r=yield t();for(let n=0;n<e&&([408,409,429].includes(r.status)||r.status>=500);++n){const i=Math.min(Cee*Math.pow(2,n),Mee),a=Aee(i);yield new Promise(o=>setTimeout(o,a)),r=yield t()}return r})}Kg.requestWithRetries=$ee;var xR=u&&u.__awaiter||function(t,e,r,n){function i(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function s(d){try{c(n.next(d))}catch(f){o(f)}}function l(d){try{c(n.throw(d))}catch(f){o(f)}}function c(d){d.done?a(d.value):i(d.value).then(s,l)}c((n=n.apply(t,e||[])).next())})};Object.defineProperty(vu,"__esModule",{value:!0});vu.fetcher=vu.fetcherImpl=void 0;const Iee=zg,xee=Vg,Dee=Hg,Nee=qg,zee=Wg,Bee=Kg;function LF(t){return xR(this,void 0,void 0,function*(){const e={};if(t.body!==void 0&&t.contentType!=null&&(e["Content-Type"]=t.contentType),t.headers!=null)for(const[a,o]of Object.entries(t.headers))o!=null&&(e[a]=o);const r=(0,Iee.createRequestUrl)(t.url,t.queryParameters);let n=yield(0,Dee.getRequestBody)({body:t.body,type:t.requestType==="json"?"json":"other"});const i=yield(0,xee.getFetchFn)();try{const a=yield(0,Bee.requestWithRetries)(()=>xR(this,void 0,void 0,function*(){return(0,zee.makeRequest)(i,r,t.method,e,n,t.timeoutMs,t.abortSignal,t.withCredentials,t.duplex)}),t.maxRetries);let o=yield(0,Nee.getResponseBody)(a,t.responseType);return a.status>=200&&a.status<400?{ok:!0,body:o,headers:a.headers}:{ok:!1,error:{reason:"status-code",statusCode:a.status,body:o}}}catch(a){return t.abortSignal!=null&&t.abortSignal.aborted?{ok:!1,error:{reason:"unknown",errorMessage:"The user aborted a request"}}:a instanceof Error&&a.name==="AbortError"?{ok:!1,error:{reason:"timeout"}}:a instanceof Error?{ok:!1,error:{reason:"unknown",errorMessage:a.message}}:{ok:!1,error:{reason:"unknown",errorMessage:JSON.stringify(a)}}}})}vu.fetcherImpl=LF;vu.fetcher=LF;var Jg={};Object.defineProperty(Jg,"__esModule",{value:!0});Jg.getHeader=void 0;function Uee(t,e){for(const[r,n]of Object.entries(t))if(r.toLowerCase()===e.toLowerCase())return n}Jg.getHeader=Uee;var Xg={},Fee=u&&u.__awaiter||function(t,e,r,n){function i(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function s(d){try{c(n.next(d))}catch(f){o(f)}}function l(d){try{c(n.throw(d))}catch(f){o(f)}}function c(d){d.done?a(d.value):i(d.value).then(s,l)}c((n=n.apply(t,e||[])).next())})};Object.defineProperty(Xg,"__esModule",{value:!0});Xg.Supplier=void 0;Xg.Supplier={get:t=>Fee(void 0,void 0,void 0,function*(){return typeof t=="function"?t():t})};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Supplier=t.getHeader=t.fetcher=void 0;var e=vu;Object.defineProperty(t,"fetcher",{enumerable:!0,get:function(){return e.fetcher}});var r=Jg;Object.defineProperty(t,"getHeader",{enumerable:!0,get:function(){return r.getHeader}});var n=Xg;Object.defineProperty(t,"Supplier",{enumerable:!0,get:function(){return n.Supplier}})})(pF);var VF={},Zg={},kF={exports:{}};(function(t,e){(function(r,n){t.exports=n()})(typeof self<"u"?self:typeof window<"u"?window:u,function(){var r="3.7.2",n=r,i=typeof atob=="function",a=typeof btoa=="function",o=typeof Buffer=="function",s=typeof TextDecoder=="function"?new TextDecoder:void 0,l=typeof TextEncoder=="function"?new TextEncoder:void 0,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",d=Array.prototype.slice.call(c),f=function(U){var ie={};return U.forEach(function(F,W){return ie[F]=W}),ie}(d),h=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,p=String.fromCharCode.bind(String),b=typeof Uint8Array.from=="function"?Uint8Array.from.bind(Uint8Array):function(U,ie){return ie===void 0&&(ie=function(F){return F}),new Uint8Array(Array.prototype.slice.call(U,0).map(ie))},g=function(U){return U.replace(/=/g,"").replace(/[+\/]/g,function(ie){return ie=="+"?"-":"_"})},v=function(U){return U.replace(/[^A-Za-z0-9\+\/]/g,"")},E=function(U){for(var ie,F,W,de,Se="",T=U.length%3,R=0;R<U.length;){if((F=U.charCodeAt(R++))>255||(W=U.charCodeAt(R++))>255||(de=U.charCodeAt(R++))>255)throw new TypeError("invalid character found");ie=F<<16|W<<8|de,Se+=d[ie>>18&63]+d[ie>>12&63]+d[ie>>6&63]+d[ie&63]}return T?Se.slice(0,T-3)+"===".substring(T):Se},C=a?function(U){return btoa(U)}:o?function(U){return Buffer.from(U,"binary").toString("base64")}:E,S=o?function(U){return Buffer.from(U).toString("base64")}:function(U){for(var ie=4096,F=[],W=0,de=U.length;W<de;W+=ie)F.push(p.apply(null,U.subarray(W,W+ie)));return C(F.join(""))},N=function(U,ie){return ie===void 0&&(ie=!1),ie?g(S(U)):S(U)},D=function(U){if(U.length<2){var ie=U.charCodeAt(0);return ie<128?U:ie<2048?p(192|ie>>>6)+p(128|ie&63):p(224|ie>>>12&15)+p(128|ie>>>6&63)+p(128|ie&63)}else{var ie=65536+(U.charCodeAt(0)-55296)*1024+(U.charCodeAt(1)-56320);return p(240|ie>>>18&7)+p(128|ie>>>12&63)+p(128|ie>>>6&63)+p(128|ie&63)}},Z=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,se=function(U){return U.replace(Z,D)},re=o?function(U){return Buffer.from(U,"utf8").toString("base64")}:l?function(U){return S(l.encode(U))}:function(U){return C(se(U))},k=function(U,ie){return ie===void 0&&(ie=!1),ie?g(re(U)):re(U)},ee=function(U){return k(U,!0)},X=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,te=function(U){switch(U.length){case 4:var ie=(7&U.charCodeAt(0))<<18|(63&U.charCodeAt(1))<<12|(63&U.charCodeAt(2))<<6|63&U.charCodeAt(3),F=ie-65536;return p((F>>>10)+55296)+p((F&1023)+56320);case 3:return p((15&U.charCodeAt(0))<<12|(63&U.charCodeAt(1))<<6|63&U.charCodeAt(2));default:return p((31&U.charCodeAt(0))<<6|63&U.charCodeAt(1))}},I=function(U){return U.replace(X,te)},x=function(U){if(U=U.replace(/\s+/g,""),!h.test(U))throw new TypeError("malformed base64.");U+="==".slice(2-(U.length&3));for(var ie,F="",W,de,Se=0;Se<U.length;)ie=f[U.charAt(Se++)]<<18|f[U.charAt(Se++)]<<12|(W=f[U.charAt(Se++)])<<6|(de=f[U.charAt(Se++)]),F+=W===64?p(ie>>16&255):de===64?p(ie>>16&255,ie>>8&255):p(ie>>16&255,ie>>8&255,ie&255);return F},A=i?function(U){return atob(v(U))}:o?function(U){return Buffer.from(U,"base64").toString("binary")}:x,V=o?function(U){return b(Buffer.from(U,"base64"))}:function(U){return b(A(U),function(ie){return ie.charCodeAt(0)})},G=function(U){return V(H(U))},J=o?function(U){return Buffer.from(U,"base64").toString("utf8")}:s?function(U){return s.decode(V(U))}:function(U){return I(A(U))},H=function(U){return v(U.replace(/[-_]/g,function(ie){return ie=="-"?"+":"/"}))},Y=function(U){return J(H(U))},Q=function(U){if(typeof U!="string")return!1;var ie=U.replace(/\s+/g,"").replace(/={0,2}$/,"");return!/[^\s0-9a-zA-Z\+/]/.test(ie)||!/[^\s0-9a-zA-Z\-_]/.test(ie)},le=function(U){return{value:U,enumerable:!1,writable:!0,configurable:!0}},ne=function(){var U=function(ie,F){return Object.defineProperty(String.prototype,ie,le(F))};U("fromBase64",function(){return Y(this)}),U("toBase64",function(ie){return k(this,ie)}),U("toBase64URI",function(){return k(this,!0)}),U("toBase64URL",function(){return k(this,!0)}),U("toUint8Array",function(){return G(this)})},Ce=function(){var U=function(ie,F){return Object.defineProperty(Uint8Array.prototype,ie,le(F))};U("toBase64",function(ie){return N(this,ie)}),U("toBase64URI",function(){return N(this,!0)}),U("toBase64URL",function(){return N(this,!0)})},Te=function(){ne(),Ce()},Qe={version:r,VERSION:n,atob:A,atobPolyfill:x,btoa:C,btoaPolyfill:E,fromBase64:Y,toBase64:k,encode:k,encodeURI:ee,encodeURL:ee,utob:se,btou:I,decode:Y,isValid:Q,fromUint8Array:N,toUint8Array:G,extendString:ne,extendUint8Array:Ce,extendBuiltins:Te};return Qe.Base64={},Object.keys(Qe).forEach(function(U){return Qe.Base64[U]=Qe[U]}),Qe})})(kF);var Lee=kF.exports;Object.defineProperty(Zg,"__esModule",{value:!0});Zg.BasicAuth=void 0;const DR=Lee,Vee=/^Basic /i;Zg.BasicAuth={toAuthorizationHeader:t=>t==null?void 0:`Basic ${DR.Base64.encode(`${t.username}:${t.password}`)}`,fromAuthorizationHeader:t=>{const e=t.replace(Vee,""),r=DR.Base64.decode(e),[n,i]=r.split(":",2);if(n==null||i==null)throw new Error("Invalid basic auth");return{username:n,password:i}}};var Yg={};Object.defineProperty(Yg,"__esModule",{value:!0});Yg.BearerToken=void 0;const kee=/^Bearer /i;Yg.BearerToken={toAuthorizationHeader:t=>{if(t!=null)return`Bearer ${t}`},fromAuthorizationHeader:t=>t.replace(kee,"").trim()};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.BearerToken=t.BasicAuth=void 0;var e=Zg;Object.defineProperty(t,"BasicAuth",{enumerable:!0,get:function(){return e.BasicAuth}});var r=Yg;Object.defineProperty(t,"BearerToken",{enumerable:!0,get:function(){return r.BearerToken}})})(VF);var HF={},Oo={},NR=u&&u.__awaiter||function(t,e,r,n){function i(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function s(d){try{c(n.next(d))}catch(f){o(f)}}function l(d){try{c(n.throw(d))}catch(f){o(f)}}function c(d){d.done?a(d.value):i(d.value).then(s,l)}c((n=n.apply(t,e||[])).next())})},zR=u&&u.__asyncValues||function(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof __values=="function"?__values(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(a){r[a]=t[a]&&function(o){return new Promise(function(s,l){o=t[a](o),i(s,l,o.done,o.value)})}}function i(a,o,s,l){Promise.resolve(l).then(function(c){a({value:c,done:s})},o)}},Rn=u&&u.__await||function(t){return this instanceof Rn?(this.v=t,this):new Rn(t)},BR=u&&u.__asyncGenerator||function(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(t,e||[]),i,a=[];return i={},o("next"),o("throw"),o("return"),i[Symbol.asyncIterator]=function(){return this},i;function o(h){n[h]&&(i[h]=function(p){return new Promise(function(b,g){a.push([h,p,b,g])>1||s(h,p)})})}function s(h,p){try{l(n[h](p))}catch(b){f(a[0][3],b)}}function l(h){h.value instanceof Rn?Promise.resolve(h.value.v).then(c,d):f(a[0][2],h)}function c(h){s("next",h)}function d(h){s("throw",h)}function f(h,p){h(p),a.shift(),a.length&&s(a[0][0],a[0][1])}};Object.defineProperty(Oo,"__esModule",{value:!0});Oo.readableStreamAsyncIterable=Oo.Stream=void 0;const Hee=Lu,qee="data:";let Gee=class{constructor({stream:e,parse:r,eventShape:n,signal:i}){this.controller=new AbortController,this.stream=e,this.parse=r,n.type==="sse"?(this.prefix=qee,this.messageTerminator=`
`,this.streamTerminator=n.streamTerminator):this.messageTerminator=n.messageTerminator,i?.addEventListener("abort",()=>this.controller.abort())}iterMessages(){return BR(this,arguments,function*(){var r,n;this.controller.signal;const i=qF(this.stream);let a="",o=!1;try{for(var s=zR(i),l;l=yield Rn(s.next()),!l.done;){const c=l.value;a+=this.decodeChunk(c);let d;for(;(d=a.indexOf(this.messageTerminator))>=0;){let f=a.slice(0,d+1);if(a=a.slice(d+1),f.length===0)continue;if(!o&&this.prefix!=null){const p=f.indexOf(this.prefix);if(p===-1)continue;o=!0,f=f.slice(p+this.prefix.length)}if(this.streamTerminator!=null&&f.includes(this.streamTerminator))return yield Rn(void 0);const h=yield Rn(this.parse(JSON.parse(f)));yield yield Rn(h),o=!1}}}catch(c){r={error:c}}finally{try{l&&!l.done&&(n=s.return)&&(yield Rn(n.call(s)))}finally{if(r)throw r.error}}})}[Symbol.asyncIterator](){return BR(this,arguments,function*(){var r,n;try{for(var i=zR(this.iterMessages()),a;a=yield Rn(i.next()),!a.done;){const o=a.value;yield yield Rn(o)}}catch(o){r={error:o}}finally{try{a&&!a.done&&(n=i.return)&&(yield Rn(n.call(i)))}finally{if(r)throw r.error}}})}decodeChunk(e){let r="";if(typeof TextDecoder<"u"){const n=new TextDecoder("utf8");r+=n.decode(e)}else Hee.RUNTIME.type==="node"&&typeof e<"u"&&(r+=Buffer.isBuffer(e)?e:Buffer.from(e));return r}};Oo.Stream=Gee;function qF(t){if(t[Symbol.asyncIterator])return t;const e=t.getReader();return{next(){return NR(this,void 0,void 0,function*(){try{const r=yield e.read();return r?.done&&e.releaseLock(),r}catch(r){throw e.releaseLock(),r}})},return(){return NR(this,void 0,void 0,function*(){const r=e.cancel();return e.releaseLock(),yield r,{done:!0,value:void 0}})},[Symbol.asyncIterator](){return this}}}Oo.readableStreamAsyncIterable=qF;(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Stream=void 0;var e=Oo;Object.defineProperty(t,"Stream",{enumerable:!0,get:function(){return e.Stream}})})(HF);var GF={},ni={},R0,UR;function Wee(){if(UR)return R0;UR=1;var t=Object.defineProperty,e=Object.getOwnPropertyDescriptor,r=Object.getOwnPropertyNames,n=Object.prototype.hasOwnProperty,i=(h,p)=>{for(var b in p)t(h,b,{get:p[b],enumerable:!0})},a=(h,p,b,g)=>{if(p&&typeof p=="object"||typeof p=="function")for(let v of r(p))!n.call(h,v)&&v!==b&&t(h,v,{get:()=>p[v],enumerable:!(g=e(p,v))||g.enumerable});return h},o=h=>a(t({},"__esModule",{value:!0}),h),s={};i(s,{Blob:()=>d,File:()=>f,FormData:()=>c}),R0=o(s);var l=function(){return typeof globalThis<"u"?globalThis:typeof self<"u"?self:window}(),{FormData:c,Blob:d,File:f}=l;return R0}var A0,FR;function Kee(){if(FR)return A0;FR=1;var t=Object.defineProperty,e=Object.getOwnPropertyDescriptor,r=Object.getOwnPropertyNames,n=Object.prototype.hasOwnProperty,i=(F,W)=>{for(var de in W)t(F,de,{get:W[de],enumerable:!0})},a=(F,W,de,Se)=>{if(W&&typeof W=="object"||typeof W=="function")for(let T of r(W))!n.call(F,T)&&T!==de&&t(F,T,{get:()=>W[T],enumerable:!(Se=e(W,T))||Se.enumerable});return F},o=F=>a(t({},"__esModule",{value:!0}),F),s=(F,W,de)=>{if(!W.has(F))throw TypeError("Cannot "+de)},l=(F,W,de)=>(s(F,W,"read from private field"),de?de.call(F):W.get(F)),c=(F,W,de)=>{if(W.has(F))throw TypeError("Cannot add the same private member more than once");W instanceof WeakSet?W.add(F):W.set(F,de)},d=(F,W,de,Se)=>(s(F,W,"write to private field"),W.set(F,de),de),f=(F,W,de)=>(s(F,W,"access private method"),de),h={};i(h,{FormDataEncoder:()=>ie,isFile:()=>I,isFormData:()=>X}),A0=o(h);var p=F=>typeof F=="function",b=F=>p(F[Symbol.asyncIterator]),g=65536;function*v(F){if(F.byteLength<=g){yield F;return}let W=0;for(;W<F.byteLength;){const de=Math.min(F.byteLength-W,g),Se=F.buffer.slice(W,W+de);W+=Se.byteLength,yield new Uint8Array(Se)}}async function*E(F){const W=F.getReader();for(;;){const{done:de,value:Se}=await W.read();if(de)break;yield Se}}async function*C(F){for await(const W of F)yield*v(W)}var S=F=>{if(b(F))return C(F);if(p(F.getReader))return C(E(F));throw new TypeError("Unsupported data source: Expected either ReadableStream or async iterable.")},N="abcdefghijklmnopqrstuvwxyz0123456789";function D(){let F=16,W="";for(;F--;)W+=N[Math.random()*N.length<<0];return W}var Z=F=>String(F).replace(/\r|\n/g,(W,de,Se)=>W==="\r"&&Se[de+1]!==`
`||W===`
`&&Se[de-1]!=="\r"?`\r
`:W),se=F=>Object.prototype.toString.call(F).slice(8,-1).toLowerCase();function re(F){if(se(F)!=="object")return!1;const W=Object.getPrototypeOf(F);return W==null?!0:(W.constructor&&W.constructor.toString())===Object.toString()}function k(F,W){if(typeof W=="string"){for(const[de,Se]of Object.entries(F))if(W.toLowerCase()===de.toLowerCase())return Se}}var ee=F=>new Proxy(F,{get:(W,de)=>k(W,de),has:(W,de)=>k(W,de)!==void 0}),X=F=>!!(F&&p(F.constructor)&&F[Symbol.toStringTag]==="FormData"&&p(F.append)&&p(F.getAll)&&p(F.entries)&&p(F[Symbol.iterator])),te=F=>String(F).replace(/\r/g,"%0D").replace(/\n/g,"%0A").replace(/"/g,"%22"),I=F=>!!(F&&typeof F=="object"&&p(F.constructor)&&F[Symbol.toStringTag]==="File"&&p(F.stream)&&F.name!=null),x={enableAdditionalHeaders:!1},A={writable:!1,configurable:!1},V,G,J,H,Y,Q,le,ne,Ce,Te,Qe,U,ie=class{constructor(F,W,de){if(c(this,Ce),c(this,Qe),c(this,V,`\r
`),c(this,G,void 0),c(this,J,void 0),c(this,H,"-".repeat(2)),c(this,Y,new TextEncoder),c(this,Q,void 0),c(this,le,void 0),c(this,ne,void 0),!X(F))throw new TypeError("Expected first argument to be a FormData instance.");let Se;if(re(W)?de=W:Se=W,Se||(Se=D()),typeof Se!="string")throw new TypeError("Expected boundary argument to be a string.");if(de&&!re(de))throw new TypeError("Expected options argument to be an object.");d(this,le,Array.from(F.entries())),d(this,ne,{...x,...de}),d(this,G,l(this,Y).encode(l(this,V))),d(this,J,l(this,G).byteLength),this.boundary=`form-data-boundary-${Se}`,this.contentType=`multipart/form-data; boundary=${this.boundary}`,d(this,Q,l(this,Y).encode(`${l(this,H)}${this.boundary}${l(this,H)}${l(this,V).repeat(2)}`));const T={"Content-Type":this.contentType},R=f(this,Qe,U).call(this);R&&(this.contentLength=R,T["Content-Length"]=R),this.headers=ee(Object.freeze(T)),Object.defineProperties(this,{boundary:A,contentType:A,contentLength:A,headers:A})}*values(){for(const[F,W]of l(this,le)){const de=I(W)?W:l(this,Y).encode(Z(W));yield f(this,Ce,Te).call(this,F,de),yield de,yield l(this,G)}yield l(this,Q)}async*encode(){for(const F of this.values())I(F)?yield*S(F.stream()):yield*v(F)}[Symbol.iterator](){return this.values()}[Symbol.asyncIterator](){return this.encode()}};return V=new WeakMap,G=new WeakMap,J=new WeakMap,H=new WeakMap,Y=new WeakMap,Q=new WeakMap,le=new WeakMap,ne=new WeakMap,Ce=new WeakSet,Te=function(F,W){let de="";if(de+=`${l(this,H)}${this.boundary}${l(this,V)}`,de+=`Content-Disposition: form-data; name="${te(F)}"`,I(W)&&(de+=`; filename="${te(W.name)}"${l(this,V)}`,de+=`Content-Type: ${W.type||"application/octet-stream"}`),l(this,ne).enableAdditionalHeaders===!0){const Se=I(W)?W.size:W.byteLength;Se!=null&&!isNaN(Se)&&(de+=`${l(this,V)}Content-Length: ${Se}`)}return l(this,Y).encode(`${de}${l(this,V).repeat(2)}`)},Qe=new WeakSet,U=function(){let F=0;for(const[W,de]of l(this,le)){const Se=I(de)?de:l(this,Y).encode(Z(de)),T=I(Se)?Se.size:Se.byteLength;if(T==null||isNaN(T))return;F+=f(this,Ce,Te).call(this,W,Se).byteLength,F+=T,F+=l(this,J)}return String(F+l(this,Q).byteLength)},A0}var $0,LR;function Jee(){return LR||(LR=1,$0=typeof self=="object"?self.FormData:window.FormData),$0}var Xee=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Zee=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Bs=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Xee(e,t,r);return Zee(e,t),e},Oa=u&&u.__awaiter||function(t,e,r,n){function i(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function s(d){try{c(n.next(d))}catch(f){o(f)}}function l(d){try{c(n.throw(d))}catch(f){o(f)}}function c(d){d.done?a(d.value):i(d.value).then(s,l)}c((n=n.apply(t,e||[])).next())})};Object.defineProperty(ni,"__esModule",{value:!0});ni.WebFormData=ni.Node16FormData=ni.Node18FormData=ni.newFormData=void 0;const f_=Lu;function XP(t){return typeof t=="object"&&t!=null&&"name"in t}function Yee(){return Oa(this,void 0,void 0,function*(){let t;return f_.RUNTIME.type==="node"&&f_.RUNTIME.parsedVersion!=null&&f_.RUNTIME.parsedVersion>=18?t=new WF:f_.RUNTIME.type==="node"?t=new KF:t=new JF,yield t.setup(),t})}ni.newFormData=Yee;class WF{setup(){return Oa(this,void 0,void 0,function*(){this.fd=new(yield Promise.resolve().then(()=>Bs(Wee()))).FormData})}append(e,r){var n;(n=this.fd)===null||n===void 0||n.append(e,r)}appendFile(e,r,n){var i,a;return Oa(this,void 0,void 0,function*(){n==null&&XP(r)&&(n=r.name),r instanceof(yield Promise.resolve().then(()=>Bs($y))).Readable?(i=this.fd)===null||i===void 0||i.append(e,{type:void 0,name:n,[Symbol.toStringTag]:"File",stream(){return r}}):(a=this.fd)===null||a===void 0||a.append(e,r,n)})}getRequest(){return Oa(this,void 0,void 0,function*(){const e=new(yield Promise.resolve().then(()=>Bs(Kee()))).FormDataEncoder(this.fd);return{body:yield(yield Promise.resolve().then(()=>Bs($y))).Readable.from(e),headers:e.headers,duplex:"half"}})}}ni.Node18FormData=WF;class KF{setup(){return Oa(this,void 0,void 0,function*(){this.fd=new(yield Promise.resolve().then(()=>Bs(Jee()))).default})}append(e,r){var n;(n=this.fd)===null||n===void 0||n.append(e,r)}appendFile(e,r,n){var i,a;return Oa(this,void 0,void 0,function*(){n==null&&XP(r)&&(n=r.name);let o;r instanceof(yield Promise.resolve().then(()=>Bs($y))).Readable?o=r:o=Buffer.from(yield r.arrayBuffer()),n==null?(i=this.fd)===null||i===void 0||i.append(e,o):(a=this.fd)===null||a===void 0||a.append(e,o,{filename:n})})}getRequest(){return{body:this.fd,headers:this.fd?this.fd.getHeaders():{}}}}ni.Node16FormData=KF;class JF{setup(){return Oa(this,void 0,void 0,function*(){this.fd=new FormData})}append(e,r){var n;(n=this.fd)===null||n===void 0||n.append(e,r)}appendFile(e,r,n){var i;return Oa(this,void 0,void 0,function*(){n==null&&XP(r)&&(n=r.name),(i=this.fd)===null||i===void 0||i.append(e,new Blob([r]),n)})}getRequest(){return{body:this.fd,headers:{}}}}ni.WebFormData=JF;(function(t){var e=u&&u.__createBinding||(Object.create?function(n,i,a,o){o===void 0&&(o=a);var s=Object.getOwnPropertyDescriptor(i,a);(!s||("get"in s?!i.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return i[a]}}),Object.defineProperty(n,o,s)}:function(n,i,a,o){o===void 0&&(o=a),n[o]=i[a]}),r=u&&u.__exportStar||function(n,i){for(var a in n)a!=="default"&&!Object.prototype.hasOwnProperty.call(i,a)&&e(i,n,a)};Object.defineProperty(t,"__esModule",{value:!0}),r(ni,t)})(GF);var XF={},ZF={},YF={},Qg={},zt={};Object.defineProperty(zt,"__esModule",{value:!0});zt.SchemaType=void 0;zt.SchemaType={BIGINT:"bigint",DATE:"date",ENUM:"enum",LIST:"list",STRING_LITERAL:"stringLiteral",BOOLEAN_LITERAL:"booleanLiteral",OBJECT:"object",ANY:"any",BOOLEAN:"boolean",NUMBER:"number",STRING:"string",UNKNOWN:"unknown",RECORD:"record",SET:"set",UNION:"union",UNDISCRIMINATED_UNION:"undiscriminatedUnion",OPTIONAL:"optional"};var tr={};Object.defineProperty(tr,"__esModule",{value:!0});tr.getErrorMessageForIncorrectType=void 0;function Qee(t,e){return`Expected ${e}. Received ${ete(t)}.`}tr.getErrorMessageForIncorrectType=Qee;function ete(t){if(Array.isArray(t))return"list";if(t===null)return"null";if(t instanceof BigInt)return"BigInt";switch(typeof t){case"string":return`"${t}"`;case"bigint":case"number":case"boolean":case"undefined":return`${t}`}return typeof t}var gn={};Object.defineProperty(gn,"__esModule",{value:!0});gn.maybeSkipValidation=void 0;function tte(t){return Object.assign(Object.assign({},t),{json:VR(t.json),parse:VR(t.parse)})}gn.maybeSkipValidation=tte;function VR(t){return(e,r)=>{const n=t(e,r),{skipValidation:i=!1}=r??{};return!n.ok&&i?(console.warn(["Failed to validate.",...n.errors.map(a=>"  - "+(a.path.length>0?`${a.path.join(".")}: ${a.message}`:a.message))].join(`
`)),{ok:!0,value:e}):n}}var xr={},Sa={},md={},vd={};Object.defineProperty(vd,"__esModule",{value:!0});vd.stringifyValidationError=void 0;function rte(t){return t.path.length===0?t.message:`${t.path.join(" -> ")}: ${t.message}`}vd.stringifyValidationError=rte;Object.defineProperty(md,"__esModule",{value:!0});md.JsonError=void 0;const nte=vd;class ZP extends Error{constructor(e){super(e.map(nte.stringifyValidationError).join("; ")),this.errors=e,Object.setPrototypeOf(this,ZP.prototype)}}md.JsonError=ZP;var wd={};Object.defineProperty(wd,"__esModule",{value:!0});wd.ParseError=void 0;const ite=vd;class YP extends Error{constructor(e){super(e.map(ite.stringifyValidationError).join("; ")),this.errors=e,Object.setPrototypeOf(this,YP.prototype)}}wd.ParseError=YP;Object.defineProperty(Sa,"__esModule",{value:!0});Sa.transform=Sa.optional=Sa.getSchemaUtils=void 0;const ate=zt,ote=md,ste=wd;function QP(t){return{optional:()=>QF(t),transform:e=>eL(t,e),parseOrThrow:(e,r)=>{const n=t.parse(e,r);if(n.ok)return n.value;throw new ste.ParseError(n.errors)},jsonOrThrow:(e,r)=>{const n=t.json(e,r);if(n.ok)return n.value;throw new ote.JsonError(n.errors)}}}Sa.getSchemaUtils=QP;function QF(t){const e={parse:(r,n)=>r==null?{ok:!0,value:void 0}:t.parse(r,n),json:(r,n)=>n?.omitUndefined&&r===void 0?{ok:!0,value:void 0}:r==null?{ok:!0,value:null}:t.json(r,n),getType:()=>ate.SchemaType.OPTIONAL};return Object.assign(Object.assign({},e),QP(e))}Sa.optional=QF;function eL(t,e){const r={parse:(n,i)=>{const a=t.parse(n,i);return a.ok?{ok:!0,value:e.transform(a.value)}:a},json:(n,i)=>{const a=e.untransform(n);return t.json(a,i)},getType:()=>t.getType()};return Object.assign(Object.assign({},r),QP(r))}Sa.transform=eL;(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ParseError=t.JsonError=t.transform=t.optional=t.getSchemaUtils=void 0;var e=Sa;Object.defineProperty(t,"getSchemaUtils",{enumerable:!0,get:function(){return e.getSchemaUtils}}),Object.defineProperty(t,"optional",{enumerable:!0,get:function(){return e.optional}}),Object.defineProperty(t,"transform",{enumerable:!0,get:function(){return e.transform}});var r=md;Object.defineProperty(t,"JsonError",{enumerable:!0,get:function(){return r.JsonError}});var n=wd;Object.defineProperty(t,"ParseError",{enumerable:!0,get:function(){return n.ParseError}})})(xr);Object.defineProperty(Qg,"__esModule",{value:!0});Qg.bigint=void 0;const ute=zt,kR=tr,lte=gn,cte=xr;function dte(){const t={parse:(e,{breadcrumbsPrefix:r=[]}={})=>typeof e!="string"?{ok:!1,errors:[{path:r,message:(0,kR.getErrorMessageForIncorrectType)(e,"string")}]}:{ok:!0,value:BigInt(e)},json:(e,{breadcrumbsPrefix:r=[]}={})=>typeof e=="bigint"?{ok:!0,value:e.toString()}:{ok:!1,errors:[{path:r,message:(0,kR.getErrorMessageForIncorrectType)(e,"bigint")}]},getType:()=>ute.SchemaType.BIGINT};return Object.assign(Object.assign({},(0,lte.maybeSkipValidation)(t)),(0,cte.getSchemaUtils)(t))}Qg.bigint=dte;(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.bigint=void 0;var e=Qg;Object.defineProperty(t,"bigint",{enumerable:!0,get:function(){return e.bigint}})})(YF);var tL={},em={};Object.defineProperty(em,"__esModule",{value:!0});em.date=void 0;const fte=zt,I0=tr,hte=gn,pte=xr,_te=/^([+-]?\d{4}(?!\d{2}\b))((-?)((0[1-9]|1[0-2])(\3([12]\d|0[1-9]|3[01]))?|W([0-4]\d|5[0-2])(-?[1-7])?|(00[1-9]|0[1-9]\d|[12]\d{2}|3([0-5]\d|6[1-6])))([T\s]((([01]\d|2[0-3])((:?)[0-5]\d)?|24:?00)([.,]\d+(?!:))?)?(\17[0-5]\d([.,]\d+)?)?([zZ]|([+-])([01]\d|2[0-3]):?([0-5]\d)?)?)?)?$/;function yte(){const t={parse:(e,{breadcrumbsPrefix:r=[]}={})=>typeof e!="string"?{ok:!1,errors:[{path:r,message:(0,I0.getErrorMessageForIncorrectType)(e,"string")}]}:_te.test(e)?{ok:!0,value:new Date(e)}:{ok:!1,errors:[{path:r,message:(0,I0.getErrorMessageForIncorrectType)(e,"ISO 8601 date string")}]},json:(e,{breadcrumbsPrefix:r=[]}={})=>e instanceof Date?{ok:!0,value:e.toISOString()}:{ok:!1,errors:[{path:r,message:(0,I0.getErrorMessageForIncorrectType)(e,"Date object")}]},getType:()=>fte.SchemaType.DATE};return Object.assign(Object.assign({},(0,hte.maybeSkipValidation)(t)),(0,pte.getSchemaUtils)(t))}em.date=yte;(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.date=void 0;var e=em;Object.defineProperty(t,"date",{enumerable:!0,get:function(){return e.date}})})(tL);var ej={},tm={},Fn={};Object.defineProperty(Fn,"__esModule",{value:!0});Fn.createIdentitySchemaCreator=void 0;const bte=xr,gte=gn;function mte(t,e){return()=>{const r={parse:e,json:e,getType:()=>t};return Object.assign(Object.assign({},(0,gte.maybeSkipValidation)(r)),(0,bte.getSchemaUtils)(r))}}Fn.createIdentitySchemaCreator=mte;Object.defineProperty(tm,"__esModule",{value:!0});tm.enum_=void 0;const vte=zt,wte=Fn,HR=tr;function Ote(t){const e=new Set(t);return(0,wte.createIdentitySchemaCreator)(vte.SchemaType.ENUM,(n,{allowUnrecognizedEnumValues:i,breadcrumbsPrefix:a=[]}={})=>typeof n!="string"?{ok:!1,errors:[{path:a,message:(0,HR.getErrorMessageForIncorrectType)(n,"string")}]}:!e.has(n)&&!i?{ok:!1,errors:[{path:a,message:(0,HR.getErrorMessageForIncorrectType)(n,"enum")}]}:{ok:!0,value:n})()}tm.enum_=Ote;(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.enum_=void 0;var e=tm;Object.defineProperty(t,"enum_",{enumerable:!0,get:function(){return e.enum_}})})(ej);var rL={},xi={};Object.defineProperty(xi,"__esModule",{value:!0});xi.getMemoizedSchema=xi.constructLazyBaseSchema=xi.lazy=void 0;const Ste=xr;function Ete(t){const e=nL(t);return Object.assign(Object.assign({},e),(0,Ste.getSchemaUtils)(e))}xi.lazy=Ete;function nL(t){return{parse:(e,r)=>ey(t).parse(e,r),json:(e,r)=>ey(t).json(e,r),getType:()=>ey(t).getType()}}xi.constructLazyBaseSchema=nL;function ey(t){const e=t;return e.__zurg_memoized==null&&(e.__zurg_memoized=t()),e.__zurg_memoized}xi.getMemoizedSchema=ey;var rm={},tj={},So={},Od={};Object.defineProperty(Od,"__esModule",{value:!0});Od.entries=void 0;function Pte(t){return Object.entries(t)}Od.entries=Pte;var Sd={};Object.defineProperty(Sd,"__esModule",{value:!0});Sd.filterObject=void 0;function jte(t,e){const r=new Set(e);return Object.entries(t).reduce((n,[i,a])=>(r.has(i)&&(n[i]=a),n),{})}Sd.filterObject=jte;var Io={};Object.defineProperty(Io,"__esModule",{value:!0});Io.isPlainObject=void 0;function Cte(t){if(typeof t!="object"||t===null)return!1;if(Object.getPrototypeOf(t)===null)return!0;let e=t;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e}Io.isPlainObject=Cte;var Ed={};Object.defineProperty(Ed,"__esModule",{value:!0});Ed.keys=void 0;function Mte(t){return Object.keys(t)}Ed.keys=Mte;var nm={};Object.defineProperty(nm,"__esModule",{value:!0});nm.partition=void 0;function Tte(t,e){const r=[],n=[];for(const i of t)e(i)?r.push(i):n.push(i);return[r,n]}nm.partition=Tte;var Pd={},Pu={};Object.defineProperty(Pu,"__esModule",{value:!0});Pu.withParsedProperties=Pu.getObjectLikeUtils=void 0;const Rte=Sd,Ate=tr,$te=Io,Ite=xr;function iL(t){return{withParsedProperties:e=>aL(t,e)}}Pu.getObjectLikeUtils=iL;function aL(t,e){const r={parse:(n,i)=>{const a=t.parse(n,i);if(!a.ok)return a;const o=Object.entries(e).reduce((s,[l,c])=>Object.assign(Object.assign({},s),{[l]:typeof c=="function"?c(a.value):c}),{});return{ok:!0,value:Object.assign(Object.assign({},a.value),o)}},json:(n,i)=>{var a;if(!(0,$te.isPlainObject)(n))return{ok:!1,errors:[{path:(a=i?.breadcrumbsPrefix)!==null&&a!==void 0?a:[],message:(0,Ate.getErrorMessageForIncorrectType)(n,"object")}]};const o=new Set(Object.keys(e)),s=(0,Rte.filterObject)(n,Object.keys(n).filter(l=>!o.has(l)));return t.json(s,i)},getType:()=>t.getType()};return Object.assign(Object.assign(Object.assign({},r),(0,Ite.getSchemaUtils)(r)),iL(r))}Pu.withParsedProperties=aL;(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.withParsedProperties=t.getObjectLikeUtils=void 0;var e=Pu;Object.defineProperty(t,"getObjectLikeUtils",{enumerable:!0,get:function(){return e.getObjectLikeUtils}}),Object.defineProperty(t,"withParsedProperties",{enumerable:!0,get:function(){return e.withParsedProperties}})})(Pd);var Eo={};Object.defineProperty(Eo,"__esModule",{value:!0});Eo.isProperty=Eo.property=void 0;function xte(t,e){return{rawKey:t,valueSchema:e,isProperty:!0}}Eo.property=xte;function Dte(t){return t.isProperty}Eo.isProperty=Dte;Object.defineProperty(So,"__esModule",{value:!0});So.getObjectUtils=So.object=void 0;const Xs=zt,qR=Od,GR=Sd,Nte=tr,zte=Io,oL=Ed,Bte=gn,Ute=nm,DS=Pd,NS=xr,Cl=Eo;function Fte(t){const e={_getRawProperties:()=>Object.entries(t).map(([r,n])=>(0,Cl.isProperty)(n)?n.rawKey:r),_getParsedProperties:()=>(0,oL.keys)(t),parse:(r,n)=>{const i={},a=[];for(const[o,s]of(0,qR.entries)(t)){const l=(0,Cl.isProperty)(s)?s.rawKey:o,c=(0,Cl.isProperty)(s)?s.valueSchema:s,d={rawKey:l,parsedKey:o,valueSchema:c};i[l]=d,JR(c)&&a.push(l)}return WR({value:r,requiredKeys:a,getProperty:o=>{const s=i[o];if(s!=null)return{transformedKey:s.parsedKey,transform:l=>{var c;return s.valueSchema.parse(l,Object.assign(Object.assign({},n),{breadcrumbsPrefix:[...(c=n?.breadcrumbsPrefix)!==null&&c!==void 0?c:[],o]}))}}},unrecognizedObjectKeys:n?.unrecognizedObjectKeys,skipValidation:n?.skipValidation,breadcrumbsPrefix:n?.breadcrumbsPrefix,omitUndefined:n?.omitUndefined})},json:(r,n)=>{const i=[];for(const[a,o]of(0,qR.entries)(t)){const s=(0,Cl.isProperty)(o)?o.valueSchema:o;JR(s)&&i.push(a)}return WR({value:r,requiredKeys:i,getProperty:a=>{const o=t[a];if(o!=null)return(0,Cl.isProperty)(o)?{transformedKey:o.rawKey,transform:s=>{var l;return o.valueSchema.json(s,Object.assign(Object.assign({},n),{breadcrumbsPrefix:[...(l=n?.breadcrumbsPrefix)!==null&&l!==void 0?l:[],a]}))}}:{transformedKey:a,transform:s=>{var l;return o.json(s,Object.assign(Object.assign({},n),{breadcrumbsPrefix:[...(l=n?.breadcrumbsPrefix)!==null&&l!==void 0?l:[],a]}))}}},unrecognizedObjectKeys:n?.unrecognizedObjectKeys,skipValidation:n?.skipValidation,breadcrumbsPrefix:n?.breadcrumbsPrefix,omitUndefined:n?.omitUndefined})},getType:()=>Xs.SchemaType.OBJECT};return Object.assign(Object.assign(Object.assign(Object.assign({},(0,Bte.maybeSkipValidation)(e)),(0,NS.getSchemaUtils)(e)),(0,DS.getObjectLikeUtils)(e)),zy(e))}So.object=Fte;function WR({value:t,requiredKeys:e,getProperty:r,unrecognizedObjectKeys:n="fail",skipValidation:i=!1,breadcrumbsPrefix:a=[]}){if(!(0,zte.isPlainObject)(t))return{ok:!1,errors:[{path:a,message:(0,Nte.getErrorMessageForIncorrectType)(t,"object")}]};const o=new Set(e),s=[],l={};for(const[c,d]of Object.entries(t)){const f=r(c);if(f!=null){o.delete(c);const h=f.transform(d);h.ok?l[f.transformedKey]=h.value:(l[c]=d,s.push(...h.errors))}else switch(n){case"fail":s.push({path:[...a,c],message:`Unexpected key "${c}"`});break;case"strip":break;case"passthrough":l[c]=d;break}}return s.push(...e.filter(c=>o.has(c)).map(c=>({path:a,message:`Missing required key "${c}"`}))),s.length===0||i?{ok:!0,value:l}:{ok:!1,errors:s}}function zy(t){return{extend:e=>{const r={_getParsedProperties:()=>[...t._getParsedProperties(),...e._getParsedProperties()],_getRawProperties:()=>[...t._getRawProperties(),...e._getRawProperties()],parse:(n,i)=>KR({extensionKeys:e._getRawProperties(),value:n,transformBase:a=>t.parse(a,i),transformExtension:a=>e.parse(a,i)}),json:(n,i)=>KR({extensionKeys:e._getParsedProperties(),value:n,transformBase:a=>t.json(a,i),transformExtension:a=>e.json(a,i)}),getType:()=>Xs.SchemaType.OBJECT};return Object.assign(Object.assign(Object.assign(Object.assign({},r),(0,NS.getSchemaUtils)(r)),(0,DS.getObjectLikeUtils)(r)),zy(r))},passthrough:()=>{const e={_getParsedProperties:()=>t._getParsedProperties(),_getRawProperties:()=>t._getRawProperties(),parse:(r,n)=>{const i=t.parse(r,Object.assign(Object.assign({},n),{unrecognizedObjectKeys:"passthrough"}));return i.ok?{ok:!0,value:Object.assign(Object.assign({},r),i.value)}:i},json:(r,n)=>{const i=t.json(r,Object.assign(Object.assign({},n),{unrecognizedObjectKeys:"passthrough"}));return i.ok?{ok:!0,value:Object.assign(Object.assign({},r),i.value)}:i},getType:()=>Xs.SchemaType.OBJECT};return Object.assign(Object.assign(Object.assign(Object.assign({},e),(0,NS.getSchemaUtils)(e)),(0,DS.getObjectLikeUtils)(e)),zy(e))}}}So.getObjectUtils=zy;function KR({extensionKeys:t,value:e,transformBase:r,transformExtension:n}){const i=new Set(t),[a,o]=(0,Ute.partition)((0,oL.keys)(e),c=>i.has(c)),s=r((0,GR.filterObject)(e,o)),l=n((0,GR.filterObject)(e,a));return s.ok&&l.ok?{ok:!0,value:Object.assign(Object.assign({},s.value),l.value)}:{ok:!1,errors:[...s.ok?[]:s.errors,...l.ok?[]:l.errors]}}function JR(t){return!Lte(t)}function Lte(t){switch(t.getType()){case Xs.SchemaType.ANY:case Xs.SchemaType.UNKNOWN:case Xs.SchemaType.OPTIONAL:return!0;default:return!1}}var im={};Object.defineProperty(im,"__esModule",{value:!0});im.objectWithoutOptionalProperties=void 0;const Vte=So;function kte(t){return(0,Vte.object)(t)}im.objectWithoutOptionalProperties=kte;(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.property=t.isProperty=t.objectWithoutOptionalProperties=t.object=t.getObjectUtils=void 0;var e=So;Object.defineProperty(t,"getObjectUtils",{enumerable:!0,get:function(){return e.getObjectUtils}}),Object.defineProperty(t,"object",{enumerable:!0,get:function(){return e.object}});var r=im;Object.defineProperty(t,"objectWithoutOptionalProperties",{enumerable:!0,get:function(){return r.objectWithoutOptionalProperties}});var n=Eo;Object.defineProperty(t,"isProperty",{enumerable:!0,get:function(){return n.isProperty}}),Object.defineProperty(t,"property",{enumerable:!0,get:function(){return n.property}})})(tj);Object.defineProperty(rm,"__esModule",{value:!0});rm.lazyObject=void 0;const Hte=tj,qte=Pd,Gte=xr,x0=xi;function Wte(t){const e=Object.assign(Object.assign({},(0,x0.constructLazyBaseSchema)(t)),{_getRawProperties:()=>(0,x0.getMemoizedSchema)(t)._getRawProperties(),_getParsedProperties:()=>(0,x0.getMemoizedSchema)(t)._getParsedProperties()});return Object.assign(Object.assign(Object.assign(Object.assign({},e),(0,Gte.getSchemaUtils)(e)),(0,qte.getObjectLikeUtils)(e)),(0,Hte.getObjectUtils)(e))}rm.lazyObject=Wte;(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.lazyObject=t.lazy=void 0;var e=xi;Object.defineProperty(t,"lazy",{enumerable:!0,get:function(){return e.lazy}});var r=rm;Object.defineProperty(t,"lazyObject",{enumerable:!0,get:function(){return r.lazyObject}})})(rL);var rj={},am={};Object.defineProperty(am,"__esModule",{value:!0});am.list=void 0;const Kte=zt,Jte=tr,Xte=gn,Zte=xr;function Yte(t){const e={parse:(r,n)=>XR(r,(i,a)=>{var o;return t.parse(i,Object.assign(Object.assign({},n),{breadcrumbsPrefix:[...(o=n?.breadcrumbsPrefix)!==null&&o!==void 0?o:[],`[${a}]`]}))}),json:(r,n)=>XR(r,(i,a)=>{var o;return t.json(i,Object.assign(Object.assign({},n),{breadcrumbsPrefix:[...(o=n?.breadcrumbsPrefix)!==null&&o!==void 0?o:[],`[${a}]`]}))}),getType:()=>Kte.SchemaType.LIST};return Object.assign(Object.assign({},(0,Xte.maybeSkipValidation)(e)),(0,Zte.getSchemaUtils)(e))}am.list=Yte;function XR(t,e){return Array.isArray(t)?t.map((n,i)=>e(n,i)).reduce((n,i)=>{if(n.ok&&i.ok)return{ok:!0,value:[...n.value,i.value]};const a=[];return n.ok||a.push(...n.errors),i.ok||a.push(...i.errors),{ok:!1,errors:a}},{ok:!0,value:[]}):{ok:!1,errors:[{message:(0,Jte.getErrorMessageForIncorrectType)(t,"list"),path:[]}]}}(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.list=void 0;var e=am;Object.defineProperty(t,"list",{enumerable:!0,get:function(){return e.list}})})(rj);var sL={},om={};Object.defineProperty(om,"__esModule",{value:!0});om.stringLiteral=void 0;const Qte=zt,ere=Fn,tre=tr;function rre(t){return(0,ere.createIdentitySchemaCreator)(Qte.SchemaType.STRING_LITERAL,(r,{breadcrumbsPrefix:n=[]}={})=>r===t?{ok:!0,value:t}:{ok:!1,errors:[{path:n,message:(0,tre.getErrorMessageForIncorrectType)(r,`"${t}"`)}]})()}om.stringLiteral=rre;var sm={};Object.defineProperty(sm,"__esModule",{value:!0});sm.booleanLiteral=void 0;const nre=zt,ire=Fn,are=tr;function ore(t){return(0,ire.createIdentitySchemaCreator)(nre.SchemaType.BOOLEAN_LITERAL,(r,{breadcrumbsPrefix:n=[]}={})=>r===t?{ok:!0,value:t}:{ok:!1,errors:[{path:n,message:(0,are.getErrorMessageForIncorrectType)(r,`${t.toString()}`)}]})()}sm.booleanLiteral=ore;(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.booleanLiteral=t.stringLiteral=void 0;var e=om;Object.defineProperty(t,"stringLiteral",{enumerable:!0,get:function(){return e.stringLiteral}});var r=sm;Object.defineProperty(t,"booleanLiteral",{enumerable:!0,get:function(){return r.booleanLiteral}})})(sL);var uL={},um={};Object.defineProperty(um,"__esModule",{value:!0});um.any=void 0;const sre=zt,ure=Fn;um.any=(0,ure.createIdentitySchemaCreator)(sre.SchemaType.ANY,t=>({ok:!0,value:t}));var lm={};Object.defineProperty(lm,"__esModule",{value:!0});lm.boolean=void 0;const lre=zt,cre=Fn,dre=tr;lm.boolean=(0,cre.createIdentitySchemaCreator)(lre.SchemaType.BOOLEAN,(t,{breadcrumbsPrefix:e=[]}={})=>typeof t=="boolean"?{ok:!0,value:t}:{ok:!1,errors:[{path:e,message:(0,dre.getErrorMessageForIncorrectType)(t,"boolean")}]});var cm={};Object.defineProperty(cm,"__esModule",{value:!0});cm.number=void 0;const fre=zt,hre=Fn,pre=tr;cm.number=(0,hre.createIdentitySchemaCreator)(fre.SchemaType.NUMBER,(t,{breadcrumbsPrefix:e=[]}={})=>typeof t=="number"?{ok:!0,value:t}:{ok:!1,errors:[{path:e,message:(0,pre.getErrorMessageForIncorrectType)(t,"number")}]});var dm={};Object.defineProperty(dm,"__esModule",{value:!0});dm.string=void 0;const _re=zt,yre=Fn,bre=tr;dm.string=(0,yre.createIdentitySchemaCreator)(_re.SchemaType.STRING,(t,{breadcrumbsPrefix:e=[]}={})=>typeof t=="string"?{ok:!0,value:t}:{ok:!1,errors:[{path:e,message:(0,bre.getErrorMessageForIncorrectType)(t,"string")}]});var fm={};Object.defineProperty(fm,"__esModule",{value:!0});fm.unknown=void 0;const gre=zt,mre=Fn;fm.unknown=(0,mre.createIdentitySchemaCreator)(gre.SchemaType.UNKNOWN,t=>({ok:!0,value:t}));(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.unknown=t.string=t.number=t.boolean=t.any=void 0;var e=um;Object.defineProperty(t,"any",{enumerable:!0,get:function(){return e.any}});var r=lm;Object.defineProperty(t,"boolean",{enumerable:!0,get:function(){return r.boolean}});var n=cm;Object.defineProperty(t,"number",{enumerable:!0,get:function(){return n.number}});var i=dm;Object.defineProperty(t,"string",{enumerable:!0,get:function(){return i.string}});var a=fm;Object.defineProperty(t,"unknown",{enumerable:!0,get:function(){return a.unknown}})})(uL);var lL={},hm={};Object.defineProperty(hm,"__esModule",{value:!0});hm.record=void 0;const D0=zt,vre=Od,wre=tr,Ore=Io,Sre=gn,Ere=xr;function Pre(t,e){const r={parse:(n,i)=>ZR({value:n,isKeyNumeric:t.getType()===D0.SchemaType.NUMBER,transformKey:a=>{var o;return t.parse(a,Object.assign(Object.assign({},i),{breadcrumbsPrefix:[...(o=i?.breadcrumbsPrefix)!==null&&o!==void 0?o:[],`${a} (key)`]}))},transformValue:(a,o)=>{var s;return e.parse(a,Object.assign(Object.assign({},i),{breadcrumbsPrefix:[...(s=i?.breadcrumbsPrefix)!==null&&s!==void 0?s:[],`${o}`]}))},breadcrumbsPrefix:i?.breadcrumbsPrefix}),json:(n,i)=>ZR({value:n,isKeyNumeric:t.getType()===D0.SchemaType.NUMBER,transformKey:a=>{var o;return t.json(a,Object.assign(Object.assign({},i),{breadcrumbsPrefix:[...(o=i?.breadcrumbsPrefix)!==null&&o!==void 0?o:[],`${a} (key)`]}))},transformValue:(a,o)=>{var s;return e.json(a,Object.assign(Object.assign({},i),{breadcrumbsPrefix:[...(s=i?.breadcrumbsPrefix)!==null&&s!==void 0?s:[],`${o}`]}))},breadcrumbsPrefix:i?.breadcrumbsPrefix}),getType:()=>D0.SchemaType.RECORD};return Object.assign(Object.assign({},(0,Sre.maybeSkipValidation)(r)),(0,Ere.getSchemaUtils)(r))}hm.record=Pre;function ZR({value:t,isKeyNumeric:e,transformKey:r,transformValue:n,breadcrumbsPrefix:i=[]}){return(0,Ore.isPlainObject)(t)?(0,vre.entries)(t).reduce((a,[o,s])=>{if(s==null)return a;const l=a;let c=o;if(e){const p=o.length>0?Number(o):NaN;isNaN(p)||(c=p)}const d=r(c),f=n(s,c);if(l.ok&&d.ok&&f.ok)return{ok:!0,value:Object.assign(Object.assign({},l.value),{[d.value]:f.value})};const h=[];return l.ok||h.push(...l.errors),d.ok||h.push(...d.errors),f.ok||h.push(...f.errors),{ok:!1,errors:h}},{ok:!0,value:{}}):{ok:!1,errors:[{path:i,message:(0,wre.getErrorMessageForIncorrectType)(t,"object")}]}}(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.record=void 0;var e=hm;Object.defineProperty(t,"record",{enumerable:!0,get:function(){return e.record}})})(lL);var cL={},pm={};Object.defineProperty(pm,"__esModule",{value:!0});pm.set=void 0;const jre=zt,Cre=tr,Mre=gn,Tre=rj,Rre=xr;function Are(t){const e=(0,Tre.list)(t),r={parse:(n,i)=>{const a=e.parse(n,i);return a.ok?{ok:!0,value:new Set(a.value)}:a},json:(n,i)=>{var a;return n instanceof Set?e.json([...n],i):{ok:!1,errors:[{path:(a=i?.breadcrumbsPrefix)!==null&&a!==void 0?a:[],message:(0,Cre.getErrorMessageForIncorrectType)(n,"Set")}]}},getType:()=>jre.SchemaType.SET};return Object.assign(Object.assign({},(0,Mre.maybeSkipValidation)(r)),(0,Rre.getSchemaUtils)(r))}pm.set=Are;(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.set=void 0;var e=pm;Object.defineProperty(t,"set",{enumerable:!0,get:function(){return e.set}})})(cL);var dL={},_m={};Object.defineProperty(_m,"__esModule",{value:!0});_m.undiscriminatedUnion=void 0;const $re=zt,Ire=gn,xre=xr;function Dre(t){const e={parse:(r,n)=>YR((i,a)=>i.parse(r,a),t,n),json:(r,n)=>YR((i,a)=>i.json(r,a),t,n),getType:()=>$re.SchemaType.UNDISCRIMINATED_UNION};return Object.assign(Object.assign({},(0,Ire.maybeSkipValidation)(e)),(0,xre.getSchemaUtils)(e))}_m.undiscriminatedUnion=Dre;function YR(t,e,r){const n=[];for(const[i,a]of e.entries()){const o=t(a,Object.assign(Object.assign({},r),{skipValidation:!1}));if(o.ok)return o;for(const s of o.errors)n.push({path:s.path,message:`[Variant ${i}] ${s.message}`})}return{ok:!1,errors:n}}(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.undiscriminatedUnion=void 0;var e=_m;Object.defineProperty(t,"undiscriminatedUnion",{enumerable:!0,get:function(){return e.undiscriminatedUnion}})})(dL);var fL={},ym={};Object.defineProperty(ym,"__esModule",{value:!0});ym.discriminant=void 0;function Nre(t,e){return{parsedDiscriminant:t,rawDiscriminant:e}}ym.discriminant=Nre;var bm={},zre=u&&u.__rest||function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r};Object.defineProperty(bm,"__esModule",{value:!0});bm.union=void 0;const Bre=zt,Ure=tr,Fre=Io,Lre=Ed,Vre=gn,kre=ej,Hre=Pd,qre=xr;function Gre(t,e){const r=typeof t=="string"?t:t.rawDiscriminant,n=typeof t=="string"?t:t.parsedDiscriminant,i=(0,kre.enum_)((0,Lre.keys)(e)),a={parse:(o,s)=>QR({value:o,discriminant:r,transformedDiscriminant:n,transformDiscriminantValue:l=>{var c;return i.parse(l,{allowUnrecognizedEnumValues:s?.allowUnrecognizedUnionMembers,breadcrumbsPrefix:[...(c=s?.breadcrumbsPrefix)!==null&&c!==void 0?c:[],r]})},getAdditionalPropertiesSchema:l=>e[l],allowUnrecognizedUnionMembers:s?.allowUnrecognizedUnionMembers,transformAdditionalProperties:(l,c)=>c.parse(l,s),breadcrumbsPrefix:s?.breadcrumbsPrefix}),json:(o,s)=>QR({value:o,discriminant:n,transformedDiscriminant:r,transformDiscriminantValue:l=>{var c;return i.json(l,{allowUnrecognizedEnumValues:s?.allowUnrecognizedUnionMembers,breadcrumbsPrefix:[...(c=s?.breadcrumbsPrefix)!==null&&c!==void 0?c:[],n]})},getAdditionalPropertiesSchema:l=>e[l],allowUnrecognizedUnionMembers:s?.allowUnrecognizedUnionMembers,transformAdditionalProperties:(l,c)=>c.json(l,s),breadcrumbsPrefix:s?.breadcrumbsPrefix}),getType:()=>Bre.SchemaType.UNION};return Object.assign(Object.assign(Object.assign({},(0,Vre.maybeSkipValidation)(a)),(0,qre.getSchemaUtils)(a)),(0,Hre.getObjectLikeUtils)(a))}bm.union=Gre;function QR({value:t,discriminant:e,transformedDiscriminant:r,transformDiscriminantValue:n,getAdditionalPropertiesSchema:i,allowUnrecognizedUnionMembers:a=!1,transformAdditionalProperties:o,breadcrumbsPrefix:s=[]}){if(!(0,Fre.isPlainObject)(t))return{ok:!1,errors:[{path:s,message:(0,Ure.getErrorMessageForIncorrectType)(t,"object")}]};const l=t,c=e,d=l[c],f=zre(l,[typeof c=="symbol"?c:c+""]);if(d==null)return{ok:!1,errors:[{path:s,message:`Missing discriminant ("${e}")`}]};const h=n(d);if(!h.ok)return{ok:!1,errors:h.errors};const p=i(h.value);if(p==null)return a?{ok:!0,value:Object.assign({[r]:h.value},f)}:{ok:!1,errors:[{path:[...s,e],message:"Unexpected discriminant value"}]};const b=o(f,p);return b.ok?{ok:!0,value:Object.assign({[r]:d},b.value)}:b}(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.union=t.discriminant=void 0;var e=ym;Object.defineProperty(t,"discriminant",{enumerable:!0,get:function(){return e.discriminant}});var r=bm;Object.defineProperty(t,"union",{enumerable:!0,get:function(){return r.union}})})(fL);(function(t){var e=u&&u.__createBinding||(Object.create?function(n,i,a,o){o===void 0&&(o=a);var s=Object.getOwnPropertyDescriptor(i,a);(!s||("get"in s?!i.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return i[a]}}),Object.defineProperty(n,o,s)}:function(n,i,a,o){o===void 0&&(o=a),n[o]=i[a]}),r=u&&u.__exportStar||function(n,i){for(var a in n)a!=="default"&&!Object.prototype.hasOwnProperty.call(i,a)&&e(i,n,a)};Object.defineProperty(t,"__esModule",{value:!0}),r(YF,t),r(tL,t),r(ej,t),r(rL,t),r(rj,t),r(sL,t),r(tj,t),r(Pd,t),r(uL,t),r(lL,t),r(xr,t),r(cL,t),r(dL,t),r(fL,t)})(ZF);(function(t){var e=u&&u.__createBinding||(Object.create?function(n,i,a,o){o===void 0&&(o=a);var s=Object.getOwnPropertyDescriptor(i,a);(!s||("get"in s?!i.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return i[a]}}),Object.defineProperty(n,o,s)}:function(n,i,a,o){o===void 0&&(o=a),n[o]=i[a]}),r=u&&u.__exportStar||function(n,i){for(var a in n)a!=="default"&&!Object.prototype.hasOwnProperty.call(i,a)&&e(i,n,a)};Object.defineProperty(t,"__esModule",{value:!0}),r(ZF,t)})(XF);(function(t){var e=u&&u.__createBinding||(Object.create?function(a,o,s,l){l===void 0&&(l=s);var c=Object.getOwnPropertyDescriptor(o,s);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(a,l,c)}:function(a,o,s,l){l===void 0&&(l=s),a[l]=o[s]}),r=u&&u.__setModuleDefault||(Object.create?function(a,o){Object.defineProperty(a,"default",{enumerable:!0,value:o})}:function(a,o){a.default=o}),n=u&&u.__exportStar||function(a,o){for(var s in a)s!=="default"&&!Object.prototype.hasOwnProperty.call(o,s)&&e(o,a,s)},i=u&&u.__importStar||function(a){if(a&&a.__esModule)return a;var o={};if(a!=null)for(var s in a)s!=="default"&&Object.prototype.hasOwnProperty.call(a,s)&&e(o,a,s);return r(o,a),o};Object.defineProperty(t,"__esModule",{value:!0}),t.serialization=void 0,n(pF,t),n(VF,t),n(HF,t),n(Lu,t),n(GF,t),t.serialization=i(XF)})(P);var cn={},Ec=u&&u.__awaiter||function(t,e,r,n){function i(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function s(d){try{c(n.next(d))}catch(f){o(f)}}function l(d){try{c(n.throw(d))}catch(f){o(f)}}function c(d){d.done?a(d.value):i(d.value).then(s,l)}c((n=n.apply(t,e||[])).next())})},Pc=u&&u.__asyncValues||function(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof __values=="function"?__values(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(a){r[a]=t[a]&&function(o){return new Promise(function(s,l){o=t[a](o),i(s,l,o.done,o.value)})}}function i(a,o,s,l){Promise.resolve(l).then(function(c){a({value:c,done:s})},o)}},Et=u&&u.__await||function(t){return this instanceof Et?(this.v=t,this):new Et(t)},jc=u&&u.__asyncGenerator||function(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(t,e||[]),i,a=[];return i={},o("next"),o("throw"),o("return"),i[Symbol.asyncIterator]=function(){return this},i;function o(h){n[h]&&(i[h]=function(p){return new Promise(function(b,g){a.push([h,p,b,g])>1||s(h,p)})})}function s(h,p){try{l(n[h](p))}catch(b){f(a[0][3],b)}}function l(h){h.value instanceof Et?Promise.resolve(h.value.v).then(c,d):f(a[0][2],h)}function c(h){s("next",h)}function d(h){s("throw",h)}function f(h,p){h(p),a.shift(),a.length&&s(a[0][0],a[0][1])}};Object.defineProperty(cn,"__esModule",{value:!0});cn.readableStreamAsyncIterable=cn._decodeChunks=cn.LineDecoder=cn._iterSSEMessages=cn.StreamUtils=void 0;const Zs=Rt;class Us{constructor(e,r){this.iterator=e,this.controller=r}static fromSSEResponse(e,r){let n=!1;function i(){return jc(this,arguments,function*(){var o,s;if(n)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");n=!0;let l=!1;try{try{for(var c=Pc(hL(e,r)),d;d=yield Et(c.next()),!d.done;){const f=d.value;if(!l){if(f.data.startsWith("[DONE]")){l=!0;continue}if(f.event===null){let h;try{h=JSON.parse(f.data)}catch(p){throw console.error("Could not parse message into JSON:",f.data),console.error("From chunk:",f.raw),p}if(h&&h.error)throw new Zs.CohereError({message:`Error: ${h.error}`});yield yield Et(h)}else{let h;try{h=JSON.parse(f.data)}catch(p){throw console.error("Could not parse message into JSON:",f.data),console.error("From chunk:",f.raw),p}if(f.event=="error")throw new Zs.CohereError({message:`Error: ${h.message}, ${h.error}`});yield yield Et({event:f.event,data:h})}}}}catch(f){o={error:f}}finally{try{d&&!d.done&&(s=c.return)&&(yield Et(s.call(c)))}finally{if(o)throw o.error}}l=!0}catch(f){if(f instanceof Error&&f.name==="AbortError")return yield Et(void 0);throw f}finally{l||r?.abort()}})}return new Us(i,r)}static fromReadableStream(e,r){let n=!1;function i(){return jc(this,arguments,function*(){var s,l;const c=new Vu,d=nj(e);try{for(var f=Pc(d),h;h=yield Et(f.next()),!h.done;){const p=h.value;for(const b of c.decode(p))yield yield Et(b)}}catch(p){s={error:p}}finally{try{h&&!h.done&&(l=f.return)&&(yield Et(l.call(f)))}finally{if(s)throw s.error}}for(const p of c.flush())yield yield Et(p)})}function a(){return jc(this,arguments,function*(){var s,l;if(n)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");n=!0;let c=!1;try{try{for(var d=Pc(i()),f;f=yield Et(d.next()),!f.done;){const h=f.value;c||h&&(yield yield Et(JSON.parse(h)))}}catch(h){s={error:h}}finally{try{f&&!f.done&&(l=d.return)&&(yield Et(l.call(d)))}finally{if(s)throw s.error}}c=!0}catch(h){if(h instanceof Error&&h.name==="AbortError")return yield Et(void 0);throw h}finally{c||r?.abort()}})}return new Us(a,r)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],r=[],n=this.iterator(),i=a=>({next:()=>{if(a.length===0){const o=n.next();e.push(o),r.push(o)}return a.shift()}});return[new Us(()=>i(e),this.controller),new Us(()=>i(r),this.controller)]}toReadableStream(){const e=this;let r;const n=new TextEncoder;return new ReadableStream({start(){return Ec(this,void 0,void 0,function*(){r=e[Symbol.asyncIterator]()})},pull(i){return Ec(this,void 0,void 0,function*(){try{const{value:a,done:o}=yield r.next();if(o)return i.close();const s=n.encode(JSON.stringify(a)+`
`);i.enqueue(s)}catch(a){i.error(a)}})},cancel(){var i;return Ec(this,void 0,void 0,function*(){yield(i=r.return)===null||i===void 0?void 0:i.call(r)})}})}}cn.StreamUtils=Us;function hL(t,e){return jc(this,arguments,function*(){var n,i;if(!t.body)throw e?.abort(),new Zs.CohereError({message:"Attempted to iterate over a response with no body"});const a=new Jre,o=new Vu,s=nj(t.body);try{for(var l=Pc(Wre(s)),c;c=yield Et(l.next()),!c.done;){const d=c.value;for(const f of o.decode(d)){const h=a.decode(f);h&&(yield yield Et(h))}}}catch(d){n={error:d}}finally{try{c&&!c.done&&(i=l.return)&&(yield Et(i.call(l)))}finally{if(n)throw n.error}}for(const d of o.flush()){const f=a.decode(d);f&&(yield yield Et(f))}})}cn._iterSSEMessages=hL;function Wre(t){return jc(this,arguments,function*(){var r,n;let i=new Uint8Array;try{for(var a=Pc(t),o;o=yield Et(a.next()),!o.done;){const s=o.value;if(s==null)continue;const l=s instanceof ArrayBuffer?new Uint8Array(s):typeof s=="string"?new TextEncoder().encode(s):s;let c=new Uint8Array(i.length+l.length);c.set(i),c.set(l,i.length),i=c;let d;for(;(d=Kre(i))!==-1;)yield yield Et(i.slice(0,d)),i=i.slice(d)}}catch(s){r={error:s}}finally{try{o&&!o.done&&(n=a.return)&&(yield Et(n.call(a)))}finally{if(r)throw r.error}}i.length>0&&(yield yield Et(i))})}function Kre(t){for(let n=0;n<t.length-2;n++){if(t[n]===10&&t[n+1]===10||t[n]===13&&t[n+1]===13)return n+2;if(t[n]===13&&t[n+1]===10&&n+3<t.length&&t[n+2]===13&&t[n+3]===10)return n+4}return-1}let Jre=class{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const a={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],a}if(this.chunks.push(e),e.startsWith(":"))return null;let[r,n,i]=Zre(e,":");return i.startsWith(" ")&&(i=i.substring(1)),r==="event"?this.event=i:r==="data"&&this.data.push(i),null}},Vu=class zS{constructor(){this.buffer=[],this.trailingCR=!1}decode(e){let r=this.decodeText(e);if(this.trailingCR&&(r="\r"+r,this.trailingCR=!1),r.endsWith("\r")&&(this.trailingCR=!0,r=r.slice(0,-1)),!r)return[];const n=zS.NEWLINE_CHARS.has(r[r.length-1]||"");let i=r.split(zS.NEWLINE_REGEXP);return n&&i.pop(),i.length===1&&!n?(this.buffer.push(i[0]),[]):(this.buffer.length>0&&(i=[this.buffer.join("")+i[0],...i.slice(1)],this.buffer=[]),n||(this.buffer=[i.pop()||""]),i)}decodeText(e){var r;if(e==null)return"";if(typeof e=="string")return e;if(typeof Buffer<"u"){if(e instanceof Buffer)return e.toString();if(e instanceof Uint8Array)return Buffer.from(e).toString();throw new Zs.CohereError({message:`Unexpected: received non-Uint8Array (${e.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`})}if(typeof TextDecoder<"u"){if(e instanceof Uint8Array||e instanceof ArrayBuffer)return(r=this.textDecoder)!==null&&r!==void 0||(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(e);throw new Zs.CohereError({message:`Unexpected: received non-Uint8Array/ArrayBuffer (${e.constructor.name}) in a web platform. Please report this error.`})}throw new Zs.CohereError({message:"Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error."})}flush(){if(!this.buffer.length&&!this.trailingCR)return[];const e=[this.buffer.join("")];return this.buffer=[],this.trailingCR=!1,e}};cn.LineDecoder=Vu;Vu.NEWLINE_CHARS=new Set([`
`,"\r"]);Vu.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function Xre(t){const e=new Vu,r=[];for(const n of t)r.push(...e.decode(n));return r}cn._decodeChunks=Xre;function Zre(t,e){const r=t.indexOf(e);return r!==-1?[t.substring(0,r),e,t.substring(r+e.length)]:[t,"",""]}function nj(t){if(t[Symbol.asyncIterator])return t;const e=t.getReader();return{next(){return Ec(this,void 0,void 0,function*(){try{const r=yield e.read();return r?.done&&e.releaseLock(),r}catch(r){throw e.releaseLock(),r}})},return(){return Ec(this,void 0,void 0,function*(){const r=e.cancel();return e.releaseLock(),yield r,{done:!0,value:void 0}})},[Symbol.asyncIterator](){return this}}}cn.readableStreamAsyncIterable=nj;var Gi={},pL={},_L={},ij={},jd={},xo={},Yre=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Qre=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),ene=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Yre(e,t,r);return Qre(e,t),e};Object.defineProperty(xo,"__esModule",{value:!0});xo.Document=void 0;const Ml=ene(P);xo.Document=Ml.serialization.object({data:Ml.serialization.record(Ml.serialization.string(),Ml.serialization.unknown()),id:Ml.serialization.string().optional()});var tne=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),rne=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),nne=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&tne(e,t,r);return rne(e,t),e};Object.defineProperty(jd,"__esModule",{value:!0});jd.V2ChatStreamRequestDocumentsItem=void 0;const eA=nne(P),ine=xo;jd.V2ChatStreamRequestDocumentsItem=eA.serialization.undiscriminatedUnion([eA.serialization.string(),ine.Document]);var Cd={},ane=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),one=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),sne=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&ane(e,t,r);return one(e,t),e};Object.defineProperty(Cd,"__esModule",{value:!0});Cd.V2ChatStreamRequestSafetyMode=void 0;const une=sne(P);Cd.V2ChatStreamRequestSafetyMode=une.serialization.enum_(["CONTEXTUAL","STRICT","OFF"]);var Md={},lne=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),cne=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),dne=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&lne(e,t,r);return cne(e,t),e};Object.defineProperty(Md,"__esModule",{value:!0});Md.V2ChatStreamRequestToolChoice=void 0;const fne=dne(P);Md.V2ChatStreamRequestToolChoice=fne.serialization.enum_(["REQUIRED","NONE"]);var Td={},hne=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),pne=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),_ne=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&hne(e,t,r);return pne(e,t),e};Object.defineProperty(Td,"__esModule",{value:!0});Td.V2ChatRequestDocumentsItem=void 0;const tA=_ne(P),yne=xo;Td.V2ChatRequestDocumentsItem=tA.serialization.undiscriminatedUnion([tA.serialization.string(),yne.Document]);var Rd={},bne=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),gne=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),mne=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&bne(e,t,r);return gne(e,t),e};Object.defineProperty(Rd,"__esModule",{value:!0});Rd.V2ChatRequestSafetyMode=void 0;const vne=mne(P);Rd.V2ChatRequestSafetyMode=vne.serialization.enum_(["CONTEXTUAL","STRICT","OFF"]);var Ad={},wne=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),One=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Sne=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&wne(e,t,r);return One(e,t),e};Object.defineProperty(Ad,"__esModule",{value:!0});Ad.V2ChatRequestToolChoice=void 0;const Ene=Sne(P);Ad.V2ChatRequestToolChoice=Ene.serialization.enum_(["REQUIRED","NONE"]);var $d={},Pne=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),jne=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Cne=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Pne(e,t,r);return jne(e,t),e};Object.defineProperty($d,"__esModule",{value:!0});$d.V2EmbedRequestTruncate=void 0;const Mne=Cne(P);$d.V2EmbedRequestTruncate=Mne.serialization.enum_(["NONE","START","END"]);var Id={},Tne=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Rne=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Ane=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Tne(e,t,r);return Rne(e,t),e};Object.defineProperty(Id,"__esModule",{value:!0});Id.V2RerankResponseResultsItemDocument=void 0;const rA=Ane(P);Id.V2RerankResponseResultsItemDocument=rA.serialization.object({text:rA.serialization.string()});var xd={},$ne=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Ine=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),xne=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&$ne(e,t,r);return Ine(e,t),e};Object.defineProperty(xd,"__esModule",{value:!0});xd.V2RerankResponseResultsItem=void 0;const h_=xne(P),Dne=Id;xd.V2RerankResponseResultsItem=h_.serialization.object({document:Dne.V2RerankResponseResultsItemDocument.optional(),index:h_.serialization.number(),relevanceScore:h_.serialization.property("relevance_score",h_.serialization.number())});var gm={},hr={},Dd={},Nne=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),zne=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Bne=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Nne(e,t,r);return zne(e,t),e};Object.defineProperty(Dd,"__esModule",{value:!0});Dd.ApiMetaApiVersion=void 0;const ns=Bne(P);Dd.ApiMetaApiVersion=ns.serialization.object({version:ns.serialization.string(),isDeprecated:ns.serialization.property("is_deprecated",ns.serialization.boolean().optional()),isExperimental:ns.serialization.property("is_experimental",ns.serialization.boolean().optional())});var Nd={},Une=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Fne=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Lne=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Une(e,t,r);return Fne(e,t),e};Object.defineProperty(Nd,"__esModule",{value:!0});Nd.ApiMetaBilledUnits=void 0;const bi=Lne(P);Nd.ApiMetaBilledUnits=bi.serialization.object({images:bi.serialization.number().optional(),inputTokens:bi.serialization.property("input_tokens",bi.serialization.number().optional()),outputTokens:bi.serialization.property("output_tokens",bi.serialization.number().optional()),searchUnits:bi.serialization.property("search_units",bi.serialization.number().optional()),classifications:bi.serialization.number().optional()});var zd={},Vne=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),kne=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Hne=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Vne(e,t,r);return kne(e,t),e};Object.defineProperty(zd,"__esModule",{value:!0});zd.ApiMetaTokens=void 0;const Tl=Hne(P);zd.ApiMetaTokens=Tl.serialization.object({inputTokens:Tl.serialization.property("input_tokens",Tl.serialization.number().optional()),outputTokens:Tl.serialization.property("output_tokens",Tl.serialization.number().optional())});var qne=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Gne=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Wne=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&qne(e,t,r);return Gne(e,t),e};Object.defineProperty(hr,"__esModule",{value:!0});hr.ApiMeta=void 0;const Rl=Wne(P),Kne=Dd,Jne=Nd,Xne=zd;hr.ApiMeta=Rl.serialization.object({apiVersion:Rl.serialization.property("api_version",Kne.ApiMetaApiVersion.optional()),billedUnits:Rl.serialization.property("billed_units",Jne.ApiMetaBilledUnits.optional()),tokens:Xne.ApiMetaTokens.optional(),warnings:Rl.serialization.list(Rl.serialization.string()).optional()});var Zne=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Yne=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Qne=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Zne(e,t,r);return Yne(e,t),e};Object.defineProperty(gm,"__esModule",{value:!0});gm.V2RerankResponse=void 0;const N0=Qne(P),eie=xd,tie=hr;gm.V2RerankResponse=N0.serialization.object({id:N0.serialization.string().optional(),results:N0.serialization.list(eie.V2RerankResponseResultsItem),meta:tie.ApiMeta.optional()});(function(t){var e=u&&u.__createBinding||(Object.create?function(n,i,a,o){o===void 0&&(o=a);var s=Object.getOwnPropertyDescriptor(i,a);(!s||("get"in s?!i.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return i[a]}}),Object.defineProperty(n,o,s)}:function(n,i,a,o){o===void 0&&(o=a),n[o]=i[a]}),r=u&&u.__exportStar||function(n,i){for(var a in n)a!=="default"&&!Object.prototype.hasOwnProperty.call(i,a)&&e(i,n,a)};Object.defineProperty(t,"__esModule",{value:!0}),r(jd,t),r(Cd,t),r(Md,t),r(Td,t),r(Rd,t),r(Ad,t),r($d,t),r(Id,t),r(xd,t),r(gm,t)})(ij);var yL={},aj={},mm={},ku={},Bd={},Ud={},Fd={},Ld={},Wi={},rie=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),nie=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),iie=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&rie(e,t,r);return nie(e,t),e};Object.defineProperty(Wi,"__esModule",{value:!0});Wi.TextContent=void 0;const nA=iie(P);Wi.TextContent=nA.serialization.object({text:nA.serialization.string()});var Vd={},kd={},aie=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),oie=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),sie=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&aie(e,t,r);return oie(e,t),e};Object.defineProperty(kd,"__esModule",{value:!0});kd.ImageUrl=void 0;const iA=sie(P);kd.ImageUrl=iA.serialization.object({url:iA.serialization.string()});var uie=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),lie=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),cie=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&uie(e,t,r);return lie(e,t),e};Object.defineProperty(Vd,"__esModule",{value:!0});Vd.ImageContent=void 0;const aA=cie(P),die=kd;Vd.ImageContent=aA.serialization.object({imageUrl:aA.serialization.property("image_url",die.ImageUrl)});var fie=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),hie=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),pie=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&fie(e,t,r);return hie(e,t),e};Object.defineProperty(Ld,"__esModule",{value:!0});Ld.Content=void 0;const _ie=pie(P),yie=Wi,bie=Vd;Ld.Content=_ie.serialization.union("type",{text:yie.TextContent,image_url:bie.ImageContent}).transform({transform:t=>t,untransform:t=>t});var gie=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),mie=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),vie=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&gie(e,t,r);return mie(e,t),e};Object.defineProperty(Fd,"__esModule",{value:!0});Fd.UserMessageContent=void 0;const z0=vie(P),wie=Ld;Fd.UserMessageContent=z0.serialization.undiscriminatedUnion([z0.serialization.string(),z0.serialization.list(wie.Content)]);var Oie=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Sie=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Eie=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Oie(e,t,r);return Sie(e,t),e};Object.defineProperty(Ud,"__esModule",{value:!0});Ud.UserMessage=void 0;const Pie=Eie(P),jie=Fd;Ud.UserMessage=Pie.serialization.object({content:jie.UserMessageContent});var Hd={},Do={},qd={},Cie=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Mie=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Tie=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Cie(e,t,r);return Mie(e,t),e};Object.defineProperty(qd,"__esModule",{value:!0});qd.ToolCallV2Function=void 0;const B0=Tie(P);qd.ToolCallV2Function=B0.serialization.object({name:B0.serialization.string().optional(),arguments:B0.serialization.string().optional()});var Rie=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Aie=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),$ie=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Rie(e,t,r);return Aie(e,t),e};Object.defineProperty(Do,"__esModule",{value:!0});Do.ToolCallV2=void 0;const U0=$ie(P),Iie=qd;Do.ToolCallV2=U0.serialization.object({id:U0.serialization.string().optional(),type:U0.serialization.stringLiteral("function").optional(),function:Iie.ToolCallV2Function.optional()});var Gd={},Wd={},xie=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Die=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Nie=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&xie(e,t,r);return Die(e,t),e};Object.defineProperty(Wd,"__esModule",{value:!0});Wd.AssistantMessageContentItem=void 0;const zie=Nie(P),Bie=Wi;Wd.AssistantMessageContentItem=zie.serialization.union("type",{text:Bie.TextContent}).transform({transform:t=>t,untransform:t=>t});var Uie=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Fie=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Lie=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Uie(e,t,r);return Fie(e,t),e};Object.defineProperty(Gd,"__esModule",{value:!0});Gd.AssistantMessageContent=void 0;const F0=Lie(P),Vie=Wd;Gd.AssistantMessageContent=F0.serialization.undiscriminatedUnion([F0.serialization.string(),F0.serialization.list(Vie.AssistantMessageContentItem)]);var No={},Kd={},Jd={},kie=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Hie=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),qie=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&kie(e,t,r);return Hie(e,t),e};Object.defineProperty(Jd,"__esModule",{value:!0});Jd.ToolSource=void 0;const is=qie(P);Jd.ToolSource=is.serialization.object({id:is.serialization.string().optional(),toolOutput:is.serialization.property("tool_output",is.serialization.record(is.serialization.string(),is.serialization.unknown()).optional())});var Xd={},Gie=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Wie=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Kie=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Gie(e,t,r);return Wie(e,t),e};Object.defineProperty(Xd,"__esModule",{value:!0});Xd.DocumentSource=void 0;const Al=Kie(P);Xd.DocumentSource=Al.serialization.object({id:Al.serialization.string().optional(),document:Al.serialization.record(Al.serialization.string(),Al.serialization.unknown()).optional()});var Jie=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Xie=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Zie=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Jie(e,t,r);return Xie(e,t),e};Object.defineProperty(Kd,"__esModule",{value:!0});Kd.Source=void 0;const Yie=Zie(P),Qie=Jd,eae=Xd;Kd.Source=Yie.serialization.union("type",{tool:Qie.ToolSource,document:eae.DocumentSource}).transform({transform:t=>t,untransform:t=>t});var Zd={},tae=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),rae=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),nae=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&tae(e,t,r);return rae(e,t),e};Object.defineProperty(Zd,"__esModule",{value:!0});Zd.CitationType=void 0;const iae=nae(P);Zd.CitationType=iae.serialization.enum_(["TEXT_CONTENT","PLAN"]);var aae=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),oae=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),sae=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&aae(e,t,r);return oae(e,t),e};Object.defineProperty(No,"__esModule",{value:!0});No.Citation=void 0;const $l=sae(P),uae=Kd,lae=Zd;No.Citation=$l.serialization.object({start:$l.serialization.number().optional(),end:$l.serialization.number().optional(),text:$l.serialization.string().optional(),sources:$l.serialization.list(uae.Source).optional(),type:lae.CitationType.optional()});var cae=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),dae=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),fae=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&cae(e,t,r);return dae(e,t),e};Object.defineProperty(Hd,"__esModule",{value:!0});Hd.AssistantMessage=void 0;const as=fae(P),hae=Do,pae=Gd,_ae=No;Hd.AssistantMessage=as.serialization.object({toolCalls:as.serialization.property("tool_calls",as.serialization.list(hae.ToolCallV2).optional()),toolPlan:as.serialization.property("tool_plan",as.serialization.string().optional()),content:pae.AssistantMessageContent.optional(),citations:as.serialization.list(_ae.Citation).optional()});var Yd={},Qd={},ef={},yae=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),bae=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),gae=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&yae(e,t,r);return bae(e,t),e};Object.defineProperty(ef,"__esModule",{value:!0});ef.SystemMessageContentItem=void 0;const mae=gae(P),vae=Wi;ef.SystemMessageContentItem=mae.serialization.union("type",{text:vae.TextContent}).transform({transform:t=>t,untransform:t=>t});var wae=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Oae=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Sae=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&wae(e,t,r);return Oae(e,t),e};Object.defineProperty(Qd,"__esModule",{value:!0});Qd.SystemMessageContent=void 0;const L0=Sae(P),Eae=ef;Qd.SystemMessageContent=L0.serialization.undiscriminatedUnion([L0.serialization.string(),L0.serialization.list(Eae.SystemMessageContentItem)]);var Pae=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),jae=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Cae=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Pae(e,t,r);return jae(e,t),e};Object.defineProperty(Yd,"__esModule",{value:!0});Yd.SystemMessage=void 0;const Mae=Cae(P),Tae=Qd;Yd.SystemMessage=Mae.serialization.object({content:Tae.SystemMessageContent});var tf={},rf={},nf={},af={},Rae=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Aae=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),$ae=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Rae(e,t,r);return Aae(e,t),e};Object.defineProperty(af,"__esModule",{value:!0});af.DocumentContent=void 0;const Iae=$ae(P),xae=xo;af.DocumentContent=Iae.serialization.object({document:xae.Document});var Dae=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Nae=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),zae=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Dae(e,t,r);return Nae(e,t),e};Object.defineProperty(nf,"__esModule",{value:!0});nf.ToolContent=void 0;const Bae=zae(P),Uae=Wi,Fae=af;nf.ToolContent=Bae.serialization.union("type",{text:Uae.TextContent,document:Fae.DocumentContent}).transform({transform:t=>t,untransform:t=>t});var Lae=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Vae=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),kae=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Lae(e,t,r);return Vae(e,t),e};Object.defineProperty(rf,"__esModule",{value:!0});rf.ToolMessageV2Content=void 0;const V0=kae(P),Hae=nf;rf.ToolMessageV2Content=V0.serialization.undiscriminatedUnion([V0.serialization.string(),V0.serialization.list(Hae.ToolContent)]);var qae=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Gae=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Wae=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&qae(e,t,r);return Gae(e,t),e};Object.defineProperty(tf,"__esModule",{value:!0});tf.ToolMessageV2=void 0;const k0=Wae(P),Kae=rf;tf.ToolMessageV2=k0.serialization.object({toolCallId:k0.serialization.property("tool_call_id",k0.serialization.string()),content:Kae.ToolMessageV2Content});var Jae=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Xae=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Zae=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Jae(e,t,r);return Xae(e,t),e};Object.defineProperty(Bd,"__esModule",{value:!0});Bd.ChatMessageV2=void 0;const Yae=Zae(P),Qae=Ud,eoe=Hd,toe=Yd,roe=tf;Bd.ChatMessageV2=Yae.serialization.union("role",{user:Qae.UserMessage,assistant:eoe.AssistantMessage,system:toe.SystemMessage,tool:roe.ToolMessageV2}).transform({transform:t=>t,untransform:t=>t});var noe=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),ioe=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),aoe=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&noe(e,t,r);return ioe(e,t),e};Object.defineProperty(ku,"__esModule",{value:!0});ku.ChatMessages=void 0;const ooe=aoe(P),soe=Bd;ku.ChatMessages=ooe.serialization.list(soe.ChatMessageV2);var Hu={},of={},uoe=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),loe=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),coe=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&uoe(e,t,r);return loe(e,t),e};Object.defineProperty(of,"__esModule",{value:!0});of.ToolV2Function=void 0;const os=coe(P);of.ToolV2Function=os.serialization.object({name:os.serialization.string(),description:os.serialization.string().optional(),parameters:os.serialization.record(os.serialization.string(),os.serialization.unknown())});var doe=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),foe=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),hoe=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&doe(e,t,r);return foe(e,t),e};Object.defineProperty(Hu,"__esModule",{value:!0});Hu.ToolV2=void 0;const oA=hoe(P),poe=of;Hu.ToolV2=oA.serialization.object({type:oA.serialization.stringLiteral("function").optional(),function:poe.ToolV2Function.optional()});var qu={},sf={},_oe=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),yoe=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),boe=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&_oe(e,t,r);return yoe(e,t),e};Object.defineProperty(sf,"__esModule",{value:!0});sf.CitationOptionsMode=void 0;const goe=boe(P);sf.CitationOptionsMode=goe.serialization.enum_(["FAST","ACCURATE","OFF"]);var moe=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),voe=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),woe=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&moe(e,t,r);return voe(e,t),e};Object.defineProperty(qu,"__esModule",{value:!0});qu.CitationOptions=void 0;const Ooe=woe(P),Soe=sf;qu.CitationOptions=Ooe.serialization.object({mode:Soe.CitationOptionsMode.optional()});var Gu={},uf={},Eoe=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Poe=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),joe=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Eoe(e,t,r);return Poe(e,t),e};Object.defineProperty(uf,"__esModule",{value:!0});uf.TextResponseFormatV2=void 0;const Coe=joe(P);uf.TextResponseFormatV2=Coe.serialization.object({});var lf={},Moe=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Toe=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Roe=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Moe(e,t,r);return Toe(e,t),e};Object.defineProperty(lf,"__esModule",{value:!0});lf.JsonResponseFormatV2=void 0;const Il=Roe(P);lf.JsonResponseFormatV2=Il.serialization.object({jsonSchema:Il.serialization.property("json_schema",Il.serialization.record(Il.serialization.string(),Il.serialization.unknown()).optional())});var Aoe=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),$oe=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Ioe=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Aoe(e,t,r);return $oe(e,t),e};Object.defineProperty(Gu,"__esModule",{value:!0});Gu.ResponseFormatV2=void 0;const xoe=Ioe(P),Doe=uf,Noe=lf;Gu.ResponseFormatV2=xoe.serialization.union("type",{text:Doe.TextResponseFormatV2,json_object:Noe.JsonResponseFormatV2}).transform({transform:t=>t,untransform:t=>t});var zoe=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Boe=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Uoe=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&zoe(e,t,r);return Boe(e,t),e};Object.defineProperty(mm,"__esModule",{value:!0});mm.V2ChatStreamRequest=void 0;const ft=Uoe(P),Foe=ku,Loe=Hu,Voe=jd,koe=qu,Hoe=Gu,qoe=Cd,Goe=Md;mm.V2ChatStreamRequest=ft.serialization.object({model:ft.serialization.string(),messages:Foe.ChatMessages,tools:ft.serialization.list(Loe.ToolV2).optional(),strictTools:ft.serialization.property("strict_tools",ft.serialization.boolean().optional()),documents:ft.serialization.list(Voe.V2ChatStreamRequestDocumentsItem).optional(),citationOptions:ft.serialization.property("citation_options",koe.CitationOptions.optional()),responseFormat:ft.serialization.property("response_format",Hoe.ResponseFormatV2.optional()),safetyMode:ft.serialization.property("safety_mode",qoe.V2ChatStreamRequestSafetyMode.optional()),maxTokens:ft.serialization.property("max_tokens",ft.serialization.number().optional()),stopSequences:ft.serialization.property("stop_sequences",ft.serialization.list(ft.serialization.string()).optional()),temperature:ft.serialization.number().optional(),seed:ft.serialization.number().optional(),frequencyPenalty:ft.serialization.property("frequency_penalty",ft.serialization.number().optional()),presencePenalty:ft.serialization.property("presence_penalty",ft.serialization.number().optional()),k:ft.serialization.number().optional(),p:ft.serialization.number().optional(),returnPrompt:ft.serialization.property("return_prompt",ft.serialization.boolean().optional()),logprobs:ft.serialization.boolean().optional(),toolChoice:ft.serialization.property("tool_choice",Goe.V2ChatStreamRequestToolChoice.optional())});var vm={},Woe=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Koe=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Joe=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Woe(e,t,r);return Koe(e,t),e};Object.defineProperty(vm,"__esModule",{value:!0});vm.V2ChatRequest=void 0;const ht=Joe(P),Xoe=ku,Zoe=Hu,Yoe=Td,Qoe=qu,ese=Gu,tse=Rd,rse=Ad;vm.V2ChatRequest=ht.serialization.object({model:ht.serialization.string(),messages:Xoe.ChatMessages,tools:ht.serialization.list(Zoe.ToolV2).optional(),strictTools:ht.serialization.property("strict_tools",ht.serialization.boolean().optional()),documents:ht.serialization.list(Yoe.V2ChatRequestDocumentsItem).optional(),citationOptions:ht.serialization.property("citation_options",Qoe.CitationOptions.optional()),responseFormat:ht.serialization.property("response_format",ese.ResponseFormatV2.optional()),safetyMode:ht.serialization.property("safety_mode",tse.V2ChatRequestSafetyMode.optional()),maxTokens:ht.serialization.property("max_tokens",ht.serialization.number().optional()),stopSequences:ht.serialization.property("stop_sequences",ht.serialization.list(ht.serialization.string()).optional()),temperature:ht.serialization.number().optional(),seed:ht.serialization.number().optional(),frequencyPenalty:ht.serialization.property("frequency_penalty",ht.serialization.number().optional()),presencePenalty:ht.serialization.property("presence_penalty",ht.serialization.number().optional()),k:ht.serialization.number().optional(),p:ht.serialization.number().optional(),returnPrompt:ht.serialization.property("return_prompt",ht.serialization.boolean().optional()),logprobs:ht.serialization.boolean().optional(),toolChoice:ht.serialization.property("tool_choice",rse.V2ChatRequestToolChoice.optional())});var wm={},zo={},nse=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),ise=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),ase=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&nse(e,t,r);return ise(e,t),e};Object.defineProperty(zo,"__esModule",{value:!0});zo.EmbedInputType=void 0;const ose=ase(P);zo.EmbedInputType=ose.serialization.enum_(["search_document","search_query","classification","clustering","image"]);var Bo={},sse=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),use=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),lse=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&sse(e,t,r);return use(e,t),e};Object.defineProperty(Bo,"__esModule",{value:!0});Bo.EmbeddingType=void 0;const cse=lse(P);Bo.EmbeddingType=cse.serialization.enum_(["float","int8","uint8","binary","ubinary"]);var dse=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),fse=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),hse=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&dse(e,t,r);return fse(e,t),e};Object.defineProperty(wm,"__esModule",{value:!0});wm.V2EmbedRequest=void 0;const gi=hse(P),pse=zo,_se=Bo,yse=$d;wm.V2EmbedRequest=gi.serialization.object({texts:gi.serialization.list(gi.serialization.string()).optional(),images:gi.serialization.list(gi.serialization.string()).optional(),model:gi.serialization.string(),inputType:gi.serialization.property("input_type",pse.EmbedInputType),embeddingTypes:gi.serialization.property("embedding_types",gi.serialization.list(_se.EmbeddingType)),truncate:yse.V2EmbedRequestTruncate.optional()});var Om={},bse=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),gse=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),mse=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&bse(e,t,r);return gse(e,t),e};Object.defineProperty(Om,"__esModule",{value:!0});Om.V2RerankRequest=void 0;const En=mse(P);Om.V2RerankRequest=En.serialization.object({model:En.serialization.string(),query:En.serialization.string(),documents:En.serialization.list(En.serialization.string()),topN:En.serialization.property("top_n",En.serialization.number().optional()),returnDocuments:En.serialization.property("return_documents",En.serialization.boolean().optional()),maxTokensPerDoc:En.serialization.property("max_tokens_per_doc",En.serialization.number().optional())});(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.V2RerankRequest=t.V2EmbedRequest=t.V2ChatRequest=t.V2ChatStreamRequest=void 0;var e=mm;Object.defineProperty(t,"V2ChatStreamRequest",{enumerable:!0,get:function(){return e.V2ChatStreamRequest}});var r=vm;Object.defineProperty(t,"V2ChatRequest",{enumerable:!0,get:function(){return r.V2ChatRequest}});var n=wm;Object.defineProperty(t,"V2EmbedRequest",{enumerable:!0,get:function(){return n.V2EmbedRequest}});var i=Om;Object.defineProperty(t,"V2RerankRequest",{enumerable:!0,get:function(){return i.V2RerankRequest}})})(aj);(function(t){var e=u&&u.__createBinding||(Object.create?function(n,i,a,o){o===void 0&&(o=a);var s=Object.getOwnPropertyDescriptor(i,a);(!s||("get"in s?!i.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return i[a]}}),Object.defineProperty(n,o,s)}:function(n,i,a,o){o===void 0&&(o=a),n[o]=i[a]}),r=u&&u.__exportStar||function(n,i){for(var a in n)a!=="default"&&!Object.prototype.hasOwnProperty.call(i,a)&&e(i,n,a)};Object.defineProperty(t,"__esModule",{value:!0}),r(aj,t)})(yL);(function(t){var e=u&&u.__createBinding||(Object.create?function(n,i,a,o){o===void 0&&(o=a);var s=Object.getOwnPropertyDescriptor(i,a);(!s||("get"in s?!i.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return i[a]}}),Object.defineProperty(n,o,s)}:function(n,i,a,o){o===void 0&&(o=a),n[o]=i[a]}),r=u&&u.__exportStar||function(n,i){for(var a in n)a!=="default"&&!Object.prototype.hasOwnProperty.call(i,a)&&e(i,n,a)};Object.defineProperty(t,"__esModule",{value:!0}),r(ij,t),r(yL,t)})(_L);var bL={},oj={},cf={},vse=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),wse=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Ose=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&vse(e,t,r);return wse(e,t),e};Object.defineProperty(cf,"__esModule",{value:!0});cf.CreateEmbedJobRequestTruncate=void 0;const Sse=Ose(P);cf.CreateEmbedJobRequestTruncate=Sse.serialization.enum_(["START","END"]);(function(t){var e=u&&u.__createBinding||(Object.create?function(n,i,a,o){o===void 0&&(o=a);var s=Object.getOwnPropertyDescriptor(i,a);(!s||("get"in s?!i.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return i[a]}}),Object.defineProperty(n,o,s)}:function(n,i,a,o){o===void 0&&(o=a),n[o]=i[a]}),r=u&&u.__exportStar||function(n,i){for(var a in n)a!=="default"&&!Object.prototype.hasOwnProperty.call(i,a)&&e(i,n,a)};Object.defineProperty(t,"__esModule",{value:!0}),r(cf,t)})(oj);var gL={},sj={},Sm={},Ese=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Pse=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),jse=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Ese(e,t,r);return Pse(e,t),e};Object.defineProperty(Sm,"__esModule",{value:!0});Sm.CreateEmbedJobRequest=void 0;const ra=jse(P),Cse=zo,Mse=Bo,Tse=cf;Sm.CreateEmbedJobRequest=ra.serialization.object({model:ra.serialization.string(),datasetId:ra.serialization.property("dataset_id",ra.serialization.string()),inputType:ra.serialization.property("input_type",Cse.EmbedInputType),name:ra.serialization.string().optional(),embeddingTypes:ra.serialization.property("embedding_types",ra.serialization.list(Mse.EmbeddingType).optional()),truncate:Tse.CreateEmbedJobRequestTruncate.optional()});(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.CreateEmbedJobRequest=void 0;var e=Sm;Object.defineProperty(t,"CreateEmbedJobRequest",{enumerable:!0,get:function(){return e.CreateEmbedJobRequest}})})(sj);(function(t){var e=u&&u.__createBinding||(Object.create?function(n,i,a,o){o===void 0&&(o=a);var s=Object.getOwnPropertyDescriptor(i,a);(!s||("get"in s?!i.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return i[a]}}),Object.defineProperty(n,o,s)}:function(n,i,a,o){o===void 0&&(o=a),n[o]=i[a]}),r=u&&u.__exportStar||function(n,i){for(var a in n)a!=="default"&&!Object.prototype.hasOwnProperty.call(i,a)&&e(i,n,a)};Object.defineProperty(t,"__esModule",{value:!0}),r(sj,t)})(gL);(function(t){var e=u&&u.__createBinding||(Object.create?function(n,i,a,o){o===void 0&&(o=a);var s=Object.getOwnPropertyDescriptor(i,a);(!s||("get"in s?!i.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return i[a]}}),Object.defineProperty(n,o,s)}:function(n,i,a,o){o===void 0&&(o=a),n[o]=i[a]}),r=u&&u.__exportStar||function(n,i){for(var a in n)a!=="default"&&!Object.prototype.hasOwnProperty.call(i,a)&&e(i,n,a)};Object.defineProperty(t,"__esModule",{value:!0}),r(oj,t),r(gL,t)})(bL);var mL={},uj={},Em={},Wu={},df={},Rse=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Ase=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),$se=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Rse(e,t,r);return Ase(e,t),e};Object.defineProperty(df,"__esModule",{value:!0});df.DatasetType=void 0;const Ise=$se(P);df.DatasetType=Ise.serialization.enum_(["embed-input","embed-result","cluster-result","cluster-outliers","reranker-finetune-input","single-label-classification-finetune-input","chat-finetune-input","multi-label-classification-finetune-input"]);var ff={},xse=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Dse=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Nse=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&xse(e,t,r);return Dse(e,t),e};Object.defineProperty(ff,"__esModule",{value:!0});ff.DatasetValidationStatus=void 0;const zse=Nse(P);ff.DatasetValidationStatus=zse.serialization.enum_(["unknown","queued","processing","failed","validated","skipped"]);var hf={},Bse=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Use=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Fse=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Bse(e,t,r);return Use(e,t),e};Object.defineProperty(hf,"__esModule",{value:!0});hf.DatasetPart=void 0;const Nr=Fse(P);hf.DatasetPart=Nr.serialization.object({id:Nr.serialization.string(),name:Nr.serialization.string(),url:Nr.serialization.string().optional(),index:Nr.serialization.number().optional(),sizeBytes:Nr.serialization.property("size_bytes",Nr.serialization.number().optional()),numRows:Nr.serialization.property("num_rows",Nr.serialization.number().optional()),originalUrl:Nr.serialization.property("original_url",Nr.serialization.string().optional()),samples:Nr.serialization.list(Nr.serialization.string()).optional()});var Lse=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Vse=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),kse=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Lse(e,t,r);return Vse(e,t),e};Object.defineProperty(Wu,"__esModule",{value:!0});Wu.Dataset=void 0;const Ct=kse(P),Hse=df,qse=ff,Gse=hf;Wu.Dataset=Ct.serialization.object({id:Ct.serialization.string(),name:Ct.serialization.string(),createdAt:Ct.serialization.property("created_at",Ct.serialization.date()),updatedAt:Ct.serialization.property("updated_at",Ct.serialization.date()),datasetType:Ct.serialization.property("dataset_type",Hse.DatasetType),validationStatus:Ct.serialization.property("validation_status",qse.DatasetValidationStatus),validationError:Ct.serialization.property("validation_error",Ct.serialization.string().optional()),schema:Ct.serialization.string().optional(),requiredFields:Ct.serialization.property("required_fields",Ct.serialization.list(Ct.serialization.string()).optional()),preserveFields:Ct.serialization.property("preserve_fields",Ct.serialization.list(Ct.serialization.string()).optional()),datasetParts:Ct.serialization.property("dataset_parts",Ct.serialization.list(Gse.DatasetPart).optional()),validationWarnings:Ct.serialization.property("validation_warnings",Ct.serialization.list(Ct.serialization.string()).optional())});var Wse=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Kse=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Jse=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Wse(e,t,r);return Kse(e,t),e};Object.defineProperty(Em,"__esModule",{value:!0});Em.DatasetsListResponse=void 0;const sA=Jse(P),Xse=Wu;Em.DatasetsListResponse=sA.serialization.object({datasets:sA.serialization.list(Xse.Dataset).optional()});var Pm={},Zse=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Yse=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Qse=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Zse(e,t,r);return Yse(e,t),e};Object.defineProperty(Pm,"__esModule",{value:!0});Pm.DatasetsCreateResponseDatasetPartsItem=void 0;const na=Qse(P);Pm.DatasetsCreateResponseDatasetPartsItem=na.serialization.object({name:na.serialization.string().optional(),numRows:na.serialization.property("num_rows",na.serialization.number().optional()),samples:na.serialization.list(na.serialization.string()).optional(),partKind:na.serialization.property("part_kind",na.serialization.string().optional())});var jm={},eue=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),tue=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),rue=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&eue(e,t,r);return tue(e,t),e};Object.defineProperty(jm,"__esModule",{value:!0});jm.DatasetsCreateResponse=void 0;const uA=rue(P);jm.DatasetsCreateResponse=uA.serialization.object({id:uA.serialization.string().optional()});var Cm={},nue=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),iue=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),aue=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&nue(e,t,r);return iue(e,t),e};Object.defineProperty(Cm,"__esModule",{value:!0});Cm.DatasetsGetUsageResponse=void 0;const H0=aue(P);Cm.DatasetsGetUsageResponse=H0.serialization.object({organizationUsage:H0.serialization.property("organization_usage",H0.serialization.number().optional())});var Mm={},oue=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),sue=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),uue=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&oue(e,t,r);return sue(e,t),e};Object.defineProperty(Mm,"__esModule",{value:!0});Mm.DatasetsGetResponse=void 0;const lue=uue(P),cue=Wu;Mm.DatasetsGetResponse=lue.serialization.object({dataset:cue.Dataset});(function(t){var e=u&&u.__createBinding||(Object.create?function(n,i,a,o){o===void 0&&(o=a);var s=Object.getOwnPropertyDescriptor(i,a);(!s||("get"in s?!i.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return i[a]}}),Object.defineProperty(n,o,s)}:function(n,i,a,o){o===void 0&&(o=a),n[o]=i[a]}),r=u&&u.__exportStar||function(n,i){for(var a in n)a!=="default"&&!Object.prototype.hasOwnProperty.call(i,a)&&e(i,n,a)};Object.defineProperty(t,"__esModule",{value:!0}),r(Em,t),r(Pm,t),r(jm,t),r(Cm,t),r(Mm,t)})(uj);var Tm={},Rm={},due=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),fue=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),hue=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&due(e,t,r);return fue(e,t),e};Object.defineProperty(Rm,"__esModule",{value:!0});Rm.Response=void 0;const q0=hue(P);Rm.Response=q0.serialization.record(q0.serialization.string(),q0.serialization.unknown());var pue=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),_ue=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),yue=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&pue(e,t,r);return _ue(e,t),e};Object.defineProperty(Tm,"__esModule",{value:!0});Tm.delete=void 0;Tm.delete=yue(Rm);(function(t){var e=u&&u.__createBinding||(Object.create?function(n,i,a,o){o===void 0&&(o=a);var s=Object.getOwnPropertyDescriptor(i,a);(!s||("get"in s?!i.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return i[a]}}),Object.defineProperty(n,o,s)}:function(n,i,a,o){o===void 0&&(o=a),n[o]=i[a]}),r=u&&u.__exportStar||function(n,i){for(var a in n)a!=="default"&&!Object.prototype.hasOwnProperty.call(i,a)&&e(i,n,a)};Object.defineProperty(t,"__esModule",{value:!0}),r(uj,t),r(Tm,t)})(mL);var vL={},wL={},OL={},lj={},pf={},bue=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),gue=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),mue=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&bue(e,t,r);return gue(e,t),e};Object.defineProperty(pf,"__esModule",{value:!0});pf.BaseType=void 0;const vue=mue(P);pf.BaseType=vue.serialization.enum_(["BASE_TYPE_UNSPECIFIED","BASE_TYPE_GENERATIVE","BASE_TYPE_CLASSIFICATION","BASE_TYPE_RERANK","BASE_TYPE_CHAT"]);var _f={},wue=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Oue=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Sue=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&wue(e,t,r);return Oue(e,t),e};Object.defineProperty(_f,"__esModule",{value:!0});_f.Strategy=void 0;const Eue=Sue(P);_f.Strategy=Eue.serialization.enum_(["STRATEGY_UNSPECIFIED","STRATEGY_VANILLA","STRATEGY_TFEW"]);var yf={},Pue=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),jue=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Cue=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Pue(e,t,r);return jue(e,t),e};Object.defineProperty(yf,"__esModule",{value:!0});yf.BaseModel=void 0;const p_=Cue(P),Mue=pf,Tue=_f;yf.BaseModel=p_.serialization.object({name:p_.serialization.string().optional(),version:p_.serialization.string().optional(),baseType:p_.serialization.property("base_type",Mue.BaseType),strategy:Tue.Strategy.optional()});var bf={},Rue=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Aue=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),$ue=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Rue(e,t,r);return Aue(e,t),e};Object.defineProperty(bf,"__esModule",{value:!0});bf.LoraTargetModules=void 0;const Iue=$ue(P);bf.LoraTargetModules=Iue.serialization.enum_(["LORA_TARGET_MODULES_UNSPECIFIED","LORA_TARGET_MODULES_QV","LORA_TARGET_MODULES_QKVO","LORA_TARGET_MODULES_QKVO_FFN"]);var gf={},xue=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Due=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Nue=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&xue(e,t,r);return Due(e,t),e};Object.defineProperty(gf,"__esModule",{value:!0});gf.Hyperparameters=void 0;const ar=Nue(P),zue=bf;gf.Hyperparameters=ar.serialization.object({earlyStoppingPatience:ar.serialization.property("early_stopping_patience",ar.serialization.number().optional()),earlyStoppingThreshold:ar.serialization.property("early_stopping_threshold",ar.serialization.number().optional()),trainBatchSize:ar.serialization.property("train_batch_size",ar.serialization.number().optional()),trainEpochs:ar.serialization.property("train_epochs",ar.serialization.number().optional()),learningRate:ar.serialization.property("learning_rate",ar.serialization.number().optional()),loraAlpha:ar.serialization.property("lora_alpha",ar.serialization.number().optional()),loraRank:ar.serialization.property("lora_rank",ar.serialization.number().optional()),loraTargetModules:ar.serialization.property("lora_target_modules",zue.LoraTargetModules.optional())});var mf={},Bue=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Uue=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Fue=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Bue(e,t,r);return Uue(e,t),e};Object.defineProperty(mf,"__esModule",{value:!0});mf.WandbConfig=void 0;const xl=Fue(P);mf.WandbConfig=xl.serialization.object({project:xl.serialization.string(),apiKey:xl.serialization.property("api_key",xl.serialization.string()),entity:xl.serialization.string().optional()});var Ku={},Lue=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Vue=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),kue=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Lue(e,t,r);return Vue(e,t),e};Object.defineProperty(Ku,"__esModule",{value:!0});Ku.Settings=void 0;const ss=kue(P),Hue=yf,que=gf,Gue=mf;Ku.Settings=ss.serialization.object({baseModel:ss.serialization.property("base_model",Hue.BaseModel),datasetId:ss.serialization.property("dataset_id",ss.serialization.string()),hyperparameters:que.Hyperparameters.optional(),multiLabel:ss.serialization.property("multi_label",ss.serialization.boolean().optional()),wandb:Gue.WandbConfig.optional()});var Uo={},Wue=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Kue=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Jue=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Wue(e,t,r);return Kue(e,t),e};Object.defineProperty(Uo,"__esModule",{value:!0});Uo.Status=void 0;const Xue=Jue(P);Uo.Status=Xue.serialization.enum_(["STATUS_UNSPECIFIED","STATUS_FINETUNING","STATUS_DEPLOYING_API","STATUS_READY","STATUS_FAILED","STATUS_DELETED","STATUS_TEMPORARILY_OFFLINE","STATUS_PAUSED","STATUS_QUEUED"]);var Na={},Zue=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Yue=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Que=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Zue(e,t,r);return Yue(e,t),e};Object.defineProperty(Na,"__esModule",{value:!0});Na.FinetunedModel=void 0;const yr=Que(P),ele=Ku,tle=Uo;Na.FinetunedModel=yr.serialization.object({id:yr.serialization.string().optional(),name:yr.serialization.string(),creatorId:yr.serialization.property("creator_id",yr.serialization.string().optional()),organizationId:yr.serialization.property("organization_id",yr.serialization.string().optional()),settings:ele.Settings,status:tle.Status.optional(),createdAt:yr.serialization.property("created_at",yr.serialization.date().optional()),updatedAt:yr.serialization.property("updated_at",yr.serialization.date().optional()),completedAt:yr.serialization.property("completed_at",yr.serialization.date().optional()),lastUsed:yr.serialization.property("last_used",yr.serialization.date().optional())});var Am={},rle=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),nle=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),ile=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&rle(e,t,r);return nle(e,t),e};Object.defineProperty(Am,"__esModule",{value:!0});Am.ListFinetunedModelsResponse=void 0;const Ka=ile(P),ale=Na;Am.ListFinetunedModelsResponse=Ka.serialization.object({finetunedModels:Ka.serialization.property("finetuned_models",Ka.serialization.list(ale.FinetunedModel).optional()),nextPageToken:Ka.serialization.property("next_page_token",Ka.serialization.string().optional()),totalSize:Ka.serialization.property("total_size",Ka.serialization.number().optional())});var $m={},ole=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),sle=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),ule=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&ole(e,t,r);return sle(e,t),e};Object.defineProperty($m,"__esModule",{value:!0});$m.CreateFinetunedModelResponse=void 0;const lA=ule(P),lle=Na;$m.CreateFinetunedModelResponse=lA.serialization.object({finetunedModel:lA.serialization.property("finetuned_model",lle.FinetunedModel.optional())});var Im={},cle=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),dle=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),fle=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&cle(e,t,r);return dle(e,t),e};Object.defineProperty(Im,"__esModule",{value:!0});Im.GetFinetunedModelResponse=void 0;const cA=fle(P),hle=Na;Im.GetFinetunedModelResponse=cA.serialization.object({finetunedModel:cA.serialization.property("finetuned_model",hle.FinetunedModel.optional())});var xm={},ple=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),_le=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),yle=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&ple(e,t,r);return _le(e,t),e};Object.defineProperty(xm,"__esModule",{value:!0});xm.DeleteFinetunedModelResponse=void 0;const G0=yle(P);xm.DeleteFinetunedModelResponse=G0.serialization.record(G0.serialization.string(),G0.serialization.unknown());var Dm={},ble=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),gle=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),mle=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&ble(e,t,r);return gle(e,t),e};Object.defineProperty(Dm,"__esModule",{value:!0});Dm.UpdateFinetunedModelResponse=void 0;const dA=mle(P),vle=Na;Dm.UpdateFinetunedModelResponse=dA.serialization.object({finetunedModel:dA.serialization.property("finetuned_model",vle.FinetunedModel.optional())});var vf={},wle=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Ole=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Sle=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&wle(e,t,r);return Ole(e,t),e};Object.defineProperty(vf,"__esModule",{value:!0});vf.Event=void 0;const Dl=Sle(P),Ele=Uo;vf.Event=Dl.serialization.object({userId:Dl.serialization.property("user_id",Dl.serialization.string().optional()),status:Ele.Status.optional(),createdAt:Dl.serialization.property("created_at",Dl.serialization.date().optional())});var Nm={},Ple=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),jle=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Cle=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Ple(e,t,r);return jle(e,t),e};Object.defineProperty(Nm,"__esModule",{value:!0});Nm.ListEventsResponse=void 0;const us=Cle(P),Mle=vf;Nm.ListEventsResponse=us.serialization.object({events:us.serialization.list(Mle.Event).optional(),nextPageToken:us.serialization.property("next_page_token",us.serialization.string().optional()),totalSize:us.serialization.property("total_size",us.serialization.number().optional())});var wf={},Tle=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Rle=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Ale=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Tle(e,t,r);return Rle(e,t),e};Object.defineProperty(wf,"__esModule",{value:!0});wf.TrainingStepMetrics=void 0;const ia=Ale(P);wf.TrainingStepMetrics=ia.serialization.object({createdAt:ia.serialization.property("created_at",ia.serialization.date().optional()),stepNumber:ia.serialization.property("step_number",ia.serialization.number().optional()),metrics:ia.serialization.record(ia.serialization.string(),ia.serialization.number()).optional()});var zm={},$le=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Ile=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),xle=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&$le(e,t,r);return Ile(e,t),e};Object.defineProperty(zm,"__esModule",{value:!0});zm.ListTrainingStepMetricsResponse=void 0;const Nl=xle(P),Dle=wf;zm.ListTrainingStepMetricsResponse=Nl.serialization.object({stepMetrics:Nl.serialization.property("step_metrics",Nl.serialization.list(Dle.TrainingStepMetrics).optional()),nextPageToken:Nl.serialization.property("next_page_token",Nl.serialization.string().optional())});(function(t){var e=u&&u.__createBinding||(Object.create?function(n,i,a,o){o===void 0&&(o=a);var s=Object.getOwnPropertyDescriptor(i,a);(!s||("get"in s?!i.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return i[a]}}),Object.defineProperty(n,o,s)}:function(n,i,a,o){o===void 0&&(o=a),n[o]=i[a]}),r=u&&u.__exportStar||function(n,i){for(var a in n)a!=="default"&&!Object.prototype.hasOwnProperty.call(i,a)&&e(i,n,a)};Object.defineProperty(t,"__esModule",{value:!0}),r(pf,t),r(_f,t),r(yf,t),r(bf,t),r(gf,t),r(mf,t),r(Ku,t),r(Uo,t),r(Na,t),r(Am,t),r($m,t),r(Im,t),r(xm,t),r(Dm,t),r(vf,t),r(Nm,t),r(wf,t),r(zm,t)})(lj);(function(t){var e=u&&u.__createBinding||(Object.create?function(n,i,a,o){o===void 0&&(o=a);var s=Object.getOwnPropertyDescriptor(i,a);(!s||("get"in s?!i.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return i[a]}}),Object.defineProperty(n,o,s)}:function(n,i,a,o){o===void 0&&(o=a),n[o]=i[a]}),r=u&&u.__exportStar||function(n,i){for(var a in n)a!=="default"&&!Object.prototype.hasOwnProperty.call(i,a)&&e(i,n,a)};Object.defineProperty(t,"__esModule",{value:!0}),r(lj,t)})(OL);(function(t){var e=u&&u.__createBinding||(Object.create?function(a,o,s,l){l===void 0&&(l=s);var c=Object.getOwnPropertyDescriptor(o,s);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(a,l,c)}:function(a,o,s,l){l===void 0&&(l=s),a[l]=o[s]}),r=u&&u.__setModuleDefault||(Object.create?function(a,o){Object.defineProperty(a,"default",{enumerable:!0,value:o})}:function(a,o){a.default=o}),n=u&&u.__importStar||function(a){if(a&&a.__esModule)return a;var o={};if(a!=null)for(var s in a)s!=="default"&&Object.prototype.hasOwnProperty.call(a,s)&&e(o,a,s);return r(o,a),o},i=u&&u.__exportStar||function(a,o){for(var s in a)s!=="default"&&!Object.prototype.hasOwnProperty.call(o,s)&&e(o,a,s)};Object.defineProperty(t,"__esModule",{value:!0}),t.finetuning=void 0,t.finetuning=n(OL),i(lj,t)})(wL);var SL={},cj={},Bm={},Nle=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),zle=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Ble=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Nle(e,t,r);return zle(e,t),e};Object.defineProperty(Bm,"__esModule",{value:!0});Bm.FinetuningUpdateFinetunedModelRequest=void 0;const Sr=Ble(P),Ule=Ku,Fle=Uo;Bm.FinetuningUpdateFinetunedModelRequest=Sr.serialization.object({name:Sr.serialization.string(),creatorId:Sr.serialization.property("creator_id",Sr.serialization.string().optional()),organizationId:Sr.serialization.property("organization_id",Sr.serialization.string().optional()),settings:Ule.Settings,status:Fle.Status.optional(),createdAt:Sr.serialization.property("created_at",Sr.serialization.date().optional()),updatedAt:Sr.serialization.property("updated_at",Sr.serialization.date().optional()),completedAt:Sr.serialization.property("completed_at",Sr.serialization.date().optional()),lastUsed:Sr.serialization.property("last_used",Sr.serialization.date().optional())});(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.FinetuningUpdateFinetunedModelRequest=void 0;var e=Bm;Object.defineProperty(t,"FinetuningUpdateFinetunedModelRequest",{enumerable:!0,get:function(){return e.FinetuningUpdateFinetunedModelRequest}})})(cj);(function(t){var e=u&&u.__createBinding||(Object.create?function(n,i,a,o){o===void 0&&(o=a);var s=Object.getOwnPropertyDescriptor(i,a);(!s||("get"in s?!i.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return i[a]}}),Object.defineProperty(n,o,s)}:function(n,i,a,o){o===void 0&&(o=a),n[o]=i[a]}),r=u&&u.__exportStar||function(n,i){for(var a in n)a!=="default"&&!Object.prototype.hasOwnProperty.call(i,a)&&e(i,n,a)};Object.defineProperty(t,"__esModule",{value:!0}),r(cj,t)})(SL);(function(t){var e=u&&u.__createBinding||(Object.create?function(n,i,a,o){o===void 0&&(o=a);var s=Object.getOwnPropertyDescriptor(i,a);(!s||("get"in s?!i.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return i[a]}}),Object.defineProperty(n,o,s)}:function(n,i,a,o){o===void 0&&(o=a),n[o]=i[a]}),r=u&&u.__exportStar||function(n,i){for(var a in n)a!=="default"&&!Object.prototype.hasOwnProperty.call(i,a)&&e(i,n,a)};Object.defineProperty(t,"__esModule",{value:!0}),r(wL,t),r(SL,t)})(vL);var EL={},PL={},dj={},Um={},Ju={},Lle=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Vle=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),kle=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Lle(e,t,r);return Vle(e,t),e};Object.defineProperty(Ju,"__esModule",{value:!0});Ju.CreateConnectorOAuth=void 0;const qn=kle(P);Ju.CreateConnectorOAuth=qn.serialization.object({clientId:qn.serialization.property("client_id",qn.serialization.string().optional()),clientSecret:qn.serialization.property("client_secret",qn.serialization.string().optional()),authorizeUrl:qn.serialization.property("authorize_url",qn.serialization.string().optional()),tokenUrl:qn.serialization.property("token_url",qn.serialization.string().optional()),scope:qn.serialization.string().optional()});var Xu={},Of={},Hle=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),qle=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Gle=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Hle(e,t,r);return qle(e,t),e};Object.defineProperty(Of,"__esModule",{value:!0});Of.AuthTokenType=void 0;const Wle=Gle(P);Of.AuthTokenType=Wle.serialization.enum_(["bearer","basic","noscheme"]);var Kle=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Jle=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Xle=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Kle(e,t,r);return Jle(e,t),e};Object.defineProperty(Xu,"__esModule",{value:!0});Xu.CreateConnectorServiceAuth=void 0;const fA=Xle(P),Zle=Of;Xu.CreateConnectorServiceAuth=fA.serialization.object({type:Zle.AuthTokenType,token:fA.serialization.string()});var Yle=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Qle=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),ece=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Yle(e,t,r);return Qle(e,t),e};Object.defineProperty(Um,"__esModule",{value:!0});Um.CreateConnectorRequest=void 0;const Gn=ece(P),tce=Ju,rce=Xu;Um.CreateConnectorRequest=Gn.serialization.object({name:Gn.serialization.string(),description:Gn.serialization.string().optional(),url:Gn.serialization.string(),excludes:Gn.serialization.list(Gn.serialization.string()).optional(),oauth:tce.CreateConnectorOAuth.optional(),active:Gn.serialization.boolean().optional(),continueOnFailure:Gn.serialization.property("continue_on_failure",Gn.serialization.boolean().optional()),serviceAuth:Gn.serialization.property("service_auth",rce.CreateConnectorServiceAuth.optional())});var Fm={},nce=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),ice=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),ace=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&nce(e,t,r);return ice(e,t),e};Object.defineProperty(Fm,"__esModule",{value:!0});Fm.UpdateConnectorRequest=void 0;const mi=ace(P),oce=Ju,sce=Xu;Fm.UpdateConnectorRequest=mi.serialization.object({name:mi.serialization.string().optional(),url:mi.serialization.string().optional(),excludes:mi.serialization.list(mi.serialization.string()).optional(),oauth:oce.CreateConnectorOAuth.optional(),active:mi.serialization.boolean().optional(),continueOnFailure:mi.serialization.property("continue_on_failure",mi.serialization.boolean().optional()),serviceAuth:mi.serialization.property("service_auth",sce.CreateConnectorServiceAuth.optional())});(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.UpdateConnectorRequest=t.CreateConnectorRequest=void 0;var e=Um;Object.defineProperty(t,"CreateConnectorRequest",{enumerable:!0,get:function(){return e.CreateConnectorRequest}});var r=Fm;Object.defineProperty(t,"UpdateConnectorRequest",{enumerable:!0,get:function(){return r.UpdateConnectorRequest}})})(dj);(function(t){var e=u&&u.__createBinding||(Object.create?function(n,i,a,o){o===void 0&&(o=a);var s=Object.getOwnPropertyDescriptor(i,a);(!s||("get"in s?!i.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return i[a]}}),Object.defineProperty(n,o,s)}:function(n,i,a,o){o===void 0&&(o=a),n[o]=i[a]}),r=u&&u.__exportStar||function(n,i){for(var a in n)a!=="default"&&!Object.prototype.hasOwnProperty.call(i,a)&&e(i,n,a)};Object.defineProperty(t,"__esModule",{value:!0}),r(dj,t)})(PL);(function(t){var e=u&&u.__createBinding||(Object.create?function(n,i,a,o){o===void 0&&(o=a);var s=Object.getOwnPropertyDescriptor(i,a);(!s||("get"in s?!i.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return i[a]}}),Object.defineProperty(n,o,s)}:function(n,i,a,o){o===void 0&&(o=a),n[o]=i[a]}),r=u&&u.__exportStar||function(n,i){for(var a in n)a!=="default"&&!Object.prototype.hasOwnProperty.call(i,a)&&e(i,n,a)};Object.defineProperty(t,"__esModule",{value:!0}),r(PL,t)})(EL);(function(t){var e=u&&u.__createBinding||(Object.create?function(a,o,s,l){l===void 0&&(l=s);var c=Object.getOwnPropertyDescriptor(o,s);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(a,l,c)}:function(a,o,s,l){l===void 0&&(l=s),a[l]=o[s]}),r=u&&u.__setModuleDefault||(Object.create?function(a,o){Object.defineProperty(a,"default",{enumerable:!0,value:o})}:function(a,o){a.default=o}),n=u&&u.__importStar||function(a){if(a&&a.__esModule)return a;var o={};if(a!=null)for(var s in a)s!=="default"&&Object.prototype.hasOwnProperty.call(a,s)&&e(o,a,s);return r(o,a),o},i=u&&u.__exportStar||function(a,o){for(var s in a)s!=="default"&&!Object.prototype.hasOwnProperty.call(o,s)&&e(o,a,s)};Object.defineProperty(t,"__esModule",{value:!0}),t.connectors=t.finetuning=t.datasets=t.embedJobs=t.v2=void 0,t.v2=n(_L),i(ij,t),t.embedJobs=n(bL),i(oj,t),t.datasets=n(mL),i(uj,t),t.finetuning=n(vL),i(aj,t),i(sj,t),t.connectors=n(EL),i(dj,t),i(cj,t)})(pL);var jL={},Sf={},uce=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),lce=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),cce=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&uce(e,t,r);return lce(e,t),e};Object.defineProperty(Sf,"__esModule",{value:!0});Sf.ChatStreamRequestPromptTruncation=void 0;const dce=cce(P);Sf.ChatStreamRequestPromptTruncation=dce.serialization.enum_(["OFF","AUTO","AUTO_PRESERVE_ORDER"]);var Ef={},fce=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),hce=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),pce=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&fce(e,t,r);return hce(e,t),e};Object.defineProperty(Ef,"__esModule",{value:!0});Ef.ChatStreamRequestCitationQuality=void 0;const _ce=pce(P);Ef.ChatStreamRequestCitationQuality=_ce.serialization.enum_(["fast","accurate","off"]);var Lm={},yce=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),bce=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),gce=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&yce(e,t,r);return bce(e,t),e};Object.defineProperty(Lm,"__esModule",{value:!0});Lm.ChatStreamRequestConnectorsSearchOptions=void 0;const hA=gce(P);Lm.ChatStreamRequestConnectorsSearchOptions=hA.serialization.object({seed:hA.serialization.number().optional()});var Pf={},mce=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),vce=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),wce=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&mce(e,t,r);return vce(e,t),e};Object.defineProperty(Pf,"__esModule",{value:!0});Pf.ChatStreamRequestSafetyMode=void 0;const Oce=wce(P);Pf.ChatStreamRequestSafetyMode=Oce.serialization.enum_(["CONTEXTUAL","STRICT","NONE"]);var jf={},Sce=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Ece=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Pce=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Sce(e,t,r);return Ece(e,t),e};Object.defineProperty(jf,"__esModule",{value:!0});jf.ChatRequestPromptTruncation=void 0;const jce=Pce(P);jf.ChatRequestPromptTruncation=jce.serialization.enum_(["OFF","AUTO","AUTO_PRESERVE_ORDER"]);var Cf={},Cce=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Mce=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Tce=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Cce(e,t,r);return Mce(e,t),e};Object.defineProperty(Cf,"__esModule",{value:!0});Cf.ChatRequestCitationQuality=void 0;const Rce=Tce(P);Cf.ChatRequestCitationQuality=Rce.serialization.enum_(["fast","accurate","off"]);var Vm={},Ace=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),$ce=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Ice=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Ace(e,t,r);return $ce(e,t),e};Object.defineProperty(Vm,"__esModule",{value:!0});Vm.ChatRequestConnectorsSearchOptions=void 0;const pA=Ice(P);Vm.ChatRequestConnectorsSearchOptions=pA.serialization.object({seed:pA.serialization.number().optional()});var Mf={},xce=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Dce=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Nce=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&xce(e,t,r);return Dce(e,t),e};Object.defineProperty(Mf,"__esModule",{value:!0});Mf.ChatRequestSafetyMode=void 0;const zce=Nce(P);Mf.ChatRequestSafetyMode=zce.serialization.enum_(["CONTEXTUAL","STRICT","NONE"]);var Tf={},Bce=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Uce=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Fce=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Bce(e,t,r);return Uce(e,t),e};Object.defineProperty(Tf,"__esModule",{value:!0});Tf.GenerateStreamRequestTruncate=void 0;const Lce=Fce(P);Tf.GenerateStreamRequestTruncate=Lce.serialization.enum_(["NONE","START","END"]);var Rf={},Vce=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),kce=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Hce=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Vce(e,t,r);return kce(e,t),e};Object.defineProperty(Rf,"__esModule",{value:!0});Rf.GenerateStreamRequestReturnLikelihoods=void 0;const qce=Hce(P);Rf.GenerateStreamRequestReturnLikelihoods=qce.serialization.enum_(["GENERATION","ALL","NONE"]);var Af={},Gce=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Wce=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Kce=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Gce(e,t,r);return Wce(e,t),e};Object.defineProperty(Af,"__esModule",{value:!0});Af.GenerateRequestTruncate=void 0;const Jce=Kce(P);Af.GenerateRequestTruncate=Jce.serialization.enum_(["NONE","START","END"]);var $f={},Xce=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Zce=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Yce=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Xce(e,t,r);return Zce(e,t),e};Object.defineProperty($f,"__esModule",{value:!0});$f.GenerateRequestReturnLikelihoods=void 0;const Qce=Yce(P);$f.GenerateRequestReturnLikelihoods=Qce.serialization.enum_(["GENERATION","ALL","NONE"]);var If={},ede=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),tde=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),rde=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&ede(e,t,r);return tde(e,t),e};Object.defineProperty(If,"__esModule",{value:!0});If.EmbedRequestTruncate=void 0;const nde=rde(P);If.EmbedRequestTruncate=nde.serialization.enum_(["NONE","START","END"]);var km={},xf={},Zu={},ide=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),ade=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),ode=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&ide(e,t,r);return ade(e,t),e};Object.defineProperty(Zu,"__esModule",{value:!0});Zu.Image=void 0;const ls=ode(P);Zu.Image=ls.serialization.object({width:ls.serialization.number(),height:ls.serialization.number(),format:ls.serialization.string(),bitDepth:ls.serialization.property("bit_depth",ls.serialization.number())});var sde=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),ude=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),lde=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&sde(e,t,r);return ude(e,t),e};Object.defineProperty(xf,"__esModule",{value:!0});xf.EmbedFloatsResponse=void 0;const aa=lde(P),cde=Zu,dde=hr;xf.EmbedFloatsResponse=aa.serialization.object({id:aa.serialization.string(),embeddings:aa.serialization.list(aa.serialization.list(aa.serialization.number())),texts:aa.serialization.list(aa.serialization.string()),images:aa.serialization.list(cde.Image).optional(),meta:dde.ApiMeta.optional()});var Df={},Nf={},fde=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),hde=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),pde=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&fde(e,t,r);return hde(e,t),e};Object.defineProperty(Nf,"__esModule",{value:!0});Nf.EmbedByTypeResponseEmbeddings=void 0;const or=pde(P);Nf.EmbedByTypeResponseEmbeddings=or.serialization.object({float:or.serialization.list(or.serialization.list(or.serialization.number())).optional(),int8:or.serialization.list(or.serialization.list(or.serialization.number())).optional(),uint8:or.serialization.list(or.serialization.list(or.serialization.number())).optional(),binary:or.serialization.list(or.serialization.list(or.serialization.number())).optional(),ubinary:or.serialization.list(or.serialization.list(or.serialization.number())).optional()});var _de=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),yde=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),bde=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&_de(e,t,r);return yde(e,t),e};Object.defineProperty(Df,"__esModule",{value:!0});Df.EmbedByTypeResponse=void 0;const zl=bde(P),gde=Nf,mde=Zu,vde=hr;Df.EmbedByTypeResponse=zl.serialization.object({id:zl.serialization.string(),embeddings:gde.EmbedByTypeResponseEmbeddings,texts:zl.serialization.list(zl.serialization.string()),images:zl.serialization.list(mde.Image).optional(),meta:vde.ApiMeta.optional()});var wde=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Ode=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Sde=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&wde(e,t,r);return Ode(e,t),e};Object.defineProperty(km,"__esModule",{value:!0});km.EmbedResponse=void 0;const _A=Sde(P),Ede=xf,Pde=Df;km.EmbedResponse=_A.serialization.union(_A.serialization.discriminant("responseType","response_type"),{embeddings_floats:Ede.EmbedFloatsResponse,embeddings_by_type:Pde.EmbedByTypeResponse}).transform({transform:t=>t,untransform:t=>t});var zf={},Bf={},jde=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Cde=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Mde=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&jde(e,t,r);return Cde(e,t),e};Object.defineProperty(Bf,"__esModule",{value:!0});Bf.RerankDocument=void 0;const W0=Mde(P);Bf.RerankDocument=W0.serialization.record(W0.serialization.string(),W0.serialization.string());var Tde=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Rde=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Ade=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Tde(e,t,r);return Rde(e,t),e};Object.defineProperty(zf,"__esModule",{value:!0});zf.RerankRequestDocumentsItem=void 0;const yA=Ade(P),$de=Bf;zf.RerankRequestDocumentsItem=yA.serialization.undiscriminatedUnion([yA.serialization.string(),$de.RerankDocument]);var Uf={},Ide=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),xde=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Dde=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Ide(e,t,r);return xde(e,t),e};Object.defineProperty(Uf,"__esModule",{value:!0});Uf.RerankResponseResultsItemDocument=void 0;const bA=Dde(P);Uf.RerankResponseResultsItemDocument=bA.serialization.object({text:bA.serialization.string()});var Ff={},Nde=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),zde=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Bde=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Nde(e,t,r);return zde(e,t),e};Object.defineProperty(Ff,"__esModule",{value:!0});Ff.RerankResponseResultsItem=void 0;const __=Bde(P),Ude=Uf;Ff.RerankResponseResultsItem=__.serialization.object({document:Ude.RerankResponseResultsItemDocument.optional(),index:__.serialization.number(),relevanceScore:__.serialization.property("relevance_score",__.serialization.number())});var Hm={},Fde=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Lde=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Vde=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Fde(e,t,r);return Lde(e,t),e};Object.defineProperty(Hm,"__esModule",{value:!0});Hm.RerankResponse=void 0;const K0=Vde(P),kde=Ff,Hde=hr;Hm.RerankResponse=K0.serialization.object({id:K0.serialization.string().optional(),results:K0.serialization.list(kde.RerankResponseResultsItem),meta:Hde.ApiMeta.optional()});var Lf={},qde=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Gde=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Wde=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&qde(e,t,r);return Gde(e,t),e};Object.defineProperty(Lf,"__esModule",{value:!0});Lf.ClassifyRequestTruncate=void 0;const Kde=Wde(P);Lf.ClassifyRequestTruncate=Kde.serialization.enum_(["NONE","START","END"]);var Vf={},Jde=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Xde=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Zde=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Jde(e,t,r);return Xde(e,t),e};Object.defineProperty(Vf,"__esModule",{value:!0});Vf.ClassifyResponseClassificationsItemLabelsValue=void 0;const gA=Zde(P);Vf.ClassifyResponseClassificationsItemLabelsValue=gA.serialization.object({confidence:gA.serialization.number().optional()});var kf={},Yde=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Qde=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),efe=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Yde(e,t,r);return Qde(e,t),e};Object.defineProperty(kf,"__esModule",{value:!0});kf.ClassifyResponseClassificationsItemClassificationType=void 0;const tfe=efe(P);kf.ClassifyResponseClassificationsItemClassificationType=tfe.serialization.enum_(["single-label","multi-label"]);var Hf={},rfe=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),nfe=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),ife=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&rfe(e,t,r);return nfe(e,t),e};Object.defineProperty(Hf,"__esModule",{value:!0});Hf.ClassifyResponseClassificationsItem=void 0;const rn=ife(P),afe=Vf,ofe=kf;Hf.ClassifyResponseClassificationsItem=rn.serialization.object({id:rn.serialization.string(),input:rn.serialization.string().optional(),prediction:rn.serialization.string().optional(),predictions:rn.serialization.list(rn.serialization.string()),confidence:rn.serialization.number().optional(),confidences:rn.serialization.list(rn.serialization.number()),labels:rn.serialization.record(rn.serialization.string(),afe.ClassifyResponseClassificationsItemLabelsValue),classificationType:rn.serialization.property("classification_type",ofe.ClassifyResponseClassificationsItemClassificationType)});var qm={},sfe=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),ufe=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),lfe=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&sfe(e,t,r);return ufe(e,t),e};Object.defineProperty(qm,"__esModule",{value:!0});qm.ClassifyResponse=void 0;const J0=lfe(P),cfe=Hf,dfe=hr;qm.ClassifyResponse=J0.serialization.object({id:J0.serialization.string(),classifications:J0.serialization.list(cfe.ClassifyResponseClassificationsItem),meta:dfe.ApiMeta.optional()});var qf={},ffe=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),hfe=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),pfe=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&ffe(e,t,r);return hfe(e,t),e};Object.defineProperty(qf,"__esModule",{value:!0});qf.SummarizeRequestLength=void 0;const _fe=pfe(P);qf.SummarizeRequestLength=_fe.serialization.enum_(["short","medium","long"]);var Gf={},yfe=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),bfe=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),gfe=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&yfe(e,t,r);return bfe(e,t),e};Object.defineProperty(Gf,"__esModule",{value:!0});Gf.SummarizeRequestFormat=void 0;const mfe=gfe(P);Gf.SummarizeRequestFormat=mfe.serialization.enum_(["paragraph","bullets"]);var Wf={},vfe=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),wfe=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Ofe=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&vfe(e,t,r);return wfe(e,t),e};Object.defineProperty(Wf,"__esModule",{value:!0});Wf.SummarizeRequestExtractiveness=void 0;const Sfe=Ofe(P);Wf.SummarizeRequestExtractiveness=Sfe.serialization.enum_(["low","medium","high"]);var Gm={},Efe=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Pfe=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),jfe=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Efe(e,t,r);return Pfe(e,t),e};Object.defineProperty(Gm,"__esModule",{value:!0});Gm.SummarizeResponse=void 0;const X0=jfe(P),Cfe=hr;Gm.SummarizeResponse=X0.serialization.object({id:X0.serialization.string().optional(),summary:X0.serialization.string().optional(),meta:Cfe.ApiMeta.optional()});var Wm={},Mfe=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Tfe=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Rfe=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Mfe(e,t,r);return Tfe(e,t),e};Object.defineProperty(Wm,"__esModule",{value:!0});Wm.TokenizeResponse=void 0;const cs=Rfe(P),Afe=hr;Wm.TokenizeResponse=cs.serialization.object({tokens:cs.serialization.list(cs.serialization.number()),tokenStrings:cs.serialization.property("token_strings",cs.serialization.list(cs.serialization.string())),meta:Afe.ApiMeta.optional()});var Km={},$fe=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Ife=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),xfe=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&$fe(e,t,r);return Ife(e,t),e};Object.defineProperty(Km,"__esModule",{value:!0});Km.DetokenizeResponse=void 0;const mA=xfe(P),Dfe=hr;Km.DetokenizeResponse=mA.serialization.object({text:mA.serialization.string(),meta:Dfe.ApiMeta.optional()});var Jm={},Nfe=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),zfe=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Bfe=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Nfe(e,t,r);return zfe(e,t),e};Object.defineProperty(Jm,"__esModule",{value:!0});Jm.CheckApiKeyResponse=void 0;const ds=Bfe(P);Jm.CheckApiKeyResponse=ds.serialization.object({valid:ds.serialization.boolean(),organizationId:ds.serialization.property("organization_id",ds.serialization.string().optional()),ownerId:ds.serialization.property("owner_id",ds.serialization.string().optional())});var za={},Ufe=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Ffe=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Lfe=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Ufe(e,t,r);return Ffe(e,t),e};Object.defineProperty(za,"__esModule",{value:!0});za.ToolCall=void 0;const Bl=Lfe(P);za.ToolCall=Bl.serialization.object({name:Bl.serialization.string(),parameters:Bl.serialization.record(Bl.serialization.string(),Bl.serialization.unknown())});var Kf={},Vfe=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),kfe=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Hfe=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Vfe(e,t,r);return kfe(e,t),e};Object.defineProperty(Kf,"__esModule",{value:!0});Kf.ChatMessage=void 0;const y_=Hfe(P),qfe=za;Kf.ChatMessage=y_.serialization.object({message:y_.serialization.string(),toolCalls:y_.serialization.property("tool_calls",y_.serialization.list(qfe.ToolCall).optional())});var Fo={},Gfe=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Wfe=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Kfe=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Gfe(e,t,r);return Wfe(e,t),e};Object.defineProperty(Fo,"__esModule",{value:!0});Fo.ToolResult=void 0;const Ul=Kfe(P),Jfe=za;Fo.ToolResult=Ul.serialization.object({call:Jfe.ToolCall,outputs:Ul.serialization.list(Ul.serialization.record(Ul.serialization.string(),Ul.serialization.unknown()))});var Jf={},Xfe=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Zfe=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Yfe=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Xfe(e,t,r);return Zfe(e,t),e};Object.defineProperty(Jf,"__esModule",{value:!0});Jf.ToolMessage=void 0;const Z0=Yfe(P),Qfe=Fo;Jf.ToolMessage=Z0.serialization.object({toolResults:Z0.serialization.property("tool_results",Z0.serialization.list(Qfe.ToolResult).optional())});var Lo={},ehe=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),the=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),rhe=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&ehe(e,t,r);return the(e,t),e};Object.defineProperty(Lo,"__esModule",{value:!0});Lo.Message=void 0;const nhe=rhe(P),Y0=Kf,ihe=Jf;Lo.Message=nhe.serialization.union("role",{CHATBOT:Y0.ChatMessage,SYSTEM:Y0.ChatMessage,USER:Y0.ChatMessage,TOOL:ihe.ToolMessage}).transform({transform:t=>t,untransform:t=>t});var Yu={},ahe=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),ohe=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),she=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&ahe(e,t,r);return ohe(e,t),e};Object.defineProperty(Yu,"__esModule",{value:!0});Yu.ChatConnector=void 0;const vi=she(P);Yu.ChatConnector=vi.serialization.object({id:vi.serialization.string(),userAccessToken:vi.serialization.property("user_access_token",vi.serialization.string().optional()),continueOnFailure:vi.serialization.property("continue_on_failure",vi.serialization.boolean().optional()),options:vi.serialization.record(vi.serialization.string(),vi.serialization.unknown()).optional()});var Ba={},uhe=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),lhe=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),che=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&uhe(e,t,r);return lhe(e,t),e};Object.defineProperty(Ba,"__esModule",{value:!0});Ba.ChatDocument=void 0;const Q0=che(P);Ba.ChatDocument=Q0.serialization.record(Q0.serialization.string(),Q0.serialization.string());var Xf={},dhe=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),fhe=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),hhe=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&dhe(e,t,r);return fhe(e,t),e};Object.defineProperty(Xf,"__esModule",{value:!0});Xf.ToolParameterDefinitionsValue=void 0;const b_=hhe(P);Xf.ToolParameterDefinitionsValue=b_.serialization.object({description:b_.serialization.string().optional(),type:b_.serialization.string(),required:b_.serialization.boolean().optional()});var Qu={},phe=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),_he=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),yhe=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&phe(e,t,r);return _he(e,t),e};Object.defineProperty(Qu,"__esModule",{value:!0});Qu.Tool=void 0;const fs=yhe(P),bhe=Xf;Qu.Tool=fs.serialization.object({name:fs.serialization.string(),description:fs.serialization.string(),parameterDefinitions:fs.serialization.property("parameter_definitions",fs.serialization.record(fs.serialization.string(),bhe.ToolParameterDefinitionsValue).optional())});var Zf={},ghe=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),mhe=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),vhe=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&ghe(e,t,r);return mhe(e,t),e};Object.defineProperty(Zf,"__esModule",{value:!0});Zf.TextResponseFormat=void 0;const whe=vhe(P);Zf.TextResponseFormat=whe.serialization.object({});var Yf={},Ohe=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),She=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Ehe=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Ohe(e,t,r);return She(e,t),e};Object.defineProperty(Yf,"__esModule",{value:!0});Yf.JsonResponseFormat=void 0;const g_=Ehe(P);Yf.JsonResponseFormat=g_.serialization.object({schema:g_.serialization.record(g_.serialization.string(),g_.serialization.unknown()).optional()});var el={},Phe=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),jhe=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Che=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Phe(e,t,r);return jhe(e,t),e};Object.defineProperty(el,"__esModule",{value:!0});el.ResponseFormat=void 0;const Mhe=Che(P),The=Zf,Rhe=Yf;el.ResponseFormat=Mhe.serialization.union("type",{text:The.TextResponseFormat,json_object:Rhe.JsonResponseFormat}).transform({transform:t=>t,untransform:t=>t});var Qf={},Ahe=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),$he=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Ihe=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Ahe(e,t,r);return $he(e,t),e};Object.defineProperty(Qf,"__esModule",{value:!0});Qf.ChatCitationType=void 0;const xhe=Ihe(P);Qf.ChatCitationType=xhe.serialization.enum_(["TEXT_CONTENT","PLAN"]);var tl={},Dhe=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Nhe=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),zhe=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Dhe(e,t,r);return Nhe(e,t),e};Object.defineProperty(tl,"__esModule",{value:!0});tl.ChatCitation=void 0;const Ja=zhe(P),Bhe=Qf;tl.ChatCitation=Ja.serialization.object({start:Ja.serialization.number(),end:Ja.serialization.number(),text:Ja.serialization.string(),documentIds:Ja.serialization.property("document_ids",Ja.serialization.list(Ja.serialization.string())),type:Bhe.ChatCitationType.optional()});var Vo={},Uhe=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Fhe=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Lhe=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Uhe(e,t,r);return Fhe(e,t),e};Object.defineProperty(Vo,"__esModule",{value:!0});Vo.ChatSearchQuery=void 0;const m_=Lhe(P);Vo.ChatSearchQuery=m_.serialization.object({text:m_.serialization.string(),generationId:m_.serialization.property("generation_id",m_.serialization.string())});var eh={},Vhe=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),khe=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Hhe=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Vhe(e,t,r);return khe(e,t),e};Object.defineProperty(eh,"__esModule",{value:!0});eh.ChatSearchResultConnector=void 0;const vA=Hhe(P);eh.ChatSearchResultConnector=vA.serialization.object({id:vA.serialization.string()});var rl={},qhe=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Ghe=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Whe=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&qhe(e,t,r);return Ghe(e,t),e};Object.defineProperty(rl,"__esModule",{value:!0});rl.ChatSearchResult=void 0;const wi=Whe(P),Khe=Vo,Jhe=eh;rl.ChatSearchResult=wi.serialization.object({searchQuery:wi.serialization.property("search_query",Khe.ChatSearchQuery.optional()),connector:Jhe.ChatSearchResultConnector,documentIds:wi.serialization.property("document_ids",wi.serialization.list(wi.serialization.string())),errorMessage:wi.serialization.property("error_message",wi.serialization.string().optional()),continueOnFailure:wi.serialization.property("continue_on_failure",wi.serialization.boolean().optional())});var Ua={},Xhe=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Zhe=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Yhe=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Xhe(e,t,r);return Zhe(e,t),e};Object.defineProperty(Ua,"__esModule",{value:!0});Ua.FinishReason=void 0;const Qhe=Yhe(P);Ua.FinishReason=Qhe.serialization.enum_(["COMPLETE","STOP_SEQUENCE","ERROR","ERROR_TOXIC","ERROR_LIMIT","USER_CANCEL","MAX_TOKENS"]);var th={},epe=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),tpe=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),rpe=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&epe(e,t,r);return tpe(e,t),e};Object.defineProperty(th,"__esModule",{value:!0});th.NonStreamedChatResponse=void 0;const xt=rpe(P),npe=tl,ipe=Ba,ape=Vo,ope=rl,spe=Ua,upe=za,lpe=Lo,cpe=hr;th.NonStreamedChatResponse=xt.serialization.object({text:xt.serialization.string(),generationId:xt.serialization.property("generation_id",xt.serialization.string().optional()),responseId:xt.serialization.property("response_id",xt.serialization.string().optional()),citations:xt.serialization.list(npe.ChatCitation).optional(),documents:xt.serialization.list(ipe.ChatDocument).optional(),isSearchRequired:xt.serialization.property("is_search_required",xt.serialization.boolean().optional()),searchQueries:xt.serialization.property("search_queries",xt.serialization.list(ape.ChatSearchQuery).optional()),searchResults:xt.serialization.property("search_results",xt.serialization.list(ope.ChatSearchResult).optional()),finishReason:xt.serialization.property("finish_reason",spe.FinishReason.optional()),toolCalls:xt.serialization.property("tool_calls",xt.serialization.list(upe.ToolCall).optional()),chatHistory:xt.serialization.property("chat_history",xt.serialization.list(lpe.Message).optional()),prompt:xt.serialization.string().optional(),meta:cpe.ApiMeta.optional()});var Zr={},dpe=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),fpe=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),hpe=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&dpe(e,t,r);return fpe(e,t),e};Object.defineProperty(Zr,"__esModule",{value:!0});Zr.ChatStreamEvent=void 0;const ppe=hpe(P);Zr.ChatStreamEvent=ppe.serialization.object({});var rh={},_pe=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),ype=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),bpe=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&_pe(e,t,r);return ype(e,t),e};Object.defineProperty(rh,"__esModule",{value:!0});rh.ChatStreamStartEvent=void 0;const eO=bpe(P),gpe=Zr;rh.ChatStreamStartEvent=eO.serialization.object({generationId:eO.serialization.property("generation_id",eO.serialization.string())}).extend(gpe.ChatStreamEvent);var nh={},mpe=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),vpe=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),wpe=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&mpe(e,t,r);return vpe(e,t),e};Object.defineProperty(nh,"__esModule",{value:!0});nh.ChatSearchQueriesGenerationEvent=void 0;const tO=wpe(P),Ope=Vo,Spe=Zr;nh.ChatSearchQueriesGenerationEvent=tO.serialization.object({searchQueries:tO.serialization.property("search_queries",tO.serialization.list(Ope.ChatSearchQuery))}).extend(Spe.ChatStreamEvent);var ih={},Epe=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Ppe=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),jpe=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Epe(e,t,r);return Ppe(e,t),e};Object.defineProperty(ih,"__esModule",{value:!0});ih.ChatSearchResultsEvent=void 0;const v_=jpe(P),Cpe=rl,Mpe=Ba,Tpe=Zr;ih.ChatSearchResultsEvent=v_.serialization.object({searchResults:v_.serialization.property("search_results",v_.serialization.list(Cpe.ChatSearchResult).optional()),documents:v_.serialization.list(Mpe.ChatDocument).optional()}).extend(Tpe.ChatStreamEvent);var ah={},Rpe=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Ape=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),$pe=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Rpe(e,t,r);return Ape(e,t),e};Object.defineProperty(ah,"__esModule",{value:!0});ah.ChatTextGenerationEvent=void 0;const wA=$pe(P),Ipe=Zr;ah.ChatTextGenerationEvent=wA.serialization.object({text:wA.serialization.string()}).extend(Ipe.ChatStreamEvent);var oh={},xpe=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Dpe=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Npe=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&xpe(e,t,r);return Dpe(e,t),e};Object.defineProperty(oh,"__esModule",{value:!0});oh.ChatCitationGenerationEvent=void 0;const OA=Npe(P),zpe=tl,Bpe=Zr;oh.ChatCitationGenerationEvent=OA.serialization.object({citations:OA.serialization.list(zpe.ChatCitation)}).extend(Bpe.ChatStreamEvent);var sh={},Upe=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Fpe=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Lpe=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Upe(e,t,r);return Fpe(e,t),e};Object.defineProperty(sh,"__esModule",{value:!0});sh.ChatToolCallsGenerationEvent=void 0;const w_=Lpe(P),Vpe=za,kpe=Zr;sh.ChatToolCallsGenerationEvent=w_.serialization.object({text:w_.serialization.string().optional(),toolCalls:w_.serialization.property("tool_calls",w_.serialization.list(Vpe.ToolCall))}).extend(kpe.ChatStreamEvent);var uh={},Hpe=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),qpe=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Gpe=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Hpe(e,t,r);return qpe(e,t),e};Object.defineProperty(uh,"__esModule",{value:!0});uh.ChatStreamEndEventFinishReason=void 0;const Wpe=Gpe(P);uh.ChatStreamEndEventFinishReason=Wpe.serialization.enum_(["COMPLETE","ERROR_LIMIT","MAX_TOKENS","ERROR","ERROR_TOXIC"]);var lh={},Kpe=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Jpe=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Xpe=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Kpe(e,t,r);return Jpe(e,t),e};Object.defineProperty(lh,"__esModule",{value:!0});lh.ChatStreamEndEvent=void 0;const SA=Xpe(P),Zpe=uh,Ype=th,Qpe=Zr;lh.ChatStreamEndEvent=SA.serialization.object({finishReason:SA.serialization.property("finish_reason",Zpe.ChatStreamEndEventFinishReason),response:Ype.NonStreamedChatResponse}).extend(Qpe.ChatStreamEvent);var ch={},e_e=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),t_e=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),r_e=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&e_e(e,t,r);return t_e(e,t),e};Object.defineProperty(ch,"__esModule",{value:!0});ch.ToolCallDelta=void 0;const Fl=r_e(P);ch.ToolCallDelta=Fl.serialization.object({name:Fl.serialization.string().optional(),index:Fl.serialization.number().optional(),parameters:Fl.serialization.string().optional(),text:Fl.serialization.string().optional()});var dh={},n_e=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),i_e=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),a_e=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&n_e(e,t,r);return i_e(e,t),e};Object.defineProperty(dh,"__esModule",{value:!0});dh.ChatToolCallsChunkEvent=void 0;const rO=a_e(P),o_e=ch,s_e=Zr;dh.ChatToolCallsChunkEvent=rO.serialization.object({toolCallDelta:rO.serialization.property("tool_call_delta",o_e.ToolCallDelta),text:rO.serialization.string().optional()}).extend(s_e.ChatStreamEvent);var nl={},u_e=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),l_e=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),c_e=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&u_e(e,t,r);return l_e(e,t),e};Object.defineProperty(nl,"__esModule",{value:!0});nl.ChatDebugEvent=void 0;const EA=c_e(P),d_e=Zr;nl.ChatDebugEvent=EA.serialization.object({prompt:EA.serialization.string().optional()}).extend(d_e.ChatStreamEvent);var Xm={},f_e=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),h_e=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),p_e=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&f_e(e,t,r);return h_e(e,t),e};Object.defineProperty(Xm,"__esModule",{value:!0});Xm.StreamedChatResponse=void 0;const PA=p_e(P),__e=rh,y_e=nh,b_e=ih,g_e=ah,m_e=oh,v_e=sh,w_e=lh,O_e=dh,S_e=nl;Xm.StreamedChatResponse=PA.serialization.union(PA.serialization.discriminant("eventType","event_type"),{"stream-start":__e.ChatStreamStartEvent,"search-queries-generation":y_e.ChatSearchQueriesGenerationEvent,"search-results":b_e.ChatSearchResultsEvent,"text-generation":g_e.ChatTextGenerationEvent,"citation-generation":m_e.ChatCitationGenerationEvent,"tool-calls-generation":v_e.ChatToolCallsGenerationEvent,"stream-end":w_e.ChatStreamEndEvent,"tool-calls-chunk":O_e.ChatToolCallsChunkEvent,debug:S_e.ChatDebugEvent}).transform({transform:t=>t,untransform:t=>t});var il={},E_e=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),P_e=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),j_e=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&E_e(e,t,r);return P_e(e,t),e};Object.defineProperty(il,"__esModule",{value:!0});il.ChatFinishReason=void 0;const C_e=j_e(P);il.ChatFinishReason=C_e.serialization.enum_(["COMPLETE","STOP_SEQUENCE","MAX_TOKENS","TOOL_CALL","ERROR"]);var fh={},M_e=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),T_e=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),R_e=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&M_e(e,t,r);return T_e(e,t),e};Object.defineProperty(fh,"__esModule",{value:!0});fh.AssistantMessageResponseContentItem=void 0;const A_e=R_e(P),$_e=Wi;fh.AssistantMessageResponseContentItem=A_e.serialization.union("type",{text:$_e.TextContent}).transform({transform:t=>t,untransform:t=>t});var hh={},I_e=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),x_e=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),D_e=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&I_e(e,t,r);return x_e(e,t),e};Object.defineProperty(hh,"__esModule",{value:!0});hh.AssistantMessageResponse=void 0;const oa=D_e(P),N_e=Do,z_e=fh,B_e=No;hh.AssistantMessageResponse=oa.serialization.object({role:oa.serialization.stringLiteral("assistant"),toolCalls:oa.serialization.property("tool_calls",oa.serialization.list(N_e.ToolCallV2).optional()),toolPlan:oa.serialization.property("tool_plan",oa.serialization.string().optional()),content:oa.serialization.list(z_e.AssistantMessageResponseContentItem).optional(),citations:oa.serialization.list(B_e.Citation).optional()});var ph={},U_e=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),F_e=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),L_e=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&U_e(e,t,r);return F_e(e,t),e};Object.defineProperty(ph,"__esModule",{value:!0});ph.UsageBilledUnits=void 0;const sa=L_e(P);ph.UsageBilledUnits=sa.serialization.object({inputTokens:sa.serialization.property("input_tokens",sa.serialization.number().optional()),outputTokens:sa.serialization.property("output_tokens",sa.serialization.number().optional()),searchUnits:sa.serialization.property("search_units",sa.serialization.number().optional()),classifications:sa.serialization.number().optional()});var _h={},V_e=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),k_e=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),H_e=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&V_e(e,t,r);return k_e(e,t),e};Object.defineProperty(_h,"__esModule",{value:!0});_h.UsageTokens=void 0;const Ll=H_e(P);_h.UsageTokens=Ll.serialization.object({inputTokens:Ll.serialization.property("input_tokens",Ll.serialization.number().optional()),outputTokens:Ll.serialization.property("output_tokens",Ll.serialization.number().optional())});var al={},q_e=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),G_e=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),W_e=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&q_e(e,t,r);return G_e(e,t),e};Object.defineProperty(al,"__esModule",{value:!0});al.Usage=void 0;const jA=W_e(P),K_e=ph,J_e=_h;al.Usage=jA.serialization.object({billedUnits:jA.serialization.property("billed_units",K_e.UsageBilledUnits.optional()),tokens:J_e.UsageTokens.optional()});var ol={},X_e=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Z_e=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Y_e=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&X_e(e,t,r);return Z_e(e,t),e};Object.defineProperty(ol,"__esModule",{value:!0});ol.LogprobItem=void 0;const Xa=Y_e(P);ol.LogprobItem=Xa.serialization.object({text:Xa.serialization.string().optional(),tokenIds:Xa.serialization.property("token_ids",Xa.serialization.list(Xa.serialization.number())),logprobs:Xa.serialization.list(Xa.serialization.number()).optional()});var Zm={},Q_e=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),eye=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),tye=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Q_e(e,t,r);return eye(e,t),e};Object.defineProperty(Zm,"__esModule",{value:!0});Zm.ChatResponse=void 0;const Vl=tye(P),rye=il,nye=hh,iye=al,aye=ol;Zm.ChatResponse=Vl.serialization.object({id:Vl.serialization.string(),finishReason:Vl.serialization.property("finish_reason",rye.ChatFinishReason),prompt:Vl.serialization.string().optional(),message:nye.AssistantMessageResponse,usage:iye.Usage.optional(),logprobs:Vl.serialization.list(aye.LogprobItem).optional()});var vr={},oye=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),sye=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),uye=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&oye(e,t,r);return sye(e,t),e};Object.defineProperty(vr,"__esModule",{value:!0});vr.ChatStreamEventType=void 0;const lye=uye(P);vr.ChatStreamEventType=lye.serialization.object({});var yh={},cye=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),dye=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),fye=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&cye(e,t,r);return dye(e,t),e};Object.defineProperty(yh,"__esModule",{value:!0});yh.ChatMessageStartEventDeltaMessage=void 0;const CA=fye(P);yh.ChatMessageStartEventDeltaMessage=CA.serialization.object({role:CA.serialization.stringLiteral("assistant").optional()});var bh={},hye=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),pye=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),_ye=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&hye(e,t,r);return pye(e,t),e};Object.defineProperty(bh,"__esModule",{value:!0});bh.ChatMessageStartEventDelta=void 0;const yye=_ye(P),bye=yh;bh.ChatMessageStartEventDelta=yye.serialization.object({message:bye.ChatMessageStartEventDeltaMessage.optional()});var gh={},gye=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),mye=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),vye=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&gye(e,t,r);return mye(e,t),e};Object.defineProperty(gh,"__esModule",{value:!0});gh.ChatMessageStartEvent=void 0;const MA=vye(P),wye=bh,Oye=vr;gh.ChatMessageStartEvent=MA.serialization.object({id:MA.serialization.string().optional(),delta:wye.ChatMessageStartEventDelta.optional()}).extend(Oye.ChatStreamEventType);var mh={},Sye=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Eye=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Pye=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Sye(e,t,r);return Eye(e,t),e};Object.defineProperty(mh,"__esModule",{value:!0});mh.ChatContentStartEventDeltaMessageContent=void 0;const nO=Pye(P);mh.ChatContentStartEventDeltaMessageContent=nO.serialization.object({text:nO.serialization.string().optional(),type:nO.serialization.stringLiteral("text").optional()});var vh={},jye=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Cye=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Mye=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&jye(e,t,r);return Cye(e,t),e};Object.defineProperty(vh,"__esModule",{value:!0});vh.ChatContentStartEventDeltaMessage=void 0;const Tye=Mye(P),Rye=mh;vh.ChatContentStartEventDeltaMessage=Tye.serialization.object({content:Rye.ChatContentStartEventDeltaMessageContent.optional()});var wh={},Aye=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),$ye=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Iye=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Aye(e,t,r);return $ye(e,t),e};Object.defineProperty(wh,"__esModule",{value:!0});wh.ChatContentStartEventDelta=void 0;const xye=Iye(P),Dye=vh;wh.ChatContentStartEventDelta=xye.serialization.object({message:Dye.ChatContentStartEventDeltaMessage.optional()});var Oh={},Nye=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),zye=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Bye=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Nye(e,t,r);return zye(e,t),e};Object.defineProperty(Oh,"__esModule",{value:!0});Oh.ChatContentStartEvent=void 0;const TA=Bye(P),Uye=wh,Fye=vr;Oh.ChatContentStartEvent=TA.serialization.object({index:TA.serialization.number().optional(),delta:Uye.ChatContentStartEventDelta.optional()}).extend(Fye.ChatStreamEventType);var Sh={},Lye=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Vye=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),kye=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Lye(e,t,r);return Vye(e,t),e};Object.defineProperty(Sh,"__esModule",{value:!0});Sh.ChatContentDeltaEventDeltaMessageContent=void 0;const RA=kye(P);Sh.ChatContentDeltaEventDeltaMessageContent=RA.serialization.object({text:RA.serialization.string().optional()});var Eh={},Hye=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),qye=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Gye=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Hye(e,t,r);return qye(e,t),e};Object.defineProperty(Eh,"__esModule",{value:!0});Eh.ChatContentDeltaEventDeltaMessage=void 0;const Wye=Gye(P),Kye=Sh;Eh.ChatContentDeltaEventDeltaMessage=Wye.serialization.object({content:Kye.ChatContentDeltaEventDeltaMessageContent.optional()});var Ph={},Jye=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Xye=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Zye=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Jye(e,t,r);return Xye(e,t),e};Object.defineProperty(Ph,"__esModule",{value:!0});Ph.ChatContentDeltaEventDelta=void 0;const Yye=Zye(P),Qye=Eh;Ph.ChatContentDeltaEventDelta=Yye.serialization.object({message:Qye.ChatContentDeltaEventDeltaMessage.optional()});var jh={},ebe=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),tbe=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),rbe=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&ebe(e,t,r);return tbe(e,t),e};Object.defineProperty(jh,"__esModule",{value:!0});jh.ChatContentDeltaEvent=void 0;const AA=rbe(P),nbe=Ph,ibe=ol,abe=vr;jh.ChatContentDeltaEvent=AA.serialization.object({index:AA.serialization.number().optional(),delta:nbe.ChatContentDeltaEventDelta.optional(),logprobs:ibe.LogprobItem.optional()}).extend(abe.ChatStreamEventType);var Ch={},obe=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),sbe=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),ube=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&obe(e,t,r);return sbe(e,t),e};Object.defineProperty(Ch,"__esModule",{value:!0});Ch.ChatContentEndEvent=void 0;const $A=ube(P),lbe=vr;Ch.ChatContentEndEvent=$A.serialization.object({index:$A.serialization.number().optional()}).extend(lbe.ChatStreamEventType);var Mh={},cbe=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),dbe=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),fbe=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&cbe(e,t,r);return dbe(e,t),e};Object.defineProperty(Mh,"__esModule",{value:!0});Mh.ChatToolPlanDeltaEventDeltaMessage=void 0;const iO=fbe(P);Mh.ChatToolPlanDeltaEventDeltaMessage=iO.serialization.object({toolPlan:iO.serialization.property("tool_plan",iO.serialization.string().optional())});var Th={},hbe=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),pbe=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),_be=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&hbe(e,t,r);return pbe(e,t),e};Object.defineProperty(Th,"__esModule",{value:!0});Th.ChatToolPlanDeltaEventDelta=void 0;const ybe=_be(P),bbe=Mh;Th.ChatToolPlanDeltaEventDelta=ybe.serialization.object({message:bbe.ChatToolPlanDeltaEventDeltaMessage.optional()});var Rh={},gbe=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),mbe=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),vbe=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&gbe(e,t,r);return mbe(e,t),e};Object.defineProperty(Rh,"__esModule",{value:!0});Rh.ChatToolPlanDeltaEvent=void 0;const wbe=vbe(P),Obe=Th,Sbe=vr;Rh.ChatToolPlanDeltaEvent=wbe.serialization.object({delta:Obe.ChatToolPlanDeltaEventDelta.optional()}).extend(Sbe.ChatStreamEventType);var Ah={},Ebe=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Pbe=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),jbe=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Ebe(e,t,r);return Pbe(e,t),e};Object.defineProperty(Ah,"__esModule",{value:!0});Ah.ChatToolCallStartEventDeltaMessage=void 0;const IA=jbe(P),Cbe=Do;Ah.ChatToolCallStartEventDeltaMessage=IA.serialization.object({toolCalls:IA.serialization.property("tool_calls",Cbe.ToolCallV2.optional())});var $h={},Mbe=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Tbe=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Rbe=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Mbe(e,t,r);return Tbe(e,t),e};Object.defineProperty($h,"__esModule",{value:!0});$h.ChatToolCallStartEventDelta=void 0;const Abe=Rbe(P),$be=Ah;$h.ChatToolCallStartEventDelta=Abe.serialization.object({message:$be.ChatToolCallStartEventDeltaMessage.optional()});var Ih={},Ibe=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),xbe=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Dbe=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Ibe(e,t,r);return xbe(e,t),e};Object.defineProperty(Ih,"__esModule",{value:!0});Ih.ChatToolCallStartEvent=void 0;const xA=Dbe(P),Nbe=$h,zbe=vr;Ih.ChatToolCallStartEvent=xA.serialization.object({index:xA.serialization.number().optional(),delta:Nbe.ChatToolCallStartEventDelta.optional()}).extend(zbe.ChatStreamEventType);var xh={},Bbe=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Ube=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Fbe=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Bbe(e,t,r);return Ube(e,t),e};Object.defineProperty(xh,"__esModule",{value:!0});xh.ChatToolCallDeltaEventDeltaMessageToolCallsFunction=void 0;const DA=Fbe(P);xh.ChatToolCallDeltaEventDeltaMessageToolCallsFunction=DA.serialization.object({arguments:DA.serialization.string().optional()});var Dh={},Lbe=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Vbe=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),kbe=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Lbe(e,t,r);return Vbe(e,t),e};Object.defineProperty(Dh,"__esModule",{value:!0});Dh.ChatToolCallDeltaEventDeltaMessageToolCalls=void 0;const Hbe=kbe(P),qbe=xh;Dh.ChatToolCallDeltaEventDeltaMessageToolCalls=Hbe.serialization.object({function:qbe.ChatToolCallDeltaEventDeltaMessageToolCallsFunction.optional()});var Nh={},Gbe=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Wbe=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Kbe=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Gbe(e,t,r);return Wbe(e,t),e};Object.defineProperty(Nh,"__esModule",{value:!0});Nh.ChatToolCallDeltaEventDeltaMessage=void 0;const NA=Kbe(P),Jbe=Dh;Nh.ChatToolCallDeltaEventDeltaMessage=NA.serialization.object({toolCalls:NA.serialization.property("tool_calls",Jbe.ChatToolCallDeltaEventDeltaMessageToolCalls.optional())});var zh={},Xbe=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Zbe=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Ybe=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Xbe(e,t,r);return Zbe(e,t),e};Object.defineProperty(zh,"__esModule",{value:!0});zh.ChatToolCallDeltaEventDelta=void 0;const Qbe=Ybe(P),ege=Nh;zh.ChatToolCallDeltaEventDelta=Qbe.serialization.object({message:ege.ChatToolCallDeltaEventDeltaMessage.optional()});var Bh={},tge=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),rge=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),nge=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&tge(e,t,r);return rge(e,t),e};Object.defineProperty(Bh,"__esModule",{value:!0});Bh.ChatToolCallDeltaEvent=void 0;const zA=nge(P),ige=zh,age=vr;Bh.ChatToolCallDeltaEvent=zA.serialization.object({index:zA.serialization.number().optional(),delta:ige.ChatToolCallDeltaEventDelta.optional()}).extend(age.ChatStreamEventType);var Uh={},oge=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),sge=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),uge=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&oge(e,t,r);return sge(e,t),e};Object.defineProperty(Uh,"__esModule",{value:!0});Uh.ChatToolCallEndEvent=void 0;const BA=uge(P),lge=vr;Uh.ChatToolCallEndEvent=BA.serialization.object({index:BA.serialization.number().optional()}).extend(lge.ChatStreamEventType);var Fh={},cge=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),dge=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),fge=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&cge(e,t,r);return dge(e,t),e};Object.defineProperty(Fh,"__esModule",{value:!0});Fh.CitationStartEventDeltaMessage=void 0;const hge=fge(P),pge=No;Fh.CitationStartEventDeltaMessage=hge.serialization.object({citations:pge.Citation.optional()});var Lh={},_ge=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),yge=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),bge=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&_ge(e,t,r);return yge(e,t),e};Object.defineProperty(Lh,"__esModule",{value:!0});Lh.CitationStartEventDelta=void 0;const gge=bge(P),mge=Fh;Lh.CitationStartEventDelta=gge.serialization.object({message:mge.CitationStartEventDeltaMessage.optional()});var Vh={},vge=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),wge=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Oge=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&vge(e,t,r);return wge(e,t),e};Object.defineProperty(Vh,"__esModule",{value:!0});Vh.CitationStartEvent=void 0;const UA=Oge(P),Sge=Lh,Ege=vr;Vh.CitationStartEvent=UA.serialization.object({index:UA.serialization.number().optional(),delta:Sge.CitationStartEventDelta.optional()}).extend(Ege.ChatStreamEventType);var kh={},Pge=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),jge=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Cge=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Pge(e,t,r);return jge(e,t),e};Object.defineProperty(kh,"__esModule",{value:!0});kh.CitationEndEvent=void 0;const FA=Cge(P),Mge=vr;kh.CitationEndEvent=FA.serialization.object({index:FA.serialization.number().optional()}).extend(Mge.ChatStreamEventType);var Hh={},Tge=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Rge=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Age=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Tge(e,t,r);return Rge(e,t),e};Object.defineProperty(Hh,"__esModule",{value:!0});Hh.ChatMessageEndEventDelta=void 0;const LA=Age(P),$ge=il,Ige=al;Hh.ChatMessageEndEventDelta=LA.serialization.object({finishReason:LA.serialization.property("finish_reason",$ge.ChatFinishReason.optional()),usage:Ige.Usage.optional()});var qh={},xge=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Dge=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Nge=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&xge(e,t,r);return Dge(e,t),e};Object.defineProperty(qh,"__esModule",{value:!0});qh.ChatMessageEndEvent=void 0;const VA=Nge(P),zge=Hh,Bge=vr;qh.ChatMessageEndEvent=VA.serialization.object({id:VA.serialization.string().optional(),delta:zge.ChatMessageEndEventDelta.optional()}).extend(Bge.ChatStreamEventType);var Ym={},Uge=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Fge=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Lge=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Uge(e,t,r);return Fge(e,t),e};Object.defineProperty(Ym,"__esModule",{value:!0});Ym.StreamedChatResponseV2=void 0;const Vge=Lge(P),kge=gh,Hge=Oh,qge=jh,Gge=Ch,Wge=Rh,Kge=Ih,Jge=Bh,Xge=Uh,Zge=Vh,Yge=kh,Qge=qh,eme=nl;Ym.StreamedChatResponseV2=Vge.serialization.union("type",{"message-start":kge.ChatMessageStartEvent,"content-start":Hge.ChatContentStartEvent,"content-delta":qge.ChatContentDeltaEvent,"content-end":Gge.ChatContentEndEvent,"tool-plan-delta":Wge.ChatToolPlanDeltaEvent,"tool-call-start":Kge.ChatToolCallStartEvent,"tool-call-delta":Jge.ChatToolCallDeltaEvent,"tool-call-end":Xge.ChatToolCallEndEvent,"citation-start":Zge.CitationStartEvent,"citation-end":Yge.CitationEndEvent,"message-end":Qge.ChatMessageEndEvent,debug:eme.ChatDebugEvent}).transform({transform:t=>t,untransform:t=>t});var Gh={},tme=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),rme=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),nme=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&tme(e,t,r);return rme(e,t),e};Object.defineProperty(Gh,"__esModule",{value:!0});Gh.SingleGenerationTokenLikelihoodsItem=void 0;const aO=nme(P);Gh.SingleGenerationTokenLikelihoodsItem=aO.serialization.object({token:aO.serialization.string(),likelihood:aO.serialization.number()});var Wh={},ime=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),ame=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),ome=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&ime(e,t,r);return ame(e,t),e};Object.defineProperty(Wh,"__esModule",{value:!0});Wh.SingleGeneration=void 0;const Za=ome(P),sme=Gh;Wh.SingleGeneration=Za.serialization.object({id:Za.serialization.string(),text:Za.serialization.string(),index:Za.serialization.number().optional(),likelihood:Za.serialization.number().optional(),tokenLikelihoods:Za.serialization.property("token_likelihoods",Za.serialization.list(sme.SingleGenerationTokenLikelihoodsItem).optional())});var Qm={},ume=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),lme=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),cme=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&ume(e,t,r);return lme(e,t),e};Object.defineProperty(Qm,"__esModule",{value:!0});Qm.Generation=void 0;const O_=cme(P),dme=Wh,fme=hr;Qm.Generation=O_.serialization.object({id:O_.serialization.string(),prompt:O_.serialization.string().optional(),generations:O_.serialization.list(dme.SingleGeneration),meta:fme.ApiMeta.optional()});var ko={},hme=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),pme=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),_me=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&hme(e,t,r);return pme(e,t),e};Object.defineProperty(ko,"__esModule",{value:!0});ko.GenerateStreamEvent=void 0;const yme=_me(P);ko.GenerateStreamEvent=yme.serialization.object({});var Kh={},bme=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),gme=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),mme=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&bme(e,t,r);return gme(e,t),e};Object.defineProperty(Kh,"__esModule",{value:!0});Kh.GenerateStreamText=void 0;const kl=mme(P),vme=ko;Kh.GenerateStreamText=kl.serialization.object({text:kl.serialization.string(),index:kl.serialization.number().optional(),isFinished:kl.serialization.property("is_finished",kl.serialization.boolean())}).extend(vme.GenerateStreamEvent);var Jh={},wme=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Ome=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Sme=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&wme(e,t,r);return Ome(e,t),e};Object.defineProperty(Jh,"__esModule",{value:!0});Jh.SingleGenerationInStream=void 0;const Hl=Sme(P),Eme=Ua;Jh.SingleGenerationInStream=Hl.serialization.object({id:Hl.serialization.string(),text:Hl.serialization.string(),index:Hl.serialization.number().optional(),finishReason:Hl.serialization.property("finish_reason",Eme.FinishReason)});var Xh={},Pme=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),jme=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Cme=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Pme(e,t,r);return jme(e,t),e};Object.defineProperty(Xh,"__esModule",{value:!0});Xh.GenerateStreamEndResponse=void 0;const S_=Cme(P),Mme=Jh;Xh.GenerateStreamEndResponse=S_.serialization.object({id:S_.serialization.string(),prompt:S_.serialization.string().optional(),generations:S_.serialization.list(Mme.SingleGenerationInStream).optional()});var Zh={},Tme=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Rme=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Ame=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Tme(e,t,r);return Rme(e,t),e};Object.defineProperty(Zh,"__esModule",{value:!0});Zh.GenerateStreamEnd=void 0;const E_=Ame(P),$me=Ua,Ime=Xh,xme=ko;Zh.GenerateStreamEnd=E_.serialization.object({isFinished:E_.serialization.property("is_finished",E_.serialization.boolean()),finishReason:E_.serialization.property("finish_reason",$me.FinishReason.optional()),response:Ime.GenerateStreamEndResponse}).extend(xme.GenerateStreamEvent);var Yh={},Dme=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Nme=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),zme=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Dme(e,t,r);return Nme(e,t),e};Object.defineProperty(Yh,"__esModule",{value:!0});Yh.GenerateStreamError=void 0;const hs=zme(P),Bme=Ua,Ume=ko;Yh.GenerateStreamError=hs.serialization.object({index:hs.serialization.number().optional(),isFinished:hs.serialization.property("is_finished",hs.serialization.boolean()),finishReason:hs.serialization.property("finish_reason",Bme.FinishReason),err:hs.serialization.string()}).extend(Ume.GenerateStreamEvent);var ev={},Fme=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Lme=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Vme=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Fme(e,t,r);return Lme(e,t),e};Object.defineProperty(ev,"__esModule",{value:!0});ev.GenerateStreamedResponse=void 0;const kA=Vme(P),kme=Kh,Hme=Zh,qme=Yh;ev.GenerateStreamedResponse=kA.serialization.union(kA.serialization.discriminant("eventType","event_type"),{"text-generation":kme.GenerateStreamText,"stream-end":Hme.GenerateStreamEnd,"stream-error":qme.GenerateStreamError}).transform({transform:t=>t,untransform:t=>t});var Qh={},Gme=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Wme=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Kme=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Gme(e,t,r);return Wme(e,t),e};Object.defineProperty(Qh,"__esModule",{value:!0});Qh.EmbedJobStatus=void 0;const Jme=Kme(P);Qh.EmbedJobStatus=Jme.serialization.enum_(["processing","complete","cancelling","cancelled","failed"]);var ep={},Xme=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Zme=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Yme=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Xme(e,t,r);return Zme(e,t),e};Object.defineProperty(ep,"__esModule",{value:!0});ep.EmbedJobTruncate=void 0;const Qme=Yme(P);ep.EmbedJobTruncate=Qme.serialization.enum_(["START","END"]);var tp={},eve=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),tve=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),rve=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&eve(e,t,r);return tve(e,t),e};Object.defineProperty(tp,"__esModule",{value:!0});tp.EmbedJob=void 0;const Pn=rve(P),nve=Qh,ive=ep,ave=hr;tp.EmbedJob=Pn.serialization.object({jobId:Pn.serialization.property("job_id",Pn.serialization.string()),name:Pn.serialization.string().optional(),status:nve.EmbedJobStatus,createdAt:Pn.serialization.property("created_at",Pn.serialization.date()),inputDatasetId:Pn.serialization.property("input_dataset_id",Pn.serialization.string()),outputDatasetId:Pn.serialization.property("output_dataset_id",Pn.serialization.string().optional()),model:Pn.serialization.string(),truncate:ive.EmbedJobTruncate,meta:ave.ApiMeta.optional()});var tv={},ove=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),sve=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),uve=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&ove(e,t,r);return sve(e,t),e};Object.defineProperty(tv,"__esModule",{value:!0});tv.ListEmbedJobResponse=void 0;const oO=uve(P),lve=tp;tv.ListEmbedJobResponse=oO.serialization.object({embedJobs:oO.serialization.property("embed_jobs",oO.serialization.list(lve.EmbedJob).optional())});var rv={},cve=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),dve=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),fve=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&cve(e,t,r);return dve(e,t),e};Object.defineProperty(rv,"__esModule",{value:!0});rv.CreateEmbedJobResponse=void 0;const sO=fve(P),hve=hr;rv.CreateEmbedJobResponse=sO.serialization.object({jobId:sO.serialization.property("job_id",sO.serialization.string()),meta:hve.ApiMeta.optional()});var rp={},pve=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),_ve=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),yve=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&pve(e,t,r);return _ve(e,t),e};Object.defineProperty(rp,"__esModule",{value:!0});rp.ClassifyExample=void 0;const uO=yve(P);rp.ClassifyExample=uO.serialization.object({text:uO.serialization.string().optional(),label:uO.serialization.string().optional()});var nv={},bve=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),gve=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),mve=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&bve(e,t,r);return gve(e,t),e};Object.defineProperty(nv,"__esModule",{value:!0});nv.ParseInfo=void 0;const lO=mve(P);nv.ParseInfo=lO.serialization.object({separator:lO.serialization.string().optional(),delimiter:lO.serialization.string().optional()});var iv={},vve=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),wve=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Ove=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&vve(e,t,r);return wve(e,t),e};Object.defineProperty(iv,"__esModule",{value:!0});iv.RerankerDataMetrics=void 0;const zr=Ove(P);iv.RerankerDataMetrics=zr.serialization.object({numTrainQueries:zr.serialization.property("num_train_queries",zr.serialization.number().optional()),numTrainRelevantPassages:zr.serialization.property("num_train_relevant_passages",zr.serialization.number().optional()),numTrainHardNegatives:zr.serialization.property("num_train_hard_negatives",zr.serialization.number().optional()),numEvalQueries:zr.serialization.property("num_eval_queries",zr.serialization.number().optional()),numEvalRelevantPassages:zr.serialization.property("num_eval_relevant_passages",zr.serialization.number().optional()),numEvalHardNegatives:zr.serialization.property("num_eval_hard_negatives",zr.serialization.number().optional())});var av={},Sve=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Eve=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Pve=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Sve(e,t,r);return Eve(e,t),e};Object.defineProperty(av,"__esModule",{value:!0});av.ChatDataMetrics=void 0;const ps=Pve(P);av.ChatDataMetrics=ps.serialization.object({numTrainTurns:ps.serialization.property("num_train_turns",ps.serialization.number().optional()),numEvalTurns:ps.serialization.property("num_eval_turns",ps.serialization.number().optional()),preamble:ps.serialization.string().optional()});var np={},jve=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Cve=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Mve=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&jve(e,t,r);return Cve(e,t),e};Object.defineProperty(np,"__esModule",{value:!0});np.LabelMetric=void 0;const _s=Mve(P);np.LabelMetric=_s.serialization.object({totalExamples:_s.serialization.property("total_examples",_s.serialization.number().optional()),label:_s.serialization.string().optional(),samples:_s.serialization.list(_s.serialization.string()).optional()});var ov={},Tve=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Rve=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Ave=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Tve(e,t,r);return Rve(e,t),e};Object.defineProperty(ov,"__esModule",{value:!0});ov.ClassifyDataMetrics=void 0;const cO=Ave(P),$ve=np;ov.ClassifyDataMetrics=cO.serialization.object({labelMetrics:cO.serialization.property("label_metrics",cO.serialization.list($ve.LabelMetric).optional())});var ip={},Ive=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),xve=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Dve=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Ive(e,t,r);return xve(e,t),e};Object.defineProperty(ip,"__esModule",{value:!0});ip.FinetuneDatasetMetrics=void 0;const Br=Dve(P);ip.FinetuneDatasetMetrics=Br.serialization.object({trainableTokenCount:Br.serialization.property("trainable_token_count",Br.serialization.number().optional()),totalExamples:Br.serialization.property("total_examples",Br.serialization.number().optional()),trainExamples:Br.serialization.property("train_examples",Br.serialization.number().optional()),trainSizeBytes:Br.serialization.property("train_size_bytes",Br.serialization.number().optional()),evalExamples:Br.serialization.property("eval_examples",Br.serialization.number().optional()),evalSizeBytes:Br.serialization.property("eval_size_bytes",Br.serialization.number().optional())});var ap={},Nve=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),zve=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Bve=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Nve(e,t,r);return zve(e,t),e};Object.defineProperty(ap,"__esModule",{value:!0});ap.MetricsEmbedDataFieldsItem=void 0;const dO=Bve(P);ap.MetricsEmbedDataFieldsItem=dO.serialization.object({name:dO.serialization.string().optional(),count:dO.serialization.number().optional()});var op={},Uve=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Fve=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Lve=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Uve(e,t,r);return Fve(e,t),e};Object.defineProperty(op,"__esModule",{value:!0});op.MetricsEmbedData=void 0;const HA=Lve(P),Vve=ap;op.MetricsEmbedData=HA.serialization.object({fields:HA.serialization.list(Vve.MetricsEmbedDataFieldsItem).optional()});var sv={},kve=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Hve=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),qve=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&kve(e,t,r);return Hve(e,t),e};Object.defineProperty(sv,"__esModule",{value:!0});sv.Metrics=void 0;const fO=qve(P),Gve=ip,Wve=op;sv.Metrics=fO.serialization.object({finetuneDatasetMetrics:fO.serialization.property("finetune_dataset_metrics",Gve.FinetuneDatasetMetrics.optional()),embedData:fO.serialization.property("embed_data",Wve.MetricsEmbedData.optional())});var sp={},Kve=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Jve=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Xve=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Kve(e,t,r);return Jve(e,t),e};Object.defineProperty(sp,"__esModule",{value:!0});sp.ConnectorOAuth=void 0;const Wn=Xve(P);sp.ConnectorOAuth=Wn.serialization.object({clientId:Wn.serialization.property("client_id",Wn.serialization.string().optional()),clientSecret:Wn.serialization.property("client_secret",Wn.serialization.string().optional()),authorizeUrl:Wn.serialization.property("authorize_url",Wn.serialization.string()),tokenUrl:Wn.serialization.property("token_url",Wn.serialization.string()),scope:Wn.serialization.string().optional()});var up={},Zve=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Yve=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Qve=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Zve(e,t,r);return Yve(e,t),e};Object.defineProperty(up,"__esModule",{value:!0});up.ConnectorAuthStatus=void 0;const ewe=Qve(P);up.ConnectorAuthStatus=ewe.serialization.enum_(["valid","expired"]);var Fa={},twe=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),rwe=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),nwe=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&twe(e,t,r);return rwe(e,t),e};Object.defineProperty(Fa,"__esModule",{value:!0});Fa.Connector=void 0;const Ut=nwe(P),iwe=sp,awe=up;Fa.Connector=Ut.serialization.object({id:Ut.serialization.string(),organizationId:Ut.serialization.property("organization_id",Ut.serialization.string().optional()),name:Ut.serialization.string(),description:Ut.serialization.string().optional(),url:Ut.serialization.string().optional(),createdAt:Ut.serialization.property("created_at",Ut.serialization.date()),updatedAt:Ut.serialization.property("updated_at",Ut.serialization.date()),excludes:Ut.serialization.list(Ut.serialization.string()).optional(),authType:Ut.serialization.property("auth_type",Ut.serialization.string().optional()),oauth:iwe.ConnectorOAuth.optional(),authStatus:Ut.serialization.property("auth_status",awe.ConnectorAuthStatus.optional()),active:Ut.serialization.boolean().optional(),continueOnFailure:Ut.serialization.property("continue_on_failure",Ut.serialization.boolean().optional())});var uv={},owe=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),swe=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),uwe=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&owe(e,t,r);return swe(e,t),e};Object.defineProperty(uv,"__esModule",{value:!0});uv.ListConnectorsResponse=void 0;const P_=uwe(P),lwe=Fa;uv.ListConnectorsResponse=P_.serialization.object({connectors:P_.serialization.list(lwe.Connector),totalCount:P_.serialization.property("total_count",P_.serialization.number().optional())});var lv={},cwe=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),dwe=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),fwe=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&cwe(e,t,r);return dwe(e,t),e};Object.defineProperty(lv,"__esModule",{value:!0});lv.CreateConnectorResponse=void 0;const hwe=fwe(P),pwe=Fa;lv.CreateConnectorResponse=hwe.serialization.object({connector:pwe.Connector});var cv={},_we=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),ywe=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),bwe=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&_we(e,t,r);return ywe(e,t),e};Object.defineProperty(cv,"__esModule",{value:!0});cv.GetConnectorResponse=void 0;const gwe=bwe(P),mwe=Fa;cv.GetConnectorResponse=gwe.serialization.object({connector:mwe.Connector});var dv={},vwe=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),wwe=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Owe=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&vwe(e,t,r);return wwe(e,t),e};Object.defineProperty(dv,"__esModule",{value:!0});dv.DeleteConnectorResponse=void 0;const hO=Owe(P);dv.DeleteConnectorResponse=hO.serialization.record(hO.serialization.string(),hO.serialization.unknown());var fv={},Swe=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Ewe=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Pwe=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Swe(e,t,r);return Ewe(e,t),e};Object.defineProperty(fv,"__esModule",{value:!0});fv.UpdateConnectorResponse=void 0;const jwe=Pwe(P),Cwe=Fa;fv.UpdateConnectorResponse=jwe.serialization.object({connector:Cwe.Connector});var hv={},Mwe=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Twe=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Rwe=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Mwe(e,t,r);return Twe(e,t),e};Object.defineProperty(hv,"__esModule",{value:!0});hv.OAuthAuthorizeResponse=void 0;const pO=Rwe(P);hv.OAuthAuthorizeResponse=pO.serialization.object({redirectUrl:pO.serialization.property("redirect_url",pO.serialization.string().optional())});var lp={},Awe=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),$we=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Iwe=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Awe(e,t,r);return $we(e,t),e};Object.defineProperty(lp,"__esModule",{value:!0});lp.CompatibleEndpoint=void 0;const xwe=Iwe(P);lp.CompatibleEndpoint=xwe.serialization.enum_(["chat","embed","classify","summarize","rerank","rate","generate"]);var cp={},Dwe=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Nwe=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),zwe=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Dwe(e,t,r);return Nwe(e,t),e};Object.defineProperty(cp,"__esModule",{value:!0});cp.GetModelResponse=void 0;const nn=zwe(P),qA=lp;cp.GetModelResponse=nn.serialization.object({name:nn.serialization.string().optional(),endpoints:nn.serialization.list(qA.CompatibleEndpoint).optional(),finetuned:nn.serialization.boolean().optional(),contextLength:nn.serialization.property("context_length",nn.serialization.number().optional()),tokenizerUrl:nn.serialization.property("tokenizer_url",nn.serialization.string().optional()),supportsVision:nn.serialization.property("supports_vision",nn.serialization.boolean().optional()),defaultEndpoints:nn.serialization.property("default_endpoints",nn.serialization.list(qA.CompatibleEndpoint).optional())});var pv={},Bwe=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Uwe=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Fwe=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Bwe(e,t,r);return Uwe(e,t),e};Object.defineProperty(pv,"__esModule",{value:!0});pv.ListModelsResponse=void 0;const j_=Fwe(P),Lwe=cp;pv.ListModelsResponse=j_.serialization.object({models:j_.serialization.list(Lwe.GetModelResponse),nextPageToken:j_.serialization.property("next_page_token",j_.serialization.string().optional())});(function(t){var e=u&&u.__createBinding||(Object.create?function(n,i,a,o){o===void 0&&(o=a);var s=Object.getOwnPropertyDescriptor(i,a);(!s||("get"in s?!i.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return i[a]}}),Object.defineProperty(n,o,s)}:function(n,i,a,o){o===void 0&&(o=a),n[o]=i[a]}),r=u&&u.__exportStar||function(n,i){for(var a in n)a!=="default"&&!Object.prototype.hasOwnProperty.call(i,a)&&e(i,n,a)};Object.defineProperty(t,"__esModule",{value:!0}),r(Sf,t),r(Ef,t),r(Lm,t),r(Pf,t),r(jf,t),r(Cf,t),r(Vm,t),r(Mf,t),r(Tf,t),r(Rf,t),r(Af,t),r($f,t),r(If,t),r(km,t),r(zf,t),r(Uf,t),r(Ff,t),r(Hm,t),r(Lf,t),r(Vf,t),r(kf,t),r(Hf,t),r(qm,t),r(qf,t),r(Gf,t),r(Wf,t),r(Gm,t),r(Wm,t),r(Km,t),r(Jm,t),r(za,t),r(Kf,t),r(Fo,t),r(Jf,t),r(Lo,t),r(Yu,t),r(Ba,t),r(Xf,t),r(Qu,t),r(Zf,t),r(Yf,t),r(el,t),r(Qf,t),r(tl,t),r(Vo,t),r(eh,t),r(rl,t),r(Ua,t),r(Dd,t),r(Nd,t),r(zd,t),r(hr,t),r(th,t),r(Zr,t),r(rh,t),r(nh,t),r(ih,t),r(ah,t),r(oh,t),r(sh,t),r(uh,t),r(lh,t),r(ch,t),r(dh,t),r(nl,t),r(Xm,t),r(Wi,t),r(kd,t),r(Vd,t),r(Ld,t),r(Fd,t),r(Ud,t),r(qd,t),r(Do,t),r(Jd,t),r(Xd,t),r(Kd,t),r(Zd,t),r(No,t),r(Wd,t),r(Gd,t),r(Hd,t),r(ef,t),r(Qd,t),r(Yd,t),r(xo,t),r(af,t),r(nf,t),r(rf,t),r(tf,t),r(Bd,t),r(ku,t),r(of,t),r(Hu,t),r(sf,t),r(qu,t),r(uf,t),r(lf,t),r(Gu,t),r(il,t),r(fh,t),r(hh,t),r(ph,t),r(_h,t),r(al,t),r(ol,t),r(Zm,t),r(vr,t),r(yh,t),r(bh,t),r(gh,t),r(mh,t),r(vh,t),r(wh,t),r(Oh,t),r(Sh,t),r(Eh,t),r(Ph,t),r(jh,t),r(Ch,t),r(Mh,t),r(Th,t),r(Rh,t),r(Ah,t),r($h,t),r(Ih,t),r(xh,t),r(Dh,t),r(Nh,t),r(zh,t),r(Bh,t),r(Uh,t),r(Fh,t),r(Lh,t),r(Vh,t),r(kh,t),r(Hh,t),r(qh,t),r(Ym,t),r(Gh,t),r(Wh,t),r(Qm,t),r(ko,t),r(Kh,t),r(Jh,t),r(Xh,t),r(Zh,t),r(Yh,t),r(ev,t),r(zo,t),r(Bo,t),r(Zu,t),r(xf,t),r(Nf,t),r(Df,t),r(Qh,t),r(ep,t),r(tp,t),r(tv,t),r(rv,t),r(Bf,t),r(rp,t),r(ff,t),r(df,t),r(hf,t),r(nv,t),r(iv,t),r(av,t),r(np,t),r(ov,t),r(ip,t),r(ap,t),r(op,t),r(sv,t),r(Wu,t),r(sp,t),r(up,t),r(Fa,t),r(uv,t),r(Ju,t),r(Of,t),r(Xu,t),r(lv,t),r(cv,t),r(dv,t),r(fv,t),r(hv,t),r(lp,t),r(cp,t),r(pv,t)})(jL);var CL={},ML={},_v={},Vwe=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),kwe=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Hwe=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Vwe(e,t,r);return kwe(e,t),e};Object.defineProperty(_v,"__esModule",{value:!0});_v.ChatStreamRequest=void 0;const Be=Hwe(P),qwe=Lo,Gwe=Sf,Wwe=Yu,Kwe=Ba,Jwe=Ef,Xwe=Qu,Zwe=Fo,Ywe=el,Qwe=Pf;_v.ChatStreamRequest=Be.serialization.object({message:Be.serialization.string(),model:Be.serialization.string().optional(),preamble:Be.serialization.string().optional(),chatHistory:Be.serialization.property("chat_history",Be.serialization.list(qwe.Message).optional()),conversationId:Be.serialization.property("conversation_id",Be.serialization.string().optional()),promptTruncation:Be.serialization.property("prompt_truncation",Gwe.ChatStreamRequestPromptTruncation.optional()),connectors:Be.serialization.list(Wwe.ChatConnector).optional(),searchQueriesOnly:Be.serialization.property("search_queries_only",Be.serialization.boolean().optional()),documents:Be.serialization.list(Kwe.ChatDocument).optional(),citationQuality:Be.serialization.property("citation_quality",Jwe.ChatStreamRequestCitationQuality.optional()),temperature:Be.serialization.number().optional(),maxTokens:Be.serialization.property("max_tokens",Be.serialization.number().optional()),maxInputTokens:Be.serialization.property("max_input_tokens",Be.serialization.number().optional()),k:Be.serialization.number().optional(),p:Be.serialization.number().optional(),seed:Be.serialization.number().optional(),stopSequences:Be.serialization.property("stop_sequences",Be.serialization.list(Be.serialization.string()).optional()),frequencyPenalty:Be.serialization.property("frequency_penalty",Be.serialization.number().optional()),presencePenalty:Be.serialization.property("presence_penalty",Be.serialization.number().optional()),rawPrompting:Be.serialization.property("raw_prompting",Be.serialization.boolean().optional()),returnPrompt:Be.serialization.property("return_prompt",Be.serialization.boolean().optional()),tools:Be.serialization.list(Xwe.Tool).optional(),toolResults:Be.serialization.property("tool_results",Be.serialization.list(Zwe.ToolResult).optional()),forceSingleStep:Be.serialization.property("force_single_step",Be.serialization.boolean().optional()),responseFormat:Be.serialization.property("response_format",Ywe.ResponseFormat.optional()),safetyMode:Be.serialization.property("safety_mode",Qwe.ChatStreamRequestSafetyMode.optional())});var yv={},e0e=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),t0e=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),r0e=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&e0e(e,t,r);return t0e(e,t),e};Object.defineProperty(yv,"__esModule",{value:!0});yv.ChatRequest=void 0;const Ue=r0e(P),n0e=Lo,i0e=jf,a0e=Yu,o0e=Ba,s0e=Cf,u0e=Qu,l0e=Fo,c0e=el,d0e=Mf;yv.ChatRequest=Ue.serialization.object({message:Ue.serialization.string(),model:Ue.serialization.string().optional(),preamble:Ue.serialization.string().optional(),chatHistory:Ue.serialization.property("chat_history",Ue.serialization.list(n0e.Message).optional()),conversationId:Ue.serialization.property("conversation_id",Ue.serialization.string().optional()),promptTruncation:Ue.serialization.property("prompt_truncation",i0e.ChatRequestPromptTruncation.optional()),connectors:Ue.serialization.list(a0e.ChatConnector).optional(),searchQueriesOnly:Ue.serialization.property("search_queries_only",Ue.serialization.boolean().optional()),documents:Ue.serialization.list(o0e.ChatDocument).optional(),citationQuality:Ue.serialization.property("citation_quality",s0e.ChatRequestCitationQuality.optional()),temperature:Ue.serialization.number().optional(),maxTokens:Ue.serialization.property("max_tokens",Ue.serialization.number().optional()),maxInputTokens:Ue.serialization.property("max_input_tokens",Ue.serialization.number().optional()),k:Ue.serialization.number().optional(),p:Ue.serialization.number().optional(),seed:Ue.serialization.number().optional(),stopSequences:Ue.serialization.property("stop_sequences",Ue.serialization.list(Ue.serialization.string()).optional()),frequencyPenalty:Ue.serialization.property("frequency_penalty",Ue.serialization.number().optional()),presencePenalty:Ue.serialization.property("presence_penalty",Ue.serialization.number().optional()),rawPrompting:Ue.serialization.property("raw_prompting",Ue.serialization.boolean().optional()),returnPrompt:Ue.serialization.property("return_prompt",Ue.serialization.boolean().optional()),tools:Ue.serialization.list(u0e.Tool).optional(),toolResults:Ue.serialization.property("tool_results",Ue.serialization.list(l0e.ToolResult).optional()),forceSingleStep:Ue.serialization.property("force_single_step",Ue.serialization.boolean().optional()),responseFormat:Ue.serialization.property("response_format",c0e.ResponseFormat.optional()),safetyMode:Ue.serialization.property("safety_mode",d0e.ChatRequestSafetyMode.optional())});var bv={},f0e=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),h0e=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),p0e=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&f0e(e,t,r);return h0e(e,t),e};Object.defineProperty(bv,"__esModule",{value:!0});bv.GenerateStreamRequest=void 0;const yt=p0e(P),_0e=Tf,y0e=Rf;bv.GenerateStreamRequest=yt.serialization.object({prompt:yt.serialization.string(),model:yt.serialization.string().optional(),numGenerations:yt.serialization.property("num_generations",yt.serialization.number().optional()),maxTokens:yt.serialization.property("max_tokens",yt.serialization.number().optional()),truncate:_0e.GenerateStreamRequestTruncate.optional(),temperature:yt.serialization.number().optional(),seed:yt.serialization.number().optional(),preset:yt.serialization.string().optional(),endSequences:yt.serialization.property("end_sequences",yt.serialization.list(yt.serialization.string()).optional()),stopSequences:yt.serialization.property("stop_sequences",yt.serialization.list(yt.serialization.string()).optional()),k:yt.serialization.number().optional(),p:yt.serialization.number().optional(),frequencyPenalty:yt.serialization.property("frequency_penalty",yt.serialization.number().optional()),presencePenalty:yt.serialization.property("presence_penalty",yt.serialization.number().optional()),returnLikelihoods:yt.serialization.property("return_likelihoods",y0e.GenerateStreamRequestReturnLikelihoods.optional()),rawPrompting:yt.serialization.property("raw_prompting",yt.serialization.boolean().optional())});var gv={},b0e=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),g0e=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),m0e=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&b0e(e,t,r);return g0e(e,t),e};Object.defineProperty(gv,"__esModule",{value:!0});gv.GenerateRequest=void 0;const bt=m0e(P),v0e=Af,w0e=$f;gv.GenerateRequest=bt.serialization.object({prompt:bt.serialization.string(),model:bt.serialization.string().optional(),numGenerations:bt.serialization.property("num_generations",bt.serialization.number().optional()),maxTokens:bt.serialization.property("max_tokens",bt.serialization.number().optional()),truncate:v0e.GenerateRequestTruncate.optional(),temperature:bt.serialization.number().optional(),seed:bt.serialization.number().optional(),preset:bt.serialization.string().optional(),endSequences:bt.serialization.property("end_sequences",bt.serialization.list(bt.serialization.string()).optional()),stopSequences:bt.serialization.property("stop_sequences",bt.serialization.list(bt.serialization.string()).optional()),k:bt.serialization.number().optional(),p:bt.serialization.number().optional(),frequencyPenalty:bt.serialization.property("frequency_penalty",bt.serialization.number().optional()),presencePenalty:bt.serialization.property("presence_penalty",bt.serialization.number().optional()),returnLikelihoods:bt.serialization.property("return_likelihoods",w0e.GenerateRequestReturnLikelihoods.optional()),rawPrompting:bt.serialization.property("raw_prompting",bt.serialization.boolean().optional())});var mv={},O0e=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),S0e=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),E0e=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&O0e(e,t,r);return S0e(e,t),e};Object.defineProperty(mv,"__esModule",{value:!0});mv.EmbedRequest=void 0;const Oi=E0e(P),P0e=zo,j0e=Bo,C0e=If;mv.EmbedRequest=Oi.serialization.object({texts:Oi.serialization.list(Oi.serialization.string()).optional(),images:Oi.serialization.list(Oi.serialization.string()).optional(),model:Oi.serialization.string().optional(),inputType:Oi.serialization.property("input_type",P0e.EmbedInputType.optional()),embeddingTypes:Oi.serialization.property("embedding_types",Oi.serialization.list(j0e.EmbeddingType).optional()),truncate:C0e.EmbedRequestTruncate.optional()});var vv={},M0e=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),T0e=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),R0e=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&M0e(e,t,r);return T0e(e,t),e};Object.defineProperty(vv,"__esModule",{value:!0});vv.RerankRequest=void 0;const Ur=R0e(P),A0e=zf;vv.RerankRequest=Ur.serialization.object({model:Ur.serialization.string().optional(),query:Ur.serialization.string(),documents:Ur.serialization.list(A0e.RerankRequestDocumentsItem),topN:Ur.serialization.property("top_n",Ur.serialization.number().optional()),rankFields:Ur.serialization.property("rank_fields",Ur.serialization.list(Ur.serialization.string()).optional()),returnDocuments:Ur.serialization.property("return_documents",Ur.serialization.boolean().optional()),maxChunksPerDoc:Ur.serialization.property("max_chunks_per_doc",Ur.serialization.number().optional())});var wv={},$0e=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),I0e=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),x0e=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&$0e(e,t,r);return I0e(e,t),e};Object.defineProperty(wv,"__esModule",{value:!0});wv.ClassifyRequest=void 0;const ys=x0e(P),D0e=rp,N0e=Lf;wv.ClassifyRequest=ys.serialization.object({inputs:ys.serialization.list(ys.serialization.string()),examples:ys.serialization.list(D0e.ClassifyExample).optional(),model:ys.serialization.string().optional(),preset:ys.serialization.string().optional(),truncate:N0e.ClassifyRequestTruncate.optional()});var Ov={},z0e=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),B0e=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),U0e=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&z0e(e,t,r);return B0e(e,t),e};Object.defineProperty(Ov,"__esModule",{value:!0});Ov.SummarizeRequest=void 0;const bs=U0e(P),F0e=qf,L0e=Gf,V0e=Wf;Ov.SummarizeRequest=bs.serialization.object({text:bs.serialization.string(),length:F0e.SummarizeRequestLength.optional(),format:L0e.SummarizeRequestFormat.optional(),model:bs.serialization.string().optional(),extractiveness:V0e.SummarizeRequestExtractiveness.optional(),temperature:bs.serialization.number().optional(),additionalCommand:bs.serialization.property("additional_command",bs.serialization.string().optional())});var Sv={},k0e=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),H0e=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),q0e=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&k0e(e,t,r);return H0e(e,t),e};Object.defineProperty(Sv,"__esModule",{value:!0});Sv.TokenizeRequest=void 0;const _O=q0e(P);Sv.TokenizeRequest=_O.serialization.object({text:_O.serialization.string(),model:_O.serialization.string()});var Ev={},G0e=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),W0e=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),K0e=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&G0e(e,t,r);return W0e(e,t),e};Object.defineProperty(Ev,"__esModule",{value:!0});Ev.DetokenizeRequest=void 0;const C_=K0e(P);Ev.DetokenizeRequest=C_.serialization.object({tokens:C_.serialization.list(C_.serialization.number()),model:C_.serialization.string()});(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.DetokenizeRequest=t.TokenizeRequest=t.SummarizeRequest=t.ClassifyRequest=t.RerankRequest=t.EmbedRequest=t.GenerateRequest=t.GenerateStreamRequest=t.ChatRequest=t.ChatStreamRequest=void 0;var e=_v;Object.defineProperty(t,"ChatStreamRequest",{enumerable:!0,get:function(){return e.ChatStreamRequest}});var r=yv;Object.defineProperty(t,"ChatRequest",{enumerable:!0,get:function(){return r.ChatRequest}});var n=bv;Object.defineProperty(t,"GenerateStreamRequest",{enumerable:!0,get:function(){return n.GenerateStreamRequest}});var i=gv;Object.defineProperty(t,"GenerateRequest",{enumerable:!0,get:function(){return i.GenerateRequest}});var a=mv;Object.defineProperty(t,"EmbedRequest",{enumerable:!0,get:function(){return a.EmbedRequest}});var o=vv;Object.defineProperty(t,"RerankRequest",{enumerable:!0,get:function(){return o.RerankRequest}});var s=wv;Object.defineProperty(t,"ClassifyRequest",{enumerable:!0,get:function(){return s.ClassifyRequest}});var l=Ov;Object.defineProperty(t,"SummarizeRequest",{enumerable:!0,get:function(){return l.SummarizeRequest}});var c=Sv;Object.defineProperty(t,"TokenizeRequest",{enumerable:!0,get:function(){return c.TokenizeRequest}});var d=Ev;Object.defineProperty(t,"DetokenizeRequest",{enumerable:!0,get:function(){return d.DetokenizeRequest}})})(ML);(function(t){var e=u&&u.__createBinding||(Object.create?function(n,i,a,o){o===void 0&&(o=a);var s=Object.getOwnPropertyDescriptor(i,a);(!s||("get"in s?!i.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return i[a]}}),Object.defineProperty(n,o,s)}:function(n,i,a,o){o===void 0&&(o=a),n[o]=i[a]}),r=u&&u.__exportStar||function(n,i){for(var a in n)a!=="default"&&!Object.prototype.hasOwnProperty.call(i,a)&&e(i,n,a)};Object.defineProperty(t,"__esModule",{value:!0}),r(ML,t)})(CL);(function(t){var e=u&&u.__createBinding||(Object.create?function(n,i,a,o){o===void 0&&(o=a);var s=Object.getOwnPropertyDescriptor(i,a);(!s||("get"in s?!i.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return i[a]}}),Object.defineProperty(n,o,s)}:function(n,i,a,o){o===void 0&&(o=a),n[o]=i[a]}),r=u&&u.__exportStar||function(n,i){for(var a in n)a!=="default"&&!Object.prototype.hasOwnProperty.call(i,a)&&e(i,n,a)};Object.defineProperty(t,"__esModule",{value:!0}),r(pL,t),r(jL,t),r(CL,t)})(Gi);(function(t){var e={},r=u&&u.__createBinding||(Object.create?function(k,ee,X,te){te===void 0&&(te=X);var I=Object.getOwnPropertyDescriptor(ee,X);(!I||("get"in I?!ee.__esModule:I.writable||I.configurable))&&(I={enumerable:!0,get:function(){return ee[X]}}),Object.defineProperty(k,te,I)}:function(k,ee,X,te){te===void 0&&(te=X),k[te]=ee[X]}),n=u&&u.__setModuleDefault||(Object.create?function(k,ee){Object.defineProperty(k,"default",{enumerable:!0,value:ee})}:function(k,ee){k.default=ee}),i=u&&u.__importStar||function(k){if(k&&k.__esModule)return k;var ee={};if(k!=null)for(var X in k)X!=="default"&&Object.prototype.hasOwnProperty.call(k,X)&&r(ee,k,X);return n(ee,k),ee},a=u&&u.__awaiter||function(k,ee,X,te){function I(x){return x instanceof X?x:new X(function(A){A(x)})}return new(X||(X=Promise))(function(x,A){function V(H){try{J(te.next(H))}catch(Y){A(Y)}}function G(H){try{J(te.throw(H))}catch(Y){A(Y)}}function J(H){H.done?x(H.value):I(H.value).then(V,G)}J((te=te.apply(k,ee||[])).next())})},o=u&&u.__asyncValues||function(k){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var ee=k[Symbol.asyncIterator],X;return ee?ee.call(k):(k=typeof __values=="function"?__values(k):k[Symbol.iterator](),X={},te("next"),te("throw"),te("return"),X[Symbol.asyncIterator]=function(){return this},X);function te(x){X[x]=k[x]&&function(A){return new Promise(function(V,G){A=k[x](A),I(V,G,A.done,A.value)})}}function I(x,A,V,G){Promise.resolve(G).then(function(J){x({value:J,done:V})},A)}};Object.defineProperty(t,"__esModule",{value:!0}),t.fetchOverride=t.parseAWSEvent=t.getAuthHeaders=t.getUrl=t.mapResponseFromBedrock=void 0;const s=s5,l=yW,c=SW,d=LK,f=$y,h=P,p=Oo,b=cn,g=i(Gi),v=(k,ee)=>a(void 0,void 0,void 0,function*(){const X=Object.assign({},e);try{return k(),yield ee()}finally{e=X}}),E={1:{chat:g.StreamedChatResponse,generate:g.GenerateStreamedResponse},2:{chat:g.StreamedChatResponseV2,generate:g.GenerateStreamedResponse}},C={1:{chat:g.NonStreamedChatResponse,embed:g.EmbedResponse,generate:g.Generation,rerank:g.RerankResponse},2:{chat:g.ChatResponse,embed:g.EmbedByTypeResponse,generate:g.Generation,rerank:g.V2RerankResponse}},S=(k,ee,X,te)=>a(void 0,void 0,void 0,function*(){const I=k?E[X][ee]:C[X][ee],x={unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0,skipValidation:!0,breadcrumbsPrefix:["response"]},A=yield I.parseOrThrow(te,x);return I.jsonOrThrow(A,x)});t.mapResponseFromBedrock=S;const N=(k,ee,X,te)=>{const I={bedrock:te?"invoke-with-response-stream":"invoke",sagemaker:te?"invocations-response-stream":"invocations"}[k];return{bedrock:`https://${k}-runtime.${ee}.amazonaws.com/model/${X}/${I}`,sagemaker:`https://runtime.sagemaker.${ee}.amazonaws.com/endpoints/${X}/${I}`}[k]};t.getUrl=N;const D=(k,ee,X,te,I,x)=>a(void 0,void 0,void 0,function*(){const A=(0,l.fromNodeProviderChain)(),V=yield v(()=>{x.awsAccessKey&&(e.AWS_ACCESS_KEY_ID=x.awsAccessKey),x.awsSecretKey&&(e.AWS_SECRET_ACCESS_KEY=x.awsSecretKey),x.awsSessionToken&&(e.AWS_SESSION_TOKEN=x.awsSessionToken)},()=>A()),G=new d.SignatureV4({service:I,region:x.awsRegion,credentials:V,sha256:s.Sha256});delete X.connection,X.host=k.hostname;const J=new c.HttpRequest({method:ee.toUpperCase(),protocol:k.protocol,path:k.pathname,headers:X,body:te});return(yield G.sign(J)).headers});t.getAuthHeaders=D;const Z=k=>{const ee=/{[^\}]*}/,X=k.match(ee);if(X?.[0]){const te=JSON.parse(X[0]);if(te.bytes){const I=Buffer.from(te.bytes,"base64").toString("utf-8"),x=JSON.parse(I);if(x.event_type)return x}}};t.parseAWSEvent=Z;const se=k=>({v1:1,v2:2})[k]||1,re=(k,{awsRegion:ee,awsAccessKey:X,awsSecretKey:te,awsSessionToken:I})=>x=>a(void 0,void 0,void 0,function*(){var A,V;const G=x.url.split("/"),J=G.pop(),H=se(G.pop()),Y=x.body;console.assert(Y.model,"model is required");const Q=!!Y.stream,le=(0,t.getUrl)(k,ee,Y.model,Q);J==="rerank"&&(Y.api_version=H),delete Y.stream,delete Y.model,delete x.headers.Authorization,x.headers.Host=new URL(le).hostname;const ne=yield(0,t.getAuthHeaders)(new URL(le),x.method,x.headers,JSON.stringify(Y),k,{awsRegion:ee,awsAccessKey:X,awsSecretKey:te,awsSessionToken:I});x.url=le,x.headers=ne;const Ce=yield(0,h.fetcher)(x);if(!Ce.ok)return Ce;try{if(Q){const U=(0,p.readableStreamAsyncIterable)(Ce.body),ie=new b.LineDecoder,F=new f.PassThrough;try{for(var Te=o(U),Qe;Qe=yield Te.next(),!Qe.done;){const W=Qe.value;for(const de of ie.decode(W)){const Se=(0,t.parseAWSEvent)(de);if(Se){const T=yield(0,t.mapResponseFromBedrock)(Q,J,H,Se);F.push(JSON.stringify(T)+`
`)}}}}catch(W){A={error:W}}finally{try{Qe&&!Qe.done&&(V=Te.return)&&(yield V.call(Te))}finally{if(A)throw A.error}}for(const W of ie.flush()){const de=(0,t.parseAWSEvent)(W);if(de){const Se=yield(0,t.mapResponseFromBedrock)(Q,J,H,de);F.push(JSON.stringify(Se)+`
`)}}return F.end(),{ok:!0,body:F}}else{const U=yield Ce.body;return{ok:!0,body:yield(0,t.mapResponseFromBedrock)(Q,J,H,U)}}}catch(U){throw U}});t.fetchOverride=re})(EP);var dp={},sl={},Ln={};Object.defineProperty(Ln,"__esModule",{value:!0});Ln.CohereEnvironment=void 0;Ln.CohereEnvironment={Production:"https://api.cohere.com"};var TL={exports:{}};(function(t){(function(e,r,n){t.exports?t.exports=n():r[e]=n()})("urljoin",u,function(){function e(r){var n=[];if(r.length===0)return"";if(typeof r[0]!="string")throw new TypeError("Url must be a string. Received "+r[0]);if(r[0].match(/^[^/:]+:\/*$/)&&r.length>1){var i=r.shift();r[0]=i+r[0]}r[0].match(/^file:\/\/\//)?r[0]=r[0].replace(/^([^/:]+):\/*/,"$1:///"):r[0]=r[0].replace(/^([^/:]+):\/*/,"$1://");for(var a=0;a<r.length;a++){var o=r[a];if(typeof o!="string")throw new TypeError("Url must be a string. Received "+o);o!==""&&(a>0&&(o=o.replace(/^[\/]+/,"")),a<r.length-1?o=o.replace(/[\/]+$/,""):o=o.replace(/[\/]+$/,"/"),n.push(o))}var s=n.join("/");s=s.replace(/\/(\?|&|#[^!])/g,"$1");var l=s.split("?");return s=l.shift()+(l.length>0?"?":"")+l.join("&"),s}return function(){var r;return typeof arguments[0]=="object"?r=arguments[0]:r=[].slice.call(arguments),e(r)}})})(TL);var Ho=TL.exports,fp={},J0e={},X0e=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Z0e=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),hp=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&X0e(e,t,r);return Z0e(e,t),e},gs=u&&u.__awaiter||function(t,e,r,n){function i(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function s(d){try{c(n.next(d))}catch(f){o(f)}}function l(d){try{c(n.throw(d))}catch(f){o(f)}}function c(d){d.done?a(d.value):i(d.value).then(s,l)}c((n=n.apply(t,e||[])).next())})},Y0e=u&&u.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(fp,"__esModule",{value:!0});fp.V2=void 0;const M_=hp(Ln),pt=hp(P),Pe=hp(Vi),ua=hp(Gi),T_=Y0e(Ho),Jt=hp(Rt);class Q0e{constructor(e={}){this._options=e}chatStream(e,r){var n,i;return gs(this,void 0,void 0,function*(){const a=yield((n=this._options.fetcher)!==null&&n!==void 0?n:pt.fetcher)({url:(0,T_.default)((i=yield pt.Supplier.get(this._options.environment))!==null&&i!==void 0?i:M_.CohereEnvironment.Production,"v2/chat"),method:"POST",headers:Object.assign({Authorization:yield this._getAuthorizationHeader(),"X-Client-Name":(yield pt.Supplier.get(this._options.clientName))!=null?yield pt.Supplier.get(this._options.clientName):void 0,"X-Fern-Language":"JavaScript","X-Fern-SDK-Name":"cohere-ai","X-Fern-SDK-Version":"7.16.0","User-Agent":"cohere-ai/7.16.0","X-Fern-Runtime":pt.RUNTIME.type,"X-Fern-Runtime-Version":pt.RUNTIME.version},r?.headers),contentType:"application/json",requestType:"json",body:Object.assign(Object.assign({},ua.V2ChatStreamRequest.jsonOrThrow(e,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0})),{stream:!0}),responseType:"sse",timeoutMs:r?.timeoutInSeconds!=null?r.timeoutInSeconds*1e3:3e5,maxRetries:r?.maxRetries,abortSignal:r?.abortSignal});if(a.ok)return new pt.Stream({stream:a.body,parse:o=>gs(this,void 0,void 0,function*(){return ua.StreamedChatResponseV2.parseOrThrow(o,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0,skipValidation:!0,breadcrumbsPrefix:["response"]})}),signal:r?.abortSignal,eventShape:{type:"sse",streamTerminator:"[DONE]"}});if(a.error.reason==="status-code")switch(a.error.statusCode){case 400:throw new Pe.BadRequestError(a.error.body);case 401:throw new Pe.UnauthorizedError(a.error.body);case 403:throw new Pe.ForbiddenError(a.error.body);case 404:throw new Pe.NotFoundError(a.error.body);case 422:throw new Pe.UnprocessableEntityError(a.error.body);case 429:throw new Pe.TooManyRequestsError(a.error.body);case 498:throw new Pe.InvalidTokenError(a.error.body);case 499:throw new Pe.ClientClosedRequestError(a.error.body);case 500:throw new Pe.InternalServerError(a.error.body);case 501:throw new Pe.NotImplementedError(a.error.body);case 503:throw new Pe.ServiceUnavailableError(a.error.body);case 504:throw new Pe.GatewayTimeoutError(a.error.body);default:throw new Jt.CohereError({statusCode:a.error.statusCode,body:a.error.body})}switch(a.error.reason){case"non-json":throw new Jt.CohereError({statusCode:a.error.statusCode,body:a.error.rawBody});case"timeout":throw new Jt.CohereTimeoutError("Timeout exceeded when calling POST /v2/chat.");case"unknown":throw new Jt.CohereError({message:a.error.errorMessage})}})}chat(e,r){var n,i;return gs(this,void 0,void 0,function*(){const a=yield((n=this._options.fetcher)!==null&&n!==void 0?n:pt.fetcher)({url:(0,T_.default)((i=yield pt.Supplier.get(this._options.environment))!==null&&i!==void 0?i:M_.CohereEnvironment.Production,"v2/chat"),method:"POST",headers:Object.assign({Authorization:yield this._getAuthorizationHeader(),"X-Client-Name":(yield pt.Supplier.get(this._options.clientName))!=null?yield pt.Supplier.get(this._options.clientName):void 0,"X-Fern-Language":"JavaScript","X-Fern-SDK-Name":"cohere-ai","X-Fern-SDK-Version":"7.16.0","User-Agent":"cohere-ai/7.16.0","X-Fern-Runtime":pt.RUNTIME.type,"X-Fern-Runtime-Version":pt.RUNTIME.version},r?.headers),contentType:"application/json",requestType:"json",body:Object.assign(Object.assign({},ua.V2ChatRequest.jsonOrThrow(e,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0})),{stream:!1}),timeoutMs:r?.timeoutInSeconds!=null?r.timeoutInSeconds*1e3:3e5,maxRetries:r?.maxRetries,abortSignal:r?.abortSignal});if(a.ok)return ua.ChatResponse.parseOrThrow(a.body,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0,skipValidation:!0,breadcrumbsPrefix:["response"]});if(a.error.reason==="status-code")switch(a.error.statusCode){case 400:throw new Pe.BadRequestError(a.error.body);case 401:throw new Pe.UnauthorizedError(a.error.body);case 403:throw new Pe.ForbiddenError(a.error.body);case 404:throw new Pe.NotFoundError(a.error.body);case 422:throw new Pe.UnprocessableEntityError(a.error.body);case 429:throw new Pe.TooManyRequestsError(a.error.body);case 498:throw new Pe.InvalidTokenError(a.error.body);case 499:throw new Pe.ClientClosedRequestError(a.error.body);case 500:throw new Pe.InternalServerError(a.error.body);case 501:throw new Pe.NotImplementedError(a.error.body);case 503:throw new Pe.ServiceUnavailableError(a.error.body);case 504:throw new Pe.GatewayTimeoutError(a.error.body);default:throw new Jt.CohereError({statusCode:a.error.statusCode,body:a.error.body})}switch(a.error.reason){case"non-json":throw new Jt.CohereError({statusCode:a.error.statusCode,body:a.error.rawBody});case"timeout":throw new Jt.CohereTimeoutError("Timeout exceeded when calling POST /v2/chat.");case"unknown":throw new Jt.CohereError({message:a.error.errorMessage})}})}embed(e,r){var n,i;return gs(this,void 0,void 0,function*(){const a=yield((n=this._options.fetcher)!==null&&n!==void 0?n:pt.fetcher)({url:(0,T_.default)((i=yield pt.Supplier.get(this._options.environment))!==null&&i!==void 0?i:M_.CohereEnvironment.Production,"v2/embed"),method:"POST",headers:Object.assign({Authorization:yield this._getAuthorizationHeader(),"X-Client-Name":(yield pt.Supplier.get(this._options.clientName))!=null?yield pt.Supplier.get(this._options.clientName):void 0,"X-Fern-Language":"JavaScript","X-Fern-SDK-Name":"cohere-ai","X-Fern-SDK-Version":"7.16.0","User-Agent":"cohere-ai/7.16.0","X-Fern-Runtime":pt.RUNTIME.type,"X-Fern-Runtime-Version":pt.RUNTIME.version},r?.headers),contentType:"application/json",requestType:"json",body:ua.V2EmbedRequest.jsonOrThrow(e,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0}),timeoutMs:r?.timeoutInSeconds!=null?r.timeoutInSeconds*1e3:3e5,maxRetries:r?.maxRetries,abortSignal:r?.abortSignal});if(a.ok)return ua.EmbedByTypeResponse.parseOrThrow(a.body,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0,skipValidation:!0,breadcrumbsPrefix:["response"]});if(a.error.reason==="status-code")switch(a.error.statusCode){case 400:throw new Pe.BadRequestError(a.error.body);case 401:throw new Pe.UnauthorizedError(a.error.body);case 403:throw new Pe.ForbiddenError(a.error.body);case 404:throw new Pe.NotFoundError(a.error.body);case 422:throw new Pe.UnprocessableEntityError(a.error.body);case 429:throw new Pe.TooManyRequestsError(a.error.body);case 498:throw new Pe.InvalidTokenError(a.error.body);case 499:throw new Pe.ClientClosedRequestError(a.error.body);case 500:throw new Pe.InternalServerError(a.error.body);case 501:throw new Pe.NotImplementedError(a.error.body);case 503:throw new Pe.ServiceUnavailableError(a.error.body);case 504:throw new Pe.GatewayTimeoutError(a.error.body);default:throw new Jt.CohereError({statusCode:a.error.statusCode,body:a.error.body})}switch(a.error.reason){case"non-json":throw new Jt.CohereError({statusCode:a.error.statusCode,body:a.error.rawBody});case"timeout":throw new Jt.CohereTimeoutError("Timeout exceeded when calling POST /v2/embed.");case"unknown":throw new Jt.CohereError({message:a.error.errorMessage})}})}rerank(e,r){var n,i;return gs(this,void 0,void 0,function*(){const a=yield((n=this._options.fetcher)!==null&&n!==void 0?n:pt.fetcher)({url:(0,T_.default)((i=yield pt.Supplier.get(this._options.environment))!==null&&i!==void 0?i:M_.CohereEnvironment.Production,"v2/rerank"),method:"POST",headers:Object.assign({Authorization:yield this._getAuthorizationHeader(),"X-Client-Name":(yield pt.Supplier.get(this._options.clientName))!=null?yield pt.Supplier.get(this._options.clientName):void 0,"X-Fern-Language":"JavaScript","X-Fern-SDK-Name":"cohere-ai","X-Fern-SDK-Version":"7.16.0","User-Agent":"cohere-ai/7.16.0","X-Fern-Runtime":pt.RUNTIME.type,"X-Fern-Runtime-Version":pt.RUNTIME.version},r?.headers),contentType:"application/json",requestType:"json",body:ua.V2RerankRequest.jsonOrThrow(e,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0}),timeoutMs:r?.timeoutInSeconds!=null?r.timeoutInSeconds*1e3:3e5,maxRetries:r?.maxRetries,abortSignal:r?.abortSignal});if(a.ok)return ua.V2RerankResponse.parseOrThrow(a.body,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0,skipValidation:!0,breadcrumbsPrefix:["response"]});if(a.error.reason==="status-code")switch(a.error.statusCode){case 400:throw new Pe.BadRequestError(a.error.body);case 401:throw new Pe.UnauthorizedError(a.error.body);case 403:throw new Pe.ForbiddenError(a.error.body);case 404:throw new Pe.NotFoundError(a.error.body);case 422:throw new Pe.UnprocessableEntityError(a.error.body);case 429:throw new Pe.TooManyRequestsError(a.error.body);case 498:throw new Pe.InvalidTokenError(a.error.body);case 499:throw new Pe.ClientClosedRequestError(a.error.body);case 500:throw new Pe.InternalServerError(a.error.body);case 501:throw new Pe.NotImplementedError(a.error.body);case 503:throw new Pe.ServiceUnavailableError(a.error.body);case 504:throw new Pe.GatewayTimeoutError(a.error.body);default:throw new Jt.CohereError({statusCode:a.error.statusCode,body:a.error.body})}switch(a.error.reason){case"non-json":throw new Jt.CohereError({statusCode:a.error.statusCode,body:a.error.rawBody});case"timeout":throw new Jt.CohereTimeoutError("Timeout exceeded when calling POST /v2/rerank.");case"unknown":throw new Jt.CohereError({message:a.error.errorMessage})}})}_getAuthorizationHeader(){var e;return gs(this,void 0,void 0,function*(){const r=(e=yield pt.Supplier.get(this._options.token))!==null&&e!==void 0?e:process==null?void 0:J0e.CO_API_KEY;if(r==null)throw new Jt.CohereError({message:"Please specify CO_API_KEY when instantiating the client."});return`Bearer ${r}`})}}fp.V2=Q0e;var Pv={},eOe={},tOe=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),rOe=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),pp=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&tOe(e,t,r);return rOe(e,t),e},ql=u&&u.__awaiter||function(t,e,r,n){function i(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function s(d){try{c(n.next(d))}catch(f){o(f)}}function l(d){try{c(n.throw(d))}catch(f){o(f)}}function c(d){d.done?a(d.value):i(d.value).then(s,l)}c((n=n.apply(t,e||[])).next())})},nOe=u&&u.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Pv,"__esModule",{value:!0});Pv.EmbedJobs=void 0;const R_=pp(Ln),gt=pp(P),je=pp(Vi),A_=nOe(Ho),$_=pp(Gi),Xt=pp(Rt);class iOe{constructor(e={}){this._options=e}list(e){var r,n;return ql(this,void 0,void 0,function*(){const i=yield((r=this._options.fetcher)!==null&&r!==void 0?r:gt.fetcher)({url:(0,A_.default)((n=yield gt.Supplier.get(this._options.environment))!==null&&n!==void 0?n:R_.CohereEnvironment.Production,"v1/embed-jobs"),method:"GET",headers:Object.assign({Authorization:yield this._getAuthorizationHeader(),"X-Client-Name":(yield gt.Supplier.get(this._options.clientName))!=null?yield gt.Supplier.get(this._options.clientName):void 0,"X-Fern-Language":"JavaScript","X-Fern-SDK-Name":"cohere-ai","X-Fern-SDK-Version":"7.16.0","User-Agent":"cohere-ai/7.16.0","X-Fern-Runtime":gt.RUNTIME.type,"X-Fern-Runtime-Version":gt.RUNTIME.version},e?.headers),contentType:"application/json",requestType:"json",timeoutMs:e?.timeoutInSeconds!=null?e.timeoutInSeconds*1e3:3e5,maxRetries:e?.maxRetries,abortSignal:e?.abortSignal});if(i.ok)return $_.ListEmbedJobResponse.parseOrThrow(i.body,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0,skipValidation:!0,breadcrumbsPrefix:["response"]});if(i.error.reason==="status-code")switch(i.error.statusCode){case 400:throw new je.BadRequestError(i.error.body);case 401:throw new je.UnauthorizedError(i.error.body);case 403:throw new je.ForbiddenError(i.error.body);case 404:throw new je.NotFoundError(i.error.body);case 422:throw new je.UnprocessableEntityError(i.error.body);case 429:throw new je.TooManyRequestsError(i.error.body);case 498:throw new je.InvalidTokenError(i.error.body);case 499:throw new je.ClientClosedRequestError(i.error.body);case 500:throw new je.InternalServerError(i.error.body);case 501:throw new je.NotImplementedError(i.error.body);case 503:throw new je.ServiceUnavailableError(i.error.body);case 504:throw new je.GatewayTimeoutError(i.error.body);default:throw new Xt.CohereError({statusCode:i.error.statusCode,body:i.error.body})}switch(i.error.reason){case"non-json":throw new Xt.CohereError({statusCode:i.error.statusCode,body:i.error.rawBody});case"timeout":throw new Xt.CohereTimeoutError("Timeout exceeded when calling GET /v1/embed-jobs.");case"unknown":throw new Xt.CohereError({message:i.error.errorMessage})}})}create(e,r){var n,i;return ql(this,void 0,void 0,function*(){const a=yield((n=this._options.fetcher)!==null&&n!==void 0?n:gt.fetcher)({url:(0,A_.default)((i=yield gt.Supplier.get(this._options.environment))!==null&&i!==void 0?i:R_.CohereEnvironment.Production,"v1/embed-jobs"),method:"POST",headers:Object.assign({Authorization:yield this._getAuthorizationHeader(),"X-Client-Name":(yield gt.Supplier.get(this._options.clientName))!=null?yield gt.Supplier.get(this._options.clientName):void 0,"X-Fern-Language":"JavaScript","X-Fern-SDK-Name":"cohere-ai","X-Fern-SDK-Version":"7.16.0","User-Agent":"cohere-ai/7.16.0","X-Fern-Runtime":gt.RUNTIME.type,"X-Fern-Runtime-Version":gt.RUNTIME.version},r?.headers),contentType:"application/json",requestType:"json",body:$_.CreateEmbedJobRequest.jsonOrThrow(e,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0}),timeoutMs:r?.timeoutInSeconds!=null?r.timeoutInSeconds*1e3:3e5,maxRetries:r?.maxRetries,abortSignal:r?.abortSignal});if(a.ok)return $_.CreateEmbedJobResponse.parseOrThrow(a.body,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0,skipValidation:!0,breadcrumbsPrefix:["response"]});if(a.error.reason==="status-code")switch(a.error.statusCode){case 400:throw new je.BadRequestError(a.error.body);case 401:throw new je.UnauthorizedError(a.error.body);case 403:throw new je.ForbiddenError(a.error.body);case 404:throw new je.NotFoundError(a.error.body);case 422:throw new je.UnprocessableEntityError(a.error.body);case 429:throw new je.TooManyRequestsError(a.error.body);case 498:throw new je.InvalidTokenError(a.error.body);case 499:throw new je.ClientClosedRequestError(a.error.body);case 500:throw new je.InternalServerError(a.error.body);case 501:throw new je.NotImplementedError(a.error.body);case 503:throw new je.ServiceUnavailableError(a.error.body);case 504:throw new je.GatewayTimeoutError(a.error.body);default:throw new Xt.CohereError({statusCode:a.error.statusCode,body:a.error.body})}switch(a.error.reason){case"non-json":throw new Xt.CohereError({statusCode:a.error.statusCode,body:a.error.rawBody});case"timeout":throw new Xt.CohereTimeoutError("Timeout exceeded when calling POST /v1/embed-jobs.");case"unknown":throw new Xt.CohereError({message:a.error.errorMessage})}})}get(e,r){var n,i;return ql(this,void 0,void 0,function*(){const a=yield((n=this._options.fetcher)!==null&&n!==void 0?n:gt.fetcher)({url:(0,A_.default)((i=yield gt.Supplier.get(this._options.environment))!==null&&i!==void 0?i:R_.CohereEnvironment.Production,`v1/embed-jobs/${encodeURIComponent(e)}`),method:"GET",headers:Object.assign({Authorization:yield this._getAuthorizationHeader(),"X-Client-Name":(yield gt.Supplier.get(this._options.clientName))!=null?yield gt.Supplier.get(this._options.clientName):void 0,"X-Fern-Language":"JavaScript","X-Fern-SDK-Name":"cohere-ai","X-Fern-SDK-Version":"7.16.0","User-Agent":"cohere-ai/7.16.0","X-Fern-Runtime":gt.RUNTIME.type,"X-Fern-Runtime-Version":gt.RUNTIME.version},r?.headers),contentType:"application/json",requestType:"json",timeoutMs:r?.timeoutInSeconds!=null?r.timeoutInSeconds*1e3:3e5,maxRetries:r?.maxRetries,abortSignal:r?.abortSignal});if(a.ok)return $_.EmbedJob.parseOrThrow(a.body,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0,skipValidation:!0,breadcrumbsPrefix:["response"]});if(a.error.reason==="status-code")switch(a.error.statusCode){case 400:throw new je.BadRequestError(a.error.body);case 401:throw new je.UnauthorizedError(a.error.body);case 403:throw new je.ForbiddenError(a.error.body);case 404:throw new je.NotFoundError(a.error.body);case 422:throw new je.UnprocessableEntityError(a.error.body);case 429:throw new je.TooManyRequestsError(a.error.body);case 498:throw new je.InvalidTokenError(a.error.body);case 499:throw new je.ClientClosedRequestError(a.error.body);case 500:throw new je.InternalServerError(a.error.body);case 501:throw new je.NotImplementedError(a.error.body);case 503:throw new je.ServiceUnavailableError(a.error.body);case 504:throw new je.GatewayTimeoutError(a.error.body);default:throw new Xt.CohereError({statusCode:a.error.statusCode,body:a.error.body})}switch(a.error.reason){case"non-json":throw new Xt.CohereError({statusCode:a.error.statusCode,body:a.error.rawBody});case"timeout":throw new Xt.CohereTimeoutError("Timeout exceeded when calling GET /v1/embed-jobs/{id}.");case"unknown":throw new Xt.CohereError({message:a.error.errorMessage})}})}cancel(e,r){var n,i;return ql(this,void 0,void 0,function*(){const a=yield((n=this._options.fetcher)!==null&&n!==void 0?n:gt.fetcher)({url:(0,A_.default)((i=yield gt.Supplier.get(this._options.environment))!==null&&i!==void 0?i:R_.CohereEnvironment.Production,`v1/embed-jobs/${encodeURIComponent(e)}/cancel`),method:"POST",headers:Object.assign({Authorization:yield this._getAuthorizationHeader(),"X-Client-Name":(yield gt.Supplier.get(this._options.clientName))!=null?yield gt.Supplier.get(this._options.clientName):void 0,"X-Fern-Language":"JavaScript","X-Fern-SDK-Name":"cohere-ai","X-Fern-SDK-Version":"7.16.0","User-Agent":"cohere-ai/7.16.0","X-Fern-Runtime":gt.RUNTIME.type,"X-Fern-Runtime-Version":gt.RUNTIME.version},r?.headers),contentType:"application/json",requestType:"json",timeoutMs:r?.timeoutInSeconds!=null?r.timeoutInSeconds*1e3:3e5,maxRetries:r?.maxRetries,abortSignal:r?.abortSignal});if(!a.ok){if(a.error.reason==="status-code")switch(a.error.statusCode){case 400:throw new je.BadRequestError(a.error.body);case 401:throw new je.UnauthorizedError(a.error.body);case 403:throw new je.ForbiddenError(a.error.body);case 404:throw new je.NotFoundError(a.error.body);case 422:throw new je.UnprocessableEntityError(a.error.body);case 429:throw new je.TooManyRequestsError(a.error.body);case 498:throw new je.InvalidTokenError(a.error.body);case 499:throw new je.ClientClosedRequestError(a.error.body);case 500:throw new je.InternalServerError(a.error.body);case 501:throw new je.NotImplementedError(a.error.body);case 503:throw new je.ServiceUnavailableError(a.error.body);case 504:throw new je.GatewayTimeoutError(a.error.body);default:throw new Xt.CohereError({statusCode:a.error.statusCode,body:a.error.body})}switch(a.error.reason){case"non-json":throw new Xt.CohereError({statusCode:a.error.statusCode,body:a.error.rawBody});case"timeout":throw new Xt.CohereTimeoutError("Timeout exceeded when calling POST /v1/embed-jobs/{id}/cancel.");case"unknown":throw new Xt.CohereError({message:a.error.errorMessage})}}})}_getAuthorizationHeader(){var e;return ql(this,void 0,void 0,function*(){const r=(e=yield gt.Supplier.get(this._options.token))!==null&&e!==void 0?e:process==null?void 0:eOe.CO_API_KEY;if(r==null)throw new Xt.CohereError({message:"Please specify CO_API_KEY when instantiating the client."});return`Bearer ${r}`})}}Pv.EmbedJobs=iOe;var jv={},aOe={},oOe=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),sOe=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),_p=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&oOe(e,t,r);return sOe(e,t),e},ms=u&&u.__awaiter||function(t,e,r,n){function i(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function s(d){try{c(n.next(d))}catch(f){o(f)}}function l(d){try{c(n.throw(d))}catch(f){o(f)}}function c(d){d.done?a(d.value):i(d.value).then(s,l)}c((n=n.apply(t,e||[])).next())})},uOe=u&&u.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(jv,"__esModule",{value:!0});jv.Datasets=void 0;const Gl=_p(Ln),Ke=_p(P),ye=_p(Vi),Wl=uOe(Ho),Kl=_p(Gi),At=_p(Rt);class lOe{constructor(e={}){this._options=e}list(e={},r){var n,i;return ms(this,void 0,void 0,function*(){const{datasetType:a,before:o,after:s,limit:l,offset:c,validationStatus:d}=e,f={};a!=null&&(f.datasetType=a),o!=null&&(f.before=o.toISOString()),s!=null&&(f.after=s.toISOString()),l!=null&&(f.limit=l.toString()),c!=null&&(f.offset=c.toString()),d!=null&&(f.validationStatus=d);const h=yield((n=this._options.fetcher)!==null&&n!==void 0?n:Ke.fetcher)({url:(0,Wl.default)((i=yield Ke.Supplier.get(this._options.environment))!==null&&i!==void 0?i:Gl.CohereEnvironment.Production,"v1/datasets"),method:"GET",headers:Object.assign({Authorization:yield this._getAuthorizationHeader(),"X-Client-Name":(yield Ke.Supplier.get(this._options.clientName))!=null?yield Ke.Supplier.get(this._options.clientName):void 0,"X-Fern-Language":"JavaScript","X-Fern-SDK-Name":"cohere-ai","X-Fern-SDK-Version":"7.16.0","User-Agent":"cohere-ai/7.16.0","X-Fern-Runtime":Ke.RUNTIME.type,"X-Fern-Runtime-Version":Ke.RUNTIME.version},r?.headers),contentType:"application/json",queryParameters:f,requestType:"json",timeoutMs:r?.timeoutInSeconds!=null?r.timeoutInSeconds*1e3:3e5,maxRetries:r?.maxRetries,abortSignal:r?.abortSignal});if(h.ok)return Kl.DatasetsListResponse.parseOrThrow(h.body,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0,skipValidation:!0,breadcrumbsPrefix:["response"]});if(h.error.reason==="status-code")switch(h.error.statusCode){case 400:throw new ye.BadRequestError(h.error.body);case 401:throw new ye.UnauthorizedError(h.error.body);case 403:throw new ye.ForbiddenError(h.error.body);case 404:throw new ye.NotFoundError(h.error.body);case 422:throw new ye.UnprocessableEntityError(h.error.body);case 429:throw new ye.TooManyRequestsError(h.error.body);case 498:throw new ye.InvalidTokenError(h.error.body);case 499:throw new ye.ClientClosedRequestError(h.error.body);case 500:throw new ye.InternalServerError(h.error.body);case 501:throw new ye.NotImplementedError(h.error.body);case 503:throw new ye.ServiceUnavailableError(h.error.body);case 504:throw new ye.GatewayTimeoutError(h.error.body);default:throw new At.CohereError({statusCode:h.error.statusCode,body:h.error.body})}switch(h.error.reason){case"non-json":throw new At.CohereError({statusCode:h.error.statusCode,body:h.error.rawBody});case"timeout":throw new At.CohereTimeoutError("Timeout exceeded when calling GET /v1/datasets.");case"unknown":throw new At.CohereError({message:h.error.errorMessage})}})}create(e,r,n,i){var a,o;return ms(this,void 0,void 0,function*(){const s={};s.name=n.name,s.type=n.type,n.keepOriginalFile!=null&&(s.keep_original_file=n.keepOriginalFile.toString()),n.skipMalformedInput!=null&&(s.skip_malformed_input=n.skipMalformedInput.toString()),n.keepFields!=null&&(Array.isArray(n.keepFields)?s.keep_fields=n.keepFields.map(f=>f):s.keep_fields=n.keepFields),n.optionalFields!=null&&(Array.isArray(n.optionalFields)?s.optional_fields=n.optionalFields.map(f=>f):s.optional_fields=n.optionalFields),n.textSeparator!=null&&(s.text_separator=n.textSeparator),n.csvDelimiter!=null&&(s.csv_delimiter=n.csvDelimiter),n.dryRun!=null&&(s.dry_run=n.dryRun.toString());const l=yield Ke.newFormData();yield l.appendFile("data",e),r!=null&&(yield l.appendFile("eval_data",r));const c=yield l.getRequest(),d=yield((a=this._options.fetcher)!==null&&a!==void 0?a:Ke.fetcher)({url:(0,Wl.default)((o=yield Ke.Supplier.get(this._options.environment))!==null&&o!==void 0?o:Gl.CohereEnvironment.Production,"v1/datasets"),method:"POST",headers:Object.assign(Object.assign({Authorization:yield this._getAuthorizationHeader(),"X-Client-Name":(yield Ke.Supplier.get(this._options.clientName))!=null?yield Ke.Supplier.get(this._options.clientName):void 0,"X-Fern-Language":"JavaScript","X-Fern-SDK-Name":"cohere-ai","X-Fern-SDK-Version":"7.16.0","User-Agent":"cohere-ai/7.16.0","X-Fern-Runtime":Ke.RUNTIME.type,"X-Fern-Runtime-Version":Ke.RUNTIME.version},c.headers),i?.headers),queryParameters:s,requestType:"file",duplex:c.duplex,body:c.body,timeoutMs:i?.timeoutInSeconds!=null?i.timeoutInSeconds*1e3:3e5,maxRetries:i?.maxRetries,abortSignal:i?.abortSignal});if(d.ok)return Kl.DatasetsCreateResponse.parseOrThrow(d.body,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0,skipValidation:!0,breadcrumbsPrefix:["response"]});if(d.error.reason==="status-code")switch(d.error.statusCode){case 400:throw new ye.BadRequestError(d.error.body);case 401:throw new ye.UnauthorizedError(d.error.body);case 403:throw new ye.ForbiddenError(d.error.body);case 404:throw new ye.NotFoundError(d.error.body);case 422:throw new ye.UnprocessableEntityError(d.error.body);case 429:throw new ye.TooManyRequestsError(d.error.body);case 498:throw new ye.InvalidTokenError(d.error.body);case 499:throw new ye.ClientClosedRequestError(d.error.body);case 500:throw new ye.InternalServerError(d.error.body);case 501:throw new ye.NotImplementedError(d.error.body);case 503:throw new ye.ServiceUnavailableError(d.error.body);case 504:throw new ye.GatewayTimeoutError(d.error.body);default:throw new At.CohereError({statusCode:d.error.statusCode,body:d.error.body})}switch(d.error.reason){case"non-json":throw new At.CohereError({statusCode:d.error.statusCode,body:d.error.rawBody});case"timeout":throw new At.CohereTimeoutError("Timeout exceeded when calling POST /v1/datasets.");case"unknown":throw new At.CohereError({message:d.error.errorMessage})}})}getUsage(e){var r,n;return ms(this,void 0,void 0,function*(){const i=yield((r=this._options.fetcher)!==null&&r!==void 0?r:Ke.fetcher)({url:(0,Wl.default)((n=yield Ke.Supplier.get(this._options.environment))!==null&&n!==void 0?n:Gl.CohereEnvironment.Production,"v1/datasets/usage"),method:"GET",headers:Object.assign({Authorization:yield this._getAuthorizationHeader(),"X-Client-Name":(yield Ke.Supplier.get(this._options.clientName))!=null?yield Ke.Supplier.get(this._options.clientName):void 0,"X-Fern-Language":"JavaScript","X-Fern-SDK-Name":"cohere-ai","X-Fern-SDK-Version":"7.16.0","User-Agent":"cohere-ai/7.16.0","X-Fern-Runtime":Ke.RUNTIME.type,"X-Fern-Runtime-Version":Ke.RUNTIME.version},e?.headers),contentType:"application/json",requestType:"json",timeoutMs:e?.timeoutInSeconds!=null?e.timeoutInSeconds*1e3:3e5,maxRetries:e?.maxRetries,abortSignal:e?.abortSignal});if(i.ok)return Kl.DatasetsGetUsageResponse.parseOrThrow(i.body,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0,skipValidation:!0,breadcrumbsPrefix:["response"]});if(i.error.reason==="status-code")switch(i.error.statusCode){case 400:throw new ye.BadRequestError(i.error.body);case 401:throw new ye.UnauthorizedError(i.error.body);case 403:throw new ye.ForbiddenError(i.error.body);case 404:throw new ye.NotFoundError(i.error.body);case 422:throw new ye.UnprocessableEntityError(i.error.body);case 429:throw new ye.TooManyRequestsError(i.error.body);case 498:throw new ye.InvalidTokenError(i.error.body);case 499:throw new ye.ClientClosedRequestError(i.error.body);case 500:throw new ye.InternalServerError(i.error.body);case 501:throw new ye.NotImplementedError(i.error.body);case 503:throw new ye.ServiceUnavailableError(i.error.body);case 504:throw new ye.GatewayTimeoutError(i.error.body);default:throw new At.CohereError({statusCode:i.error.statusCode,body:i.error.body})}switch(i.error.reason){case"non-json":throw new At.CohereError({statusCode:i.error.statusCode,body:i.error.rawBody});case"timeout":throw new At.CohereTimeoutError("Timeout exceeded when calling GET /v1/datasets/usage.");case"unknown":throw new At.CohereError({message:i.error.errorMessage})}})}get(e,r){var n,i;return ms(this,void 0,void 0,function*(){const a=yield((n=this._options.fetcher)!==null&&n!==void 0?n:Ke.fetcher)({url:(0,Wl.default)((i=yield Ke.Supplier.get(this._options.environment))!==null&&i!==void 0?i:Gl.CohereEnvironment.Production,`v1/datasets/${encodeURIComponent(e)}`),method:"GET",headers:Object.assign({Authorization:yield this._getAuthorizationHeader(),"X-Client-Name":(yield Ke.Supplier.get(this._options.clientName))!=null?yield Ke.Supplier.get(this._options.clientName):void 0,"X-Fern-Language":"JavaScript","X-Fern-SDK-Name":"cohere-ai","X-Fern-SDK-Version":"7.16.0","User-Agent":"cohere-ai/7.16.0","X-Fern-Runtime":Ke.RUNTIME.type,"X-Fern-Runtime-Version":Ke.RUNTIME.version},r?.headers),contentType:"application/json",requestType:"json",timeoutMs:r?.timeoutInSeconds!=null?r.timeoutInSeconds*1e3:3e5,maxRetries:r?.maxRetries,abortSignal:r?.abortSignal});if(a.ok)return Kl.DatasetsGetResponse.parseOrThrow(a.body,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0,skipValidation:!0,breadcrumbsPrefix:["response"]});if(a.error.reason==="status-code")switch(a.error.statusCode){case 400:throw new ye.BadRequestError(a.error.body);case 401:throw new ye.UnauthorizedError(a.error.body);case 403:throw new ye.ForbiddenError(a.error.body);case 404:throw new ye.NotFoundError(a.error.body);case 422:throw new ye.UnprocessableEntityError(a.error.body);case 429:throw new ye.TooManyRequestsError(a.error.body);case 498:throw new ye.InvalidTokenError(a.error.body);case 499:throw new ye.ClientClosedRequestError(a.error.body);case 500:throw new ye.InternalServerError(a.error.body);case 501:throw new ye.NotImplementedError(a.error.body);case 503:throw new ye.ServiceUnavailableError(a.error.body);case 504:throw new ye.GatewayTimeoutError(a.error.body);default:throw new At.CohereError({statusCode:a.error.statusCode,body:a.error.body})}switch(a.error.reason){case"non-json":throw new At.CohereError({statusCode:a.error.statusCode,body:a.error.rawBody});case"timeout":throw new At.CohereTimeoutError("Timeout exceeded when calling GET /v1/datasets/{id}.");case"unknown":throw new At.CohereError({message:a.error.errorMessage})}})}delete(e,r){var n,i;return ms(this,void 0,void 0,function*(){const a=yield((n=this._options.fetcher)!==null&&n!==void 0?n:Ke.fetcher)({url:(0,Wl.default)((i=yield Ke.Supplier.get(this._options.environment))!==null&&i!==void 0?i:Gl.CohereEnvironment.Production,`v1/datasets/${encodeURIComponent(e)}`),method:"DELETE",headers:Object.assign({Authorization:yield this._getAuthorizationHeader(),"X-Client-Name":(yield Ke.Supplier.get(this._options.clientName))!=null?yield Ke.Supplier.get(this._options.clientName):void 0,"X-Fern-Language":"JavaScript","X-Fern-SDK-Name":"cohere-ai","X-Fern-SDK-Version":"7.16.0","User-Agent":"cohere-ai/7.16.0","X-Fern-Runtime":Ke.RUNTIME.type,"X-Fern-Runtime-Version":Ke.RUNTIME.version},r?.headers),contentType:"application/json",requestType:"json",timeoutMs:r?.timeoutInSeconds!=null?r.timeoutInSeconds*1e3:3e5,maxRetries:r?.maxRetries,abortSignal:r?.abortSignal});if(a.ok)return Kl.datasets.delete.Response.parseOrThrow(a.body,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0,skipValidation:!0,breadcrumbsPrefix:["response"]});if(a.error.reason==="status-code")switch(a.error.statusCode){case 400:throw new ye.BadRequestError(a.error.body);case 401:throw new ye.UnauthorizedError(a.error.body);case 403:throw new ye.ForbiddenError(a.error.body);case 404:throw new ye.NotFoundError(a.error.body);case 422:throw new ye.UnprocessableEntityError(a.error.body);case 429:throw new ye.TooManyRequestsError(a.error.body);case 498:throw new ye.InvalidTokenError(a.error.body);case 499:throw new ye.ClientClosedRequestError(a.error.body);case 500:throw new ye.InternalServerError(a.error.body);case 501:throw new ye.NotImplementedError(a.error.body);case 503:throw new ye.ServiceUnavailableError(a.error.body);case 504:throw new ye.GatewayTimeoutError(a.error.body);default:throw new At.CohereError({statusCode:a.error.statusCode,body:a.error.body})}switch(a.error.reason){case"non-json":throw new At.CohereError({statusCode:a.error.statusCode,body:a.error.rawBody});case"timeout":throw new At.CohereTimeoutError("Timeout exceeded when calling DELETE /v1/datasets/{id}.");case"unknown":throw new At.CohereError({message:a.error.errorMessage})}})}_getAuthorizationHeader(){var e;return ms(this,void 0,void 0,function*(){const r=(e=yield Ke.Supplier.get(this._options.token))!==null&&e!==void 0?e:process==null?void 0:aOe.CO_API_KEY;if(r==null)throw new At.CohereError({message:"Please specify CO_API_KEY when instantiating the client."});return`Bearer ${r}`})}}jv.Datasets=lOe;var Cv={},cOe={},dOe=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),fOe=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),yp=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&dOe(e,t,r);return fOe(e,t),e},Ya=u&&u.__awaiter||function(t,e,r,n){function i(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function s(d){try{c(n.next(d))}catch(f){o(f)}}function l(d){try{c(n.throw(d))}catch(f){o(f)}}function c(d){d.done?a(d.value):i(d.value).then(s,l)}c((n=n.apply(t,e||[])).next())})},hOe=u&&u.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Cv,"__esModule",{value:!0});Cv.Connectors=void 0;const vs=yp(Ln),ke=yp(P),ce=yp(Vi),ws=hOe(Ho),la=yp(Gi),mt=yp(Rt);class pOe{constructor(e={}){this._options=e}list(e={},r){var n,i;return Ya(this,void 0,void 0,function*(){const{limit:a,offset:o}=e,s={};a!=null&&(s.limit=a.toString()),o!=null&&(s.offset=o.toString());const l=yield((n=this._options.fetcher)!==null&&n!==void 0?n:ke.fetcher)({url:(0,ws.default)((i=yield ke.Supplier.get(this._options.environment))!==null&&i!==void 0?i:vs.CohereEnvironment.Production,"v1/connectors"),method:"GET",headers:Object.assign({Authorization:yield this._getAuthorizationHeader(),"X-Client-Name":(yield ke.Supplier.get(this._options.clientName))!=null?yield ke.Supplier.get(this._options.clientName):void 0,"X-Fern-Language":"JavaScript","X-Fern-SDK-Name":"cohere-ai","X-Fern-SDK-Version":"7.16.0","User-Agent":"cohere-ai/7.16.0","X-Fern-Runtime":ke.RUNTIME.type,"X-Fern-Runtime-Version":ke.RUNTIME.version},r?.headers),contentType:"application/json",queryParameters:s,requestType:"json",timeoutMs:r?.timeoutInSeconds!=null?r.timeoutInSeconds*1e3:3e5,maxRetries:r?.maxRetries,abortSignal:r?.abortSignal});if(l.ok)return la.ListConnectorsResponse.parseOrThrow(l.body,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0,skipValidation:!0,breadcrumbsPrefix:["response"]});if(l.error.reason==="status-code")switch(l.error.statusCode){case 400:throw new ce.BadRequestError(l.error.body);case 401:throw new ce.UnauthorizedError(l.error.body);case 403:throw new ce.ForbiddenError(l.error.body);case 404:throw new ce.NotFoundError(l.error.body);case 422:throw new ce.UnprocessableEntityError(l.error.body);case 429:throw new ce.TooManyRequestsError(l.error.body);case 498:throw new ce.InvalidTokenError(l.error.body);case 499:throw new ce.ClientClosedRequestError(l.error.body);case 500:throw new ce.InternalServerError(l.error.body);case 501:throw new ce.NotImplementedError(l.error.body);case 503:throw new ce.ServiceUnavailableError(l.error.body);case 504:throw new ce.GatewayTimeoutError(l.error.body);default:throw new mt.CohereError({statusCode:l.error.statusCode,body:l.error.body})}switch(l.error.reason){case"non-json":throw new mt.CohereError({statusCode:l.error.statusCode,body:l.error.rawBody});case"timeout":throw new mt.CohereTimeoutError("Timeout exceeded when calling GET /v1/connectors.");case"unknown":throw new mt.CohereError({message:l.error.errorMessage})}})}create(e,r){var n,i;return Ya(this,void 0,void 0,function*(){const a=yield((n=this._options.fetcher)!==null&&n!==void 0?n:ke.fetcher)({url:(0,ws.default)((i=yield ke.Supplier.get(this._options.environment))!==null&&i!==void 0?i:vs.CohereEnvironment.Production,"v1/connectors"),method:"POST",headers:Object.assign({Authorization:yield this._getAuthorizationHeader(),"X-Client-Name":(yield ke.Supplier.get(this._options.clientName))!=null?yield ke.Supplier.get(this._options.clientName):void 0,"X-Fern-Language":"JavaScript","X-Fern-SDK-Name":"cohere-ai","X-Fern-SDK-Version":"7.16.0","User-Agent":"cohere-ai/7.16.0","X-Fern-Runtime":ke.RUNTIME.type,"X-Fern-Runtime-Version":ke.RUNTIME.version},r?.headers),contentType:"application/json",requestType:"json",body:la.CreateConnectorRequest.jsonOrThrow(e,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0}),timeoutMs:r?.timeoutInSeconds!=null?r.timeoutInSeconds*1e3:3e5,maxRetries:r?.maxRetries,abortSignal:r?.abortSignal});if(a.ok)return la.CreateConnectorResponse.parseOrThrow(a.body,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0,skipValidation:!0,breadcrumbsPrefix:["response"]});if(a.error.reason==="status-code")switch(a.error.statusCode){case 400:throw new ce.BadRequestError(a.error.body);case 401:throw new ce.UnauthorizedError(a.error.body);case 403:throw new ce.ForbiddenError(a.error.body);case 404:throw new ce.NotFoundError(a.error.body);case 422:throw new ce.UnprocessableEntityError(a.error.body);case 429:throw new ce.TooManyRequestsError(a.error.body);case 498:throw new ce.InvalidTokenError(a.error.body);case 499:throw new ce.ClientClosedRequestError(a.error.body);case 500:throw new ce.InternalServerError(a.error.body);case 501:throw new ce.NotImplementedError(a.error.body);case 503:throw new ce.ServiceUnavailableError(a.error.body);case 504:throw new ce.GatewayTimeoutError(a.error.body);default:throw new mt.CohereError({statusCode:a.error.statusCode,body:a.error.body})}switch(a.error.reason){case"non-json":throw new mt.CohereError({statusCode:a.error.statusCode,body:a.error.rawBody});case"timeout":throw new mt.CohereTimeoutError("Timeout exceeded when calling POST /v1/connectors.");case"unknown":throw new mt.CohereError({message:a.error.errorMessage})}})}get(e,r){var n,i;return Ya(this,void 0,void 0,function*(){const a=yield((n=this._options.fetcher)!==null&&n!==void 0?n:ke.fetcher)({url:(0,ws.default)((i=yield ke.Supplier.get(this._options.environment))!==null&&i!==void 0?i:vs.CohereEnvironment.Production,`v1/connectors/${encodeURIComponent(e)}`),method:"GET",headers:Object.assign({Authorization:yield this._getAuthorizationHeader(),"X-Client-Name":(yield ke.Supplier.get(this._options.clientName))!=null?yield ke.Supplier.get(this._options.clientName):void 0,"X-Fern-Language":"JavaScript","X-Fern-SDK-Name":"cohere-ai","X-Fern-SDK-Version":"7.16.0","User-Agent":"cohere-ai/7.16.0","X-Fern-Runtime":ke.RUNTIME.type,"X-Fern-Runtime-Version":ke.RUNTIME.version},r?.headers),contentType:"application/json",requestType:"json",timeoutMs:r?.timeoutInSeconds!=null?r.timeoutInSeconds*1e3:3e5,maxRetries:r?.maxRetries,abortSignal:r?.abortSignal});if(a.ok)return la.GetConnectorResponse.parseOrThrow(a.body,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0,skipValidation:!0,breadcrumbsPrefix:["response"]});if(a.error.reason==="status-code")switch(a.error.statusCode){case 400:throw new ce.BadRequestError(a.error.body);case 401:throw new ce.UnauthorizedError(a.error.body);case 403:throw new ce.ForbiddenError(a.error.body);case 404:throw new ce.NotFoundError(a.error.body);case 422:throw new ce.UnprocessableEntityError(a.error.body);case 429:throw new ce.TooManyRequestsError(a.error.body);case 498:throw new ce.InvalidTokenError(a.error.body);case 499:throw new ce.ClientClosedRequestError(a.error.body);case 500:throw new ce.InternalServerError(a.error.body);case 501:throw new ce.NotImplementedError(a.error.body);case 503:throw new ce.ServiceUnavailableError(a.error.body);case 504:throw new ce.GatewayTimeoutError(a.error.body);default:throw new mt.CohereError({statusCode:a.error.statusCode,body:a.error.body})}switch(a.error.reason){case"non-json":throw new mt.CohereError({statusCode:a.error.statusCode,body:a.error.rawBody});case"timeout":throw new mt.CohereTimeoutError("Timeout exceeded when calling GET /v1/connectors/{id}.");case"unknown":throw new mt.CohereError({message:a.error.errorMessage})}})}delete(e,r){var n,i;return Ya(this,void 0,void 0,function*(){const a=yield((n=this._options.fetcher)!==null&&n!==void 0?n:ke.fetcher)({url:(0,ws.default)((i=yield ke.Supplier.get(this._options.environment))!==null&&i!==void 0?i:vs.CohereEnvironment.Production,`v1/connectors/${encodeURIComponent(e)}`),method:"DELETE",headers:Object.assign({Authorization:yield this._getAuthorizationHeader(),"X-Client-Name":(yield ke.Supplier.get(this._options.clientName))!=null?yield ke.Supplier.get(this._options.clientName):void 0,"X-Fern-Language":"JavaScript","X-Fern-SDK-Name":"cohere-ai","X-Fern-SDK-Version":"7.16.0","User-Agent":"cohere-ai/7.16.0","X-Fern-Runtime":ke.RUNTIME.type,"X-Fern-Runtime-Version":ke.RUNTIME.version},r?.headers),contentType:"application/json",requestType:"json",timeoutMs:r?.timeoutInSeconds!=null?r.timeoutInSeconds*1e3:3e5,maxRetries:r?.maxRetries,abortSignal:r?.abortSignal});if(a.ok)return la.DeleteConnectorResponse.parseOrThrow(a.body,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0,skipValidation:!0,breadcrumbsPrefix:["response"]});if(a.error.reason==="status-code")switch(a.error.statusCode){case 400:throw new ce.BadRequestError(a.error.body);case 401:throw new ce.UnauthorizedError(a.error.body);case 403:throw new ce.ForbiddenError(a.error.body);case 404:throw new ce.NotFoundError(a.error.body);case 422:throw new ce.UnprocessableEntityError(a.error.body);case 429:throw new ce.TooManyRequestsError(a.error.body);case 498:throw new ce.InvalidTokenError(a.error.body);case 499:throw new ce.ClientClosedRequestError(a.error.body);case 500:throw new ce.InternalServerError(a.error.body);case 501:throw new ce.NotImplementedError(a.error.body);case 503:throw new ce.ServiceUnavailableError(a.error.body);case 504:throw new ce.GatewayTimeoutError(a.error.body);default:throw new mt.CohereError({statusCode:a.error.statusCode,body:a.error.body})}switch(a.error.reason){case"non-json":throw new mt.CohereError({statusCode:a.error.statusCode,body:a.error.rawBody});case"timeout":throw new mt.CohereTimeoutError("Timeout exceeded when calling DELETE /v1/connectors/{id}.");case"unknown":throw new mt.CohereError({message:a.error.errorMessage})}})}update(e,r={},n){var i,a;return Ya(this,void 0,void 0,function*(){const o=yield((i=this._options.fetcher)!==null&&i!==void 0?i:ke.fetcher)({url:(0,ws.default)((a=yield ke.Supplier.get(this._options.environment))!==null&&a!==void 0?a:vs.CohereEnvironment.Production,`v1/connectors/${encodeURIComponent(e)}`),method:"PATCH",headers:Object.assign({Authorization:yield this._getAuthorizationHeader(),"X-Client-Name":(yield ke.Supplier.get(this._options.clientName))!=null?yield ke.Supplier.get(this._options.clientName):void 0,"X-Fern-Language":"JavaScript","X-Fern-SDK-Name":"cohere-ai","X-Fern-SDK-Version":"7.16.0","User-Agent":"cohere-ai/7.16.0","X-Fern-Runtime":ke.RUNTIME.type,"X-Fern-Runtime-Version":ke.RUNTIME.version},n?.headers),contentType:"application/json",requestType:"json",body:la.UpdateConnectorRequest.jsonOrThrow(r,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0}),timeoutMs:n?.timeoutInSeconds!=null?n.timeoutInSeconds*1e3:3e5,maxRetries:n?.maxRetries,abortSignal:n?.abortSignal});if(o.ok)return la.UpdateConnectorResponse.parseOrThrow(o.body,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0,skipValidation:!0,breadcrumbsPrefix:["response"]});if(o.error.reason==="status-code")switch(o.error.statusCode){case 400:throw new ce.BadRequestError(o.error.body);case 401:throw new ce.UnauthorizedError(o.error.body);case 403:throw new ce.ForbiddenError(o.error.body);case 404:throw new ce.NotFoundError(o.error.body);case 422:throw new ce.UnprocessableEntityError(o.error.body);case 429:throw new ce.TooManyRequestsError(o.error.body);case 498:throw new ce.InvalidTokenError(o.error.body);case 499:throw new ce.ClientClosedRequestError(o.error.body);case 500:throw new ce.InternalServerError(o.error.body);case 501:throw new ce.NotImplementedError(o.error.body);case 503:throw new ce.ServiceUnavailableError(o.error.body);case 504:throw new ce.GatewayTimeoutError(o.error.body);default:throw new mt.CohereError({statusCode:o.error.statusCode,body:o.error.body})}switch(o.error.reason){case"non-json":throw new mt.CohereError({statusCode:o.error.statusCode,body:o.error.rawBody});case"timeout":throw new mt.CohereTimeoutError("Timeout exceeded when calling PATCH /v1/connectors/{id}.");case"unknown":throw new mt.CohereError({message:o.error.errorMessage})}})}oAuthAuthorize(e,r={},n){var i,a;return Ya(this,void 0,void 0,function*(){const{afterTokenRedirect:o}=r,s={};o!=null&&(s.after_token_redirect=o);const l=yield((i=this._options.fetcher)!==null&&i!==void 0?i:ke.fetcher)({url:(0,ws.default)((a=yield ke.Supplier.get(this._options.environment))!==null&&a!==void 0?a:vs.CohereEnvironment.Production,`v1/connectors/${encodeURIComponent(e)}/oauth/authorize`),method:"POST",headers:Object.assign({Authorization:yield this._getAuthorizationHeader(),"X-Client-Name":(yield ke.Supplier.get(this._options.clientName))!=null?yield ke.Supplier.get(this._options.clientName):void 0,"X-Fern-Language":"JavaScript","X-Fern-SDK-Name":"cohere-ai","X-Fern-SDK-Version":"7.16.0","User-Agent":"cohere-ai/7.16.0","X-Fern-Runtime":ke.RUNTIME.type,"X-Fern-Runtime-Version":ke.RUNTIME.version},n?.headers),contentType:"application/json",queryParameters:s,requestType:"json",timeoutMs:n?.timeoutInSeconds!=null?n.timeoutInSeconds*1e3:3e5,maxRetries:n?.maxRetries,abortSignal:n?.abortSignal});if(l.ok)return la.OAuthAuthorizeResponse.parseOrThrow(l.body,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0,skipValidation:!0,breadcrumbsPrefix:["response"]});if(l.error.reason==="status-code")switch(l.error.statusCode){case 400:throw new ce.BadRequestError(l.error.body);case 401:throw new ce.UnauthorizedError(l.error.body);case 403:throw new ce.ForbiddenError(l.error.body);case 404:throw new ce.NotFoundError(l.error.body);case 422:throw new ce.UnprocessableEntityError(l.error.body);case 429:throw new ce.TooManyRequestsError(l.error.body);case 498:throw new ce.InvalidTokenError(l.error.body);case 499:throw new ce.ClientClosedRequestError(l.error.body);case 500:throw new ce.InternalServerError(l.error.body);case 501:throw new ce.NotImplementedError(l.error.body);case 503:throw new ce.ServiceUnavailableError(l.error.body);case 504:throw new ce.GatewayTimeoutError(l.error.body);default:throw new mt.CohereError({statusCode:l.error.statusCode,body:l.error.body})}switch(l.error.reason){case"non-json":throw new mt.CohereError({statusCode:l.error.statusCode,body:l.error.rawBody});case"timeout":throw new mt.CohereTimeoutError("Timeout exceeded when calling POST /v1/connectors/{id}/oauth/authorize.");case"unknown":throw new mt.CohereError({message:l.error.errorMessage})}})}_getAuthorizationHeader(){var e;return Ya(this,void 0,void 0,function*(){const r=(e=yield ke.Supplier.get(this._options.token))!==null&&e!==void 0?e:process==null?void 0:cOe.CO_API_KEY;if(r==null)throw new mt.CohereError({message:"Please specify CO_API_KEY when instantiating the client."});return`Bearer ${r}`})}}Cv.Connectors=pOe;var Mv={},_Oe={},yOe=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),bOe=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),bp=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&yOe(e,t,r);return bOe(e,t),e},yO=u&&u.__awaiter||function(t,e,r,n){function i(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function s(d){try{c(n.next(d))}catch(f){o(f)}}function l(d){try{c(n.throw(d))}catch(f){o(f)}}function c(d){d.done?a(d.value):i(d.value).then(s,l)}c((n=n.apply(t,e||[])).next())})},gOe=u&&u.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Mv,"__esModule",{value:!0});Mv.Models=void 0;const GA=bp(Ln),Fr=bp(P),St=bp(Vi),WA=gOe(Ho),KA=bp(Gi),Si=bp(Rt);let mOe=class{constructor(e={}){this._options=e}get(e,r){var n,i;return yO(this,void 0,void 0,function*(){const a=yield((n=this._options.fetcher)!==null&&n!==void 0?n:Fr.fetcher)({url:(0,WA.default)((i=yield Fr.Supplier.get(this._options.environment))!==null&&i!==void 0?i:GA.CohereEnvironment.Production,`v1/models/${encodeURIComponent(e)}`),method:"GET",headers:Object.assign({Authorization:yield this._getAuthorizationHeader(),"X-Client-Name":(yield Fr.Supplier.get(this._options.clientName))!=null?yield Fr.Supplier.get(this._options.clientName):void 0,"X-Fern-Language":"JavaScript","X-Fern-SDK-Name":"cohere-ai","X-Fern-SDK-Version":"7.16.0","User-Agent":"cohere-ai/7.16.0","X-Fern-Runtime":Fr.RUNTIME.type,"X-Fern-Runtime-Version":Fr.RUNTIME.version},r?.headers),contentType:"application/json",requestType:"json",timeoutMs:r?.timeoutInSeconds!=null?r.timeoutInSeconds*1e3:3e5,maxRetries:r?.maxRetries,abortSignal:r?.abortSignal});if(a.ok)return KA.GetModelResponse.parseOrThrow(a.body,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0,skipValidation:!0,breadcrumbsPrefix:["response"]});if(a.error.reason==="status-code")switch(a.error.statusCode){case 400:throw new St.BadRequestError(a.error.body);case 401:throw new St.UnauthorizedError(a.error.body);case 403:throw new St.ForbiddenError(a.error.body);case 404:throw new St.NotFoundError(a.error.body);case 422:throw new St.UnprocessableEntityError(a.error.body);case 429:throw new St.TooManyRequestsError(a.error.body);case 498:throw new St.InvalidTokenError(a.error.body);case 499:throw new St.ClientClosedRequestError(a.error.body);case 500:throw new St.InternalServerError(a.error.body);case 501:throw new St.NotImplementedError(a.error.body);case 503:throw new St.ServiceUnavailableError(a.error.body);case 504:throw new St.GatewayTimeoutError(a.error.body);default:throw new Si.CohereError({statusCode:a.error.statusCode,body:a.error.body})}switch(a.error.reason){case"non-json":throw new Si.CohereError({statusCode:a.error.statusCode,body:a.error.rawBody});case"timeout":throw new Si.CohereTimeoutError("Timeout exceeded when calling GET /v1/models/{model}.");case"unknown":throw new Si.CohereError({message:a.error.errorMessage})}})}list(e={},r){var n,i;return yO(this,void 0,void 0,function*(){const{pageSize:a,pageToken:o,endpoint:s,defaultOnly:l}=e,c={};a!=null&&(c.page_size=a.toString()),o!=null&&(c.page_token=o),s!=null&&(c.endpoint=s),l!=null&&(c.default_only=l.toString());const d=yield((n=this._options.fetcher)!==null&&n!==void 0?n:Fr.fetcher)({url:(0,WA.default)((i=yield Fr.Supplier.get(this._options.environment))!==null&&i!==void 0?i:GA.CohereEnvironment.Production,"v1/models"),method:"GET",headers:Object.assign({Authorization:yield this._getAuthorizationHeader(),"X-Client-Name":(yield Fr.Supplier.get(this._options.clientName))!=null?yield Fr.Supplier.get(this._options.clientName):void 0,"X-Fern-Language":"JavaScript","X-Fern-SDK-Name":"cohere-ai","X-Fern-SDK-Version":"7.16.0","User-Agent":"cohere-ai/7.16.0","X-Fern-Runtime":Fr.RUNTIME.type,"X-Fern-Runtime-Version":Fr.RUNTIME.version},r?.headers),contentType:"application/json",queryParameters:c,requestType:"json",timeoutMs:r?.timeoutInSeconds!=null?r.timeoutInSeconds*1e3:3e5,maxRetries:r?.maxRetries,abortSignal:r?.abortSignal});if(d.ok)return KA.ListModelsResponse.parseOrThrow(d.body,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0,skipValidation:!0,breadcrumbsPrefix:["response"]});if(d.error.reason==="status-code")switch(d.error.statusCode){case 400:throw new St.BadRequestError(d.error.body);case 401:throw new St.UnauthorizedError(d.error.body);case 403:throw new St.ForbiddenError(d.error.body);case 404:throw new St.NotFoundError(d.error.body);case 422:throw new St.UnprocessableEntityError(d.error.body);case 429:throw new St.TooManyRequestsError(d.error.body);case 498:throw new St.InvalidTokenError(d.error.body);case 499:throw new St.ClientClosedRequestError(d.error.body);case 500:throw new St.InternalServerError(d.error.body);case 501:throw new St.NotImplementedError(d.error.body);case 503:throw new St.ServiceUnavailableError(d.error.body);case 504:throw new St.GatewayTimeoutError(d.error.body);default:throw new Si.CohereError({statusCode:d.error.statusCode,body:d.error.body})}switch(d.error.reason){case"non-json":throw new Si.CohereError({statusCode:d.error.statusCode,body:d.error.rawBody});case"timeout":throw new Si.CohereTimeoutError("Timeout exceeded when calling GET /v1/models.");case"unknown":throw new Si.CohereError({message:d.error.errorMessage})}})}_getAuthorizationHeader(){var e;return yO(this,void 0,void 0,function*(){const r=(e=yield Fr.Supplier.get(this._options.token))!==null&&e!==void 0?e:process==null?void 0:_Oe.CO_API_KEY;if(r==null)throw new Si.CohereError({message:"Please specify CO_API_KEY when instantiating the client."});return`Bearer ${r}`})}};Mv.Models=mOe;var Tv={},vOe={},wOe=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),OOe=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),gp=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&wOe(e,t,r);return OOe(e,t),e},ca=u&&u.__awaiter||function(t,e,r,n){function i(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function s(d){try{c(n.next(d))}catch(f){o(f)}}function l(d){try{c(n.throw(d))}catch(f){o(f)}}function c(d){d.done?a(d.value):i(d.value).then(s,l)}c((n=n.apply(t,e||[])).next())})},SOe=u&&u.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Tv,"__esModule",{value:!0});Tv.Finetuning=void 0;const Qa=gp(Ln),Re=gp(P),$e=gp(Vi),eo=SOe(Ho),Ei=gp(Gi),rt=gp(Rt);class EOe{constructor(e={}){this._options=e}listFinetunedModels(e={},r){var n,i;return ca(this,void 0,void 0,function*(){const{pageSize:a,pageToken:o,orderBy:s}=e,l={};a!=null&&(l.page_size=a.toString()),o!=null&&(l.page_token=o),s!=null&&(l.order_by=s);const c=yield((n=this._options.fetcher)!==null&&n!==void 0?n:Re.fetcher)({url:(0,eo.default)((i=yield Re.Supplier.get(this._options.environment))!==null&&i!==void 0?i:Qa.CohereEnvironment.Production,"v1/finetuning/finetuned-models"),method:"GET",headers:Object.assign({Authorization:yield this._getAuthorizationHeader(),"X-Client-Name":(yield Re.Supplier.get(this._options.clientName))!=null?yield Re.Supplier.get(this._options.clientName):void 0,"X-Fern-Language":"JavaScript","X-Fern-SDK-Name":"cohere-ai","X-Fern-SDK-Version":"7.16.0","User-Agent":"cohere-ai/7.16.0","X-Fern-Runtime":Re.RUNTIME.type,"X-Fern-Runtime-Version":Re.RUNTIME.version},r?.headers),contentType:"application/json",queryParameters:l,requestType:"json",timeoutMs:r?.timeoutInSeconds!=null?r.timeoutInSeconds*1e3:3e5,maxRetries:r?.maxRetries,abortSignal:r?.abortSignal});if(c.ok)return Ei.finetuning.ListFinetunedModelsResponse.parseOrThrow(c.body,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0,skipValidation:!0,breadcrumbsPrefix:["response"]});if(c.error.reason==="status-code")switch(c.error.statusCode){case 400:throw new $e.BadRequestError(c.error.body);case 401:throw new $e.UnauthorizedError(c.error.body);case 403:throw new $e.ForbiddenError(c.error.body);case 404:throw new $e.NotFoundError(c.error.body);case 500:throw new $e.InternalServerError(c.error.body);case 503:throw new $e.ServiceUnavailableError(c.error.body);default:throw new rt.CohereError({statusCode:c.error.statusCode,body:c.error.body})}switch(c.error.reason){case"non-json":throw new rt.CohereError({statusCode:c.error.statusCode,body:c.error.rawBody});case"timeout":throw new rt.CohereTimeoutError("Timeout exceeded when calling GET /v1/finetuning/finetuned-models.");case"unknown":throw new rt.CohereError({message:c.error.errorMessage})}})}createFinetunedModel(e,r){var n,i;return ca(this,void 0,void 0,function*(){const a=yield((n=this._options.fetcher)!==null&&n!==void 0?n:Re.fetcher)({url:(0,eo.default)((i=yield Re.Supplier.get(this._options.environment))!==null&&i!==void 0?i:Qa.CohereEnvironment.Production,"v1/finetuning/finetuned-models"),method:"POST",headers:Object.assign({Authorization:yield this._getAuthorizationHeader(),"X-Client-Name":(yield Re.Supplier.get(this._options.clientName))!=null?yield Re.Supplier.get(this._options.clientName):void 0,"X-Fern-Language":"JavaScript","X-Fern-SDK-Name":"cohere-ai","X-Fern-SDK-Version":"7.16.0","User-Agent":"cohere-ai/7.16.0","X-Fern-Runtime":Re.RUNTIME.type,"X-Fern-Runtime-Version":Re.RUNTIME.version},r?.headers),contentType:"application/json",requestType:"json",body:Ei.finetuning.FinetunedModel.jsonOrThrow(e,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0}),timeoutMs:r?.timeoutInSeconds!=null?r.timeoutInSeconds*1e3:3e5,maxRetries:r?.maxRetries,abortSignal:r?.abortSignal});if(a.ok)return Ei.finetuning.CreateFinetunedModelResponse.parseOrThrow(a.body,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0,skipValidation:!0,breadcrumbsPrefix:["response"]});if(a.error.reason==="status-code")switch(a.error.statusCode){case 400:throw new $e.BadRequestError(a.error.body);case 401:throw new $e.UnauthorizedError(a.error.body);case 403:throw new $e.ForbiddenError(a.error.body);case 404:throw new $e.NotFoundError(a.error.body);case 500:throw new $e.InternalServerError(a.error.body);case 503:throw new $e.ServiceUnavailableError(a.error.body);default:throw new rt.CohereError({statusCode:a.error.statusCode,body:a.error.body})}switch(a.error.reason){case"non-json":throw new rt.CohereError({statusCode:a.error.statusCode,body:a.error.rawBody});case"timeout":throw new rt.CohereTimeoutError("Timeout exceeded when calling POST /v1/finetuning/finetuned-models.");case"unknown":throw new rt.CohereError({message:a.error.errorMessage})}})}getFinetunedModel(e,r){var n,i;return ca(this,void 0,void 0,function*(){const a=yield((n=this._options.fetcher)!==null&&n!==void 0?n:Re.fetcher)({url:(0,eo.default)((i=yield Re.Supplier.get(this._options.environment))!==null&&i!==void 0?i:Qa.CohereEnvironment.Production,`v1/finetuning/finetuned-models/${encodeURIComponent(e)}`),method:"GET",headers:Object.assign({Authorization:yield this._getAuthorizationHeader(),"X-Client-Name":(yield Re.Supplier.get(this._options.clientName))!=null?yield Re.Supplier.get(this._options.clientName):void 0,"X-Fern-Language":"JavaScript","X-Fern-SDK-Name":"cohere-ai","X-Fern-SDK-Version":"7.16.0","User-Agent":"cohere-ai/7.16.0","X-Fern-Runtime":Re.RUNTIME.type,"X-Fern-Runtime-Version":Re.RUNTIME.version},r?.headers),contentType:"application/json",requestType:"json",timeoutMs:r?.timeoutInSeconds!=null?r.timeoutInSeconds*1e3:3e5,maxRetries:r?.maxRetries,abortSignal:r?.abortSignal});if(a.ok)return Ei.finetuning.GetFinetunedModelResponse.parseOrThrow(a.body,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0,skipValidation:!0,breadcrumbsPrefix:["response"]});if(a.error.reason==="status-code")switch(a.error.statusCode){case 400:throw new $e.BadRequestError(a.error.body);case 401:throw new $e.UnauthorizedError(a.error.body);case 403:throw new $e.ForbiddenError(a.error.body);case 404:throw new $e.NotFoundError(a.error.body);case 500:throw new $e.InternalServerError(a.error.body);case 503:throw new $e.ServiceUnavailableError(a.error.body);default:throw new rt.CohereError({statusCode:a.error.statusCode,body:a.error.body})}switch(a.error.reason){case"non-json":throw new rt.CohereError({statusCode:a.error.statusCode,body:a.error.rawBody});case"timeout":throw new rt.CohereTimeoutError("Timeout exceeded when calling GET /v1/finetuning/finetuned-models/{id}.");case"unknown":throw new rt.CohereError({message:a.error.errorMessage})}})}deleteFinetunedModel(e,r){var n,i;return ca(this,void 0,void 0,function*(){const a=yield((n=this._options.fetcher)!==null&&n!==void 0?n:Re.fetcher)({url:(0,eo.default)((i=yield Re.Supplier.get(this._options.environment))!==null&&i!==void 0?i:Qa.CohereEnvironment.Production,`v1/finetuning/finetuned-models/${encodeURIComponent(e)}`),method:"DELETE",headers:Object.assign({Authorization:yield this._getAuthorizationHeader(),"X-Client-Name":(yield Re.Supplier.get(this._options.clientName))!=null?yield Re.Supplier.get(this._options.clientName):void 0,"X-Fern-Language":"JavaScript","X-Fern-SDK-Name":"cohere-ai","X-Fern-SDK-Version":"7.16.0","User-Agent":"cohere-ai/7.16.0","X-Fern-Runtime":Re.RUNTIME.type,"X-Fern-Runtime-Version":Re.RUNTIME.version},r?.headers),contentType:"application/json",requestType:"json",timeoutMs:r?.timeoutInSeconds!=null?r.timeoutInSeconds*1e3:3e5,maxRetries:r?.maxRetries,abortSignal:r?.abortSignal});if(a.ok)return Ei.finetuning.DeleteFinetunedModelResponse.parseOrThrow(a.body,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0,skipValidation:!0,breadcrumbsPrefix:["response"]});if(a.error.reason==="status-code")switch(a.error.statusCode){case 400:throw new $e.BadRequestError(a.error.body);case 401:throw new $e.UnauthorizedError(a.error.body);case 403:throw new $e.ForbiddenError(a.error.body);case 404:throw new $e.NotFoundError(a.error.body);case 500:throw new $e.InternalServerError(a.error.body);case 503:throw new $e.ServiceUnavailableError(a.error.body);default:throw new rt.CohereError({statusCode:a.error.statusCode,body:a.error.body})}switch(a.error.reason){case"non-json":throw new rt.CohereError({statusCode:a.error.statusCode,body:a.error.rawBody});case"timeout":throw new rt.CohereTimeoutError("Timeout exceeded when calling DELETE /v1/finetuning/finetuned-models/{id}.");case"unknown":throw new rt.CohereError({message:a.error.errorMessage})}})}updateFinetunedModel(e,r,n){var i,a;return ca(this,void 0,void 0,function*(){const o=yield((i=this._options.fetcher)!==null&&i!==void 0?i:Re.fetcher)({url:(0,eo.default)((a=yield Re.Supplier.get(this._options.environment))!==null&&a!==void 0?a:Qa.CohereEnvironment.Production,`v1/finetuning/finetuned-models/${encodeURIComponent(e)}`),method:"PATCH",headers:Object.assign({Authorization:yield this._getAuthorizationHeader(),"X-Client-Name":(yield Re.Supplier.get(this._options.clientName))!=null?yield Re.Supplier.get(this._options.clientName):void 0,"X-Fern-Language":"JavaScript","X-Fern-SDK-Name":"cohere-ai","X-Fern-SDK-Version":"7.16.0","User-Agent":"cohere-ai/7.16.0","X-Fern-Runtime":Re.RUNTIME.type,"X-Fern-Runtime-Version":Re.RUNTIME.version},n?.headers),contentType:"application/json",requestType:"json",body:Ei.FinetuningUpdateFinetunedModelRequest.jsonOrThrow(r,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0}),timeoutMs:n?.timeoutInSeconds!=null?n.timeoutInSeconds*1e3:3e5,maxRetries:n?.maxRetries,abortSignal:n?.abortSignal});if(o.ok)return Ei.finetuning.UpdateFinetunedModelResponse.parseOrThrow(o.body,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0,skipValidation:!0,breadcrumbsPrefix:["response"]});if(o.error.reason==="status-code")switch(o.error.statusCode){case 400:throw new $e.BadRequestError(o.error.body);case 401:throw new $e.UnauthorizedError(o.error.body);case 403:throw new $e.ForbiddenError(o.error.body);case 404:throw new $e.NotFoundError(o.error.body);case 500:throw new $e.InternalServerError(o.error.body);case 503:throw new $e.ServiceUnavailableError(o.error.body);default:throw new rt.CohereError({statusCode:o.error.statusCode,body:o.error.body})}switch(o.error.reason){case"non-json":throw new rt.CohereError({statusCode:o.error.statusCode,body:o.error.rawBody});case"timeout":throw new rt.CohereTimeoutError("Timeout exceeded when calling PATCH /v1/finetuning/finetuned-models/{id}.");case"unknown":throw new rt.CohereError({message:o.error.errorMessage})}})}listEvents(e,r={},n){var i,a;return ca(this,void 0,void 0,function*(){const{pageSize:o,pageToken:s,orderBy:l}=r,c={};o!=null&&(c.page_size=o.toString()),s!=null&&(c.page_token=s),l!=null&&(c.order_by=l);const d=yield((i=this._options.fetcher)!==null&&i!==void 0?i:Re.fetcher)({url:(0,eo.default)((a=yield Re.Supplier.get(this._options.environment))!==null&&a!==void 0?a:Qa.CohereEnvironment.Production,`v1/finetuning/finetuned-models/${encodeURIComponent(e)}/events`),method:"GET",headers:Object.assign({Authorization:yield this._getAuthorizationHeader(),"X-Client-Name":(yield Re.Supplier.get(this._options.clientName))!=null?yield Re.Supplier.get(this._options.clientName):void 0,"X-Fern-Language":"JavaScript","X-Fern-SDK-Name":"cohere-ai","X-Fern-SDK-Version":"7.16.0","User-Agent":"cohere-ai/7.16.0","X-Fern-Runtime":Re.RUNTIME.type,"X-Fern-Runtime-Version":Re.RUNTIME.version},n?.headers),contentType:"application/json",queryParameters:c,requestType:"json",timeoutMs:n?.timeoutInSeconds!=null?n.timeoutInSeconds*1e3:3e5,maxRetries:n?.maxRetries,abortSignal:n?.abortSignal});if(d.ok)return Ei.finetuning.ListEventsResponse.parseOrThrow(d.body,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0,skipValidation:!0,breadcrumbsPrefix:["response"]});if(d.error.reason==="status-code")switch(d.error.statusCode){case 400:throw new $e.BadRequestError(d.error.body);case 401:throw new $e.UnauthorizedError(d.error.body);case 403:throw new $e.ForbiddenError(d.error.body);case 404:throw new $e.NotFoundError(d.error.body);case 500:throw new $e.InternalServerError(d.error.body);case 503:throw new $e.ServiceUnavailableError(d.error.body);default:throw new rt.CohereError({statusCode:d.error.statusCode,body:d.error.body})}switch(d.error.reason){case"non-json":throw new rt.CohereError({statusCode:d.error.statusCode,body:d.error.rawBody});case"timeout":throw new rt.CohereTimeoutError("Timeout exceeded when calling GET /v1/finetuning/finetuned-models/{finetuned_model_id}/events.");case"unknown":throw new rt.CohereError({message:d.error.errorMessage})}})}listTrainingStepMetrics(e,r={},n){var i,a;return ca(this,void 0,void 0,function*(){const{pageSize:o,pageToken:s}=r,l={};o!=null&&(l.page_size=o.toString()),s!=null&&(l.page_token=s);const c=yield((i=this._options.fetcher)!==null&&i!==void 0?i:Re.fetcher)({url:(0,eo.default)((a=yield Re.Supplier.get(this._options.environment))!==null&&a!==void 0?a:Qa.CohereEnvironment.Production,`v1/finetuning/finetuned-models/${encodeURIComponent(e)}/training-step-metrics`),method:"GET",headers:Object.assign({Authorization:yield this._getAuthorizationHeader(),"X-Client-Name":(yield Re.Supplier.get(this._options.clientName))!=null?yield Re.Supplier.get(this._options.clientName):void 0,"X-Fern-Language":"JavaScript","X-Fern-SDK-Name":"cohere-ai","X-Fern-SDK-Version":"7.16.0","User-Agent":"cohere-ai/7.16.0","X-Fern-Runtime":Re.RUNTIME.type,"X-Fern-Runtime-Version":Re.RUNTIME.version},n?.headers),contentType:"application/json",queryParameters:l,requestType:"json",timeoutMs:n?.timeoutInSeconds!=null?n.timeoutInSeconds*1e3:3e5,maxRetries:n?.maxRetries,abortSignal:n?.abortSignal});if(c.ok)return Ei.finetuning.ListTrainingStepMetricsResponse.parseOrThrow(c.body,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0,skipValidation:!0,breadcrumbsPrefix:["response"]});if(c.error.reason==="status-code")switch(c.error.statusCode){case 400:throw new $e.BadRequestError(c.error.body);case 401:throw new $e.UnauthorizedError(c.error.body);case 403:throw new $e.ForbiddenError(c.error.body);case 404:throw new $e.NotFoundError(c.error.body);case 500:throw new $e.InternalServerError(c.error.body);case 503:throw new $e.ServiceUnavailableError(c.error.body);default:throw new rt.CohereError({statusCode:c.error.statusCode,body:c.error.body})}switch(c.error.reason){case"non-json":throw new rt.CohereError({statusCode:c.error.statusCode,body:c.error.rawBody});case"timeout":throw new rt.CohereTimeoutError("Timeout exceeded when calling GET /v1/finetuning/finetuned-models/{finetuned_model_id}/training-step-metrics.");case"unknown":throw new rt.CohereError({message:c.error.errorMessage})}})}_getAuthorizationHeader(){var e;return ca(this,void 0,void 0,function*(){const r=(e=yield Re.Supplier.get(this._options.token))!==null&&e!==void 0?e:process==null?void 0:vOe.CO_API_KEY;if(r==null)throw new rt.CohereError({message:"Please specify CO_API_KEY when instantiating the client."});return`Bearer ${r}`})}}Tv.Finetuning=EOe;var POe={},jOe=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),COe=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),mp=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&jOe(e,t,r);return COe(e,t),e},Er=u&&u.__awaiter||function(t,e,r,n){function i(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function s(d){try{c(n.next(d))}catch(f){o(f)}}function l(d){try{c(n.throw(d))}catch(f){o(f)}}function c(d){d.done?a(d.value):i(d.value).then(s,l)}c((n=n.apply(t,e||[])).next())})},JA=u&&u.__rest||function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r},MOe=u&&u.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(sl,"__esModule",{value:!0});sl.CohereClient=void 0;const jn=mp(Ln),he=mp(P),z=mp(Vi),$t=mp(Gi),Cn=MOe(Ho),Me=mp(Rt),TOe=fp,ROe=Pv,AOe=jv,$Oe=Cv,IOe=Mv,xOe=Tv;class DOe{constructor(e={}){this._options=e}get v2(){var e;return(e=this._v2)!==null&&e!==void 0?e:this._v2=new TOe.V2(this._options)}get embedJobs(){var e;return(e=this._embedJobs)!==null&&e!==void 0?e:this._embedJobs=new ROe.EmbedJobs(this._options)}get datasets(){var e;return(e=this._datasets)!==null&&e!==void 0?e:this._datasets=new AOe.Datasets(this._options)}get connectors(){var e;return(e=this._connectors)!==null&&e!==void 0?e:this._connectors=new $Oe.Connectors(this._options)}get models(){var e;return(e=this._models)!==null&&e!==void 0?e:this._models=new IOe.Models(this._options)}get finetuning(){var e;return(e=this._finetuning)!==null&&e!==void 0?e:this._finetuning=new xOe.Finetuning(this._options)}chatStream(e,r){var n,i;return Er(this,void 0,void 0,function*(){const{accepts:a}=e,o=JA(e,["accepts"]),s=yield((n=this._options.fetcher)!==null&&n!==void 0?n:he.fetcher)({url:(0,Cn.default)((i=yield he.Supplier.get(this._options.environment))!==null&&i!==void 0?i:jn.CohereEnvironment.Production,"v1/chat"),method:"POST",headers:Object.assign({Authorization:yield this._getAuthorizationHeader(),"X-Client-Name":(yield he.Supplier.get(this._options.clientName))!=null?yield he.Supplier.get(this._options.clientName):void 0,"X-Fern-Language":"JavaScript","X-Fern-SDK-Name":"cohere-ai","X-Fern-SDK-Version":"7.16.0","User-Agent":"cohere-ai/7.16.0","X-Fern-Runtime":he.RUNTIME.type,"X-Fern-Runtime-Version":he.RUNTIME.version,Accepts:a??void 0},r?.headers),contentType:"application/json",requestType:"json",body:Object.assign(Object.assign({},$t.ChatStreamRequest.jsonOrThrow(o,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0})),{stream:!0}),responseType:"sse",timeoutMs:r?.timeoutInSeconds!=null?r.timeoutInSeconds*1e3:3e5,maxRetries:r?.maxRetries,abortSignal:r?.abortSignal});if(s.ok)return new he.Stream({stream:s.body,parse:l=>Er(this,void 0,void 0,function*(){return $t.StreamedChatResponse.parseOrThrow(l,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0,skipValidation:!0,breadcrumbsPrefix:["response"]})}),signal:r?.abortSignal,eventShape:{type:"json",messageTerminator:`
`}});if(s.error.reason==="status-code")switch(s.error.statusCode){case 400:throw new z.BadRequestError(s.error.body);case 401:throw new z.UnauthorizedError(s.error.body);case 403:throw new z.ForbiddenError(s.error.body);case 404:throw new z.NotFoundError(s.error.body);case 422:throw new z.UnprocessableEntityError(s.error.body);case 429:throw new z.TooManyRequestsError(s.error.body);case 498:throw new z.InvalidTokenError(s.error.body);case 499:throw new z.ClientClosedRequestError(s.error.body);case 500:throw new z.InternalServerError(s.error.body);case 501:throw new z.NotImplementedError(s.error.body);case 503:throw new z.ServiceUnavailableError(s.error.body);case 504:throw new z.GatewayTimeoutError(s.error.body);default:throw new Me.CohereError({statusCode:s.error.statusCode,body:s.error.body})}switch(s.error.reason){case"non-json":throw new Me.CohereError({statusCode:s.error.statusCode,body:s.error.rawBody});case"timeout":throw new Me.CohereTimeoutError("Timeout exceeded when calling POST /v1/chat.");case"unknown":throw new Me.CohereError({message:s.error.errorMessage})}})}chat(e,r){var n,i;return Er(this,void 0,void 0,function*(){const{accepts:a}=e,o=JA(e,["accepts"]),s=yield((n=this._options.fetcher)!==null&&n!==void 0?n:he.fetcher)({url:(0,Cn.default)((i=yield he.Supplier.get(this._options.environment))!==null&&i!==void 0?i:jn.CohereEnvironment.Production,"v1/chat"),method:"POST",headers:Object.assign({Authorization:yield this._getAuthorizationHeader(),"X-Client-Name":(yield he.Supplier.get(this._options.clientName))!=null?yield he.Supplier.get(this._options.clientName):void 0,"X-Fern-Language":"JavaScript","X-Fern-SDK-Name":"cohere-ai","X-Fern-SDK-Version":"7.16.0","User-Agent":"cohere-ai/7.16.0","X-Fern-Runtime":he.RUNTIME.type,"X-Fern-Runtime-Version":he.RUNTIME.version,Accepts:a??void 0},r?.headers),contentType:"application/json",requestType:"json",body:Object.assign(Object.assign({},$t.ChatRequest.jsonOrThrow(o,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0})),{stream:!1}),timeoutMs:r?.timeoutInSeconds!=null?r.timeoutInSeconds*1e3:3e5,maxRetries:r?.maxRetries,abortSignal:r?.abortSignal});if(s.ok)return $t.NonStreamedChatResponse.parseOrThrow(s.body,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0,skipValidation:!0,breadcrumbsPrefix:["response"]});if(s.error.reason==="status-code")switch(s.error.statusCode){case 400:throw new z.BadRequestError(s.error.body);case 401:throw new z.UnauthorizedError(s.error.body);case 403:throw new z.ForbiddenError(s.error.body);case 404:throw new z.NotFoundError(s.error.body);case 422:throw new z.UnprocessableEntityError(s.error.body);case 429:throw new z.TooManyRequestsError(s.error.body);case 498:throw new z.InvalidTokenError(s.error.body);case 499:throw new z.ClientClosedRequestError(s.error.body);case 500:throw new z.InternalServerError(s.error.body);case 501:throw new z.NotImplementedError(s.error.body);case 503:throw new z.ServiceUnavailableError(s.error.body);case 504:throw new z.GatewayTimeoutError(s.error.body);default:throw new Me.CohereError({statusCode:s.error.statusCode,body:s.error.body})}switch(s.error.reason){case"non-json":throw new Me.CohereError({statusCode:s.error.statusCode,body:s.error.rawBody});case"timeout":throw new Me.CohereTimeoutError("Timeout exceeded when calling POST /v1/chat.");case"unknown":throw new Me.CohereError({message:s.error.errorMessage})}})}generateStream(e,r){var n,i;return Er(this,void 0,void 0,function*(){const a=yield((n=this._options.fetcher)!==null&&n!==void 0?n:he.fetcher)({url:(0,Cn.default)((i=yield he.Supplier.get(this._options.environment))!==null&&i!==void 0?i:jn.CohereEnvironment.Production,"v1/generate"),method:"POST",headers:Object.assign({Authorization:yield this._getAuthorizationHeader(),"X-Client-Name":(yield he.Supplier.get(this._options.clientName))!=null?yield he.Supplier.get(this._options.clientName):void 0,"X-Fern-Language":"JavaScript","X-Fern-SDK-Name":"cohere-ai","X-Fern-SDK-Version":"7.16.0","User-Agent":"cohere-ai/7.16.0","X-Fern-Runtime":he.RUNTIME.type,"X-Fern-Runtime-Version":he.RUNTIME.version},r?.headers),contentType:"application/json",requestType:"json",body:Object.assign(Object.assign({},$t.GenerateStreamRequest.jsonOrThrow(e,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0})),{stream:!0}),responseType:"sse",timeoutMs:r?.timeoutInSeconds!=null?r.timeoutInSeconds*1e3:3e5,maxRetries:r?.maxRetries,abortSignal:r?.abortSignal});if(a.ok)return new he.Stream({stream:a.body,parse:o=>Er(this,void 0,void 0,function*(){return $t.GenerateStreamedResponse.parseOrThrow(o,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0,skipValidation:!0,breadcrumbsPrefix:["response"]})}),signal:r?.abortSignal,eventShape:{type:"json",messageTerminator:`
`}});if(a.error.reason==="status-code")switch(a.error.statusCode){case 400:throw new z.BadRequestError(a.error.body);case 401:throw new z.UnauthorizedError(a.error.body);case 403:throw new z.ForbiddenError(a.error.body);case 404:throw new z.NotFoundError(a.error.body);case 422:throw new z.UnprocessableEntityError(a.error.body);case 429:throw new z.TooManyRequestsError(a.error.body);case 498:throw new z.InvalidTokenError(a.error.body);case 499:throw new z.ClientClosedRequestError(a.error.body);case 500:throw new z.InternalServerError(a.error.body);case 501:throw new z.NotImplementedError(a.error.body);case 503:throw new z.ServiceUnavailableError(a.error.body);case 504:throw new z.GatewayTimeoutError(a.error.body);default:throw new Me.CohereError({statusCode:a.error.statusCode,body:a.error.body})}switch(a.error.reason){case"non-json":throw new Me.CohereError({statusCode:a.error.statusCode,body:a.error.rawBody});case"timeout":throw new Me.CohereTimeoutError("Timeout exceeded when calling POST /v1/generate.");case"unknown":throw new Me.CohereError({message:a.error.errorMessage})}})}generate(e,r){var n,i;return Er(this,void 0,void 0,function*(){const a=yield((n=this._options.fetcher)!==null&&n!==void 0?n:he.fetcher)({url:(0,Cn.default)((i=yield he.Supplier.get(this._options.environment))!==null&&i!==void 0?i:jn.CohereEnvironment.Production,"v1/generate"),method:"POST",headers:Object.assign({Authorization:yield this._getAuthorizationHeader(),"X-Client-Name":(yield he.Supplier.get(this._options.clientName))!=null?yield he.Supplier.get(this._options.clientName):void 0,"X-Fern-Language":"JavaScript","X-Fern-SDK-Name":"cohere-ai","X-Fern-SDK-Version":"7.16.0","User-Agent":"cohere-ai/7.16.0","X-Fern-Runtime":he.RUNTIME.type,"X-Fern-Runtime-Version":he.RUNTIME.version},r?.headers),contentType:"application/json",requestType:"json",body:Object.assign(Object.assign({},$t.GenerateRequest.jsonOrThrow(e,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0})),{stream:!1}),timeoutMs:r?.timeoutInSeconds!=null?r.timeoutInSeconds*1e3:3e5,maxRetries:r?.maxRetries,abortSignal:r?.abortSignal});if(a.ok)return $t.Generation.parseOrThrow(a.body,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0,skipValidation:!0,breadcrumbsPrefix:["response"]});if(a.error.reason==="status-code")switch(a.error.statusCode){case 400:throw new z.BadRequestError(a.error.body);case 401:throw new z.UnauthorizedError(a.error.body);case 403:throw new z.ForbiddenError(a.error.body);case 404:throw new z.NotFoundError(a.error.body);case 422:throw new z.UnprocessableEntityError(a.error.body);case 429:throw new z.TooManyRequestsError(a.error.body);case 498:throw new z.InvalidTokenError(a.error.body);case 499:throw new z.ClientClosedRequestError(a.error.body);case 500:throw new z.InternalServerError(a.error.body);case 501:throw new z.NotImplementedError(a.error.body);case 503:throw new z.ServiceUnavailableError(a.error.body);case 504:throw new z.GatewayTimeoutError(a.error.body);default:throw new Me.CohereError({statusCode:a.error.statusCode,body:a.error.body})}switch(a.error.reason){case"non-json":throw new Me.CohereError({statusCode:a.error.statusCode,body:a.error.rawBody});case"timeout":throw new Me.CohereTimeoutError("Timeout exceeded when calling POST /v1/generate.");case"unknown":throw new Me.CohereError({message:a.error.errorMessage})}})}embed(e={},r){var n,i;return Er(this,void 0,void 0,function*(){const a=yield((n=this._options.fetcher)!==null&&n!==void 0?n:he.fetcher)({url:(0,Cn.default)((i=yield he.Supplier.get(this._options.environment))!==null&&i!==void 0?i:jn.CohereEnvironment.Production,"v1/embed"),method:"POST",headers:Object.assign({Authorization:yield this._getAuthorizationHeader(),"X-Client-Name":(yield he.Supplier.get(this._options.clientName))!=null?yield he.Supplier.get(this._options.clientName):void 0,"X-Fern-Language":"JavaScript","X-Fern-SDK-Name":"cohere-ai","X-Fern-SDK-Version":"7.16.0","User-Agent":"cohere-ai/7.16.0","X-Fern-Runtime":he.RUNTIME.type,"X-Fern-Runtime-Version":he.RUNTIME.version},r?.headers),contentType:"application/json",requestType:"json",body:$t.EmbedRequest.jsonOrThrow(e,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0}),timeoutMs:r?.timeoutInSeconds!=null?r.timeoutInSeconds*1e3:3e5,maxRetries:r?.maxRetries,abortSignal:r?.abortSignal});if(a.ok)return $t.EmbedResponse.parseOrThrow(a.body,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0,skipValidation:!0,breadcrumbsPrefix:["response"]});if(a.error.reason==="status-code")switch(a.error.statusCode){case 400:throw new z.BadRequestError(a.error.body);case 401:throw new z.UnauthorizedError(a.error.body);case 403:throw new z.ForbiddenError(a.error.body);case 404:throw new z.NotFoundError(a.error.body);case 422:throw new z.UnprocessableEntityError(a.error.body);case 429:throw new z.TooManyRequestsError(a.error.body);case 498:throw new z.InvalidTokenError(a.error.body);case 499:throw new z.ClientClosedRequestError(a.error.body);case 500:throw new z.InternalServerError(a.error.body);case 501:throw new z.NotImplementedError(a.error.body);case 503:throw new z.ServiceUnavailableError(a.error.body);case 504:throw new z.GatewayTimeoutError(a.error.body);default:throw new Me.CohereError({statusCode:a.error.statusCode,body:a.error.body})}switch(a.error.reason){case"non-json":throw new Me.CohereError({statusCode:a.error.statusCode,body:a.error.rawBody});case"timeout":throw new Me.CohereTimeoutError("Timeout exceeded when calling POST /v1/embed.");case"unknown":throw new Me.CohereError({message:a.error.errorMessage})}})}rerank(e,r){var n,i;return Er(this,void 0,void 0,function*(){const a=yield((n=this._options.fetcher)!==null&&n!==void 0?n:he.fetcher)({url:(0,Cn.default)((i=yield he.Supplier.get(this._options.environment))!==null&&i!==void 0?i:jn.CohereEnvironment.Production,"v1/rerank"),method:"POST",headers:Object.assign({Authorization:yield this._getAuthorizationHeader(),"X-Client-Name":(yield he.Supplier.get(this._options.clientName))!=null?yield he.Supplier.get(this._options.clientName):void 0,"X-Fern-Language":"JavaScript","X-Fern-SDK-Name":"cohere-ai","X-Fern-SDK-Version":"7.16.0","User-Agent":"cohere-ai/7.16.0","X-Fern-Runtime":he.RUNTIME.type,"X-Fern-Runtime-Version":he.RUNTIME.version},r?.headers),contentType:"application/json",requestType:"json",body:$t.RerankRequest.jsonOrThrow(e,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0}),timeoutMs:r?.timeoutInSeconds!=null?r.timeoutInSeconds*1e3:3e5,maxRetries:r?.maxRetries,abortSignal:r?.abortSignal});if(a.ok)return $t.RerankResponse.parseOrThrow(a.body,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0,skipValidation:!0,breadcrumbsPrefix:["response"]});if(a.error.reason==="status-code")switch(a.error.statusCode){case 400:throw new z.BadRequestError(a.error.body);case 401:throw new z.UnauthorizedError(a.error.body);case 403:throw new z.ForbiddenError(a.error.body);case 404:throw new z.NotFoundError(a.error.body);case 422:throw new z.UnprocessableEntityError(a.error.body);case 429:throw new z.TooManyRequestsError(a.error.body);case 498:throw new z.InvalidTokenError(a.error.body);case 499:throw new z.ClientClosedRequestError(a.error.body);case 500:throw new z.InternalServerError(a.error.body);case 501:throw new z.NotImplementedError(a.error.body);case 503:throw new z.ServiceUnavailableError(a.error.body);case 504:throw new z.GatewayTimeoutError(a.error.body);default:throw new Me.CohereError({statusCode:a.error.statusCode,body:a.error.body})}switch(a.error.reason){case"non-json":throw new Me.CohereError({statusCode:a.error.statusCode,body:a.error.rawBody});case"timeout":throw new Me.CohereTimeoutError("Timeout exceeded when calling POST /v1/rerank.");case"unknown":throw new Me.CohereError({message:a.error.errorMessage})}})}classify(e,r){var n,i;return Er(this,void 0,void 0,function*(){const a=yield((n=this._options.fetcher)!==null&&n!==void 0?n:he.fetcher)({url:(0,Cn.default)((i=yield he.Supplier.get(this._options.environment))!==null&&i!==void 0?i:jn.CohereEnvironment.Production,"v1/classify"),method:"POST",headers:Object.assign({Authorization:yield this._getAuthorizationHeader(),"X-Client-Name":(yield he.Supplier.get(this._options.clientName))!=null?yield he.Supplier.get(this._options.clientName):void 0,"X-Fern-Language":"JavaScript","X-Fern-SDK-Name":"cohere-ai","X-Fern-SDK-Version":"7.16.0","User-Agent":"cohere-ai/7.16.0","X-Fern-Runtime":he.RUNTIME.type,"X-Fern-Runtime-Version":he.RUNTIME.version},r?.headers),contentType:"application/json",requestType:"json",body:$t.ClassifyRequest.jsonOrThrow(e,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0}),timeoutMs:r?.timeoutInSeconds!=null?r.timeoutInSeconds*1e3:3e5,maxRetries:r?.maxRetries,abortSignal:r?.abortSignal});if(a.ok)return $t.ClassifyResponse.parseOrThrow(a.body,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0,skipValidation:!0,breadcrumbsPrefix:["response"]});if(a.error.reason==="status-code")switch(a.error.statusCode){case 400:throw new z.BadRequestError(a.error.body);case 401:throw new z.UnauthorizedError(a.error.body);case 403:throw new z.ForbiddenError(a.error.body);case 404:throw new z.NotFoundError(a.error.body);case 422:throw new z.UnprocessableEntityError(a.error.body);case 429:throw new z.TooManyRequestsError(a.error.body);case 498:throw new z.InvalidTokenError(a.error.body);case 499:throw new z.ClientClosedRequestError(a.error.body);case 500:throw new z.InternalServerError(a.error.body);case 501:throw new z.NotImplementedError(a.error.body);case 503:throw new z.ServiceUnavailableError(a.error.body);case 504:throw new z.GatewayTimeoutError(a.error.body);default:throw new Me.CohereError({statusCode:a.error.statusCode,body:a.error.body})}switch(a.error.reason){case"non-json":throw new Me.CohereError({statusCode:a.error.statusCode,body:a.error.rawBody});case"timeout":throw new Me.CohereTimeoutError("Timeout exceeded when calling POST /v1/classify.");case"unknown":throw new Me.CohereError({message:a.error.errorMessage})}})}summarize(e,r){var n,i;return Er(this,void 0,void 0,function*(){const a=yield((n=this._options.fetcher)!==null&&n!==void 0?n:he.fetcher)({url:(0,Cn.default)((i=yield he.Supplier.get(this._options.environment))!==null&&i!==void 0?i:jn.CohereEnvironment.Production,"v1/summarize"),method:"POST",headers:Object.assign({Authorization:yield this._getAuthorizationHeader(),"X-Client-Name":(yield he.Supplier.get(this._options.clientName))!=null?yield he.Supplier.get(this._options.clientName):void 0,"X-Fern-Language":"JavaScript","X-Fern-SDK-Name":"cohere-ai","X-Fern-SDK-Version":"7.16.0","User-Agent":"cohere-ai/7.16.0","X-Fern-Runtime":he.RUNTIME.type,"X-Fern-Runtime-Version":he.RUNTIME.version},r?.headers),contentType:"application/json",requestType:"json",body:$t.SummarizeRequest.jsonOrThrow(e,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0}),timeoutMs:r?.timeoutInSeconds!=null?r.timeoutInSeconds*1e3:3e5,maxRetries:r?.maxRetries,abortSignal:r?.abortSignal});if(a.ok)return $t.SummarizeResponse.parseOrThrow(a.body,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0,skipValidation:!0,breadcrumbsPrefix:["response"]});if(a.error.reason==="status-code")switch(a.error.statusCode){case 400:throw new z.BadRequestError(a.error.body);case 401:throw new z.UnauthorizedError(a.error.body);case 403:throw new z.ForbiddenError(a.error.body);case 404:throw new z.NotFoundError(a.error.body);case 422:throw new z.UnprocessableEntityError(a.error.body);case 429:throw new z.TooManyRequestsError(a.error.body);case 498:throw new z.InvalidTokenError(a.error.body);case 499:throw new z.ClientClosedRequestError(a.error.body);case 500:throw new z.InternalServerError(a.error.body);case 501:throw new z.NotImplementedError(a.error.body);case 503:throw new z.ServiceUnavailableError(a.error.body);case 504:throw new z.GatewayTimeoutError(a.error.body);default:throw new Me.CohereError({statusCode:a.error.statusCode,body:a.error.body})}switch(a.error.reason){case"non-json":throw new Me.CohereError({statusCode:a.error.statusCode,body:a.error.rawBody});case"timeout":throw new Me.CohereTimeoutError("Timeout exceeded when calling POST /v1/summarize.");case"unknown":throw new Me.CohereError({message:a.error.errorMessage})}})}tokenize(e,r){var n,i;return Er(this,void 0,void 0,function*(){const a=yield((n=this._options.fetcher)!==null&&n!==void 0?n:he.fetcher)({url:(0,Cn.default)((i=yield he.Supplier.get(this._options.environment))!==null&&i!==void 0?i:jn.CohereEnvironment.Production,"v1/tokenize"),method:"POST",headers:Object.assign({Authorization:yield this._getAuthorizationHeader(),"X-Client-Name":(yield he.Supplier.get(this._options.clientName))!=null?yield he.Supplier.get(this._options.clientName):void 0,"X-Fern-Language":"JavaScript","X-Fern-SDK-Name":"cohere-ai","X-Fern-SDK-Version":"7.16.0","User-Agent":"cohere-ai/7.16.0","X-Fern-Runtime":he.RUNTIME.type,"X-Fern-Runtime-Version":he.RUNTIME.version},r?.headers),contentType:"application/json",requestType:"json",body:$t.TokenizeRequest.jsonOrThrow(e,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0}),timeoutMs:r?.timeoutInSeconds!=null?r.timeoutInSeconds*1e3:3e5,maxRetries:r?.maxRetries,abortSignal:r?.abortSignal});if(a.ok)return $t.TokenizeResponse.parseOrThrow(a.body,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0,skipValidation:!0,breadcrumbsPrefix:["response"]});if(a.error.reason==="status-code")switch(a.error.statusCode){case 400:throw new z.BadRequestError(a.error.body);case 401:throw new z.UnauthorizedError(a.error.body);case 403:throw new z.ForbiddenError(a.error.body);case 404:throw new z.NotFoundError(a.error.body);case 422:throw new z.UnprocessableEntityError(a.error.body);case 429:throw new z.TooManyRequestsError(a.error.body);case 498:throw new z.InvalidTokenError(a.error.body);case 499:throw new z.ClientClosedRequestError(a.error.body);case 500:throw new z.InternalServerError(a.error.body);case 501:throw new z.NotImplementedError(a.error.body);case 503:throw new z.ServiceUnavailableError(a.error.body);case 504:throw new z.GatewayTimeoutError(a.error.body);default:throw new Me.CohereError({statusCode:a.error.statusCode,body:a.error.body})}switch(a.error.reason){case"non-json":throw new Me.CohereError({statusCode:a.error.statusCode,body:a.error.rawBody});case"timeout":throw new Me.CohereTimeoutError("Timeout exceeded when calling POST /v1/tokenize.");case"unknown":throw new Me.CohereError({message:a.error.errorMessage})}})}detokenize(e,r){var n,i;return Er(this,void 0,void 0,function*(){const a=yield((n=this._options.fetcher)!==null&&n!==void 0?n:he.fetcher)({url:(0,Cn.default)((i=yield he.Supplier.get(this._options.environment))!==null&&i!==void 0?i:jn.CohereEnvironment.Production,"v1/detokenize"),method:"POST",headers:Object.assign({Authorization:yield this._getAuthorizationHeader(),"X-Client-Name":(yield he.Supplier.get(this._options.clientName))!=null?yield he.Supplier.get(this._options.clientName):void 0,"X-Fern-Language":"JavaScript","X-Fern-SDK-Name":"cohere-ai","X-Fern-SDK-Version":"7.16.0","User-Agent":"cohere-ai/7.16.0","X-Fern-Runtime":he.RUNTIME.type,"X-Fern-Runtime-Version":he.RUNTIME.version},r?.headers),contentType:"application/json",requestType:"json",body:$t.DetokenizeRequest.jsonOrThrow(e,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0}),timeoutMs:r?.timeoutInSeconds!=null?r.timeoutInSeconds*1e3:3e5,maxRetries:r?.maxRetries,abortSignal:r?.abortSignal});if(a.ok)return $t.DetokenizeResponse.parseOrThrow(a.body,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0,skipValidation:!0,breadcrumbsPrefix:["response"]});if(a.error.reason==="status-code")switch(a.error.statusCode){case 400:throw new z.BadRequestError(a.error.body);case 401:throw new z.UnauthorizedError(a.error.body);case 403:throw new z.ForbiddenError(a.error.body);case 404:throw new z.NotFoundError(a.error.body);case 422:throw new z.UnprocessableEntityError(a.error.body);case 429:throw new z.TooManyRequestsError(a.error.body);case 498:throw new z.InvalidTokenError(a.error.body);case 499:throw new z.ClientClosedRequestError(a.error.body);case 500:throw new z.InternalServerError(a.error.body);case 501:throw new z.NotImplementedError(a.error.body);case 503:throw new z.ServiceUnavailableError(a.error.body);case 504:throw new z.GatewayTimeoutError(a.error.body);default:throw new Me.CohereError({statusCode:a.error.statusCode,body:a.error.body})}switch(a.error.reason){case"non-json":throw new Me.CohereError({statusCode:a.error.statusCode,body:a.error.rawBody});case"timeout":throw new Me.CohereTimeoutError("Timeout exceeded when calling POST /v1/detokenize.");case"unknown":throw new Me.CohereError({message:a.error.errorMessage})}})}checkApiKey(e){var r,n;return Er(this,void 0,void 0,function*(){const i=yield((r=this._options.fetcher)!==null&&r!==void 0?r:he.fetcher)({url:(0,Cn.default)((n=yield he.Supplier.get(this._options.environment))!==null&&n!==void 0?n:jn.CohereEnvironment.Production,"v1/check-api-key"),method:"POST",headers:Object.assign({Authorization:yield this._getAuthorizationHeader(),"X-Client-Name":(yield he.Supplier.get(this._options.clientName))!=null?yield he.Supplier.get(this._options.clientName):void 0,"X-Fern-Language":"JavaScript","X-Fern-SDK-Name":"cohere-ai","X-Fern-SDK-Version":"7.16.0","User-Agent":"cohere-ai/7.16.0","X-Fern-Runtime":he.RUNTIME.type,"X-Fern-Runtime-Version":he.RUNTIME.version},e?.headers),contentType:"application/json",requestType:"json",timeoutMs:e?.timeoutInSeconds!=null?e.timeoutInSeconds*1e3:3e5,maxRetries:e?.maxRetries,abortSignal:e?.abortSignal});if(i.ok)return $t.CheckApiKeyResponse.parseOrThrow(i.body,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0,skipValidation:!0,breadcrumbsPrefix:["response"]});if(i.error.reason==="status-code")switch(i.error.statusCode){case 400:throw new z.BadRequestError(i.error.body);case 401:throw new z.UnauthorizedError(i.error.body);case 403:throw new z.ForbiddenError(i.error.body);case 404:throw new z.NotFoundError(i.error.body);case 422:throw new z.UnprocessableEntityError(i.error.body);case 429:throw new z.TooManyRequestsError(i.error.body);case 498:throw new z.InvalidTokenError(i.error.body);case 499:throw new z.ClientClosedRequestError(i.error.body);case 500:throw new z.InternalServerError(i.error.body);case 501:throw new z.NotImplementedError(i.error.body);case 503:throw new z.ServiceUnavailableError(i.error.body);case 504:throw new z.GatewayTimeoutError(i.error.body);default:throw new Me.CohereError({statusCode:i.error.statusCode,body:i.error.body})}switch(i.error.reason){case"non-json":throw new Me.CohereError({statusCode:i.error.statusCode,body:i.error.rawBody});case"timeout":throw new Me.CohereTimeoutError("Timeout exceeded when calling POST /v1/check-api-key.");case"unknown":throw new Me.CohereError({message:i.error.errorMessage})}})}_getAuthorizationHeader(){var e;return Er(this,void 0,void 0,function*(){const r=(e=yield he.Supplier.get(this._options.token))!==null&&e!==void 0?e:process==null?void 0:POe.CO_API_KEY;if(r==null)throw new Me.CohereError({message:"Please specify CO_API_KEY when instantiating the client."});return`Bearer ${r}`})}}sl.CohereClient=DOe;Object.defineProperty(dp,"__esModule",{value:!0});dp.AwsClient=void 0;const NOe=sl;class zOe extends NOe.CohereClient{constructor(e){e.token="n/a",super(e)}}dp.AwsClient=zOe;Object.defineProperty(wg,"__esModule",{value:!0});wg.BedrockClient=void 0;const BOe=EP,UOe=dp;class FOe extends UOe.AwsClient{constructor(e){super(Object.assign(Object.assign({},e),{fetcher:(0,BOe.fetchOverride)("bedrock",e)}))}}wg.BedrockClient=FOe;var Rv={};Object.defineProperty(Rv,"__esModule",{value:!0});Rv.CohereClientV2=void 0;const LOe=fp,VOe=sl;class kOe{constructor(e){this._options=e,this.client=new VOe.CohereClient(this._options),this.clientV2=new LOe.V2(this._options),this.chat=this.clientV2.chat.bind(this.clientV2),this.chatStream=this.clientV2.chatStream.bind(this.clientV2),this.embed=this.clientV2.embed.bind(this.clientV2),this.rerank=this.clientV2.rerank.bind(this.clientV2),this.generateStream=this.client.generateStream.bind(this.clientV2),this.generate=this.client.generate.bind(this.clientV2),this.classify=this.client.classify.bind(this.clientV2),this.summarize=this.client.summarize.bind(this.clientV2),this.tokenize=this.client.tokenize.bind(this.clientV2),this.detokenize=this.client.detokenize.bind(this.clientV2),this.checkApiKey=this.client.checkApiKey.bind(this.clientV2),this.embedJobs=this.client.embedJobs,this.datasets=this.client.datasets,this.connectors=this.client.connectors,this.models=this.client.models,this.finetuning=this.client.finetuning}}Rv.CohereClientV2=kOe;var Av={};Object.defineProperty(Av,"__esModule",{value:!0});Av.CustomClient=void 0;const HOe=sl;class qOe extends HOe.CohereClient{constructor(e={}){var r,n;try{const i=/\/v1\/?$/,a=(r=e.environment)===null||r===void 0?void 0:r.toString().replace(i,"");a!==((n=e.environment)===null||n===void 0?void 0:n.toString())&&(e.environment=a)}catch{}super(e),this._options=e}}Av.CustomClient=qOe;var $v={};Object.defineProperty($v,"__esModule",{value:!0});$v.SagemakerClient=void 0;const GOe=dp,WOe=EP;class KOe extends GOe.AwsClient{constructor(e){super(Object.assign(Object.assign({},e),{fetcher:(0,WOe.fetchOverride)("sagemaker",e)}))}}$v.SagemakerClient=KOe;(function(t){var e=u&&u.__createBinding||(Object.create?function(d,f,h,p){p===void 0&&(p=h);var b=Object.getOwnPropertyDescriptor(f,h);(!b||("get"in b?!f.__esModule:b.writable||b.configurable))&&(b={enumerable:!0,get:function(){return f[h]}}),Object.defineProperty(d,p,b)}:function(d,f,h,p){p===void 0&&(p=h),d[p]=f[h]}),r=u&&u.__setModuleDefault||(Object.create?function(d,f){Object.defineProperty(d,"default",{enumerable:!0,value:f})}:function(d,f){d.default=f}),n=u&&u.__importStar||function(d){if(d&&d.__esModule)return d;var f={};if(d!=null)for(var h in d)h!=="default"&&Object.prototype.hasOwnProperty.call(d,h)&&e(f,d,h);return r(f,d),f};Object.defineProperty(t,"__esModule",{value:!0}),t.SagemakerClient=t.CohereTimeoutError=t.CohereError=t.CohereEnvironment=t.CohereClient=t.CohereClientV2=t.BedrockClient=t.Cohere=void 0,t.Cohere=n(Vi);var i=wg;Object.defineProperty(t,"BedrockClient",{enumerable:!0,get:function(){return i.BedrockClient}});var a=Rv;Object.defineProperty(t,"CohereClientV2",{enumerable:!0,get:function(){return a.CohereClientV2}});var o=Av;Object.defineProperty(t,"CohereClient",{enumerable:!0,get:function(){return o.CustomClient}});var s=Ln;Object.defineProperty(t,"CohereEnvironment",{enumerable:!0,get:function(){return s.CohereEnvironment}});var l=Rt;Object.defineProperty(t,"CohereError",{enumerable:!0,get:function(){return l.CohereError}}),Object.defineProperty(t,"CohereTimeoutError",{enumerable:!0,get:function(){return l.CohereTimeoutError}});var c=$v;Object.defineProperty(t,"SagemakerClient",{enumerable:!0,get:function(){return c.SagemakerClient}})})(rD);function RL(t){if(t?.client)return t.client;const e=t?.apiKey??Ye("COHERE_API_KEY");if(!e)throw new Error("COHERE_API_KEY must be set");return new rD.CohereClient({token:e})}function XA(t){const e=[];let r=[];typeof t=="string"?r=[{output:t}]:t instanceof Map||typeof t=="object"&&t!==null&&!Array.isArray(t)?r=[t]:Array.isArray(t)||(r=[{output:t}]);for(let n of r)!(n instanceof Map)&&(typeof n!="object"||n===null)&&(n={output:n}),e.push(n);return e}function I_(t,e){const r=a=>{switch(a){case"system":return"SYSTEM";case"human":return"USER";case"ai":return"CHATBOT";case"tool":return"TOOL";default:throw new Error(`Unknown message type: '${a}'. Accepted types: 'human', 'ai', 'system', 'tool'`)}},n=a=>{if(typeof a=="string")return a;throw new Error(`ChatCohere does not support non text message content. Received: ${JSON.stringify(a,null,2)}`)},i=a=>ii(a)&&a.tool_calls?a.tool_calls.map(o=>({name:o.name,parameters:o.args})):[];if(t._getType().toLowerCase()==="ai")return{role:r(t._getType()),message:n(t.content),toolCalls:i(t)};if(t._getType().toLowerCase()==="tool")return{role:r(t._getType()),message:n(t.content),toolResults:e};if(t._getType().toLowerCase()==="human"||t._getType().toLowerCase()==="system")return{role:r(t._getType()),message:n(t.content)};throw new Error("Got unknown message type. Supported types are AIMessage, ToolMessage, HumanMessage, and SystemMessage")}function JOe(t){return"name"in t&&"description"in t&&"parameterDefinitions"in t}function ZA(t){return t._getType()==="tool"}function YA(t){const e="properties"in t?t.properties:{};let r="required"in t?t.required:[];const n={};return Object.keys(e).forEach(i=>{n[i]=e[i],r===void 0&&(r=[]),n[i].required=r.includes(i)}),n}function XOe(t){if(t){if(t.every(JOe))return t;if(t.every(ud))return t.map(e=>({name:e.function.name,description:e.function.description??"",parameterDefinitions:YA(e.function.parameters)}));if(t.every(zu))return t.map(e=>{const r=ui(e.schema);return{name:e.name,description:e.description??"",parameterDefinitions:YA(r)}});throw new Error("Can not pass in a mix of tool schema types to ChatCohere.")}else return}class ZOe extends un{static lc_name(){return"ChatCohere"}constructor(e){super(e??{}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"model",{enumerable:!0,configurable:!0,writable:!0,value:"command-r-plus"}),Object.defineProperty(this,"temperature",{enumerable:!0,configurable:!0,writable:!0,value:.3}),Object.defineProperty(this,"streaming",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"streamUsage",{enumerable:!0,configurable:!0,writable:!0,value:!0}),this.client=RL(e),this.model=e?.model??this.model,this.temperature=e?.temperature??this.temperature,this.streaming=e?.streaming??this.streaming,this.streamUsage=e?.streamUsage??this.streamUsage}getLsParams(e){const r=this.invocationParams(e);return{ls_provider:"cohere",ls_model_name:this.model,ls_model_type:"chat",ls_temperature:this.temperature??void 0,ls_max_tokens:typeof r.maxTokens=="number"?r.maxTokens:void 0,ls_stop:Array.isArray(r.stopSequences)?r.stopSequences:void 0}}_llmType(){return"cohere"}invocationParams(e){if(e.tool_choice)throw new Error("'tool_choice' call option is not supported by ChatCohere.");const r={model:this.model,preamble:e.preamble,conversationId:e.conversationId,promptTruncation:e.promptTruncation,connectors:e.connectors,searchQueriesOnly:e.searchQueriesOnly,documents:e.documents,temperature:e.temperature??this.temperature,forceSingleStep:e.forceSingleStep,tools:e.tools};return Object.fromEntries(Object.entries(r).filter(([,n])=>n!==void 0))}bindTools(e,r){return this.bind({tools:XOe(e),...r})}_getChatRequest(e,r){const n=this.invocationParams(r),i=this._messagesToCohereToolResultsCurrChatTurn(e),a=[];let o="",s=[];if(n.forceSingleStep){o="";for(let c=0;c<e.length-1;c+=1){const d=e[c];if(!(ii(d)&&d.tool_calls))if(d._getType().toLowerCase()==="tool"){if(s=s.concat(this._messageToCohereToolResults(e,c)),c===e.length-1||e[c+1]._getType().toLowerCase()!=="tool"){const f=I_(d,s);a.push(f),s=[]}}else a.push(I_(d,[]))}for(let c=e.length-1;c>=0;c-=1){const d=e[c];if(d._getType().toLowerCase()==="human"&&d.content){o=d.content.toString();break}}}else{for(let c=0;c<e.length-1;c+=1){const d=e[c];if(d._getType().toLowerCase()==="tool"){if(s=s.concat(this._messageToCohereToolResults(e,c)),c===e.length-1||e[c+1]._getType().toLowerCase()!=="tool"){const f=I_(d,s);a.push(f),s=[]}}else a.push(I_(d,[]))}o=i.length>0?"":e[e.length-1].content.toString()}return{message:o,chatHistory:a,toolResults:i.length>0?i:void 0,...n}}_getCurrChatTurnMessages(e){const r=[];for(let n=e.length-1;n>=0;n-=1){const i=e[n];if(r.push(i),i._getType().toLowerCase()==="human")break}return r.reverse()}_messagesToCohereToolResultsCurrChatTurn(e){const r=[],n=this._getCurrChatTurnMessages(e);for(const i of n)if(ZA(i)){const a=i,o=n.filter(s=>ii(s)&&s.tool_calls!==void 0);if(o.length>0){const s=o[o.length-1];s.tool_calls&&r.push(...s.tool_calls.filter(l=>l.id===a.tool_call_id).map(l=>({call:{name:l.name,parameters:l.args},outputs:XA(a.content)})))}}return r}_messageToCohereToolResults(e,r){const n=[],i=e[r];if(!ZA(i))throw new Error("The message index does not correspond to an instance of ToolMessage");const o=e.slice(0,r).filter(s=>ii(s)&&s.tool_calls).slice(-1)[0];return o.tool_calls&&n.push(...o.tool_calls.filter(s=>s.id===i.tool_call_id).map(s=>({call:{name:s.name,parameters:s.args},outputs:XA(i.content)}))),n}_formatCohereToolCalls(e=null){if(!e)return[];const r=[];for(const n of e)r.push({id:lr().substring(0,32),function:{name:n.name,arguments:n.parameters},type:"function"});return r}_convertCohereToolCallToLangchain(e){return e.map(r=>({name:r.function.name,args:r.function.arguments,id:r.id,type:"tool_call"}))}async _generate(e,r,n){const i={},a=this._getChatRequest(e,r);if(this.streaming){const d=this._streamResponseChunks(e,r,n),f={};for await(const p of d){const b=p.generationInfo?.completion??0;f[b]===void 0?f[b]=p:f[b]=f[b].concat(p)}return{generations:Object.entries(f).sort(([p],[b])=>parseInt(p,10)-parseInt(b,10)).map(([p,b])=>b),llmOutput:{estimatedTokenUsage:i}}}const o=await this.caller.callWithOptions({signal:r.signal},async()=>{let d;try{d=await this.client.chat(a)}catch(f){throw f.status=f.status??f.statusCode,f}return d});if(o.meta?.tokens){const{inputTokens:d,outputTokens:f}=o.meta.tokens;f&&(i.completionTokens=(i.completionTokens??0)+f),d&&(i.promptTokens=(i.promptTokens??0)+d),i.totalTokens=(i.totalTokens??0)+(i.promptTokens??0)+(i.completionTokens??0)}const s={...o};delete s.text,o.toolCalls&&o.toolCalls.length>0&&(s.toolCalls=this._formatCohereToolCalls(o.toolCalls));let l=[];return"toolCalls"in s&&(l=this._convertCohereToolCallToLangchain(s.toolCalls)),{generations:[{text:o.text,message:new Nn({content:o.text,additional_kwargs:s,tool_calls:l,usage_metadata:{input_tokens:i.promptTokens??0,output_tokens:i.completionTokens??0,total_tokens:i.totalTokens??0}}),generationInfo:s}],llmOutput:{estimatedTokenUsage:i}}}async*_streamResponseChunks(e,r,n){const i=this._getChatRequest(e,r),a=await this.caller.call(async()=>{let o;try{o=await this.client.chatStream(i)}catch(s){throw s.status=s.status??s.statusCode,s}return o});for await(const o of a)if(o.eventType==="text-generation")yield new Mr({text:o.text,message:new vt({content:o.text})}),await n?.handleLLMNewToken(o.text);else if(o.eventType!=="stream-end")yield new Mr({text:"",message:new vt({content:"",additional_kwargs:{...o}}),generationInfo:{...o}});else if(o.eventType==="stream-end"&&(this.streamUsage||r.streamUsage)){const s=o.response.meta?.tokens?.inputTokens??0,l=o.response.meta?.tokens?.outputTokens??0,c={...o.response};o.response.toolCalls&&o.response.toolCalls.length>0&&(c.toolCalls=this._formatCohereToolCalls(o.response.toolCalls));let d=[];const f=c.toolCalls??[];f.length>0&&(d=f.map(h=>({name:h.function.name,args:h.function.arguments,id:h.id,index:h.index,type:"tool_call_chunk"}))),yield new Mr({text:"",message:new vt({content:"",additional_kwargs:{eventType:"stream-end"},tool_call_chunks:d,usage_metadata:{input_tokens:s,output_tokens:l,total_tokens:s+l}}),generationInfo:{eventType:"stream-end",...c}})}}_combineLLMOutput(...e){return e.reduce((r,n)=>{if(n&&n.estimatedTokenUsage){let i=r.estimatedTokenUsage?.completionTokens??0,a=r.estimatedTokenUsage?.promptTokens??0,o=r.estimatedTokenUsage?.totalTokens??0;i+=n.estimatedTokenUsage.completionTokens??0,a+=n.estimatedTokenUsage.promptTokens??0,o+=n.estimatedTokenUsage.totalTokens??0,r.estimatedTokenUsage={completionTokens:i,promptTokens:a,totalTokens:o}}return r},{estimatedTokenUsage:{completionTokens:0,promptTokens:0,totalTokens:0}})}get lc_secrets(){return{apiKey:"COHERE_API_KEY",api_key:"COHERE_API_KEY"}}get lc_aliases(){return{apiKey:"cohere_api_key",api_key:"cohere_api_key"}}}class YOe extends jx{constructor(e){const r={maxConcurrency:2,...e};if(super(r),Object.defineProperty(this,"model",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"batchSize",{enumerable:!0,configurable:!0,writable:!0,value:48}),Object.defineProperty(this,"embeddingTypes",{enumerable:!0,configurable:!0,writable:!0,value:["float"]}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.client=RL(r),this.model=r?.model??this.model,!this.model)throw new Error("Model not specified for CohereEmbeddings instance. Please provide a model name from the options here: https://docs.cohere.com/reference/embed");this.batchSize=r?.batchSize??this.batchSize,this.embeddingTypes=r?.embeddingTypes??this.embeddingTypes}async embedDocuments(e){const r=WE(e,this.batchSize),n=r.map(o=>this.embeddingWithRetry({model:this.model,texts:o,inputType:"search_document",embeddingTypes:this.embeddingTypes})),i=await Promise.all(n),a=[];for(let o=0;o<i.length;o+=1){const s=r[o],{embeddings:l}=i[o];for(let c=0;c<s.length;c+=1)"float"in l&&l.float?a.push(l.float[c]):Array.isArray(l)&&a.push(l[c])}return a}async embedQuery(e){const{embeddings:r}=await this.embeddingWithRetry({model:this.model,texts:[e],inputType:"search_query",embeddingTypes:this.embeddingTypes});if("float"in r&&r.float)return r.float[0];if(Array.isArray(r))return r[0];throw new Error(`Invalid response from Cohere API. Received: ${JSON.stringify(r,null,2)}`)}async embed(e){const{embeddings:r}=await this.embeddingWithRetry(e);if("float"in r&&r.float)return r.float[0];if(Array.isArray(r))return r[0];throw new Error(`Invalid response from Cohere API. Received: ${JSON.stringify(r,null,2)}`)}async embeddingWithRetry(e){return this.caller.call(async()=>{let r;try{r=await this.client.embed(e)}catch(n){throw n.status=n.status??n.statusCode,n}return r})}get lc_secrets(){return{apiKey:"COHERE_API_KEY",api_key:"COHERE_API_KEY"}}get lc_aliases(){return{apiKey:"cohere_api_key",api_key:"cohere_api_key"}}}const Rs="0.5.0";let QA=!1,Cc,AL,$L,BS,IL,xL,DL,NL,zL;function QOe(t,e={auto:!1}){if(QA)throw new Error(`you must \`import 'groq-sdk/shims/${t.kind}'\` before importing anything else from groq-sdk`);if(Cc)throw new Error(`can't \`import 'groq-sdk/shims/${t.kind}'\` after \`import 'groq-sdk/shims/${Cc}'\``);QA=e.auto,Cc=t.kind,AL=t.fetch,$L=t.FormData,BS=t.File,IL=t.ReadableStream,xL=t.getMultipartRequestOptions,DL=t.getDefaultAgent,NL=t.fileFromPath,zL=t.isFsReadStream}class eSe{constructor(e){this.body=e}get[Symbol.toStringTag](){return"MultipartBody"}}function tSe({manuallyImported:t}={}){const e=t?"You may need to use polyfills":"Add one of these imports before your first `import  from 'groq-sdk'`:\n- `import 'groq-sdk/shims/node'` (if you're running on Node)\n- `import 'groq-sdk/shims/web'` (otherwise)\n";let r,n,i,a;try{r=fetch,n=Request,i=Response,a=Headers}catch(o){throw new Error(`this environment is missing the following Web Fetch API type: ${o.message}. ${e}`)}return{kind:"web",fetch:r,Request:n,Response:i,Headers:a,FormData:typeof FormData<"u"?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${e}`)}},Blob:typeof Blob<"u"?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${e}`)}},File:typeof File<"u"?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${e}`)}},ReadableStream:typeof ReadableStream<"u"?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${e}`)}},getMultipartRequestOptions:async(o,s)=>({...s,body:new eSe(o)}),getDefaultAgent:o=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/groq/groq-typescript#file-uploads")},isFsReadStream:o=>!1}}Cc||QOe(tSe(),{auto:!0});class Dn extends Error{}class fr extends Dn{constructor(e,r,n,i){super(`${fr.makeMessage(e,r,n)}`),this.status=e,this.headers=i,this.error=r}static makeMessage(e,r,n){const i=r?.message?typeof r.message=="string"?r.message:JSON.stringify(r.message):r?JSON.stringify(r):n;return e&&i?`${e} ${i}`:e?`${e} status code (no body)`:i||"(no status code or body)"}static generate(e,r,n,i){if(!e)return new Iv({cause:LS(r)});const a=r;return e===400?new UL(e,a,n,i):e===401?new FL(e,a,n,i):e===403?new LL(e,a,n,i):e===404?new VL(e,a,n,i):e===409?new kL(e,a,n,i):e===422?new HL(e,a,n,i):e===429?new qL(e,a,n,i):e>=500?new GL(e,a,n,i):new fr(e,a,n,i)}}class US extends fr{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0),this.status=void 0}}class Iv extends fr{constructor({message:e,cause:r}){super(void 0,void 0,e||"Connection error.",void 0),this.status=void 0,r&&(this.cause=r)}}class BL extends Iv{constructor({message:e}={}){super({message:e??"Request timed out."})}}class UL extends fr{constructor(){super(...arguments),this.status=400}}class FL extends fr{constructor(){super(...arguments),this.status=401}}class LL extends fr{constructor(){super(...arguments),this.status=403}}class VL extends fr{constructor(){super(...arguments),this.status=404}}class kL extends fr{constructor(){super(...arguments),this.status=409}}class HL extends fr{constructor(){super(...arguments),this.status=422}}class qL extends fr{constructor(){super(...arguments),this.status=429}}class GL extends fr{}class Fs{constructor(e,r){this.iterator=e,this.controller=r}static fromSSEResponse(e,r){let n=!1;const i=new rSe;async function*a(){if(!e.body)throw r.abort(),new Dn("Attempted to iterate over a response with no body");const s=new Po,l=e$(e.body);for await(const c of l)for(const d of s.decode(c)){const f=i.decode(d);f&&(yield f)}for(const c of s.flush()){const d=i.decode(c);d&&(yield d)}}async function*o(){if(n)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");n=!0;let s=!1;try{for await(const l of a())if(!s){if(l.data.startsWith("[DONE]")){s=!0;continue}if(l.event===null){let c;try{c=JSON.parse(l.data)}catch(d){throw console.error("Could not parse message into JSON:",l.data),console.error("From chunk:",l.raw),d}if(c&&c.error)throw new fr(void 0,c.error,void 0,void 0);yield c}}s=!0}catch(l){if(l instanceof Error&&l.name==="AbortError")return;throw l}finally{s||r.abort()}}return new Fs(o,r)}static fromReadableStream(e,r){let n=!1;async function*i(){const o=new Po,s=e$(e);for await(const l of s)for(const c of o.decode(l))yield c;for(const l of o.flush())yield l}async function*a(){if(n)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");n=!0;let o=!1;try{for await(const s of i())o||s&&(yield JSON.parse(s));o=!0}catch(s){if(s instanceof Error&&s.name==="AbortError")return;throw s}finally{o||r.abort()}}return new Fs(a,r)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],r=[],n=this.iterator(),i=a=>({next:()=>{if(a.length===0){const o=n.next();e.push(o),r.push(o)}return a.shift()}});return[new Fs(()=>i(e),this.controller),new Fs(()=>i(r),this.controller)]}toReadableStream(){const e=this;let r;const n=new TextEncoder;return new IL({async start(){r=e[Symbol.asyncIterator]()},async pull(i){try{const{value:a,done:o}=await r.next();if(o)return i.close();const s=n.encode(JSON.stringify(a)+`
`);i.enqueue(s)}catch(a){i.error(a)}},async cancel(){await r.return?.()}})}}class rSe{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const a={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],a}if(this.chunks.push(e),e.startsWith(":"))return null;let[r,n,i]=nSe(e,":");return i.startsWith(" ")&&(i=i.substring(1)),r==="event"?this.event=i:r==="data"&&this.data.push(i),null}}class Po{constructor(){this.buffer=[],this.trailingCR=!1}decode(e){let r=this.decodeText(e);if(this.trailingCR&&(r="\r"+r,this.trailingCR=!1),r.endsWith("\r")&&(this.trailingCR=!0,r=r.slice(0,-1)),!r)return[];const n=Po.NEWLINE_CHARS.has(r[r.length-1]||"");let i=r.split(Po.NEWLINE_REGEXP);return i.length===1&&!n?(this.buffer.push(i[0]),[]):(this.buffer.length>0&&(i=[this.buffer.join("")+i[0],...i.slice(1)],this.buffer=[]),n||(this.buffer=[i.pop()||""]),i)}decodeText(e){if(e==null)return"";if(typeof e=="string")return e;if(typeof Buffer<"u"){if(e instanceof Buffer)return e.toString();if(e instanceof Uint8Array)return Buffer.from(e).toString();throw new Dn(`Unexpected: received non-Uint8Array (${e.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if(typeof TextDecoder<"u"){if(e instanceof Uint8Array||e instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(e);throw new Dn(`Unexpected: received non-Uint8Array/ArrayBuffer (${e.constructor.name}) in a web platform. Please report this error.`)}throw new Dn("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){if(!this.buffer.length&&!this.trailingCR)return[];const e=[this.buffer.join("")];return this.buffer=[],this.trailingCR=!1,e}}Po.NEWLINE_CHARS=new Set([`
`,"\r","\v","\f","","","","","\u2028","\u2029"]);Po.NEWLINE_REGEXP=/\r\n|[\n\r\x0b\x0c\x1c\x1d\x1e\x85\u2028\u2029]/g;function nSe(t,e){const r=t.indexOf(e);return r!==-1?[t.substring(0,r),e,t.substring(r+e.length)]:[t,"",""]}function e$(t){if(t[Symbol.asyncIterator])return t;const e=t.getReader();return{async next(){try{const r=await e.read();return r?.done&&e.releaseLock(),r}catch(r){throw e.releaseLock(),r}},async return(){const r=e.cancel();return e.releaseLock(),await r,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}const WL=t=>t!=null&&typeof t=="object"&&typeof t.url=="string"&&typeof t.blob=="function",KL=t=>t!=null&&typeof t=="object"&&typeof t.name=="string"&&typeof t.lastModified=="number"&&fj(t),fj=t=>t!=null&&typeof t=="object"&&typeof t.size=="number"&&typeof t.type=="string"&&typeof t.text=="function"&&typeof t.slice=="function"&&typeof t.arrayBuffer=="function",iSe=t=>KL(t)||WL(t)||zL(t);async function JL(t,e,r){if(t=await t,r??(r=KL(t)?{lastModified:t.lastModified,type:t.type}:{}),WL(t)){const i=await t.blob();return e||(e=new URL(t.url).pathname.split(/[\\/]/).pop()??"unknown_file"),new BS([i],e,r)}const n=await aSe(t);if(e||(e=sSe(t)??"unknown_file"),!r.type){const i=n[0]?.type;typeof i=="string"&&(r={...r,type:i})}return new BS(n,e,r)}async function aSe(t){let e=[];if(typeof t=="string"||ArrayBuffer.isView(t)||t instanceof ArrayBuffer)e.push(t);else if(fj(t))e.push(await t.arrayBuffer());else if(uSe(t))for await(const r of t)e.push(r);else throw new Error(`Unexpected data type: ${typeof t}; constructor: ${t?.constructor?.name}; props: ${oSe(t)}`);return e}function oSe(t){return`[${Object.getOwnPropertyNames(t).map(r=>`"${r}"`).join(", ")}]`}function sSe(t){return bO(t.name)||bO(t.filename)||bO(t.path)?.split(/[\\/]/).pop()}const bO=t=>{if(typeof t=="string")return t;if(typeof Buffer<"u"&&t instanceof Buffer)return String(t)},uSe=t=>t!=null&&typeof t=="object"&&typeof t[Symbol.asyncIterator]=="function",t$=t=>t&&typeof t=="object"&&t.body&&t[Symbol.toStringTag]==="MultipartBody",XL=async t=>{const e=await lSe(t.body);return xL(e,t)},lSe=async t=>{const e=new $L;return await Promise.all(Object.entries(t||{}).map(([r,n])=>FS(e,r,n))),e},FS=async(t,e,r)=>{if(r!==void 0){if(r==null)throw new TypeError(`Received null for "${e}"; to pass null in FormData, you must use the string 'null'`);if(typeof r=="string"||typeof r=="number"||typeof r=="boolean")t.append(e,String(r));else if(iSe(r)){const n=await JL(r);t.append(e,n)}else if(Array.isArray(r))await Promise.all(r.map(n=>FS(t,e+"[]",n)));else if(typeof r=="object")await Promise.all(Object.entries(r).map(([n,i])=>FS(t,`${e}[${n}]`,i)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${r} instead`)}};var ZL={};async function YL(t){const{response:e}=t;if(t.options.stream)return Ys("response",e.status,e.url,e.headers,e.body),t.options.__streamClass?t.options.__streamClass.fromSSEResponse(e,t.controller):Fs.fromSSEResponse(e,t.controller);if(e.status===204)return null;if(t.options.__binaryResponse)return e;const r=e.headers.get("content-type");if(r?.includes("application/json")||r?.includes("application/vnd.api+json")){const a=await e.json();return Ys("response",e.status,e.url,e.headers,a),a}const i=await e.text();return Ys("response",e.status,e.url,e.headers,i),i}class xv extends Promise{constructor(e,r=YL){super(n=>{n(null)}),this.responsePromise=e,this.parseResponse=r}_thenUnwrap(e){return new xv(this.responsePromise,async r=>e(await this.parseResponse(r)))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,r]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:r}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(e,r){return this.parse().then(e,r)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}class cSe{constructor({baseURL:e,maxRetries:r=2,timeout:n=6e4,httpAgent:i,fetch:a}){this.baseURL=e,this.maxRetries=gO("maxRetries",r),this.timeout=gO("timeout",n),this.httpAgent=i,this.fetch=a??AL}authHeaders(e){return{}}defaultHeaders(e){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),..._Se(),...this.authHeaders(e)}}validateHeaders(e,r){}defaultIdempotencyKey(){return`stainless-node-retry-${OSe()}`}get(e,r){return this.methodRequest("get",e,r)}post(e,r){return this.methodRequest("post",e,r)}patch(e,r){return this.methodRequest("patch",e,r)}put(e,r){return this.methodRequest("put",e,r)}delete(e,r){return this.methodRequest("delete",e,r)}methodRequest(e,r,n){return this.request(Promise.resolve(n).then(async i=>{const a=i&&fj(i?.body)?new DataView(await i.body.arrayBuffer()):i?.body instanceof DataView?i.body:i?.body instanceof ArrayBuffer?new DataView(i.body):i&&ArrayBuffer.isView(i?.body)?new DataView(i.body.buffer):i?.body;return{method:e,path:r,...i,body:a}}))}getAPIList(e,r,n){return this.requestAPIList(r,{method:"get",path:e,...n})}calculateContentLength(e){if(typeof e=="string"){if(typeof Buffer<"u")return Buffer.byteLength(e,"utf8").toString();if(typeof TextEncoder<"u")return new TextEncoder().encode(e).length.toString()}else if(ArrayBuffer.isView(e))return e.byteLength.toString();return null}buildRequest(e){const{method:r,path:n,query:i,headers:a={}}=e,o=ArrayBuffer.isView(e.body)||e.__binaryRequest&&typeof e.body=="string"?e.body:t$(e.body)?e.body.body:e.body?JSON.stringify(e.body,null,2):null,s=this.calculateContentLength(o),l=this.buildURL(n,i);"timeout"in e&&gO("timeout",e.timeout);const c=e.timeout??this.timeout,d=e.httpAgent??this.httpAgent??DL(l),f=c+1e3;typeof d?.options?.timeout=="number"&&f>(d.options.timeout??0)&&(d.options.timeout=f),this.idempotencyHeader&&r!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),a[this.idempotencyHeader]=e.idempotencyKey);const h=this.buildHeaders({options:e,headers:a,contentLength:s});return{req:{method:r,...o&&{body:o},headers:h,...d&&{agent:d},signal:e.signal??null},url:l,timeout:c}}buildHeaders({options:e,headers:r,contentLength:n}){const i={};n&&(i["content-length"]=n);const a=this.defaultHeaders(e);return o$(i,a),o$(i,r),t$(e.body)&&Cc!=="node"&&delete i["content-type"],this.validateHeaders(i,r),i}async prepareOptions(e){}async prepareRequest(e,{url:r,options:n}){}parseHeaders(e){return e?Symbol.iterator in e?Object.fromEntries(Array.from(e).map(r=>[...r])):{...e}:{}}makeStatusError(e,r,n,i){return fr.generate(e,r,n,i)}request(e,r=null){return new xv(this.makeRequest(e,r))}async makeRequest(e,r){const n=await e;r==null&&(r=n.maxRetries??this.maxRetries),await this.prepareOptions(n);const{req:i,url:a,timeout:o}=this.buildRequest(n);if(await this.prepareRequest(i,{url:a,options:n}),Ys("request",a,n,i.headers),n.signal?.aborted)throw new US;const s=new AbortController,l=await this.fetchWithTimeout(a,i,o,s).catch(LS);if(l instanceof Error){if(n.signal?.aborted)throw new US;if(r)return this.retryRequest(n,r);throw l.name==="AbortError"?new BL:new Iv({cause:l})}const c=fSe(l.headers);if(!l.ok){if(r&&this.shouldRetry(l)){const g=`retrying, ${r} attempts remaining`;return Ys(`response (error; ${g})`,l.status,a,c),this.retryRequest(n,r,c)}const d=await l.text().catch(g=>LS(g).message),f=ySe(d),h=f?void 0:d;throw Ys(`response (error; ${r?"(error; no more retries left)":"(error; not retryable)"})`,l.status,a,c,h),this.makeStatusError(l.status,f,h,c)}return{response:l,options:n,controller:s}}requestAPIList(e,r){const n=this.makeRequest(r,null);return new dSe(this,n,e)}buildURL(e,r){const n=gSe(e)?new URL(e):new URL(this.baseURL+(this.baseURL.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),i=this.defaultQuery();return vSe(i)||(r={...i,...r}),typeof r=="object"&&r&&!Array.isArray(r)&&(n.search=this.stringifyQuery(r)),n.toString()}stringifyQuery(e){return Object.entries(e).filter(([r,n])=>typeof n<"u").map(([r,n])=>{if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")return`${encodeURIComponent(r)}=${encodeURIComponent(n)}`;if(n===null)return`${encodeURIComponent(r)}=`;throw new Dn(`Cannot stringify type ${typeof n}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}async fetchWithTimeout(e,r,n,i){const{signal:a,...o}=r||{};a&&a.addEventListener("abort",()=>i.abort());const s=setTimeout(()=>i.abort(),n);return this.getRequestClient().fetch.call(void 0,e,{signal:i.signal,...o}).finally(()=>{clearTimeout(s)})}getRequestClient(){return{fetch:this.fetch}}shouldRetry(e){const r=e.headers.get("x-should-retry");return r==="true"?!0:r==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,r,n){let i;const a=n?.["retry-after-ms"];if(a){const s=parseFloat(a);Number.isNaN(s)||(i=s)}const o=n?.["retry-after"];if(o&&!i){const s=parseFloat(o);Number.isNaN(s)?i=Date.parse(o)-Date.now():i=s*1e3}if(!(i&&0<=i&&i<60*1e3)){const s=e.maxRetries??this.maxRetries;i=this.calculateDefaultRetryTimeoutMillis(r,s)}return await mSe(i),this.makeRequest(e,r-1)}calculateDefaultRetryTimeoutMillis(e,r){const a=r-e,o=Math.min(.5*Math.pow(2,a),8),s=1-Math.random()*.25;return o*s*1e3}getUserAgent(){return`${this.constructor.name}/JS ${Rs}`}}class dSe extends xv{constructor(e,r,n){super(r,async i=>new n(e,i.response,await YL(i),i.options))}async*[Symbol.asyncIterator](){const e=await this;for await(const r of e)yield r}}const fSe=t=>new Proxy(Object.fromEntries(t.entries()),{get(e,r){const n=r.toString();return e[n.toLowerCase()]||e[n]}}),hSe=()=>{if(typeof Deno<"u"&&Deno.build!=null)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Rs,"X-Stainless-OS":n$(Deno.build.os),"X-Stainless-Arch":r$(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:Deno.version?.deno??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Rs,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":process.version};if(Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Rs,"X-Stainless-OS":n$(process.platform),"X-Stainless-Arch":r$(process.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":process.version};const t=pSe();return t?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Rs,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${t.browser}`,"X-Stainless-Runtime-Version":t.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Rs,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function pSe(){if(typeof navigator>"u"||!navigator)return null;const t=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:r}of t){const n=r.exec(navigator.userAgent);if(n){const i=n[1]||0,a=n[2]||0,o=n[3]||0;return{browser:e,version:`${i}.${a}.${o}`}}}return null}const r$=t=>t==="x32"?"x32":t==="x86_64"||t==="x64"?"x64":t==="arm"?"arm":t==="aarch64"||t==="arm64"?"arm64":t?`other:${t}`:"unknown",n$=t=>(t=t.toLowerCase(),t.includes("ios")?"iOS":t==="android"?"Android":t==="darwin"?"MacOS":t==="win32"?"Windows":t==="freebsd"?"FreeBSD":t==="openbsd"?"OpenBSD":t==="linux"?"Linux":t?`Other:${t}`:"Unknown");let i$;const _Se=()=>i$??(i$=hSe()),ySe=t=>{try{return JSON.parse(t)}catch{return}},bSe=new RegExp("^(?:[a-z]+:)?//","i"),gSe=t=>bSe.test(t),mSe=t=>new Promise(e=>setTimeout(e,t)),gO=(t,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new Dn(`${t} must be an integer`);if(e<0)throw new Dn(`${t} must be a positive integer`);return e},LS=t=>t instanceof Error?t:new Error(t),a$=t=>{if(typeof process<"u")return ZL?.[t]?.trim()??void 0;if(typeof Deno<"u")return Deno.env?.get?.(t)?.trim()};function vSe(t){if(!t)return!0;for(const e in t)return!1;return!0}function wSe(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function o$(t,e){for(const r in e){if(!wSe(e,r))continue;const n=r.toLowerCase();if(!n)continue;const i=e[r];i===null?delete t[n]:i!==void 0&&(t[n]=i)}}function Ys(t,...e){typeof process<"u"&&ZL?.DEBUG==="true"&&console.log(`Groq:DEBUG:${t}`,...e)}const OSe=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{const e=Math.random()*16|0;return(t==="x"?e:e&3|8).toString(16)}),SSe=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u";class La{constructor(e){this._client=e}}class By extends La{create(e,r){return this._client.post("/openai/v1/audio/transcriptions",XL({body:e,...r}))}}By||(By={});class Uy extends La{create(e,r){return this._client.post("/openai/v1/audio/translations",XL({body:e,...r}))}}Uy||(Uy={});class Fy extends La{constructor(){super(...arguments),this.transcriptions=new By(this._client),this.translations=new Uy(this._client)}}(function(t){t.Transcriptions=By,t.Translations=Uy})(Fy||(Fy={}));let Ly=class extends La{create(e,r){return this._client.post("/openai/v1/chat/completions",{body:e,...r,stream:e.stream??!1})}};Ly||(Ly={});class Vy extends La{constructor(){super(...arguments),this.completions=new Ly(this._client)}}(function(t){t.Completions=Ly})(Vy||(Vy={}));class ky extends La{}ky||(ky={});class Hy extends La{create(e,r){return this._client.post("/openai/v1/embeddings",{body:e,...r})}}Hy||(Hy={});class qy extends La{retrieve(e,r){return this._client.get(`/openai/v1/models/${e}`,r)}list(e){return this._client.get("/openai/v1/models",e)}delete(e,r){return this._client.delete(`/openai/v1/models/${e}`,r)}}qy||(qy={});var QL;class Nt extends cSe{constructor({baseURL:e=a$("GROQ_BASE_URL"),apiKey:r=a$("GROQ_API_KEY"),...n}={}){if(r===void 0)throw new Dn("The GROQ_API_KEY environment variable is missing or empty; either provide it, or instantiate the Groq client with an apiKey option, like new Groq({ apiKey: 'My API Key' }).");const i={apiKey:r,...n,baseURL:e||"https://api.groq.com"};if(!i.dangerouslyAllowBrowser&&SSe())throw new Dn(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new Groq({ apiKey, dangerouslyAllowBrowser: true })`);super({baseURL:i.baseURL,timeout:i.timeout??6e4,httpAgent:i.httpAgent,maxRetries:i.maxRetries,fetch:i.fetch}),this.completions=new ky(this),this.chat=new Vy(this),this.embeddings=new Hy(this),this.audio=new Fy(this),this.models=new qy(this),this._options=i,this.apiKey=r}defaultQuery(){return this._options.defaultQuery}defaultHeaders(e){return{...super.defaultHeaders(e),...this._options.defaultHeaders}}authHeaders(e){return{Authorization:`Bearer ${this.apiKey}`}}}QL=Nt;Nt.Groq=QL;Nt.GroqError=Dn;Nt.APIError=fr;Nt.APIConnectionError=Iv;Nt.APIConnectionTimeoutError=BL;Nt.APIUserAbortError=US;Nt.NotFoundError=VL;Nt.ConflictError=kL;Nt.RateLimitError=qL;Nt.BadRequestError=UL;Nt.AuthenticationError=FL;Nt.InternalServerError=GL;Nt.PermissionDeniedError=LL;Nt.UnprocessableEntityError=HL;Nt.toFile=JL;Nt.fileFromPath=NL;(function(t){t.Completions=ky,t.Chat=Vy,t.Embeddings=Hy,t.Audio=Fy,t.Models=qy})(Nt||(Nt={}));function ESe(t){const e=t._getType();switch(e){case"system":return"system";case"ai":return"assistant";case"human":return"user";case"function":return"function";case"tool":return"tool";default:throw new Error(`Unknown message type: ${e}`)}}function s$(t){return t.map(e=>{if(typeof e.content!="string")throw new Error("Non string message content not supported");const r={role:ESe(e),content:e.content,name:e.name,function_call:e.additional_kwargs.function_call,tool_calls:e.additional_kwargs.tool_calls,tool_call_id:e.tool_call_id};return ii(e)&&e.tool_calls?.length?r.tool_calls=e.tool_calls.map(_x):(e.additional_kwargs.tool_calls!=null&&(r.tool_calls=e.additional_kwargs.tool_calls),e.tool_call_id!=null&&(r.tool_call_id=e.tool_call_id)),r})}function PSe(t,e){const r=t.tool_calls;switch(t.role){case"assistant":{const n=[],i=[];for(const a of r??[])try{n.push(qE(a,{returnId:!0}))}catch(o){i.push(yx(a,o.message))}return new Nn({content:t.content||"",additional_kwargs:{tool_calls:r},tool_calls:n,invalid_tool_calls:i,usage_metadata:e})}default:return new Co(t.content||"",t.role??"unknown")}}function jSe(t,e){if(t?.length)return t.map(r=>({id:r.id,name:r.function?.name,args:r.function?.arguments,type:"tool_call_chunk",index:e}))}function CSe(t,e,r){const{role:n}=t,i=t.content??"";let a;t.function_call?a={function_call:t.function_call}:t.tool_calls?a={tool_calls:t.tool_calls}:a={};let o,s;if(r?.usage&&(o={input_tokens:r.usage.prompt_tokens,output_tokens:r.usage.completion_tokens,total_tokens:r.usage.total_tokens},s=r.id),n==="user")return{message:new Xc({content:i})};if(n==="assistant"){const l=jSe(t.tool_calls,e);return{message:new vt({content:i,additional_kwargs:a,tool_call_chunks:l?l.map(c=>({type:c.type,args:c.args,index:c.index})):void 0,usage_metadata:o,id:s}),toolCallData:l?l.map(c=>({id:c.id??"",name:c.name??"",index:c.index??e,type:"tool_call_chunk"})):void 0}}else return n==="system"?{message:new Qs({content:i})}:{message:new Jc({content:i,role:n})}}class MSe extends un{static lc_name(){return"ChatGroq"}_llmType(){return"groq"}get lc_secrets(){return{apiKey:"GROQ_API_KEY"}}constructor(e){super(e??{}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","chat_models","groq"]}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"modelName",{enumerable:!0,configurable:!0,writable:!0,value:"mixtral-8x7b-32768"}),Object.defineProperty(this,"model",{enumerable:!0,configurable:!0,writable:!0,value:"mixtral-8x7b-32768"}),Object.defineProperty(this,"temperature",{enumerable:!0,configurable:!0,writable:!0,value:.7}),Object.defineProperty(this,"stop",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stopSequences",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxTokens",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"streaming",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0});const r=e?.apiKey||Ye("GROQ_API_KEY");if(!r)throw new Error('Groq API key not found. Please set the GROQ_API_KEY environment variable or provide the key into "apiKey"');const n={"User-Agent":"langchainjs",...e?.defaultHeaders??{}};this.client=new Nt({apiKey:r,dangerouslyAllowBrowser:!0,baseURL:e?.baseUrl,timeout:e?.timeout,httpAgent:e?.httpAgent,fetch:e?.fetch,maxRetries:0,defaultHeaders:n,defaultQuery:e?.defaultQuery}),this.apiKey=r,this.temperature=e?.temperature??this.temperature,this.modelName=e?.model??e?.modelName??this.model,this.model=this.modelName,this.streaming=e?.streaming??this.streaming,this.stop=e?.stopSequences??(typeof e?.stop=="string"?[e.stop]:e?.stop)??[],this.stopSequences=this.stop,this.maxTokens=e?.maxTokens}getLsParams(e){const r=this.invocationParams(e);return{ls_provider:"groq",ls_model_name:this.model,ls_model_type:"chat",ls_temperature:r.temperature??this.temperature,ls_max_tokens:r.max_tokens??this.maxTokens,ls_stop:e.stop}}async completionWithRetry(e,r){return this.caller.call(async()=>this.client.chat.completions.create(e,r))}invocationParams(e){const r=super.invocationParams(e);return e.tool_choice!==void 0&&(r.tool_choice=e.tool_choice),e.tools!==void 0&&(r.tools=e.tools),e.response_format!==void 0&&(r.response_format=e.response_format),{...r,stop:e.stop??this.stopSequences,model:this.model,temperature:this.temperature,max_tokens:this.maxTokens}}bindTools(e,r){return this.bind({tools:e.map(n=>WH(n)),...r})}async*_streamResponseChunks(e,r,n){const i=this.invocationParams(r),a=s$(e),o=await this.completionWithRetry({...i,messages:a,stream:!0},{signal:r?.signal,headers:r?.headers});let s="";const l=[];let c;for await(const d of o){c=d;const f=d?.choices[0];if(!f)continue;f.delta?.role&&(s=f.delta.role);const{message:h,toolCallData:p}=CSe({...f.delta,role:s},f.index,d.x_groq);if(p){const g=p.filter(v=>l.every(E=>E.id!==v.id));l.push(...g),yield new Mr({message:new vt({content:"",tool_call_chunks:g}),text:""})}const b=new Mr({message:h,text:f.delta.content??"",generationInfo:{finishReason:f.finish_reason}});yield b,n?.handleLLMNewToken(b.text??"")}if(c&&("choices"in c&&delete c.choices,yield new Mr({message:new vt({content:"",response_metadata:c}),text:""})),r.signal?.aborted)throw new Error("AbortError")}async _generate(e,r,n){if(this.streaming){const i={},a=this._streamResponseChunks(e,r,n),o={};for await(const l of a){const c=l.generationInfo?.completion??0;o[c]===void 0?o[c]=l:o[c]=o[c].concat(l)}return{generations:Object.entries(o).sort(([l],[c])=>parseInt(l,10)-parseInt(c,10)).map(([l,c])=>c),llmOutput:{estimatedTokenUsage:i}}}else return this._generateNonStreaming(e,r,n)}async _generateNonStreaming(e,r,n){const i={},a=this.invocationParams(r),o=s$(e),s=await this.completionWithRetry({...a,stream:!1,messages:o},{signal:r?.signal,headers:r?.headers});if("usage"in s&&s.usage){const{completion_tokens:c,prompt_tokens:d,total_tokens:f}=s.usage;c&&(i.completionTokens=(i.completionTokens??0)+c),d&&(i.promptTokens=(i.promptTokens??0)+d),f&&(i.totalTokens=(i.totalTokens??0)+f)}const l=[];if("choices"in s&&s.choices)for(const c of s.choices){const d=c.message?.content??"";let f;i.totalTokens!==void 0&&(f={input_tokens:i.promptTokens??0,output_tokens:i.completionTokens??0,total_tokens:i.totalTokens});const h={text:d,message:PSe(c.message??{role:"assistant"},f)};h.generationInfo={...c.finish_reason?{finish_reason:c.finish_reason}:{},...c.logprobs?{logprobs:c.logprobs}:{}},l.push(h)}return{generations:l,llmOutput:{tokenUsage:i}}}withStructuredOutput(e,r){const n=e,i=r?.name,a=r?.method,o=r?.includeRaw;let s=i??"extract",l,c;if(a==="jsonMode")c=this.bind({response_format:{type:"json_object"}}),yu(n)?l=YO.fromZodSchema(n):l=new QO;else if(yu(n)){const p=ui(n);c=this.bind({tools:[{type:"function",function:{name:s,description:p.description,parameters:p}}],tool_choice:{type:"function",function:{name:s}}}),l=new Oy({returnSingle:!0,keyName:s,zodSchema:n})}else{let p;typeof n.name=="string"&&typeof n.parameters=="object"&&n.parameters!=null?(p=n,s=n.name):(s=n.title??s,p={name:s,description:n.description??"",parameters:n}),c=this.bind({tools:[{type:"function",function:p}],tool_choice:{type:"function",function:{name:s}}}),l=new Oy({returnSingle:!0,keyName:s})}if(!o)return c.pipe(l).withConfig({runName:"ChatGroqStructuredOutput"});const d=li.assign({parsed:(p,b)=>l.invoke(p.raw,b)}),f=li.assign({parsed:()=>null}),h=d.withFallbacks({fallbacks:[f]});return Gr.from([{raw:c},h]).withConfig({runName:"ChatGroqStructuredOutput"})}}var Ki={};Object.defineProperty(Ki,"__esModule",{value:!0});var e4=Ki.HTTPClient=void 0;Ki.matchContentType=t4;Ki.matchStatusCode=r4;Ki.matchResponse=ASe;Ki.isConnectionError=$Se;Ki.isTimeoutError=ISe;Ki.isAbortError=xSe;const TSe=(t,e)=>e==null?fetch(t):fetch(t,e);class hj{constructor(e={}){this.options=e,this.requestHooks=[],this.requestErrorHooks=[],this.responseHooks=[],this.fetcher=e.fetcher||TSe}async request(e){let r=e;for(const n of this.requestHooks){const i=await n(r);i&&(r=i)}try{const n=await this.fetcher(r);for(const i of this.responseHooks)await i(n,r);return n}catch(n){for(const i of this.requestErrorHooks)await i(n,r);throw n}}addHook(...e){if(e[0]==="beforeRequest")this.requestHooks.push(e[1]);else if(e[0]==="requestError")this.requestErrorHooks.push(e[1]);else if(e[0]==="response")this.responseHooks.push(e[1]);else throw new Error(`Invalid hook type: ${e[0]}`);return this}removeHook(...e){let r;if(e[0]==="beforeRequest")r=this.requestHooks;else if(e[0]==="requestError")r=this.requestErrorHooks;else if(e[0]==="response")r=this.responseHooks;else throw new Error(`Invalid hook type: ${e[0]}`);const n=r.findIndex(i=>i===e[1]);return n>=0&&r.splice(n,1),this}clone(){const e=new hj(this.options);return e.requestHooks=this.requestHooks.slice(),e.requestErrorHooks=this.requestErrorHooks.slice(),e.responseHooks=this.responseHooks.slice(),e}}e4=Ki.HTTPClient=hj;const u$=/\s*;\s*/g;function t4(t,e){if(e==="*")return!0;let r=t.headers.get("content-type")?.trim()||"application/octet-stream";r=r.toLowerCase();const n=e.toLowerCase().trim().split(u$),[i="",...a]=n;if(i.split("/").length!==2)return!1;const o=r.split(u$),[s="",...l]=o,[c="",d=""]=s.split("/");if(!c||!d||i!=="*/*"&&s!==i&&`${c}/*`!==i&&`*/${d}`!==i||l.length<a.length)return!1;const f=new Set(l);for(const h of a)if(!f.has(h))return!1;return!0}const RSe=new RegExp("^[0-9]xx$","i");function r4(t,e){const r=`${t.status}`,n=Array.isArray(e)?e:[e];return n.length?n.some(i=>{const a=`${i}`;if(a==="default")return!0;if(!RSe.test(`${a}`))return a===r;const o=a.charAt(0);if(!o)throw new Error("Invalid status code range");const s=r.charAt(0);if(!s)throw new Error(`Invalid response status code: ${r}`);return s===o}):!1}function ASe(t,e,r){return r4(t,e)&&t4(t,r)}function $Se(t){if(typeof t!="object"||t==null)return!1;const e=t instanceof TypeError&&t.message.toLowerCase().startsWith("failed to fetch"),r=t instanceof TypeError&&t.message.toLowerCase().startsWith("fetch failed"),n="name"in t&&t.name==="ConnectionError",i="code"in t&&typeof t.code=="string"&&t.code.toLowerCase()==="econnreset";return e||r||i||n}function ISe(t){if(typeof t!="object"||t==null)return!1;const e="name"in t&&t.name==="TimeoutError",r="code"in t&&t.code===23,n="code"in t&&typeof t.code=="string"&&t.code.toLowerCase()==="econnaborted";return e||r||n}function xSe(t){if(typeof t!="object"||t==null)return!1;const e="name"in t&&t.name==="AbortError",r="code"in t&&t.code===20,n="code"in t&&typeof t.code=="string"&&t.code.toLowerCase()==="econnaborted";return e||r||n}class DSe extends Px{static lc_name(){return"MistralAI"}constructor(e){super(e??{}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","llms","mistralai"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"model",{enumerable:!0,configurable:!0,writable:!0,value:"codestral-latest"}),Object.defineProperty(this,"temperature",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"topP",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxTokens",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"randomSeed",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"streaming",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"batchSize",{enumerable:!0,configurable:!0,writable:!0,value:20}),Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"endpoint",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"serverURL",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxRetries",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxConcurrency",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"beforeRequestHooks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"requestErrorHooks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"responseHooks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"httpClient",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.model=e?.model??this.model,this.temperature=e?.temperature??this.temperature,this.topP=e?.topP??this.topP,this.maxTokens=e?.maxTokens??this.maxTokens,this.randomSeed=e?.randomSeed??this.randomSeed,this.batchSize=e?.batchSize??this.batchSize,this.streaming=e?.streaming??this.streaming,this.serverURL=e?.serverURL??this.serverURL,this.maxRetries=e?.maxRetries,this.maxConcurrency=e?.maxConcurrency,this.beforeRequestHooks=e?.beforeRequestHooks??this.beforeRequestHooks,this.requestErrorHooks=e?.requestErrorHooks??this.requestErrorHooks,this.responseHooks=e?.responseHooks??this.responseHooks,this.httpClient=e?.httpClient??this.httpClient;const r=e?.apiKey??Ye("MISTRAL_API_KEY");if(!r)throw new Error(`MistralAI requires an API key to be set.
Either provide one via the "apiKey" field in the constructor, or set the "MISTRAL_API_KEY" environment variable.`);this.apiKey=r,this.addAllHooksToHttpClient()}get lc_secrets(){return{apiKey:"MISTRAL_API_KEY"}}get lc_aliases(){return{apiKey:"mistral_api_key"}}_llmType(){return"mistralai"}invocationParams(e){return{model:this.model,suffix:e.suffix,temperature:this.temperature,maxTokens:this.maxTokens,topP:this.topP,randomSeed:this.randomSeed,stop:e.stop}}async _call(e,r){const n={...this.invocationParams(r),prompt:e};let a=(await this.completionWithRetry(n,r,!1))?.choices?.[0].message.content??"";return Array.isArray(a)&&(a=a[0].type==="text"?a[0].text:""),a}async _generate(e,r,n){const i=WE(e,this.batchSize),a=[],o=this.invocationParams(r);for(let l=0;l<i.length;l+=1){const c=await(async()=>{if(this.streaming){const d=[];for(let f=0;f<i[l].length;f+=1){const h=[];let p;const b=await this.completionWithRetry({...o,prompt:i[l][f]},r,!0);for await(const{data:g}of b){p||(p={id:g.id,object:"chat.completion",created:g.created,model:g.model});for(const v of g.choices){let E=v.delta.content??"";if(Array.isArray(E)){let C="";for(const S of E)if(S.type==="text")C+=S.text;else if(S.type==="image_url"){const N=typeof S.imageUrl=="string"?S.imageUrl:S.imageUrl.url;C+=N}E=C}if(!h[v.index])h[v.index]={index:v.index,message:{role:"assistant",content:E,toolCalls:null},finishReason:v.finishReason??"length"};else{const C=h[v.index];C.message.content+=E,C.finishReason=v.finishReason??"length"}n?.handleLLMNewToken(E,{prompt:v.index,completion:v.index})}}if(r.signal?.aborted)throw new Error("AbortError");d.push({...p,choices:h})}return d}else{const d=[];for(let f=0;f<i[l].length;f+=1){const h=await this.completionWithRetry({...o,prompt:i[l][f]},r,!1);d.push(h)}return d}})();a.push(...c.map(d=>d.choices??[]))}return{generations:a.map(l=>l.map(c=>{let d=c.message?.content??"";return Array.isArray(d)&&(d=d[0].type==="text"?d[0].text:""),{text:d,generationInfo:{finishReason:c.finishReason}}}))}}async completionWithRetry(e,r,n){const{Mistral:i}=await this.imports(),a=new Qc({maxConcurrency:r.maxConcurrency||this.maxConcurrency,maxRetries:this.maxRetries}),o=new i({apiKey:this.apiKey,serverURL:this.serverURL,timeoutMs:r.timeout,...this.httpClient?{httpClient:this.httpClient}:{}});return a.callWithOptions({signal:r.signal},async()=>{try{let s;return n?s=await o.fim.stream(e):s=await o.fim.complete(e),s}catch(s){throw(s.message?.includes("status: 400")||s.message?.toLowerCase().includes("status 400")||s.message?.includes("validation failed"))&&(s.status=400),s}})}async*_streamResponseChunks(e,r,n){const i={...this.invocationParams(r),prompt:e},a=await this.completionWithRetry(i,r,!0);for await(const o of a){const{data:s}=o,l=s?.choices[0];if(!l)continue;let c=l.delta.content??"";Array.isArray(c)&&(c=c[0].type==="text"?c[0].text:"");const d=new Ui({text:c,generationInfo:{finishReason:l.finishReason,tokenUsage:s.usage}});yield d,n?.handleLLMNewToken(d.text??"")}if(r.signal?.aborted)throw new Error("AbortError")}addAllHooksToHttpClient(){try{if(this.removeAllHooksFromHttpClient(),[this.beforeRequestHooks,this.requestErrorHooks,this.responseHooks].some(r=>r&&r.length>0)&&!this.httpClient&&(this.httpClient=new e4),this.beforeRequestHooks)for(const r of this.beforeRequestHooks)this.httpClient?.addHook("beforeRequest",r);if(this.requestErrorHooks)for(const r of this.requestErrorHooks)this.httpClient?.addHook("requestError",r);if(this.responseHooks)for(const r of this.responseHooks)this.httpClient?.addHook("response",r)}catch{throw new Error("Error in adding all hooks")}}removeAllHooksFromHttpClient(){try{if(this.beforeRequestHooks)for(const e of this.beforeRequestHooks)this.httpClient?.removeHook("beforeRequest",e);if(this.requestErrorHooks)for(const e of this.requestErrorHooks)this.httpClient?.removeHook("requestError",e);if(this.responseHooks)for(const e of this.responseHooks)this.httpClient?.removeHook("response",e)}catch{throw new Error("Error in removing hooks")}}removeHookFromHttpClient(e){try{this.httpClient?.removeHook("beforeRequest",e),this.httpClient?.removeHook("requestError",e),this.httpClient?.removeHook("response",e)}catch{throw new Error("Error in removing hook")}}async imports(){const{Mistral:e}=await va(async()=>{const{Mistral:r}=await import("./index-RBvPzMxV.js").then(n=>n.i);return{Mistral:r}},[]);return{Mistral:e}}}var NSe=Object.defineProperty,zSe=(t,e)=>{for(var r in e)NSe(t,r,{get:e[r],enumerable:!0})},BSe={};zSe(BSe,{audioClassification:()=>WSe,audioToAudio:()=>XSe,automaticSpeechRecognition:()=>KSe,chatCompletion:()=>_Ee,chatCompletionStream:()=>yEe,documentQuestionAnswering:()=>bEe,featureExtraction:()=>iEe,fillMask:()=>aEe,imageClassification:()=>ZSe,imageSegmentation:()=>YSe,imageToImage:()=>rEe,imageToText:()=>QSe,objectDetection:()=>eEe,questionAnswering:()=>oEe,request:()=>at,sentenceSimilarity:()=>sEe,streamingRequest:()=>Dv,summarization:()=>uEe,tableQuestionAnswering:()=>lEe,tabularClassification:()=>vEe,tabularRegression:()=>mEe,textClassification:()=>cEe,textGeneration:()=>o4,textGenerationStream:()=>dEe,textToImage:()=>tEe,textToSpeech:()=>JSe,tokenClassification:()=>fEe,translation:()=>hEe,visualQuestionAnswering:()=>gEe,zeroShotClassification:()=>pEe,zeroShotImageClassification:()=>nEe});function USe(t,e){return Object.assign({},...e.map(r=>{if(t[r]!==void 0)return{[r]:t[r]}}))}function FSe(t,e){return t.includes(e)}function LSe(t,e){const r=Array.isArray(e)?e:[e],n=Object.keys(t).filter(i=>!FSe(r,i));return USe(t,n)}function ty(t){return/^http(s?):/.test(t)||t.startsWith("/")}var Os=new Map,VSe=10*60*1e3,kSe=1e3,n4="https://huggingface.co";async function i4(t,e,r){if(ty(t))return null;const n=`${t}:${e}`;let i=Os.get(n);if(i&&i.date<new Date(Date.now()-VSe)&&(Os.delete(n),i=void 0),i===void 0){const a=await(r?.fetch??fetch)(`${n4}/api/models/${t}?expand[]=pipeline_tag`,{headers:e?{Authorization:`Bearer ${e}`}:{}}).then(o=>o.json()).then(o=>o.pipeline_tag).catch(()=>null);if(!a)return null;i={task:a,date:new Date},Os.set(n,{task:a,date:new Date}),Os.size>kSe&&Os.delete(Os.keys().next().value)}return i.task}var l$="https://api-inference.huggingface.co",x_=null;async function a4(t,e){const{accessToken:r,endpointUrl:n,...i}=t;let{model:a}=t;const{forceTask:o,includeCredentials:s,taskHint:l,wait_for_model:c,use_cache:d,dont_load_model:f,chatCompletion:h}=e??{},p={};if(r&&(p.Authorization=`Bearer ${r}`),!a&&!x_&&l){const C=await fetch(`${n4}/api/tasks`);C.ok&&(x_=await C.json())}if(!a&&x_&&l){const C=x_[l];C&&(a=C.models[0].id)}if(!a)throw new Error("No model provided, and no default model found for this task");const b="data"in t&&!!t.data;b||(p["Content-Type"]="application/json"),c&&(p["X-Wait-For-Model"]="true"),d===!1&&(p["X-Use-Cache"]="false"),f&&(p["X-Load-Model"]="0");let g=(()=>{if(n&&ty(a))throw new TypeError("Both model and endpointUrl cannot be URLs");return ty(a)?(console.warn("Using a model URL is deprecated, please use the `endpointUrl` parameter instead"),a):n||(o?`${l$}/pipeline/${o}/${a}`:`${l$}/models/${a}`)})();h&&!g.endsWith("/chat/completions")&&(g+="/v1/chat/completions");let v;typeof s=="string"?v=s:s===!0&&(v="include");const E={headers:p,method:"POST",body:b?t.data:JSON.stringify({...i.model&&ty(i.model)?LSe(i,"model"):i}),...v&&{credentials:v},signal:e?.signal};return{url:g,info:E}}async function at(t,e){const{url:r,info:n}=await a4(t,e),i=await(e?.fetch??fetch)(r,n);if(e?.retry_on_error!==!1&&i.status===503&&!e?.wait_for_model)return at(t,{...e,wait_for_model:!0});if(!i.ok){if(i.headers.get("Content-Type")?.startsWith("application/json")){const a=await i.json();if([400,422,404,500].includes(i.status)&&e?.chatCompletion)throw new Error(`Server ${t.model} does not seem to support chat completion. Error: ${a.error}`);if(a.error)throw new Error(JSON.stringify(a.error))}throw new Error("An error occurred while fetching the blob")}return i.headers.get("Content-Type")?.startsWith("application/json")?await i.json():await i.blob()}function HSe(t){let e,r,n,i=!1;return function(o){e===void 0?(e=o,r=0,n=-1):e=GSe(e,o);const s=e.length;let l=0;for(;r<s;){i&&(e[r]===10&&(l=++r),i=!1);let c=-1;for(;r<s&&c===-1;++r)switch(e[r]){case 58:n===-1&&(n=r-l);break;case 13:i=!0;case 10:c=r;break}if(c===-1)break;t(e.subarray(l,c),n),l=r,n=-1}l===s?e=void 0:l!==0&&(e=e.subarray(l),r-=l)}}function qSe(t,e,r){let n=c$();const i=new TextDecoder;return function(o,s){if(o.length===0)r?.(n),n=c$();else if(s>0){const l=i.decode(o.subarray(0,s)),c=s+(o[s+1]===32?2:1),d=i.decode(o.subarray(c));switch(l){case"data":n.data=n.data?n.data+`
`+d:d;break;case"event":n.event=d;break;case"id":t(n.id=d);break;case"retry":const f=parseInt(d,10);isNaN(f)||e(n.retry=f);break}}}}function GSe(t,e){const r=new Uint8Array(t.length+e.length);return r.set(t),r.set(e,t.length),r}function c$(){return{data:"",event:"",id:"",retry:void 0}}async function*Dv(t,e){const{url:r,info:n}=await a4({...t,stream:!0},e),i=await(e?.fetch??fetch)(r,n);if(e?.retry_on_error!==!1&&i.status===503&&!e?.wait_for_model)return yield*Dv(t,{...e,wait_for_model:!0});if(!i.ok){if(i.headers.get("Content-Type")?.startsWith("application/json")){const c=await i.json();if([400,422,404,500].includes(i.status)&&e?.chatCompletion)throw new Error(`Server ${t.model} does not seem to support chat completion. Error: ${c.error}`);if(c.error)throw new Error(c.error)}throw new Error(`Server response contains error: ${i.status}`)}if(!i.headers.get("content-type")?.startsWith("text/event-stream"))throw new Error("Server does not support event stream content type, it returned "+i.headers.get("content-type"));if(!i.body)return;const a=i.body.getReader();let o=[];const l=HSe(qSe(()=>{},()=>{},c=>{o.push(c)}));try{for(;;){const{done:c,value:d}=await a.read();if(c)return;l(d);for(const f of o)if(f.data.length>0){if(f.data==="[DONE]")return;const h=JSON.parse(f.data);if(typeof h=="object"&&h!==null&&"error"in h)throw new Error(h.error);yield h}o=[]}}finally{a.releaseLock()}}var ct=class extends TypeError{constructor(t){super(`Invalid inference output: ${t}. Use the 'request' method with the same parameters to do a custom call with no type checking.`),this.name="InferenceOutputError"}};async function WSe(t,e){const r=await at(t,{...e,taskHint:"audio-classification"});if(!(Array.isArray(r)&&r.every(i=>typeof i.label=="string"&&typeof i.score=="number")))throw new ct("Expected Array<{label: string, score: number}>");return r}async function KSe(t,e){const r=await at(t,{...e,taskHint:"automatic-speech-recognition"});if(!(typeof r?.text=="string"))throw new ct("Expected {text: string}");return r}async function JSe(t,e){const r=await at(t,{...e,taskHint:"text-to-speech"});if(!(r&&r instanceof Blob))throw new ct("Expected Blob");return r}async function XSe(t,e){const r=await at(t,{...e,taskHint:"audio-to-audio"});if(!(Array.isArray(r)&&r.every(i=>typeof i.label=="string"&&typeof i.blob=="string"&&typeof i["content-type"]=="string")))throw new ct("Expected Array<{label: string, blob: string, content-type: string}>");return r}async function ZSe(t,e){const r=await at(t,{...e,taskHint:"image-classification"});if(!(Array.isArray(r)&&r.every(i=>typeof i.label=="string"&&typeof i.score=="number")))throw new ct("Expected Array<{label: string, score: number}>");return r}async function YSe(t,e){const r=await at(t,{...e,taskHint:"image-segmentation"});if(!(Array.isArray(r)&&r.every(i=>typeof i.label=="string"&&typeof i.mask=="string"&&typeof i.score=="number")))throw new ct("Expected Array<{label: string, mask: string, score: number}>");return r}async function QSe(t,e){const r=(await at(t,{...e,taskHint:"image-to-text"}))?.[0];if(typeof r?.generated_text!="string")throw new ct("Expected {generated_text: string}");return r}async function eEe(t,e){const r=await at(t,{...e,taskHint:"object-detection"});if(!(Array.isArray(r)&&r.every(i=>typeof i.label=="string"&&typeof i.score=="number"&&typeof i.box.xmin=="number"&&typeof i.box.ymin=="number"&&typeof i.box.xmax=="number"&&typeof i.box.ymax=="number")))throw new ct("Expected Array<{label:string; score:number; box:{xmin:number; ymin:number; xmax:number; ymax:number}}>");return r}async function tEe(t,e){const r=await at(t,{...e,taskHint:"text-to-image"});if(!(r&&r instanceof Blob))throw new ct("Expected Blob");return r}function Nv(t){if(globalThis.Buffer)return globalThis.Buffer.from(t).toString("base64");{const e=[];return t.forEach(r=>{e.push(String.fromCharCode(r))}),globalThis.btoa(e.join(""))}}async function rEe(t,e){let r;t.parameters?r={...t,inputs:Nv(new Uint8Array(t.inputs instanceof ArrayBuffer?t.inputs:await t.inputs.arrayBuffer()))}:r={accessToken:t.accessToken,model:t.model,data:t.inputs};const n=await at(r,{...e,taskHint:"image-to-image"});if(!(n&&n instanceof Blob))throw new ct("Expected Blob");return n}async function nEe(t,e){const r={...t,inputs:{image:Nv(new Uint8Array(t.inputs.image instanceof ArrayBuffer?t.inputs.image:await t.inputs.image.arrayBuffer()))}},n=await at(r,{...e,taskHint:"zero-shot-image-classification"});if(!(Array.isArray(n)&&n.every(a=>typeof a.label=="string"&&typeof a.score=="number")))throw new ct("Expected Array<{label: string, score: number}>");return n}async function iEe(t,e){const r=t.model?await i4(t.model,t.accessToken,e):void 0,n=await at(t,{...e,taskHint:"feature-extraction",...r==="sentence-similarity"&&{forceTask:"feature-extraction"}});let i=!0;const a=(o,s,l=0)=>l>s?!1:o.every(c=>Array.isArray(c))?o.every(c=>a(c,s,l+1)):o.every(c=>typeof c=="number");if(i=Array.isArray(n)&&a(n,3,0),!i)throw new ct("Expected Array<number[][][] | number[][] | number[] | number>");return n}async function aEe(t,e){const r=await at(t,{...e,taskHint:"fill-mask"});if(!(Array.isArray(r)&&r.every(i=>typeof i.score=="number"&&typeof i.sequence=="string"&&typeof i.token=="number"&&typeof i.token_str=="string")))throw new ct("Expected Array<{score: number, sequence: string, token: number, token_str: string}>");return r}async function oEe(t,e){const r=await at(t,{...e,taskHint:"question-answering"});if(!(typeof r=="object"&&!!r&&typeof r.answer=="string"&&typeof r.end=="number"&&typeof r.score=="number"&&typeof r.start=="number"))throw new ct("Expected {answer: string, end: number, score: number, start: number}");return r}async function sEe(t,e){const r=t.model?await i4(t.model,t.accessToken,e):void 0,n=await at(t,{...e,taskHint:"sentence-similarity",...r==="feature-extraction"&&{forceTask:"sentence-similarity"}});if(!(Array.isArray(n)&&n.every(a=>typeof a=="number")))throw new ct("Expected number[]");return n}async function uEe(t,e){const r=await at(t,{...e,taskHint:"summarization"});if(!(Array.isArray(r)&&r.every(i=>typeof i?.summary_text=="string")))throw new ct("Expected Array<{summary_text: string}>");return r?.[0]}async function lEe(t,e){const r=await at(t,{...e,taskHint:"table-question-answering"});if(!(typeof r?.aggregator=="string"&&typeof r.answer=="string"&&Array.isArray(r.cells)&&r.cells.every(i=>typeof i=="string")&&Array.isArray(r.coordinates)&&r.coordinates.every(i=>Array.isArray(i)&&i.every(a=>typeof a=="number"))))throw new ct("Expected {aggregator: string, answer: string, cells: string[], coordinates: number[][]}");return r}async function cEe(t,e){const r=(await at(t,{...e,taskHint:"text-classification"}))?.[0];if(!(Array.isArray(r)&&r.every(i=>typeof i?.label=="string"&&typeof i.score=="number")))throw new ct("Expected Array<{label: string, score: number}>");return r}function zv(t){return Array.isArray(t)?t:[t]}async function o4(t,e){const r=zv(await at(t,{...e,taskHint:"text-generation"}));if(!(Array.isArray(r)&&r.every(i=>typeof i?.generated_text=="string")))throw new ct("Expected Array<{generated_text: string}>");return r?.[0]}async function*dEe(t,e){yield*Dv(t,{...e,taskHint:"text-generation"})}async function fEe(t,e){const r=zv(await at(t,{...e,taskHint:"token-classification"}));if(!(Array.isArray(r)&&r.every(i=>typeof i.end=="number"&&typeof i.entity_group=="string"&&typeof i.score=="number"&&typeof i.start=="number"&&typeof i.word=="string")))throw new ct("Expected Array<{end: number, entity_group: string, score: number, start: number, word: string}>");return r}async function hEe(t,e){const r=await at(t,{...e,taskHint:"translation"});if(!(Array.isArray(r)&&r.every(i=>typeof i?.translation_text=="string")))throw new ct("Expected type Array<{translation_text: string}>");return r?.length===1?r?.[0]:r}async function pEe(t,e){const r=zv(await at(t,{...e,taskHint:"zero-shot-classification"}));if(!(Array.isArray(r)&&r.every(i=>Array.isArray(i.labels)&&i.labels.every(a=>typeof a=="string")&&Array.isArray(i.scores)&&i.scores.every(a=>typeof a=="number")&&typeof i.sequence=="string")))throw new ct("Expected Array<{labels: string[], scores: number[], sequence: string}>");return r}async function _Ee(t,e){const r=await at(t,{...e,taskHint:"text-generation",chatCompletion:!0});if(!(typeof r=="object"&&Array.isArray(r?.choices)&&typeof r?.created=="number"&&typeof r?.id=="string"&&typeof r?.model=="string"&&typeof r?.system_fingerprint=="string"&&typeof r?.usage=="object"))throw new ct("Expected ChatCompletionOutput");return r}async function*yEe(t,e){yield*Dv(t,{...e,taskHint:"text-generation",chatCompletion:!0})}async function bEe(t,e){const r={...t,inputs:{question:t.inputs.question,image:Nv(new Uint8Array(t.inputs.image instanceof ArrayBuffer?t.inputs.image:await t.inputs.image.arrayBuffer()))}},n=zv(await at(r,{...e,taskHint:"document-question-answering"}))?.[0];if(!(typeof n?.answer=="string"&&(typeof n.end=="number"||typeof n.end>"u")&&(typeof n.score=="number"||typeof n.score>"u")&&(typeof n.start=="number"||typeof n.start>"u")))throw new ct("Expected Array<{answer: string, end?: number, score?: number, start?: number}>");return n}async function gEe(t,e){const r={...t,inputs:{question:t.inputs.question,image:Nv(new Uint8Array(t.inputs.image instanceof ArrayBuffer?t.inputs.image:await t.inputs.image.arrayBuffer()))}},n=(await at(r,{...e,taskHint:"visual-question-answering"}))?.[0];if(!(typeof n?.answer=="string"&&typeof n.score=="number"))throw new ct("Expected Array<{answer: string, score: number}>");return n}async function mEe(t,e){const r=await at(t,{...e,taskHint:"tabular-regression"});if(!(Array.isArray(r)&&r.every(i=>typeof i=="number")))throw new ct("Expected number[]");return r}async function vEe(t,e){const r=await at(t,{...e,taskHint:"tabular-classification"});if(!(Array.isArray(r)&&r.every(i=>typeof i=="number")))throw new ct("Expected number[]");return r}function wEe(){const t=document.getElementById("apiKey").value,e=document.getElementById("aiModel").value;let r,n,i=!1,a=!1;switch(e){case"OpenAI":r=new GE({model:"gpt-4o-mini",temperature:0,apiKey:t}),n=new tS({model:"text-embedding-3-small",apiKey:t});break;case"Anthropic":r=new Qq({model:"claude-3-5-sonnet-20240620",apiKey:t}),i=!0;break;case"Azure":r=new aq({model:"gpt-4o",temperature:0,azureOpenAIApiKey:t}),n=new oq({azureOpenAIApiEmbeddingsDeploymentName:"text-embedding-ada-002"});break;case"Google":r=new JG({model:"gemini-1.5-pro",temperature:0,apiKey:t}),i=!0;break;case"Cohere":r=new ZOe({model:"command-r-plus",temperature:0,apiKey:t}),n=new YOe({model:"embed-english-v3.0"});break;case"FireworksAI":r=new eG({model:"accounts/fireworks/models/llama-v3p1-70b-instruct",temperature:0,apiKey:t}),i=!0;break;case"Groq":r=new MSe({model:"mixtral-8x7b-32768",temperature:0,apiKey:t}),i=!0;break;case"MistralAI":r=new DSe({model:"codestral-latest",temperature:0,apiKey:t}),i=!0;break;case"TogetherAI":r=new uG({model:"meta-llama/Meta-Llama-3.1-8B-Instruct-Turbo",maxTokens:256,apiKey:t}),i=!0;break;case"HuggingFace":i=!0,a=!0;break;default:console.log("Invalid LLM model selected")}if(i){const o=document.getElementById("otherApiKey").value;n=new tS({model:"text-embedding-3-small",apiKey:o})}return{llm:r,embeddings:n,huggingface:a}}async function OEe(t,e,r){try{const n=r.replace("{context}",t).replace("{query}",e);return(await o4({accessToken:document.getElementById("apiKey").value,model:document.getElementById("huggingFaceModel").value,inputs:n,parameters:{max_new_tokens:50}})).generated_text}catch(n){return console.error("Error:",n),"Error generating response with HuggingFace"}}let Ti=null;async function SEe(){const{llm:t,embeddings:e,huggingface:r}=wEe(),n=new sE(e),a=await new by({chunkSize:1e3,chunkOverlap:100}).splitDocuments(Ti);console.log("Splitted Documents:",a),await n.addDocuments(a);const o=document.getElementById("userQuery").value,s=await n.similaritySearch(o,3);console.log("Top matches:",s);const l=s.map((d,f)=>`Source ${f+1}: ${d.metadata.source}
${d.pageContent}`).join(`

`);console.log("Context:",l),console.log("Query:",o);let c="";if(r)c=await OEe(l,o,Pj);else{const d=dc.fromTemplate(Pj);c=(await Gr.from([d,t]).invoke({context:l,query:o})).content}return document.getElementById("response").innerText=c,c}async function EEe(){const t=document.getElementById("sourceType").value,e=document.getElementById("githubToken").value,r=document.getElementById("sourceUrl").value;if(t==="feedAPI")console.log("Pulling data from API feed..."),Ti=await Bk(Ti),console.log("Contents:",Ti);else try{Ti=await Nk(r,t,e),console.log("Contents:",Ti)}catch(n){console.log("Error loading documents:",n)}}function pj(t){Ti=t}function PEe(){return console.log(Ti),Ti}function jEe(t){const n=new DOMParser().parseFromString(t,"text/xml").getElementsByTagName("item"),i=[];for(let a=0;a<n.length;a++){const o=n[a],s=o.querySelector("link")?o.querySelector("link").textContent:"No link",l=o.querySelector("description")?o.querySelector("description").textContent:"No description",c=o.querySelector("pubDate")?o.querySelector("pubDate").textContent:"No date",d=o.querySelector("guid")?o.querySelector("guid").textContent:"No GUID";i.push({link:s,description:l,pubDate:c,guid:d})}console.log("Parsed RSS Items:",i),pj(i)}function CEe(t){console.log("Making CORS request to:",t),fetch("https://cors-anywhere.herokuapp.com/"+t).then(r=>(console.log("CORS Response Status:",r.status),r.text())).then(r=>{if(console.log("CORS Response Data:",r),r.startsWith("<?xml"))console.log("Received XML data, parsing..."),jEe(r);else try{const n=JSON.parse(r);pj(n)}catch(n){console.error("Error parsing JSON:",n)}}).catch(r=>{console.error("CORS request failed:",r)})}function MEe(t){console.log("CORS not needed URL:",t),fetch(t).then(e=>e.json()).then(e=>{console.log("Fetched data:",e),pj(e)}).catch(e=>{console.error("Data fetch failed:",e)})}function TEe(){document.getElementById("corsLink").style.display="block"}function REe(){document.getElementById("corsLink").style.display="none"}function d$(){const t=document.getElementById("aiModel").value,e=document.getElementById("otherApiKeyContainer"),r=["Anthropic","Google","FireworksAI","Groq","MistralAI","TogetherAI","HuggingFace"].includes(t);e.style.display=r?"block":"none"}function AEe(){const t=`https://sheets.googleapis.com/v4/spreadsheets/${f$}/values/${h$}?key=${p$}`;fetch(t).then(e=>e.json()).then(e=>{console.log("Success:",e),$Ee(e.values)}).catch(e=>{console.error("Error:",e)})}function $Ee(t){const e=document.getElementById("apiFeeds");e.innerHTML="";const r=document.createElement("option");r.value="none",r.textContent="Select a feed.......",e.appendChild(r),t.forEach(i=>{const a=document.createElement("option");a.value=i[0],a.textContent=i[1],e.appendChild(a)});const n=localStorage.getItem("selectedFeed");n&&(e.value=n,_j(n))}function IEe(t){return new Promise((e,r)=>{const n=`https://sheets.googleapis.com/v4/spreadsheets/${f$}/values/${h$}?key=${p$}`;fetch(n).then(i=>i.json()).then(i=>{const a=i.values.find(o=>o[0]===t);a?e({url:a[9],cors:a[8]}):r("Feed not found")}).catch(i=>r(i))})}function _j(t){console.log(`Selected feed: ${t}`),document.getElementById("resultJson").innerHTML="",document.getElementById("resultFull").innerHTML="",localStorage.setItem("selectedFeed",t),IEe(t).then(e=>{if(e){const{url:r,cors:n}=e;console.log(`Feed URL: ${r}, CORS Needed: ${n}`),n==="TRUE"?(console.log("CORS Needed"),TEe(),CEe(r)):(console.log("No CORS Needed"),REe(),MEe(r))}}).catch(e=>{console.error("Error fetching feed details:",e)})}document.addEventListener("DOMContentLoaded",()=>{const t=document.getElementById("submitButton"),e=document.getElementById("aiModel"),r=document.getElementById("contextBtn"),n=document.getElementById("apiFeeds");r.addEventListener("click",PEe),e.addEventListener("change",d$),n.addEventListener("change",i=>_j(i.target.value)),d$(),t.addEventListener("click",async()=>{await SEe()}),AEe()});document.addEventListener("click",function(t){t.target.id==="corsLink"&&t.target.tagName==="A"&&alert("CORS passthrough enabled. Please refresh the page.")});const yj=document.getElementById("sourceUrl");function bj(t){try{const e=new URL(t);return e.hostname==="github.com"||e.hostname.endsWith(".github.com")}catch{return!1}}function s4(t){console.log(`Processing GitHub URL: ${t}`),EEe()}yj.addEventListener("input",function(){const t=this.value.trim();if(t===""){this.classList.remove("border-red-500","border-green-500");return}bj(t)?(this.classList.remove("border-red-500"),this.classList.add("border-green-500")):(this.classList.remove("border-green-500"),this.classList.add("border-red-500"))});yj.addEventListener("blur",function(){const t=this.value.trim();bj(t)&&s4(t)});yj.addEventListener("keydown",function(t){if(t.key==="Enter"){const e=this.value.trim();bj(e)&&s4(e)}});console.log("Application initialized");window.updateFeed=_j;export{u6 as $,FM as A,IO as B,B8 as C,U8 as D,UM as E,jP as F,F8 as G,F1 as H,L8 as I,L1 as J,Xe as K,k8 as L,H8 as M,q8 as N,W8 as O,An as P,K8 as Q,Z8 as R,i5 as S,Y8 as T,Q8 as U,e6 as V,r6 as W,n6 as X,a6 as Y,o6 as Z,s6 as _,cje as a,h6 as a0,k1 as a1,l6 as a2,V1 as a3,c6 as a4,d6 as a5,t6 as a6,f6 as a7,py as a8,p6 as a9,nt as aa,mn as ab,jo as ac,HEe as ad,u as ae,Ki as af,fje as ag,hje as ah,uS as b,K1 as c,N5 as d,dje as e,S5 as f,_je as g,z5 as h,Bw as i,lje as j,tU as k,n5 as l,WB as m,uW as n,U1 as o,pje as p,uC as q,Is as r,j5 as s,P5 as t,D8 as u,N8 as v,x8 as w,qEe as x,z8 as y,ui as z};

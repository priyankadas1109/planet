const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./loadCognitoIdentity.js","./index2.js","./loadSts.js","./index.js"])))=>i.map(i=>d[i]);
var o9=Object.defineProperty;var s9=(a,e,t)=>e in a?o9(a,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[e]=t;var Zs=(a,e,t)=>s9(a,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(n){if(n.ep)return;n.ep=!0;const i=t(n);fetch(n.href,i)}})();const g4="1jQTlXWom-pXvyP9zuTcbdluyvpb43hu2h7anxhF5qlQ",v4="A2:J",w4="AIzaSyC211F_ub1nAGr2Xv-wJGeulMg4nPzG1yE",uP=`
  You are an expert assistant answering questions related to the data pulled from a GitHub repository.
  Use the following context to answer the query:

  Context:
  {context}

  Query:
  {query}

  Provide a detailed, accurate response based on the context provided.
  If you're unsure about something, please say so.
  If the question is unrelated to the context, please say that the question is unrelated or something
  along the lines of that
  
  Answer:
`,u9=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-8][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/i;function Xh(a){return typeof a=="string"&&u9.test(a)}var Ct=[];for(var tm=0;tm<256;++tm)Ct.push((tm+256).toString(16).slice(1));function l9(a,e=0){return(Ct[a[e+0]]+Ct[a[e+1]]+Ct[a[e+2]]+Ct[a[e+3]]+"-"+Ct[a[e+4]]+Ct[a[e+5]]+"-"+Ct[a[e+6]]+Ct[a[e+7]]+"-"+Ct[a[e+8]]+Ct[a[e+9]]+"-"+Ct[a[e+10]]+Ct[a[e+11]]+Ct[a[e+12]]+Ct[a[e+13]]+Ct[a[e+14]]+Ct[a[e+15]]).toLowerCase()}var f_,c9=new Uint8Array(16);function f9(){if(!f_&&(f_=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!f_))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return f_(c9)}var d9=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);const lP={randomUUID:d9};function xt(a,e,t){if(lP.randomUUID&&!a)return lP.randomUUID();a=a||{};var r=a.random||(a.rng||f9)();return r[6]=r[6]&15|64,r[8]=r[8]&63|128,l9(r)}var vf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Np(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}function Mc(a){if(Object.prototype.hasOwnProperty.call(a,"__esModule"))return a;var e=a.default;if(typeof e=="function"){var t=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(a).forEach(function(r){var n=Object.getOwnPropertyDescriptor(a,r);Object.defineProperty(t,r,n.get?n:{enumerable:!0,get:function(){return a[r]}})}),t}var rm,cP;function h9(){return cP||(cP=1,rm=function(a,e){if(typeof a!="string")throw new TypeError("Expected a string");return e=typeof e>"u"?"_":e,a.replace(/([a-z\d])([A-Z])/g,"$1"+e+"$2").replace(/([A-Z]+)([A-Z][a-z\d]+)/g,"$1"+e+"$2").toLowerCase()}),rm}var p9=h9();const _9=Np(p9);var d_={exports:{}},fP;function y9(){if(fP)return d_.exports;fP=1;const a=/[\p{Lu}]/u,e=/[\p{Ll}]/u,t=/^[\p{Lu}](?![\p{Lu}])/gu,r=/([\p{Alpha}\p{N}_]|$)/u,n=/[_.\- ]+/,i=new RegExp("^"+n.source),o=new RegExp(n.source+r.source,"gu"),s=new RegExp("\\d+"+r.source,"gu"),u=(p,h,y)=>{let d=!1,_=!1,m=!1;for(let b=0;b<p.length;b++){const g=p[b];d&&a.test(g)?(p=p.slice(0,b)+"-"+p.slice(b),d=!1,m=_,_=!0,b++):_&&m&&e.test(g)?(p=p.slice(0,b-1)+"-"+p.slice(b-1),m=_,_=!1,d=!0):(d=h(g)===g&&y(g)!==g,m=_,_=y(g)===g&&h(g)!==g)}return p},l=(p,h)=>(t.lastIndex=0,p.replace(t,y=>h(y))),c=(p,h)=>(o.lastIndex=0,s.lastIndex=0,p.replace(o,(y,d)=>h(d)).replace(s,y=>h(y))),f=(p,h)=>{if(!(typeof p=="string"||Array.isArray(p)))throw new TypeError("Expected the input to be `string | string[]`");if(h={pascalCase:!1,preserveConsecutiveUppercase:!1,...h},Array.isArray(p)?p=p.map(m=>m.trim()).filter(m=>m.length).join("-"):p=p.trim(),p.length===0)return"";const y=h.locale===!1?m=>m.toLowerCase():m=>m.toLocaleLowerCase(h.locale),d=h.locale===!1?m=>m.toUpperCase():m=>m.toLocaleUpperCase(h.locale);return p.length===1?h.pascalCase?d(p):y(p):(p!==y(p)&&(p=u(p,y,d)),p=p.replace(i,""),h.preserveConsecutiveUppercase?p=l(p,y):p=y(p),h.pascalCase&&(p=d(p.charAt(0))+p.slice(1)),c(p,d))};return d_.exports=f,d_.exports.default=f,d_.exports}y9();function b9(a,e){return(e==null?void 0:e[a])||_9(a)}function m9(a,e,t){const r={};for(const n in a)Object.hasOwn(a,n)&&(r[e(n,t)]=a[n]);return r}function dP(a){return Array.isArray(a)?[...a]:{...a}}function g9(a,e){const t=dP(a);for(const[r,n]of Object.entries(e)){const[i,...o]=r.split(".").reverse();let s=t;for(const u of o.reverse()){if(s[u]===void 0)break;s[u]=dP(s[u]),s=s[u]}s[i]!==void 0&&(s[i]={lc:1,type:"secret",id:[n]})}return t}function O4(a){const e=Object.getPrototypeOf(a);return typeof a.lc_name=="function"&&(typeof e.lc_name!="function"||a.lc_name()!==e.lc_name())?a.lc_name():a.name}class Gu{static lc_name(){return this.name}get lc_id(){return[...this.lc_namespace,O4(this.constructor)]}get lc_secrets(){}get lc_attributes(){}get lc_aliases(){}get lc_serializable_keys(){}constructor(e,...t){Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.lc_serializable_keys!==void 0?this.lc_kwargs=Object.fromEntries(Object.entries(e||{}).filter(([r])=>{var n;return(n=this.lc_serializable_keys)==null?void 0:n.includes(r)})):this.lc_kwargs=e??{}}toJSON(){if(!this.lc_serializable)return this.toJSONNotImplemented();if(this.lc_kwargs instanceof Gu||typeof this.lc_kwargs!="object"||Array.isArray(this.lc_kwargs))return this.toJSONNotImplemented();const e={},t={},r=Object.keys(this.lc_kwargs).reduce((n,i)=>(n[i]=i in this?this[i]:this.lc_kwargs[i],n),{});for(let n=Object.getPrototypeOf(this);n;n=Object.getPrototypeOf(n))Object.assign(e,Reflect.get(n,"lc_aliases",this)),Object.assign(t,Reflect.get(n,"lc_secrets",this)),Object.assign(r,Reflect.get(n,"lc_attributes",this));return Object.keys(t).forEach(n=>{let i=this,o=r;const[s,...u]=n.split(".").reverse();for(const l of u.reverse()){if(!(l in i)||i[l]===void 0)return;(!(l in o)||o[l]===void 0)&&(typeof i[l]=="object"&&i[l]!=null?o[l]={}:Array.isArray(i[l])&&(o[l]=[])),i=i[l],o=o[l]}s in i&&i[s]!==void 0&&(o[s]=o[s]||i[s])}),{lc:1,type:"constructor",id:this.lc_id,kwargs:m9(Object.keys(t).length?g9(r,t):r,b9,e)}}toJSONNotImplemented(){return{lc:1,type:"not_implemented",id:this.lc_id}}}var nm={};const v9=()=>typeof window<"u"&&typeof window.document<"u",w9=()=>typeof globalThis=="object"&&globalThis.constructor&&globalThis.constructor.name==="DedicatedWorkerGlobalScope",O9=()=>typeof window<"u"&&window.name==="nodejs"||typeof navigator<"u"&&(navigator.userAgent.includes("Node.js")||navigator.userAgent.includes("jsdom")),_R=()=>typeof Deno<"u",S9=()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"&&!_R(),E9=()=>{let a;return v9()?a="browser":S9()?a="node":w9()?a="webworker":O9()?a="jsdom":_R()?a="deno":a="other",a};let im;async function R9(){return im===void 0&&(im={library:"langchain-js",runtime:E9()}),im}function We(a){try{return typeof process<"u"?nm==null?void 0:nm[a]:_R()?Deno==null?void 0:Deno.env.get(a):void 0}catch{return}}class C9{}function S4(a){return"lc_prefer_streaming"in a&&a.lc_prefer_streaming}class qp extends C9{get lc_namespace(){return["langchain_core","callbacks",this.name]}get lc_secrets(){}get lc_attributes(){}get lc_aliases(){}get lc_serializable_keys(){}static lc_name(){return this.name}get lc_id(){return[...this.lc_namespace,O4(this.constructor)]}constructor(e){super(),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"ignoreLLM",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreChain",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreAgent",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreRetriever",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreCustomEvent",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"raiseError",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"awaitHandlers",{enumerable:!0,configurable:!0,writable:!0,value:We("LANGCHAIN_CALLBACKS_BACKGROUND")==="false"}),this.lc_kwargs=e||{},e&&(this.ignoreLLM=e.ignoreLLM??this.ignoreLLM,this.ignoreChain=e.ignoreChain??this.ignoreChain,this.ignoreAgent=e.ignoreAgent??this.ignoreAgent,this.ignoreRetriever=e.ignoreRetriever??this.ignoreRetriever,this.ignoreCustomEvent=e.ignoreCustomEvent??this.ignoreCustomEvent,this.raiseError=e.raiseError??this.raiseError,this.awaitHandlers=this.raiseError||(e._awaitHandler??this.awaitHandlers))}copy(){return new this.constructor(this)}toJSON(){return Gu.prototype.toJSON.call(this)}toJSONNotImplemented(){return Gu.prototype.toJSONNotImplemented.call(this)}static fromMethods(e){class t extends qp{constructor(){super(),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:xt()}),Object.assign(this,e)}}return new t}}const P9=a=>{const e=a;return e!==void 0&&typeof e.copy=="function"&&typeof e.name=="string"&&typeof e.awaitHandlers=="boolean"};var ny={exports:{}};ny.exports;var hP;function j9(){return hP||(hP=1,function(a){const t=(i=0)=>o=>`\x1B[${38+i};5;${o}m`,r=(i=0)=>(o,s,u)=>`\x1B[${38+i};2;${o};${s};${u}m`;function n(){const i=new Map,o={modifier:{reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],overline:[53,55],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},color:{black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],blackBright:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39]},bgColor:{bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgBlackBright:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]}};o.color.gray=o.color.blackBright,o.bgColor.bgGray=o.bgColor.bgBlackBright,o.color.grey=o.color.blackBright,o.bgColor.bgGrey=o.bgColor.bgBlackBright;for(const[s,u]of Object.entries(o)){for(const[l,c]of Object.entries(u))o[l]={open:`\x1B[${c[0]}m`,close:`\x1B[${c[1]}m`},u[l]=o[l],i.set(c[0],c[1]);Object.defineProperty(o,s,{value:u,enumerable:!1})}return Object.defineProperty(o,"codes",{value:i,enumerable:!1}),o.color.close="\x1B[39m",o.bgColor.close="\x1B[49m",o.color.ansi256=t(),o.color.ansi16m=r(),o.bgColor.ansi256=t(10),o.bgColor.ansi16m=r(10),Object.defineProperties(o,{rgbToAnsi256:{value:(s,u,l)=>s===u&&u===l?s<8?16:s>248?231:Math.round((s-8)/247*24)+232:16+36*Math.round(s/255*5)+6*Math.round(u/255*5)+Math.round(l/255*5),enumerable:!1},hexToRgb:{value:s=>{const u=/(?<colorString>[a-f\d]{6}|[a-f\d]{3})/i.exec(s.toString(16));if(!u)return[0,0,0];let{colorString:l}=u.groups;l.length===3&&(l=l.split("").map(f=>f+f).join(""));const c=Number.parseInt(l,16);return[c>>16&255,c>>8&255,c&255]},enumerable:!1},hexToAnsi256:{value:s=>o.rgbToAnsi256(...o.hexToRgb(s)),enumerable:!1}}),o}Object.defineProperty(a,"exports",{enumerable:!0,get:n})}(ny)),ny.exports}var T9=j9();const E4=Np(T9);function am(a,e){return a&&!Array.isArray(a)&&typeof a=="object"?a:{[e]:a}}function M9(a){return a.replace(/[-:.]/g,"")}function A9(a,e,t){const r=t.toFixed(0).slice(0,3).padStart(3,"0");return M9(`${new Date(a).toISOString().slice(0,-1)}${r}Z`)+e}function Hf(a){return typeof a._addRunToRunMap=="function"}class zp extends qp{constructor(e){super(...arguments),Object.defineProperty(this,"runMap",{enumerable:!0,configurable:!0,writable:!0,value:new Map})}copy(){return this}stringifyError(e){return e instanceof Error?e.message+(e!=null&&e.stack?`

${e.stack}`:""):typeof e=="string"?e:`${e}`}_addChildRun(e,t){e.child_runs.push(t)}_addRunToRunMap(e){const t=A9(e.start_time,e.id,e.execution_order),r={...e};if(r.parent_run_id!==void 0){const n=this.runMap.get(r.parent_run_id);n&&(this._addChildRun(n,r),n.child_execution_order=Math.max(n.child_execution_order,r.child_execution_order),r.trace_id=n.trace_id,n.dotted_order!==void 0&&(r.dotted_order=[n.dotted_order,t].join(".")))}else r.trace_id=r.id,r.dotted_order=t;return this.runMap.set(r.id,r),r}async _endTrace(e){var r;const t=e.parent_run_id!==void 0&&this.runMap.get(e.parent_run_id);t?t.child_execution_order=Math.max(t.child_execution_order,e.child_execution_order):await this.persistRun(e),this.runMap.delete(e.id),await((r=this.onRunUpdate)==null?void 0:r.call(this,e))}_getExecutionOrder(e){const t=e!==void 0&&this.runMap.get(e);return t?t.child_execution_order+1:1}_createRunForLLMStart(e,t,r,n,i,o,s,u){const l=this._getExecutionOrder(n),c=Date.now(),f=s?{...i,metadata:s}:i,p={id:r,name:u??e.id[e.id.length-1],parent_run_id:n,start_time:c,serialized:e,events:[{name:"start",time:new Date(c).toISOString()}],inputs:{prompts:t},execution_order:l,child_runs:[],child_execution_order:l,run_type:"llm",extra:f??{},tags:o||[]};return this._addRunToRunMap(p)}async handleLLMStart(e,t,r,n,i,o,s,u){var c,f;const l=this.runMap.get(r)??this._createRunForLLMStart(e,t,r,n,i,o,s,u);return await((c=this.onRunCreate)==null?void 0:c.call(this,l)),await((f=this.onLLMStart)==null?void 0:f.call(this,l)),l}_createRunForChatModelStart(e,t,r,n,i,o,s,u){const l=this._getExecutionOrder(n),c=Date.now(),f=s?{...i,metadata:s}:i,p={id:r,name:u??e.id[e.id.length-1],parent_run_id:n,start_time:c,serialized:e,events:[{name:"start",time:new Date(c).toISOString()}],inputs:{messages:t},execution_order:l,child_runs:[],child_execution_order:l,run_type:"llm",extra:f??{},tags:o||[]};return this._addRunToRunMap(p)}async handleChatModelStart(e,t,r,n,i,o,s,u){var c,f;const l=this.runMap.get(r)??this._createRunForChatModelStart(e,t,r,n,i,o,s,u);return await((c=this.onRunCreate)==null?void 0:c.call(this,l)),await((f=this.onLLMStart)==null?void 0:f.call(this,l)),l}async handleLLMEnd(e,t,r,n,i){var s;const o=this.runMap.get(t);if(!o||(o==null?void 0:o.run_type)!=="llm")throw new Error("No LLM run to end.");return o.end_time=Date.now(),o.outputs=e,o.events.push({name:"end",time:new Date(o.end_time).toISOString()}),o.extra={...o.extra,...i},await((s=this.onLLMEnd)==null?void 0:s.call(this,o)),await this._endTrace(o),o}async handleLLMError(e,t,r,n,i){var s;const o=this.runMap.get(t);if(!o||(o==null?void 0:o.run_type)!=="llm")throw new Error("No LLM run to end.");return o.end_time=Date.now(),o.error=this.stringifyError(e),o.events.push({name:"error",time:new Date(o.end_time).toISOString()}),o.extra={...o.extra,...i},await((s=this.onLLMError)==null?void 0:s.call(this,o)),await this._endTrace(o),o}_createRunForChainStart(e,t,r,n,i,o,s,u){const l=this._getExecutionOrder(n),c=Date.now(),f={id:r,name:u??e.id[e.id.length-1],parent_run_id:n,start_time:c,serialized:e,events:[{name:"start",time:new Date(c).toISOString()}],inputs:t,execution_order:l,child_execution_order:l,run_type:s??"chain",child_runs:[],extra:o?{metadata:o}:{},tags:i||[]};return this._addRunToRunMap(f)}async handleChainStart(e,t,r,n,i,o,s,u){var c,f;const l=this.runMap.get(r)??this._createRunForChainStart(e,t,r,n,i,o,s,u);return await((c=this.onRunCreate)==null?void 0:c.call(this,l)),await((f=this.onChainStart)==null?void 0:f.call(this,l)),l}async handleChainEnd(e,t,r,n,i){var s;const o=this.runMap.get(t);if(!o)throw new Error("No chain run to end.");return o.end_time=Date.now(),o.outputs=am(e,"output"),o.events.push({name:"end",time:new Date(o.end_time).toISOString()}),(i==null?void 0:i.inputs)!==void 0&&(o.inputs=am(i.inputs,"input")),await((s=this.onChainEnd)==null?void 0:s.call(this,o)),await this._endTrace(o),o}async handleChainError(e,t,r,n,i){var s;const o=this.runMap.get(t);if(!o)throw new Error("No chain run to end.");return o.end_time=Date.now(),o.error=this.stringifyError(e),o.events.push({name:"error",time:new Date(o.end_time).toISOString()}),(i==null?void 0:i.inputs)!==void 0&&(o.inputs=am(i.inputs,"input")),await((s=this.onChainError)==null?void 0:s.call(this,o)),await this._endTrace(o),o}_createRunForToolStart(e,t,r,n,i,o,s){const u=this._getExecutionOrder(n),l=Date.now(),c={id:r,name:s??e.id[e.id.length-1],parent_run_id:n,start_time:l,serialized:e,events:[{name:"start",time:new Date(l).toISOString()}],inputs:{input:t},execution_order:u,child_execution_order:u,run_type:"tool",child_runs:[],extra:o?{metadata:o}:{},tags:i||[]};return this._addRunToRunMap(c)}async handleToolStart(e,t,r,n,i,o,s){var l,c;const u=this.runMap.get(r)??this._createRunForToolStart(e,t,r,n,i,o,s);return await((l=this.onRunCreate)==null?void 0:l.call(this,u)),await((c=this.onToolStart)==null?void 0:c.call(this,u)),u}async handleToolEnd(e,t){var n;const r=this.runMap.get(t);if(!r||(r==null?void 0:r.run_type)!=="tool")throw new Error("No tool run to end");return r.end_time=Date.now(),r.outputs={output:e},r.events.push({name:"end",time:new Date(r.end_time).toISOString()}),await((n=this.onToolEnd)==null?void 0:n.call(this,r)),await this._endTrace(r),r}async handleToolError(e,t){var n;const r=this.runMap.get(t);if(!r||(r==null?void 0:r.run_type)!=="tool")throw new Error("No tool run to end");return r.end_time=Date.now(),r.error=this.stringifyError(e),r.events.push({name:"error",time:new Date(r.end_time).toISOString()}),await((n=this.onToolError)==null?void 0:n.call(this,r)),await this._endTrace(r),r}async handleAgentAction(e,t){var i;const r=this.runMap.get(t);if(!r||(r==null?void 0:r.run_type)!=="chain")return;const n=r;n.actions=n.actions||[],n.actions.push(e),n.events.push({name:"agent_action",time:new Date().toISOString(),kwargs:{action:e}}),await((i=this.onAgentAction)==null?void 0:i.call(this,r))}async handleAgentEnd(e,t){var n;const r=this.runMap.get(t);!r||(r==null?void 0:r.run_type)!=="chain"||(r.events.push({name:"agent_end",time:new Date().toISOString(),kwargs:{action:e}}),await((n=this.onAgentEnd)==null?void 0:n.call(this,r)))}_createRunForRetrieverStart(e,t,r,n,i,o,s){const u=this._getExecutionOrder(n),l=Date.now(),c={id:r,name:s??e.id[e.id.length-1],parent_run_id:n,start_time:l,serialized:e,events:[{name:"start",time:new Date(l).toISOString()}],inputs:{query:t},execution_order:u,child_execution_order:u,run_type:"retriever",child_runs:[],extra:o?{metadata:o}:{},tags:i||[]};return this._addRunToRunMap(c)}async handleRetrieverStart(e,t,r,n,i,o,s){var l,c;const u=this.runMap.get(r)??this._createRunForRetrieverStart(e,t,r,n,i,o,s);return await((l=this.onRunCreate)==null?void 0:l.call(this,u)),await((c=this.onRetrieverStart)==null?void 0:c.call(this,u)),u}async handleRetrieverEnd(e,t){var n;const r=this.runMap.get(t);if(!r||(r==null?void 0:r.run_type)!=="retriever")throw new Error("No retriever run to end");return r.end_time=Date.now(),r.outputs={documents:e},r.events.push({name:"end",time:new Date(r.end_time).toISOString()}),await((n=this.onRetrieverEnd)==null?void 0:n.call(this,r)),await this._endTrace(r),r}async handleRetrieverError(e,t){var n;const r=this.runMap.get(t);if(!r||(r==null?void 0:r.run_type)!=="retriever")throw new Error("No retriever run to end");return r.end_time=Date.now(),r.error=this.stringifyError(e),r.events.push({name:"error",time:new Date(r.end_time).toISOString()}),await((n=this.onRetrieverError)==null?void 0:n.call(this,r)),await this._endTrace(r),r}async handleText(e,t){var n;const r=this.runMap.get(t);!r||(r==null?void 0:r.run_type)!=="chain"||(r.events.push({name:"text",time:new Date().toISOString(),kwargs:{text:e}}),await((n=this.onText)==null?void 0:n.call(this,r)))}async handleLLMNewToken(e,t,r,n,i,o){var u;const s=this.runMap.get(r);if(!s||(s==null?void 0:s.run_type)!=="llm")throw new Error('Invalid "runId" provided to "handleLLMNewToken" callback.');return s.events.push({name:"new_token",time:new Date().toISOString(),kwargs:{token:e,idx:t,chunk:o==null?void 0:o.chunk}}),await((u=this.onLLMNewToken)==null?void 0:u.call(this,s,e,{chunk:o==null?void 0:o.chunk})),s}}function Bt(a,e){return`${a.open}${e}${a.close}`}function Tr(a,e){try{return JSON.stringify(a,null,2)}catch{return e}}function pP(a){return typeof a=="string"?a.trim():a==null?a:Tr(a,a.toString())}function Tu(a){if(!a.end_time)return"";const e=a.end_time-a.start_time;return e<1e3?`${e}ms`:`${(e/1e3).toFixed(2)}s`}const{color:Yt}=E4;class _P extends zp{constructor(){super(...arguments),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"console_callback_handler"})}persistRun(e){return Promise.resolve()}getParents(e){const t=[];let r=e;for(;r.parent_run_id;){const n=this.runMap.get(r.parent_run_id);if(n)t.push(n),r=n;else break}return t}getBreadcrumbs(e){const r=[...this.getParents(e).reverse(),e].map((n,i,o)=>{const s=`${n.execution_order}:${n.run_type}:${n.name}`;return i===o.length-1?Bt(E4.bold,s):s}).join(" > ");return Bt(Yt.grey,r)}onChainStart(e){const t=this.getBreadcrumbs(e);console.log(`${Bt(Yt.green,"[chain/start]")} [${t}] Entering Chain run with input: ${Tr(e.inputs,"[inputs]")}`)}onChainEnd(e){const t=this.getBreadcrumbs(e);console.log(`${Bt(Yt.cyan,"[chain/end]")} [${t}] [${Tu(e)}] Exiting Chain run with output: ${Tr(e.outputs,"[outputs]")}`)}onChainError(e){const t=this.getBreadcrumbs(e);console.log(`${Bt(Yt.red,"[chain/error]")} [${t}] [${Tu(e)}] Chain run errored with error: ${Tr(e.error,"[error]")}`)}onLLMStart(e){const t=this.getBreadcrumbs(e),r="prompts"in e.inputs?{prompts:e.inputs.prompts.map(n=>n.trim())}:e.inputs;console.log(`${Bt(Yt.green,"[llm/start]")} [${t}] Entering LLM run with input: ${Tr(r,"[inputs]")}`)}onLLMEnd(e){const t=this.getBreadcrumbs(e);console.log(`${Bt(Yt.cyan,"[llm/end]")} [${t}] [${Tu(e)}] Exiting LLM run with output: ${Tr(e.outputs,"[response]")}`)}onLLMError(e){const t=this.getBreadcrumbs(e);console.log(`${Bt(Yt.red,"[llm/error]")} [${t}] [${Tu(e)}] LLM run errored with error: ${Tr(e.error,"[error]")}`)}onToolStart(e){const t=this.getBreadcrumbs(e);console.log(`${Bt(Yt.green,"[tool/start]")} [${t}] Entering Tool run with input: "${pP(e.inputs.input)}"`)}onToolEnd(e){var r;const t=this.getBreadcrumbs(e);console.log(`${Bt(Yt.cyan,"[tool/end]")} [${t}] [${Tu(e)}] Exiting Tool run with output: "${pP((r=e.outputs)==null?void 0:r.output)}"`)}onToolError(e){const t=this.getBreadcrumbs(e);console.log(`${Bt(Yt.red,"[tool/error]")} [${t}] [${Tu(e)}] Tool run errored with error: ${Tr(e.error,"[error]")}`)}onRetrieverStart(e){const t=this.getBreadcrumbs(e);console.log(`${Bt(Yt.green,"[retriever/start]")} [${t}] Entering Retriever run with input: ${Tr(e.inputs,"[inputs]")}`)}onRetrieverEnd(e){const t=this.getBreadcrumbs(e);console.log(`${Bt(Yt.cyan,"[retriever/end]")} [${t}] [${Tu(e)}] Exiting Retriever run with output: ${Tr(e.outputs,"[outputs]")}`)}onRetrieverError(e){const t=this.getBreadcrumbs(e);console.log(`${Bt(Yt.red,"[retriever/error]")} [${t}] [${Tu(e)}] Retriever run errored with error: ${Tr(e.error,"[error]")}`)}onAgentAction(e){const t=e,r=this.getBreadcrumbs(e);console.log(`${Bt(Yt.blue,"[agent/action]")} [${r}] Agent selected action: ${Tr(t.actions[t.actions.length-1],"[action]")}`)}}function ib(a,e){return a.lc_error_code=e,a.message=`${a.message}

Troubleshooting URL: https://js.langchain.com/docs/troubleshooting/errors/${e}/
`,a}function R4(a){return!!(a&&typeof a=="object"&&"type"in a&&a.type==="tool_call")}class I9 extends Error{constructor(e,t){super(e),Object.defineProperty(this,"output",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.output=t}}function yP(a,e=yR){a=a.trim();const t=/```(json)?(.*)```/s.exec(a);return e(t?t[2]:a)}function yR(a){if(typeof a>"u")return null;try{return JSON.parse(a)}catch{}let e="";const t=[];let r=!1,n=!1;for(let i of a){if(r)i==='"'&&!n?r=!1:i===`
`&&!n?i="\\n":i==="\\"?n=!n:n=!1;else if(i==='"')r=!0,n=!1;else if(i==="{")t.push("}");else if(i==="[")t.push("]");else if(i==="}"||i==="]")if(t&&t[t.length-1]===i)t.pop();else return null;e+=i}r&&(e+='"');for(let i=t.length-1;i>=0;i-=1)e+=t[i];try{return JSON.parse(e)}catch{return null}}function Mf(a,e){return typeof a=="string"?a===""?e:typeof e=="string"?a+e:[{type:"text",text:a},...e]:Array.isArray(e)?ab(a,e)??[...a,...e]:e===""?a:[...a,{type:"text",text:e}]}function D9(a,e){return a==="error"||e==="error"?"error":"success"}function x9(a,e){function t(r,n){if(typeof r!="object"||r===null||r===void 0)return r;if(n>=e)return Array.isArray(r)?"[Array]":"[Object]";if(Array.isArray(r))return r.map(o=>t(o,n+1));const i={};for(const o of Object.keys(r))i[o]=t(r[o],n+1);return i}return JSON.stringify(t(a,0),null,2)}class Ou extends Gu{get lc_aliases(){return{additional_kwargs:"additional_kwargs",response_metadata:"response_metadata"}}get text(){return typeof this.content=="string"?this.content:""}getType(){return this._getType()}constructor(e,t){typeof e=="string"&&(e={content:e,additional_kwargs:t,response_metadata:{}}),e.additional_kwargs||(e.additional_kwargs={}),e.response_metadata||(e.response_metadata={}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","messages"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"content",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"additional_kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"response_metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name=e.name,this.content=e.content,this.additional_kwargs=e.additional_kwargs,this.response_metadata=e.response_metadata,this.id=e.id}toDict(){return{type:this._getType(),data:this.toJSON().kwargs}}static lc_name(){return"BaseMessage"}get _printableFields(){return{id:this.id,content:this.content,name:this.name,additional_kwargs:this.additional_kwargs,response_metadata:this.response_metadata}}_updateId(e){this.id=e,this.lc_kwargs.id=e}get[Symbol.toStringTag](){return this.constructor.lc_name()}[Symbol.for("nodejs.util.inspect.custom")](e){if(e===null)return this;const t=x9(this._printableFields,Math.max(4,e));return`${this.constructor.lc_name()} ${t}`}}function Kt(a,e){const t={...a};for(const[r,n]of Object.entries(e))if(t[r]==null)t[r]=n;else{if(n==null)continue;if(typeof t[r]!=typeof n||Array.isArray(t[r])!==Array.isArray(n))throw new Error(`field[${r}] already exists in the message chunk, but with a different type.`);if(typeof t[r]=="string"){if(r==="type")continue;t[r]+=n}else if(typeof t[r]=="object"&&!Array.isArray(t[r]))t[r]=Kt(t[r],n);else if(Array.isArray(t[r]))t[r]=ab(t[r],n);else{if(t[r]===n)continue;console.warn(`field[${r}] already exists in this message chunk and value has unsupported type.`)}}return t}function ab(a,e){if(!(a===void 0&&e===void 0)){if(a===void 0||e===void 0)return a||e;{const t=[...a];for(const r of e)if(typeof r=="object"&&"index"in r&&typeof r.index=="number"){const n=t.findIndex(i=>i.index===r.index);n!==-1?t[n]=Kt(t[n],r):t.push(r)}else{if(typeof r=="object"&&"text"in r&&r.text==="")continue;t.push(r)}return t}}}function $9(a,e){if(!a&&!e)throw new Error("Cannot merge two undefined objects.");if(!a||!e)return a||e;if(typeof a!=typeof e)throw new Error(`Cannot merge objects of different types.
Left ${typeof a}
Right ${typeof e}`);if(typeof a=="string"&&typeof e=="string")return a+e;if(Array.isArray(a)&&Array.isArray(e))return ab(a,e);if(typeof a=="object"&&typeof e=="object")return Kt(a,e);if(a===e)return a;throw new Error(`Can not merge objects of different types.
Left ${a}
Right ${e}`)}class Af extends Ou{}function N9(a){return typeof a.role=="string"}function If(a){return typeof(a==null?void 0:a._getType)=="function"}function q9(a){return If(a)&&typeof a.concat=="function"}let z9=class extends Ou{static lc_name(){return"ToolMessage"}get lc_aliases(){return{tool_call_id:"tool_call_id"}}constructor(e,t,r){typeof e=="string"&&(e={content:e,name:r,tool_call_id:t}),super(e),Object.defineProperty(this,"lc_direct_tool_output",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"status",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tool_call_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"artifact",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.tool_call_id=e.tool_call_id,this.artifact=e.artifact,this.status=e.status}_getType(){return"tool"}static isInstance(e){return e._getType()==="tool"}get _printableFields(){return{...super._printableFields,tool_call_id:this.tool_call_id,artifact:this.artifact}}};class bR extends Af{constructor(e){super(e),Object.defineProperty(this,"tool_call_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"status",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"artifact",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.tool_call_id=e.tool_call_id,this.artifact=e.artifact,this.status=e.status}static lc_name(){return"ToolMessageChunk"}_getType(){return"tool"}concat(e){return new bR({content:Mf(this.content,e.content),additional_kwargs:Kt(this.additional_kwargs,e.additional_kwargs),response_metadata:Kt(this.response_metadata,e.response_metadata),artifact:$9(this.artifact,e.artifact),tool_call_id:this.tool_call_id,id:this.id??e.id,status:D9(this.status,e.status)})}get _printableFields(){return{...super._printableFields,tool_call_id:this.tool_call_id,artifact:this.artifact}}}function B9(a){const e=[],t=[];for(const r of a)if(r.function){const n=r.function.name;try{const i=JSON.parse(r.function.arguments),o={name:n||"",args:i||{},id:r.id};e.push(o)}catch{t.push({name:n,args:r.function.arguments,id:r.id,error:"Malformed args."})}}else continue;return[e,t]}class Hs extends Ou{get lc_aliases(){return{...super.lc_aliases,tool_calls:"tool_calls",invalid_tool_calls:"invalid_tool_calls"}}constructor(e,t){var n;let r;if(typeof e=="string")r={content:e,tool_calls:[],invalid_tool_calls:[],additional_kwargs:t??{}};else{r=e;const i=(n=r.additional_kwargs)==null?void 0:n.tool_calls,o=r.tool_calls;i!=null&&i.length>0&&(o===void 0||o.length===0)&&console.warn(["New LangChain packages are available that more efficiently handle",`tool calling.

Please upgrade your packages to versions that set`,"message tool calls. e.g., `yarn add @langchain/anthropic`,","yarn add @langchain/openai`, etc."].join(" "));try{if(i!=null&&o===void 0){const[s,u]=B9(i);r.tool_calls=s??[],r.invalid_tool_calls=u??[]}else r.tool_calls=r.tool_calls??[],r.invalid_tool_calls=r.invalid_tool_calls??[]}catch{r.tool_calls=[],r.invalid_tool_calls=[]}}super(r),Object.defineProperty(this,"tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"invalid_tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"usage_metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),typeof r!="string"&&(this.tool_calls=r.tool_calls??this.tool_calls,this.invalid_tool_calls=r.invalid_tool_calls??this.invalid_tool_calls),this.usage_metadata=r.usage_metadata}static lc_name(){return"AIMessage"}_getType(){return"ai"}get _printableFields(){return{...super._printableFields,tool_calls:this.tool_calls,invalid_tool_calls:this.invalid_tool_calls,usage_metadata:this.usage_metadata}}}function ru(a){return a._getType()==="ai"}function bP(a){return a._getType()==="ai"}class it extends Af{constructor(e){let t;if(typeof e=="string")t={content:e,tool_calls:[],invalid_tool_calls:[],tool_call_chunks:[]};else if(e.tool_call_chunks===void 0)t={...e,tool_calls:e.tool_calls??[],invalid_tool_calls:[],tool_call_chunks:[],usage_metadata:e.usage_metadata!==void 0?e.usage_metadata:void 0};else{const r=[],n=[];for(const i of e.tool_call_chunks){let o={};try{if(o=yR(i.args||"{}"),o===null||typeof o!="object"||Array.isArray(o))throw new Error("Malformed tool call chunk args.");r.push({name:i.name??"",args:o,id:i.id,type:"tool_call"})}catch{n.push({name:i.name,args:i.args,id:i.id,error:"Malformed args.",type:"invalid_tool_call"})}}t={...e,tool_calls:r,invalid_tool_calls:n,usage_metadata:e.usage_metadata!==void 0?e.usage_metadata:void 0}}super(t),Object.defineProperty(this,"tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"invalid_tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"tool_call_chunks",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"usage_metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.tool_call_chunks=t.tool_call_chunks??this.tool_call_chunks,this.tool_calls=t.tool_calls??this.tool_calls,this.invalid_tool_calls=t.invalid_tool_calls??this.invalid_tool_calls,this.usage_metadata=t.usage_metadata}get lc_aliases(){return{...super.lc_aliases,tool_calls:"tool_calls",invalid_tool_calls:"invalid_tool_calls",tool_call_chunks:"tool_call_chunks"}}static lc_name(){return"AIMessageChunk"}_getType(){return"ai"}get _printableFields(){return{...super._printableFields,tool_calls:this.tool_calls,tool_call_chunks:this.tool_call_chunks,invalid_tool_calls:this.invalid_tool_calls,usage_metadata:this.usage_metadata}}concat(e){var r,n,i,o,s,u,l,c,f,p,h,y,d,_,m,b,g,v,w,S,R,P,C,T,M,K,q,B,H,Q,se,F,ee,A,J,te,Z,he,ye,ve;const t={content:Mf(this.content,e.content),additional_kwargs:Kt(this.additional_kwargs,e.additional_kwargs),response_metadata:Kt(this.response_metadata,e.response_metadata),tool_call_chunks:[],id:this.id??e.id};if(this.tool_call_chunks!==void 0||e.tool_call_chunks!==void 0){const W=ab(this.tool_call_chunks,e.tool_call_chunks);W!==void 0&&W.length>0&&(t.tool_call_chunks=W)}if(this.usage_metadata!==void 0||e.usage_metadata!==void 0){const W={...(((n=(r=this.usage_metadata)==null?void 0:r.input_token_details)==null?void 0:n.audio)!==void 0||((o=(i=e.usage_metadata)==null?void 0:i.input_token_details)==null?void 0:o.audio)!==void 0)&&{audio:(((u=(s=this.usage_metadata)==null?void 0:s.input_token_details)==null?void 0:u.audio)??0)+(((c=(l=e.usage_metadata)==null?void 0:l.input_token_details)==null?void 0:c.audio)??0)},...(((p=(f=this.usage_metadata)==null?void 0:f.input_token_details)==null?void 0:p.cache_read)!==void 0||((y=(h=e.usage_metadata)==null?void 0:h.input_token_details)==null?void 0:y.cache_read)!==void 0)&&{cache_read:(((_=(d=this.usage_metadata)==null?void 0:d.input_token_details)==null?void 0:_.cache_read)??0)+(((b=(m=e.usage_metadata)==null?void 0:m.input_token_details)==null?void 0:b.cache_read)??0)},...(((v=(g=this.usage_metadata)==null?void 0:g.input_token_details)==null?void 0:v.cache_creation)!==void 0||((S=(w=e.usage_metadata)==null?void 0:w.input_token_details)==null?void 0:S.cache_creation)!==void 0)&&{cache_creation:(((P=(R=this.usage_metadata)==null?void 0:R.input_token_details)==null?void 0:P.cache_creation)??0)+(((T=(C=e.usage_metadata)==null?void 0:C.input_token_details)==null?void 0:T.cache_creation)??0)}},U={...(((K=(M=this.usage_metadata)==null?void 0:M.output_token_details)==null?void 0:K.audio)!==void 0||((B=(q=e.usage_metadata)==null?void 0:q.output_token_details)==null?void 0:B.audio)!==void 0)&&{audio:(((Q=(H=this.usage_metadata)==null?void 0:H.output_token_details)==null?void 0:Q.audio)??0)+(((F=(se=e.usage_metadata)==null?void 0:se.output_token_details)==null?void 0:F.audio)??0)},...(((A=(ee=this.usage_metadata)==null?void 0:ee.output_token_details)==null?void 0:A.reasoning)!==void 0||((te=(J=e.usage_metadata)==null?void 0:J.output_token_details)==null?void 0:te.reasoning)!==void 0)&&{reasoning:(((he=(Z=this.usage_metadata)==null?void 0:Z.output_token_details)==null?void 0:he.reasoning)??0)+(((ve=(ye=e.usage_metadata)==null?void 0:ye.output_token_details)==null?void 0:ve.reasoning)??0)}},N=this.usage_metadata??{input_tokens:0,output_tokens:0,total_tokens:0},k=e.usage_metadata??{input_tokens:0,output_tokens:0,total_tokens:0},ie={input_tokens:N.input_tokens+k.input_tokens,output_tokens:N.output_tokens+k.output_tokens,total_tokens:N.total_tokens+k.total_tokens,...Object.keys(W).length>0&&{input_token_details:W},...Object.keys(U).length>0&&{output_token_details:U}};t.usage_metadata=ie}return new it(t)}}let Ac=class C4 extends Ou{static lc_name(){return"ChatMessage"}static _chatMessageClass(){return C4}constructor(e,t){typeof e=="string"&&(e={content:e,role:t}),super(e),Object.defineProperty(this,"role",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.role=e.role}_getType(){return"generic"}static isInstance(e){return e._getType()==="generic"}get _printableFields(){return{...super._printableFields,role:this.role}}};class Bp extends Af{static lc_name(){return"ChatMessageChunk"}constructor(e,t){typeof e=="string"&&(e={content:e,role:t}),super(e),Object.defineProperty(this,"role",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.role=e.role}_getType(){return"generic"}concat(e){return new Bp({content:Mf(this.content,e.content),additional_kwargs:Kt(this.additional_kwargs,e.additional_kwargs),response_metadata:Kt(this.response_metadata,e.response_metadata),role:this.role,id:this.id??e.id})}get _printableFields(){return{...super._printableFields,role:this.role}}}class ob extends Af{static lc_name(){return"FunctionMessageChunk"}_getType(){return"function"}concat(e){return new ob({content:Mf(this.content,e.content),additional_kwargs:Kt(this.additional_kwargs,e.additional_kwargs),response_metadata:Kt(this.response_metadata,e.response_metadata),name:this.name??"",id:this.id??e.id})}}class ku extends Ou{static lc_name(){return"HumanMessage"}_getType(){return"human"}}class Up extends Af{static lc_name(){return"HumanMessageChunk"}_getType(){return"human"}concat(e){return new Up({content:Mf(this.content,e.content),additional_kwargs:Kt(this.additional_kwargs,e.additional_kwargs),response_metadata:Kt(this.response_metadata,e.response_metadata),id:this.id??e.id})}}let dE=class extends Ou{static lc_name(){return"SystemMessage"}_getType(){return"system"}};class wf extends Af{static lc_name(){return"SystemMessageChunk"}_getType(){return"system"}concat(e){return new wf({content:Mf(this.content,e.content),additional_kwargs:Kt(this.additional_kwargs,e.additional_kwargs),response_metadata:Kt(this.response_metadata,e.response_metadata),id:this.id??e.id})}}function U9(a){return R4(a)?a:typeof a.id=="string"&&a.type==="function"&&typeof a.function=="object"&&a.function!==null&&"arguments"in a.function&&typeof a.function.arguments=="string"&&"name"in a.function&&typeof a.function.name=="string"?{id:a.id,args:JSON.parse(a.function.arguments),name:a.function.name,type:"tool_call"}:a}function F9(a){return typeof a=="object"&&a!=null&&a.lc===1&&Array.isArray(a.id)&&a.kwargs!=null&&typeof a.kwargs=="object"}function om(a){let e,t;if(F9(a)){const r=a.id.at(-1);r==="HumanMessage"||r==="HumanMessageChunk"?e="user":r==="AIMessage"||r==="AIMessageChunk"?e="assistant":r==="SystemMessage"||r==="SystemMessageChunk"?e="system":r==="FunctionMessage"||r==="FunctionMessageChunk"?e="function":r==="ToolMessage"||r==="ToolMessageChunk"?e="tool":e="unknown",t=a.kwargs}else{const{type:r,...n}=a;e=r,t=n}if(e==="human"||e==="user")return new ku(t);if(e==="ai"||e==="assistant"){const{tool_calls:r,...n}=t;if(!Array.isArray(r))return new Hs(t);const i=r.map(U9);return new Hs({...n,tool_calls:i})}else{if(e==="system")return new dE(t);if(e==="developer")return new dE({...t,additional_kwargs:{...t.additional_kwargs,__openai_role__:"developer"}});if(e==="tool"&&"tool_call_id"in t)return new z9({...t,content:t.content,tool_call_id:t.tool_call_id,name:t.name});throw ib(new Error(`Unable to coerce message from array: only human, AI, system, developer, or tool message coercion is currently supported.

Received: ${JSON.stringify(a,null,2)}`),"MESSAGE_COERCION_FAILURE")}}function Uu(a){if(typeof a=="string")return new ku(a);if(If(a))return a;if(Array.isArray(a)){const[e,t]=a;return om({type:e,content:t})}else if(N9(a)){const{role:e,...t}=a;return om({...t,type:e})}else return om(a)}function mR(a,e="Human",t="AI"){const r=[];for(const n of a){let i;if(n._getType()==="human")i=e;else if(n._getType()==="ai")i=t;else if(n._getType()==="system")i="System";else if(n._getType()==="function")i="Function";else if(n._getType()==="tool")i="Tool";else if(n._getType()==="generic")i=n.role;else throw new Error(`Got unsupported message type: ${n._getType()}`);const o=n.name?`${n.name}, `:"",s=typeof n.content=="string"?n.content:JSON.stringify(n.content,null,2);r.push(`${i}: ${o}${s}`)}return r.join(`
`)}function L9(a){var t;const e=a._getType();if(e==="human")return new Up({...a});if(e==="ai"){let r={...a};return"tool_calls"in r&&(r={...r,tool_call_chunks:(t=r.tool_calls)==null?void 0:t.map(n=>({...n,type:"tool_call_chunk",index:void 0,args:JSON.stringify(n.args)}))}),new it({...r})}else{if(e==="system")return new wf({...a});if(e==="function")return new ob({...a});if(Ac.isInstance(a))return new Bp({...a});throw new Error("Unknown message type.")}}var Wf={exports:{}},sm={},um,mP;function V9(){if(mP)return um;mP=1;function a(e,t){typeof t=="boolean"&&(t={forever:t}),this._originalTimeouts=JSON.parse(JSON.stringify(e)),this._timeouts=e,this._options=t||{},this._maxRetryTime=t&&t.maxRetryTime||1/0,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._timer=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}return um=a,a.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts.slice(0)},a.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timer&&clearTimeout(this._timer),this._timeouts=[],this._cachedTimeouts=null},a.prototype.retry=function(e){if(this._timeout&&clearTimeout(this._timeout),!e)return!1;var t=new Date().getTime();if(e&&t-this._operationStart>=this._maxRetryTime)return this._errors.push(e),this._errors.unshift(new Error("RetryOperation timeout occurred")),!1;this._errors.push(e);var r=this._timeouts.shift();if(r===void 0)if(this._cachedTimeouts)this._errors.splice(0,this._errors.length-1),r=this._cachedTimeouts.slice(-1);else return!1;var n=this;return this._timer=setTimeout(function(){n._attempts++,n._operationTimeoutCb&&(n._timeout=setTimeout(function(){n._operationTimeoutCb(n._attempts)},n._operationTimeout),n._options.unref&&n._timeout.unref()),n._fn(n._attempts)},r),this._options.unref&&this._timer.unref(),!0},a.prototype.attempt=function(e,t){this._fn=e,t&&(t.timeout&&(this._operationTimeout=t.timeout),t.cb&&(this._operationTimeoutCb=t.cb));var r=this;this._operationTimeoutCb&&(this._timeout=setTimeout(function(){r._operationTimeoutCb()},r._operationTimeout)),this._operationStart=new Date().getTime(),this._fn(this._attempts)},a.prototype.try=function(e){console.log("Using RetryOperation.try() is deprecated"),this.attempt(e)},a.prototype.start=function(e){console.log("Using RetryOperation.start() is deprecated"),this.attempt(e)},a.prototype.start=a.prototype.try,a.prototype.errors=function(){return this._errors},a.prototype.attempts=function(){return this._attempts},a.prototype.mainError=function(){if(this._errors.length===0)return null;for(var e={},t=null,r=0,n=0;n<this._errors.length;n++){var i=this._errors[n],o=i.message,s=(e[o]||0)+1;e[o]=s,s>=r&&(t=i,r=s)}return t},um}var gP;function G9(){return gP||(gP=1,function(a){var e=V9();a.operation=function(t){var r=a.timeouts(t);return new e(r,{forever:t&&(t.forever||t.retries===1/0),unref:t&&t.unref,maxRetryTime:t&&t.maxRetryTime})},a.timeouts=function(t){if(t instanceof Array)return[].concat(t);var r={retries:10,factor:2,minTimeout:1*1e3,maxTimeout:1/0,randomize:!1};for(var n in t)r[n]=t[n];if(r.minTimeout>r.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var i=[],o=0;o<r.retries;o++)i.push(this.createTimeout(o,r));return t&&t.forever&&!i.length&&i.push(this.createTimeout(o,r)),i.sort(function(s,u){return s-u}),i},a.createTimeout=function(t,r){var n=r.randomize?Math.random()+1:1,i=Math.round(n*Math.max(r.minTimeout,1)*Math.pow(r.factor,t));return i=Math.min(i,r.maxTimeout),i},a.wrap=function(t,r,n){if(r instanceof Array&&(n=r,r=null),!n){n=[];for(var i in t)typeof t[i]=="function"&&n.push(i)}for(var o=0;o<n.length;o++){var s=n[o],u=t[s];t[s]=(function(c){var f=a.operation(r),p=Array.prototype.slice.call(arguments,1),h=p.pop();p.push(function(y){f.retry(y)||(y&&(arguments[0]=f.mainError()),h.apply(this,arguments))}),f.attempt(function(){c.apply(t,p)})}).bind(t,u),t[s].options=r}}}(sm)),sm}var lm,vP;function k9(){return vP||(vP=1,lm=G9()),lm}var wP;function H9(){if(wP)return Wf.exports;wP=1;const a=k9(),e=["Failed to fetch","NetworkError when attempting to fetch resource.","The Internet connection appears to be offline.","Network request failed"];class t extends Error{constructor(s){super(),s instanceof Error?(this.originalError=s,{message:s}=s):(this.originalError=new Error(s),this.originalError.stack=this.stack),this.name="AbortError",this.message=s}}const r=(o,s,u)=>{const l=u.retries-(s-1);return o.attemptNumber=s,o.retriesLeft=l,o},n=o=>e.includes(o),i=(o,s)=>new Promise((u,l)=>{s={onFailedAttempt:()=>{},retries:10,...s};const c=a.operation(s);c.attempt(async f=>{try{u(await o(f))}catch(p){if(!(p instanceof Error)){l(new TypeError(`Non-error was thrown: "${p}". You should only throw errors.`));return}if(p instanceof t)c.stop(),l(p.originalError);else if(p instanceof TypeError&&!n(p.message))c.stop(),l(p);else{r(p,f,s);try{await s.onFailedAttempt(p)}catch(h){l(h);return}c.retry(p)||l(c.mainError())}}})});return Wf.exports=i,Wf.exports.default=i,Wf.exports.AbortError=t,Wf.exports}var W9=H9();const wy=Np(W9);var h_={},cm={exports:{}},OP;function K9(){return OP||(OP=1,function(a){var e=Object.prototype.hasOwnProperty,t="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(t=!1));function n(u,l,c){this.fn=u,this.context=l,this.once=c||!1}function i(u,l,c,f,p){if(typeof c!="function")throw new TypeError("The listener must be a function");var h=new n(c,f||u,p),y=t?t+l:l;return u._events[y]?u._events[y].fn?u._events[y]=[u._events[y],h]:u._events[y].push(h):(u._events[y]=h,u._eventsCount++),u}function o(u,l){--u._eventsCount===0?u._events=new r:delete u._events[l]}function s(){this._events=new r,this._eventsCount=0}s.prototype.eventNames=function(){var l=[],c,f;if(this._eventsCount===0)return l;for(f in c=this._events)e.call(c,f)&&l.push(t?f.slice(1):f);return Object.getOwnPropertySymbols?l.concat(Object.getOwnPropertySymbols(c)):l},s.prototype.listeners=function(l){var c=t?t+l:l,f=this._events[c];if(!f)return[];if(f.fn)return[f.fn];for(var p=0,h=f.length,y=new Array(h);p<h;p++)y[p]=f[p].fn;return y},s.prototype.listenerCount=function(l){var c=t?t+l:l,f=this._events[c];return f?f.fn?1:f.length:0},s.prototype.emit=function(l,c,f,p,h,y){var d=t?t+l:l;if(!this._events[d])return!1;var _=this._events[d],m=arguments.length,b,g;if(_.fn){switch(_.once&&this.removeListener(l,_.fn,void 0,!0),m){case 1:return _.fn.call(_.context),!0;case 2:return _.fn.call(_.context,c),!0;case 3:return _.fn.call(_.context,c,f),!0;case 4:return _.fn.call(_.context,c,f,p),!0;case 5:return _.fn.call(_.context,c,f,p,h),!0;case 6:return _.fn.call(_.context,c,f,p,h,y),!0}for(g=1,b=new Array(m-1);g<m;g++)b[g-1]=arguments[g];_.fn.apply(_.context,b)}else{var v=_.length,w;for(g=0;g<v;g++)switch(_[g].once&&this.removeListener(l,_[g].fn,void 0,!0),m){case 1:_[g].fn.call(_[g].context);break;case 2:_[g].fn.call(_[g].context,c);break;case 3:_[g].fn.call(_[g].context,c,f);break;case 4:_[g].fn.call(_[g].context,c,f,p);break;default:if(!b)for(w=1,b=new Array(m-1);w<m;w++)b[w-1]=arguments[w];_[g].fn.apply(_[g].context,b)}}return!0},s.prototype.on=function(l,c,f){return i(this,l,c,f,!1)},s.prototype.once=function(l,c,f){return i(this,l,c,f,!0)},s.prototype.removeListener=function(l,c,f,p){var h=t?t+l:l;if(!this._events[h])return this;if(!c)return o(this,h),this;var y=this._events[h];if(y.fn)y.fn===c&&(!p||y.once)&&(!f||y.context===f)&&o(this,h);else{for(var d=0,_=[],m=y.length;d<m;d++)(y[d].fn!==c||p&&!y[d].once||f&&y[d].context!==f)&&_.push(y[d]);_.length?this._events[h]=_.length===1?_[0]:_:o(this,h)}return this},s.prototype.removeAllListeners=function(l){var c;return l?(c=t?t+l:l,this._events[c]&&o(this,c)):(this._events=new r,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=t,s.EventEmitter=s,a.exports=s}(cm)),cm.exports}var Kf={exports:{}},fm,SP;function J9(){return SP||(SP=1,fm=(a,e)=>(e=e||(()=>{}),a.then(t=>new Promise(r=>{r(e())}).then(()=>t),t=>new Promise(r=>{r(e())}).then(()=>{throw t})))),fm}var EP;function X9(){if(EP)return Kf.exports;EP=1;const a=J9();class e extends Error{constructor(n){super(n),this.name="TimeoutError"}}const t=(r,n,i)=>new Promise((o,s)=>{if(typeof n!="number"||n<0)throw new TypeError("Expected `milliseconds` to be a positive number");if(n===1/0){o(r);return}const u=setTimeout(()=>{if(typeof i=="function"){try{o(i())}catch(f){s(f)}return}const l=typeof i=="string"?i:`Promise timed out after ${n} milliseconds`,c=i instanceof Error?i:new e(l);typeof r.cancel=="function"&&r.cancel(),s(c)},n);a(r.then(o,s),()=>{clearTimeout(u)})});return Kf.exports=t,Kf.exports.default=t,Kf.exports.TimeoutError=e,Kf.exports}var p_={},__={},RP;function Z9(){if(RP)return __;RP=1,Object.defineProperty(__,"__esModule",{value:!0});function a(e,t,r){let n=0,i=e.length;for(;i>0;){const o=i/2|0;let s=n+o;r(e[s],t)<=0?(n=++s,i-=o+1):i=o}return n}return __.default=a,__}var CP;function Q9(){if(CP)return p_;CP=1,Object.defineProperty(p_,"__esModule",{value:!0});const a=Z9();class e{constructor(){this._queue=[]}enqueue(r,n){n=Object.assign({priority:0},n);const i={priority:n.priority,run:r};if(this.size&&this._queue[this.size-1].priority>=n.priority){this._queue.push(i);return}const o=a.default(this._queue,i,(s,u)=>u.priority-s.priority);this._queue.splice(o,0,i)}dequeue(){const r=this._queue.shift();return r==null?void 0:r.run}filter(r){return this._queue.filter(n=>n.priority===r.priority).map(n=>n.run)}get size(){return this._queue.length}}return p_.default=e,p_}var PP;function Y9(){if(PP)return h_;PP=1,Object.defineProperty(h_,"__esModule",{value:!0});const a=K9(),e=X9(),t=Q9(),r=()=>{},n=new e.TimeoutError;class i extends a{constructor(s){var u,l,c,f;if(super(),this._intervalCount=0,this._intervalEnd=0,this._pendingCount=0,this._resolveEmpty=r,this._resolveIdle=r,s=Object.assign({carryoverConcurrencyCount:!1,intervalCap:1/0,interval:0,concurrency:1/0,autoStart:!0,queueClass:t.default},s),!(typeof s.intervalCap=="number"&&s.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${(l=(u=s.intervalCap)===null||u===void 0?void 0:u.toString())!==null&&l!==void 0?l:""}\` (${typeof s.intervalCap})`);if(s.interval===void 0||!(Number.isFinite(s.interval)&&s.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${(f=(c=s.interval)===null||c===void 0?void 0:c.toString())!==null&&f!==void 0?f:""}\` (${typeof s.interval})`);this._carryoverConcurrencyCount=s.carryoverConcurrencyCount,this._isIntervalIgnored=s.intervalCap===1/0||s.interval===0,this._intervalCap=s.intervalCap,this._interval=s.interval,this._queue=new s.queueClass,this._queueClass=s.queueClass,this.concurrency=s.concurrency,this._timeout=s.timeout,this._throwOnTimeout=s.throwOnTimeout===!0,this._isPaused=s.autoStart===!1}get _doesIntervalAllowAnother(){return this._isIntervalIgnored||this._intervalCount<this._intervalCap}get _doesConcurrentAllowAnother(){return this._pendingCount<this._concurrency}_next(){this._pendingCount--,this._tryToStartAnother(),this.emit("next")}_resolvePromises(){this._resolveEmpty(),this._resolveEmpty=r,this._pendingCount===0&&(this._resolveIdle(),this._resolveIdle=r,this.emit("idle"))}_onResumeInterval(){this._onInterval(),this._initializeIntervalIfNeeded(),this._timeoutId=void 0}_isIntervalPaused(){const s=Date.now();if(this._intervalId===void 0){const u=this._intervalEnd-s;if(u<0)this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0;else return this._timeoutId===void 0&&(this._timeoutId=setTimeout(()=>{this._onResumeInterval()},u)),!0}return!1}_tryToStartAnother(){if(this._queue.size===0)return this._intervalId&&clearInterval(this._intervalId),this._intervalId=void 0,this._resolvePromises(),!1;if(!this._isPaused){const s=!this._isIntervalPaused();if(this._doesIntervalAllowAnother&&this._doesConcurrentAllowAnother){const u=this._queue.dequeue();return u?(this.emit("active"),u(),s&&this._initializeIntervalIfNeeded(),!0):!1}}return!1}_initializeIntervalIfNeeded(){this._isIntervalIgnored||this._intervalId!==void 0||(this._intervalId=setInterval(()=>{this._onInterval()},this._interval),this._intervalEnd=Date.now()+this._interval)}_onInterval(){this._intervalCount===0&&this._pendingCount===0&&this._intervalId&&(clearInterval(this._intervalId),this._intervalId=void 0),this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0,this._processQueue()}_processQueue(){for(;this._tryToStartAnother(););}get concurrency(){return this._concurrency}set concurrency(s){if(!(typeof s=="number"&&s>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${s}\` (${typeof s})`);this._concurrency=s,this._processQueue()}async add(s,u={}){return new Promise((l,c)=>{const f=async()=>{this._pendingCount++,this._intervalCount++;try{const p=this._timeout===void 0&&u.timeout===void 0?s():e.default(Promise.resolve(s()),u.timeout===void 0?this._timeout:u.timeout,()=>{(u.throwOnTimeout===void 0?this._throwOnTimeout:u.throwOnTimeout)&&c(n)});l(await p)}catch(p){c(p)}this._next()};this._queue.enqueue(f,u),this._tryToStartAnother(),this.emit("add")})}async addAll(s,u){return Promise.all(s.map(async l=>this.add(l,u)))}start(){return this._isPaused?(this._isPaused=!1,this._processQueue(),this):this}pause(){this._isPaused=!0}clear(){this._queue=new this._queueClass}async onEmpty(){if(this._queue.size!==0)return new Promise(s=>{const u=this._resolveEmpty;this._resolveEmpty=()=>{u(),s()}})}async onIdle(){if(!(this._pendingCount===0&&this._queue.size===0))return new Promise(s=>{const u=this._resolveIdle;this._resolveIdle=()=>{u(),s()}})}get size(){return this._queue.size}sizeBy(s){return this._queue.filter(s).length}get pending(){return this._pendingCount}get isPaused(){return this._isPaused}get timeout(){return this._timeout}set timeout(s){this._timeout=s}}return h_.default=i,h_}var e5=Y9();const Su=Np(e5),t5=(...a)=>fetch(...a),r5=Symbol.for("ls:fetch_implementation"),je=()=>globalThis[r5]??t5,n5=[400,401,403,404,405,406,407,408],i5=[409];let jP=class{constructor(e){Object.defineProperty(this,"maxConcurrency",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxRetries",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"queue",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"onFailedResponseHook",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxConcurrency=e.maxConcurrency??1/0,this.maxRetries=e.maxRetries??6,"default"in Su?this.queue=new Su.default({concurrency:this.maxConcurrency}):this.queue=new Su({concurrency:this.maxConcurrency}),this.onFailedResponseHook=e==null?void 0:e.onFailedResponseHook}call(e,...t){const r=this.onFailedResponseHook;return this.queue.add(()=>wy(()=>e(...t).catch(n=>{throw n instanceof Error?n:new Error(n)}),{async onFailedAttempt(n){if(n.message.startsWith("Cancel")||n.message.startsWith("TimeoutError")||n.message.startsWith("AbortError")||(n==null?void 0:n.code)==="ECONNABORTED")throw n;const i=n==null?void 0:n.response,o=i==null?void 0:i.status;if(o){if(n5.includes(+o))throw n;if(i5.includes(+o))return;r&&await r(i)}},retries:this.maxRetries,randomize:!0}),{throwOnTimeout:!0})}callWithOptions(e,t,...r){return e.signal?Promise.race([this.call(t,...r),new Promise((n,i)=>{var o;(o=e.signal)==null||o.addEventListener("abort",()=>{i(new Error("AbortError"))})})]):this.call(t,...r)}fetch(...e){return this.call(()=>je()(...e).then(t=>t.ok?t:Promise.reject(t)))}};function TP(a){return typeof(a==null?void 0:a._getType)=="function"}function MP(a){const e={type:a._getType(),data:{content:a.content}};return a!=null&&a.additional_kwargs&&Object.keys(a.additional_kwargs).length>0&&(e.data.additional_kwargs={...a.additional_kwargs}),e}function xe(a,e){if(!Xh(a)){const t=e!==void 0?`Invalid UUID for ${e}: ${a}`:`Invalid UUID: ${a}`;throw new Error(t)}return a}const AP={};function P4(a){AP[a]||(console.warn(a),AP[a]=!0)}var y_={exports:{}},dm,IP;function sb(){if(IP)return dm;IP=1;const a="2.0.0",e=256,t=Number.MAX_SAFE_INTEGER||9007199254740991,r=16,n=e-6;return dm={MAX_LENGTH:e,MAX_SAFE_COMPONENT_LENGTH:r,MAX_SAFE_BUILD_LENGTH:n,MAX_SAFE_INTEGER:t,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:a,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2},dm}var hm,DP;function ub(){if(DP)return hm;DP=1;var a={};return hm=typeof process=="object"&&a&&a.NODE_DEBUG&&/\bsemver\b/i.test(a.NODE_DEBUG)?(...t)=>console.error("SEMVER",...t):()=>{},hm}var xP;function Fp(){return xP||(xP=1,function(a,e){const{MAX_SAFE_COMPONENT_LENGTH:t,MAX_SAFE_BUILD_LENGTH:r,MAX_LENGTH:n}=sb(),i=ub();e=a.exports={};const o=e.re=[],s=e.safeRe=[],u=e.src=[],l=e.safeSrc=[],c=e.t={};let f=0;const p="[a-zA-Z0-9-]",h=[["\\s",1],["\\d",n],[p,r]],y=_=>{for(const[m,b]of h)_=_.split(`${m}*`).join(`${m}{0,${b}}`).split(`${m}+`).join(`${m}{1,${b}}`);return _},d=(_,m,b)=>{const g=y(m),v=f++;i(_,v,m),c[_]=v,u[v]=m,l[v]=g,o[v]=new RegExp(m,b?"g":void 0),s[v]=new RegExp(g,b?"g":void 0)};d("NUMERICIDENTIFIER","0|[1-9]\\d*"),d("NUMERICIDENTIFIERLOOSE","\\d+"),d("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${p}*`),d("MAINVERSION",`(${u[c.NUMERICIDENTIFIER]})\\.(${u[c.NUMERICIDENTIFIER]})\\.(${u[c.NUMERICIDENTIFIER]})`),d("MAINVERSIONLOOSE",`(${u[c.NUMERICIDENTIFIERLOOSE]})\\.(${u[c.NUMERICIDENTIFIERLOOSE]})\\.(${u[c.NUMERICIDENTIFIERLOOSE]})`),d("PRERELEASEIDENTIFIER",`(?:${u[c.NUMERICIDENTIFIER]}|${u[c.NONNUMERICIDENTIFIER]})`),d("PRERELEASEIDENTIFIERLOOSE",`(?:${u[c.NUMERICIDENTIFIERLOOSE]}|${u[c.NONNUMERICIDENTIFIER]})`),d("PRERELEASE",`(?:-(${u[c.PRERELEASEIDENTIFIER]}(?:\\.${u[c.PRERELEASEIDENTIFIER]})*))`),d("PRERELEASELOOSE",`(?:-?(${u[c.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${u[c.PRERELEASEIDENTIFIERLOOSE]})*))`),d("BUILDIDENTIFIER",`${p}+`),d("BUILD",`(?:\\+(${u[c.BUILDIDENTIFIER]}(?:\\.${u[c.BUILDIDENTIFIER]})*))`),d("FULLPLAIN",`v?${u[c.MAINVERSION]}${u[c.PRERELEASE]}?${u[c.BUILD]}?`),d("FULL",`^${u[c.FULLPLAIN]}$`),d("LOOSEPLAIN",`[v=\\s]*${u[c.MAINVERSIONLOOSE]}${u[c.PRERELEASELOOSE]}?${u[c.BUILD]}?`),d("LOOSE",`^${u[c.LOOSEPLAIN]}$`),d("GTLT","((?:<|>)?=?)"),d("XRANGEIDENTIFIERLOOSE",`${u[c.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),d("XRANGEIDENTIFIER",`${u[c.NUMERICIDENTIFIER]}|x|X|\\*`),d("XRANGEPLAIN",`[v=\\s]*(${u[c.XRANGEIDENTIFIER]})(?:\\.(${u[c.XRANGEIDENTIFIER]})(?:\\.(${u[c.XRANGEIDENTIFIER]})(?:${u[c.PRERELEASE]})?${u[c.BUILD]}?)?)?`),d("XRANGEPLAINLOOSE",`[v=\\s]*(${u[c.XRANGEIDENTIFIERLOOSE]})(?:\\.(${u[c.XRANGEIDENTIFIERLOOSE]})(?:\\.(${u[c.XRANGEIDENTIFIERLOOSE]})(?:${u[c.PRERELEASELOOSE]})?${u[c.BUILD]}?)?)?`),d("XRANGE",`^${u[c.GTLT]}\\s*${u[c.XRANGEPLAIN]}$`),d("XRANGELOOSE",`^${u[c.GTLT]}\\s*${u[c.XRANGEPLAINLOOSE]}$`),d("COERCEPLAIN",`(^|[^\\d])(\\d{1,${t}})(?:\\.(\\d{1,${t}}))?(?:\\.(\\d{1,${t}}))?`),d("COERCE",`${u[c.COERCEPLAIN]}(?:$|[^\\d])`),d("COERCEFULL",u[c.COERCEPLAIN]+`(?:${u[c.PRERELEASE]})?(?:${u[c.BUILD]})?(?:$|[^\\d])`),d("COERCERTL",u[c.COERCE],!0),d("COERCERTLFULL",u[c.COERCEFULL],!0),d("LONETILDE","(?:~>?)"),d("TILDETRIM",`(\\s*)${u[c.LONETILDE]}\\s+`,!0),e.tildeTrimReplace="$1~",d("TILDE",`^${u[c.LONETILDE]}${u[c.XRANGEPLAIN]}$`),d("TILDELOOSE",`^${u[c.LONETILDE]}${u[c.XRANGEPLAINLOOSE]}$`),d("LONECARET","(?:\\^)"),d("CARETTRIM",`(\\s*)${u[c.LONECARET]}\\s+`,!0),e.caretTrimReplace="$1^",d("CARET",`^${u[c.LONECARET]}${u[c.XRANGEPLAIN]}$`),d("CARETLOOSE",`^${u[c.LONECARET]}${u[c.XRANGEPLAINLOOSE]}$`),d("COMPARATORLOOSE",`^${u[c.GTLT]}\\s*(${u[c.LOOSEPLAIN]})$|^$`),d("COMPARATOR",`^${u[c.GTLT]}\\s*(${u[c.FULLPLAIN]})$|^$`),d("COMPARATORTRIM",`(\\s*)${u[c.GTLT]}\\s*(${u[c.LOOSEPLAIN]}|${u[c.XRANGEPLAIN]})`,!0),e.comparatorTrimReplace="$1$2$3",d("HYPHENRANGE",`^\\s*(${u[c.XRANGEPLAIN]})\\s+-\\s+(${u[c.XRANGEPLAIN]})\\s*$`),d("HYPHENRANGELOOSE",`^\\s*(${u[c.XRANGEPLAINLOOSE]})\\s+-\\s+(${u[c.XRANGEPLAINLOOSE]})\\s*$`),d("STAR","(<|>)?=?\\s*\\*"),d("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),d("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")}(y_,y_.exports)),y_.exports}var pm,$P;function gR(){if($P)return pm;$P=1;const a=Object.freeze({loose:!0}),e=Object.freeze({});return pm=r=>r?typeof r!="object"?a:r:e,pm}var _m,NP;function j4(){if(NP)return _m;NP=1;const a=/^[0-9]+$/,e=(r,n)=>{const i=a.test(r),o=a.test(n);return i&&o&&(r=+r,n=+n),r===n?0:i&&!o?-1:o&&!i?1:r<n?-1:1};return _m={compareIdentifiers:e,rcompareIdentifiers:(r,n)=>e(n,r)},_m}var ym,qP;function Xt(){if(qP)return ym;qP=1;const a=ub(),{MAX_LENGTH:e,MAX_SAFE_INTEGER:t}=sb(),{safeRe:r,safeSrc:n,t:i}=Fp(),o=gR(),{compareIdentifiers:s}=j4();class u{constructor(c,f){if(f=o(f),c instanceof u){if(c.loose===!!f.loose&&c.includePrerelease===!!f.includePrerelease)return c;c=c.version}else if(typeof c!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof c}".`);if(c.length>e)throw new TypeError(`version is longer than ${e} characters`);a("SemVer",c,f),this.options=f,this.loose=!!f.loose,this.includePrerelease=!!f.includePrerelease;const p=c.trim().match(f.loose?r[i.LOOSE]:r[i.FULL]);if(!p)throw new TypeError(`Invalid Version: ${c}`);if(this.raw=c,this.major=+p[1],this.minor=+p[2],this.patch=+p[3],this.major>t||this.major<0)throw new TypeError("Invalid major version");if(this.minor>t||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>t||this.patch<0)throw new TypeError("Invalid patch version");p[4]?this.prerelease=p[4].split(".").map(h=>{if(/^[0-9]+$/.test(h)){const y=+h;if(y>=0&&y<t)return y}return h}):this.prerelease=[],this.build=p[5]?p[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(c){if(a("SemVer.compare",this.version,this.options,c),!(c instanceof u)){if(typeof c=="string"&&c===this.version)return 0;c=new u(c,this.options)}return c.version===this.version?0:this.compareMain(c)||this.comparePre(c)}compareMain(c){return c instanceof u||(c=new u(c,this.options)),s(this.major,c.major)||s(this.minor,c.minor)||s(this.patch,c.patch)}comparePre(c){if(c instanceof u||(c=new u(c,this.options)),this.prerelease.length&&!c.prerelease.length)return-1;if(!this.prerelease.length&&c.prerelease.length)return 1;if(!this.prerelease.length&&!c.prerelease.length)return 0;let f=0;do{const p=this.prerelease[f],h=c.prerelease[f];if(a("prerelease compare",f,p,h),p===void 0&&h===void 0)return 0;if(h===void 0)return 1;if(p===void 0)return-1;if(p===h)continue;return s(p,h)}while(++f)}compareBuild(c){c instanceof u||(c=new u(c,this.options));let f=0;do{const p=this.build[f],h=c.build[f];if(a("build compare",f,p,h),p===void 0&&h===void 0)return 0;if(h===void 0)return 1;if(p===void 0)return-1;if(p===h)continue;return s(p,h)}while(++f)}inc(c,f,p){if(c.startsWith("pre")){if(!f&&p===!1)throw new Error("invalid increment argument: identifier is empty");if(f){const h=new RegExp(`^${this.options.loose?n[i.PRERELEASELOOSE]:n[i.PRERELEASE]}$`),y=`-${f}`.match(h);if(!y||y[1]!==f)throw new Error(`invalid identifier: ${f}`)}}switch(c){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",f,p);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",f,p);break;case"prepatch":this.prerelease.length=0,this.inc("patch",f,p),this.inc("pre",f,p);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",f,p),this.inc("pre",f,p);break;case"release":if(this.prerelease.length===0)throw new Error(`version ${this.raw} is not a prerelease`);this.prerelease.length=0;break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{const h=Number(p)?1:0;if(this.prerelease.length===0)this.prerelease=[h];else{let y=this.prerelease.length;for(;--y>=0;)typeof this.prerelease[y]=="number"&&(this.prerelease[y]++,y=-2);if(y===-1){if(f===this.prerelease.join(".")&&p===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(h)}}if(f){let y=[f,h];p===!1&&(y=[f]),s(this.prerelease[0],f)===0?isNaN(this.prerelease[1])&&(this.prerelease=y):this.prerelease=y}break}default:throw new Error(`invalid increment argument: ${c}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}}return ym=u,ym}var bm,zP;function Df(){if(zP)return bm;zP=1;const a=Xt();return bm=(t,r,n=!1)=>{if(t instanceof a)return t;try{return new a(t,r)}catch(i){if(!n)return null;throw i}},bm}var mm,BP;function a5(){if(BP)return mm;BP=1;const a=Df();return mm=(t,r)=>{const n=a(t,r);return n?n.version:null},mm}var gm,UP;function o5(){if(UP)return gm;UP=1;const a=Df();return gm=(t,r)=>{const n=a(t.trim().replace(/^[=v]+/,""),r);return n?n.version:null},gm}var vm,FP;function s5(){if(FP)return vm;FP=1;const a=Xt();return vm=(t,r,n,i,o)=>{typeof n=="string"&&(o=i,i=n,n=void 0);try{return new a(t instanceof a?t.version:t,n).inc(r,i,o).version}catch{return null}},vm}var wm,LP;function u5(){if(LP)return wm;LP=1;const a=Df();return wm=(t,r)=>{const n=a(t,null,!0),i=a(r,null,!0),o=n.compare(i);if(o===0)return null;const s=o>0,u=s?n:i,l=s?i:n,c=!!u.prerelease.length;if(!!l.prerelease.length&&!c){if(!l.patch&&!l.minor)return"major";if(l.compareMain(u)===0)return l.minor&&!l.patch?"minor":"patch"}const p=c?"pre":"";return n.major!==i.major?p+"major":n.minor!==i.minor?p+"minor":n.patch!==i.patch?p+"patch":"prerelease"},wm}var Om,VP;function l5(){if(VP)return Om;VP=1;const a=Xt();return Om=(t,r)=>new a(t,r).major,Om}var Sm,GP;function c5(){if(GP)return Sm;GP=1;const a=Xt();return Sm=(t,r)=>new a(t,r).minor,Sm}var Em,kP;function f5(){if(kP)return Em;kP=1;const a=Xt();return Em=(t,r)=>new a(t,r).patch,Em}var Rm,HP;function d5(){if(HP)return Rm;HP=1;const a=Df();return Rm=(t,r)=>{const n=a(t,r);return n&&n.prerelease.length?n.prerelease:null},Rm}var Cm,WP;function Js(){if(WP)return Cm;WP=1;const a=Xt();return Cm=(t,r,n)=>new a(t,n).compare(new a(r,n)),Cm}var Pm,KP;function h5(){if(KP)return Pm;KP=1;const a=Js();return Pm=(t,r,n)=>a(r,t,n),Pm}var jm,JP;function p5(){if(JP)return jm;JP=1;const a=Js();return jm=(t,r)=>a(t,r,!0),jm}var Tm,XP;function vR(){if(XP)return Tm;XP=1;const a=Xt();return Tm=(t,r,n)=>{const i=new a(t,n),o=new a(r,n);return i.compare(o)||i.compareBuild(o)},Tm}var Mm,ZP;function _5(){if(ZP)return Mm;ZP=1;const a=vR();return Mm=(t,r)=>t.sort((n,i)=>a(n,i,r)),Mm}var Am,QP;function y5(){if(QP)return Am;QP=1;const a=vR();return Am=(t,r)=>t.sort((n,i)=>a(i,n,r)),Am}var Im,YP;function lb(){if(YP)return Im;YP=1;const a=Js();return Im=(t,r,n)=>a(t,r,n)>0,Im}var Dm,ej;function wR(){if(ej)return Dm;ej=1;const a=Js();return Dm=(t,r,n)=>a(t,r,n)<0,Dm}var xm,tj;function T4(){if(tj)return xm;tj=1;const a=Js();return xm=(t,r,n)=>a(t,r,n)===0,xm}var $m,rj;function M4(){if(rj)return $m;rj=1;const a=Js();return $m=(t,r,n)=>a(t,r,n)!==0,$m}var Nm,nj;function OR(){if(nj)return Nm;nj=1;const a=Js();return Nm=(t,r,n)=>a(t,r,n)>=0,Nm}var qm,ij;function SR(){if(ij)return qm;ij=1;const a=Js();return qm=(t,r,n)=>a(t,r,n)<=0,qm}var zm,aj;function A4(){if(aj)return zm;aj=1;const a=T4(),e=M4(),t=lb(),r=OR(),n=wR(),i=SR();return zm=(s,u,l,c)=>{switch(u){case"===":return typeof s=="object"&&(s=s.version),typeof l=="object"&&(l=l.version),s===l;case"!==":return typeof s=="object"&&(s=s.version),typeof l=="object"&&(l=l.version),s!==l;case"":case"=":case"==":return a(s,l,c);case"!=":return e(s,l,c);case">":return t(s,l,c);case">=":return r(s,l,c);case"<":return n(s,l,c);case"<=":return i(s,l,c);default:throw new TypeError(`Invalid operator: ${u}`)}},zm}var Bm,oj;function b5(){if(oj)return Bm;oj=1;const a=Xt(),e=Df(),{safeRe:t,t:r}=Fp();return Bm=(i,o)=>{if(i instanceof a)return i;if(typeof i=="number"&&(i=String(i)),typeof i!="string")return null;o=o||{};let s=null;if(!o.rtl)s=i.match(o.includePrerelease?t[r.COERCEFULL]:t[r.COERCE]);else{const h=o.includePrerelease?t[r.COERCERTLFULL]:t[r.COERCERTL];let y;for(;(y=h.exec(i))&&(!s||s.index+s[0].length!==i.length);)(!s||y.index+y[0].length!==s.index+s[0].length)&&(s=y),h.lastIndex=y.index+y[1].length+y[2].length;h.lastIndex=-1}if(s===null)return null;const u=s[2],l=s[3]||"0",c=s[4]||"0",f=o.includePrerelease&&s[5]?`-${s[5]}`:"",p=o.includePrerelease&&s[6]?`+${s[6]}`:"";return e(`${u}.${l}.${c}${f}${p}`,o)},Bm}var Um,sj;function m5(){if(sj)return Um;sj=1;class a{constructor(){this.max=1e3,this.map=new Map}get(t){const r=this.map.get(t);if(r!==void 0)return this.map.delete(t),this.map.set(t,r),r}delete(t){return this.map.delete(t)}set(t,r){if(!this.delete(t)&&r!==void 0){if(this.map.size>=this.max){const i=this.map.keys().next().value;this.delete(i)}this.map.set(t,r)}return this}}return Um=a,Um}var Fm,uj;function Xs(){if(uj)return Fm;uj=1;const a=/\s+/g;class e{constructor(H,Q){if(Q=n(Q),H instanceof e)return H.loose===!!Q.loose&&H.includePrerelease===!!Q.includePrerelease?H:new e(H.raw,Q);if(H instanceof i)return this.raw=H.value,this.set=[[H]],this.formatted=void 0,this;if(this.options=Q,this.loose=!!Q.loose,this.includePrerelease=!!Q.includePrerelease,this.raw=H.trim().replace(a," "),this.set=this.raw.split("||").map(se=>this.parseRange(se.trim())).filter(se=>se.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const se=this.set[0];if(this.set=this.set.filter(F=>!d(F[0])),this.set.length===0)this.set=[se];else if(this.set.length>1){for(const F of this.set)if(F.length===1&&_(F[0])){this.set=[F];break}}}this.formatted=void 0}get range(){if(this.formatted===void 0){this.formatted="";for(let H=0;H<this.set.length;H++){H>0&&(this.formatted+="||");const Q=this.set[H];for(let se=0;se<Q.length;se++)se>0&&(this.formatted+=" "),this.formatted+=Q[se].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(H){const se=((this.options.includePrerelease&&h)|(this.options.loose&&y))+":"+H,F=r.get(se);if(F)return F;const ee=this.options.loose,A=ee?u[l.HYPHENRANGELOOSE]:u[l.HYPHENRANGE];H=H.replace(A,K(this.options.includePrerelease)),o("hyphen replace",H),H=H.replace(u[l.COMPARATORTRIM],c),o("comparator trim",H),H=H.replace(u[l.TILDETRIM],f),o("tilde trim",H),H=H.replace(u[l.CARETTRIM],p),o("caret trim",H);let J=H.split(" ").map(ye=>b(ye,this.options)).join(" ").split(/\s+/).map(ye=>M(ye,this.options));ee&&(J=J.filter(ye=>(o("loose invalid filter",ye,this.options),!!ye.match(u[l.COMPARATORLOOSE])))),o("range list",J);const te=new Map,Z=J.map(ye=>new i(ye,this.options));for(const ye of Z){if(d(ye))return[ye];te.set(ye.value,ye)}te.size>1&&te.has("")&&te.delete("");const he=[...te.values()];return r.set(se,he),he}intersects(H,Q){if(!(H instanceof e))throw new TypeError("a Range is required");return this.set.some(se=>m(se,Q)&&H.set.some(F=>m(F,Q)&&se.every(ee=>F.every(A=>ee.intersects(A,Q)))))}test(H){if(!H)return!1;if(typeof H=="string")try{H=new s(H,this.options)}catch{return!1}for(let Q=0;Q<this.set.length;Q++)if(q(this.set[Q],H,this.options))return!0;return!1}}Fm=e;const t=m5(),r=new t,n=gR(),i=cb(),o=ub(),s=Xt(),{safeRe:u,t:l,comparatorTrimReplace:c,tildeTrimReplace:f,caretTrimReplace:p}=Fp(),{FLAG_INCLUDE_PRERELEASE:h,FLAG_LOOSE:y}=sb(),d=B=>B.value==="<0.0.0-0",_=B=>B.value==="",m=(B,H)=>{let Q=!0;const se=B.slice();let F=se.pop();for(;Q&&se.length;)Q=se.every(ee=>F.intersects(ee,H)),F=se.pop();return Q},b=(B,H)=>(o("comp",B,H),B=S(B,H),o("caret",B),B=v(B,H),o("tildes",B),B=P(B,H),o("xrange",B),B=T(B,H),o("stars",B),B),g=B=>!B||B.toLowerCase()==="x"||B==="*",v=(B,H)=>B.trim().split(/\s+/).map(Q=>w(Q,H)).join(" "),w=(B,H)=>{const Q=H.loose?u[l.TILDELOOSE]:u[l.TILDE];return B.replace(Q,(se,F,ee,A,J)=>{o("tilde",B,se,F,ee,A,J);let te;return g(F)?te="":g(ee)?te=`>=${F}.0.0 <${+F+1}.0.0-0`:g(A)?te=`>=${F}.${ee}.0 <${F}.${+ee+1}.0-0`:J?(o("replaceTilde pr",J),te=`>=${F}.${ee}.${A}-${J} <${F}.${+ee+1}.0-0`):te=`>=${F}.${ee}.${A} <${F}.${+ee+1}.0-0`,o("tilde return",te),te})},S=(B,H)=>B.trim().split(/\s+/).map(Q=>R(Q,H)).join(" "),R=(B,H)=>{o("caret",B,H);const Q=H.loose?u[l.CARETLOOSE]:u[l.CARET],se=H.includePrerelease?"-0":"";return B.replace(Q,(F,ee,A,J,te)=>{o("caret",B,F,ee,A,J,te);let Z;return g(ee)?Z="":g(A)?Z=`>=${ee}.0.0${se} <${+ee+1}.0.0-0`:g(J)?ee==="0"?Z=`>=${ee}.${A}.0${se} <${ee}.${+A+1}.0-0`:Z=`>=${ee}.${A}.0${se} <${+ee+1}.0.0-0`:te?(o("replaceCaret pr",te),ee==="0"?A==="0"?Z=`>=${ee}.${A}.${J}-${te} <${ee}.${A}.${+J+1}-0`:Z=`>=${ee}.${A}.${J}-${te} <${ee}.${+A+1}.0-0`:Z=`>=${ee}.${A}.${J}-${te} <${+ee+1}.0.0-0`):(o("no pr"),ee==="0"?A==="0"?Z=`>=${ee}.${A}.${J}${se} <${ee}.${A}.${+J+1}-0`:Z=`>=${ee}.${A}.${J}${se} <${ee}.${+A+1}.0-0`:Z=`>=${ee}.${A}.${J} <${+ee+1}.0.0-0`),o("caret return",Z),Z})},P=(B,H)=>(o("replaceXRanges",B,H),B.split(/\s+/).map(Q=>C(Q,H)).join(" ")),C=(B,H)=>{B=B.trim();const Q=H.loose?u[l.XRANGELOOSE]:u[l.XRANGE];return B.replace(Q,(se,F,ee,A,J,te)=>{o("xRange",B,se,F,ee,A,J,te);const Z=g(ee),he=Z||g(A),ye=he||g(J),ve=ye;return F==="="&&ve&&(F=""),te=H.includePrerelease?"-0":"",Z?F===">"||F==="<"?se="<0.0.0-0":se="*":F&&ve?(he&&(A=0),J=0,F===">"?(F=">=",he?(ee=+ee+1,A=0,J=0):(A=+A+1,J=0)):F==="<="&&(F="<",he?ee=+ee+1:A=+A+1),F==="<"&&(te="-0"),se=`${F+ee}.${A}.${J}${te}`):he?se=`>=${ee}.0.0${te} <${+ee+1}.0.0-0`:ye&&(se=`>=${ee}.${A}.0${te} <${ee}.${+A+1}.0-0`),o("xRange return",se),se})},T=(B,H)=>(o("replaceStars",B,H),B.trim().replace(u[l.STAR],"")),M=(B,H)=>(o("replaceGTE0",B,H),B.trim().replace(u[H.includePrerelease?l.GTE0PRE:l.GTE0],"")),K=B=>(H,Q,se,F,ee,A,J,te,Z,he,ye,ve)=>(g(se)?Q="":g(F)?Q=`>=${se}.0.0${B?"-0":""}`:g(ee)?Q=`>=${se}.${F}.0${B?"-0":""}`:A?Q=`>=${Q}`:Q=`>=${Q}${B?"-0":""}`,g(Z)?te="":g(he)?te=`<${+Z+1}.0.0-0`:g(ye)?te=`<${Z}.${+he+1}.0-0`:ve?te=`<=${Z}.${he}.${ye}-${ve}`:B?te=`<${Z}.${he}.${+ye+1}-0`:te=`<=${te}`,`${Q} ${te}`.trim()),q=(B,H,Q)=>{for(let se=0;se<B.length;se++)if(!B[se].test(H))return!1;if(H.prerelease.length&&!Q.includePrerelease){for(let se=0;se<B.length;se++)if(o(B[se].semver),B[se].semver!==i.ANY&&B[se].semver.prerelease.length>0){const F=B[se].semver;if(F.major===H.major&&F.minor===H.minor&&F.patch===H.patch)return!0}return!1}return!0};return Fm}var Lm,lj;function cb(){if(lj)return Lm;lj=1;const a=Symbol("SemVer ANY");class e{static get ANY(){return a}constructor(c,f){if(f=t(f),c instanceof e){if(c.loose===!!f.loose)return c;c=c.value}c=c.trim().split(/\s+/).join(" "),o("comparator",c,f),this.options=f,this.loose=!!f.loose,this.parse(c),this.semver===a?this.value="":this.value=this.operator+this.semver.version,o("comp",this)}parse(c){const f=this.options.loose?r[n.COMPARATORLOOSE]:r[n.COMPARATOR],p=c.match(f);if(!p)throw new TypeError(`Invalid comparator: ${c}`);this.operator=p[1]!==void 0?p[1]:"",this.operator==="="&&(this.operator=""),p[2]?this.semver=new s(p[2],this.options.loose):this.semver=a}toString(){return this.value}test(c){if(o("Comparator.test",c,this.options.loose),this.semver===a||c===a)return!0;if(typeof c=="string")try{c=new s(c,this.options)}catch{return!1}return i(c,this.operator,this.semver,this.options)}intersects(c,f){if(!(c instanceof e))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new u(c.value,f).test(this.value):c.operator===""?c.value===""?!0:new u(this.value,f).test(c.semver):(f=t(f),f.includePrerelease&&(this.value==="<0.0.0-0"||c.value==="<0.0.0-0")||!f.includePrerelease&&(this.value.startsWith("<0.0.0")||c.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&c.operator.startsWith(">")||this.operator.startsWith("<")&&c.operator.startsWith("<")||this.semver.version===c.semver.version&&this.operator.includes("=")&&c.operator.includes("=")||i(this.semver,"<",c.semver,f)&&this.operator.startsWith(">")&&c.operator.startsWith("<")||i(this.semver,">",c.semver,f)&&this.operator.startsWith("<")&&c.operator.startsWith(">")))}}Lm=e;const t=gR(),{safeRe:r,t:n}=Fp(),i=A4(),o=ub(),s=Xt(),u=Xs();return Lm}var Vm,cj;function fb(){if(cj)return Vm;cj=1;const a=Xs();return Vm=(t,r,n)=>{try{r=new a(r,n)}catch{return!1}return r.test(t)},Vm}var Gm,fj;function g5(){if(fj)return Gm;fj=1;const a=Xs();return Gm=(t,r)=>new a(t,r).set.map(n=>n.map(i=>i.value).join(" ").trim().split(" ")),Gm}var km,dj;function v5(){if(dj)return km;dj=1;const a=Xt(),e=Xs();return km=(r,n,i)=>{let o=null,s=null,u=null;try{u=new e(n,i)}catch{return null}return r.forEach(l=>{u.test(l)&&(!o||s.compare(l)===-1)&&(o=l,s=new a(o,i))}),o},km}var Hm,hj;function w5(){if(hj)return Hm;hj=1;const a=Xt(),e=Xs();return Hm=(r,n,i)=>{let o=null,s=null,u=null;try{u=new e(n,i)}catch{return null}return r.forEach(l=>{u.test(l)&&(!o||s.compare(l)===1)&&(o=l,s=new a(o,i))}),o},Hm}var Wm,pj;function O5(){if(pj)return Wm;pj=1;const a=Xt(),e=Xs(),t=lb();return Wm=(n,i)=>{n=new e(n,i);let o=new a("0.0.0");if(n.test(o)||(o=new a("0.0.0-0"),n.test(o)))return o;o=null;for(let s=0;s<n.set.length;++s){const u=n.set[s];let l=null;u.forEach(c=>{const f=new a(c.semver.version);switch(c.operator){case">":f.prerelease.length===0?f.patch++:f.prerelease.push(0),f.raw=f.format();case"":case">=":(!l||t(f,l))&&(l=f);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${c.operator}`)}}),l&&(!o||t(o,l))&&(o=l)}return o&&n.test(o)?o:null},Wm}var Km,_j;function S5(){if(_j)return Km;_j=1;const a=Xs();return Km=(t,r)=>{try{return new a(t,r).range||"*"}catch{return null}},Km}var Jm,yj;function ER(){if(yj)return Jm;yj=1;const a=Xt(),e=cb(),{ANY:t}=e,r=Xs(),n=fb(),i=lb(),o=wR(),s=SR(),u=OR();return Jm=(c,f,p,h)=>{c=new a(c,h),f=new r(f,h);let y,d,_,m,b;switch(p){case">":y=i,d=s,_=o,m=">",b=">=";break;case"<":y=o,d=u,_=i,m="<",b="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(n(c,f,h))return!1;for(let g=0;g<f.set.length;++g){const v=f.set[g];let w=null,S=null;if(v.forEach(R=>{R.semver===t&&(R=new e(">=0.0.0")),w=w||R,S=S||R,y(R.semver,w.semver,h)?w=R:_(R.semver,S.semver,h)&&(S=R)}),w.operator===m||w.operator===b||(!S.operator||S.operator===m)&&d(c,S.semver))return!1;if(S.operator===b&&_(c,S.semver))return!1}return!0},Jm}var Xm,bj;function E5(){if(bj)return Xm;bj=1;const a=ER();return Xm=(t,r,n)=>a(t,r,">",n),Xm}var Zm,mj;function R5(){if(mj)return Zm;mj=1;const a=ER();return Zm=(t,r,n)=>a(t,r,"<",n),Zm}var Qm,gj;function C5(){if(gj)return Qm;gj=1;const a=Xs();return Qm=(t,r,n)=>(t=new a(t,n),r=new a(r,n),t.intersects(r,n)),Qm}var Ym,vj;function P5(){if(vj)return Ym;vj=1;const a=fb(),e=Js();return Ym=(t,r,n)=>{const i=[];let o=null,s=null;const u=t.sort((p,h)=>e(p,h,n));for(const p of u)a(p,r,n)?(s=p,o||(o=p)):(s&&i.push([o,s]),s=null,o=null);o&&i.push([o,null]);const l=[];for(const[p,h]of i)p===h?l.push(p):!h&&p===u[0]?l.push("*"):h?p===u[0]?l.push(`<=${h}`):l.push(`${p} - ${h}`):l.push(`>=${p}`);const c=l.join(" || "),f=typeof r.raw=="string"?r.raw:String(r);return c.length<f.length?c:r},Ym}var eg,wj;function j5(){if(wj)return eg;wj=1;const a=Xs(),e=cb(),{ANY:t}=e,r=fb(),n=Js(),i=(f,p,h={})=>{if(f===p)return!0;f=new a(f,h),p=new a(p,h);let y=!1;e:for(const d of f.set){for(const _ of p.set){const m=u(d,_,h);if(y=y||m!==null,m)continue e}if(y)return!1}return!0},o=[new e(">=0.0.0-0")],s=[new e(">=0.0.0")],u=(f,p,h)=>{if(f===p)return!0;if(f.length===1&&f[0].semver===t){if(p.length===1&&p[0].semver===t)return!0;h.includePrerelease?f=o:f=s}if(p.length===1&&p[0].semver===t){if(h.includePrerelease)return!0;p=s}const y=new Set;let d,_;for(const P of f)P.operator===">"||P.operator===">="?d=l(d,P,h):P.operator==="<"||P.operator==="<="?_=c(_,P,h):y.add(P.semver);if(y.size>1)return null;let m;if(d&&_){if(m=n(d.semver,_.semver,h),m>0)return null;if(m===0&&(d.operator!==">="||_.operator!=="<="))return null}for(const P of y){if(d&&!r(P,String(d),h)||_&&!r(P,String(_),h))return null;for(const C of p)if(!r(P,String(C),h))return!1;return!0}let b,g,v,w,S=_&&!h.includePrerelease&&_.semver.prerelease.length?_.semver:!1,R=d&&!h.includePrerelease&&d.semver.prerelease.length?d.semver:!1;S&&S.prerelease.length===1&&_.operator==="<"&&S.prerelease[0]===0&&(S=!1);for(const P of p){if(w=w||P.operator===">"||P.operator===">=",v=v||P.operator==="<"||P.operator==="<=",d){if(R&&P.semver.prerelease&&P.semver.prerelease.length&&P.semver.major===R.major&&P.semver.minor===R.minor&&P.semver.patch===R.patch&&(R=!1),P.operator===">"||P.operator===">="){if(b=l(d,P,h),b===P&&b!==d)return!1}else if(d.operator===">="&&!r(d.semver,String(P),h))return!1}if(_){if(S&&P.semver.prerelease&&P.semver.prerelease.length&&P.semver.major===S.major&&P.semver.minor===S.minor&&P.semver.patch===S.patch&&(S=!1),P.operator==="<"||P.operator==="<="){if(g=c(_,P,h),g===P&&g!==_)return!1}else if(_.operator==="<="&&!r(_.semver,String(P),h))return!1}if(!P.operator&&(_||d)&&m!==0)return!1}return!(d&&v&&!_&&m!==0||_&&w&&!d&&m!==0||R||S)},l=(f,p,h)=>{if(!f)return p;const y=n(f.semver,p.semver,h);return y>0?f:y<0||p.operator===">"&&f.operator===">="?p:f},c=(f,p,h)=>{if(!f)return p;const y=n(f.semver,p.semver,h);return y<0?f:y>0||p.operator==="<"&&f.operator==="<="?p:f};return eg=i,eg}var tg,Oj;function T5(){if(Oj)return tg;Oj=1;const a=Fp(),e=sb(),t=Xt(),r=j4(),n=Df(),i=a5(),o=o5(),s=s5(),u=u5(),l=l5(),c=c5(),f=f5(),p=d5(),h=Js(),y=h5(),d=p5(),_=vR(),m=_5(),b=y5(),g=lb(),v=wR(),w=T4(),S=M4(),R=OR(),P=SR(),C=A4(),T=b5(),M=cb(),K=Xs(),q=fb(),B=g5(),H=v5(),Q=w5(),se=O5(),F=S5(),ee=ER(),A=E5(),J=R5(),te=C5(),Z=P5(),he=j5();return tg={parse:n,valid:i,clean:o,inc:s,diff:u,major:l,minor:c,patch:f,prerelease:p,compare:h,rcompare:y,compareLoose:d,compareBuild:_,sort:m,rsort:b,gt:g,lt:v,eq:w,neq:S,gte:R,lte:P,cmp:C,coerce:T,Comparator:M,Range:K,satisfies:q,toComparators:B,maxSatisfying:H,minSatisfying:Q,minVersion:se,validRange:F,outside:ee,gtr:A,ltr:J,intersects:te,simplifyRange:Z,subset:he,SemVer:t,re:a.re,src:a.src,tokens:a.t,SEMVER_SPEC_VERSION:e.SEMVER_SPEC_VERSION,RELEASE_TYPES:e.RELEASE_TYPES,compareIdentifiers:r.compareIdentifiers,rcompareIdentifiers:r.rcompareIdentifiers},tg}T5();function Mu(a){if(!a||a.split("/").length>2||a.startsWith("/")||a.endsWith("/")||a.split(":").length>2)throw new Error(`Invalid identifier format: ${a}`);const[e,t]=a.split(":"),r=t||"latest";if(e.includes("/")){const[n,i]=e.split("/",2);if(!n||!i)throw new Error(`Invalid identifier format: ${a}`);return[n,i,r]}else{if(!e)throw new Error(`Invalid identifier format: ${a}`);return["-",e,r]}}class M5 extends Error{constructor(e){super(e),this.name="LangSmithConflictError"}}async function Fe(a,e,t){let r;if(a.ok){t&&(r=await a.text());return}r=await a.text();const n=`Failed to ${e}. Received status [${a.status}]: ${a.statusText}. Server response: ${r}`;throw a.status===409?new M5(n):new Error(n)}var Sj="[...]",A5={result:"[Circular]"},Oy=[],ef=[];const I5=new TextEncoder;function D5(){return{depthLimit:Number.MAX_SAFE_INTEGER,edgesLimit:Number.MAX_SAFE_INTEGER}}function b_(a){return I5.encode(a)}function hr(a,e,t,r){var n;try{const i=JSON.stringify(a,e,t);return b_(i)}catch(i){if(!((n=i.message)!=null&&n.includes("Converting circular structure to JSON")))return console.warn("[WARNING]: LangSmith received unserializable value."),b_("[Unserializable]");console.warn("[WARNING]: LangSmith received circular JSON. This will decrease tracer performance."),typeof r>"u"&&(r=D5()),hE(a,"",0,[],void 0,0,r);let o;try{ef.length===0?o=JSON.stringify(a,e,t):o=JSON.stringify(a,x5(e),t)}catch{return b_("[unable to serialize, circular reference is too complex to analyze]")}finally{for(;Oy.length!==0;){const s=Oy.pop();s.length===4?Object.defineProperty(s[0],s[1],s[3]):s[0][s[1]]=s[2]}}return b_(o)}}function rg(a,e,t,r){var n=Object.getOwnPropertyDescriptor(r,t);n.get!==void 0?n.configurable?(Object.defineProperty(r,t,{value:a}),Oy.push([r,t,e,n])):ef.push([e,t,a]):(r[t]=a,Oy.push([r,t,e]))}function hE(a,e,t,r,n,i,o){i+=1;var s;if(typeof a=="object"&&a!==null){for(s=0;s<r.length;s++)if(r[s]===a){rg(A5,a,e,n);return}if(typeof o.depthLimit<"u"&&i>o.depthLimit){rg(Sj,a,e,n);return}if(typeof o.edgesLimit<"u"&&t+1>o.edgesLimit){rg(Sj,a,e,n);return}if(r.push(a),Array.isArray(a))for(s=0;s<a.length;s++)hE(a[s],s,s,r,a,i,o);else{var u=Object.keys(a);for(s=0;s<u.length;s++){var l=u[s];hE(a[l],l,s,r,a,i,o)}}r.pop()}}function x5(a){return a=typeof a<"u"?a:function(e,t){return t},function(e,t){if(ef.length>0)for(var r=0;r<ef.length;r++){var n=ef[r];if(n[1]===e&&n[0]===t){t=n[2],ef.splice(r,1);break}}return a.call(this,e,t)}}function Ej(a){const e=$4(),t=W5(),r=a.extra??{},n=r.metadata;return a.extra={...r,runtime:{...e,...r==null?void 0:r.runtime},metadata:{...t,...t.revision_id||a.revision_id?{revision_id:a.revision_id??t.revision_id}:{},...n}},a}const $5=a=>{const e=(a==null?void 0:a.toString())??zu("TRACING_SAMPLING_RATE");if(e===void 0)return;const t=parseFloat(e);if(t<0||t>1)throw new Error(`LANGSMITH_TRACING_SAMPLING_RATE must be between 0 and 1 if set. Got: ${t}`);return t},N5=a=>{const t=a.replace("http://","").replace("https://","").split("/")[0].split(":")[0];return t==="localhost"||t==="127.0.0.1"||t==="::1"};async function q5(a){const e=[];for await(const t of a)e.push(t);return e}function ng(a){if(a!==void 0)return a.trim().replace(/^"(.*)"$/,"$1").replace(/^'(.*)'$/,"$1")}const z5=async a=>{if((a==null?void 0:a.status)===429){const e=parseInt(a.headers.get("retry-after")??"30",10)*1e3;if(e>0)return await new Promise(t=>setTimeout(t,e)),!0}return!1};function Rj(a){return typeof a=="number"?Number(a.toFixed(4)):a}class B5{constructor(){Object.defineProperty(this,"items",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"sizeBytes",{enumerable:!0,configurable:!0,writable:!0,value:0})}peek(){return this.items[0]}push(e){let t;const r=new Promise(i=>{t=i}),n=hr(e.item).length;return this.items.push({action:e.action,payload:e.item,itemPromiseResolve:t,itemPromise:r,size:n}),this.sizeBytes+=n,r}pop(e){var n;if(e<1)throw new Error("Number of bytes to pop off may not be less than 1.");const t=[];let r=0;for(;r+(((n=this.peek())==null?void 0:n.size)??0)<e&&this.items.length>0;){const i=this.items.shift();i&&(t.push(i),r+=i.size,this.sizeBytes-=i.size)}if(t.length===0&&this.items.length>0){const i=this.items.shift();t.push(i),r+=i.size,this.sizeBytes-=i.size}return[t.map(i=>({action:i.action,item:i.payload})),()=>t.forEach(i=>i.itemPromiseResolve())]}}const U5=20971520,F5=2500;let I4=class pE{constructor(e={}){var r;Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiUrl",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"webUrl",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"caller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"batchIngestCaller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"timeout_ms",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_tenantId",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"hideInputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"hideOutputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tracingSampleRate",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"filteredPostUuids",{enumerable:!0,configurable:!0,writable:!0,value:new Set}),Object.defineProperty(this,"autoBatchTracing",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"autoBatchQueue",{enumerable:!0,configurable:!0,writable:!0,value:new B5}),Object.defineProperty(this,"autoBatchTimeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"autoBatchAggregationDelayMs",{enumerable:!0,configurable:!0,writable:!0,value:250}),Object.defineProperty(this,"batchSizeBytesLimit",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fetchOptions",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"settings",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"blockOnRootRunFinalization",{enumerable:!0,configurable:!0,writable:!0,value:vc("LANGSMITH_TRACING_BACKGROUND")==="false"}),Object.defineProperty(this,"traceBatchConcurrency",{enumerable:!0,configurable:!0,writable:!0,value:5}),Object.defineProperty(this,"_serverInfo",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_getServerInfoPromise",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"manualFlushMode",{enumerable:!0,configurable:!0,writable:!0,value:!1});const t=pE.getDefaultClientConfig();if(this.tracingSampleRate=$5(e.tracingSamplingRate),this.apiUrl=ng(e.apiUrl??t.apiUrl)??"",this.apiUrl.endsWith("/")&&(this.apiUrl=this.apiUrl.slice(0,-1)),this.apiKey=ng(e.apiKey??t.apiKey),this.webUrl=ng(e.webUrl??t.webUrl),(r=this.webUrl)!=null&&r.endsWith("/")&&(this.webUrl=this.webUrl.slice(0,-1)),this.timeout_ms=e.timeout_ms??9e4,this.caller=new jP(e.callerOptions??{}),this.traceBatchConcurrency=e.traceBatchConcurrency??this.traceBatchConcurrency,this.traceBatchConcurrency<1)throw new Error("Trace batch concurrency must be positive.");this.batchIngestCaller=new jP({maxRetries:2,maxConcurrency:this.traceBatchConcurrency,...e.callerOptions??{},onFailedResponseHook:z5}),this.hideInputs=e.hideInputs??e.anonymizer??t.hideInputs,this.hideOutputs=e.hideOutputs??e.anonymizer??t.hideOutputs,this.autoBatchTracing=e.autoBatchTracing??this.autoBatchTracing,this.blockOnRootRunFinalization=e.blockOnRootRunFinalization??this.blockOnRootRunFinalization,this.batchSizeBytesLimit=e.batchSizeBytesLimit,this.fetchOptions=e.fetchOptions||{},this.manualFlushMode=e.manualFlushMode??this.manualFlushMode}static getDefaultClientConfig(){const e=zu("API_KEY"),t=zu("ENDPOINT")??"https://api.smith.langchain.com",r=zu("HIDE_INPUTS")==="true",n=zu("HIDE_OUTPUTS")==="true";return{apiUrl:t,apiKey:e,webUrl:void 0,hideInputs:r,hideOutputs:n}}getHostUrl(){return this.webUrl?this.webUrl:N5(this.apiUrl)?(this.webUrl="http://localhost:3000",this.webUrl):this.apiUrl.endsWith("/api/v1")?(this.webUrl=this.apiUrl.replace("/api/v1",""),this.webUrl):this.apiUrl.includes("/api")&&!this.apiUrl.split(".",1)[0].endsWith("api")?(this.webUrl=this.apiUrl.replace("/api",""),this.webUrl):this.apiUrl.split(".",1)[0].includes("dev")?(this.webUrl="https://dev.smith.langchain.com",this.webUrl):this.apiUrl.split(".",1)[0].includes("eu")?(this.webUrl="https://eu.smith.langchain.com",this.webUrl):this.apiUrl.split(".",1)[0].includes("beta")?(this.webUrl="https://beta.smith.langchain.com",this.webUrl):(this.webUrl="https://smith.langchain.com",this.webUrl)}get headers(){const e={"User-Agent":`langsmith-js/${D4}`};return this.apiKey&&(e["x-api-key"]=`${this.apiKey}`),e}processInputs(e){return this.hideInputs===!1?e:this.hideInputs===!0?{}:typeof this.hideInputs=="function"?this.hideInputs(e):e}processOutputs(e){return this.hideOutputs===!1?e:this.hideOutputs===!0?{}:typeof this.hideOutputs=="function"?this.hideOutputs(e):e}prepareRunCreateOrUpdateInputs(e){const t={...e};return t.inputs!==void 0&&(t.inputs=this.processInputs(t.inputs)),t.outputs!==void 0&&(t.outputs=this.processOutputs(t.outputs)),t}async _getResponse(e,t){const r=(t==null?void 0:t.toString())??"",n=`${this.apiUrl}${e}?${r}`,i=await this.caller.call(je(),n,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Fe(i,`Failed to fetch ${e}`),i}async _get(e,t){return(await this._getResponse(e,t)).json()}async*_getPaginated(e,t=new URLSearchParams,r){let n=Number(t.get("offset"))||0;const i=Number(t.get("limit"))||100;for(;;){t.set("offset",String(n)),t.set("limit",String(i));const o=`${this.apiUrl}${e}?${t}`,s=await this.caller.call(je(),o,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Fe(s,`Failed to fetch ${e}`);const u=r?r(await s.json()):await s.json();if(u.length===0||(yield u,u.length<i))break;n+=u.length}}async*_getCursorPaginatedList(e,t=null,r="POST",n="runs"){const i=t?{...t}:{};for(;;){const s=await(await this.caller.call(je(),`${this.apiUrl}${e}`,{method:r,headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:JSON.stringify(i)})).json();if(!s||!s[n])break;yield s[n];const u=s.cursors;if(!u||!u.next)break;i.cursor=u.next}}_shouldSample(){return this.tracingSampleRate===void 0?!0:Math.random()<this.tracingSampleRate}_filterForSampling(e,t=!1){if(this.tracingSampleRate===void 0)return e;if(t){const r=[];for(const n of e)this.filteredPostUuids.has(n.id)?this.filteredPostUuids.delete(n.id):r.push(n);return r}else{const r=[];for(const n of e){const i=n.trace_id??n.id;this.filteredPostUuids.has(i)||(n.id===i?this._shouldSample()?r.push(n):this.filteredPostUuids.add(i):r.push(n))}return r}}async _getBatchSizeLimitBytes(){var t;const e=await this._ensureServerInfo();return this.batchSizeBytesLimit??((t=e.batch_ingest_config)==null?void 0:t.size_limit_bytes)??U5}async _getMultiPartSupport(){var t;return((t=(await this._ensureServerInfo()).instance_flags)==null?void 0:t.dataset_examples_multipart_enabled)??!1}drainAutoBatchQueue(e){const t=[];for(;this.autoBatchQueue.items.length>0;){const[r,n]=this.autoBatchQueue.pop(e);if(!r.length){n();break}const i=this._processBatch(r,n).catch(console.error);t.push(i)}return Promise.all(t)}async _processBatch(e,t){var r;if(!e.length){t();return}try{const n={runCreates:e.filter(o=>o.action==="create").map(o=>o.item),runUpdates:e.filter(o=>o.action==="update").map(o=>o.item)},i=await this._ensureServerInfo();(r=i==null?void 0:i.batch_ingest_config)!=null&&r.use_multipart_endpoint?await this.multipartIngestRuns(n):await this.batchIngestRuns(n)}finally{t()}}async processRunOperation(e){clearTimeout(this.autoBatchTimeout),this.autoBatchTimeout=void 0,e.action==="create"&&(e.item=Ej(e.item));const t=this.autoBatchQueue.push(e);if(this.manualFlushMode)return t;const r=await this._getBatchSizeLimitBytes();return this.autoBatchQueue.sizeBytes>r&&this.drainAutoBatchQueue(r),this.autoBatchQueue.items.length>0&&(this.autoBatchTimeout=setTimeout(()=>{this.autoBatchTimeout=void 0,this.drainAutoBatchQueue(r)},this.autoBatchAggregationDelayMs)),t}async _getServerInfo(){const e=await je()(`${this.apiUrl}/info`,{method:"GET",headers:{Accept:"application/json"},signal:AbortSignal.timeout(F5),...this.fetchOptions});return await Fe(e,"get server info"),e.json()}async _ensureServerInfo(){return this._getServerInfoPromise===void 0&&(this._getServerInfoPromise=(async()=>{if(this._serverInfo===void 0)try{this._serverInfo=await this._getServerInfo()}catch{console.warn("[WARNING]: LangSmith failed to fetch info on supported operations. Falling back to batch operations and default limits.")}return this._serverInfo??{}})()),this._getServerInfoPromise.then(e=>(this._serverInfo===void 0&&(this._getServerInfoPromise=void 0),e))}async _getSettings(){return this.settings||(this.settings=this._get("/settings")),await this.settings}async flush(){const e=await this._getBatchSizeLimitBytes();await this.drainAutoBatchQueue(e)}async createRun(e){if(!this._filterForSampling([e]).length)return;const t={...this.headers,"Content-Type":"application/json"},r=e.project_name;delete e.project_name;const n=this.prepareRunCreateOrUpdateInputs({session_name:r,...e,start_time:e.start_time??Date.now()});if(this.autoBatchTracing&&n.trace_id!==void 0&&n.dotted_order!==void 0){this.processRunOperation({action:"create",item:n}).catch(console.error);return}const i=Ej(n),o=await this.caller.call(je(),`${this.apiUrl}/runs`,{method:"POST",headers:t,body:hr(i),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Fe(o,"create run",!0)}async batchIngestRuns({runCreates:e,runUpdates:t}){if(e===void 0&&t===void 0)return;let r=(e==null?void 0:e.map(s=>this.prepareRunCreateOrUpdateInputs(s)))??[],n=(t==null?void 0:t.map(s=>this.prepareRunCreateOrUpdateInputs(s)))??[];if(r.length>0&&n.length>0){const s=r.reduce((l,c)=>(c.id&&(l[c.id]=c),l),{}),u=[];for(const l of n)l.id!==void 0&&s[l.id]?s[l.id]={...s[l.id],...l}:u.push(l);r=Object.values(s),n=u}const i={post:r,patch:n};if(!i.post.length&&!i.patch.length)return;const o={post:[],patch:[]};for(const s of["post","patch"]){const u=s,l=i[u].reverse();let c=l.pop();for(;c!==void 0;)o[u].push(c),c=l.pop()}(o.post.length>0||o.patch.length>0)&&await this._postBatchIngestRuns(hr(o))}async _postBatchIngestRuns(e){const t={...this.headers,"Content-Type":"application/json",Accept:"application/json"},r=await this.batchIngestCaller.call(je(),`${this.apiUrl}/runs/batch`,{method:"POST",headers:t,body:e,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Fe(r,"batch create run",!0)}async multipartIngestRuns({runCreates:e,runUpdates:t}){if(e===void 0&&t===void 0)return;const r={};let n=[];for(const c of e??[]){const f=this.prepareRunCreateOrUpdateInputs(c);f.id!==void 0&&f.attachments!==void 0&&(r[f.id]=f.attachments),delete f.attachments,n.push(f)}let i=[];for(const c of t??[])i.push(this.prepareRunCreateOrUpdateInputs(c));if(n.find(c=>c.trace_id===void 0||c.dotted_order===void 0)!==void 0)throw new Error('Multipart ingest requires "trace_id" and "dotted_order" to be set when creating a run');if(i.find(c=>c.trace_id===void 0||c.dotted_order===void 0)!==void 0)throw new Error('Multipart ingest requires "trace_id" and "dotted_order" to be set when updating a run');if(n.length>0&&i.length>0){const c=n.reduce((p,h)=>(h.id&&(p[h.id]=h),p),{}),f=[];for(const p of i)p.id!==void 0&&c[p.id]?c[p.id]={...c[p.id],...p}:f.push(p);n=Object.values(c),i=f}if(n.length===0&&i.length===0)return;const u=[],l=[];for(const[c,f]of[["post",n],["patch",i]])for(const p of f){const{inputs:h,outputs:y,events:d,attachments:_,...m}=p,b={inputs:h,outputs:y,events:d},g=hr(m);l.push({name:`${c}.${m.id}`,payload:new Blob([g],{type:`application/json; length=${g.length}`})});for(const[v,w]of Object.entries(b)){if(w===void 0)continue;const S=hr(w);l.push({name:`${c}.${m.id}.${v}`,payload:new Blob([S],{type:`application/json; length=${S.length}`})})}if(m.id!==void 0){const v=r[m.id];if(v){delete r[m.id];for(const[w,S]of Object.entries(v)){let R,P;if(Array.isArray(S)?[R,P]=S:(R=S.mimeType,P=S.data),w.includes(".")){console.warn(`Skipping attachment '${w}' for run ${m.id}: Invalid attachment name. Attachment names must not contain periods ('.'). Please rename the attachment and try again.`);continue}l.push({name:`attachment.${m.id}.${w}`,payload:new Blob([P],{type:`${R}; length=${P.byteLength}`})})}}}u.push(`trace=${m.trace_id},id=${m.id}`)}await this._sendMultipartRequest(l,u.join("; "))}async _sendMultipartRequest(e,t){try{const r="----LangSmithFormBoundary"+Math.random().toString(36).slice(2),n=[];for(const u of e)n.push(new Blob([`--${r}\r
`])),n.push(new Blob([`Content-Disposition: form-data; name="${u.name}"\r
`,`Content-Type: ${u.payload.type}\r
\r
`])),n.push(u.payload),n.push(new Blob([`\r
`]));n.push(new Blob([`--${r}--\r
`]));const o=await new Blob(n).arrayBuffer(),s=await this.batchIngestCaller.call(je(),`${this.apiUrl}/runs/multipart`,{method:"POST",headers:{...this.headers,"Content-Type":`multipart/form-data; boundary=${r}`},body:o,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Fe(s,"ingest multipart runs",!0)}catch(r){console.warn(`${r.message.trim()}

Context: ${t}`)}}async updateRun(e,t){xe(e),t.inputs&&(t.inputs=this.processInputs(t.inputs)),t.outputs&&(t.outputs=this.processOutputs(t.outputs));const r={...t,id:e};if(!this._filterForSampling([r],!0).length)return;if(this.autoBatchTracing&&r.trace_id!==void 0&&r.dotted_order!==void 0){if(t.end_time!==void 0&&r.parent_run_id===void 0&&this.blockOnRootRunFinalization&&!this.manualFlushMode){await this.processRunOperation({action:"update",item:r}).catch(console.error);return}else this.processRunOperation({action:"update",item:r}).catch(console.error);return}const n={...this.headers,"Content-Type":"application/json"},i=await this.caller.call(je(),`${this.apiUrl}/runs/${e}`,{method:"PATCH",headers:n,body:hr(t),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Fe(i,"update run",!0)}async readRun(e,{loadChildRuns:t}={loadChildRuns:!1}){xe(e);let r=await this._get(`/runs/${e}`);return t&&r.child_run_ids&&(r=await this._loadChildRuns(r)),r}async getRunUrl({runId:e,run:t,projectOpts:r}){if(t!==void 0){let n;t.session_id?n=t.session_id:r!=null&&r.projectName?n=(await this.readProject({projectName:r==null?void 0:r.projectName})).id:r!=null&&r.projectId?n=r==null?void 0:r.projectId:n=(await this.readProject({projectName:zu("PROJECT")||"default"})).id;const i=await this._getTenantId();return`${this.getHostUrl()}/o/${i}/projects/p/${n}/r/${t.id}?poll=true`}else if(e!==void 0){const n=await this.readRun(e);if(!n.app_path)throw new Error(`Run ${e} has no app_path`);return`${this.getHostUrl()}${n.app_path}`}else throw new Error("Must provide either runId or run")}async _loadChildRuns(e){const t=await q5(this.listRuns({id:e.child_run_ids})),r={},n={};t.sort((i,o)=>((i==null?void 0:i.dotted_order)??"").localeCompare((o==null?void 0:o.dotted_order)??""));for(const i of t){if(i.parent_run_id===null||i.parent_run_id===void 0)throw new Error(`Child run ${i.id} has no parent`);i.parent_run_id in r||(r[i.parent_run_id]=[]),r[i.parent_run_id].push(i),n[i.id]=i}e.child_runs=r[e.id]||[];for(const i in r)i!==e.id&&(n[i].child_runs=r[i]);return e}async*listRuns(e){const{projectId:t,projectName:r,parentRunId:n,traceId:i,referenceExampleId:o,startTime:s,executionOrder:u,isRoot:l,runType:c,error:f,id:p,query:h,filter:y,traceFilter:d,treeFilter:_,limit:m,select:b}=e;let g=[];if(t&&(g=Array.isArray(t)?t:[t]),r){const R=Array.isArray(r)?r:[r],P=await Promise.all(R.map(C=>this.readProject({projectName:C}).then(T=>T.id)));g.push(...P)}const v=["app_path","child_run_ids","completion_cost","completion_tokens","dotted_order","end_time","error","events","extra","feedback_stats","first_token_time","id","inputs","name","outputs","parent_run_id","parent_run_ids","prompt_cost","prompt_tokens","reference_example_id","run_type","session_id","start_time","status","tags","total_cost","total_tokens","trace_id"],w={session:g.length?g:null,run_type:c,reference_example:o,query:h,filter:y,trace_filter:d,tree_filter:_,execution_order:u,parent_run:n,start_time:s?s.toISOString():null,error:f,id:p,limit:m,trace:i,select:b||v,is_root:l};let S=0;for await(const R of this._getCursorPaginatedList("/runs/query",w))if(m){if(S>=m)break;if(R.length+S>m){yield*R.slice(0,m-S);break}S+=R.length,yield*R}else yield*R}async getRunStats({id:e,trace:t,parentRun:r,runType:n,projectNames:i,projectIds:o,referenceExampleIds:s,startTime:u,endTime:l,error:c,query:f,filter:p,traceFilter:h,treeFilter:y,isRoot:d,dataSourceType:_}){let m=o||[];i&&(m=[...o||[],...await Promise.all(i.map(S=>this.readProject({projectName:S}).then(R=>R.id)))]);const g=Object.fromEntries(Object.entries({id:e,trace:t,parent_run:r,run_type:n,session:m,reference_example:s,start_time:u,end_time:l,error:c,query:f,filter:p,trace_filter:h,tree_filter:y,is_root:d,data_source_type:_}).filter(([S,R])=>R!==void 0));return await(await this.caller.call(je(),`${this.apiUrl}/runs/stats`,{method:"POST",headers:this.headers,body:JSON.stringify(g),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json()}async shareRun(e,{shareId:t}={}){const r={run_id:e,share_token:t||xt()};xe(e);const i=await(await this.caller.call(je(),`${this.apiUrl}/runs/${e}/share`,{method:"PUT",headers:this.headers,body:JSON.stringify(r),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json();if(i===null||!("share_token"in i))throw new Error("Invalid response from server");return`${this.getHostUrl()}/public/${i.share_token}/r`}async unshareRun(e){xe(e);const t=await this.caller.call(je(),`${this.apiUrl}/runs/${e}/share`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Fe(t,"unshare run",!0)}async readRunSharedLink(e){xe(e);const r=await(await this.caller.call(je(),`${this.apiUrl}/runs/${e}/share`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json();if(!(r===null||!("share_token"in r)))return`${this.getHostUrl()}/public/${r.share_token}/r`}async listSharedRuns(e,{runIds:t}={}){const r=new URLSearchParams({share_token:e});if(t!==void 0)for(const o of t)r.append("id",o);return xe(e),await(await this.caller.call(je(),`${this.apiUrl}/public/${e}/runs${r}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json()}async readDatasetSharedSchema(e,t){if(!e&&!t)throw new Error("Either datasetId or datasetName must be given");e||(e=(await this.readDataset({datasetName:t})).id),xe(e);const n=await(await this.caller.call(je(),`${this.apiUrl}/datasets/${e}/share`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json();return n.url=`${this.getHostUrl()}/public/${n.share_token}/d`,n}async shareDataset(e,t){if(!e&&!t)throw new Error("Either datasetId or datasetName must be given");e||(e=(await this.readDataset({datasetName:t})).id);const r={dataset_id:e};xe(e);const i=await(await this.caller.call(je(),`${this.apiUrl}/datasets/${e}/share`,{method:"PUT",headers:this.headers,body:JSON.stringify(r),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json();return i.url=`${this.getHostUrl()}/public/${i.share_token}/d`,i}async unshareDataset(e){xe(e);const t=await this.caller.call(je(),`${this.apiUrl}/datasets/${e}/share`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Fe(t,"unshare dataset",!0)}async readSharedDataset(e){return xe(e),await(await this.caller.call(je(),`${this.apiUrl}/public/${e}/datasets`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json()}async listSharedExamples(e,t){const r={};t!=null&&t.exampleIds&&(r.id=t.exampleIds);const n=new URLSearchParams;Object.entries(r).forEach(([s,u])=>{Array.isArray(u)?u.forEach(l=>n.append(s,l)):n.append(s,u)});const i=await this.caller.call(je(),`${this.apiUrl}/public/${e}/examples?${n.toString()}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions}),o=await i.json();if(!i.ok)throw"detail"in o?new Error(`Failed to list shared examples.
Status: ${i.status}
Message: ${o.detail.join(`
`)}`):new Error(`Failed to list shared examples: ${i.status} ${i.statusText}`);return o.map(s=>({...s,_hostUrl:this.getHostUrl()}))}async createProject({projectName:e,description:t=null,metadata:r=null,upsert:n=!1,projectExtra:i=null,referenceDatasetId:o=null}){const s=n?"?upsert=true":"",u=`${this.apiUrl}/sessions${s}`,l=i||{};r&&(l.metadata=r);const c={name:e,extra:l,description:t};o!==null&&(c.reference_dataset_id=o);const f=await this.caller.call(je(),u,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(c),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Fe(f,"create project"),await f.json()}async updateProject(e,{name:t=null,description:r=null,metadata:n=null,projectExtra:i=null,endTime:o=null}){const s=`${this.apiUrl}/sessions/${e}`;let u=i;n&&(u={...u||{},metadata:n});const l={name:t,extra:u,description:r,end_time:o?new Date(o).toISOString():null},c=await this.caller.call(je(),s,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(l),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Fe(c,"update project"),await c.json()}async hasProject({projectId:e,projectName:t}){let r="/sessions";const n=new URLSearchParams;if(e!==void 0&&t!==void 0)throw new Error("Must provide either projectName or projectId, not both");if(e!==void 0)xe(e),r+=`/${e}`;else if(t!==void 0)n.append("name",t);else throw new Error("Must provide projectName or projectId");const i=await this.caller.call(je(),`${this.apiUrl}${r}?${n}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});try{const o=await i.json();return i.ok?Array.isArray(o)?o.length>0:!0:!1}catch{return!1}}async readProject({projectId:e,projectName:t,includeStats:r}){let n="/sessions";const i=new URLSearchParams;if(e!==void 0&&t!==void 0)throw new Error("Must provide either projectName or projectId, not both");if(e!==void 0)xe(e),n+=`/${e}`;else if(t!==void 0)i.append("name",t);else throw new Error("Must provide projectName or projectId");r!==void 0&&i.append("include_stats",r.toString());const o=await this._get(n,i);let s;if(Array.isArray(o)){if(o.length===0)throw new Error(`Project[id=${e}, name=${t}] not found`);s=o[0]}else s=o;return s}async getProjectUrl({projectId:e,projectName:t}){if(e===void 0&&t===void 0)throw new Error("Must provide either projectName or projectId");const r=await this.readProject({projectId:e,projectName:t}),n=await this._getTenantId();return`${this.getHostUrl()}/o/${n}/projects/p/${r.id}`}async getDatasetUrl({datasetId:e,datasetName:t}){if(e===void 0&&t===void 0)throw new Error("Must provide either datasetName or datasetId");const r=await this.readDataset({datasetId:e,datasetName:t}),n=await this._getTenantId();return`${this.getHostUrl()}/o/${n}/datasets/${r.id}`}async _getTenantId(){if(this._tenantId!==null)return this._tenantId;const e=new URLSearchParams({limit:"1"});for await(const t of this._getPaginated("/sessions",e))return this._tenantId=t[0].tenant_id,t[0].tenant_id;throw new Error("No projects found to resolve tenant.")}async*listProjects({projectIds:e,name:t,nameContains:r,referenceDatasetId:n,referenceDatasetName:i,referenceFree:o,metadata:s}={}){const u=new URLSearchParams;if(e!==void 0)for(const l of e)u.append("id",l);if(t!==void 0&&u.append("name",t),r!==void 0&&u.append("name_contains",r),n!==void 0)u.append("reference_dataset",n);else if(i!==void 0){const l=await this.readDataset({datasetName:i});u.append("reference_dataset",l.id)}o!==void 0&&u.append("reference_free",o.toString()),s!==void 0&&u.append("metadata",JSON.stringify(s));for await(const l of this._getPaginated("/sessions",u))yield*l}async deleteProject({projectId:e,projectName:t}){let r;if(e===void 0&&t===void 0)throw new Error("Must provide projectName or projectId");if(e!==void 0&&t!==void 0)throw new Error("Must provide either projectName or projectId, not both");e===void 0?r=(await this.readProject({projectName:t})).id:r=e,xe(r);const n=await this.caller.call(je(),`${this.apiUrl}/sessions/${r}`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Fe(n,`delete session ${r} (${t})`,!0)}async uploadCsv({csvFile:e,fileName:t,inputKeys:r,outputKeys:n,description:i,dataType:o,name:s}){const u=`${this.apiUrl}/datasets/upload`,l=new FormData;l.append("file",e,t),r.forEach(p=>{l.append("input_keys",p)}),n.forEach(p=>{l.append("output_keys",p)}),i&&l.append("description",i),o&&l.append("data_type",o),s&&l.append("name",s);const c=await this.caller.call(je(),u,{method:"POST",headers:this.headers,body:l,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Fe(c,"upload CSV"),await c.json()}async createDataset(e,{description:t,dataType:r,inputsSchema:n,outputsSchema:i,metadata:o}={}){const s={name:e,description:t,extra:o?{metadata:o}:void 0};r&&(s.data_type=r),n&&(s.inputs_schema_definition=n),i&&(s.outputs_schema_definition=i);const u=await this.caller.call(je(),`${this.apiUrl}/datasets`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(s),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Fe(u,"create dataset"),await u.json()}async readDataset({datasetId:e,datasetName:t}){let r="/datasets";const n=new URLSearchParams({limit:"1"});if(e!==void 0&&t!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");if(e!==void 0)xe(e),r+=`/${e}`;else if(t!==void 0)n.append("name",t);else throw new Error("Must provide datasetName or datasetId");const i=await this._get(r,n);let o;if(Array.isArray(i)){if(i.length===0)throw new Error(`Dataset[id=${e}, name=${t}] not found`);o=i[0]}else o=i;return o}async hasDataset({datasetId:e,datasetName:t}){try{return await this.readDataset({datasetId:e,datasetName:t}),!0}catch(r){if(r instanceof Error&&r.message.toLocaleLowerCase().includes("not found"))return!1;throw r}}async diffDatasetVersions({datasetId:e,datasetName:t,fromVersion:r,toVersion:n}){let i=e;if(i===void 0&&t===void 0)throw new Error("Must provide either datasetName or datasetId");if(i!==void 0&&t!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");i===void 0&&(i=(await this.readDataset({datasetName:t})).id);const o=new URLSearchParams({from_version:typeof r=="string"?r:r.toISOString(),to_version:typeof n=="string"?n:n.toISOString()});return await this._get(`/datasets/${i}/versions/diff`,o)}async readDatasetOpenaiFinetuning({datasetId:e,datasetName:t}){const r="/datasets";if(e===void 0)if(t!==void 0)e=(await this.readDataset({datasetName:t})).id;else throw new Error("Must provide either datasetName or datasetId");return(await(await this._getResponse(`${r}/${e}/openai_ft`)).text()).trim().split(`
`).map(s=>JSON.parse(s))}async*listDatasets({limit:e=100,offset:t=0,datasetIds:r,datasetName:n,datasetNameContains:i,metadata:o}={}){const s="/datasets",u=new URLSearchParams({limit:e.toString(),offset:t.toString()});if(r!==void 0)for(const l of r)u.append("id",l);n!==void 0&&u.append("name",n),i!==void 0&&u.append("name_contains",i),o!==void 0&&u.append("metadata",JSON.stringify(o));for await(const l of this._getPaginated(s,u))yield*l}async updateDataset(e){const{datasetId:t,datasetName:r,...n}=e;if(!t&&!r)throw new Error("Must provide either datasetName or datasetId");const i=t??(await this.readDataset({datasetName:r})).id;xe(i);const o=await this.caller.call(je(),`${this.apiUrl}/datasets/${i}`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(n),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Fe(o,"update dataset"),await o.json()}async updateDatasetTag(e){const{datasetId:t,datasetName:r,asOf:n,tag:i}=e;if(!t&&!r)throw new Error("Must provide either datasetName or datasetId");const o=t??(await this.readDataset({datasetName:r})).id;xe(o);const s=await this.caller.call(je(),`${this.apiUrl}/datasets/${o}/tags`,{method:"PUT",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify({as_of:typeof n=="string"?n:n.toISOString(),tag:i}),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Fe(s,"update dataset tags")}async deleteDataset({datasetId:e,datasetName:t}){let r="/datasets",n=e;if(e!==void 0&&t!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");if(t!==void 0&&(n=(await this.readDataset({datasetName:t})).id),n!==void 0)xe(n),r+=`/${n}`;else throw new Error("Must provide datasetName or datasetId");const i=await this.caller.call(je(),this.apiUrl+r,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Fe(i,`delete ${r}`),await i.json()}async indexDataset({datasetId:e,datasetName:t,tag:r}){let n=e;if(!n&&!t)throw new Error("Must provide either datasetName or datasetId");if(n&&t)throw new Error("Must provide either datasetName or datasetId, not both");n||(n=(await this.readDataset({datasetName:t})).id),xe(n);const i={tag:r},o=await this.caller.call(je(),`${this.apiUrl}/datasets/${n}/index`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(i),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Fe(o,"index dataset"),await o.json()}async similarExamples(e,t,r,{filter:n}={}){const i={limit:r,inputs:e};n!==void 0&&(i.filter=n),xe(t);const o=await this.caller.call(je(),`${this.apiUrl}/datasets/${t}/search`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(i),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Fe(o,"fetch similar examples"),(await o.json()).examples}async createExample(e,t,r){var c;if(Cj(e)&&(t!==void 0||r!==void 0))throw new Error("Cannot provide outputs or options when using ExampleCreate object");let n=t?r==null?void 0:r.datasetId:e.dataset_id;const i=t?r==null?void 0:r.datasetName:e.dataset_name;if(n===void 0&&i===void 0)throw new Error("Must provide either datasetName or datasetId");if(n!==void 0&&i!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");n===void 0&&(n=(await this.readDataset({datasetName:i})).id);const o=(t?r==null?void 0:r.createdAt:e.created_at)||new Date;let s;Cj(e)?s=e:s={inputs:e,outputs:t,created_at:o==null?void 0:o.toISOString(),id:r==null?void 0:r.exampleId,metadata:r==null?void 0:r.metadata,split:r==null?void 0:r.split,source_run_id:r==null?void 0:r.sourceRunId,use_source_run_io:r==null?void 0:r.useSourceRunIO,use_source_run_attachments:r==null?void 0:r.useSourceRunAttachments,attachments:r==null?void 0:r.attachments};const u=await this._uploadExamplesMultipart(n,[s]);return await this.readExample(((c=u.example_ids)==null?void 0:c[0])??xt())}async createExamples(e){if(Array.isArray(e)){if(e.length===0)return[];const b=e;let g=b[0].dataset_id;const v=b[0].dataset_name;if(g===void 0&&v===void 0)throw new Error("Must provide either datasetName or datasetId");if(g!==void 0&&v!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");g===void 0&&(g=(await this.readDataset({datasetName:v})).id);const w=await this._uploadExamplesMultipart(g,b);return await Promise.all(w.example_ids.map(R=>this.readExample(R)))}const{inputs:t,outputs:r,metadata:n,splits:i,sourceRunIds:o,useSourceRunIOs:s,useSourceRunAttachments:u,attachments:l,exampleIds:c,datasetId:f,datasetName:p}=e;if(t===void 0)throw new Error("Must provide inputs when using legacy parameters");let h=f;const y=p;if(h===void 0&&y===void 0)throw new Error("Must provide either datasetName or datasetId");if(h!==void 0&&y!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");h===void 0&&(h=(await this.readDataset({datasetName:y})).id);const d=t.map((b,g)=>({dataset_id:h,inputs:b,outputs:r==null?void 0:r[g],metadata:n==null?void 0:n[g],split:i==null?void 0:i[g],id:c==null?void 0:c[g],attachments:l==null?void 0:l[g],source_run_id:o==null?void 0:o[g],use_source_run_io:s==null?void 0:s[g],use_source_run_attachments:u==null?void 0:u[g]})),_=await this._uploadExamplesMultipart(h,d);return await Promise.all(_.example_ids.map(b=>this.readExample(b)))}async createLLMExample(e,t,r){return this.createExample({input:e},{output:t},r)}async createChatExample(e,t,r){const n=e.map(o=>TP(o)?MP(o):o),i=TP(t)?MP(t):t;return this.createExample({input:n},{output:i},r)}async readExample(e){xe(e);const t=`/examples/${e}`,r=await this._get(t),{attachment_urls:n,...i}=r,o=i;return n&&(o.attachments=Object.entries(n).reduce((s,[u,l])=>(s[u.slice(11)]={presigned_url:l.presigned_url,mime_type:l.mime_type},s),{})),o}async*listExamples({datasetId:e,datasetName:t,exampleIds:r,asOf:n,splits:i,inlineS3Urls:o,metadata:s,limit:u,offset:l,filter:c,includeAttachments:f}={}){let p;if(e!==void 0&&t!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");if(e!==void 0)p=e;else if(t!==void 0)p=(await this.readDataset({datasetName:t})).id;else throw new Error("Must provide a datasetName or datasetId");const h=new URLSearchParams({dataset:p}),y=n?typeof n=="string"?n:n==null?void 0:n.toISOString():void 0;y&&h.append("as_of",y);const d=o??!0;if(h.append("inline_s3_urls",d.toString()),r!==void 0)for(const m of r)h.append("id",m);if(i!==void 0)for(const m of i)h.append("splits",m);if(s!==void 0){const m=JSON.stringify(s);h.append("metadata",m)}u!==void 0&&h.append("limit",u.toString()),l!==void 0&&h.append("offset",l.toString()),c!==void 0&&h.append("filter",c),f===!0&&["attachment_urls","outputs","metadata"].forEach(m=>h.append("select",m));let _=0;for await(const m of this._getPaginated("/examples",h)){for(const b of m){const{attachment_urls:g,...v}=b,w=v;g&&(w.attachments=Object.entries(g).reduce((S,[R,P])=>(S[R.slice(11)]={presigned_url:P.presigned_url,mime_type:P.mime_type||void 0},S),{})),yield w,_++}if(u!==void 0&&_>=u)break}}async deleteExample(e){xe(e);const t=`/examples/${e}`,r=await this.caller.call(je(),this.apiUrl+t,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Fe(r,`delete ${t}`),await r.json()}async updateExample(e,t){let r;t?r=e:r=e.id,xe(r);let n;t?n={id:r,...t}:n=e;let i;return n.dataset_id!==void 0?i=n.dataset_id:i=(await this.readExample(r)).dataset_id,this._updateExamplesMultipart(i,[n])}async updateExamples(e){let t;return e[0].dataset_id===void 0?t=(await this.readExample(e[0].id)).dataset_id:t=e[0].dataset_id,this._updateExamplesMultipart(t,e)}async readDatasetVersion({datasetId:e,datasetName:t,asOf:r,tag:n}){let i;if(e?i=e:i=(await this.readDataset({datasetName:t})).id,xe(i),r&&n||!r&&!n)throw new Error("Exactly one of asOf and tag must be specified.");const o=new URLSearchParams;r!==void 0&&o.append("as_of",typeof r=="string"?r:r.toISOString()),n!==void 0&&o.append("tag",n);const s=await this.caller.call(je(),`${this.apiUrl}/datasets/${i}/version?${o.toString()}`,{method:"GET",headers:{...this.headers},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Fe(s,"read dataset version"),await s.json()}async listDatasetSplits({datasetId:e,datasetName:t,asOf:r}){let n;if(e===void 0&&t===void 0)throw new Error("Must provide dataset name or ID");if(e!==void 0&&t!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");e===void 0?n=(await this.readDataset({datasetName:t})).id:n=e,xe(n);const i=new URLSearchParams,o=r?typeof r=="string"?r:r==null?void 0:r.toISOString():void 0;return o&&i.append("as_of",o),await this._get(`/datasets/${n}/splits`,i)}async updateDatasetSplits({datasetId:e,datasetName:t,splitName:r,exampleIds:n,remove:i=!1}){let o;if(e===void 0&&t===void 0)throw new Error("Must provide dataset name or ID");if(e!==void 0&&t!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");e===void 0?o=(await this.readDataset({datasetName:t})).id:o=e,xe(o);const s={split_name:r,examples:n.map(l=>(xe(l),l)),remove:i},u=await this.caller.call(je(),`${this.apiUrl}/datasets/${o}/splits`,{method:"PUT",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(s),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Fe(u,"update dataset splits",!0)}async evaluateRun(e,t,{sourceInfo:r,loadChildRuns:n,referenceExample:i}={loadChildRuns:!1}){P4("This method is deprecated and will be removed in future LangSmith versions, use `evaluate` from `langsmith/evaluation` instead.");let o;if(typeof e=="string")o=await this.readRun(e,{loadChildRuns:n});else if(typeof e=="object"&&"id"in e)o=e;else throw new Error(`Invalid run type: ${typeof e}`);o.reference_example_id!==null&&o.reference_example_id!==void 0&&(i=await this.readExample(o.reference_example_id));const s=await t.evaluateRun(o,i),[u,l]=await this._logEvaluationFeedback(s,o,r);return l[0]}async createFeedback(e,t,{score:r,value:n,correction:i,comment:o,sourceInfo:s,feedbackSourceType:u="api",sourceRunId:l,feedbackId:c,feedbackConfig:f,projectId:p,comparativeExperimentId:h}){var b;if(!e&&!p)throw new Error("One of runId or projectId must be provided");if(e&&p)throw new Error("Only one of runId or projectId can be provided");const y={type:u??"api",metadata:s??{}};l!==void 0&&(y==null?void 0:y.metadata)!==void 0&&!y.metadata.__run&&(y.metadata.__run={run_id:l}),(y==null?void 0:y.metadata)!==void 0&&((b=y.metadata.__run)==null?void 0:b.run_id)!==void 0&&xe(y.metadata.__run.run_id);const d={id:c??xt(),run_id:e,key:t,score:Rj(r),value:n,correction:i,comment:o,feedback_source:y,comparative_experiment_id:h,feedbackConfig:f,session_id:p},_=`${this.apiUrl}/feedback`,m=await this.caller.call(je(),_,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(d),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Fe(m,"create feedback",!0),d}async updateFeedback(e,{score:t,value:r,correction:n,comment:i}){const o={};t!=null&&(o.score=Rj(t)),r!=null&&(o.value=r),n!=null&&(o.correction=n),i!=null&&(o.comment=i),xe(e);const s=await this.caller.call(je(),`${this.apiUrl}/feedback/${e}`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(o),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Fe(s,"update feedback",!0)}async readFeedback(e){xe(e);const t=`/feedback/${e}`;return await this._get(t)}async deleteFeedback(e){xe(e);const t=`/feedback/${e}`,r=await this.caller.call(je(),this.apiUrl+t,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Fe(r,`delete ${t}`),await r.json()}async*listFeedback({runIds:e,feedbackKeys:t,feedbackSourceTypes:r}={}){const n=new URLSearchParams;if(e&&n.append("run",e.join(",")),t)for(const i of t)n.append("key",i);if(r)for(const i of r)n.append("source",i);for await(const i of this._getPaginated("/feedback",n))yield*i}async createPresignedFeedbackToken(e,t,{expiration:r,feedbackConfig:n}={}){const i={run_id:e,feedback_key:t,feedback_config:n};return r?typeof r=="string"?i.expires_at=r:(r!=null&&r.hours||r!=null&&r.minutes||r!=null&&r.days)&&(i.expires_in=r):i.expires_in={hours:3},await(await this.caller.call(je(),`${this.apiUrl}/feedback/tokens`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(i),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json()}async createComparativeExperiment({name:e,experimentIds:t,referenceDatasetId:r,createdAt:n,description:i,metadata:o,id:s}){var c;if(t.length===0)throw new Error("At least one experiment is required");if(r||(r=(await this.readProject({projectId:t[0]})).reference_dataset_id),!r==null)throw new Error("A reference dataset is required");const u={id:s,name:e,experiment_ids:t,reference_dataset_id:r,description:i,created_at:(c=n??new Date)==null?void 0:c.toISOString(),extra:{}};return o&&(u.extra.metadata=o),await(await this.caller.call(je(),`${this.apiUrl}/datasets/comparative`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(u),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json()}async*listPresignedFeedbackTokens(e){xe(e);const t=new URLSearchParams({run_id:e});for await(const r of this._getPaginated("/feedback/tokens",t))yield*r}_selectEvalResults(e){let t;return"results"in e?t=e.results:Array.isArray(e)?t=e:t=[e],t}async _logEvaluationFeedback(e,t,r){const n=this._selectEvalResults(e),i=[];for(const o of n){let s=r||{};o.evaluatorInfo&&(s={...o.evaluatorInfo,...s});let u=null;o.targetRunId?u=o.targetRunId:t&&(u=t.id),i.push(await this.createFeedback(u,o.key,{score:o.score,value:o.value,comment:o.comment,correction:o.correction,sourceInfo:s,sourceRunId:o.sourceRunId,feedbackConfig:o.feedbackConfig,feedbackSourceType:"model"}))}return[n,i]}async logEvaluationFeedback(e,t,r){const[n]=await this._logEvaluationFeedback(e,t,r);return n}async*listAnnotationQueues(e={}){const{queueIds:t,name:r,nameContains:n,limit:i}=e,o=new URLSearchParams;t&&t.forEach((u,l)=>{xe(u,`queueIds[${l}]`),o.append("ids",u)}),r&&o.append("name",r),n&&o.append("name_contains",n),o.append("limit",(i!==void 0?Math.min(i,100):100).toString());let s=0;for await(const u of this._getPaginated("/annotation-queues",o))if(yield*u,s++,i!==void 0&&s>=i)break}async createAnnotationQueue(e){const{name:t,description:r,queueId:n}=e,i={name:t,description:r,id:n||xt()},o=await this.caller.call(je(),`${this.apiUrl}/annotation-queues`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(Object.fromEntries(Object.entries(i).filter(([u,l])=>l!==void 0))),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Fe(o,"create annotation queue"),await o.json()}async readAnnotationQueue(e){const t=await this.listAnnotationQueues({queueIds:[e]}).next();if(t.done)throw new Error(`Annotation queue with ID ${e} not found`);return t.value}async updateAnnotationQueue(e,t){const{name:r,description:n}=t,i=await this.caller.call(je(),`${this.apiUrl}/annotation-queues/${xe(e,"queueId")}`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify({name:r,description:n}),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Fe(i,"update annotation queue")}async deleteAnnotationQueue(e){const t=await this.caller.call(je(),`${this.apiUrl}/annotation-queues/${xe(e,"queueId")}`,{method:"DELETE",headers:{...this.headers,Accept:"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Fe(t,"delete annotation queue")}async addRunsToAnnotationQueue(e,t){const r=await this.caller.call(je(),`${this.apiUrl}/annotation-queues/${xe(e,"queueId")}/runs`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(t.map((n,i)=>xe(n,`runIds[${i}]`).toString())),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Fe(r,"add runs to annotation queue")}async getRunFromAnnotationQueue(e,t){const r=`/annotation-queues/${xe(e,"queueId")}/run`,n=await this.caller.call(je(),`${this.apiUrl}${r}/${t}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Fe(n,"get run from annotation queue"),await n.json()}async deleteRunFromAnnotationQueue(e,t){const r=await this.caller.call(je(),`${this.apiUrl}/annotation-queues/${xe(e,"queueId")}/runs/${xe(t,"queueRunId")}`,{method:"DELETE",headers:{...this.headers,Accept:"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Fe(r,"delete run from annotation queue")}async getSizeFromAnnotationQueue(e){const t=await this.caller.call(je(),`${this.apiUrl}/annotation-queues/${xe(e,"queueId")}/size`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Fe(t,"get size from annotation queue"),await t.json()}async _currentTenantIsOwner(e){const t=await this._getSettings();return e=="-"||t.tenant_handle===e}async _ownerConflictError(e,t){const r=await this._getSettings();return new Error(`Cannot ${e} for another tenant.

      Current tenant: ${r.tenant_handle}

      Requested tenant: ${t}`)}async _getLatestCommitHash(e){const t=await this.caller.call(je(),`${this.apiUrl}/commits/${e}/?limit=1&offset=0`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions}),r=await t.json();if(!t.ok){const n=typeof r.detail=="string"?r.detail:JSON.stringify(r.detail),i=new Error(`Error ${t.status}: ${t.statusText}
${n}`);throw i.statusCode=t.status,i}if(r.commits.length!==0)return r.commits[0].commit_hash}async _likeOrUnlikePrompt(e,t){const[r,n,i]=Mu(e),o=await this.caller.call(je(),`${this.apiUrl}/likes/${r}/${n}`,{method:"POST",body:JSON.stringify({like:t}),headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Fe(o,`${t?"like":"unlike"} prompt`),await o.json()}async _getPromptUrl(e){const[t,r,n]=Mu(e);if(await this._currentTenantIsOwner(t)){const i=await this._getSettings();return n!=="latest"?`${this.getHostUrl()}/prompts/${r}/${n.substring(0,8)}?organizationId=${i.id}`:`${this.getHostUrl()}/prompts/${r}?organizationId=${i.id}`}else return n!=="latest"?`${this.getHostUrl()}/hub/${t}/${r}/${n.substring(0,8)}`:`${this.getHostUrl()}/hub/${t}/${r}`}async promptExists(e){return!!await this.getPrompt(e)}async likePrompt(e){return this._likeOrUnlikePrompt(e,!0)}async unlikePrompt(e){return this._likeOrUnlikePrompt(e,!1)}async*listCommits(e){for await(const t of this._getPaginated(`/commits/${e}/`,new URLSearchParams,r=>r.commits))yield*t}async*listPrompts(e){const t=new URLSearchParams;t.append("sort_field",(e==null?void 0:e.sortField)??"updated_at"),t.append("sort_direction","desc"),t.append("is_archived",(!!(e!=null&&e.isArchived)).toString()),(e==null?void 0:e.isPublic)!==void 0&&t.append("is_public",e.isPublic.toString()),e!=null&&e.query&&t.append("query",e.query);for await(const r of this._getPaginated("/repos",t,n=>n.repos))yield*r}async getPrompt(e){const[t,r,n]=Mu(e),i=await this.caller.call(je(),`${this.apiUrl}/repos/${t}/${r}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});if(i.status===404)return null;await Fe(i,"get prompt");const o=await i.json();return o.repo?o.repo:null}async createPrompt(e,t){const r=await this._getSettings();if(t!=null&&t.isPublic&&!r.tenant_handle)throw new Error(`Cannot create a public prompt without first

        creating a LangChain Hub handle. 
        You can add a handle by creating a public prompt at:

        https://smith.langchain.com/prompts`);const[n,i,o]=Mu(e);if(!await this._currentTenantIsOwner(n))throw await this._ownerConflictError("create a prompt",n);const s={repo_handle:i,...(t==null?void 0:t.description)&&{description:t.description},...(t==null?void 0:t.readme)&&{readme:t.readme},...(t==null?void 0:t.tags)&&{tags:t.tags},is_public:!!(t!=null&&t.isPublic)},u=await this.caller.call(je(),`${this.apiUrl}/repos/`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(s),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Fe(u,"create prompt");const{repo:l}=await u.json();return l}async createCommit(e,t,r){if(!await this.promptExists(e))throw new Error("Prompt does not exist, you must create it first.");const[n,i,o]=Mu(e),s=(r==null?void 0:r.parentCommitHash)==="latest"||!(r!=null&&r.parentCommitHash)?await this._getLatestCommitHash(`${n}/${i}`):r==null?void 0:r.parentCommitHash,u={manifest:JSON.parse(JSON.stringify(t)),parent_commit:s},l=await this.caller.call(je(),`${this.apiUrl}/commits/${n}/${i}`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(u),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Fe(l,"create commit");const c=await l.json();return this._getPromptUrl(`${n}/${i}${c.commit_hash?`:${c.commit_hash}`:""}`)}async updateExamplesMultipart(e,t=[]){return this._updateExamplesMultipart(e,t)}async _updateExamplesMultipart(e,t=[]){var s;if(!await this._getMultiPartSupport())throw new Error("Your LangSmith version does not allow using the multipart examples endpoint, please update to the latest version.");const r=new FormData;for(const u of t){const l=u.id,c={...u.metadata&&{metadata:u.metadata},...u.split&&{split:u.split}},f=hr(c),p=new Blob([f],{type:"application/json"});if(r.append(l,p),u.inputs){const h=hr(u.inputs),y=new Blob([h],{type:"application/json"});r.append(`${l}.inputs`,y)}if(u.outputs){const h=hr(u.outputs),y=new Blob([h],{type:"application/json"});r.append(`${l}.outputs`,y)}if(u.attachments)for(const[h,y]of Object.entries(u.attachments)){let d,_;Array.isArray(y)?[d,_]=y:(d=y.mimeType,_=y.data);const m=new Blob([_],{type:`${d}; length=${_.byteLength}`});r.append(`${l}.attachment.${h}`,m)}if(u.attachments_operations){const h=hr(u.attachments_operations),y=new Blob([h],{type:"application/json"});r.append(`${l}.attachments_operations`,y)}}const n=e??((s=t[0])==null?void 0:s.dataset_id);return await(await this.caller.call(je(),`${this.apiUrl}/v1/platform/datasets/${n}/examples`,{method:"PATCH",headers:this.headers,body:r})).json()}async uploadExamplesMultipart(e,t=[]){return this._uploadExamplesMultipart(e,t)}async _uploadExamplesMultipart(e,t=[]){if(!await this._getMultiPartSupport())throw new Error("Your LangSmith version does not allow using the multipart examples endpoint, please update to the latest version.");const r=new FormData;for(const o of t){const s=(o.id??xt()).toString(),u={created_at:o.created_at,...o.metadata&&{metadata:o.metadata},...o.split&&{split:o.split},...o.source_run_id&&{source_run_id:o.source_run_id},...o.use_source_run_io&&{use_source_run_io:o.use_source_run_io},...o.use_source_run_attachments&&{use_source_run_attachments:o.use_source_run_attachments}},l=hr(u),c=new Blob([l],{type:"application/json"});if(r.append(s,c),o.inputs){const f=hr(o.inputs),p=new Blob([f],{type:"application/json"});r.append(`${s}.inputs`,p)}if(o.outputs){const f=hr(o.outputs),p=new Blob([f],{type:"application/json"});r.append(`${s}.outputs`,p)}if(o.attachments)for(const[f,p]of Object.entries(o.attachments)){let h,y;Array.isArray(p)?[h,y]=p:(h=p.mimeType,y=p.data);const d=new Blob([y],{type:`${h}; length=${y.byteLength}`});r.append(`${s}.attachment.${f}`,d)}}return await(await this.caller.call(je(),`${this.apiUrl}/v1/platform/datasets/${e}/examples`,{method:"POST",headers:this.headers,body:r})).json()}async updatePrompt(e,t){if(!await this.promptExists(e))throw new Error("Prompt does not exist, you must create it first.");const[r,n]=Mu(e);if(!await this._currentTenantIsOwner(r))throw await this._ownerConflictError("update a prompt",r);const i={};if((t==null?void 0:t.description)!==void 0&&(i.description=t.description),(t==null?void 0:t.readme)!==void 0&&(i.readme=t.readme),(t==null?void 0:t.tags)!==void 0&&(i.tags=t.tags),(t==null?void 0:t.isPublic)!==void 0&&(i.is_public=t.isPublic),(t==null?void 0:t.isArchived)!==void 0&&(i.is_archived=t.isArchived),Object.keys(i).length===0)throw new Error("No valid update options provided");const o=await this.caller.call(je(),`${this.apiUrl}/repos/${r}/${n}`,{method:"PATCH",body:JSON.stringify(i),headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Fe(o,"update prompt"),o.json()}async deletePrompt(e){if(!await this.promptExists(e))throw new Error("Prompt does not exist, you must create it first.");const[t,r,n]=Mu(e);if(!await this._currentTenantIsOwner(t))throw await this._ownerConflictError("delete a prompt",t);return await(await this.caller.call(je(),`${this.apiUrl}/repos/${t}/${r}`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json()}async pullPromptCommit(e,t){const[r,n,i]=Mu(e),o=await this.caller.call(je(),`${this.apiUrl}/commits/${r}/${n}/${i}${t!=null&&t.includeModel?"?include_model=true":""}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Fe(o,"pull prompt commit");const s=await o.json();return{owner:r,repo:n,commit_hash:s.commit_hash,manifest:s.manifest,examples:s.examples}}async _pullPrompt(e,t){const r=await this.pullPromptCommit(e,{includeModel:t==null?void 0:t.includeModel});return JSON.stringify(r.manifest)}async pushPrompt(e,t){return await this.promptExists(e)?t&&Object.keys(t).some(n=>n!=="object")&&await this.updatePrompt(e,{description:t==null?void 0:t.description,readme:t==null?void 0:t.readme,tags:t==null?void 0:t.tags,isPublic:t==null?void 0:t.isPublic}):await this.createPrompt(e,{description:t==null?void 0:t.description,readme:t==null?void 0:t.readme,tags:t==null?void 0:t.tags,isPublic:t==null?void 0:t.isPublic}),t!=null&&t.object?await this.createCommit(e,t==null?void 0:t.object,{parentCommitHash:t==null?void 0:t.parentCommitHash}):await this._getPromptUrl(e)}async clonePublicDataset(e,t={}){const{sourceApiUrl:r=this.apiUrl,datasetName:n}=t,[i,o]=this.parseTokenOrUrl(e,r),s=new pE({apiUrl:i,apiKey:"placeholder"}),u=await s.readSharedDataset(o),l=n||u.name;try{if(await this.hasDataset({datasetId:l})){console.log(`Dataset ${l} already exists in your tenant. Skipping.`);return}}catch{}const c=await s.listSharedExamples(o),f=await this.createDataset(l,{description:u.description,dataType:u.data_type||"kv",inputsSchema:u.inputs_schema_definition??void 0,outputsSchema:u.outputs_schema_definition??void 0});try{await this.createExamples({inputs:c.map(p=>p.inputs),outputs:c.flatMap(p=>p.outputs?[p.outputs]:[]),datasetId:f.id})}catch(p){throw console.error(`An error occurred while creating dataset ${l}. You should delete it manually.`),p}}parseTokenOrUrl(e,t,r=2,n="dataset"){try{return xe(e),[t,e]}catch{}try{const o=new URL(e).pathname.split("/").filter(s=>s!=="");if(o.length>=r){const s=o[o.length-r];return[t,s]}else throw new Error(`Invalid public ${n} URL: ${e}`)}catch{throw new Error(`Invalid public ${n} URL or token: ${e}`)}}awaitPendingTraceBatches(){return this.manualFlushMode?(console.warn("[WARNING]: When tracing in manual flush mode, you must call `await client.flush()` manually to submit trace batches."),Promise.resolve()):Promise.all([...this.autoBatchQueue.items.map(({itemPromise:e})=>e),this.batchIngestCaller.queue.onIdle()])}};function Cj(a){return"dataset_id"in a||"dataset_name"in a}const D4="0.3.14";var Zh={};let lu;const L5=()=>typeof window<"u"&&typeof window.document<"u",V5=()=>typeof globalThis=="object"&&globalThis.constructor&&globalThis.constructor.name==="DedicatedWorkerGlobalScope",G5=()=>typeof window<"u"&&window.name==="nodejs"||typeof navigator<"u"&&(navigator.userAgent.includes("Node.js")||navigator.userAgent.includes("jsdom")),x4=()=>typeof Deno<"u",k5=()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"&&!x4(),H5=()=>lu||(L5()?lu="browser":k5()?lu="node":V5()?lu="webworker":G5()?lu="jsdom":x4()?lu="deno":lu="other",lu);let ig;function $4(){if(ig===void 0){const a=H5(),e=J5();ig={library:"langsmith",runtime:a,sdk:"langsmith-js",sdk_version:D4,...e}}return ig}function W5(){const a=K5()||{},e={},t=["LANGCHAIN_API_KEY","LANGCHAIN_ENDPOINT","LANGCHAIN_TRACING_V2","LANGCHAIN_PROJECT","LANGCHAIN_SESSION","LANGSMITH_API_KEY","LANGSMITH_ENDPOINT","LANGSMITH_TRACING_V2","LANGSMITH_PROJECT","LANGSMITH_SESSION"];for(const[r,n]of Object.entries(a))(r.startsWith("LANGCHAIN_")||r.startsWith("LANGSMITH_"))&&typeof n=="string"&&!t.includes(r)&&!r.toLowerCase().includes("key")&&!r.toLowerCase().includes("secret")&&!r.toLowerCase().includes("token")&&(r==="LANGCHAIN_REVISION_ID"?e.revision_id=n:e[r]=n);return e}function K5(){try{return typeof process<"u"&&Zh?Object.entries(Zh).reduce((a,[e,t])=>(a[e]=String(t),a),{}):void 0}catch{return}}function vc(a){try{return typeof process<"u"?Zh==null?void 0:Zh[a]:void 0}catch{return}}function zu(a){return vc(`LANGSMITH_${a}`)||vc(`LANGCHAIN_${a}`)}let ag;function J5(){if(ag!==void 0)return ag;const a=["VERCEL_GIT_COMMIT_SHA","NEXT_PUBLIC_VERCEL_GIT_COMMIT_SHA","COMMIT_REF","RENDER_GIT_COMMIT","CI_COMMIT_SHA","CIRCLE_SHA1","CF_PAGES_COMMIT_SHA","REACT_APP_GIT_SHA","SOURCE_VERSION","GITHUB_SHA","TRAVIS_COMMIT","GIT_COMMIT","BUILD_VCS_NUMBER","bamboo_planRepository_revision","Build.SourceVersion","BITBUCKET_COMMIT","DRONE_COMMIT_SHA","SEMAPHORE_GIT_SHA","BUILDKITE_COMMIT"],e={};for(const t of a){const r=vc(t);r!==void 0&&(e[t]=r)}return ag=e,e}const X5=a=>!!["TRACING_V2","TRACING"].find(t=>zu(t)==="true"),og=Symbol.for("lc:context_variables");function Z5(a){return a.replace(/[-:.]/g,"")}function Q5(a,e,t=1){const r=t.toFixed(0).slice(0,3).padStart(3,"0");return Z5(`${new Date(a).toISOString().slice(0,-1)}${r}Z`)+e}class Sy{constructor(e,t){Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.metadata=e,this.tags=t}static fromHeader(e){const t=e.split(",");let r={},n=[];for(const i of t){const[o,s]=i.split("="),u=decodeURIComponent(s);o==="langsmith-metadata"?r=JSON.parse(u):o==="langsmith-tags"&&(n=u.split(","))}return new Sy(r,n)}toHeader(){const e=[];return this.metadata&&Object.keys(this.metadata).length>0&&e.push(`langsmith-metadata=${encodeURIComponent(JSON.stringify(this.metadata))}`),this.tags&&this.tags.length>0&&e.push(`langsmith-tags=${encodeURIComponent(this.tags.join(","))}`),e.join(",")}}class br{constructor(e){var s;if(Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"run_type",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"project_name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"parent_run",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"child_runs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"start_time",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"end_time",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"extra",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"error",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"serialized",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"inputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"outputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"reference_example_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"events",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"trace_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"dotted_order",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tracingEnabled",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"execution_order",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"child_execution_order",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"attachments",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),N4(e)){Object.assign(this,{...e});return}const t=br.getDefaultConfig(),{metadata:r,...n}=e,i=n.client??br.getSharedClient(),o={...r,...(s=n==null?void 0:n.extra)==null?void 0:s.metadata};if(n.extra={...n.extra,metadata:o},Object.assign(this,{...t,...n,client:i}),this.trace_id||(this.parent_run?this.trace_id=this.parent_run.trace_id??this.id:this.trace_id=this.id),this.execution_order??(this.execution_order=1),this.child_execution_order??(this.child_execution_order=1),!this.dotted_order){const u=Q5(this.start_time,this.id,this.execution_order);this.parent_run?this.dotted_order=this.parent_run.dotted_order+"."+u:this.dotted_order=u}}static getDefaultConfig(){return{id:xt(),run_type:"chain",project_name:zu("PROJECT")??vc("LANGCHAIN_SESSION")??"default",child_runs:[],api_url:vc("LANGCHAIN_ENDPOINT")??"http://localhost:1984",api_key:vc("LANGCHAIN_API_KEY"),caller_options:{},start_time:Date.now(),serialized:{},inputs:{},extra:{}}}static getSharedClient(){return br.sharedClient||(br.sharedClient=new I4),br.sharedClient}createChild(e){var u,l,c,f,p,h;const t=this.child_execution_order+1,r=new br({...e,parent_run:this,project_name:this.project_name,client:this.client,tracingEnabled:this.tracingEnabled,execution_order:t,child_execution_order:t});og in this&&(r[og]=this[og]);const n=Symbol.for("lc:child_config"),i=((u=e.extra)==null?void 0:u[n])??this.extra[n];if(eW(i)){const y={...i},d=Y5(y.callbacks)?(c=(l=y.callbacks).copy)==null?void 0:c.call(l):void 0;d&&(Object.assign(d,{_parentRunId:r.id}),(h=(p=(f=d.handlers)==null?void 0:f.find(q4))==null?void 0:p.updateFromRunTree)==null||h.call(p,r),y.callbacks=d),r.extra[n]=y}const o=new Set;let s=this;for(;s!=null&&!o.has(s.id);)o.add(s.id),s.child_execution_order=Math.max(s.child_execution_order,t),s=s.parent_run;return this.child_runs.push(r),r}async end(e,t,r=Date.now(),n){this.outputs=this.outputs??e,this.error=this.error??t,this.end_time=this.end_time??r,n&&Object.keys(n).length>0&&(this.extra=this.extra?{...this.extra,metadata:{...this.extra.metadata,...n}}:{metadata:n})}_convertToCreate(e,t,r=!0){var u;const n=e.extra??{};if(n.runtime||(n.runtime={}),t)for(const[l,c]of Object.entries(t))n.runtime[l]||(n.runtime[l]=c);let i,o;return r?(o=(u=e.parent_run)==null?void 0:u.id,i=[]):(i=e.child_runs.map(l=>this._convertToCreate(l,t,r)),o=void 0),{id:e.id,name:e.name,start_time:e.start_time,end_time:e.end_time,run_type:e.run_type,reference_example_id:e.reference_example_id,extra:n,serialized:e.serialized,error:e.error,inputs:e.inputs,outputs:e.outputs,session_name:e.project_name,child_runs:i,parent_run_id:o,trace_id:e.trace_id,dotted_order:e.dotted_order,tags:e.tags,attachments:e.attachments}}async postRun(e=!0){try{const t=$4(),r=await this._convertToCreate(this,t,!0);if(await this.client.createRun(r),!e){P4("Posting with excludeChildRuns=false is deprecated and will be removed in a future version.");for(const n of this.child_runs)await n.postRun(!1)}}catch(t){console.error(`Error in postRun for run ${this.id}:`,t)}}async patchRun(){var e;try{const t={end_time:this.end_time,error:this.error,inputs:this.inputs,outputs:this.outputs,parent_run_id:(e=this.parent_run)==null?void 0:e.id,reference_example_id:this.reference_example_id,extra:this.extra,events:this.events,dotted_order:this.dotted_order,trace_id:this.trace_id,tags:this.tags,attachments:this.attachments};await this.client.updateRun(this.id,t)}catch(t){console.error(`Error in patchRun for run ${this.id}`,t)}}toJSON(){return this._convertToCreate(this,void 0,!1)}addEvent(e){this.events||(this.events=[]),typeof e=="string"?this.events.push({name:"event",time:new Date().toISOString(),message:e}):this.events.push({...e,time:e.time??new Date().toISOString()})}static fromRunnableConfig(e,t){var l,c,f,p;const r=e==null?void 0:e.callbacks;let n,i,o,s=X5();if(r){const h=((l=r==null?void 0:r.getParentRunId)==null?void 0:l.call(r))??"",y=(c=r==null?void 0:r.handlers)==null?void 0:c.find(d=>(d==null?void 0:d.name)=="langchain_tracer");n=(f=y==null?void 0:y.getRun)==null?void 0:f.call(y,h),i=y==null?void 0:y.projectName,o=y==null?void 0:y.client,s=s||!!y}return n?new br({name:n.name,id:n.id,trace_id:n.trace_id,dotted_order:n.dotted_order,client:o,tracingEnabled:s,project_name:i,tags:[...new Set(((n==null?void 0:n.tags)??[]).concat((e==null?void 0:e.tags)??[]))],extra:{metadata:{...(p=n==null?void 0:n.extra)==null?void 0:p.metadata,...e==null?void 0:e.metadata}}}).createChild(t):new br({...t,client:o,tracingEnabled:s,project_name:i})}static fromDottedOrder(e){return this.fromHeaders({"langsmith-trace":e})}static fromHeaders(e,t){var l;const r="get"in e&&typeof e.get=="function"?{"langsmith-trace":e.get("langsmith-trace"),baggage:e.get("baggage")}:e,n=r["langsmith-trace"];if(!n||typeof n!="string")return;const i=n.trim(),o=i.split(".").map(c=>{const[f,p]=c.split("Z");return{strTime:f,time:Date.parse(f+"Z"),uuid:p}}),s=o[0].uuid,u={...t,name:(t==null?void 0:t.name)??"parent",run_type:(t==null?void 0:t.run_type)??"chain",start_time:(t==null?void 0:t.start_time)??Date.now(),id:(l=o.at(-1))==null?void 0:l.uuid,trace_id:s,dotted_order:i};if(r.baggage&&typeof r.baggage=="string"){const c=Sy.fromHeader(r.baggage);u.metadata=c.metadata,u.tags=c.tags}return new br(u)}toHeaders(e){var r;const t={"langsmith-trace":this.dotted_order,baggage:new Sy((r=this.extra)==null?void 0:r.metadata,this.tags).toHeader()};if(e)for(const[n,i]of Object.entries(t))e.set(n,i);return t}}Object.defineProperty(br,"sharedClient",{enumerable:!0,configurable:!0,writable:!0,value:null});function N4(a){return a!==void 0&&typeof a.createChild=="function"&&typeof a.postRun=="function"}function q4(a){return typeof a=="object"&&a!=null&&typeof a.name=="string"&&a.name==="langchain_tracer"}function Pj(a){return Array.isArray(a)&&a.some(e=>q4(e))}function Y5(a){return typeof a=="object"&&a!=null&&Array.isArray(a.handlers)}function eW(a){var e;return a!==void 0&&typeof a.callbacks=="object"&&(Pj((e=a.callbacks)==null?void 0:e.handlers)||Pj(a.callbacks))}let tW=class{getStore(){}run(e,t){return t()}};const sg=Symbol.for("ls:tracing_async_local_storage"),rW=new tW;let nW=class{getInstance(){return globalThis[sg]??rW}initializeGlobalInstance(e){globalThis[sg]===void 0&&(globalThis[sg]=e)}};const iW=new nW,aW=()=>{const a=iW.getInstance().getStore();if(!N4(a))throw new Error(["Could not get the current run tree.","","Please make sure you are calling this method within a traceable function and that tracing is enabled."].join(`
`));return a};function RR(a){return typeof a=="function"&&"langsmith:traceable"in a}let ug;const oW=()=>{if(ug===void 0){const a=We("LANGCHAIN_CALLBACKS_BACKGROUND")==="false"?{blockOnRootRunFinalization:!0}:{};ug=new I4(a)}return ug};class Qh extends zp{constructor(e={}){super(e),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"langchain_tracer"}),Object.defineProperty(this,"projectName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"exampleId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0});const{exampleId:t,projectName:r,client:n}=e;this.projectName=r??We("LANGCHAIN_PROJECT")??We("LANGCHAIN_SESSION"),this.exampleId=t,this.client=n??oW();const i=Qh.getTraceableRunTree();i&&this.updateFromRunTree(i)}async _convertToCreate(e,t=void 0){return{...e,extra:{...e.extra,runtime:await R9()},child_runs:void 0,session_name:this.projectName,reference_example_id:e.parent_run_id?void 0:t}}async persistRun(e){}async onRunCreate(e){const t=await this._convertToCreate(e,this.exampleId);await this.client.createRun(t)}async onRunUpdate(e){const t={end_time:e.end_time,error:e.error,outputs:e.outputs,events:e.events,inputs:e.inputs,trace_id:e.trace_id,dotted_order:e.dotted_order,parent_run_id:e.parent_run_id,extra:e.extra};await this.client.updateRun(e.id,t)}getRun(e){return this.runMap.get(e)}updateFromRunTree(e){let t=e;const r=new Set;for(;t.parent_run&&!(r.has(t.id)||(r.add(t.id),!t.parent_run));)t=t.parent_run;r.clear();const n=[t];for(;n.length>0;){const i=n.shift();!i||r.has(i.id)||(r.add(i.id),this.runMap.set(i.id,i),i.child_runs&&n.push(...i.child_runs))}this.client=e.client??this.client,this.projectName=e.project_name??this.projectName,this.exampleId=e.reference_example_id??this.exampleId}convertToRunTree(e){const t={},r=[];for(const[n,i]of this.runMap){const o=new br({...i,child_runs:[],parent_run:void 0,client:this.client,project_name:this.projectName,reference_example_id:this.exampleId,tracingEnabled:!0});t[n]=o,r.push([n,i.dotted_order])}r.sort((n,i)=>!n[1]||!i[1]?0:n[1].localeCompare(i[1]));for(const[n]of r){const i=this.runMap.get(n),o=t[n];if(!(!i||!o)&&i.parent_run_id){const s=t[i.parent_run_id];s&&(s.child_runs.push(o),o.parent_run=s)}}return t[e]}static getTraceableRunTree(){try{return aW()}catch{return}}}const z4=Symbol.for("ls:tracing_async_local_storage"),iy=Symbol.for("lc:context_variables"),sW=a=>{globalThis[z4]=a},fp=()=>globalThis[z4];let Yh;function uW(){const a="default"in Su?Su.default:Su;return new a({autoStart:!0,concurrency:1})}function lW(){return typeof Yh>"u"&&(Yh=uW()),Yh}async function mt(a,e){if(e===!0){const t=fp();t!==void 0?await t.run(void 0,async()=>a()):await a()}else Yh=lW(),Yh.add(async()=>{const t=fp();t!==void 0?await t.run(void 0,async()=>a()):await a()})}const cW=a=>!!["LANGSMITH_TRACING_V2","LANGCHAIN_TRACING_V2","LANGSMITH_TRACING","LANGCHAIN_TRACING"].find(t=>We(t)==="true");function B4(a){var r;const e=fp();if(e===void 0)return;const t=e.getStore();return(r=t==null?void 0:t[iy])==null?void 0:r[a]}const fW=Symbol("lc:configure_hooks"),dW=()=>B4(fW)||[];function hW(a){return a?Array.isArray(a)||"name"in a?{callbacks:a}:a:{}}class pW{setHandler(e){return this.setHandlers([e])}}class db{constructor(e,t,r,n,i,o,s,u){Object.defineProperty(this,"runId",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"handlers",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"inheritableHandlers",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"inheritableTags",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:o}),Object.defineProperty(this,"inheritableMetadata",{enumerable:!0,configurable:!0,writable:!0,value:s}),Object.defineProperty(this,"_parentRunId",{enumerable:!0,configurable:!0,writable:!0,value:u})}get parentRunId(){return this._parentRunId}async handleText(e){await Promise.all(this.handlers.map(t=>mt(async()=>{var r;try{await((r=t.handleText)==null?void 0:r.call(t,e,this.runId,this._parentRunId,this.tags))}catch(n){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleText: ${n}`),t.raiseError)throw n}},t.awaitHandlers)))}async handleCustomEvent(e,t,r,n,i){await Promise.all(this.handlers.map(o=>mt(async()=>{var s;try{await((s=o.handleCustomEvent)==null?void 0:s.call(o,e,t,this.runId,this.tags,this.metadata))}catch(u){if((o.raiseError?console.error:console.warn)(`Error in handler ${o.constructor.name}, handleCustomEvent: ${u}`),o.raiseError)throw u}},o.awaitHandlers)))}}class _W extends db{getChild(e){const t=new Ot(this.runId);return t.setHandlers(this.inheritableHandlers),t.addTags(this.inheritableTags),t.addMetadata(this.inheritableMetadata),e&&t.addTags([e],!1),t}async handleRetrieverEnd(e){await Promise.all(this.handlers.map(t=>mt(async()=>{var r;if(!t.ignoreRetriever)try{await((r=t.handleRetrieverEnd)==null?void 0:r.call(t,e,this.runId,this._parentRunId,this.tags))}catch(n){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleRetriever`),t.raiseError)throw n}},t.awaitHandlers)))}async handleRetrieverError(e){await Promise.all(this.handlers.map(t=>mt(async()=>{var r;if(!t.ignoreRetriever)try{await((r=t.handleRetrieverError)==null?void 0:r.call(t,e,this.runId,this._parentRunId,this.tags))}catch(n){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleRetrieverError: ${n}`),t.raiseError)throw e}},t.awaitHandlers)))}}class jj extends db{async handleLLMNewToken(e,t,r,n,i,o){await Promise.all(this.handlers.map(s=>mt(async()=>{var u;if(!s.ignoreLLM)try{await((u=s.handleLLMNewToken)==null?void 0:u.call(s,e,t??{prompt:0,completion:0},this.runId,this._parentRunId,this.tags,o))}catch(l){if((s.raiseError?console.error:console.warn)(`Error in handler ${s.constructor.name}, handleLLMNewToken: ${l}`),s.raiseError)throw l}},s.awaitHandlers)))}async handleLLMError(e,t,r,n,i){await Promise.all(this.handlers.map(o=>mt(async()=>{var s;if(!o.ignoreLLM)try{await((s=o.handleLLMError)==null?void 0:s.call(o,e,this.runId,this._parentRunId,this.tags,i))}catch(u){if((o.raiseError?console.error:console.warn)(`Error in handler ${o.constructor.name}, handleLLMError: ${u}`),o.raiseError)throw u}},o.awaitHandlers)))}async handleLLMEnd(e,t,r,n,i){await Promise.all(this.handlers.map(o=>mt(async()=>{var s;if(!o.ignoreLLM)try{await((s=o.handleLLMEnd)==null?void 0:s.call(o,e,this.runId,this._parentRunId,this.tags,i))}catch(u){if((o.raiseError?console.error:console.warn)(`Error in handler ${o.constructor.name}, handleLLMEnd: ${u}`),o.raiseError)throw u}},o.awaitHandlers)))}}class yW extends db{getChild(e){const t=new Ot(this.runId);return t.setHandlers(this.inheritableHandlers),t.addTags(this.inheritableTags),t.addMetadata(this.inheritableMetadata),e&&t.addTags([e],!1),t}async handleChainError(e,t,r,n,i){await Promise.all(this.handlers.map(o=>mt(async()=>{var s;if(!o.ignoreChain)try{await((s=o.handleChainError)==null?void 0:s.call(o,e,this.runId,this._parentRunId,this.tags,i))}catch(u){if((o.raiseError?console.error:console.warn)(`Error in handler ${o.constructor.name}, handleChainError: ${u}`),o.raiseError)throw u}},o.awaitHandlers)))}async handleChainEnd(e,t,r,n,i){await Promise.all(this.handlers.map(o=>mt(async()=>{var s;if(!o.ignoreChain)try{await((s=o.handleChainEnd)==null?void 0:s.call(o,e,this.runId,this._parentRunId,this.tags,i))}catch(u){if((o.raiseError?console.error:console.warn)(`Error in handler ${o.constructor.name}, handleChainEnd: ${u}`),o.raiseError)throw u}},o.awaitHandlers)))}async handleAgentAction(e){await Promise.all(this.handlers.map(t=>mt(async()=>{var r;if(!t.ignoreAgent)try{await((r=t.handleAgentAction)==null?void 0:r.call(t,e,this.runId,this._parentRunId,this.tags))}catch(n){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleAgentAction: ${n}`),t.raiseError)throw n}},t.awaitHandlers)))}async handleAgentEnd(e){await Promise.all(this.handlers.map(t=>mt(async()=>{var r;if(!t.ignoreAgent)try{await((r=t.handleAgentEnd)==null?void 0:r.call(t,e,this.runId,this._parentRunId,this.tags))}catch(n){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleAgentEnd: ${n}`),t.raiseError)throw n}},t.awaitHandlers)))}}class bW extends db{getChild(e){const t=new Ot(this.runId);return t.setHandlers(this.inheritableHandlers),t.addTags(this.inheritableTags),t.addMetadata(this.inheritableMetadata),e&&t.addTags([e],!1),t}async handleToolError(e){await Promise.all(this.handlers.map(t=>mt(async()=>{var r;if(!t.ignoreAgent)try{await((r=t.handleToolError)==null?void 0:r.call(t,e,this.runId,this._parentRunId,this.tags))}catch(n){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleToolError: ${n}`),t.raiseError)throw n}},t.awaitHandlers)))}async handleToolEnd(e){await Promise.all(this.handlers.map(t=>mt(async()=>{var r;if(!t.ignoreAgent)try{await((r=t.handleToolEnd)==null?void 0:r.call(t,e,this.runId,this._parentRunId,this.tags))}catch(n){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleToolEnd: ${n}`),t.raiseError)throw n}},t.awaitHandlers)))}}class Ot extends pW{constructor(e,t){super(),Object.defineProperty(this,"handlers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"inheritableHandlers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"inheritableTags",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"inheritableMetadata",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"callback_manager"}),Object.defineProperty(this,"_parentRunId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.handlers=(t==null?void 0:t.handlers)??this.handlers,this.inheritableHandlers=(t==null?void 0:t.inheritableHandlers)??this.inheritableHandlers,this.tags=(t==null?void 0:t.tags)??this.tags,this.inheritableTags=(t==null?void 0:t.inheritableTags)??this.inheritableTags,this.metadata=(t==null?void 0:t.metadata)??this.metadata,this.inheritableMetadata=(t==null?void 0:t.inheritableMetadata)??this.inheritableMetadata,this._parentRunId=e}getParentRunId(){return this._parentRunId}async handleLLMStart(e,t,r=void 0,n=void 0,i=void 0,o=void 0,s=void 0,u=void 0){return Promise.all(t.map(async(l,c)=>{const f=c===0&&r?r:xt();return await Promise.all(this.handlers.map(p=>{if(!p.ignoreLLM)return Hf(p)&&p._createRunForLLMStart(e,[l],f,this._parentRunId,i,this.tags,this.metadata,u),mt(async()=>{var h;try{await((h=p.handleLLMStart)==null?void 0:h.call(p,e,[l],f,this._parentRunId,i,this.tags,this.metadata,u))}catch(y){if((p.raiseError?console.error:console.warn)(`Error in handler ${p.constructor.name}, handleLLMStart: ${y}`),p.raiseError)throw y}},p.awaitHandlers)})),new jj(f,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}))}async handleChatModelStart(e,t,r=void 0,n=void 0,i=void 0,o=void 0,s=void 0,u=void 0){return Promise.all(t.map(async(l,c)=>{const f=c===0&&r?r:xt();return await Promise.all(this.handlers.map(p=>{if(!p.ignoreLLM)return Hf(p)&&p._createRunForChatModelStart(e,[l],f,this._parentRunId,i,this.tags,this.metadata,u),mt(async()=>{var h,y;try{if(p.handleChatModelStart)await((h=p.handleChatModelStart)==null?void 0:h.call(p,e,[l],f,this._parentRunId,i,this.tags,this.metadata,u));else if(p.handleLLMStart){const d=mR(l);await((y=p.handleLLMStart)==null?void 0:y.call(p,e,[d],f,this._parentRunId,i,this.tags,this.metadata,u))}}catch(d){if((p.raiseError?console.error:console.warn)(`Error in handler ${p.constructor.name}, handleLLMStart: ${d}`),p.raiseError)throw d}},p.awaitHandlers)})),new jj(f,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}))}async handleChainStart(e,t,r=xt(),n=void 0,i=void 0,o=void 0,s=void 0){return await Promise.all(this.handlers.map(u=>{if(!u.ignoreChain)return Hf(u)&&u._createRunForChainStart(e,t,r,this._parentRunId,this.tags,this.metadata,n,s),mt(async()=>{var l;try{await((l=u.handleChainStart)==null?void 0:l.call(u,e,t,r,this._parentRunId,this.tags,this.metadata,n,s))}catch(c){if((u.raiseError?console.error:console.warn)(`Error in handler ${u.constructor.name}, handleChainStart: ${c}`),u.raiseError)throw c}},u.awaitHandlers)})),new yW(r,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}async handleToolStart(e,t,r=xt(),n=void 0,i=void 0,o=void 0,s=void 0){return await Promise.all(this.handlers.map(u=>{if(!u.ignoreAgent)return Hf(u)&&u._createRunForToolStart(e,t,r,this._parentRunId,this.tags,this.metadata,s),mt(async()=>{var l;try{await((l=u.handleToolStart)==null?void 0:l.call(u,e,t,r,this._parentRunId,this.tags,this.metadata,s))}catch(c){if((u.raiseError?console.error:console.warn)(`Error in handler ${u.constructor.name}, handleToolStart: ${c}`),u.raiseError)throw c}},u.awaitHandlers)})),new bW(r,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}async handleRetrieverStart(e,t,r=xt(),n=void 0,i=void 0,o=void 0,s=void 0){return await Promise.all(this.handlers.map(u=>{if(!u.ignoreRetriever)return Hf(u)&&u._createRunForRetrieverStart(e,t,r,this._parentRunId,this.tags,this.metadata,s),mt(async()=>{var l;try{await((l=u.handleRetrieverStart)==null?void 0:l.call(u,e,t,r,this._parentRunId,this.tags,this.metadata,s))}catch(c){if((u.raiseError?console.error:console.warn)(`Error in handler ${u.constructor.name}, handleRetrieverStart: ${c}`),u.raiseError)throw c}},u.awaitHandlers)})),new _W(r,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}async handleCustomEvent(e,t,r,n,i){await Promise.all(this.handlers.map(o=>mt(async()=>{var s;if(!o.ignoreCustomEvent)try{await((s=o.handleCustomEvent)==null?void 0:s.call(o,e,t,r,this.tags,this.metadata))}catch(u){if((o.raiseError?console.error:console.warn)(`Error in handler ${o.constructor.name}, handleCustomEvent: ${u}`),o.raiseError)throw u}},o.awaitHandlers)))}addHandler(e,t=!0){this.handlers.push(e),t&&this.inheritableHandlers.push(e)}removeHandler(e){this.handlers=this.handlers.filter(t=>t!==e),this.inheritableHandlers=this.inheritableHandlers.filter(t=>t!==e)}setHandlers(e,t=!0){this.handlers=[],this.inheritableHandlers=[];for(const r of e)this.addHandler(r,t)}addTags(e,t=!0){this.removeTags(e),this.tags.push(...e),t&&this.inheritableTags.push(...e)}removeTags(e){this.tags=this.tags.filter(t=>!e.includes(t)),this.inheritableTags=this.inheritableTags.filter(t=>!e.includes(t))}addMetadata(e,t=!0){this.metadata={...this.metadata,...e},t&&(this.inheritableMetadata={...this.inheritableMetadata,...e})}removeMetadata(e){for(const t of Object.keys(e))delete this.metadata[t],delete this.inheritableMetadata[t]}copy(e=[],t=!0){const r=new Ot(this._parentRunId);for(const n of this.handlers){const i=this.inheritableHandlers.includes(n);r.addHandler(n,i)}for(const n of this.tags){const i=this.inheritableTags.includes(n);r.addTags([n],i)}for(const n of Object.keys(this.metadata)){const i=Object.keys(this.inheritableMetadata).includes(n);r.addMetadata({[n]:this.metadata[n]},i)}for(const n of e)r.handlers.filter(i=>i.name==="console_callback_handler").some(i=>i.name===n.name)||r.addHandler(n,t);return r}static fromHandlers(e){class t extends qp{constructor(){super(),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:xt()}),Object.assign(this,e)}}const r=new this;return r.addHandler(new t),r}static configure(e,t,r,n,i,o,s){return this._configureSync(e,t,r,n,i,o,s)}static _configureSync(e,t,r,n,i,o,s){var p,h;let u;(e||t)&&(Array.isArray(e)||!e?(u=new Ot,u.setHandlers((e==null?void 0:e.map(Ey))??[],!0)):u=e,u=u.copy(Array.isArray(t)?t.map(Ey):t==null?void 0:t.handlers,!1));const l=We("LANGCHAIN_VERBOSE")==="true"||(s==null?void 0:s.verbose),c=((p=Qh.getTraceableRunTree())==null?void 0:p.tracingEnabled)||cW(),f=c||(We("LANGCHAIN_TRACING")??!1);if(l||f){if(u||(u=new Ot),l&&!u.handlers.some(y=>y.name===_P.prototype.name)){const y=new _P;u.addHandler(y,!0)}if(f&&!u.handlers.some(y=>y.name==="langchain_tracer")&&c){const y=new Qh;u.addHandler(y,!0),u._parentRunId=((h=Qh.getTraceableRunTree())==null?void 0:h.id)??u._parentRunId}}for(const{contextVar:y,inheritable:d=!0,handlerClass:_,envVar:m}of dW()){const b=m&&We(m)==="true"&&_;let g;const v=y!==void 0?B4(y):void 0;v&&P9(v)?g=v:b&&(g=new _({})),g!==void 0&&(u||(u=new Ot),u.handlers.some(w=>w.name===g.name)||u.addHandler(g,d))}return(r||n)&&u&&(u.addTags(r??[]),u.addTags(n??[],!1)),(i||o)&&u&&(u.addMetadata(i??{}),u.addMetadata(o??{},!1)),u}}function Ey(a){return"name"in a?a:qp.fromMethods(a)}var Ve;(function(a){a.assertEqual=n=>n;function e(n){}a.assertIs=e;function t(n){throw new Error}a.assertNever=t,a.arrayToEnum=n=>{const i={};for(const o of n)i[o]=o;return i},a.getValidEnumValues=n=>{const i=a.objectKeys(n).filter(s=>typeof n[n[s]]!="number"),o={};for(const s of i)o[s]=n[s];return a.objectValues(o)},a.objectValues=n=>a.objectKeys(n).map(function(i){return n[i]}),a.objectKeys=typeof Object.keys=="function"?n=>Object.keys(n):n=>{const i=[];for(const o in n)Object.prototype.hasOwnProperty.call(n,o)&&i.push(o);return i},a.find=(n,i)=>{for(const o of n)if(i(o))return o},a.isInteger=typeof Number.isInteger=="function"?n=>Number.isInteger(n):n=>typeof n=="number"&&isFinite(n)&&Math.floor(n)===n;function r(n,i=" | "){return n.map(o=>typeof o=="string"?`'${o}'`:o).join(i)}a.joinValues=r,a.jsonStringifyReplacer=(n,i)=>typeof i=="bigint"?i.toString():i})(Ve||(Ve={}));var _E;(function(a){a.mergeShapes=(e,t)=>({...e,...t})})(_E||(_E={}));const Oe=Ve.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),vu=a=>{switch(typeof a){case"undefined":return Oe.undefined;case"string":return Oe.string;case"number":return isNaN(a)?Oe.nan:Oe.number;case"boolean":return Oe.boolean;case"function":return Oe.function;case"bigint":return Oe.bigint;case"symbol":return Oe.symbol;case"object":return Array.isArray(a)?Oe.array:a===null?Oe.null:a.then&&typeof a.then=="function"&&a.catch&&typeof a.catch=="function"?Oe.promise:typeof Map<"u"&&a instanceof Map?Oe.map:typeof Set<"u"&&a instanceof Set?Oe.set:typeof Date<"u"&&a instanceof Date?Oe.date:Oe.object;default:return Oe.unknown}},be=Ve.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),mW=a=>JSON.stringify(a,null,2).replace(/"([^"]+)":/g,"$1:");class vr extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}format(e){const t=e||function(i){return i.message},r={_errors:[]},n=i=>{for(const o of i.issues)if(o.code==="invalid_union")o.unionErrors.map(n);else if(o.code==="invalid_return_type")n(o.returnTypeError);else if(o.code==="invalid_arguments")n(o.argumentsError);else if(o.path.length===0)r._errors.push(t(o));else{let s=r,u=0;for(;u<o.path.length;){const l=o.path[u];u===o.path.length-1?(s[l]=s[l]||{_errors:[]},s[l]._errors.push(t(o))):s[l]=s[l]||{_errors:[]},s=s[l],u++}}};return n(this),r}static assert(e){if(!(e instanceof vr))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Ve.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=t=>t.message){const t={},r=[];for(const n of this.issues)n.path.length>0?(t[n.path[0]]=t[n.path[0]]||[],t[n.path[0]].push(e(n))):r.push(e(n));return{formErrors:r,fieldErrors:t}}get formErrors(){return this.flatten()}}vr.create=a=>new vr(a);const Of=(a,e)=>{let t;switch(a.code){case be.invalid_type:a.received===Oe.undefined?t="Required":t=`Expected ${a.expected}, received ${a.received}`;break;case be.invalid_literal:t=`Invalid literal value, expected ${JSON.stringify(a.expected,Ve.jsonStringifyReplacer)}`;break;case be.unrecognized_keys:t=`Unrecognized key(s) in object: ${Ve.joinValues(a.keys,", ")}`;break;case be.invalid_union:t="Invalid input";break;case be.invalid_union_discriminator:t=`Invalid discriminator value. Expected ${Ve.joinValues(a.options)}`;break;case be.invalid_enum_value:t=`Invalid enum value. Expected ${Ve.joinValues(a.options)}, received '${a.received}'`;break;case be.invalid_arguments:t="Invalid function arguments";break;case be.invalid_return_type:t="Invalid function return type";break;case be.invalid_date:t="Invalid date";break;case be.invalid_string:typeof a.validation=="object"?"includes"in a.validation?(t=`Invalid input: must include "${a.validation.includes}"`,typeof a.validation.position=="number"&&(t=`${t} at one or more positions greater than or equal to ${a.validation.position}`)):"startsWith"in a.validation?t=`Invalid input: must start with "${a.validation.startsWith}"`:"endsWith"in a.validation?t=`Invalid input: must end with "${a.validation.endsWith}"`:Ve.assertNever(a.validation):a.validation!=="regex"?t=`Invalid ${a.validation}`:t="Invalid";break;case be.too_small:a.type==="array"?t=`Array must contain ${a.exact?"exactly":a.inclusive?"at least":"more than"} ${a.minimum} element(s)`:a.type==="string"?t=`String must contain ${a.exact?"exactly":a.inclusive?"at least":"over"} ${a.minimum} character(s)`:a.type==="number"?t=`Number must be ${a.exact?"exactly equal to ":a.inclusive?"greater than or equal to ":"greater than "}${a.minimum}`:a.type==="date"?t=`Date must be ${a.exact?"exactly equal to ":a.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(a.minimum))}`:t="Invalid input";break;case be.too_big:a.type==="array"?t=`Array must contain ${a.exact?"exactly":a.inclusive?"at most":"less than"} ${a.maximum} element(s)`:a.type==="string"?t=`String must contain ${a.exact?"exactly":a.inclusive?"at most":"under"} ${a.maximum} character(s)`:a.type==="number"?t=`Number must be ${a.exact?"exactly":a.inclusive?"less than or equal to":"less than"} ${a.maximum}`:a.type==="bigint"?t=`BigInt must be ${a.exact?"exactly":a.inclusive?"less than or equal to":"less than"} ${a.maximum}`:a.type==="date"?t=`Date must be ${a.exact?"exactly":a.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(a.maximum))}`:t="Invalid input";break;case be.custom:t="Invalid input";break;case be.invalid_intersection_types:t="Intersection results could not be merged";break;case be.not_multiple_of:t=`Number must be a multiple of ${a.multipleOf}`;break;case be.not_finite:t="Number must be finite";break;default:t=e.defaultError,Ve.assertNever(a)}return{message:t}};let U4=Of;function gW(a){U4=a}function Ry(){return U4}const Cy=a=>{const{data:e,path:t,errorMaps:r,issueData:n}=a,i=[...t,...n.path||[]],o={...n,path:i};if(n.message!==void 0)return{...n,path:i,message:n.message};let s="";const u=r.filter(l=>!!l).slice().reverse();for(const l of u)s=l(o,{data:e,defaultError:s}).message;return{...n,path:i,message:s}},vW=[];function we(a,e){const t=Ry(),r=Cy({issueData:e,data:a.data,path:a.path,errorMaps:[a.common.contextualErrorMap,a.schemaErrorMap,t,t===Of?void 0:Of].filter(n=>!!n)});a.common.issues.push(r)}class Nt{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,t){const r=[];for(const n of t){if(n.status==="aborted")return Te;n.status==="dirty"&&e.dirty(),r.push(n.value)}return{status:e.value,value:r}}static async mergeObjectAsync(e,t){const r=[];for(const n of t){const i=await n.key,o=await n.value;r.push({key:i,value:o})}return Nt.mergeObjectSync(e,r)}static mergeObjectSync(e,t){const r={};for(const n of t){const{key:i,value:o}=n;if(i.status==="aborted"||o.status==="aborted")return Te;i.status==="dirty"&&e.dirty(),o.status==="dirty"&&e.dirty(),i.value!=="__proto__"&&(typeof o.value<"u"||n.alwaysSet)&&(r[i.value]=o.value)}return{status:e.value,value:r}}}const Te=Object.freeze({status:"aborted"}),tf=a=>({status:"dirty",value:a}),Jt=a=>({status:"valid",value:a}),yE=a=>a.status==="aborted",bE=a=>a.status==="dirty",Rc=a=>a.status==="valid",dp=a=>typeof Promise<"u"&&a instanceof Promise;function Py(a,e,t,r){if(typeof e=="function"?a!==e||!0:!e.has(a))throw new TypeError("Cannot read private member from an object whose class did not declare it");return e.get(a)}function F4(a,e,t,r,n){if(typeof e=="function"?a!==e||!0:!e.has(a))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(a,t),t}var Re;(function(a){a.errToObj=e=>typeof e=="string"?{message:e}:e||{},a.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(Re||(Re={}));var Uh,Fh;class nu{constructor(e,t,r,n){this._cachedPath=[],this.parent=e,this.data=t,this._path=r,this._key=n}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const Tj=(a,e)=>{if(Rc(e))return{success:!0,data:e.value};if(!a.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const t=new vr(a.common.issues);return this._error=t,this._error}}};function De(a){if(!a)return{};const{errorMap:e,invalid_type_error:t,required_error:r,description:n}=a;if(e&&(t||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:n}:{errorMap:(o,s)=>{var u,l;const{message:c}=a;return o.code==="invalid_enum_value"?{message:c??s.defaultError}:typeof s.data>"u"?{message:(u=c??r)!==null&&u!==void 0?u:s.defaultError}:o.code!=="invalid_type"?{message:s.defaultError}:{message:(l=c??t)!==null&&l!==void 0?l:s.defaultError}},description:n}}class ze{get description(){return this._def.description}_getType(e){return vu(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:vu(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Nt,ctx:{common:e.parent.common,data:e.data,parsedType:vu(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if(dp(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const r=this.safeParse(e,t);if(r.success)return r.data;throw r.error}safeParse(e,t){var r;const n={common:{issues:[],async:(r=t==null?void 0:t.async)!==null&&r!==void 0?r:!1,contextualErrorMap:t==null?void 0:t.errorMap},path:(t==null?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:vu(e)},i=this._parseSync({data:e,path:n.path,parent:n});return Tj(n,i)}"~validate"(e){var t,r;const n={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:vu(e)};if(!this["~standard"].async)try{const i=this._parseSync({data:e,path:[],parent:n});return Rc(i)?{value:i.value}:{issues:n.common.issues}}catch(i){!((r=(t=i==null?void 0:i.message)===null||t===void 0?void 0:t.toLowerCase())===null||r===void 0)&&r.includes("encountered")&&(this["~standard"].async=!0),n.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:n}).then(i=>Rc(i)?{value:i.value}:{issues:n.common.issues})}async parseAsync(e,t){const r=await this.safeParseAsync(e,t);if(r.success)return r.data;throw r.error}async safeParseAsync(e,t){const r={common:{issues:[],contextualErrorMap:t==null?void 0:t.errorMap,async:!0},path:(t==null?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:vu(e)},n=this._parse({data:e,path:r.path,parent:r}),i=await(dp(n)?n:Promise.resolve(n));return Tj(r,i)}refine(e,t){const r=n=>typeof t=="string"||typeof t>"u"?{message:t}:typeof t=="function"?t(n):t;return this._refinement((n,i)=>{const o=e(n),s=()=>i.addIssue({code:be.custom,...r(n)});return typeof Promise<"u"&&o instanceof Promise?o.then(u=>u?!0:(s(),!1)):o?!0:(s(),!1)})}refinement(e,t){return this._refinement((r,n)=>e(r)?!0:(n.addIssue(typeof t=="function"?t(r,n):t),!1))}_refinement(e){return new Ws({schema:this,typeName:oe.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:t=>this["~validate"](t)}}optional(){return Vs.create(this,this._def)}nullable(){return Ju.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Ls.create(this)}promise(){return Ef.create(this,this._def)}or(e){return yp.create([this,e],this._def)}and(e){return bp.create(this,e,this._def)}transform(e){return new Ws({...De(this._def),schema:this,typeName:oe.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const t=typeof e=="function"?e:()=>e;return new Op({...De(this._def),innerType:this,defaultValue:t,typeName:oe.ZodDefault})}brand(){return new CR({typeName:oe.ZodBranded,type:this,...De(this._def)})}catch(e){const t=typeof e=="function"?e:()=>e;return new Sp({...De(this._def),innerType:this,catchValue:t,typeName:oe.ZodCatch})}describe(e){const t=this.constructor;return new t({...this._def,description:e})}pipe(e){return Lp.create(this,e)}readonly(){return Ep.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const wW=/^c[^\s-]{8,}$/i,OW=/^[0-9a-z]+$/,SW=/^[0-9A-HJKMNP-TV-Z]{26}$/i,EW=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,RW=/^[a-z0-9_-]{21}$/i,CW=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,PW=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,jW=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,TW="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let lg;const MW=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,AW=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,IW=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,DW=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,xW=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,$W=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,L4="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",NW=new RegExp(`^${L4}$`);function V4(a){let e="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return a.precision?e=`${e}\\.\\d{${a.precision}}`:a.precision==null&&(e=`${e}(\\.\\d+)?`),e}function qW(a){return new RegExp(`^${V4(a)}$`)}function G4(a){let e=`${L4}T${V4(a)}`;const t=[];return t.push(a.local?"Z?":"Z"),a.offset&&t.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${t.join("|")})`,new RegExp(`^${e}$`)}function zW(a,e){return!!((e==="v4"||!e)&&MW.test(a)||(e==="v6"||!e)&&IW.test(a))}function BW(a,e){if(!CW.test(a))return!1;try{const[t]=a.split("."),r=t.replace(/-/g,"+").replace(/_/g,"/").padEnd(t.length+(4-t.length%4)%4,"="),n=JSON.parse(atob(r));return!(typeof n!="object"||n===null||!n.typ||!n.alg||e&&n.alg!==e)}catch{return!1}}function UW(a,e){return!!((e==="v4"||!e)&&AW.test(a)||(e==="v6"||!e)&&DW.test(a))}class zs extends ze{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==Oe.string){const i=this._getOrReturnCtx(e);return we(i,{code:be.invalid_type,expected:Oe.string,received:i.parsedType}),Te}const r=new Nt;let n;for(const i of this._def.checks)if(i.kind==="min")e.data.length<i.value&&(n=this._getOrReturnCtx(e,n),we(n,{code:be.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="max")e.data.length>i.value&&(n=this._getOrReturnCtx(e,n),we(n,{code:be.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="length"){const o=e.data.length>i.value,s=e.data.length<i.value;(o||s)&&(n=this._getOrReturnCtx(e,n),o?we(n,{code:be.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):s&&we(n,{code:be.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),r.dirty())}else if(i.kind==="email")jW.test(e.data)||(n=this._getOrReturnCtx(e,n),we(n,{validation:"email",code:be.invalid_string,message:i.message}),r.dirty());else if(i.kind==="emoji")lg||(lg=new RegExp(TW,"u")),lg.test(e.data)||(n=this._getOrReturnCtx(e,n),we(n,{validation:"emoji",code:be.invalid_string,message:i.message}),r.dirty());else if(i.kind==="uuid")EW.test(e.data)||(n=this._getOrReturnCtx(e,n),we(n,{validation:"uuid",code:be.invalid_string,message:i.message}),r.dirty());else if(i.kind==="nanoid")RW.test(e.data)||(n=this._getOrReturnCtx(e,n),we(n,{validation:"nanoid",code:be.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid")wW.test(e.data)||(n=this._getOrReturnCtx(e,n),we(n,{validation:"cuid",code:be.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid2")OW.test(e.data)||(n=this._getOrReturnCtx(e,n),we(n,{validation:"cuid2",code:be.invalid_string,message:i.message}),r.dirty());else if(i.kind==="ulid")SW.test(e.data)||(n=this._getOrReturnCtx(e,n),we(n,{validation:"ulid",code:be.invalid_string,message:i.message}),r.dirty());else if(i.kind==="url")try{new URL(e.data)}catch{n=this._getOrReturnCtx(e,n),we(n,{validation:"url",code:be.invalid_string,message:i.message}),r.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(e.data)||(n=this._getOrReturnCtx(e,n),we(n,{validation:"regex",code:be.invalid_string,message:i.message}),r.dirty())):i.kind==="trim"?e.data=e.data.trim():i.kind==="includes"?e.data.includes(i.value,i.position)||(n=this._getOrReturnCtx(e,n),we(n,{code:be.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),r.dirty()):i.kind==="toLowerCase"?e.data=e.data.toLowerCase():i.kind==="toUpperCase"?e.data=e.data.toUpperCase():i.kind==="startsWith"?e.data.startsWith(i.value)||(n=this._getOrReturnCtx(e,n),we(n,{code:be.invalid_string,validation:{startsWith:i.value},message:i.message}),r.dirty()):i.kind==="endsWith"?e.data.endsWith(i.value)||(n=this._getOrReturnCtx(e,n),we(n,{code:be.invalid_string,validation:{endsWith:i.value},message:i.message}),r.dirty()):i.kind==="datetime"?G4(i).test(e.data)||(n=this._getOrReturnCtx(e,n),we(n,{code:be.invalid_string,validation:"datetime",message:i.message}),r.dirty()):i.kind==="date"?NW.test(e.data)||(n=this._getOrReturnCtx(e,n),we(n,{code:be.invalid_string,validation:"date",message:i.message}),r.dirty()):i.kind==="time"?qW(i).test(e.data)||(n=this._getOrReturnCtx(e,n),we(n,{code:be.invalid_string,validation:"time",message:i.message}),r.dirty()):i.kind==="duration"?PW.test(e.data)||(n=this._getOrReturnCtx(e,n),we(n,{validation:"duration",code:be.invalid_string,message:i.message}),r.dirty()):i.kind==="ip"?zW(e.data,i.version)||(n=this._getOrReturnCtx(e,n),we(n,{validation:"ip",code:be.invalid_string,message:i.message}),r.dirty()):i.kind==="jwt"?BW(e.data,i.alg)||(n=this._getOrReturnCtx(e,n),we(n,{validation:"jwt",code:be.invalid_string,message:i.message}),r.dirty()):i.kind==="cidr"?UW(e.data,i.version)||(n=this._getOrReturnCtx(e,n),we(n,{validation:"cidr",code:be.invalid_string,message:i.message}),r.dirty()):i.kind==="base64"?xW.test(e.data)||(n=this._getOrReturnCtx(e,n),we(n,{validation:"base64",code:be.invalid_string,message:i.message}),r.dirty()):i.kind==="base64url"?$W.test(e.data)||(n=this._getOrReturnCtx(e,n),we(n,{validation:"base64url",code:be.invalid_string,message:i.message}),r.dirty()):Ve.assertNever(i);return{status:r.value,value:e.data}}_regex(e,t,r){return this.refinement(n=>e.test(n),{validation:t,code:be.invalid_string,...Re.errToObj(r)})}_addCheck(e){return new zs({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...Re.errToObj(e)})}url(e){return this._addCheck({kind:"url",...Re.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...Re.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...Re.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...Re.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...Re.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...Re.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...Re.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...Re.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...Re.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...Re.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...Re.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...Re.errToObj(e)})}datetime(e){var t,r;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(t=e==null?void 0:e.offset)!==null&&t!==void 0?t:!1,local:(r=e==null?void 0:e.local)!==null&&r!==void 0?r:!1,...Re.errToObj(e==null?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,...Re.errToObj(e==null?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...Re.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...Re.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:t==null?void 0:t.position,...Re.errToObj(t==null?void 0:t.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...Re.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...Re.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...Re.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...Re.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...Re.errToObj(t)})}nonempty(e){return this.min(1,Re.errToObj(e))}trim(){return new zs({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new zs({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new zs({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}zs.create=a=>{var e;return new zs({checks:[],typeName:oe.ZodString,coerce:(e=a==null?void 0:a.coerce)!==null&&e!==void 0?e:!1,...De(a)})};function FW(a,e){const t=(a.toString().split(".")[1]||"").length,r=(e.toString().split(".")[1]||"").length,n=t>r?t:r,i=parseInt(a.toFixed(n).replace(".","")),o=parseInt(e.toFixed(n).replace(".",""));return i%o/Math.pow(10,n)}class Hu extends ze{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==Oe.number){const i=this._getOrReturnCtx(e);return we(i,{code:be.invalid_type,expected:Oe.number,received:i.parsedType}),Te}let r;const n=new Nt;for(const i of this._def.checks)i.kind==="int"?Ve.isInteger(e.data)||(r=this._getOrReturnCtx(e,r),we(r,{code:be.invalid_type,expected:"integer",received:"float",message:i.message}),n.dirty()):i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(r=this._getOrReturnCtx(e,r),we(r,{code:be.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),n.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(r=this._getOrReturnCtx(e,r),we(r,{code:be.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),n.dirty()):i.kind==="multipleOf"?FW(e.data,i.value)!==0&&(r=this._getOrReturnCtx(e,r),we(r,{code:be.not_multiple_of,multipleOf:i.value,message:i.message}),n.dirty()):i.kind==="finite"?Number.isFinite(e.data)||(r=this._getOrReturnCtx(e,r),we(r,{code:be.not_finite,message:i.message}),n.dirty()):Ve.assertNever(i);return{status:n.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,Re.toString(t))}gt(e,t){return this.setLimit("min",e,!1,Re.toString(t))}lte(e,t){return this.setLimit("max",e,!0,Re.toString(t))}lt(e,t){return this.setLimit("max",e,!1,Re.toString(t))}setLimit(e,t,r,n){return new Hu({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:Re.toString(n)}]})}_addCheck(e){return new Hu({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:Re.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:Re.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:Re.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:Re.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:Re.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:Re.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:Re.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:Re.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:Re.toString(e)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&Ve.isInteger(e.value))}get isFinite(){let e=null,t=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(t===null||r.value>t)&&(t=r.value):r.kind==="max"&&(e===null||r.value<e)&&(e=r.value)}return Number.isFinite(t)&&Number.isFinite(e)}}Hu.create=a=>new Hu({checks:[],typeName:oe.ZodNumber,coerce:(a==null?void 0:a.coerce)||!1,...De(a)});class Wu extends ze{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==Oe.bigint)return this._getInvalidInput(e);let r;const n=new Nt;for(const i of this._def.checks)i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(r=this._getOrReturnCtx(e,r),we(r,{code:be.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),n.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(r=this._getOrReturnCtx(e,r),we(r,{code:be.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),n.dirty()):i.kind==="multipleOf"?e.data%i.value!==BigInt(0)&&(r=this._getOrReturnCtx(e,r),we(r,{code:be.not_multiple_of,multipleOf:i.value,message:i.message}),n.dirty()):Ve.assertNever(i);return{status:n.value,value:e.data}}_getInvalidInput(e){const t=this._getOrReturnCtx(e);return we(t,{code:be.invalid_type,expected:Oe.bigint,received:t.parsedType}),Te}gte(e,t){return this.setLimit("min",e,!0,Re.toString(t))}gt(e,t){return this.setLimit("min",e,!1,Re.toString(t))}lte(e,t){return this.setLimit("max",e,!0,Re.toString(t))}lt(e,t){return this.setLimit("max",e,!1,Re.toString(t))}setLimit(e,t,r,n){return new Wu({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:Re.toString(n)}]})}_addCheck(e){return new Wu({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:Re.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:Re.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:Re.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:Re.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:Re.toString(t)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}Wu.create=a=>{var e;return new Wu({checks:[],typeName:oe.ZodBigInt,coerce:(e=a==null?void 0:a.coerce)!==null&&e!==void 0?e:!1,...De(a)})};class hp extends ze{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==Oe.boolean){const r=this._getOrReturnCtx(e);return we(r,{code:be.invalid_type,expected:Oe.boolean,received:r.parsedType}),Te}return Jt(e.data)}}hp.create=a=>new hp({typeName:oe.ZodBoolean,coerce:(a==null?void 0:a.coerce)||!1,...De(a)});class Cc extends ze{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==Oe.date){const i=this._getOrReturnCtx(e);return we(i,{code:be.invalid_type,expected:Oe.date,received:i.parsedType}),Te}if(isNaN(e.data.getTime())){const i=this._getOrReturnCtx(e);return we(i,{code:be.invalid_date}),Te}const r=new Nt;let n;for(const i of this._def.checks)i.kind==="min"?e.data.getTime()<i.value&&(n=this._getOrReturnCtx(e,n),we(n,{code:be.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),r.dirty()):i.kind==="max"?e.data.getTime()>i.value&&(n=this._getOrReturnCtx(e,n),we(n,{code:be.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),r.dirty()):Ve.assertNever(i);return{status:r.value,value:new Date(e.data.getTime())}}_addCheck(e){return new Cc({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:Re.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:Re.toString(t)})}get minDate(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e!=null?new Date(e):null}}Cc.create=a=>new Cc({checks:[],coerce:(a==null?void 0:a.coerce)||!1,typeName:oe.ZodDate,...De(a)});class jy extends ze{_parse(e){if(this._getType(e)!==Oe.symbol){const r=this._getOrReturnCtx(e);return we(r,{code:be.invalid_type,expected:Oe.symbol,received:r.parsedType}),Te}return Jt(e.data)}}jy.create=a=>new jy({typeName:oe.ZodSymbol,...De(a)});class pp extends ze{_parse(e){if(this._getType(e)!==Oe.undefined){const r=this._getOrReturnCtx(e);return we(r,{code:be.invalid_type,expected:Oe.undefined,received:r.parsedType}),Te}return Jt(e.data)}}pp.create=a=>new pp({typeName:oe.ZodUndefined,...De(a)});class _p extends ze{_parse(e){if(this._getType(e)!==Oe.null){const r=this._getOrReturnCtx(e);return we(r,{code:be.invalid_type,expected:Oe.null,received:r.parsedType}),Te}return Jt(e.data)}}_p.create=a=>new _p({typeName:oe.ZodNull,...De(a)});class Sf extends ze{constructor(){super(...arguments),this._any=!0}_parse(e){return Jt(e.data)}}Sf.create=a=>new Sf({typeName:oe.ZodAny,...De(a)});class wc extends ze{constructor(){super(...arguments),this._unknown=!0}_parse(e){return Jt(e.data)}}wc.create=a=>new wc({typeName:oe.ZodUnknown,...De(a)});class Eu extends ze{_parse(e){const t=this._getOrReturnCtx(e);return we(t,{code:be.invalid_type,expected:Oe.never,received:t.parsedType}),Te}}Eu.create=a=>new Eu({typeName:oe.ZodNever,...De(a)});class Ty extends ze{_parse(e){if(this._getType(e)!==Oe.undefined){const r=this._getOrReturnCtx(e);return we(r,{code:be.invalid_type,expected:Oe.void,received:r.parsedType}),Te}return Jt(e.data)}}Ty.create=a=>new Ty({typeName:oe.ZodVoid,...De(a)});class Ls extends ze{_parse(e){const{ctx:t,status:r}=this._processInputParams(e),n=this._def;if(t.parsedType!==Oe.array)return we(t,{code:be.invalid_type,expected:Oe.array,received:t.parsedType}),Te;if(n.exactLength!==null){const o=t.data.length>n.exactLength.value,s=t.data.length<n.exactLength.value;(o||s)&&(we(t,{code:o?be.too_big:be.too_small,minimum:s?n.exactLength.value:void 0,maximum:o?n.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:n.exactLength.message}),r.dirty())}if(n.minLength!==null&&t.data.length<n.minLength.value&&(we(t,{code:be.too_small,minimum:n.minLength.value,type:"array",inclusive:!0,exact:!1,message:n.minLength.message}),r.dirty()),n.maxLength!==null&&t.data.length>n.maxLength.value&&(we(t,{code:be.too_big,maximum:n.maxLength.value,type:"array",inclusive:!0,exact:!1,message:n.maxLength.message}),r.dirty()),t.common.async)return Promise.all([...t.data].map((o,s)=>n.type._parseAsync(new nu(t,o,t.path,s)))).then(o=>Nt.mergeArray(r,o));const i=[...t.data].map((o,s)=>n.type._parseSync(new nu(t,o,t.path,s)));return Nt.mergeArray(r,i)}get element(){return this._def.type}min(e,t){return new Ls({...this._def,minLength:{value:e,message:Re.toString(t)}})}max(e,t){return new Ls({...this._def,maxLength:{value:e,message:Re.toString(t)}})}length(e,t){return new Ls({...this._def,exactLength:{value:e,message:Re.toString(t)}})}nonempty(e){return this.min(1,e)}}Ls.create=(a,e)=>new Ls({type:a,minLength:null,maxLength:null,exactLength:null,typeName:oe.ZodArray,...De(e)});function Kc(a){if(a instanceof st){const e={};for(const t in a.shape){const r=a.shape[t];e[t]=Vs.create(Kc(r))}return new st({...a._def,shape:()=>e})}else return a instanceof Ls?new Ls({...a._def,type:Kc(a.element)}):a instanceof Vs?Vs.create(Kc(a.unwrap())):a instanceof Ju?Ju.create(Kc(a.unwrap())):a instanceof iu?iu.create(a.items.map(e=>Kc(e))):a}class st extends ze{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),t=Ve.objectKeys(e);return this._cached={shape:e,keys:t}}_parse(e){if(this._getType(e)!==Oe.object){const l=this._getOrReturnCtx(e);return we(l,{code:be.invalid_type,expected:Oe.object,received:l.parsedType}),Te}const{status:r,ctx:n}=this._processInputParams(e),{shape:i,keys:o}=this._getCached(),s=[];if(!(this._def.catchall instanceof Eu&&this._def.unknownKeys==="strip"))for(const l in n.data)o.includes(l)||s.push(l);const u=[];for(const l of o){const c=i[l],f=n.data[l];u.push({key:{status:"valid",value:l},value:c._parse(new nu(n,f,n.path,l)),alwaysSet:l in n.data})}if(this._def.catchall instanceof Eu){const l=this._def.unknownKeys;if(l==="passthrough")for(const c of s)u.push({key:{status:"valid",value:c},value:{status:"valid",value:n.data[c]}});else if(l==="strict")s.length>0&&(we(n,{code:be.unrecognized_keys,keys:s}),r.dirty());else if(l!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const l=this._def.catchall;for(const c of s){const f=n.data[c];u.push({key:{status:"valid",value:c},value:l._parse(new nu(n,f,n.path,c)),alwaysSet:c in n.data})}}return n.common.async?Promise.resolve().then(async()=>{const l=[];for(const c of u){const f=await c.key,p=await c.value;l.push({key:f,value:p,alwaysSet:c.alwaysSet})}return l}).then(l=>Nt.mergeObjectSync(r,l)):Nt.mergeObjectSync(r,u)}get shape(){return this._def.shape()}strict(e){return Re.errToObj,new st({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(t,r)=>{var n,i,o,s;const u=(o=(i=(n=this._def).errorMap)===null||i===void 0?void 0:i.call(n,t,r).message)!==null&&o!==void 0?o:r.defaultError;return t.code==="unrecognized_keys"?{message:(s=Re.errToObj(e).message)!==null&&s!==void 0?s:u}:{message:u}}}:{}})}strip(){return new st({...this._def,unknownKeys:"strip"})}passthrough(){return new st({...this._def,unknownKeys:"passthrough"})}extend(e){return new st({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new st({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:oe.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new st({...this._def,catchall:e})}pick(e){const t={};return Ve.objectKeys(e).forEach(r=>{e[r]&&this.shape[r]&&(t[r]=this.shape[r])}),new st({...this._def,shape:()=>t})}omit(e){const t={};return Ve.objectKeys(this.shape).forEach(r=>{e[r]||(t[r]=this.shape[r])}),new st({...this._def,shape:()=>t})}deepPartial(){return Kc(this)}partial(e){const t={};return Ve.objectKeys(this.shape).forEach(r=>{const n=this.shape[r];e&&!e[r]?t[r]=n:t[r]=n.optional()}),new st({...this._def,shape:()=>t})}required(e){const t={};return Ve.objectKeys(this.shape).forEach(r=>{if(e&&!e[r])t[r]=this.shape[r];else{let i=this.shape[r];for(;i instanceof Vs;)i=i._def.innerType;t[r]=i}}),new st({...this._def,shape:()=>t})}keyof(){return k4(Ve.objectKeys(this.shape))}}st.create=(a,e)=>new st({shape:()=>a,unknownKeys:"strip",catchall:Eu.create(),typeName:oe.ZodObject,...De(e)});st.strictCreate=(a,e)=>new st({shape:()=>a,unknownKeys:"strict",catchall:Eu.create(),typeName:oe.ZodObject,...De(e)});st.lazycreate=(a,e)=>new st({shape:a,unknownKeys:"strip",catchall:Eu.create(),typeName:oe.ZodObject,...De(e)});class yp extends ze{_parse(e){const{ctx:t}=this._processInputParams(e),r=this._def.options;function n(i){for(const s of i)if(s.result.status==="valid")return s.result;for(const s of i)if(s.result.status==="dirty")return t.common.issues.push(...s.ctx.common.issues),s.result;const o=i.map(s=>new vr(s.ctx.common.issues));return we(t,{code:be.invalid_union,unionErrors:o}),Te}if(t.common.async)return Promise.all(r.map(async i=>{const o={...t,common:{...t.common,issues:[]},parent:null};return{result:await i._parseAsync({data:t.data,path:t.path,parent:o}),ctx:o}})).then(n);{let i;const o=[];for(const u of r){const l={...t,common:{...t.common,issues:[]},parent:null},c=u._parseSync({data:t.data,path:t.path,parent:l});if(c.status==="valid")return c;c.status==="dirty"&&!i&&(i={result:c,ctx:l}),l.common.issues.length&&o.push(l.common.issues)}if(i)return t.common.issues.push(...i.ctx.common.issues),i.result;const s=o.map(u=>new vr(u));return we(t,{code:be.invalid_union,unionErrors:s}),Te}}get options(){return this._def.options}}yp.create=(a,e)=>new yp({options:a,typeName:oe.ZodUnion,...De(e)});const mu=a=>a instanceof gp?mu(a.schema):a instanceof Ws?mu(a.innerType()):a instanceof vp?[a.value]:a instanceof Ku?a.options:a instanceof wp?Ve.objectValues(a.enum):a instanceof Op?mu(a._def.innerType):a instanceof pp?[void 0]:a instanceof _p?[null]:a instanceof Vs?[void 0,...mu(a.unwrap())]:a instanceof Ju?[null,...mu(a.unwrap())]:a instanceof CR||a instanceof Ep?mu(a.unwrap()):a instanceof Sp?mu(a._def.innerType):[];class hb extends ze{_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==Oe.object)return we(t,{code:be.invalid_type,expected:Oe.object,received:t.parsedType}),Te;const r=this.discriminator,n=t.data[r],i=this.optionsMap.get(n);return i?t.common.async?i._parseAsync({data:t.data,path:t.path,parent:t}):i._parseSync({data:t.data,path:t.path,parent:t}):(we(t,{code:be.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),Te)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,r){const n=new Map;for(const i of t){const o=mu(i.shape[e]);if(!o.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const s of o){if(n.has(s))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(s)}`);n.set(s,i)}}return new hb({typeName:oe.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:n,...De(r)})}}function mE(a,e){const t=vu(a),r=vu(e);if(a===e)return{valid:!0,data:a};if(t===Oe.object&&r===Oe.object){const n=Ve.objectKeys(e),i=Ve.objectKeys(a).filter(s=>n.indexOf(s)!==-1),o={...a,...e};for(const s of i){const u=mE(a[s],e[s]);if(!u.valid)return{valid:!1};o[s]=u.data}return{valid:!0,data:o}}else if(t===Oe.array&&r===Oe.array){if(a.length!==e.length)return{valid:!1};const n=[];for(let i=0;i<a.length;i++){const o=a[i],s=e[i],u=mE(o,s);if(!u.valid)return{valid:!1};n.push(u.data)}return{valid:!0,data:n}}else return t===Oe.date&&r===Oe.date&&+a==+e?{valid:!0,data:a}:{valid:!1}}class bp extends ze{_parse(e){const{status:t,ctx:r}=this._processInputParams(e),n=(i,o)=>{if(yE(i)||yE(o))return Te;const s=mE(i.value,o.value);return s.valid?((bE(i)||bE(o))&&t.dirty(),{status:t.value,value:s.data}):(we(r,{code:be.invalid_intersection_types}),Te)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([i,o])=>n(i,o)):n(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}bp.create=(a,e,t)=>new bp({left:a,right:e,typeName:oe.ZodIntersection,...De(t)});class iu extends ze{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==Oe.array)return we(r,{code:be.invalid_type,expected:Oe.array,received:r.parsedType}),Te;if(r.data.length<this._def.items.length)return we(r,{code:be.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),Te;!this._def.rest&&r.data.length>this._def.items.length&&(we(r,{code:be.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());const i=[...r.data].map((o,s)=>{const u=this._def.items[s]||this._def.rest;return u?u._parse(new nu(r,o,r.path,s)):null}).filter(o=>!!o);return r.common.async?Promise.all(i).then(o=>Nt.mergeArray(t,o)):Nt.mergeArray(t,i)}get items(){return this._def.items}rest(e){return new iu({...this._def,rest:e})}}iu.create=(a,e)=>{if(!Array.isArray(a))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new iu({items:a,typeName:oe.ZodTuple,rest:null,...De(e)})};class mp extends ze{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==Oe.object)return we(r,{code:be.invalid_type,expected:Oe.object,received:r.parsedType}),Te;const n=[],i=this._def.keyType,o=this._def.valueType;for(const s in r.data)n.push({key:i._parse(new nu(r,s,r.path,s)),value:o._parse(new nu(r,r.data[s],r.path,s)),alwaysSet:s in r.data});return r.common.async?Nt.mergeObjectAsync(t,n):Nt.mergeObjectSync(t,n)}get element(){return this._def.valueType}static create(e,t,r){return t instanceof ze?new mp({keyType:e,valueType:t,typeName:oe.ZodRecord,...De(r)}):new mp({keyType:zs.create(),valueType:e,typeName:oe.ZodRecord,...De(t)})}}class My extends ze{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==Oe.map)return we(r,{code:be.invalid_type,expected:Oe.map,received:r.parsedType}),Te;const n=this._def.keyType,i=this._def.valueType,o=[...r.data.entries()].map(([s,u],l)=>({key:n._parse(new nu(r,s,r.path,[l,"key"])),value:i._parse(new nu(r,u,r.path,[l,"value"]))}));if(r.common.async){const s=new Map;return Promise.resolve().then(async()=>{for(const u of o){const l=await u.key,c=await u.value;if(l.status==="aborted"||c.status==="aborted")return Te;(l.status==="dirty"||c.status==="dirty")&&t.dirty(),s.set(l.value,c.value)}return{status:t.value,value:s}})}else{const s=new Map;for(const u of o){const l=u.key,c=u.value;if(l.status==="aborted"||c.status==="aborted")return Te;(l.status==="dirty"||c.status==="dirty")&&t.dirty(),s.set(l.value,c.value)}return{status:t.value,value:s}}}}My.create=(a,e,t)=>new My({valueType:e,keyType:a,typeName:oe.ZodMap,...De(t)});class Pc extends ze{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==Oe.set)return we(r,{code:be.invalid_type,expected:Oe.set,received:r.parsedType}),Te;const n=this._def;n.minSize!==null&&r.data.size<n.minSize.value&&(we(r,{code:be.too_small,minimum:n.minSize.value,type:"set",inclusive:!0,exact:!1,message:n.minSize.message}),t.dirty()),n.maxSize!==null&&r.data.size>n.maxSize.value&&(we(r,{code:be.too_big,maximum:n.maxSize.value,type:"set",inclusive:!0,exact:!1,message:n.maxSize.message}),t.dirty());const i=this._def.valueType;function o(u){const l=new Set;for(const c of u){if(c.status==="aborted")return Te;c.status==="dirty"&&t.dirty(),l.add(c.value)}return{status:t.value,value:l}}const s=[...r.data.values()].map((u,l)=>i._parse(new nu(r,u,r.path,l)));return r.common.async?Promise.all(s).then(u=>o(u)):o(s)}min(e,t){return new Pc({...this._def,minSize:{value:e,message:Re.toString(t)}})}max(e,t){return new Pc({...this._def,maxSize:{value:e,message:Re.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}Pc.create=(a,e)=>new Pc({valueType:a,minSize:null,maxSize:null,typeName:oe.ZodSet,...De(e)});class cf extends ze{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==Oe.function)return we(t,{code:be.invalid_type,expected:Oe.function,received:t.parsedType}),Te;function r(s,u){return Cy({data:s,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,Ry(),Of].filter(l=>!!l),issueData:{code:be.invalid_arguments,argumentsError:u}})}function n(s,u){return Cy({data:s,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,Ry(),Of].filter(l=>!!l),issueData:{code:be.invalid_return_type,returnTypeError:u}})}const i={errorMap:t.common.contextualErrorMap},o=t.data;if(this._def.returns instanceof Ef){const s=this;return Jt(async function(...u){const l=new vr([]),c=await s._def.args.parseAsync(u,i).catch(h=>{throw l.addIssue(r(u,h)),l}),f=await Reflect.apply(o,this,c);return await s._def.returns._def.type.parseAsync(f,i).catch(h=>{throw l.addIssue(n(f,h)),l})})}else{const s=this;return Jt(function(...u){const l=s._def.args.safeParse(u,i);if(!l.success)throw new vr([r(u,l.error)]);const c=Reflect.apply(o,this,l.data),f=s._def.returns.safeParse(c,i);if(!f.success)throw new vr([n(c,f.error)]);return f.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new cf({...this._def,args:iu.create(e).rest(wc.create())})}returns(e){return new cf({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,r){return new cf({args:e||iu.create([]).rest(wc.create()),returns:t||wc.create(),typeName:oe.ZodFunction,...De(r)})}}class gp extends ze{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}gp.create=(a,e)=>new gp({getter:a,typeName:oe.ZodLazy,...De(e)});class vp extends ze{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return we(t,{received:t.data,code:be.invalid_literal,expected:this._def.value}),Te}return{status:"valid",value:e.data}}get value(){return this._def.value}}vp.create=(a,e)=>new vp({value:a,typeName:oe.ZodLiteral,...De(e)});function k4(a,e){return new Ku({values:a,typeName:oe.ZodEnum,...De(e)})}class Ku extends ze{constructor(){super(...arguments),Uh.set(this,void 0)}_parse(e){if(typeof e.data!="string"){const t=this._getOrReturnCtx(e),r=this._def.values;return we(t,{expected:Ve.joinValues(r),received:t.parsedType,code:be.invalid_type}),Te}if(Py(this,Uh)||F4(this,Uh,new Set(this._def.values)),!Py(this,Uh).has(e.data)){const t=this._getOrReturnCtx(e),r=this._def.values;return we(t,{received:t.data,code:be.invalid_enum_value,options:r}),Te}return Jt(e.data)}get options(){return this._def.values}get enum(){const e={};for(const t of this._def.values)e[t]=t;return e}get Values(){const e={};for(const t of this._def.values)e[t]=t;return e}get Enum(){const e={};for(const t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return Ku.create(e,{...this._def,...t})}exclude(e,t=this._def){return Ku.create(this.options.filter(r=>!e.includes(r)),{...this._def,...t})}}Uh=new WeakMap;Ku.create=k4;class wp extends ze{constructor(){super(...arguments),Fh.set(this,void 0)}_parse(e){const t=Ve.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==Oe.string&&r.parsedType!==Oe.number){const n=Ve.objectValues(t);return we(r,{expected:Ve.joinValues(n),received:r.parsedType,code:be.invalid_type}),Te}if(Py(this,Fh)||F4(this,Fh,new Set(Ve.getValidEnumValues(this._def.values))),!Py(this,Fh).has(e.data)){const n=Ve.objectValues(t);return we(r,{received:r.data,code:be.invalid_enum_value,options:n}),Te}return Jt(e.data)}get enum(){return this._def.values}}Fh=new WeakMap;wp.create=(a,e)=>new wp({values:a,typeName:oe.ZodNativeEnum,...De(e)});class Ef extends ze{unwrap(){return this._def.type}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==Oe.promise&&t.common.async===!1)return we(t,{code:be.invalid_type,expected:Oe.promise,received:t.parsedType}),Te;const r=t.parsedType===Oe.promise?t.data:Promise.resolve(t.data);return Jt(r.then(n=>this._def.type.parseAsync(n,{path:t.path,errorMap:t.common.contextualErrorMap})))}}Ef.create=(a,e)=>new Ef({type:a,typeName:oe.ZodPromise,...De(e)});class Ws extends ze{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===oe.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:t,ctx:r}=this._processInputParams(e),n=this._def.effect||null,i={addIssue:o=>{we(r,o),o.fatal?t.abort():t.dirty()},get path(){return r.path}};if(i.addIssue=i.addIssue.bind(i),n.type==="preprocess"){const o=n.transform(r.data,i);if(r.common.async)return Promise.resolve(o).then(async s=>{if(t.value==="aborted")return Te;const u=await this._def.schema._parseAsync({data:s,path:r.path,parent:r});return u.status==="aborted"?Te:u.status==="dirty"||t.value==="dirty"?tf(u.value):u});{if(t.value==="aborted")return Te;const s=this._def.schema._parseSync({data:o,path:r.path,parent:r});return s.status==="aborted"?Te:s.status==="dirty"||t.value==="dirty"?tf(s.value):s}}if(n.type==="refinement"){const o=s=>{const u=n.refinement(s,i);if(r.common.async)return Promise.resolve(u);if(u instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return s};if(r.common.async===!1){const s=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return s.status==="aborted"?Te:(s.status==="dirty"&&t.dirty(),o(s.value),{status:t.value,value:s.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(s=>s.status==="aborted"?Te:(s.status==="dirty"&&t.dirty(),o(s.value).then(()=>({status:t.value,value:s.value}))))}if(n.type==="transform")if(r.common.async===!1){const o=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!Rc(o))return o;const s=n.transform(o.value,i);if(s instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:s}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(o=>Rc(o)?Promise.resolve(n.transform(o.value,i)).then(s=>({status:t.value,value:s})):o);Ve.assertNever(n)}}Ws.create=(a,e,t)=>new Ws({schema:a,typeName:oe.ZodEffects,effect:e,...De(t)});Ws.createWithPreprocess=(a,e,t)=>new Ws({schema:e,effect:{type:"preprocess",transform:a},typeName:oe.ZodEffects,...De(t)});class Vs extends ze{_parse(e){return this._getType(e)===Oe.undefined?Jt(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Vs.create=(a,e)=>new Vs({innerType:a,typeName:oe.ZodOptional,...De(e)});class Ju extends ze{_parse(e){return this._getType(e)===Oe.null?Jt(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Ju.create=(a,e)=>new Ju({innerType:a,typeName:oe.ZodNullable,...De(e)});class Op extends ze{_parse(e){const{ctx:t}=this._processInputParams(e);let r=t.data;return t.parsedType===Oe.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}Op.create=(a,e)=>new Op({innerType:a,typeName:oe.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...De(e)});class Sp extends ze{_parse(e){const{ctx:t}=this._processInputParams(e),r={...t,common:{...t.common,issues:[]}},n=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return dp(n)?n.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new vr(r.common.issues)},input:r.data})})):{status:"valid",value:n.status==="valid"?n.value:this._def.catchValue({get error(){return new vr(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}Sp.create=(a,e)=>new Sp({innerType:a,typeName:oe.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...De(e)});class Ay extends ze{_parse(e){if(this._getType(e)!==Oe.nan){const r=this._getOrReturnCtx(e);return we(r,{code:be.invalid_type,expected:Oe.nan,received:r.parsedType}),Te}return{status:"valid",value:e.data}}}Ay.create=a=>new Ay({typeName:oe.ZodNaN,...De(a)});const LW=Symbol("zod_brand");class CR extends ze{_parse(e){const{ctx:t}=this._processInputParams(e),r=t.data;return this._def.type._parse({data:r,path:t.path,parent:t})}unwrap(){return this._def.type}}class Lp extends ze{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.common.async)return(async()=>{const i=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return i.status==="aborted"?Te:i.status==="dirty"?(t.dirty(),tf(i.value)):this._def.out._parseAsync({data:i.value,path:r.path,parent:r})})();{const n=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return n.status==="aborted"?Te:n.status==="dirty"?(t.dirty(),{status:"dirty",value:n.value}):this._def.out._parseSync({data:n.value,path:r.path,parent:r})}}static create(e,t){return new Lp({in:e,out:t,typeName:oe.ZodPipeline})}}class Ep extends ze{_parse(e){const t=this._def.innerType._parse(e),r=n=>(Rc(n)&&(n.value=Object.freeze(n.value)),n);return dp(t)?t.then(n=>r(n)):r(t)}unwrap(){return this._def.innerType}}Ep.create=(a,e)=>new Ep({innerType:a,typeName:oe.ZodReadonly,...De(e)});function Mj(a,e){const t=typeof a=="function"?a(e):typeof a=="string"?{message:a}:a;return typeof t=="string"?{message:t}:t}function H4(a,e={},t){return a?Sf.create().superRefine((r,n)=>{var i,o;const s=a(r);if(s instanceof Promise)return s.then(u=>{var l,c;if(!u){const f=Mj(e,r),p=(c=(l=f.fatal)!==null&&l!==void 0?l:t)!==null&&c!==void 0?c:!0;n.addIssue({code:"custom",...f,fatal:p})}});if(!s){const u=Mj(e,r),l=(o=(i=u.fatal)!==null&&i!==void 0?i:t)!==null&&o!==void 0?o:!0;n.addIssue({code:"custom",...u,fatal:l})}}):Sf.create()}const VW={object:st.lazycreate};var oe;(function(a){a.ZodString="ZodString",a.ZodNumber="ZodNumber",a.ZodNaN="ZodNaN",a.ZodBigInt="ZodBigInt",a.ZodBoolean="ZodBoolean",a.ZodDate="ZodDate",a.ZodSymbol="ZodSymbol",a.ZodUndefined="ZodUndefined",a.ZodNull="ZodNull",a.ZodAny="ZodAny",a.ZodUnknown="ZodUnknown",a.ZodNever="ZodNever",a.ZodVoid="ZodVoid",a.ZodArray="ZodArray",a.ZodObject="ZodObject",a.ZodUnion="ZodUnion",a.ZodDiscriminatedUnion="ZodDiscriminatedUnion",a.ZodIntersection="ZodIntersection",a.ZodTuple="ZodTuple",a.ZodRecord="ZodRecord",a.ZodMap="ZodMap",a.ZodSet="ZodSet",a.ZodFunction="ZodFunction",a.ZodLazy="ZodLazy",a.ZodLiteral="ZodLiteral",a.ZodEnum="ZodEnum",a.ZodEffects="ZodEffects",a.ZodNativeEnum="ZodNativeEnum",a.ZodOptional="ZodOptional",a.ZodNullable="ZodNullable",a.ZodDefault="ZodDefault",a.ZodCatch="ZodCatch",a.ZodPromise="ZodPromise",a.ZodBranded="ZodBranded",a.ZodPipeline="ZodPipeline",a.ZodReadonly="ZodReadonly"})(oe||(oe={}));const GW=(a,e={message:`Input not instance of ${a.name}`})=>H4(t=>t instanceof a,e),W4=zs.create,K4=Hu.create,kW=Ay.create,HW=Wu.create,J4=hp.create,WW=Cc.create,KW=jy.create,JW=pp.create,XW=_p.create,ZW=Sf.create,QW=wc.create,YW=Eu.create,eK=Ty.create,tK=Ls.create,rK=st.create,nK=st.strictCreate,iK=yp.create,aK=hb.create,oK=bp.create,sK=iu.create,uK=mp.create,lK=My.create,cK=Pc.create,fK=cf.create,dK=gp.create,hK=vp.create,pK=Ku.create,_K=wp.create,yK=Ef.create,Aj=Ws.create,bK=Vs.create,mK=Ju.create,gK=Ws.createWithPreprocess,vK=Lp.create,wK=()=>W4().optional(),OK=()=>K4().optional(),SK=()=>J4().optional(),EK={string:a=>zs.create({...a,coerce:!0}),number:a=>Hu.create({...a,coerce:!0}),boolean:a=>hp.create({...a,coerce:!0}),bigint:a=>Wu.create({...a,coerce:!0}),date:a=>Cc.create({...a,coerce:!0})},RK=Te;var Oc=Object.freeze({__proto__:null,defaultErrorMap:Of,setErrorMap:gW,getErrorMap:Ry,makeIssue:Cy,EMPTY_PATH:vW,addIssueToContext:we,ParseStatus:Nt,INVALID:Te,DIRTY:tf,OK:Jt,isAborted:yE,isDirty:bE,isValid:Rc,isAsync:dp,get util(){return Ve},get objectUtil(){return _E},ZodParsedType:Oe,getParsedType:vu,ZodType:ze,datetimeRegex:G4,ZodString:zs,ZodNumber:Hu,ZodBigInt:Wu,ZodBoolean:hp,ZodDate:Cc,ZodSymbol:jy,ZodUndefined:pp,ZodNull:_p,ZodAny:Sf,ZodUnknown:wc,ZodNever:Eu,ZodVoid:Ty,ZodArray:Ls,ZodObject:st,ZodUnion:yp,ZodDiscriminatedUnion:hb,ZodIntersection:bp,ZodTuple:iu,ZodRecord:mp,ZodMap:My,ZodSet:Pc,ZodFunction:cf,ZodLazy:gp,ZodLiteral:vp,ZodEnum:Ku,ZodNativeEnum:wp,ZodPromise:Ef,ZodEffects:Ws,ZodTransformer:Ws,ZodOptional:Vs,ZodNullable:Ju,ZodDefault:Op,ZodCatch:Sp,ZodNaN:Ay,BRAND:LW,ZodBranded:CR,ZodPipeline:Lp,ZodReadonly:Ep,custom:H4,Schema:ze,ZodSchema:ze,late:VW,get ZodFirstPartyTypeKind(){return oe},coerce:EK,any:ZW,array:tK,bigint:HW,boolean:J4,date:WW,discriminatedUnion:aK,effect:Aj,enum:pK,function:fK,instanceof:GW,intersection:oK,lazy:dK,literal:hK,map:lK,nan:kW,nativeEnum:_K,never:YW,null:XW,nullable:mK,number:K4,object:rK,oboolean:SK,onumber:OK,optional:bK,ostring:wK,pipeline:vK,preprocess:gK,promise:yK,record:uK,set:cK,strictObject:nK,string:W4,symbol:KW,transformer:Aj,tuple:sK,undefined:JW,union:iK,unknown:QW,void:eK,NEVER:RK,ZodIssueCode:be,quotelessJson:mW,ZodError:vr});/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017-2022 Joachim Wester
 * MIT licensed
 */const CK=Object.prototype.hasOwnProperty;function gE(a,e){return CK.call(a,e)}function vE(a){if(Array.isArray(a)){const t=new Array(a.length);for(let r=0;r<t.length;r++)t[r]=""+r;return t}if(Object.keys)return Object.keys(a);let e=[];for(let t in a)gE(a,t)&&e.push(t);return e}function tu(a){switch(typeof a){case"object":return JSON.parse(JSON.stringify(a));case"undefined":return null;default:return a}}function wE(a){let e=0;const t=a.length;let r;for(;e<t;){if(r=a.charCodeAt(e),r>=48&&r<=57){e++;continue}return!1}return!0}function Bc(a){return a.indexOf("/")===-1&&a.indexOf("~")===-1?a:a.replace(/~/g,"~0").replace(/\//g,"~1")}function PK(a){return a.replace(/~1/g,"/").replace(/~0/g,"~")}function OE(a){if(a===void 0)return!0;if(a){if(Array.isArray(a)){for(let t=0,r=a.length;t<r;t++)if(OE(a[t]))return!0}else if(typeof a=="object"){const t=vE(a),r=t.length;for(var e=0;e<r;e++)if(OE(a[t[e]]))return!0}}return!1}function Ij(a,e){const t=[a];for(const r in e){const n=typeof e[r]=="object"?JSON.stringify(e[r],null,2):e[r];typeof n<"u"&&t.push(`${r}: ${n}`)}return t.join(`
`)}class jK extends Error{constructor(e,t,r,n,i){super(Ij(e,{name:t,index:r,operation:n,tree:i})),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"index",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"operation",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"tree",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.setPrototypeOf(this,new.target.prototype),this.message=Ij(e,{name:t,index:r,operation:n,tree:i})}}const ht=jK,rf={add:function(a,e,t){return a[e]=this.value,{newDocument:t}},remove:function(a,e,t){var r=a[e];return delete a[e],{newDocument:t,removed:r}},replace:function(a,e,t){var r=a[e];return a[e]=this.value,{newDocument:t,removed:r}},move:function(a,e,t){let r=SE(t,this.path);r&&(r=tu(r));const n=ep(t,{op:"remove",path:this.from}).removed;return ep(t,{op:"add",path:this.path,value:n}),{newDocument:t,removed:r}},copy:function(a,e,t){const r=SE(t,this.from);return ep(t,{op:"add",path:this.path,value:tu(r)}),{newDocument:t}},test:function(a,e,t){return{newDocument:t,test:Dy(a[e],this.value)}},_get:function(a,e,t){return this.value=a[e],{newDocument:t}}};var TK={add:function(a,e,t){return wE(e)?a.splice(e,0,this.value):a[e]=this.value,{newDocument:t,index:e}},remove:function(a,e,t){var r=a.splice(e,1);return{newDocument:t,removed:r[0]}},replace:function(a,e,t){var r=a[e];return a[e]=this.value,{newDocument:t,removed:r}},move:rf.move,copy:rf.copy,test:rf.test,_get:rf._get};function SE(a,e){if(e=="")return a;var t={op:"_get",path:e};return ep(a,t),t.value}function ep(a,e,t=!1,r=!0,n=!0,i=0){if(t&&(typeof t=="function"?t(e,0,a,e.path):EE(e,0)),e.path===""){let o={newDocument:a};if(e.op==="add")return o.newDocument=e.value,o;if(e.op==="replace")return o.newDocument=e.value,o.removed=a,o;if(e.op==="move"||e.op==="copy")return o.newDocument=SE(a,e.from),e.op==="move"&&(o.removed=a),o;if(e.op==="test"){if(o.test=Dy(a,e.value),o.test===!1)throw new ht("Test operation failed","TEST_OPERATION_FAILED",i,e,a);return o.newDocument=a,o}else{if(e.op==="remove")return o.removed=a,o.newDocument=null,o;if(e.op==="_get")return e.value=a,o;if(t)throw new ht("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",i,e,a);return o}}else{r||(a=tu(a));const s=(e.path||"").split("/");let u=a,l=1,c=s.length,f,p,h;for(typeof t=="function"?h=t:h=EE;;){if(p=s[l],p&&p.indexOf("~")!=-1&&(p=PK(p)),n&&(p=="__proto__"||p=="prototype"&&l>0&&s[l-1]=="constructor"))throw new TypeError("JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(t&&f===void 0&&(u[p]===void 0?f=s.slice(0,l).join("/"):l==c-1&&(f=e.path),f!==void 0&&h(e,0,a,f)),l++,Array.isArray(u)){if(p==="-")p=u.length;else{if(t&&!wE(p))throw new ht("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",i,e,a);wE(p)&&(p=~~p)}if(l>=c){if(t&&e.op==="add"&&p>u.length)throw new ht("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",i,e,a);const y=TK[e.op].call(e,u,p,a);if(y.test===!1)throw new ht("Test operation failed","TEST_OPERATION_FAILED",i,e,a);return y}}else if(l>=c){const y=rf[e.op].call(e,u,p,a);if(y.test===!1)throw new ht("Test operation failed","TEST_OPERATION_FAILED",i,e,a);return y}if(u=u[p],t&&l<c&&(!u||typeof u!="object"))throw new ht("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",i,e,a)}}}function Iy(a,e,t,r=!0,n=!0){if(t&&!Array.isArray(e))throw new ht("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");r||(a=tu(a));const i=new Array(e.length);for(let o=0,s=e.length;o<s;o++)i[o]=ep(a,e[o],t,!0,n,o),a=i[o].newDocument;return i.newDocument=a,i}function EE(a,e,t,r){if(typeof a!="object"||a===null||Array.isArray(a))throw new ht("Operation is not an object","OPERATION_NOT_AN_OBJECT",e,a,t);if(rf[a.op]){if(typeof a.path!="string")throw new ht("Operation `path` property is not a string","OPERATION_PATH_INVALID",e,a,t);if(a.path.indexOf("/")!==0&&a.path.length>0)throw new ht('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",e,a,t);if((a.op==="move"||a.op==="copy")&&typeof a.from!="string")throw new ht("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",e,a,t);if((a.op==="add"||a.op==="replace"||a.op==="test")&&a.value===void 0)throw new ht("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",e,a,t);if((a.op==="add"||a.op==="replace"||a.op==="test")&&OE(a.value))throw new ht("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",e,a,t);if(t){if(a.op=="add"){var n=a.path.split("/").length,i=r.split("/").length;if(n!==i+1&&n!==i)throw new ht("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",e,a,t)}else if(a.op==="replace"||a.op==="remove"||a.op==="_get"){if(a.path!==r)throw new ht("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",e,a,t)}else if(a.op==="move"||a.op==="copy"){var o={op:"_get",path:a.from,value:void 0},s=MK([o],t);if(s&&s.name==="OPERATION_PATH_UNRESOLVABLE")throw new ht("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",e,a,t)}}}else throw new ht("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",e,a,t)}function MK(a,e,t){try{if(!Array.isArray(a))throw new ht("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(e)Iy(tu(e),tu(a),t||!0);else{t=t||EE;for(var r=0;r<a.length;r++)t(a[r],r,e,void 0)}}catch(n){if(n instanceof ht)return n;throw n}}function Dy(a,e){if(a===e)return!0;if(a&&e&&typeof a=="object"&&typeof e=="object"){var t=Array.isArray(a),r=Array.isArray(e),n,i,o;if(t&&r){if(i=a.length,i!=e.length)return!1;for(n=i;n--!==0;)if(!Dy(a[n],e[n]))return!1;return!0}if(t!=r)return!1;var s=Object.keys(a);if(i=s.length,i!==Object.keys(e).length)return!1;for(n=i;n--!==0;)if(!e.hasOwnProperty(s[n]))return!1;for(n=i;n--!==0;)if(o=s[n],!Dy(a[o],e[o]))return!1;return!0}return a!==a&&e!==e}/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2013-2021 Joachim Wester
 * MIT license
 */function X4(a,e,t,r,n){if(e!==a){typeof e.toJSON=="function"&&(e=e.toJSON());for(var i=vE(e),o=vE(a),s=!1,u=o.length-1;u>=0;u--){var l=o[u],c=a[l];if(gE(e,l)&&!(e[l]===void 0&&c!==void 0&&Array.isArray(e)===!1)){var f=e[l];typeof c=="object"&&c!=null&&typeof f=="object"&&f!=null&&Array.isArray(c)===Array.isArray(f)?X4(c,f,t,r+"/"+Bc(l),n):c!==f&&(n&&t.push({op:"test",path:r+"/"+Bc(l),value:tu(c)}),t.push({op:"replace",path:r+"/"+Bc(l),value:tu(f)}))}else Array.isArray(a)===Array.isArray(e)?(n&&t.push({op:"test",path:r+"/"+Bc(l),value:tu(c)}),t.push({op:"remove",path:r+"/"+Bc(l)}),s=!0):(n&&t.push({op:"test",path:r,value:a}),t.push({op:"replace",path:r,value:e}))}if(!(!s&&i.length==o.length))for(var u=0;u<i.length;u++){var l=i[u];!gE(a,l)&&e[l]!==void 0&&t.push({op:"add",path:r+"/"+Bc(l),value:tu(e[l])})}}}function AK(a,e,t=!1){var r=[];return X4(a,e,r,"",t),r}class IK{getStore(){}run(e,t){return t()}enterWith(e){}}const DK=new IK,Dj=Symbol.for("lc:child_config");class xK{getInstance(){return fp()??DK}getRunnableConfig(){var t,r;return(r=(t=this.getInstance().getStore())==null?void 0:t.extra)==null?void 0:r[Dj]}runWithConfig(e,t,r){var c;const n=Ot._configureSync(e==null?void 0:e.callbacks,void 0,e==null?void 0:e.tags,void 0,e==null?void 0:e.metadata),i=this.getInstance(),o=i.getStore(),s=n==null?void 0:n.getParentRunId(),u=(c=n==null?void 0:n.handlers)==null?void 0:c.find(f=>(f==null?void 0:f.name)==="langchain_tracer");let l;return u&&s?l=u.convertToRunTree(s):r||(l=new br({name:"<runnable_lambda>",tracingEnabled:!1})),l&&(l.extra={...l.extra,[Dj]:e}),o!==void 0&&o[iy]!==void 0&&(l===void 0&&(l={}),l[iy]=o[iy]),i.run(l,t)}initializeGlobalInstance(e){fp()===void 0&&sW(e)}}const Xu=new xK,cg=25;async function Gs(a){return Ot._configureSync(a==null?void 0:a.callbacks,void 0,a==null?void 0:a.tags,void 0,a==null?void 0:a.metadata)}function xj(...a){const e={};for(const t of a.filter(r=>!!r))for(const r of Object.keys(t))if(r==="metadata")e[r]={...e[r],...t[r]};else if(r==="tags"){const n=e[r]??[];e[r]=[...new Set(n.concat(t[r]??[]))]}else if(r==="configurable")e[r]={...e[r],...t[r]};else if(r==="timeout")e.timeout===void 0?e.timeout=t.timeout:t.timeout!==void 0&&(e.timeout=Math.min(e.timeout,t.timeout));else if(r==="signal")e.signal===void 0?e.signal=t.signal:t.signal!==void 0&&("any"in AbortSignal?e.signal=AbortSignal.any([e.signal,t.signal]):e.signal=t.signal);else if(r==="callbacks"){const n=e.callbacks,i=t.callbacks;if(Array.isArray(i))if(!n)e.callbacks=i;else if(Array.isArray(n))e.callbacks=n.concat(i);else{const o=n.copy();for(const s of i)o.addHandler(Ey(s),!0);e.callbacks=o}else if(i)if(!n)e.callbacks=i;else if(Array.isArray(n)){const o=i.copy();for(const s of n)o.addHandler(Ey(s),!0);e.callbacks=o}else e.callbacks=new Ot(i._parentRunId,{handlers:n.handlers.concat(i.handlers),inheritableHandlers:n.inheritableHandlers.concat(i.inheritableHandlers),tags:Array.from(new Set(n.tags.concat(i.tags))),inheritableTags:Array.from(new Set(n.inheritableTags.concat(i.inheritableTags))),metadata:{...n.metadata,...i.metadata}})}else{const n=r;e[n]=t[n]??e[n]}return e}const $K=new Set(["string","number","boolean"]);function ke(a){var r;const e=Xu.getRunnableConfig();let t={tags:[],metadata:{},recursionLimit:25,runId:void 0};if(e){const{runId:n,runName:i,...o}=e;t=Object.entries(o).reduce((s,[u,l])=>(l!==void 0&&(s[u]=l),s),t)}if(a&&(t=Object.entries(a).reduce((n,[i,o])=>(o!==void 0&&(n[i]=o),n),t)),t!=null&&t.configurable)for(const n of Object.keys(t.configurable))$K.has(typeof t.configurable[n])&&!((r=t.metadata)!=null&&r[n])&&(t.metadata||(t.metadata={}),t.metadata[n]=t.configurable[n]);if(t.timeout!==void 0){if(t.timeout<=0)throw new Error("Timeout must be a positive number");const n=AbortSignal.timeout(t.timeout);t.signal!==void 0?"any"in AbortSignal&&(t.signal=AbortSignal.any([t.signal,n])):t.signal=n,delete t.timeout}return t}function $t(a={},{callbacks:e,maxConcurrency:t,recursionLimit:r,runName:n,configurable:i,runId:o}={}){const s=ke(a);return e!==void 0&&(delete s.runName,s.callbacks=e),r!==void 0&&(s.recursionLimit=r),t!==void 0&&(s.maxConcurrency=t),n!==void 0&&(s.runName=n),i!==void 0&&(s.configurable={...s.configurable,...i}),o!==void 0&&delete s.runId,s}function Rf(a){return a?{configurable:a.configurable,recursionLimit:a.recursionLimit,callbacks:a.callbacks,tags:a.tags,metadata:a.metadata,maxConcurrency:a.maxConcurrency,timeout:a.timeout,signal:a.signal}:void 0}async function Zu(a,e){if(e===void 0)return a;let t;return Promise.race([a.catch(r=>{if(!(e!=null&&e.aborted))throw r}),new Promise((r,n)=>{t=()=>{n(new Error("Aborted"))},e.addEventListener("abort",t),e.aborted&&n(new Error("Aborted"))})]).finally(()=>e.removeEventListener("abort",t))}class ir extends ReadableStream{constructor(){super(...arguments),Object.defineProperty(this,"reader",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}ensureReader(){this.reader||(this.reader=this.getReader())}async next(){this.ensureReader();try{const e=await this.reader.read();return e.done?(this.reader.releaseLock(),{done:!0,value:void 0}):{done:!1,value:e.value}}catch(e){throw this.reader.releaseLock(),e}}async return(){if(this.ensureReader(),this.locked){const e=this.reader.cancel();this.reader.releaseLock(),await e}return{done:!0,value:void 0}}async throw(e){if(this.ensureReader(),this.locked){const t=this.reader.cancel();this.reader.releaseLock(),await t}throw e}[Symbol.asyncIterator](){return this}async[Symbol.asyncDispose](){await this.return()}static fromReadableStream(e){const t=e.getReader();return new ir({start(r){return n();function n(){return t.read().then(({done:i,value:o})=>{if(i){r.close();return}return r.enqueue(o),n()})}},cancel(){t.releaseLock()}})}static fromAsyncGenerator(e){return new ir({async pull(t){const{value:r,done:n}=await e.next();n&&t.close(),t.enqueue(r)},async cancel(t){await e.return(t)}})}}function Z4(a,e=2){const t=Array.from({length:e},()=>[]);return t.map(async function*(n){for(;;)if(n.length===0){const i=await a.next();for(const o of t)o.push(i)}else{if(n[0].done)return;yield n.shift().value}})}function Dr(a,e){if(Array.isArray(a)&&Array.isArray(e))return a.concat(e);if(typeof a=="string"&&typeof e=="string")return a+e;if(typeof a=="number"&&typeof e=="number")return a+e;if("concat"in a&&typeof a.concat=="function")return a.concat(e);if(typeof a=="object"&&typeof e=="object"){const t={...a};for(const[r,n]of Object.entries(e))r in t&&!Array.isArray(t[r])?t[r]=Dr(t[r],n):t[r]=n;return t}else throw new Error(`Cannot concat ${typeof a} and ${typeof e}`)}class xf{constructor(e){var t;Object.defineProperty(this,"generator",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"setup",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"signal",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"firstResult",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"firstResultUsed",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this.generator=e.generator,this.config=e.config,this.signal=e.signal??((t=this.config)==null?void 0:t.signal),this.setup=new Promise((r,n)=>{Xu.runWithConfig(Rf(e.config),async()=>{this.firstResult=e.generator.next(),e.startSetup?this.firstResult.then(e.startSetup).then(r,n):this.firstResult.then(i=>r(void 0),n)},!0)})}async next(...e){var t;return(t=this.signal)==null||t.throwIfAborted(),this.firstResultUsed?Xu.runWithConfig(Rf(this.config),this.signal?async()=>Zu(this.generator.next(...e),this.signal):async()=>this.generator.next(...e),!0):(this.firstResultUsed=!0,this.firstResult)}async return(e){return this.generator.return(e)}async throw(e){return this.generator.throw(e)}[Symbol.asyncIterator](){return this}async[Symbol.asyncDispose](){await this.return()}}async function NK(a,e,t,r,...n){const i=new xf({generator:e,startSetup:t,signal:r}),o=await i.setup;return{output:a(i,o,...n),setup:o}}class Nu{constructor(e){Object.defineProperty(this,"ops",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.ops=e.ops??[]}concat(e){const t=this.ops.concat(e.ops),r=Iy({},t);return new Rp({ops:t,state:r[r.length-1].newDocument})}}class Rp extends Nu{constructor(e){super(e),Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.state=e.state}concat(e){const t=this.ops.concat(e.ops),r=Iy(this.state,e.ops);return new Rp({ops:t,state:r[r.length-1].newDocument})}static fromRunLogPatch(e){const t=Iy({},e.ops);return new Rp({ops:e.ops,state:t[t.length-1].newDocument})}}const qK=a=>a.name==="log_stream_tracer";async function $j(a,e){if(e==="original")throw new Error("Do not assign inputs with original schema drop the key for now. When inputs are added to streamLog they should be added with standardized schema for streaming events.");const{inputs:t}=a;if(["retriever","llm","prompt"].includes(a.run_type))return t;if(!(Object.keys(t).length===1&&(t==null?void 0:t.input)===""))return t.input}async function Nj(a,e){const{outputs:t}=a;return e==="original"||["retriever","llm","prompt"].includes(a.run_type)?t:t!==void 0&&Object.keys(t).length===1&&(t==null?void 0:t.output)!==void 0?t.output:t}function zK(a){return a!==void 0&&a.message!==void 0}class qj extends zp{constructor(e){super({_awaitHandler:!0,...e}),Object.defineProperty(this,"autoClose",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"includeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_schemaFormat",{enumerable:!0,configurable:!0,writable:!0,value:"original"}),Object.defineProperty(this,"rootId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"keyMapByRunId",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"counterMapByRunName",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"transformStream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"writer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"receiveStream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"log_stream_tracer"}),Object.defineProperty(this,"lc_prefer_streaming",{enumerable:!0,configurable:!0,writable:!0,value:!0}),this.autoClose=(e==null?void 0:e.autoClose)??!0,this.includeNames=e==null?void 0:e.includeNames,this.includeTypes=e==null?void 0:e.includeTypes,this.includeTags=e==null?void 0:e.includeTags,this.excludeNames=e==null?void 0:e.excludeNames,this.excludeTypes=e==null?void 0:e.excludeTypes,this.excludeTags=e==null?void 0:e.excludeTags,this._schemaFormat=(e==null?void 0:e._schemaFormat)??this._schemaFormat,this.transformStream=new TransformStream,this.writer=this.transformStream.writable.getWriter(),this.receiveStream=ir.fromReadableStream(this.transformStream.readable)}[Symbol.asyncIterator](){return this.receiveStream}async persistRun(e){}_includeRun(e){if(e.id===this.rootId)return!1;const t=e.tags??[];let r=this.includeNames===void 0&&this.includeTags===void 0&&this.includeTypes===void 0;return this.includeNames!==void 0&&(r=r||this.includeNames.includes(e.name)),this.includeTypes!==void 0&&(r=r||this.includeTypes.includes(e.run_type)),this.includeTags!==void 0&&(r=r||t.find(n=>{var i;return(i=this.includeTags)==null?void 0:i.includes(n)})!==void 0),this.excludeNames!==void 0&&(r=r&&!this.excludeNames.includes(e.name)),this.excludeTypes!==void 0&&(r=r&&!this.excludeTypes.includes(e.run_type)),this.excludeTags!==void 0&&(r=r&&t.every(n=>{var i;return!((i=this.excludeTags)!=null&&i.includes(n))})),r}async*tapOutputIterable(e,t){for await(const r of t){if(e!==this.rootId){const n=this.keyMapByRunId[e];n&&await this.writer.write(new Nu({ops:[{op:"add",path:`/logs/${n}/streamed_output/-`,value:r}]}))}yield r}}async onRunCreate(e){var n;if(this.rootId===void 0&&(this.rootId=e.id,await this.writer.write(new Nu({ops:[{op:"replace",path:"",value:{id:e.id,name:e.name,type:e.run_type,streamed_output:[],final_output:void 0,logs:{}}}]}))),!this._includeRun(e))return;this.counterMapByRunName[e.name]===void 0&&(this.counterMapByRunName[e.name]=0),this.counterMapByRunName[e.name]+=1;const t=this.counterMapByRunName[e.name];this.keyMapByRunId[e.id]=t===1?e.name:`${e.name}:${t}`;const r={id:e.id,name:e.name,type:e.run_type,tags:e.tags??[],metadata:((n=e.extra)==null?void 0:n.metadata)??{},start_time:new Date(e.start_time).toISOString(),streamed_output:[],streamed_output_str:[],final_output:void 0,end_time:void 0};this._schemaFormat==="streaming_events"&&(r.inputs=await $j(e,this._schemaFormat)),await this.writer.write(new Nu({ops:[{op:"add",path:`/logs/${this.keyMapByRunId[e.id]}`,value:r}]}))}async onRunUpdate(e){try{const t=this.keyMapByRunId[e.id];if(t===void 0)return;const r=[];this._schemaFormat==="streaming_events"&&r.push({op:"replace",path:`/logs/${t}/inputs`,value:await $j(e,this._schemaFormat)}),r.push({op:"add",path:`/logs/${t}/final_output`,value:await Nj(e,this._schemaFormat)}),e.end_time!==void 0&&r.push({op:"add",path:`/logs/${t}/end_time`,value:new Date(e.end_time).toISOString()});const n=new Nu({ops:r});await this.writer.write(n)}finally{if(e.id===this.rootId){const t=new Nu({ops:[{op:"replace",path:"/final_output",value:await Nj(e,this._schemaFormat)}]});await this.writer.write(t),this.autoClose&&await this.writer.close()}}}async onLLMNewToken(e,t,r){const n=this.keyMapByRunId[e.id];if(n===void 0)return;const i=e.inputs.messages!==void 0;let o;i?zK(r==null?void 0:r.chunk)?o=r==null?void 0:r.chunk:o=new it({id:`run-${e.id}`,content:t}):o=t;const s=new Nu({ops:[{op:"add",path:`/logs/${n}/streamed_output_str/-`,value:t},{op:"add",path:`/logs/${n}/streamed_output/-`,value:o}]});await this.writer.write(s)}}const xy="__run";class Ru{constructor(e){Object.defineProperty(this,"text",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"generationInfo",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.text=e.text,this.generationInfo=e.generationInfo}concat(e){return new Ru({text:this.text+e.text,generationInfo:{...this.generationInfo,...e.generationInfo}})}}class rr extends Ru{constructor(e){super(e),Object.defineProperty(this,"message",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.message=e.message}concat(e){return new rr({text:this.text+e.text,generationInfo:{...this.generationInfo,...e.generationInfo},message:this.message.concat(e.message)})}}function m_({name:a,serialized:e}){return a!==void 0?a:(e==null?void 0:e.name)!==void 0?e.name:(e==null?void 0:e.id)!==void 0&&Array.isArray(e==null?void 0:e.id)?e.id[e.id.length-1]:"Unnamed"}const BK=a=>a.name==="event_stream_tracer";class UK extends zp{constructor(e){super({_awaitHandler:!0,...e}),Object.defineProperty(this,"autoClose",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"includeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"runInfoMap",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"tappedPromises",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"transformStream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"writer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"receiveStream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"event_stream_tracer"}),Object.defineProperty(this,"lc_prefer_streaming",{enumerable:!0,configurable:!0,writable:!0,value:!0}),this.autoClose=(e==null?void 0:e.autoClose)??!0,this.includeNames=e==null?void 0:e.includeNames,this.includeTypes=e==null?void 0:e.includeTypes,this.includeTags=e==null?void 0:e.includeTags,this.excludeNames=e==null?void 0:e.excludeNames,this.excludeTypes=e==null?void 0:e.excludeTypes,this.excludeTags=e==null?void 0:e.excludeTags,this.transformStream=new TransformStream,this.writer=this.transformStream.writable.getWriter(),this.receiveStream=ir.fromReadableStream(this.transformStream.readable)}[Symbol.asyncIterator](){return this.receiveStream}async persistRun(e){}_includeRun(e){const t=e.tags??[];let r=this.includeNames===void 0&&this.includeTags===void 0&&this.includeTypes===void 0;return this.includeNames!==void 0&&(r=r||this.includeNames.includes(e.name)),this.includeTypes!==void 0&&(r=r||this.includeTypes.includes(e.runType)),this.includeTags!==void 0&&(r=r||t.find(n=>{var i;return(i=this.includeTags)==null?void 0:i.includes(n)})!==void 0),this.excludeNames!==void 0&&(r=r&&!this.excludeNames.includes(e.name)),this.excludeTypes!==void 0&&(r=r&&!this.excludeTypes.includes(e.runType)),this.excludeTags!==void 0&&(r=r&&t.every(n=>{var i;return!((i=this.excludeTags)!=null&&i.includes(n))})),r}async*tapOutputIterable(e,t){const r=await t.next();if(r.done)return;const n=this.runInfoMap.get(e);if(n===void 0){yield r.value;return}function i(s,u){return s==="llm"&&typeof u=="string"?new Ru({text:u}):u}let o=this.tappedPromises.get(e);if(o===void 0){let s;o=new Promise(u=>{s=u}),this.tappedPromises.set(e,o);try{const u={event:`on_${n.runType}_stream`,run_id:e,name:n.name,tags:n.tags,metadata:n.metadata,data:{}};await this.send({...u,data:{chunk:i(n.runType,r.value)}},n),yield r.value;for await(const l of t)n.runType!=="tool"&&n.runType!=="retriever"&&await this.send({...u,data:{chunk:i(n.runType,l)}},n),yield l}finally{s()}}else{yield r.value;for await(const s of t)yield s}}async send(e,t){this._includeRun(t)&&await this.writer.write(e)}async sendEndEvent(e,t){const r=this.tappedPromises.get(e.run_id);r!==void 0?r.then(()=>{this.send(e,t)}):await this.send(e,t)}async onLLMStart(e){var o,s;const t=m_(e),r=e.inputs.messages!==void 0?"chat_model":"llm",n={tags:e.tags??[],metadata:((o=e.extra)==null?void 0:o.metadata)??{},name:t,runType:r,inputs:e.inputs};this.runInfoMap.set(e.id,n);const i=`on_${r}_start`;await this.send({event:i,data:{input:e.inputs},name:t,tags:e.tags??[],run_id:e.id,metadata:((s=e.extra)==null?void 0:s.metadata)??{}},n)}async onLLMNewToken(e,t,r){const n=this.runInfoMap.get(e.id);let i,o;if(n===void 0)throw new Error(`onLLMNewToken: Run ID ${e.id} not found in run map.`);if(this.runInfoMap.size!==1){if(n.runType==="chat_model")o="on_chat_model_stream",(r==null?void 0:r.chunk)===void 0?i=new it({content:t,id:`run-${e.id}`}):i=r.chunk.message;else if(n.runType==="llm")o="on_llm_stream",(r==null?void 0:r.chunk)===void 0?i=new Ru({text:t}):i=r.chunk;else throw new Error(`Unexpected run type ${n.runType}`);await this.send({event:o,data:{chunk:i},run_id:e.id,name:n.name,tags:n.tags,metadata:n.metadata},n)}}async onLLMEnd(e){var o,s,u;const t=this.runInfoMap.get(e.id);this.runInfoMap.delete(e.id);let r;if(t===void 0)throw new Error(`onLLMEnd: Run ID ${e.id} not found in run map.`);const n=(o=e.outputs)==null?void 0:o.generations;let i;if(t.runType==="chat_model"){for(const l of n??[]){if(i!==void 0)break;i=(s=l[0])==null?void 0:s.message}r="on_chat_model_end"}else if(t.runType==="llm")i={generations:n==null?void 0:n.map(l=>l.map(c=>({text:c.text,generationInfo:c.generationInfo}))),llmOutput:((u=e.outputs)==null?void 0:u.llmOutput)??{}},r="on_llm_end";else throw new Error(`onLLMEnd: Unexpected run type: ${t.runType}`);await this.sendEndEvent({event:r,data:{output:i,input:t.inputs},run_id:e.id,name:t.name,tags:t.tags,metadata:t.metadata},t)}async onChainStart(e){var o,s;const t=m_(e),r=e.run_type??"chain",n={tags:e.tags??[],metadata:((o=e.extra)==null?void 0:o.metadata)??{},name:t,runType:e.run_type};let i={};e.inputs.input===""&&Object.keys(e.inputs).length===1?(i={},n.inputs={}):e.inputs.input!==void 0?(i.input=e.inputs.input,n.inputs=e.inputs.input):(i.input=e.inputs,n.inputs=e.inputs),this.runInfoMap.set(e.id,n),await this.send({event:`on_${r}_start`,data:i,name:t,tags:e.tags??[],run_id:e.id,metadata:((s=e.extra)==null?void 0:s.metadata)??{}},n)}async onChainEnd(e){var s;const t=this.runInfoMap.get(e.id);if(this.runInfoMap.delete(e.id),t===void 0)throw new Error(`onChainEnd: Run ID ${e.id} not found in run map.`);const r=`on_${e.run_type}_end`,n=e.inputs??t.inputs??{},o={output:((s=e.outputs)==null?void 0:s.output)??e.outputs,input:n};n.input&&Object.keys(n).length===1&&(o.input=n.input,t.inputs=n.input),await this.sendEndEvent({event:r,data:o,run_id:e.id,name:t.name,tags:t.tags,metadata:t.metadata??{}},t)}async onToolStart(e){var n,i;const t=m_(e),r={tags:e.tags??[],metadata:((n=e.extra)==null?void 0:n.metadata)??{},name:t,runType:"tool",inputs:e.inputs??{}};this.runInfoMap.set(e.id,r),await this.send({event:"on_tool_start",data:{input:e.inputs??{}},name:t,run_id:e.id,tags:e.tags??[],metadata:((i=e.extra)==null?void 0:i.metadata)??{}},r)}async onToolEnd(e){var n;const t=this.runInfoMap.get(e.id);if(this.runInfoMap.delete(e.id),t===void 0)throw new Error(`onToolEnd: Run ID ${e.id} not found in run map.`);if(t.inputs===void 0)throw new Error(`onToolEnd: Run ID ${e.id} is a tool call, and is expected to have traced inputs.`);const r=((n=e.outputs)==null?void 0:n.output)===void 0?e.outputs:e.outputs.output;await this.sendEndEvent({event:"on_tool_end",data:{output:r,input:t.inputs},run_id:e.id,name:t.name,tags:t.tags,metadata:t.metadata},t)}async onRetrieverStart(e){var i,o;const t=m_(e),n={tags:e.tags??[],metadata:((i=e.extra)==null?void 0:i.metadata)??{},name:t,runType:"retriever",inputs:{query:e.inputs.query}};this.runInfoMap.set(e.id,n),await this.send({event:"on_retriever_start",data:{input:{query:e.inputs.query}},name:t,tags:e.tags??[],run_id:e.id,metadata:((o=e.extra)==null?void 0:o.metadata)??{}},n)}async onRetrieverEnd(e){var r;const t=this.runInfoMap.get(e.id);if(this.runInfoMap.delete(e.id),t===void 0)throw new Error(`onRetrieverEnd: Run ID ${e.id} not found in run map.`);await this.sendEndEvent({event:"on_retriever_end",data:{output:((r=e.outputs)==null?void 0:r.documents)??e.outputs,input:t.inputs},run_id:e.id,name:t.name,tags:t.tags,metadata:t.metadata},t)}async handleCustomEvent(e,t,r){const n=this.runInfoMap.get(r);if(n===void 0)throw new Error(`handleCustomEvent: Run ID ${r} not found in run map.`);await this.send({event:"on_custom_event",run_id:r,name:e,tags:n.tags,metadata:n.metadata,data:t},n)}async finish(){const e=[...this.tappedPromises.values()];Promise.all(e).finally(()=>{this.writer.close()})}}const FK=[400,401,402,403,404,405,406,407,409],LK=a=>{var t,r;if(a.message.startsWith("Cancel")||a.message.startsWith("AbortError")||a.name==="AbortError"||(a==null?void 0:a.code)==="ECONNABORTED")throw a;const e=((t=a==null?void 0:a.response)==null?void 0:t.status)??(a==null?void 0:a.status);if(e&&FK.includes(+e))throw a;if(((r=a==null?void 0:a.error)==null?void 0:r.code)==="insufficient_quota"){const n=new Error(a==null?void 0:a.message);throw n.name="InsufficientQuotaError",n}};class Vp{constructor(e){Object.defineProperty(this,"maxConcurrency",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxRetries",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"onFailedAttempt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"queue",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxConcurrency=e.maxConcurrency??1/0,this.maxRetries=e.maxRetries??6,this.onFailedAttempt=e.onFailedAttempt??LK;const t="default"in Su?Su.default:Su;this.queue=new t({concurrency:this.maxConcurrency})}call(e,...t){return this.queue.add(()=>wy(()=>e(...t).catch(r=>{throw r instanceof Error?r:new Error(r)}),{onFailedAttempt:this.onFailedAttempt,retries:this.maxRetries,randomize:!0}),{throwOnTimeout:!0})}callWithOptions(e,t,...r){return e.signal?Promise.race([this.call(t,...r),new Promise((n,i)=>{var o;(o=e.signal)==null||o.addEventListener("abort",()=>{i(new Error("AbortError"))})})]):this.call(t,...r)}fetch(...e){return this.call(()=>fetch(...e).then(t=>t.ok?t:Promise.reject(t)))}}class Q4 extends zp{constructor({config:e,onStart:t,onEnd:r,onError:n}){super({_awaitHandler:!0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"RootListenersTracer"}),Object.defineProperty(this,"rootId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"argOnStart",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"argOnEnd",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"argOnError",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.config=e,this.argOnStart=t,this.argOnEnd=r,this.argOnError=n}persistRun(e){return Promise.resolve()}async onRunCreate(e){this.rootId||(this.rootId=e.id,this.argOnStart&&await this.argOnStart(e,this.config))}async onRunUpdate(e){e.id===this.rootId&&(e.error?this.argOnError&&await this.argOnError(e,this.config):this.argOnEnd&&await this.argOnEnd(e,this.config))}}function PR(a){return a?a.lc_runnable:!1}class VK{constructor(e){Object.defineProperty(this,"includeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.includeNames=e.includeNames,this.includeTypes=e.includeTypes,this.includeTags=e.includeTags,this.excludeNames=e.excludeNames,this.excludeTypes=e.excludeTypes,this.excludeTags=e.excludeTags}includeEvent(e,t){let r=this.includeNames===void 0&&this.includeTypes===void 0&&this.includeTags===void 0;const n=e.tags??[];return this.includeNames!==void 0&&(r=r||this.includeNames.includes(e.name)),this.includeTypes!==void 0&&(r=r||this.includeTypes.includes(t)),this.includeTags!==void 0&&(r=r||n.some(i=>{var o;return(o=this.includeTags)==null?void 0:o.includes(i)})),this.excludeNames!==void 0&&(r=r&&!this.excludeNames.includes(e.name)),this.excludeTypes!==void 0&&(r=r&&!this.excludeTypes.includes(t)),this.excludeTags!==void 0&&(r=r&&n.every(i=>{var o;return!((o=this.excludeTags)!=null&&o.includes(i))})),r}}const GK=Symbol("Let zodToJsonSchema decide on which parser to use"),kK={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"},HK=a=>({...kK,...a}),WK=a=>{const e=HK(a),t=e.name!==void 0?[...e.basePath,e.definitionPath,e.name]:e.basePath;return{...e,currentPath:t,propertyPath:void 0,seen:new Map(Object.entries(e.definitions).map(([r,n])=>[n._def,{def:n._def,path:[...e.basePath,e.definitionPath,r],jsonSchema:void 0}]))}};function Y4(a,e,t,r){r!=null&&r.errorMessages&&t&&(a.errorMessage={...a.errorMessage,[e]:t})}function Ze(a,e,t,r,n){a[e]=t,Y4(a,e,r,n)}function KK(){return{}}function JK(a,e){var r,n,i;const t={type:"array"};return(r=a.type)!=null&&r._def&&((i=(n=a.type)==null?void 0:n._def)==null?void 0:i.typeName)!==oe.ZodAny&&(t.items=Ke(a.type._def,{...e,currentPath:[...e.currentPath,"items"]})),a.minLength&&Ze(t,"minItems",a.minLength.value,a.minLength.message,e),a.maxLength&&Ze(t,"maxItems",a.maxLength.value,a.maxLength.message,e),a.exactLength&&(Ze(t,"minItems",a.exactLength.value,a.exactLength.message,e),Ze(t,"maxItems",a.exactLength.value,a.exactLength.message,e)),t}function XK(a,e){const t={type:"integer",format:"int64"};if(!a.checks)return t;for(const r of a.checks)switch(r.kind){case"min":e.target==="jsonSchema7"?r.inclusive?Ze(t,"minimum",r.value,r.message,e):Ze(t,"exclusiveMinimum",r.value,r.message,e):(r.inclusive||(t.exclusiveMinimum=!0),Ze(t,"minimum",r.value,r.message,e));break;case"max":e.target==="jsonSchema7"?r.inclusive?Ze(t,"maximum",r.value,r.message,e):Ze(t,"exclusiveMaximum",r.value,r.message,e):(r.inclusive||(t.exclusiveMaximum=!0),Ze(t,"maximum",r.value,r.message,e));break;case"multipleOf":Ze(t,"multipleOf",r.value,r.message,e);break}return t}function ZK(){return{type:"boolean"}}function eV(a,e){return Ke(a.type._def,e)}const QK=(a,e)=>Ke(a.innerType._def,e);function tV(a,e,t){const r=t??e.dateStrategy;if(Array.isArray(r))return{anyOf:r.map((n,i)=>tV(a,e,n))};switch(r){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return YK(a,e)}}const YK=(a,e)=>{const t={type:"integer",format:"unix-time"};if(e.target==="openApi3")return t;for(const r of a.checks)switch(r.kind){case"min":Ze(t,"minimum",r.value,r.message,e);break;case"max":Ze(t,"maximum",r.value,r.message,e);break}return t};function e2(a,e){return{...Ke(a.innerType._def,e),default:a.defaultValue()}}function t2(a,e){return e.effectStrategy==="input"?Ke(a.schema._def,e):{}}function r2(a){return{type:"string",enum:Array.from(a.values)}}const n2=a=>"type"in a&&a.type==="string"?!1:"allOf"in a;function i2(a,e){const t=[Ke(a.left._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),Ke(a.right._def,{...e,currentPath:[...e.currentPath,"allOf","1"]})].filter(i=>!!i);let r=e.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0;const n=[];return t.forEach(i=>{if(n2(i))n.push(...i.allOf),i.unevaluatedProperties===void 0&&(r=void 0);else{let o=i;if("additionalProperties"in i&&i.additionalProperties===!1){const{additionalProperties:s,...u}=i;o=u}else r=void 0;n.push(o)}}),n.length?{allOf:n,...r}:void 0}function a2(a,e){const t=typeof a.value;return t!=="bigint"&&t!=="number"&&t!=="boolean"&&t!=="string"?{type:Array.isArray(a.value)?"array":"object"}:e.target==="openApi3"?{type:t==="bigint"?"integer":t,enum:[a.value]}:{type:t==="bigint"?"integer":t,const:a.value}}let fg;const qr={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(fg===void 0&&(fg=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),fg),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv4Cidr:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,ipv6Cidr:/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,base64url:/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/,jwt:/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/};function rV(a,e){const t={type:"string"};if(a.checks)for(const r of a.checks)switch(r.kind){case"min":Ze(t,"minLength",typeof t.minLength=="number"?Math.max(t.minLength,r.value):r.value,r.message,e);break;case"max":Ze(t,"maxLength",typeof t.maxLength=="number"?Math.min(t.maxLength,r.value):r.value,r.message,e);break;case"email":switch(e.emailStrategy){case"format:email":zr(t,"email",r.message,e);break;case"format:idn-email":zr(t,"idn-email",r.message,e);break;case"pattern:zod":Ut(t,qr.email,r.message,e);break}break;case"url":zr(t,"uri",r.message,e);break;case"uuid":zr(t,"uuid",r.message,e);break;case"regex":Ut(t,r.regex,r.message,e);break;case"cuid":Ut(t,qr.cuid,r.message,e);break;case"cuid2":Ut(t,qr.cuid2,r.message,e);break;case"startsWith":Ut(t,RegExp(`^${dg(r.value,e)}`),r.message,e);break;case"endsWith":Ut(t,RegExp(`${dg(r.value,e)}$`),r.message,e);break;case"datetime":zr(t,"date-time",r.message,e);break;case"date":zr(t,"date",r.message,e);break;case"time":zr(t,"time",r.message,e);break;case"duration":zr(t,"duration",r.message,e);break;case"length":Ze(t,"minLength",typeof t.minLength=="number"?Math.max(t.minLength,r.value):r.value,r.message,e),Ze(t,"maxLength",typeof t.maxLength=="number"?Math.min(t.maxLength,r.value):r.value,r.message,e);break;case"includes":{Ut(t,RegExp(dg(r.value,e)),r.message,e);break}case"ip":{r.version!=="v6"&&zr(t,"ipv4",r.message,e),r.version!=="v4"&&zr(t,"ipv6",r.message,e);break}case"base64url":Ut(t,qr.base64url,r.message,e);break;case"jwt":Ut(t,qr.jwt,r.message,e);break;case"cidr":{r.version!=="v6"&&Ut(t,qr.ipv4Cidr,r.message,e),r.version!=="v4"&&Ut(t,qr.ipv6Cidr,r.message,e);break}case"emoji":Ut(t,qr.emoji(),r.message,e);break;case"ulid":{Ut(t,qr.ulid,r.message,e);break}case"base64":{switch(e.base64Strategy){case"format:binary":{zr(t,"binary",r.message,e);break}case"contentEncoding:base64":{Ze(t,"contentEncoding","base64",r.message,e);break}case"pattern:zod":{Ut(t,qr.base64,r.message,e);break}}break}case"nanoid":Ut(t,qr.nanoid,r.message,e)}return t}function dg(a,e){return e.patternStrategy==="escape"?s2(a):a}const o2=new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");function s2(a){let e="";for(let t=0;t<a.length;t++)o2.has(a[t])||(e+="\\"),e+=a[t];return e}function zr(a,e,t,r){var n;a.format||(n=a.anyOf)!=null&&n.some(i=>i.format)?(a.anyOf||(a.anyOf=[]),a.format&&(a.anyOf.push({format:a.format,...a.errorMessage&&r.errorMessages&&{errorMessage:{format:a.errorMessage.format}}}),delete a.format,a.errorMessage&&(delete a.errorMessage.format,Object.keys(a.errorMessage).length===0&&delete a.errorMessage)),a.anyOf.push({format:e,...t&&r.errorMessages&&{errorMessage:{format:t}}})):Ze(a,"format",e,t,r)}function Ut(a,e,t,r){var n;a.pattern||(n=a.allOf)!=null&&n.some(i=>i.pattern)?(a.allOf||(a.allOf=[]),a.pattern&&(a.allOf.push({pattern:a.pattern,...a.errorMessage&&r.errorMessages&&{errorMessage:{pattern:a.errorMessage.pattern}}}),delete a.pattern,a.errorMessage&&(delete a.errorMessage.pattern,Object.keys(a.errorMessage).length===0&&delete a.errorMessage)),a.allOf.push({pattern:zj(e,r),...t&&r.errorMessages&&{errorMessage:{pattern:t}}})):Ze(a,"pattern",zj(e,r),t,r)}function zj(a,e){var u;if(!e.applyRegexFlags||!a.flags)return a.source;const t={i:a.flags.includes("i"),m:a.flags.includes("m"),s:a.flags.includes("s")},r=t.i?a.source.toLowerCase():a.source;let n="",i=!1,o=!1,s=!1;for(let l=0;l<r.length;l++){if(i){n+=r[l],i=!1;continue}if(t.i){if(o){if(r[l].match(/[a-z]/)){s?(n+=r[l],n+=`${r[l-2]}-${r[l]}`.toUpperCase(),s=!1):r[l+1]==="-"&&((u=r[l+2])!=null&&u.match(/[a-z]/))?(n+=r[l],s=!0):n+=`${r[l]}${r[l].toUpperCase()}`;continue}}else if(r[l].match(/[a-z]/)){n+=`[${r[l]}${r[l].toUpperCase()}]`;continue}}if(t.m){if(r[l]==="^"){n+=`(^|(?<=[\r
]))`;continue}else if(r[l]==="$"){n+=`($|(?=[\r
]))`;continue}}if(t.s&&r[l]==="."){n+=o?`${r[l]}\r
`:`[${r[l]}\r
]`;continue}n+=r[l],r[l]==="\\"?i=!0:o&&r[l]==="]"?o=!1:!o&&r[l]==="["&&(o=!0)}try{new RegExp(n)}catch{return console.warn(`Could not convert regex pattern at ${e.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),a.source}return n}function nV(a,e){var r,n,i,o,s,u;if(e.target==="openAi"&&console.warn("Warning: OpenAI may not support records in schemas! Try an array of key-value pairs instead."),e.target==="openApi3"&&((r=a.keyType)==null?void 0:r._def.typeName)===oe.ZodEnum)return{type:"object",required:a.keyType._def.values,properties:a.keyType._def.values.reduce((l,c)=>({...l,[c]:Ke(a.valueType._def,{...e,currentPath:[...e.currentPath,"properties",c]})??{}}),{}),additionalProperties:!1};const t={type:"object",additionalProperties:Ke(a.valueType._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??{}};if(e.target==="openApi3")return t;if(((n=a.keyType)==null?void 0:n._def.typeName)===oe.ZodString&&((i=a.keyType._def.checks)!=null&&i.length)){const{type:l,...c}=rV(a.keyType._def,e);return{...t,propertyNames:c}}else{if(((o=a.keyType)==null?void 0:o._def.typeName)===oe.ZodEnum)return{...t,propertyNames:{enum:a.keyType._def.values}};if(((s=a.keyType)==null?void 0:s._def.typeName)===oe.ZodBranded&&a.keyType._def.type._def.typeName===oe.ZodString&&((u=a.keyType._def.type._def.checks)!=null&&u.length)){const{type:l,...c}=eV(a.keyType._def,e);return{...t,propertyNames:c}}}return t}function u2(a,e){if(e.mapStrategy==="record")return nV(a,e);const t=Ke(a.keyType._def,{...e,currentPath:[...e.currentPath,"items","items","0"]})||{},r=Ke(a.valueType._def,{...e,currentPath:[...e.currentPath,"items","items","1"]})||{};return{type:"array",maxItems:125,items:{type:"array",items:[t,r],minItems:2,maxItems:2}}}function l2(a){const e=a.values,r=Object.keys(a.values).filter(i=>typeof e[e[i]]!="number").map(i=>e[i]),n=Array.from(new Set(r.map(i=>typeof i)));return{type:n.length===1?n[0]==="string"?"string":"number":["string","number"],enum:r}}function c2(){return{not:{}}}function f2(a){return a.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}const $y={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function d2(a,e){if(e.target==="openApi3")return Bj(a,e);const t=a.options instanceof Map?Array.from(a.options.values()):a.options;if(t.every(r=>r._def.typeName in $y&&(!r._def.checks||!r._def.checks.length))){const r=t.reduce((n,i)=>{const o=$y[i._def.typeName];return o&&!n.includes(o)?[...n,o]:n},[]);return{type:r.length>1?r:r[0]}}else if(t.every(r=>r._def.typeName==="ZodLiteral"&&!r.description)){const r=t.reduce((n,i)=>{const o=typeof i._def.value;switch(o){case"string":case"number":case"boolean":return[...n,o];case"bigint":return[...n,"integer"];case"object":if(i._def.value===null)return[...n,"null"];case"symbol":case"undefined":case"function":default:return n}},[]);if(r.length===t.length){const n=r.filter((i,o,s)=>s.indexOf(i)===o);return{type:n.length>1?n:n[0],enum:t.reduce((i,o)=>i.includes(o._def.value)?i:[...i,o._def.value],[])}}}else if(t.every(r=>r._def.typeName==="ZodEnum"))return{type:"string",enum:t.reduce((r,n)=>[...r,...n._def.values.filter(i=>!r.includes(i))],[])};return Bj(a,e)}const Bj=(a,e)=>{const t=(a.options instanceof Map?Array.from(a.options.values()):a.options).map((r,n)=>Ke(r._def,{...e,currentPath:[...e.currentPath,"anyOf",`${n}`]})).filter(r=>!!r&&(!e.strictUnions||typeof r=="object"&&Object.keys(r).length>0));return t.length?{anyOf:t}:void 0};function h2(a,e){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(a.innerType._def.typeName)&&(!a.innerType._def.checks||!a.innerType._def.checks.length))return e.target==="openApi3"?{type:$y[a.innerType._def.typeName],nullable:!0}:{type:[$y[a.innerType._def.typeName],"null"]};if(e.target==="openApi3"){const r=Ke(a.innerType._def,{...e,currentPath:[...e.currentPath]});return r&&"$ref"in r?{allOf:[r],nullable:!0}:r&&{...r,nullable:!0}}const t=Ke(a.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","0"]});return t&&{anyOf:[t,{type:"null"}]}}function p2(a,e){const t={type:"number"};if(!a.checks)return t;for(const r of a.checks)switch(r.kind){case"int":t.type="integer",Y4(t,"type",r.message,e);break;case"min":e.target==="jsonSchema7"?r.inclusive?Ze(t,"minimum",r.value,r.message,e):Ze(t,"exclusiveMinimum",r.value,r.message,e):(r.inclusive||(t.exclusiveMinimum=!0),Ze(t,"minimum",r.value,r.message,e));break;case"max":e.target==="jsonSchema7"?r.inclusive?Ze(t,"maximum",r.value,r.message,e):Ze(t,"exclusiveMaximum",r.value,r.message,e):(r.inclusive||(t.exclusiveMaximum=!0),Ze(t,"maximum",r.value,r.message,e));break;case"multipleOf":Ze(t,"multipleOf",r.value,r.message,e);break}return t}function _2(a,e){return e.removeAdditionalStrategy==="strict"?a.catchall._def.typeName==="ZodNever"?a.unknownKeys!=="strict":Ke(a.catchall._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??!0:a.catchall._def.typeName==="ZodNever"?a.unknownKeys==="passthrough":Ke(a.catchall._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??!0}function y2(a,e){const t=e.target==="openAi",r={type:"object",...Object.entries(a.shape()).reduce((n,[i,o])=>{if(o===void 0||o._def===void 0)return n;let s=o.isOptional();s&&t&&(o instanceof Vs&&(o=o._def.innerType),o.isNullable()||(o=o.nullable()),s=!1);const u=Ke(o._def,{...e,currentPath:[...e.currentPath,"properties",i],propertyPath:[...e.currentPath,"properties",i]});return u===void 0?n:{properties:{...n.properties,[i]:u},required:s?n.required:[...n.required,i]}},{properties:{},required:[]}),additionalProperties:_2(a,e)};return r.required.length||delete r.required,r}const b2=(a,e)=>{var r;if(e.currentPath.toString()===((r=e.propertyPath)==null?void 0:r.toString()))return Ke(a.innerType._def,e);const t=Ke(a.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","1"]});return t?{anyOf:[{not:{}},t]}:{}},m2=(a,e)=>{if(e.pipeStrategy==="input")return Ke(a.in._def,e);if(e.pipeStrategy==="output")return Ke(a.out._def,e);const t=Ke(a.in._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),r=Ke(a.out._def,{...e,currentPath:[...e.currentPath,"allOf",t?"1":"0"]});return{allOf:[t,r].filter(n=>n!==void 0)}};function g2(a,e){return Ke(a.type._def,e)}function v2(a,e){const r={type:"array",uniqueItems:!0,items:Ke(a.valueType._def,{...e,currentPath:[...e.currentPath,"items"]})};return a.minSize&&Ze(r,"minItems",a.minSize.value,a.minSize.message,e),a.maxSize&&Ze(r,"maxItems",a.maxSize.value,a.maxSize.message,e),r}function w2(a,e){return a.rest?{type:"array",minItems:a.items.length,items:a.items.map((t,r)=>Ke(t._def,{...e,currentPath:[...e.currentPath,"items",`${r}`]})).reduce((t,r)=>r===void 0?t:[...t,r],[]),additionalItems:Ke(a.rest._def,{...e,currentPath:[...e.currentPath,"additionalItems"]})}:{type:"array",minItems:a.items.length,maxItems:a.items.length,items:a.items.map((t,r)=>Ke(t._def,{...e,currentPath:[...e.currentPath,"items",`${r}`]})).reduce((t,r)=>r===void 0?t:[...t,r],[])}}function O2(){return{not:{}}}function S2(){return{}}const E2=(a,e)=>Ke(a.innerType._def,e),R2=(a,e,t)=>{switch(e){case oe.ZodString:return rV(a,t);case oe.ZodNumber:return p2(a,t);case oe.ZodObject:return y2(a,t);case oe.ZodBigInt:return XK(a,t);case oe.ZodBoolean:return ZK();case oe.ZodDate:return tV(a,t);case oe.ZodUndefined:return O2();case oe.ZodNull:return f2(t);case oe.ZodArray:return JK(a,t);case oe.ZodUnion:case oe.ZodDiscriminatedUnion:return d2(a,t);case oe.ZodIntersection:return i2(a,t);case oe.ZodTuple:return w2(a,t);case oe.ZodRecord:return nV(a,t);case oe.ZodLiteral:return a2(a,t);case oe.ZodEnum:return r2(a);case oe.ZodNativeEnum:return l2(a);case oe.ZodNullable:return h2(a,t);case oe.ZodOptional:return b2(a,t);case oe.ZodMap:return u2(a,t);case oe.ZodSet:return v2(a,t);case oe.ZodLazy:return()=>a.getter()._def;case oe.ZodPromise:return g2(a,t);case oe.ZodNaN:case oe.ZodNever:return c2();case oe.ZodEffects:return t2(a,t);case oe.ZodAny:return KK();case oe.ZodUnknown:return S2();case oe.ZodDefault:return e2(a,t);case oe.ZodBranded:return eV(a,t);case oe.ZodReadonly:return E2(a,t);case oe.ZodCatch:return QK(a,t);case oe.ZodPipeline:return m2(a,t);case oe.ZodFunction:case oe.ZodVoid:case oe.ZodSymbol:return;default:return(r=>{})()}};function Ke(a,e,t=!1){var s;const r=e.seen.get(a);if(e.override){const u=(s=e.override)==null?void 0:s.call(e,a,e,r,t);if(u!==GK)return u}if(r&&!t){const u=C2(r,e);if(u!==void 0)return u}const n={def:a,path:e.currentPath,jsonSchema:void 0};e.seen.set(a,n);const i=R2(a,a.typeName,e),o=typeof i=="function"?Ke(i(),e):i;if(o&&j2(a,e,o),e.postProcess){const u=e.postProcess(o,a,e);return n.jsonSchema=o,u}return n.jsonSchema=o,o}const C2=(a,e)=>{switch(e.$refStrategy){case"root":return{$ref:a.path.join("/")};case"relative":return{$ref:P2(e.currentPath,a.path)};case"none":case"seen":return a.path.length<e.currentPath.length&&a.path.every((t,r)=>e.currentPath[r]===t)?(console.warn(`Recursive reference detected at ${e.currentPath.join("/")}! Defaulting to any`),{}):e.$refStrategy==="seen"?{}:void 0}},P2=(a,e)=>{let t=0;for(;t<a.length&&t<e.length&&a[t]===e[t];t++);return[(a.length-t).toString(),...e.slice(t)].join("/")},j2=(a,e,t)=>(a.description&&(t.description=a.description,e.markdownDescription&&(t.markdownDescription=a.description)),t),au=(a,e)=>{const t=WK(e),r=void 0,n=e==null?void 0:e.name,i=Ke(a._def,t,!1)??{},o=n===void 0?r?{...i,[t.definitionPath]:r}:i:{$ref:[...t.$refStrategy==="relative"?[]:t.basePath,t.definitionPath,n].join("/"),[t.definitionPath]:{...r,[n]:i}};return t.target==="jsonSchema7"?o.$schema="http://json-schema.org/draft-07/schema#":(t.target==="jsonSchema2019-09"||t.target==="openAi")&&(o.$schema="https://json-schema.org/draft/2019-09/schema#"),t.target==="openAi"&&("anyOf"in o||"oneOf"in o||"allOf"in o||"type"in o&&Array.isArray(o.type))&&console.warn("Warning: OpenAI may not support schemas with unions as roots! Try wrapping it in an object property."),o};function hg(a){return a.replace(/[^a-zA-Z-_0-9]/g,"_")}const T2=["*","_","`"];function M2(a){let e="";for(const[t,r]of Object.entries(a))e+=`	classDef ${t} ${r};
`;return e}function A2(a,e,t){const{firstNode:r,lastNode:n,nodeColors:i,withStyles:o=!0,curveStyle:s="linear",wrapLabelNWords:u=9}=t??{};let l=o?`%%{init: {'flowchart': {'curve': '${s}'}}}%%
graph TD;
`:`graph TD;
`;if(o){const h="default",y={[h]:"{0}({1})"};r!==void 0&&(y[r]="{0}([{1}]):::first"),n!==void 0&&(y[n]="{0}([{1}]):::last");for(const[d,_]of Object.entries(a)){const m=_.name.split(":").pop()??"";let g=T2.some(w=>m.startsWith(w)&&m.endsWith(w))?`<p>${m}</p>`:m;Object.keys(_.metadata??{}).length&&(g+=`<hr/><small><em>${Object.entries(_.metadata??{}).map(([w,S])=>`${w} = ${S}`).join(`
`)}</em></small>`);const v=(y[d]??y[h]).replace("{0}",hg(d)).replace("{1}",g);l+=`	${v}
`}}const c={};for(const h of e){const y=h.source.split(":"),d=h.target.split(":"),_=y.filter((m,b)=>m===d[b]).join(":");c[_]||(c[_]=[]),c[_].push(h)}const f=new Set;function p(h,y){const d=h.length===1&&h[0].source===h[0].target;if(y&&!d){const _=y.split(":").pop();if(f.has(_))throw new Error(`Found duplicate subgraph '${_}' -- this likely means that you're reusing a subgraph node with the same name. Please adjust your graph to have subgraph nodes with unique names.`);f.add(_),l+=`	subgraph ${_}
`}for(const _ of h){const{source:m,target:b,data:g,conditional:v}=_;let w="";if(g!==void 0){let S=g;const R=S.split(" ");R.length>u&&(S=Array.from({length:Math.ceil(R.length/u)},(P,C)=>R.slice(C*u,(C+1)*u).join(" ")).join("&nbsp;<br>&nbsp;")),w=v?` -. &nbsp;${S}&nbsp; .-> `:` -- &nbsp;${S}&nbsp; --> `}else w=v?" -.-> ":" --> ";l+=`	${hg(m)}${w}${hg(b)};
`}for(const _ in c)_.startsWith(`${y}:`)&&_!==y&&p(c[_],_);y&&!d&&(l+=`	end
`)}p(c[""]??[],"");for(const h in c)!h.includes(":")&&h!==""&&p(c[h],h);return o&&(l+=M2(i??{})),l}async function I2(a,e){let{backgroundColor:t="white"}=e??{};const r=btoa(a);t!==void 0&&(/^#(?:[0-9a-fA-F]{3}){1,2}$/.test(t)||(t=`!${t}`));const n=`https://mermaid.ink/img/${r}?bgColor=${t}`,i=await fetch(n);if(!i.ok)throw new Error(["Failed to render the graph using the Mermaid.INK API.",`Status code: ${i.status}`,`Status text: ${i.statusText}`].join(`
`));return await i.blob()}function D2(a,e){if(a!==void 0&&!Xh(a))return a;if(PR(e))try{let t=e.getName();return t=t.startsWith("Runnable")?t.slice(8):t,t}catch{return e.getName()}else return e.name??"UnknownSchema"}function x2(a){return PR(a.data)?{type:"runnable",data:{id:a.data.lc_id,name:a.data.getName()}}:{type:"schema",data:{...au(a.data.schema),title:a.data.name}}}class pb{constructor(e){Object.defineProperty(this,"nodes",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"edges",{enumerable:!0,configurable:!0,writable:!0,value:[]}),this.nodes=(e==null?void 0:e.nodes)??this.nodes,this.edges=(e==null?void 0:e.edges)??this.edges}toJSON(){const e={};return Object.values(this.nodes).forEach((t,r)=>{e[t.id]=Xh(t.id)?r:t.id}),{nodes:Object.values(this.nodes).map(t=>({id:e[t.id],...x2(t)})),edges:this.edges.map(t=>{const r={source:e[t.source],target:e[t.target]};return typeof t.data<"u"&&(r.data=t.data),typeof t.conditional<"u"&&(r.conditional=t.conditional),r})}}addNode(e,t,r){if(t!==void 0&&this.nodes[t]!==void 0)throw new Error(`Node with id ${t} already exists`);const n=t??xt(),i={id:n,data:e,name:D2(t,e),metadata:r};return this.nodes[n]=i,i}removeNode(e){delete this.nodes[e.id],this.edges=this.edges.filter(t=>t.source!==e.id&&t.target!==e.id)}addEdge(e,t,r,n){if(this.nodes[e.id]===void 0)throw new Error(`Source node ${e.id} not in graph`);if(this.nodes[t.id]===void 0)throw new Error(`Target node ${t.id} not in graph`);const i={source:e.id,target:t.id,data:r,conditional:n};return this.edges.push(i),i}firstNode(){return Uj(this)}lastNode(){return Fj(this)}extend(e,t=""){let r=t;Object.values(e.nodes).map(l=>l.id).every(Xh)&&(r="");const i=l=>r?`${r}:${l}`:l;Object.entries(e.nodes).forEach(([l,c])=>{this.nodes[i(l)]={...c,id:i(l)}});const o=e.edges.map(l=>({...l,source:i(l.source),target:i(l.target)}));this.edges=[...this.edges,...o];const s=e.firstNode(),u=e.lastNode();return[s?{id:i(s.id),data:s.data}:void 0,u?{id:i(u.id),data:u.data}:void 0]}trimFirstNode(){const e=this.firstNode();e&&Uj(this,[e.id])&&this.removeNode(e)}trimLastNode(){const e=this.lastNode();e&&Fj(this,[e.id])&&this.removeNode(e)}reid(){const e=Object.fromEntries(Object.values(this.nodes).map(n=>[n.id,n.name])),t=new Map;Object.values(e).forEach(n=>{t.set(n,(t.get(n)||0)+1)});const r=n=>{const i=e[n];return Xh(n)&&t.get(i)===1?i:n};return new pb({nodes:Object.fromEntries(Object.entries(this.nodes).map(([n,i])=>[r(n),{...i,id:r(n)}])),edges:this.edges.map(n=>({...n,source:r(n.source),target:r(n.target)}))})}drawMermaid(e){const{withStyles:t,curveStyle:r,nodeColors:n={default:"fill:#f2f0ff,line-height:1.2",first:"fill-opacity:0",last:"fill:#bfb6fc"},wrapLabelNWords:i}=e??{},o=this.reid(),s=o.firstNode(),u=o.lastNode();return A2(o.nodes,o.edges,{firstNode:s==null?void 0:s.id,lastNode:u==null?void 0:u.id,withStyles:t,curveStyle:r,nodeColors:n,wrapLabelNWords:i})}async drawMermaidPng(e){const t=this.drawMermaid(e);return I2(t,{backgroundColor:e==null?void 0:e.backgroundColor})}}function Uj(a,e=[]){const t=new Set(a.edges.filter(n=>!e.includes(n.source)).map(n=>n.target)),r=[];for(const n of Object.values(a.nodes))!e.includes(n.id)&&!t.has(n.id)&&r.push(n);return r.length===1?r[0]:void 0}function Fj(a,e=[]){const t=new Set(a.edges.filter(n=>!e.includes(n.target)).map(n=>n.source)),r=[];for(const n of Object.values(a.nodes))!e.includes(n.id)&&!t.has(n.id)&&r.push(n);return r.length===1?r[0]:void 0}function $2(a){const e=new TextEncoder,t=new ReadableStream({async start(r){for await(const n of a)r.enqueue(e.encode(`event: data
data: ${JSON.stringify(n)}

`));r.enqueue(e.encode(`event: end

`)),r.close()}});return ir.fromReadableStream(t)}function Lj(a){return typeof a=="object"&&a!==null&&typeof a[Symbol.iterator]=="function"&&typeof a.next=="function"}const N2=a=>a!=null&&typeof a=="object"&&"next"in a&&typeof a.next=="function";function RE(a){return typeof a=="object"&&a!==null&&typeof a[Symbol.asyncIterator]=="function"}function*Vj(a,e){for(;;){const{value:t,done:r}=Xu.runWithConfig(Rf(a),e.next.bind(e),!0);if(r)break;yield t}}async function*CE(a,e){const t=e[Symbol.asyncIterator]();for(;;){const{value:r,done:n}=await Xu.runWithConfig(Rf(a),t.next.bind(e),!0);if(n)break;yield r}}function wt(a,e){return a&&!Array.isArray(a)&&!(a instanceof Date)&&typeof a=="object"?a:{[e]:a}}class ct extends Gu{constructor(){super(...arguments),Object.defineProperty(this,"lc_runnable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}getName(e){const t=this.name??this.constructor.lc_name()??this.constructor.name;return e?`${t}${e}`:t}bind(e){return new Sc({bound:this,kwargs:e,config:{}})}map(){return new Ny({bound:this})}withRetry(e){return new q2({bound:this,kwargs:{},config:{},maxAttemptNumber:e==null?void 0:e.stopAfterAttempt,...e})}withConfig(e){return new Sc({bound:this,config:e,kwargs:{}})}withFallbacks(e){const t=Array.isArray(e)?e:e.fallbacks;return new B2({runnable:this,fallbacks:t})}_getOptionsList(e,t=0){if(Array.isArray(e)&&e.length!==t)throw new Error(`Passed "options" must be an array with the same length as the inputs, but got ${e.length} options for ${t} inputs`);if(Array.isArray(e))return e.map(ke);if(t>1&&!Array.isArray(e)&&e.runId){console.warn("Provided runId will be used only for the first element of the batch.");const r=Object.fromEntries(Object.entries(e).filter(([n])=>n!=="runId"));return Array.from({length:t},(n,i)=>ke(i===0?e:r))}return Array.from({length:t},()=>ke(e))}async batch(e,t,r){var u;const n=this._getOptionsList(t??{},e.length),i=((u=n[0])==null?void 0:u.maxConcurrency)??(r==null?void 0:r.maxConcurrency),o=new Vp({maxConcurrency:i,onFailedAttempt:l=>{throw l}}),s=e.map((l,c)=>o.call(async()=>{try{return await this.invoke(l,n[c])}catch(f){if(r!=null&&r.returnExceptions)return f;throw f}}));return Promise.all(s)}async*_streamIterator(e,t){yield this.invoke(e,t)}async stream(e,t){const r=ke(t),n=new xf({generator:this._streamIterator(e,r),config:r});return await n.setup,ir.fromAsyncGenerator(n)}_separateRunnableConfigFromCallOptions(e){let t;e===void 0?t=ke(e):t=ke({callbacks:e.callbacks,tags:e.tags,metadata:e.metadata,runName:e.runName,configurable:e.configurable,recursionLimit:e.recursionLimit,maxConcurrency:e.maxConcurrency,runId:e.runId,timeout:e.timeout,signal:e.signal});const r={...e};return delete r.callbacks,delete r.tags,delete r.metadata,delete r.runName,delete r.configurable,delete r.recursionLimit,delete r.maxConcurrency,delete r.runId,delete r.timeout,delete r.signal,[t,r]}async _callWithConfig(e,t,r){const n=ke(r),i=await Gs(n),o=await(i==null?void 0:i.handleChainStart(this.toJSON(),wt(t,"input"),n.runId,n==null?void 0:n.runType,void 0,void 0,(n==null?void 0:n.runName)??this.getName()));delete n.runId;let s;try{const u=e.call(this,t,n,o);s=await Zu(u,r==null?void 0:r.signal)}catch(u){throw await(o==null?void 0:o.handleChainError(u)),u}return await(o==null?void 0:o.handleChainEnd(wt(s,"output"))),s}async _batchWithConfig(e,t,r,n){var l;const i=this._getOptionsList(r??{},t.length),o=await Promise.all(i.map(Gs)),s=await Promise.all(o.map(async(c,f)=>{const p=await(c==null?void 0:c.handleChainStart(this.toJSON(),wt(t[f],"input"),i[f].runId,i[f].runType,void 0,void 0,i[f].runName??this.getName()));return delete i[f].runId,p}));let u;try{const c=e.call(this,t,i,s,n);u=await Zu(c,(l=i==null?void 0:i[0])==null?void 0:l.signal)}catch(c){throw await Promise.all(s.map(f=>f==null?void 0:f.handleChainError(c))),c}return await Promise.all(s.map(c=>c==null?void 0:c.handleChainEnd(wt(u,"output")))),u}async*_transformStreamWithConfig(e,t,r){let n,i=!0,o,s=!0;const u=ke(r),l=await Gs(u);async function*c(){for await(const p of e){if(i)if(n===void 0)n=p;else try{n=Dr(n,p)}catch{n=void 0,i=!1}yield p}}let f;try{const p=await NK(t.bind(this),c(),async()=>l==null?void 0:l.handleChainStart(this.toJSON(),{input:""},u.runId,u.runType,void 0,void 0,u.runName??this.getName()),r==null?void 0:r.signal,u);delete u.runId,f=p.setup;const h=f==null?void 0:f.handlers.find(BK);let y=p.output;h!==void 0&&f!==void 0&&(y=h.tapOutputIterable(f.runId,y));const d=f==null?void 0:f.handlers.find(qK);d!==void 0&&f!==void 0&&(y=d.tapOutputIterable(f.runId,y));for await(const _ of y)if(yield _,s)if(o===void 0)o=_;else try{o=Dr(o,_)}catch{o=void 0,s=!1}}catch(p){throw await(f==null?void 0:f.handleChainError(p,void 0,void 0,void 0,{inputs:wt(n,"input")})),p}await(f==null?void 0:f.handleChainEnd(o??{},void 0,void 0,void 0,{inputs:wt(n,"input")}))}getGraph(e){const t=new pb,r=t.addNode({name:`${this.getName()}Input`,schema:Oc.any()}),n=t.addNode(this),i=t.addNode({name:`${this.getName()}Output`,schema:Oc.any()});return t.addEdge(r,n),t.addEdge(n,i),t}pipe(e){return new mr({first:this,last:bc(e)})}pick(e){return this.pipe(new U2(e))}assign(e){return this.pipe(new iV(new $f({steps:e})))}async*transform(e,t){let r;for await(const n of e)r===void 0?r=n:r=Dr(r,n);yield*this._streamIterator(r,ke(t))}async*streamLog(e,t,r){const n=new qj({...r,autoClose:!1,_schemaFormat:"original"}),i=ke(t);yield*this._streamLog(e,n,i)}async*_streamLog(e,t,r){const{callbacks:n}=r;if(n===void 0)r.callbacks=[t];else if(Array.isArray(n))r.callbacks=n.concat([t]);else{const u=n.copy();u.addHandler(t,!0),r.callbacks=u}const i=this.stream(e,r);async function o(){try{const u=await i;for await(const l of u){const c=new Nu({ops:[{op:"add",path:"/streamed_output/-",value:l}]});await t.writer.write(c)}}finally{await t.writer.close()}}const s=o();try{for await(const u of t)yield u}finally{await s}}streamEvents(e,t,r){let n;if(t.version==="v1")n=this._streamEventsV1(e,t,r);else if(t.version==="v2")n=this._streamEventsV2(e,t,r);else throw new Error('Only versions "v1" and "v2" of the schema are currently supported.');return t.encoding==="text/event-stream"?$2(n):ir.fromAsyncGenerator(n)}async*_streamEventsV2(e,t,r){var y;const n=new UK({...r,autoClose:!1}),i=ke(t),o=i.runId??xt();i.runId=o;const s=i.callbacks;if(s===void 0)i.callbacks=[n];else if(Array.isArray(s))i.callbacks=s.concat(n);else{const d=s.copy();d.addHandler(n,!0),i.callbacks=d}const u=new AbortController,l=this;async function c(){try{let d;t!=null&&t.signal?"any"in AbortSignal?d=AbortSignal.any([u.signal,t.signal]):(d=t.signal,t.signal.addEventListener("abort",()=>{u.abort()},{once:!0})):d=u.signal;const _=await l.stream(e,{...i,signal:d}),m=n.tapOutputIterable(o,_);for await(const b of m)if(u.signal.aborted)break}finally{await n.finish()}}const f=c();let p=!1,h;try{for await(const d of n){if(!p){d.data.input=e,p=!0,h=d.run_id,yield d;continue}d.run_id===h&&d.event.endsWith("_end")&&(y=d.data)!=null&&y.input&&delete d.data.input,yield d}}finally{u.abort(),await f}}async*_streamEventsV1(e,t,r){let n,i=!1;const o=ke(t),s=o.tags??[],u=o.metadata??{},l=o.runName??this.getName(),c=new qj({...r,autoClose:!1,_schemaFormat:"streaming_events"}),f=new VK({...r}),p=this._streamLog(e,c,o);for await(const y of p){if(n?n=n.concat(y):n=Rp.fromRunLogPatch(y),n.state===void 0)throw new Error('Internal error: "streamEvents" state is missing. Please open a bug report.');if(!i){i=!0;const b={...n.state},g={run_id:b.id,event:`on_${b.type}_start`,name:l,tags:s,metadata:u,data:{input:e}};f.includeEvent(g,b.type)&&(yield g)}const d=y.ops.filter(b=>b.path.startsWith("/logs/")).map(b=>b.path.split("/")[2]),_=[...new Set(d)];for(const b of _){let g,v={};const w=n.state.logs[b];if(w.end_time===void 0?w.streamed_output.length>0?g="stream":g="start":g="end",g==="start")w.inputs!==void 0&&(v.input=w.inputs);else if(g==="end")w.inputs!==void 0&&(v.input=w.inputs),v.output=w.final_output;else if(g==="stream"){const S=w.streamed_output.length;if(S!==1)throw new Error(`Expected exactly one chunk of streamed output, got ${S} instead. Encountered in: "${w.name}"`);v={chunk:w.streamed_output[0]},w.streamed_output=[]}yield{event:`on_${w.type}_${g}`,name:w.name,run_id:w.id,tags:w.tags,metadata:w.metadata,data:v}}const{state:m}=n;if(m.streamed_output.length>0){const b=m.streamed_output.length;if(b!==1)throw new Error(`Expected exactly one chunk of streamed output, got ${b} instead. Encountered in: "${m.name}"`);const g={chunk:m.streamed_output[0]};m.streamed_output=[];const v={event:`on_${m.type}_stream`,run_id:m.id,tags:s,metadata:u,name:l,data:g};f.includeEvent(v,m.type)&&(yield v)}}const h=n==null?void 0:n.state;if(h!==void 0){const y={event:`on_${h.type}_end`,name:l,run_id:h.id,tags:s,metadata:u,data:{output:h.final_output}};f.includeEvent(y,h.type)&&(yield y)}}static isRunnable(e){return PR(e)}withListeners({onStart:e,onEnd:t,onError:r}){return new Sc({bound:this,config:{},configFactories:[n=>({callbacks:[new Q4({config:n,onStart:e,onEnd:t,onError:r})]})]})}asTool(e){return F2(this,e)}}class Sc extends ct{static lc_name(){return"RunnableBinding"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"bound",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"configFactories",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.bound=e.bound,this.kwargs=e.kwargs,this.config=e.config,this.configFactories=e.configFactories}getName(e){return this.bound.getName(e)}async _mergeConfig(...e){const t=xj(this.config,...e);return xj(t,...this.configFactories?await Promise.all(this.configFactories.map(async r=>await r(t))):[])}bind(e){return new this.constructor({bound:this.bound,kwargs:{...this.kwargs,...e},config:this.config})}withConfig(e){return new this.constructor({bound:this.bound,kwargs:this.kwargs,config:{...this.config,...e}})}withRetry(e){return new this.constructor({bound:this.bound.withRetry(e),kwargs:this.kwargs,config:this.config})}async invoke(e,t){return this.bound.invoke(e,await this._mergeConfig(ke(t),this.kwargs))}async batch(e,t,r){const n=Array.isArray(t)?await Promise.all(t.map(async i=>this._mergeConfig(ke(i),this.kwargs))):await this._mergeConfig(ke(t),this.kwargs);return this.bound.batch(e,n,r)}async*_streamIterator(e,t){yield*this.bound._streamIterator(e,await this._mergeConfig(ke(t),this.kwargs))}async stream(e,t){return this.bound.stream(e,await this._mergeConfig(ke(t),this.kwargs))}async*transform(e,t){yield*this.bound.transform(e,await this._mergeConfig(ke(t),this.kwargs))}streamEvents(e,t,r){const n=this,i=async function*(){yield*n.bound.streamEvents(e,{...await n._mergeConfig(ke(t),n.kwargs),version:t.version},r)};return ir.fromAsyncGenerator(i())}static isRunnableBinding(e){return e.bound&&ct.isRunnable(e.bound)}withListeners({onStart:e,onEnd:t,onError:r}){return new Sc({bound:this.bound,kwargs:this.kwargs,config:this.config,configFactories:[n=>({callbacks:[new Q4({config:n,onStart:e,onEnd:t,onError:r})]})]})}}class Ny extends ct{static lc_name(){return"RunnableEach"}constructor(e){super(e),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"bound",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.bound=e.bound}bind(e){return new Ny({bound:this.bound.bind(e)})}async invoke(e,t){return this._callWithConfig(this._invoke.bind(this),e,t)}async _invoke(e,t,r){return this.bound.batch(e,$t(t,{callbacks:r==null?void 0:r.getChild()}))}withListeners({onStart:e,onEnd:t,onError:r}){return new Ny({bound:this.bound.withListeners({onStart:e,onEnd:t,onError:r})})}}class q2 extends Sc{static lc_name(){return"RunnableRetry"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"maxAttemptNumber",{enumerable:!0,configurable:!0,writable:!0,value:3}),Object.defineProperty(this,"onFailedAttempt",{enumerable:!0,configurable:!0,writable:!0,value:()=>{}}),this.maxAttemptNumber=e.maxAttemptNumber??this.maxAttemptNumber,this.onFailedAttempt=e.onFailedAttempt??this.onFailedAttempt}_patchConfigForRetry(e,t,r){const n=e>1?`retry:attempt:${e}`:void 0;return $t(t,{callbacks:r==null?void 0:r.getChild(n)})}async _invoke(e,t,r){return wy(n=>super.invoke(e,this._patchConfigForRetry(n,t,r)),{onFailedAttempt:n=>this.onFailedAttempt(n,e),retries:Math.max(this.maxAttemptNumber-1,0),randomize:!0})}async invoke(e,t){return this._callWithConfig(this._invoke.bind(this),e,t)}async _batch(e,t,r,n){const i={};try{await wy(async o=>{const s=e.map((p,h)=>h).filter(p=>i[p.toString()]===void 0||i[p.toString()]instanceof Error),u=s.map(p=>e[p]),l=s.map(p=>this._patchConfigForRetry(o,t==null?void 0:t[p],r==null?void 0:r[p])),c=await super.batch(u,l,{...n,returnExceptions:!0});let f;for(let p=0;p<c.length;p+=1){const h=c[p],y=s[p];h instanceof Error&&f===void 0&&(f=h,f.input=u[p]),i[y.toString()]=h}if(f)throw f;return c},{onFailedAttempt:o=>this.onFailedAttempt(o,o.input),retries:Math.max(this.maxAttemptNumber-1,0),randomize:!0})}catch(o){if((n==null?void 0:n.returnExceptions)!==!0)throw o}return Object.keys(i).sort((o,s)=>parseInt(o,10)-parseInt(s,10)).map(o=>i[parseInt(o,10)])}async batch(e,t,r){return this._batchWithConfig(this._batch.bind(this),e,t,r)}}class mr extends ct{static lc_name(){return"RunnableSequence"}constructor(e){super(e),Object.defineProperty(this,"first",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"middle",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"last",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"omitSequenceTags",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),this.first=e.first,this.middle=e.middle??this.middle,this.last=e.last,this.name=e.name,this.omitSequenceTags=e.omitSequenceTags??this.omitSequenceTags}get steps(){return[this.first,...this.middle,this.last]}async invoke(e,t){var u;const r=ke(t),n=await Gs(r),i=await(n==null?void 0:n.handleChainStart(this.toJSON(),wt(e,"input"),r.runId,void 0,void 0,void 0,r==null?void 0:r.runName));delete r.runId;let o=e,s;try{const l=[this.first,...this.middle];for(let c=0;c<l.length;c+=1){const p=l[c].invoke(o,$t(r,{callbacks:i==null?void 0:i.getChild(this.omitSequenceTags?void 0:`seq:step:${c+1}`)}));o=await Zu(p,t==null?void 0:t.signal)}if((u=t==null?void 0:t.signal)!=null&&u.aborted)throw new Error("Aborted");s=await this.last.invoke(o,$t(r,{callbacks:i==null?void 0:i.getChild(this.omitSequenceTags?void 0:`seq:step:${this.steps.length}`)}))}catch(l){throw await(i==null?void 0:i.handleChainError(l)),l}return await(i==null?void 0:i.handleChainEnd(wt(s,"output"))),s}async batch(e,t,r){var u;const n=this._getOptionsList(t??{},e.length),i=await Promise.all(n.map(Gs)),o=await Promise.all(i.map(async(l,c)=>{const f=await(l==null?void 0:l.handleChainStart(this.toJSON(),wt(e[c],"input"),n[c].runId,void 0,void 0,void 0,n[c].runName));return delete n[c].runId,f}));let s=e;try{for(let l=0;l<this.steps.length;l+=1){const f=this.steps[l].batch(s,o.map((p,h)=>{const y=p==null?void 0:p.getChild(this.omitSequenceTags?void 0:`seq:step:${l+1}`);return $t(n[h],{callbacks:y})}),r);s=await Zu(f,(u=n[0])==null?void 0:u.signal)}}catch(l){throw await Promise.all(o.map(c=>c==null?void 0:c.handleChainError(l))),l}return await Promise.all(o.map(l=>l==null?void 0:l.handleChainEnd(wt(s,"output")))),s}async*_streamIterator(e,t){var f;const r=await Gs(t),{runId:n,...i}=t??{},o=await(r==null?void 0:r.handleChainStart(this.toJSON(),wt(e,"input"),n,void 0,void 0,void 0,i==null?void 0:i.runName)),s=[this.first,...this.middle,this.last];let u=!0,l;async function*c(){yield e}try{let p=s[0].transform(c(),$t(i,{callbacks:o==null?void 0:o.getChild(this.omitSequenceTags?void 0:"seq:step:1")}));for(let h=1;h<s.length;h+=1)p=await s[h].transform(p,$t(i,{callbacks:o==null?void 0:o.getChild(this.omitSequenceTags?void 0:`seq:step:${h+1}`)}));for await(const h of p)if((f=t==null?void 0:t.signal)==null||f.throwIfAborted(),yield h,u)if(l===void 0)l=h;else try{l=Dr(l,h)}catch{l=void 0,u=!1}}catch(p){throw await(o==null?void 0:o.handleChainError(p)),p}await(o==null?void 0:o.handleChainEnd(wt(l,"output")))}getGraph(e){const t=new pb;let r=null;return this.steps.forEach((n,i)=>{const o=n.getGraph(e);i!==0&&o.trimFirstNode(),i!==this.steps.length-1&&o.trimLastNode(),t.extend(o);const s=o.firstNode();if(!s)throw new Error(`Runnable ${n} has no first node`);r&&t.addEdge(r,s),r=o.lastNode()}),t}pipe(e){return mr.isRunnableSequence(e)?new mr({first:this.first,middle:this.middle.concat([this.last,e.first,...e.middle]),last:e.last,name:this.name??e.name}):new mr({first:this.first,middle:[...this.middle,this.last],last:bc(e),name:this.name})}static isRunnableSequence(e){return Array.isArray(e.middle)&&ct.isRunnable(e)}static from([e,...t],r){let n={};return typeof r=="string"?n.name=r:r!==void 0&&(n=r),new mr({...n,first:bc(e),middle:t.slice(0,-1).map(bc),last:bc(t[t.length-1])})}}class $f extends ct{static lc_name(){return"RunnableMap"}getStepsKeys(){return Object.keys(this.steps)}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"steps",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.steps={};for(const[t,r]of Object.entries(e.steps))this.steps[t]=bc(r)}static from(e){return new $f({steps:e})}async invoke(e,t){const r=ke(t),n=await Gs(r),i=await(n==null?void 0:n.handleChainStart(this.toJSON(),{input:e},r.runId,void 0,void 0,void 0,r==null?void 0:r.runName));delete r.runId;const o={};try{const s=Object.entries(this.steps).map(async([u,l])=>{o[u]=await l.invoke(e,$t(r,{callbacks:i==null?void 0:i.getChild(`map:key:${u}`)}))});await Zu(Promise.all(s),t==null?void 0:t.signal)}catch(s){throw await(i==null?void 0:i.handleChainError(s)),s}return await(i==null?void 0:i.handleChainEnd(o)),o}async*_transform(e,t,r){const n={...this.steps},i=Z4(e,Object.keys(n).length),o=new Map(Object.entries(n).map(([s,u],l)=>{const c=u.transform(i[l],$t(r,{callbacks:t==null?void 0:t.getChild(`map:key:${s}`)}));return[s,c.next().then(f=>({key:s,gen:c,result:f}))]}));for(;o.size;){const s=Promise.race(o.values()),{key:u,result:l,gen:c}=await Zu(s,r==null?void 0:r.signal);o.delete(u),l.done||(yield{[u]:l.value},o.set(u,c.next().then(f=>({key:u,gen:c,result:f}))))}}transform(e,t){return this._transformStreamWithConfig(e,this._transform.bind(this),t)}async stream(e,t){async function*r(){yield e}const n=ke(t),i=new xf({generator:this.transform(r(),n),config:n});return await i.setup,ir.fromAsyncGenerator(i)}}class jR extends ct{constructor(e){if(super(e),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"func",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),!RR(e.func))throw new Error("RunnableTraceable requires a function that is wrapped in traceable higher-order function");this.func=e.func}async invoke(e,t){const[r]=this._getOptionsList(t??{},1),n=await Gs(r),i=this.func($t(r,{callbacks:n}),e);return Zu(i,r==null?void 0:r.signal)}async*_streamIterator(e,t){var i,o;const[r]=this._getOptionsList(t??{},1),n=await this.invoke(e,t);if(RE(n)){for await(const s of n)(i=r==null?void 0:r.signal)==null||i.throwIfAborted(),yield s;return}if(N2(n)){for(;;){(o=r==null?void 0:r.signal)==null||o.throwIfAborted();const s=n.next();if(s.done)break;yield s.value}return}yield n}static from(e){return new jR({func:e})}}function z2(a){if(RR(a))throw new Error("RunnableLambda requires a function that is not wrapped in traceable higher-order function. This shouldn't happen.")}class Gp extends ct{static lc_name(){return"RunnableLambda"}constructor(e){if(RR(e.func))return jR.from(e.func);super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"func",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),z2(e.func),this.func=e.func}static from(e){return new Gp({func:e})}async _invoke(e,t,r){return new Promise((n,i)=>{const o=$t(t,{callbacks:r==null?void 0:r.getChild(),recursionLimit:((t==null?void 0:t.recursionLimit)??cg)-1});Xu.runWithConfig(Rf(o),async()=>{var s,u;try{let l=await this.func(e,{...o});if(l&&ct.isRunnable(l)){if((t==null?void 0:t.recursionLimit)===0)throw new Error("Recursion limit reached.");l=await l.invoke(e,{...o,recursionLimit:(o.recursionLimit??cg)-1})}else if(RE(l)){let c;for await(const f of CE(o,l))if((s=t==null?void 0:t.signal)==null||s.throwIfAborted(),c===void 0)c=f;else try{c=Dr(c,f)}catch{c=f}l=c}else if(Lj(l)){let c;for(const f of Vj(o,l))if((u=t==null?void 0:t.signal)==null||u.throwIfAborted(),c===void 0)c=f;else try{c=Dr(c,f)}catch{c=f}l=c}n(l)}catch(l){i(l)}})})}async invoke(e,t){return this._callWithConfig(this._invoke.bind(this),e,t)}async*_transform(e,t,r){var s,u;let n;for await(const l of e)if(n===void 0)n=l;else try{n=Dr(n,l)}catch{n=l}const i=$t(r,{callbacks:t==null?void 0:t.getChild(),recursionLimit:((r==null?void 0:r.recursionLimit)??cg)-1}),o=await new Promise((l,c)=>{Xu.runWithConfig(Rf(i),async()=>{try{const f=await this.func(n,{...i,config:i});l(f)}catch(f){c(f)}})});if(o&&ct.isRunnable(o)){if((r==null?void 0:r.recursionLimit)===0)throw new Error("Recursion limit reached.");const l=await o.stream(n,i);for await(const c of l)yield c}else if(RE(o))for await(const l of CE(i,o))(s=r==null?void 0:r.signal)==null||s.throwIfAborted(),yield l;else if(Lj(o))for(const l of Vj(i,o))(u=r==null?void 0:r.signal)==null||u.throwIfAborted(),yield l;else yield o}transform(e,t){return this._transformStreamWithConfig(e,this._transform.bind(this),t)}async stream(e,t){async function*r(){yield e}const n=ke(t),i=new xf({generator:this.transform(r(),n),config:n});return await i.setup,ir.fromAsyncGenerator(i)}}class B2 extends ct{static lc_name(){return"RunnableWithFallbacks"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"runnable",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fallbacks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.runnable=e.runnable,this.fallbacks=e.fallbacks}*runnables(){yield this.runnable;for(const e of this.fallbacks)yield e}async invoke(e,t){const r=ke(t),n=await Gs(r),{runId:i,...o}=r,s=await(n==null?void 0:n.handleChainStart(this.toJSON(),wt(e,"input"),i,void 0,void 0,void 0,o==null?void 0:o.runName)),u=$t(o,{callbacks:s==null?void 0:s.getChild()});return await Xu.runWithConfig(u,async()=>{var f;let c;for(const p of this.runnables()){(f=r==null?void 0:r.signal)==null||f.throwIfAborted();try{const h=await p.invoke(e,u);return await(s==null?void 0:s.handleChainEnd(wt(h,"output"))),h}catch(h){c===void 0&&(c=h)}}throw c===void 0?new Error("No error stored at end of fallback."):(await(s==null?void 0:s.handleChainError(c)),c)})}async*_streamIterator(e,t){var f;const r=ke(t),n=await Gs(r),{runId:i,...o}=r,s=await(n==null?void 0:n.handleChainStart(this.toJSON(),wt(e,"input"),i,void 0,void 0,void 0,o==null?void 0:o.runName));let u,l;for(const p of this.runnables()){(f=r==null?void 0:r.signal)==null||f.throwIfAborted();const h=$t(o,{callbacks:s==null?void 0:s.getChild()});try{const y=await p.stream(e,h);l=CE(h,y);break}catch(y){u===void 0&&(u=y)}}if(l===void 0){const p=u??new Error("No error stored at end of fallback.");throw await(s==null?void 0:s.handleChainError(p)),p}let c;try{for await(const p of l){yield p;try{c=c===void 0?c:Dr(c,p)}catch{c=void 0}}}catch(p){throw await(s==null?void 0:s.handleChainError(p)),p}await(s==null?void 0:s.handleChainEnd(wt(c,"output")))}async batch(e,t,r){var u;if(r!=null&&r.returnExceptions)throw new Error("Not implemented.");const n=this._getOptionsList(t??{},e.length),i=await Promise.all(n.map(l=>Gs(l))),o=await Promise.all(i.map(async(l,c)=>{const f=await(l==null?void 0:l.handleChainStart(this.toJSON(),wt(e[c],"input"),n[c].runId,void 0,void 0,void 0,n[c].runName));return delete n[c].runId,f}));let s;for(const l of this.runnables()){(u=n[0].signal)==null||u.throwIfAborted();try{const c=await l.batch(e,o.map((f,p)=>$t(n[p],{callbacks:f==null?void 0:f.getChild()})),r);return await Promise.all(o.map((f,p)=>f==null?void 0:f.handleChainEnd(wt(c[p],"output")))),c}catch(c){s===void 0&&(s=c)}}throw s?(await Promise.all(o.map(l=>l==null?void 0:l.handleChainError(s))),s):new Error("No error stored at end of fallbacks.")}}function bc(a){if(typeof a=="function")return new Gp({func:a});if(ct.isRunnable(a))return a;if(!Array.isArray(a)&&typeof a=="object"){const e={};for(const[t,r]of Object.entries(a))e[t]=bc(r);return new $f({steps:e})}else throw new Error(`Expected a Runnable, function or object.
Instead got an unsupported type.`)}class iV extends ct{static lc_name(){return"RunnableAssign"}constructor(e){e instanceof $f&&(e={mapper:e}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"mapper",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.mapper=e.mapper}async invoke(e,t){const r=await this.mapper.invoke(e,t);return{...e,...r}}async*_transform(e,t,r){const n=this.mapper.getStepsKeys(),[i,o]=Z4(e),s=this.mapper.transform(o,$t(r,{callbacks:t==null?void 0:t.getChild()})),u=s.next();for await(const l of i){if(typeof l!="object"||Array.isArray(l))throw new Error(`RunnableAssign can only be used with objects as input, got ${typeof l}`);const c=Object.fromEntries(Object.entries(l).filter(([f])=>!n.includes(f)));Object.keys(c).length>0&&(yield c)}yield(await u).value;for await(const l of s)yield l}transform(e,t){return this._transformStreamWithConfig(e,this._transform.bind(this),t)}async stream(e,t){async function*r(){yield e}const n=ke(t),i=new xf({generator:this.transform(r(),n),config:n});return await i.setup,ir.fromAsyncGenerator(i)}}class U2 extends ct{static lc_name(){return"RunnablePick"}constructor(e){(typeof e=="string"||Array.isArray(e))&&(e={keys:e}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"keys",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.keys=e.keys}async _pick(e){if(typeof this.keys=="string")return e[this.keys];{const t=this.keys.map(r=>[r,e[r]]).filter(r=>r[1]!==void 0);return t.length===0?void 0:Object.fromEntries(t)}}async invoke(e,t){return this._callWithConfig(this._pick.bind(this),e,t)}async*_transform(e){for await(const t of e){const r=await this._pick(t);r!==void 0&&(yield r)}}transform(e,t){return this._transformStreamWithConfig(e,this._transform.bind(this),t)}async stream(e,t){async function*r(){yield e}const n=ke(t),i=new xf({generator:this.transform(r(),n),config:n});return await i.setup,ir.fromAsyncGenerator(i)}}class Gj extends Sc{constructor(e){const t=mr.from([Gp.from(async r=>{let n;if(R4(r))try{n=await this.schema.parseAsync(r.args)}catch{throw new I9("Received tool input did not match expected schema",JSON.stringify(r.args))}else n=r;return n}).withConfig({runName:`${e.name}:parse_input`}),e.bound]).withConfig({runName:e.name});super({bound:t,config:e.config??{}}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"description",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"schema",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name=e.name,this.description=e.description,this.schema=e.schema}static lc_name(){return"RunnableToolLike"}}function F2(a,e){var n;const t=e.name??a.getName(),r=e.description??((n=e.schema)==null?void 0:n.description);return e.schema.constructor===Oc.ZodString?new Gj({name:t,description:r,schema:Oc.object({input:Oc.string()}).transform(i=>i.input),bound:a}):new Gj({name:t,description:r,schema:e.schema,bound:a})}class L2 extends ct{constructor(e){super(e),Object.defineProperty(this,"callbacks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"verbose",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.callbacks=e==null?void 0:e.callbacks,this.tags=(e==null?void 0:e.tags)??[],this.metadata=(e==null?void 0:e.metadata)??{},this.verbose=(e==null?void 0:e.verbose)??!1}_getRelevantDocuments(e,t){throw new Error("Not implemented!")}async invoke(e,t){return this.getRelevantDocuments(e,ke(t))}async getRelevantDocuments(e,t){const r=ke(hW(t)),n=await Ot.configure(r.callbacks,this.callbacks,r.tags,this.tags,r.metadata,this.metadata,{verbose:this.verbose}),i=await(n==null?void 0:n.handleRetrieverStart(this.toJSON(),e,r.runId,void 0,void 0,void 0,r.runName));try{const o=await this._getRelevantDocuments(e,i);return await(i==null?void 0:i.handleRetrieverEnd(o)),o}catch(o){throw await(i==null?void 0:i.handleRetrieverError(o)),o}}}class pg extends L2{static lc_name(){return"VectorStoreRetriever"}get lc_namespace(){return["langchain_core","vectorstores"]}_vectorstoreType(){return this.vectorStore._vectorstoreType()}constructor(e){super(e),Object.defineProperty(this,"vectorStore",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"k",{enumerable:!0,configurable:!0,writable:!0,value:4}),Object.defineProperty(this,"searchType",{enumerable:!0,configurable:!0,writable:!0,value:"similarity"}),Object.defineProperty(this,"searchKwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"filter",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.vectorStore=e.vectorStore,this.k=e.k??this.k,this.searchType=e.searchType??this.searchType,this.filter=e.filter,e.searchType==="mmr"&&(this.searchKwargs=e.searchKwargs)}async _getRelevantDocuments(e,t){if(this.searchType==="mmr"){if(typeof this.vectorStore.maxMarginalRelevanceSearch!="function")throw new Error(`The vector store backing this retriever, ${this._vectorstoreType()} does not support max marginal relevance search.`);return this.vectorStore.maxMarginalRelevanceSearch(e,{k:this.k,filter:this.filter,...this.searchKwargs},t==null?void 0:t.getChild("vectorstore"))}return this.vectorStore.similaritySearch(e,this.k,this.filter,t==null?void 0:t.getChild("vectorstore"))}async addDocuments(e,t){return this.vectorStore.addDocuments(e,t)}}class V2 extends Gu{constructor(e,t){super(t),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","vectorstores",this._vectorstoreType()]}),Object.defineProperty(this,"embeddings",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.embeddings=e}async delete(e){throw new Error("Not implemented.")}async similaritySearch(e,t=4,r=void 0,n=void 0){return(await this.similaritySearchVectorWithScore(await this.embeddings.embedQuery(e),t,r)).map(o=>o[0])}async similaritySearchWithScore(e,t=4,r=void 0,n=void 0){return this.similaritySearchVectorWithScore(await this.embeddings.embedQuery(e),t,r)}static fromTexts(e,t,r,n){throw new Error("the Langchain vectorstore implementation you are using forgot to override this, please report a bug")}static fromDocuments(e,t,r){throw new Error("the Langchain vectorstore implementation you are using forgot to override this, please report a bug")}asRetriever(e,t,r,n,i,o){if(typeof e=="number")return new pg({vectorStore:this,k:e,filter:t,tags:[...n??[],this._vectorstoreType()],metadata:i,verbose:o,callbacks:r});{const s={vectorStore:this,k:e==null?void 0:e.k,filter:e==null?void 0:e.filter,tags:[...(e==null?void 0:e.tags)??[],this._vectorstoreType()],metadata:e==null?void 0:e.metadata,verbose:e==null?void 0:e.verbose,callbacks:e==null?void 0:e.callbacks,searchType:e==null?void 0:e.searchType};return(e==null?void 0:e.searchType)==="mmr"?new pg({...s,searchKwargs:e.searchKwargs}):new pg({...s})}}}let Fu=class{constructor(e){Object.defineProperty(this,"pageContent",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.pageContent=e.pageContent!==void 0?e.pageContent.toString():"",this.metadata=e.metadata??{},this.id=e.id}};class G2 extends ct{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","documents","transformers"]})}invoke(e,t){return this.transformDocuments(e)}}function k2(a,e){let t=0,r=0,n=0;for(let i=0;i<a.length;i++)t+=a[i]*e[i],r+=a[i]*a[i],n+=e[i]*e[i];return t/(Math.sqrt(r)*Math.sqrt(n))}function H2(a,e){let t=0,r=0,n=0;for(let i=0;i<a.length;i++)t+=a[i]*e[i],r+=a[i]*a[i],n+=e[i]*e[i];return t/(Math.sqrt(r)*Math.sqrt(n))}function W2(a,e,t){if(a.length===0||a[0].length===0||e.length===0||e[0].length===0)return[[]];if(a[0].length!==e[0].length)throw new Error(`Number of columns in X and Y must be the same. X has shape ${[a.length,a[0].length]} and Y has shape ${[e.length,e[0].length]}.`);return a.map(r=>e.map(n=>t(r,n)).map(n=>Number.isNaN(n)?0:n))}function kj(a,e){return W2(a,e,H2)}function K2(a,e,t=.5,r=4){if(Math.min(r,e.length)<=0)return[];const n=Array.isArray(a[0])?a:[a],i=kj(n,e)[0],o=J2(i).maxIndex,s=[e[o]],u=[o];for(;u.length<Math.min(r,e.length);){let l=-1/0,c=-1;const f=kj(e,s);i.forEach((p,h)=>{if(u.includes(h))return;const y=Math.max(...f[h]),d=t*p-(1-t)*y;d>l&&(l=d,c=h)}),s.push(e[c]),u.push(c)}return u}function J2(a){if(a.length===0)return{maxIndex:-1,maxValue:NaN};let e=a[0],t=0;for(let r=1;r<a.length;r+=1)a[r]>e&&(t=r,e=a[r]);return{maxIndex:t,maxValue:e}}class TR extends V2{_vectorstoreType(){return"memory"}constructor(e,{similarity:t,...r}={}){super(e,r),Object.defineProperty(this,"memoryVectors",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"similarity",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.similarity=t??k2}async addDocuments(e){const t=e.map(({pageContent:r})=>r);return this.addVectors(await this.embeddings.embedDocuments(t),e)}async addVectors(e,t){const r=e.map((n,i)=>({content:t[i].pageContent,embedding:n,metadata:t[i].metadata,id:t[i].id}));this.memoryVectors=this.memoryVectors.concat(r)}async _queryVectors(e,t,r){const n=o=>{if(!r)return!0;const s=new Fu({metadata:o.metadata,pageContent:o.content,id:o.id});return r(s)};return this.memoryVectors.filter(n).map((o,s)=>({similarity:this.similarity(e,o.embedding),index:s,metadata:o.metadata,content:o.content,embedding:o.embedding,id:o.id})).sort((o,s)=>o.similarity>s.similarity?-1:0).slice(0,t)}async similaritySearchVectorWithScore(e,t,r){return(await this._queryVectors(e,t,r)).map(o=>[new Fu({metadata:o.metadata,pageContent:o.content,id:o.id}),o.similarity])}async maxMarginalRelevanceSearch(e,t){const r=await this.embeddings.embedQuery(e),n=await this._queryVectors(r,t.fetchK??20,t.filter),i=n.map(s=>s.embedding);return K2(r,i,t.lambda,t.k).map(s=>new Fu({metadata:n[s].metadata,pageContent:n[s].content,id:n[s].id}))}static async fromTexts(e,t,r,n){const i=[];for(let o=0;o<e.length;o+=1){const s=Array.isArray(t)?t[o]:t,u=new Fu({pageContent:e[o],metadata:s});i.push(u)}return TR.fromDocuments(i,r,n)}static async fromDocuments(e,t,r){const n=new this(t,r);return await n.addDocuments(e),n}static async fromExistingIndex(e,t){return new this(e,t)}}const X2="modulepreload",Z2=function(a,e){return new URL(a,e).href},Hj={},Lu=function(e,t,r){let n=Promise.resolve();if(t&&t.length>0){let o=function(c){return Promise.all(c.map(f=>Promise.resolve(f).then(p=>({status:"fulfilled",value:p}),p=>({status:"rejected",reason:p}))))};const s=document.getElementsByTagName("link"),u=document.querySelector("meta[property=csp-nonce]"),l=(u==null?void 0:u.nonce)||(u==null?void 0:u.getAttribute("nonce"));n=o(t.map(c=>{if(c=Z2(c,r),c in Hj)return;Hj[c]=!0;const f=c.endsWith(".css"),p=f?'[rel="stylesheet"]':"";if(!!r)for(let d=s.length-1;d>=0;d--){const _=s[d];if(_.href===c&&(!f||_.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${c}"]${p}`))return;const y=document.createElement("link");if(y.rel=f?"stylesheet":X2,f||(y.as="script"),y.crossOrigin="",y.href=c,l&&y.setAttribute("nonce",l),document.head.appendChild(y),f)return new Promise((d,_)=>{y.addEventListener("load",d),y.addEventListener("error",()=>_(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(o){const s=new Event("vite:preloadError",{cancelable:!0});if(s.payload=o,window.dispatchEvent(s),!s.defaultPrevented)throw o}return n.then(o=>{for(const s of o||[])s.status==="rejected"&&i(s.reason);return e().catch(i)})};class MR extends ct{get lc_attributes(){return{partialVariables:void 0}}constructor(e){super(e),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompts",this._getPromptType()]}),Object.defineProperty(this,"inputVariables",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"outputParser",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"partialVariables",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0});const{inputVariables:t}=e;if(t.includes("stop"))throw new Error("Cannot have an input variable named 'stop', as it is used internally, please rename.");Object.assign(this,e)}async mergePartialAndUserVariables(e){const t=this.partialVariables??{},r={};for(const[i,o]of Object.entries(t))typeof o=="string"?r[i]=o:r[i]=await o();return{...r,...e}}async invoke(e,t){const r={...this.metadata,...t==null?void 0:t.metadata},n=[...this.tags??[],...(t==null?void 0:t.tags)??[]];return this._callWithConfig(i=>this.formatPromptValue(i),e,{...t,tags:n,metadata:r,runType:"prompt"})}serialize(){throw new Error("Use .toJSON() instead")}static async deserialize(e){switch(e._type){case"prompt":{const{PromptTemplate:t}=await Lu(async()=>{const{PromptTemplate:r}=await Promise.resolve().then(()=>Jj);return{PromptTemplate:r}},void 0,import.meta.url);return t.deserialize(e)}case void 0:{const{PromptTemplate:t}=await Lu(async()=>{const{PromptTemplate:r}=await Promise.resolve().then(()=>Jj);return{PromptTemplate:r}},void 0,import.meta.url);return t.deserialize({...e,_type:"prompt"})}case"few_shot":{const{FewShotPromptTemplate:t}=await Lu(async()=>{const{FewShotPromptTemplate:r}=await import("./few_shot.js");return{FewShotPromptTemplate:r}},[],import.meta.url);return t.deserialize(e)}default:throw new Error(`Invalid prompt type in config: ${e._type}`)}}}class AR extends Gu{}class aV extends AR{static lc_name(){return"StringPromptValue"}constructor(e){super({value:e}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompt_values"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.value=e}toString(){return this.value}toChatMessages(){return[new ku(this.value)]}}class oV extends AR{static lc_name(){return"ChatPromptValue"}constructor(e){Array.isArray(e)&&(e={messages:e}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompt_values"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"messages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.messages=e.messages}toString(){return mR(this.messages)}toChatMessages(){return this.messages}}class Q2 extends AR{static lc_name(){return"ImagePromptValue"}constructor(e){"imageUrl"in e||(e={imageUrl:e}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompt_values"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"imageUrl",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.imageUrl=e.imageUrl}toString(){return this.imageUrl.url}toChatMessages(){return[new ku({content:[{type:"image_url",image_url:{detail:this.imageUrl.detail,url:this.imageUrl.url}}]})]}}class PE extends MR{async formatPromptValue(e){const t=await this.format(e);return new aV(t)}}/*!
 * mustache.js - Logic-less {{mustache}} templates with JavaScript
 * http://github.com/janl/mustache.js
 */var Y2=Object.prototype.toString,Nf=Array.isArray||function(e){return Y2.call(e)==="[object Array]"};function IR(a){return typeof a=="function"}function eJ(a){return Nf(a)?"array":typeof a}function _g(a){return a.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function Wj(a,e){return a!=null&&typeof a=="object"&&e in a}function tJ(a,e){return a!=null&&typeof a!="object"&&a.hasOwnProperty&&a.hasOwnProperty(e)}var rJ=RegExp.prototype.test;function nJ(a,e){return rJ.call(a,e)}var iJ=/\S/;function aJ(a){return!nJ(iJ,a)}var oJ={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};function sJ(a){return String(a).replace(/[&<>"'`=\/]/g,function(t){return oJ[t]})}var uJ=/\s*/,lJ=/\s+/,Kj=/\s*=/,cJ=/\s*\}/,fJ=/#|\^|\/|>|\{|&|=|!/;function dJ(a,e){if(!a)return[];var t=!1,r=[],n=[],i=[],o=!1,s=!1,u="",l=0;function c(){if(o&&!s)for(;i.length;)delete n[i.pop()];else i=[];o=!1,s=!1}var f,p,h;function y(P){if(typeof P=="string"&&(P=P.split(lJ,2)),!Nf(P)||P.length!==2)throw new Error("Invalid tags: "+P);f=new RegExp(_g(P[0])+"\\s*"),p=new RegExp("\\s*"+_g(P[1])),h=new RegExp("\\s*"+_g("}"+P[1]))}y(e||ar.tags);for(var d=new kp(a),_,m,b,g,v,w;!d.eos();){if(_=d.pos,b=d.scanUntil(f),b)for(var S=0,R=b.length;S<R;++S)g=b.charAt(S),aJ(g)?(i.push(n.length),u+=g):(s=!0,t=!0,u+=" "),n.push(["text",g,_,_+1]),_+=1,g===`
`&&(c(),u="",l=0,t=!1);if(!d.scan(f))break;if(o=!0,m=d.scan(fJ)||"name",d.scan(uJ),m==="="?(b=d.scanUntil(Kj),d.scan(Kj),d.scanUntil(p)):m==="{"?(b=d.scanUntil(h),d.scan(cJ),d.scanUntil(p),m="&"):b=d.scanUntil(p),!d.scan(p))throw new Error("Unclosed tag at "+d.pos);if(m==">"?v=[m,b,_,d.pos,u,l,t]:v=[m,b,_,d.pos],l++,n.push(v),m==="#"||m==="^")r.push(v);else if(m==="/"){if(w=r.pop(),!w)throw new Error('Unopened section "'+b+'" at '+_);if(w[1]!==b)throw new Error('Unclosed section "'+w[1]+'" at '+_)}else m==="name"||m==="{"||m==="&"?s=!0:m==="="&&y(b)}if(c(),w=r.pop(),w)throw new Error('Unclosed section "'+w[1]+'" at '+d.pos);return pJ(hJ(n))}function hJ(a){for(var e=[],t,r,n=0,i=a.length;n<i;++n)t=a[n],t&&(t[0]==="text"&&r&&r[0]==="text"?(r[1]+=t[1],r[3]=t[3]):(e.push(t),r=t));return e}function pJ(a){for(var e=[],t=e,r=[],n,i,o=0,s=a.length;o<s;++o)switch(n=a[o],n[0]){case"#":case"^":t.push(n),r.push(n),t=n[4]=[];break;case"/":i=r.pop(),i[5]=n[2],t=r.length>0?r[r.length-1][4]:e;break;default:t.push(n)}return e}function kp(a){this.string=a,this.tail=a,this.pos=0}kp.prototype.eos=function(){return this.tail===""};kp.prototype.scan=function(e){var t=this.tail.match(e);if(!t||t.index!==0)return"";var r=t[0];return this.tail=this.tail.substring(r.length),this.pos+=r.length,r};kp.prototype.scanUntil=function(e){var t=this.tail.search(e),r;switch(t){case-1:r=this.tail,this.tail="";break;case 0:r="";break;default:r=this.tail.substring(0,t),this.tail=this.tail.substring(t)}return this.pos+=r.length,r};function Cf(a,e){this.view=a,this.cache={".":this.view},this.parent=e}Cf.prototype.push=function(e){return new Cf(e,this)};Cf.prototype.lookup=function(e){var t=this.cache,r;if(t.hasOwnProperty(e))r=t[e];else{for(var n=this,i,o,s,u=!1;n;){if(e.indexOf(".")>0)for(i=n.view,o=e.split("."),s=0;i!=null&&s<o.length;)s===o.length-1&&(u=Wj(i,o[s])||tJ(i,o[s])),i=i[o[s++]];else i=n.view[e],u=Wj(n.view,e);if(u){r=i;break}n=n.parent}t[e]=r}return IR(r)&&(r=r.call(this.view)),r};function Zt(){this.templateCache={_cache:{},set:function(e,t){this._cache[e]=t},get:function(e){return this._cache[e]},clear:function(){this._cache={}}}}Zt.prototype.clearCache=function(){typeof this.templateCache<"u"&&this.templateCache.clear()};Zt.prototype.parse=function(e,t){var r=this.templateCache,n=e+":"+(t||ar.tags).join(":"),i=typeof r<"u",o=i?r.get(n):void 0;return o==null&&(o=dJ(e,t),i&&r.set(n,o)),o};Zt.prototype.render=function(e,t,r,n){var i=this.getConfigTags(n),o=this.parse(e,i),s=t instanceof Cf?t:new Cf(t,void 0);return this.renderTokens(o,s,r,e,n)};Zt.prototype.renderTokens=function(e,t,r,n,i){for(var o="",s,u,l,c=0,f=e.length;c<f;++c)l=void 0,s=e[c],u=s[0],u==="#"?l=this.renderSection(s,t,r,n,i):u==="^"?l=this.renderInverted(s,t,r,n,i):u===">"?l=this.renderPartial(s,t,r,i):u==="&"?l=this.unescapedValue(s,t):u==="name"?l=this.escapedValue(s,t,i):u==="text"&&(l=this.rawValue(s)),l!==void 0&&(o+=l);return o};Zt.prototype.renderSection=function(e,t,r,n,i){var o=this,s="",u=t.lookup(e[1]);function l(p){return o.render(p,t,r,i)}if(u){if(Nf(u))for(var c=0,f=u.length;c<f;++c)s+=this.renderTokens(e[4],t.push(u[c]),r,n,i);else if(typeof u=="object"||typeof u=="string"||typeof u=="number")s+=this.renderTokens(e[4],t.push(u),r,n,i);else if(IR(u)){if(typeof n!="string")throw new Error("Cannot use higher-order sections without the original template");u=u.call(t.view,n.slice(e[3],e[5]),l),u!=null&&(s+=u)}else s+=this.renderTokens(e[4],t,r,n,i);return s}};Zt.prototype.renderInverted=function(e,t,r,n,i){var o=t.lookup(e[1]);if(!o||Nf(o)&&o.length===0)return this.renderTokens(e[4],t,r,n,i)};Zt.prototype.indentPartial=function(e,t,r){for(var n=t.replace(/[^ \t]/g,""),i=e.split(`
`),o=0;o<i.length;o++)i[o].length&&(o>0||!r)&&(i[o]=n+i[o]);return i.join(`
`)};Zt.prototype.renderPartial=function(e,t,r,n){if(r){var i=this.getConfigTags(n),o=IR(r)?r(e[1]):r[e[1]];if(o!=null){var s=e[6],u=e[5],l=e[4],c=o;u==0&&l&&(c=this.indentPartial(o,l,s));var f=this.parse(c,i);return this.renderTokens(f,t,r,c,n)}}};Zt.prototype.unescapedValue=function(e,t){var r=t.lookup(e[1]);if(r!=null)return r};Zt.prototype.escapedValue=function(e,t,r){var n=this.getConfigEscape(r)||ar.escape,i=t.lookup(e[1]);if(i!=null)return typeof i=="number"&&n===ar.escape?String(i):n(i)};Zt.prototype.rawValue=function(e){return e[1]};Zt.prototype.getConfigTags=function(e){return Nf(e)?e:e&&typeof e=="object"?e.tags:void 0};Zt.prototype.getConfigEscape=function(e){if(e&&typeof e=="object"&&!Nf(e))return e.escape};var ar={name:"mustache.js",version:"4.2.0",tags:["{{","}}"],clearCache:void 0,escape:void 0,parse:void 0,render:void 0,Scanner:void 0,Context:void 0,Writer:void 0,set templateCache(a){Cp.templateCache=a},get templateCache(){return Cp.templateCache}},Cp=new Zt;ar.clearCache=function(){return Cp.clearCache()};ar.parse=function(e,t){return Cp.parse(e,t)};ar.render=function(e,t,r,n){if(typeof e!="string")throw new TypeError('Invalid template! Template should be a "string" but "'+eJ(e)+'" was given as the first argument for mustache#render(template, view, partials)');return Cp.render(e,t,r,n)};ar.escape=sJ;ar.Scanner=kp;ar.Context=Cf;ar.Writer=Zt;function sV(){ar.escape=a=>a}const qy=a=>{const e=a.split(""),t=[],r=(i,o)=>{for(let s=o;s<e.length;s+=1)if(i.includes(e[s]))return s;return-1};let n=0;for(;n<e.length;)if(e[n]==="{"&&n+1<e.length&&e[n+1]==="{")t.push({type:"literal",text:"{"}),n+=2;else if(e[n]==="}"&&n+1<e.length&&e[n+1]==="}")t.push({type:"literal",text:"}"}),n+=2;else if(e[n]==="{"){const i=r("}",n);if(i<0)throw new Error("Unclosed '{' in template.");t.push({type:"variable",name:e.slice(n+1,i).join("")}),n=i+1}else{if(e[n]==="}")throw new Error("Single '}' in template.");{const i=r("{}",n),o=(i<0?e.slice(n):e.slice(n,i)).join("");t.push({type:"literal",text:o}),n=i<0?e.length:i}}return t},_J=a=>a.map(e=>e[0]==="name"?{type:"variable",name:e[1].includes(".")?e[1].split(".")[0]:e[1]}:["#","&","^",">"].includes(e[0])?{type:"variable",name:e[1]}:{type:"literal",text:e[1]}),jE=a=>{sV();const e=ar.parse(a);return _J(e)},yJ=(a,e)=>qy(a).reduce((t,r)=>{if(r.type==="variable"){if(r.name in e){const n=typeof e[r.name]=="string"?e[r.name]:JSON.stringify(e[r.name]);return t+n}throw new Error(`(f-string) Missing value for input ${r.name}`)}return t+r.text},""),bJ=(a,e)=>(sV(),ar.render(a,e)),TE={"f-string":yJ,mustache:bJ},mJ={"f-string":qy,mustache:jE},nf=(a,e,t)=>{try{return TE[e](a,t)}catch(r){throw ib(r,"INVALID_PROMPT_INPUT")}},gJ=(a,e)=>mJ[e](a),uV=(a,e,t)=>{if(!(e in TE)){const r=Object.keys(TE);throw new Error(`Invalid template format. Got \`${e}\`;
                         should be one of ${r}`)}try{const r=t.reduce((n,i)=>(n[i]="foo",n),{});Array.isArray(a)?a.forEach(n=>{if(n.type==="text")nf(n.text,e,r);else if(n.type==="image_url")if(typeof n.image_url=="string")nf(n.image_url,e,r);else{const i=n.image_url.url;nf(i,e,r)}else throw new Error(`Invalid message template received. ${JSON.stringify(n,null,2)}`)}):nf(a,e,r)}catch(r){throw new Error(`Invalid prompt schema: ${r.message}`)}};class Bs extends PE{static lc_name(){return"PromptTemplate"}constructor(e){if(super(e),Object.defineProperty(this,"template",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"templateFormat",{enumerable:!0,configurable:!0,writable:!0,value:"f-string"}),Object.defineProperty(this,"validateTemplate",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"additionalContentFields",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),e.templateFormat==="mustache"&&e.validateTemplate===void 0&&(this.validateTemplate=!1),Object.assign(this,e),this.validateTemplate){if(this.templateFormat==="mustache")throw new Error("Mustache templates cannot be validated.");let t=this.inputVariables;this.partialVariables&&(t=t.concat(Object.keys(this.partialVariables))),uV(this.template,this.templateFormat,t)}}_getPromptType(){return"prompt"}async format(e){const t=await this.mergePartialAndUserVariables(e);return nf(this.template,this.templateFormat,t)}static fromExamples(e,t,r,n=`

`,i=""){const o=[i,...e,t].join(n);return new Bs({inputVariables:r,template:o})}static fromTemplate(e,t){const{templateFormat:r="f-string",...n}=t??{},i=new Set;return gJ(e,r).forEach(o=>{o.type==="variable"&&i.add(o.name)}),new Bs({inputVariables:[...i],templateFormat:r,template:e,...n})}async partial(e){const t=this.inputVariables.filter(i=>!(i in e)),r={...this.partialVariables??{},...e},n={...this,inputVariables:t,partialVariables:r};return new Bs(n)}serialize(){if(this.outputParser!==void 0)throw new Error("Cannot serialize a prompt template with an output parser");return{_type:this._getPromptType(),input_variables:this.inputVariables,template:this.template,template_format:this.templateFormat}}static async deserialize(e){if(!e.template)throw new Error("Prompt template must have a template");return new Bs({inputVariables:e.input_variables,template:e.template,templateFormat:e.template_format})}}const Jj=Object.freeze(Object.defineProperty({__proto__:null,PromptTemplate:Bs},Symbol.toStringTag,{value:"Module"}));class tp extends MR{static lc_name(){return"ImagePromptTemplate"}constructor(e){if(super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompts","image"]}),Object.defineProperty(this,"template",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"templateFormat",{enumerable:!0,configurable:!0,writable:!0,value:"f-string"}),Object.defineProperty(this,"validateTemplate",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"additionalContentFields",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.template=e.template,this.templateFormat=e.templateFormat??this.templateFormat,this.validateTemplate=e.validateTemplate??this.validateTemplate,this.additionalContentFields=e.additionalContentFields,this.validateTemplate){let t=this.inputVariables;this.partialVariables&&(t=t.concat(Object.keys(this.partialVariables))),uV([{type:"image_url",image_url:this.template}],this.templateFormat,t)}}_getPromptType(){return"prompt"}async partial(e){const t=this.inputVariables.filter(i=>!(i in e)),r={...this.partialVariables??{},...e},n={...this,inputVariables:t,partialVariables:r};return new tp(n)}async format(e){const t={};for(const[o,s]of Object.entries(this.template))typeof s=="string"?t[o]=nf(s,this.templateFormat,e):t[o]=s;const r=e.url||t.url,n=e.detail||t.detail;if(!r)throw new Error("Must provide either an image URL.");if(typeof r!="string")throw new Error("url must be a string.");const i={url:r};return n&&(i.detail=n),i}async formatPromptValue(e){const t=await this.format(e);return new Q2(t)}}class DR extends ct{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompts","chat"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0})}async invoke(e,t){return this._callWithConfig(r=>this.formatMessages(r),e,{...t,runType:"prompt"})}}class Xj extends DR{static lc_name(){return"MessagesPlaceholder"}constructor(e){typeof e=="string"&&(e={variableName:e}),super(e),Object.defineProperty(this,"variableName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"optional",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.variableName=e.variableName,this.optional=e.optional??!1}get inputVariables(){return[this.variableName]}async formatMessages(e){const t=e[this.variableName];if(this.optional&&!t)return[];if(!t){const n=new Error(`Field "${this.variableName}" in prompt uses a MessagesPlaceholder, which expects an array of BaseMessages as an input value. Received: undefined`);throw n.name="InputFormatError",n}let r;try{Array.isArray(t)?r=t.map(Uu):r=[Uu(t)]}catch(n){const i=typeof t=="string"?t:JSON.stringify(t,null,2),o=new Error([`Field "${this.variableName}" in prompt uses a MessagesPlaceholder, which expects an array of BaseMessages or coerceable values as input.`,`Received value: ${i}`,`Additional message: ${n.message}`].join(`

`));throw o.name="InputFormatError",o.lc_error_code=n.lc_error_code,o}return r}}class vJ extends DR{constructor(e){"prompt"in e||(e={prompt:e}),super(e),Object.defineProperty(this,"prompt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.prompt=e.prompt}get inputVariables(){return this.prompt.inputVariables}async formatMessages(e){return[await this.format(e)]}}class wJ extends MR{constructor(e){super(e)}async format(e){return(await this.formatPromptValue(e)).toString()}async formatPromptValue(e){const t=await this.formatMessages(e);return new oV(t)}}class OJ extends vJ{static lc_name(){return"ChatMessagePromptTemplate"}constructor(e,t){"prompt"in e||(e={prompt:e,role:t}),super(e),Object.defineProperty(this,"role",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.role=e.role}async format(e){return new Ac(await this.prompt.format(e),this.role)}static fromTemplate(e,t,r){return new this(Bs.fromTemplate(e,{templateFormat:r==null?void 0:r.templateFormat}),t)}}class xR extends DR{static _messageClass(){throw new Error("Can not invoke _messageClass from inside _StringImageMessagePromptTemplate")}constructor(e,t){if("prompt"in e||(e={prompt:e}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompts","chat"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"inputVariables",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"additionalOptions",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"prompt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"messageClass",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"chatMessageClass",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.prompt=e.prompt,Array.isArray(this.prompt)){let r=[];this.prompt.forEach(n=>{"inputVariables"in n&&(r=r.concat(n.inputVariables))}),this.inputVariables=r}else this.inputVariables=this.prompt.inputVariables;this.additionalOptions=t??this.additionalOptions}createMessage(e){const t=this.constructor;if(t._messageClass()){const r=t._messageClass();return new r({content:e})}else if(t.chatMessageClass){const r=t.chatMessageClass();return new r({content:e,role:this.getRoleFromMessageClass(r.lc_name())})}else throw new Error("No message class defined")}getRoleFromMessageClass(e){switch(e){case"HumanMessage":return"human";case"AIMessage":return"ai";case"SystemMessage":return"system";case"ChatMessage":return"chat";default:throw new Error("Invalid message class name")}}static fromTemplate(e,t){if(typeof e=="string")return new this(Bs.fromTemplate(e,t));const r=[];for(const n of e)if(typeof n=="string"||typeof n=="object"&&"text"in n){let i="";typeof n=="string"?i=n:typeof n.text=="string"&&(i=n.text??"");const o={...t,...typeof n!="string"?{additionalContentFields:n}:{}};r.push(Bs.fromTemplate(i,o))}else if(typeof n=="object"&&"image_url"in n){let i=n.image_url??"",o,s=[];if(typeof i=="string"){let u;(t==null?void 0:t.templateFormat)==="mustache"?u=jE(i):u=qy(i);const l=u.flatMap(c=>c.type==="variable"?[c.name]:[]);if(((l==null?void 0:l.length)??0)>0){if(l.length>1)throw new Error(`Only one format variable allowed per image template.
Got: ${l}
From: ${i}`);s=[l[0]]}else s=[];i={url:i},o=new tp({template:i,inputVariables:s,templateFormat:t==null?void 0:t.templateFormat,additionalContentFields:n})}else if(typeof i=="object"){if("url"in i){let u;(t==null?void 0:t.templateFormat)==="mustache"?u=jE(i.url):u=qy(i.url),s=u.flatMap(l=>l.type==="variable"?[l.name]:[])}else s=[];o=new tp({template:i,inputVariables:s,templateFormat:t==null?void 0:t.templateFormat,additionalContentFields:n})}else throw new Error("Invalid image template");r.push(o)}return new this({prompt:r,additionalOptions:t})}async format(e){if(this.prompt instanceof PE){const t=await this.prompt.format(e);return this.createMessage(t)}else{const t=[];for(const r of this.prompt){let n={};if(!("inputVariables"in r))throw new Error(`Prompt ${r} does not have inputVariables defined.`);for(const i of r.inputVariables)n||(n={[i]:e[i]}),n={...n,[i]:e[i]};if(r instanceof PE){const i=await r.format(n);let o;"additionalContentFields"in r&&(o=r.additionalContentFields),t.push({...o,type:"text",text:i})}else if(r instanceof tp){const i=await r.format(n);let o;"additionalContentFields"in r&&(o=r.additionalContentFields),t.push({...o,type:"image_url",image_url:i})}}return this.createMessage(t)}}async formatMessages(e){return[await this.format(e)]}}class lV extends xR{static _messageClass(){return ku}static lc_name(){return"HumanMessagePromptTemplate"}}class SJ extends xR{static _messageClass(){return Hs}static lc_name(){return"AIMessagePromptTemplate"}}class EJ extends xR{static _messageClass(){return dE}static lc_name(){return"SystemMessagePromptTemplate"}}function RJ(a){return typeof a.formatMessages=="function"}function CJ(a,e){if(RJ(a)||If(a))return a;if(Array.isArray(a)&&a[0]==="placeholder"){const n=a[1];if((e==null?void 0:e.templateFormat)==="mustache"&&typeof n=="string"&&n.slice(0,2)==="{{"&&n.slice(-2)==="}}"){const i=n.slice(2,-2);return new Xj({variableName:i,optional:!0})}else if(typeof n=="string"&&n[0]==="{"&&n[n.length-1]==="}"){const i=n.slice(1,-1);return new Xj({variableName:i,optional:!0})}throw new Error(`Invalid placeholder template for format ${(e==null?void 0:e.templateFormat)??'"f-string"'}: "${a[1]}". Expected a variable name surrounded by ${(e==null?void 0:e.templateFormat)==="mustache"?"double":"single"} curly braces.`)}const t=Uu(a);let r;if(typeof t.content=="string"?r=t.content:r=t.content.map(n=>"text"in n?{...n,text:n.text}:"image_url"in n?{...n,image_url:n.image_url}:n),t._getType()==="human")return lV.fromTemplate(r,e);if(t._getType()==="ai")return SJ.fromTemplate(r,e);if(t._getType()==="system")return EJ.fromTemplate(r,e);if(Ac.isInstance(t))return OJ.fromTemplate(t.content,t.role,e);throw new Error(`Could not coerce message prompt template from input. Received message type: "${t._getType()}".`)}function PJ(a){return a.constructor.lc_name()==="MessagesPlaceholder"}class rp extends wJ{static lc_name(){return"ChatPromptTemplate"}get lc_aliases(){return{promptMessages:"messages"}}constructor(e){if(super(e),Object.defineProperty(this,"promptMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"validateTemplate",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"templateFormat",{enumerable:!0,configurable:!0,writable:!0,value:"f-string"}),e.templateFormat==="mustache"&&e.validateTemplate===void 0&&(this.validateTemplate=!1),Object.assign(this,e),this.validateTemplate){const t=new Set;for(const s of this.promptMessages)if(!(s instanceof Ou))for(const u of s.inputVariables)t.add(u);const r=this.inputVariables,n=new Set(this.partialVariables?r.concat(Object.keys(this.partialVariables)):r),i=new Set([...n].filter(s=>!t.has(s)));if(i.size>0)throw new Error(`Input variables \`${[...i]}\` are not used in any of the prompt messages.`);const o=new Set([...t].filter(s=>!n.has(s)));if(o.size>0)throw new Error(`Input variables \`${[...o]}\` are used in prompt messages but not in the prompt template.`)}}_getPromptType(){return"chat"}async _parseImagePrompts(e,t){if(typeof e.content=="string")return e;const r=await Promise.all(e.content.map(async n=>{if(n.type!=="image_url")return n;let i="";typeof n.image_url=="string"?i=n.image_url:i=n.image_url.url;const s=await Bs.fromTemplate(i,{templateFormat:this.templateFormat}).format(t);return typeof n.image_url!="string"&&"url"in n.image_url?n.image_url.url=s:n.image_url=s,n}));return e.content=r,e}async formatMessages(e){const t=await this.mergePartialAndUserVariables(e);let r=[];for(const n of this.promptMessages)if(n instanceof Ou)r.push(await this._parseImagePrompts(n,t));else{const i=n.inputVariables.reduce((s,u)=>{if(!(u in t)&&!(PJ(n)&&n.optional))throw ib(new Error(`Missing value for input variable \`${u.toString()}\``),"INVALID_PROMPT_INPUT");return s[u]=t[u],s},{}),o=await n.formatMessages(i);r=r.concat(o)}return r}async partial(e){const t=this.inputVariables.filter(i=>!(i in e)),r={...this.partialVariables??{},...e},n={...this,inputVariables:t,partialVariables:r};return new rp(n)}static fromTemplate(e,t){const r=Bs.fromTemplate(e,t),n=new lV({prompt:r});return this.fromMessages([n])}static fromMessages(e,t){const r=e.reduce((o,s)=>o.concat(s instanceof rp?s.promptMessages:[CJ(s,t)]),[]),n=e.reduce((o,s)=>s instanceof rp?Object.assign(o,s.partialVariables):o,Object.create(null)),i=new Set;for(const o of r)if(!(o instanceof Ou))for(const s of o.inputVariables)s in n||i.add(s);return new this({...t,inputVariables:[...i],promptMessages:r,partialVariables:n,templateFormat:t==null?void 0:t.templateFormat})}static fromPromptMessages(e){return this.fromMessages(e)}}class ou extends ct{static lc_name(){return"RunnablePassthrough"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"func",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),e&&(this.func=e.func)}async invoke(e,t){const r=ke(t);return this.func&&await this.func(e,r),this._callWithConfig(n=>Promise.resolve(n),e,r)}async*transform(e,t){const r=ke(t);let n,i=!0;for await(const o of this._transformStreamWithConfig(e,s=>s,r))if(yield o,i)if(n===void 0)n=o;else try{n=Dr(n,o)}catch{n=void 0,i=!1}this.func&&n!==void 0&&await this.func(n,r)}static assign(e){return new iV(new $f({steps:e}))}}var Jf={},Zj;function cV(){if(Zj)return Jf;Zj=1,Jf.byteLength=s,Jf.toByteArray=l,Jf.fromByteArray=p;for(var a=[],e=[],t=typeof Uint8Array<"u"?Uint8Array:Array,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=0,i=r.length;n<i;++n)a[n]=r[n],e[r.charCodeAt(n)]=n;e[45]=62,e[95]=63;function o(h){var y=h.length;if(y%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var d=h.indexOf("=");d===-1&&(d=y);var _=d===y?0:4-d%4;return[d,_]}function s(h){var y=o(h),d=y[0],_=y[1];return(d+_)*3/4-_}function u(h,y,d){return(y+d)*3/4-d}function l(h){var y,d=o(h),_=d[0],m=d[1],b=new t(u(h,_,m)),g=0,v=m>0?_-4:_,w;for(w=0;w<v;w+=4)y=e[h.charCodeAt(w)]<<18|e[h.charCodeAt(w+1)]<<12|e[h.charCodeAt(w+2)]<<6|e[h.charCodeAt(w+3)],b[g++]=y>>16&255,b[g++]=y>>8&255,b[g++]=y&255;return m===2&&(y=e[h.charCodeAt(w)]<<2|e[h.charCodeAt(w+1)]>>4,b[g++]=y&255),m===1&&(y=e[h.charCodeAt(w)]<<10|e[h.charCodeAt(w+1)]<<4|e[h.charCodeAt(w+2)]>>2,b[g++]=y>>8&255,b[g++]=y&255),b}function c(h){return a[h>>18&63]+a[h>>12&63]+a[h>>6&63]+a[h&63]}function f(h,y,d){for(var _,m=[],b=y;b<d;b+=3)_=(h[b]<<16&16711680)+(h[b+1]<<8&65280)+(h[b+2]&255),m.push(c(_));return m.join("")}function p(h){for(var y,d=h.length,_=d%3,m=[],b=16383,g=0,v=d-_;g<v;g+=b)m.push(f(h,g,g+b>v?v:g+b));return _===1?(y=h[d-1],m.push(a[y>>2]+a[y<<4&63]+"==")):_===2&&(y=(h[d-2]<<8)+h[d-1],m.push(a[y>>10]+a[y>>4&63]+a[y<<2&63]+"=")),m.join("")}return Jf}var jJ=cV();const TJ=Np(jJ);var MJ=Object.defineProperty,AJ=(a,e,t)=>e in a?MJ(a,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[e]=t,IJ=(a,e,t)=>(AJ(a,e+"",t),t);function DJ(a,e){let t=Array.from({length:a.length},(r,n)=>({start:n,end:n+1}));for(;t.length>1;){let r=null;for(let n=0;n<t.length-1;n++){const i=a.slice(t[n].start,t[n+1].end),o=e.get(i.join(","));o!=null&&(r==null||o<r[0])&&(r=[o,n])}if(r!=null){const n=r[1];t[n]={start:t[n].start,end:t[n+1].end},t.splice(n+1,1)}else break}return t}function xJ(a,e){return a.length===1?[e.get(a.join(","))]:DJ(a,e).map(t=>e.get(a.slice(t.start,t.end).join(","))).filter(t=>t!=null)}function $J(a){return a.replace(/[\\^$*+?.()|[\]{}]/g,"\\$&")}var ME=class{constructor(a,e){Zs(this,"specialTokens");Zs(this,"inverseSpecialTokens");Zs(this,"patStr");Zs(this,"textEncoder",new TextEncoder);Zs(this,"textDecoder",new TextDecoder("utf-8"));Zs(this,"rankMap",new Map);Zs(this,"textMap",new Map);this.patStr=a.pat_str;const t=a.bpe_ranks.split(`
`).filter(Boolean).reduce((r,n)=>{const[i,o,...s]=n.split(" "),u=Number.parseInt(o,10);return s.forEach((l,c)=>r[l]=u+c),r},{});for(const[r,n]of Object.entries(t)){const i=TJ.toByteArray(r);this.rankMap.set(i.join(","),n),this.textMap.set(n,i)}this.specialTokens={...a.special_tokens,...e},this.inverseSpecialTokens=Object.entries(this.specialTokens).reduce((r,[n,i])=>(r[i]=this.textEncoder.encode(n),r),{})}encode(a,e=[],t="all"){const r=new RegExp(this.patStr,"ug"),n=ME.specialTokenRegex(Object.keys(this.specialTokens)),i=[],o=new Set(e==="all"?Object.keys(this.specialTokens):e),s=new Set(t==="all"?Object.keys(this.specialTokens).filter(l=>!o.has(l)):t);if(s.size>0){const l=ME.specialTokenRegex([...s]),c=a.match(l);if(c!=null)throw new Error(`The text contains a special token that is not allowed: ${c[0]}`)}let u=0;for(;;){let l=null,c=u;for(;n.lastIndex=c,l=n.exec(a),!(l==null||o.has(l[0]));)c=l.index+1;const f=(l==null?void 0:l.index)??a.length;for(const h of a.substring(u,f).matchAll(r)){const y=this.textEncoder.encode(h[0]),d=this.rankMap.get(y.join(","));if(d!=null){i.push(d);continue}i.push(...xJ(y,this.rankMap))}if(l==null)break;let p=this.specialTokens[l[0]];i.push(p),u=l.index+l[0].length}return i}decode(a){const e=[];let t=0;for(let i=0;i<a.length;++i){const o=a[i],s=this.textMap.get(o)??this.inverseSpecialTokens[o];s!=null&&(e.push(s),t+=s.length)}const r=new Uint8Array(t);let n=0;for(const i of e)r.set(i,n),n+=i.length;return this.textDecoder.decode(r)}},fV=ME;IJ(fV,"specialTokenRegex",a=>new RegExp(a.map(e=>$J(e)).join("|"),"g"));function NJ(a){switch(a){case"gpt2":return"gpt2";case"code-cushman-001":case"code-cushman-002":case"code-davinci-001":case"code-davinci-002":case"cushman-codex":case"davinci-codex":case"davinci-002":case"text-davinci-002":case"text-davinci-003":return"p50k_base";case"code-davinci-edit-001":case"text-davinci-edit-001":return"p50k_edit";case"ada":case"babbage":case"babbage-002":case"code-search-ada-code-001":case"code-search-babbage-code-001":case"curie":case"davinci":case"text-ada-001":case"text-babbage-001":case"text-curie-001":case"text-davinci-001":case"text-search-ada-doc-001":case"text-search-babbage-doc-001":case"text-search-curie-doc-001":case"text-search-davinci-doc-001":case"text-similarity-ada-001":case"text-similarity-babbage-001":case"text-similarity-curie-001":case"text-similarity-davinci-001":return"r50k_base";case"gpt-3.5-turbo-instruct-0914":case"gpt-3.5-turbo-instruct":case"gpt-3.5-turbo-16k-0613":case"gpt-3.5-turbo-16k":case"gpt-3.5-turbo-0613":case"gpt-3.5-turbo-0301":case"gpt-3.5-turbo":case"gpt-4-32k-0613":case"gpt-4-32k-0314":case"gpt-4-32k":case"gpt-4-0613":case"gpt-4-0314":case"gpt-4":case"gpt-3.5-turbo-1106":case"gpt-35-turbo":case"gpt-4-1106-preview":case"gpt-4-vision-preview":case"gpt-3.5-turbo-0125":case"gpt-4-turbo":case"gpt-4-turbo-2024-04-09":case"gpt-4-turbo-preview":case"gpt-4-0125-preview":case"text-embedding-ada-002":case"text-embedding-3-small":case"text-embedding-3-large":return"cl100k_base";case"gpt-4o":case"gpt-4o-2024-05-13":case"gpt-4o-2024-08-06":case"gpt-4o-2024-11-20":case"gpt-4o-mini-2024-07-18":case"gpt-4o-mini":case"o1":case"o1-2024-12-17":case"o1-mini":case"o1-preview":case"o1-preview-2024-09-12":case"o1-mini-2024-09-12":case"o3-mini":case"o3-mini-2025-01-31":case"chatgpt-4o-latest":case"gpt-4o-realtime":case"gpt-4o-realtime-preview-2024-10-01":return"o200k_base";default:throw new Error("Unknown model")}}const g_={},qJ=new Vp({});async function zJ(a){return a in g_||(g_[a]=qJ.fetch(`https://tiktoken.pages.dev/js/${a}.json`).then(e=>e.json()).then(e=>new fV(e)).catch(e=>{throw delete g_[a],e})),await g_[a]}async function BJ(a){return zJ(NJ(a))}class UJ extends G2{constructor(e){if(super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","document_transformers","text_splitters"]}),Object.defineProperty(this,"chunkSize",{enumerable:!0,configurable:!0,writable:!0,value:1e3}),Object.defineProperty(this,"chunkOverlap",{enumerable:!0,configurable:!0,writable:!0,value:200}),Object.defineProperty(this,"keepSeparator",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lengthFunction",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.chunkSize=(e==null?void 0:e.chunkSize)??this.chunkSize,this.chunkOverlap=(e==null?void 0:e.chunkOverlap)??this.chunkOverlap,this.keepSeparator=(e==null?void 0:e.keepSeparator)??this.keepSeparator,this.lengthFunction=(e==null?void 0:e.lengthFunction)??(t=>t.length),this.chunkOverlap>=this.chunkSize)throw new Error("Cannot have chunkOverlap >= chunkSize")}async transformDocuments(e,t={}){return this.splitDocuments(e,t)}splitOnSeparator(e,t){let r;if(t)if(this.keepSeparator){const n=t.replace(/[/\-\\^$*+?.()|[\]{}]/g,"\\$&");r=e.split(new RegExp(`(?=${n})`))}else r=e.split(t);else r=e.split("");return r.filter(n=>n!=="")}async createDocuments(e,t=[],r={}){const n=t.length>0?t:[...Array(e.length)].map(()=>({})),{chunkHeader:i="",chunkOverlapHeader:o="(cont'd) ",appendChunkOverlapHeader:s=!1}=r,u=new Array;for(let l=0;l<e.length;l+=1){const c=e[l];let f=1,p=null,h=-1;for(const y of await this.splitText(c)){let d=i;const _=c.indexOf(y,h+1);if(p===null){const v=this.numberOfNewLines(c,0,_);f+=v}else{const v=h+await this.lengthFunction(p);if(v<_){const w=this.numberOfNewLines(c,v,_);f+=w}else if(v>_){const w=this.numberOfNewLines(c,_,v);f-=w}s&&(d+=o)}const m=this.numberOfNewLines(y),b=n[l].loc&&typeof n[l].loc=="object"?{...n[l].loc}:{};b.lines={from:f,to:f+m};const g={...n[l],loc:b};d+=y,u.push(new Fu({pageContent:d,metadata:g})),f+=m,p=y,h=_}}return u}numberOfNewLines(e,t,r){return(e.slice(t,r).match(/\n/g)||[]).length}async splitDocuments(e,t={}){const r=e.filter(o=>o.pageContent!==void 0),n=r.map(o=>o.pageContent),i=r.map(o=>o.metadata);return this.createDocuments(n,i,t)}joinDocs(e,t){const r=e.join(t).trim();return r===""?null:r}async mergeSplits(e,t){const r=[],n=[];let i=0;for(const s of e){const u=await this.lengthFunction(s);if(i+u+n.length*t.length>this.chunkSize&&(i>this.chunkSize&&console.warn(`Created a chunk of size ${i}, +
which is longer than the specified ${this.chunkSize}`),n.length>0)){const l=this.joinDocs(n,t);for(l!==null&&r.push(l);i>this.chunkOverlap||i+u+n.length*t.length>this.chunkSize&&i>0;)i-=await this.lengthFunction(n[0]),n.shift()}n.push(s),i+=u}const o=this.joinDocs(n,t);return o!==null&&r.push(o),r}}class zy extends UJ{static lc_name(){return"RecursiveCharacterTextSplitter"}constructor(e){super(e),Object.defineProperty(this,"separators",{enumerable:!0,configurable:!0,writable:!0,value:[`

`,`
`," ",""]}),this.separators=(e==null?void 0:e.separators)??this.separators,this.keepSeparator=(e==null?void 0:e.keepSeparator)??!0}async _splitText(e,t){const r=[];let n=t[t.length-1],i;for(let l=0;l<t.length;l+=1){const c=t[l];if(c===""){n=c;break}if(e.includes(c)){n=c,i=t.slice(l+1);break}}const o=this.splitOnSeparator(e,n);let s=[];const u=this.keepSeparator?"":n;for(const l of o)if(await this.lengthFunction(l)<this.chunkSize)s.push(l);else{if(s.length){const c=await this.mergeSplits(s,u);r.push(...c),s=[]}if(!i)r.push(l);else{const c=await this._splitText(l,i);r.push(...c)}}if(s.length){const l=await this.mergeSplits(s,u);r.push(...l)}return r}async splitText(e){return this._splitText(e,this.separators)}static fromLanguage(e,t){return new zy({...t,separators:zy.getSeparatorsForLanguage(e)})}static getSeparatorsForLanguage(e){if(e==="cpp")return[`
class `,`
void `,`
int `,`
float `,`
double `,`
if `,`
for `,`
while `,`
switch `,`
case `,`

`,`
`," ",""];if(e==="go")return[`
func `,`
var `,`
const `,`
type `,`
if `,`
for `,`
switch `,`
case `,`

`,`
`," ",""];if(e==="java")return[`
class `,`
public `,`
protected `,`
private `,`
static `,`
if `,`
for `,`
while `,`
switch `,`
case `,`

`,`
`," ",""];if(e==="js")return[`
function `,`
const `,`
let `,`
var `,`
class `,`
if `,`
for `,`
while `,`
switch `,`
case `,`
default `,`

`,`
`," ",""];if(e==="php")return[`
function `,`
class `,`
if `,`
foreach `,`
while `,`
do `,`
switch `,`
case `,`

`,`
`," ",""];if(e==="proto")return[`
message `,`
service `,`
enum `,`
option `,`
import `,`
syntax `,`

`,`
`," ",""];if(e==="python")return[`
class `,`
def `,`
	def `,`

`,`
`," ",""];if(e==="rst")return[`
===
`,`
---
`,`
***
`,`
.. `,`

`,`
`," ",""];if(e==="ruby")return[`
def `,`
class `,`
if `,`
unless `,`
while `,`
for `,`
do `,`
begin `,`
rescue `,`

`,`
`," ",""];if(e==="rust")return[`
fn `,`
const `,`
let `,`
if `,`
while `,`
for `,`
loop `,`
match `,`
const `,`

`,`
`," ",""];if(e==="scala")return[`
class `,`
object `,`
def `,`
val `,`
var `,`
if `,`
for `,`
while `,`
match `,`
case `,`

`,`
`," ",""];if(e==="swift")return[`
func `,`
class `,`
struct `,`
enum `,`
if `,`
for `,`
while `,`
do `,`
switch `,`
case `,`

`,`
`," ",""];if(e==="markdown")return[`
## `,`
### `,`
#### `,`
##### `,`
###### `,"```\n\n",`

***

`,`

---

`,`

___

`,`

`,`
`," ",""];if(e==="latex")return[`
\\chapter{`,`
\\section{`,`
\\subsection{`,`
\\subsubsection{`,`
\\begin{enumerate}`,`
\\begin{itemize}`,`
\\begin{description}`,`
\\begin{list}`,`
\\begin{quote}`,`
\\begin{quotation}`,`
\\begin{verse}`,`
\\begin{verbatim}`,`
\\begin{align}`,"$$","$",`

`,`
`," ",""];if(e==="html")return["<body>","<div>","<p>","<br>","<li>","<h1>","<h2>","<h3>","<h4>","<h5>","<h6>","<span>","<table>","<tr>","<td>","<th>","<ul>","<ol>","<header>","<footer>","<nav>","<head>","<style>","<script>","<meta>","<title>"," ",""];if(e==="sol")return[`
pragma `,`
using `,`
contract `,`
interface `,`
library `,`
constructor `,`
type `,`
function `,`
event `,`
modifier `,`
error `,`
struct `,`
enum `,`
if `,`
for `,`
while `,`
do while `,`
assembly `,`

`,`
`," ",""];throw new Error(`Language ${e} is not supported.`)}}async function FJ(a,e,t){try{let r=[];if(e=="repo"){const n=a.match(/https:\/\/github\.com\/([^\/]+)\/([^\/]+)/);if(!n)throw new Error("Invalid GitHub repository URL");const i=n[1],o=n[2];r=await LJ(i,o,"main",t)}else if(e=="folder"){const n=a.match(/https:\/\/github\.com\/([^\/]+)\/([^\/]+)\/tree\/([^\/]+)\/(.+)/);if(!n)throw new Error("Invalid GitHub folder URL");const i=n[1],o=n[2],s=n[3],u=n[4];r=await $R(i,o,s,u,t)}else if(e=="single"){const n=a.match(/https:\/\/github\.com\/([^\/]+)\/([^\/]+)\/blob\/([^\/]+)\/(.+)/);if(!n)throw new Error("Invalid GitHub file URL");const i=n[1],o=n[2],s=n[3],u=n[4],l=await dV(`https://raw.githubusercontent.com/${i}/${o}/${s}/${u}`);r=[new Fu({pageContent:l,metadata:{source:u}})]}return r}catch(r){return console.error("Error fetching repository contents:",r),[]}}async function $R(a,e,t,r="",n){const i=`https://api.github.com/repos/${a}/${e}/contents/${r}?ref=${t}`,o=n?{Authorization:`Bearer ${n}`}:{};try{const s=await fetch(i,{headers:o});if(!s.ok)throw new Error(`HTTP error! Status: ${s.status}`);const u=await s.json();let l=[];for(const c of u)if(c.type==="file")l.push(c);else if(c.type==="dir"){const f=await $R(a,e,t,c.path,n);l=l.concat(f)}return l}catch(s){return console.error("Error fetching repository contents:",s),[]}}async function dV(a,e=null){const t=e?{Authorization:`Bearer ${e}`}:{};try{const r=await fetch(a,{headers:t});if(!r.ok)throw new Error(`HTTP error! Status: ${r.status}`);return await r.text()}catch(r){return console.error("Error fetching file content:",r),null}}async function LJ(a,e,t,r=null){const n=await $R(a,e,t,"",r),i=[];for(const o of n)if(o.url){const s=await dV(o.url,r);if(s){const u=JSON.parse(s),l=atob(u.content);i.push(new Fu({pageContent:l,metadata:{source:o.path,url:o.html_url}}))}}return i}async function VJ(a){const e=[];for(const t of a){const r=JSON.stringify(t);e.push(new Fu({pageContent:r}))}return e}const AE="RFC3986",IE={RFC1738:a=>String(a).replace(/%20/g,"+"),RFC3986:a=>String(a)},GJ="RFC1738",kJ=Array.isArray,Qs=(()=>{const a=[];for(let e=0;e<256;++e)a.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return a})(),yg=1024,HJ=(a,e,t,r,n)=>{if(a.length===0)return a;let i=a;if(typeof a=="symbol"?i=Symbol.prototype.toString.call(a):typeof a!="string"&&(i=String(a)),t==="iso-8859-1")return escape(i).replace(/%u[0-9a-f]{4}/gi,function(s){return"%26%23"+parseInt(s.slice(2),16)+"%3B"});let o="";for(let s=0;s<i.length;s+=yg){const u=i.length>=yg?i.slice(s,s+yg):i,l=[];for(let c=0;c<u.length;++c){let f=u.charCodeAt(c);if(f===45||f===46||f===95||f===126||f>=48&&f<=57||f>=65&&f<=90||f>=97&&f<=122||n===GJ&&(f===40||f===41)){l[l.length]=u.charAt(c);continue}if(f<128){l[l.length]=Qs[f];continue}if(f<2048){l[l.length]=Qs[192|f>>6]+Qs[128|f&63];continue}if(f<55296||f>=57344){l[l.length]=Qs[224|f>>12]+Qs[128|f>>6&63]+Qs[128|f&63];continue}c+=1,f=65536+((f&1023)<<10|u.charCodeAt(c)&1023),l[l.length]=Qs[240|f>>18]+Qs[128|f>>12&63]+Qs[128|f>>6&63]+Qs[128|f&63]}o+=l.join("")}return o};function WJ(a){return!a||typeof a!="object"?!1:!!(a.constructor&&a.constructor.isBuffer&&a.constructor.isBuffer(a))}function Qj(a,e){if(kJ(a)){const t=[];for(let r=0;r<a.length;r+=1)t.push(e(a[r]));return t}return e(a)}const KJ=Object.prototype.hasOwnProperty,hV={brackets(a){return String(a)+"[]"},comma:"comma",indices(a,e){return String(a)+"["+e+"]"},repeat(a){return String(a)}},Ys=Array.isArray,JJ=Array.prototype.push,pV=function(a,e){JJ.apply(a,Ys(e)?e:[e])},XJ=Date.prototype.toISOString,bt={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:HJ,encodeValuesOnly:!1,format:AE,formatter:IE[AE],indices:!1,serializeDate(a){return XJ.call(a)},skipNulls:!1,strictNullHandling:!1};function ZJ(a){return typeof a=="string"||typeof a=="number"||typeof a=="boolean"||typeof a=="symbol"||typeof a=="bigint"}const bg={};function _V(a,e,t,r,n,i,o,s,u,l,c,f,p,h,y,d,_,m){let b=a,g=m,v=0,w=!1;for(;(g=g.get(bg))!==void 0&&!w;){const T=g.get(a);if(v+=1,typeof T<"u"){if(T===v)throw new RangeError("Cyclic object value");w=!0}typeof g.get(bg)>"u"&&(v=0)}if(typeof l=="function"?b=l(e,b):b instanceof Date?b=p==null?void 0:p(b):t==="comma"&&Ys(b)&&(b=Qj(b,function(T){return T instanceof Date?p==null?void 0:p(T):T})),b===null){if(i)return u&&!d?u(e,bt.encoder,_,"key",h):e;b=""}if(ZJ(b)||WJ(b)){if(u){const T=d?e:u(e,bt.encoder,_,"key",h);return[(y==null?void 0:y(T))+"="+(y==null?void 0:y(u(b,bt.encoder,_,"value",h)))]}return[(y==null?void 0:y(e))+"="+(y==null?void 0:y(String(b)))]}const S=[];if(typeof b>"u")return S;let R;if(t==="comma"&&Ys(b))d&&u&&(b=Qj(b,u)),R=[{value:b.length>0?b.join(",")||null:void 0}];else if(Ys(l))R=l;else{const T=Object.keys(b);R=c?T.sort(c):T}const P=s?String(e).replace(/\./g,"%2E"):String(e),C=r&&Ys(b)&&b.length===1?P+"[]":P;if(n&&Ys(b)&&b.length===0)return C+"[]";for(let T=0;T<R.length;++T){const M=R[T],K=typeof M=="object"&&typeof M.value<"u"?M.value:b[M];if(o&&K===null)continue;const q=f&&s?M.replace(/\./g,"%2E"):M,B=Ys(b)?typeof t=="function"?t(C,q):C:C+(f?"."+q:"["+q+"]");m.set(a,v);const H=new WeakMap;H.set(bg,m),pV(S,_V(K,B,t,r,n,i,o,s,t==="comma"&&d&&Ys(b)?null:u,l,c,f,p,h,y,d,_,H))}return S}function QJ(a=bt){if(typeof a.allowEmptyArrays<"u"&&typeof a.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof a.encodeDotInKeys<"u"&&typeof a.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(a.encoder!==null&&typeof a.encoder<"u"&&typeof a.encoder!="function")throw new TypeError("Encoder has to be a function.");const e=a.charset||bt.charset;if(typeof a.charset<"u"&&a.charset!=="utf-8"&&a.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let t=AE;if(typeof a.format<"u"){if(!KJ.call(IE,a.format))throw new TypeError("Unknown format option provided.");t=a.format}const r=IE[t];let n=bt.filter;(typeof a.filter=="function"||Ys(a.filter))&&(n=a.filter);let i;if(a.arrayFormat&&a.arrayFormat in hV?i=a.arrayFormat:"indices"in a?i=a.indices?"indices":"repeat":i=bt.arrayFormat,"commaRoundTrip"in a&&typeof a.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");const o=typeof a.allowDots>"u"?a.encodeDotInKeys?!0:bt.allowDots:!!a.allowDots;return{addQueryPrefix:typeof a.addQueryPrefix=="boolean"?a.addQueryPrefix:bt.addQueryPrefix,allowDots:o,allowEmptyArrays:typeof a.allowEmptyArrays=="boolean"?!!a.allowEmptyArrays:bt.allowEmptyArrays,arrayFormat:i,charset:e,charsetSentinel:typeof a.charsetSentinel=="boolean"?a.charsetSentinel:bt.charsetSentinel,commaRoundTrip:!!a.commaRoundTrip,delimiter:typeof a.delimiter>"u"?bt.delimiter:a.delimiter,encode:typeof a.encode=="boolean"?a.encode:bt.encode,encodeDotInKeys:typeof a.encodeDotInKeys=="boolean"?a.encodeDotInKeys:bt.encodeDotInKeys,encoder:typeof a.encoder=="function"?a.encoder:bt.encoder,encodeValuesOnly:typeof a.encodeValuesOnly=="boolean"?a.encodeValuesOnly:bt.encodeValuesOnly,filter:n,format:t,formatter:r,serializeDate:typeof a.serializeDate=="function"?a.serializeDate:bt.serializeDate,skipNulls:typeof a.skipNulls=="boolean"?a.skipNulls:bt.skipNulls,sort:typeof a.sort=="function"?a.sort:null,strictNullHandling:typeof a.strictNullHandling=="boolean"?a.strictNullHandling:bt.strictNullHandling}}function YJ(a,e={}){let t=a;const r=QJ(e);let n,i;typeof r.filter=="function"?(i=r.filter,t=i("",t)):Ys(r.filter)&&(i=r.filter,n=i);const o=[];if(typeof t!="object"||t===null)return"";const s=hV[r.arrayFormat],u=s==="comma"&&r.commaRoundTrip;n||(n=Object.keys(t)),r.sort&&n.sort(r.sort);const l=new WeakMap;for(let p=0;p<n.length;++p){const h=n[p];r.skipNulls&&t[h]===null||pV(o,_V(t[h],h,s,u,r.allowEmptyArrays,r.strictNullHandling,r.skipNulls,r.encodeDotInKeys,r.encode?r.encoder:null,r.filter,r.sort,r.allowDots,r.serializeDate,r.format,r.formatter,r.encodeValuesOnly,r.charset,l))}const c=o.join(r.delimiter);let f=r.addQueryPrefix===!0?"?":"";return r.charsetSentinel&&(r.charset==="iso-8859-1"?f+="utf8=%26%2310003%3B&":f+="utf8=%E2%9C%93&"),c.length>0?f+c:""}const Jc="4.87.3";let Yj=!1,np,yV,bV,DE,mV,gV,vV,wV,OV;function eX(a,e={auto:!1}){if(Yj)throw new Error(`you must \`import 'openai/shims/${a.kind}'\` before importing anything else from openai`);if(np)throw new Error(`can't \`import 'openai/shims/${a.kind}'\` after \`import 'openai/shims/${np}'\``);Yj=e.auto,np=a.kind,yV=a.fetch,bV=a.FormData,DE=a.File,mV=a.ReadableStream,gV=a.getMultipartRequestOptions,vV=a.getDefaultAgent,wV=a.fileFromPath,OV=a.isFsReadStream}let tX=class{constructor(e){this.body=e}get[Symbol.toStringTag](){return"MultipartBody"}};function rX({manuallyImported:a}={}){const e=a?"You may need to use polyfills":"Add one of these imports before your first `import  from 'openai'`:\n- `import 'openai/shims/node'` (if you're running on Node)\n- `import 'openai/shims/web'` (otherwise)\n";let t,r,n,i;try{t=fetch,r=Request,n=Response,i=Headers}catch(o){throw new Error(`this environment is missing the following Web Fetch API type: ${o.message}. ${e}`)}return{kind:"web",fetch:t,Request:r,Response:n,Headers:i,FormData:typeof FormData<"u"?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${e}`)}},Blob:typeof Blob<"u"?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${e}`)}},File:typeof File<"u"?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${e}`)}},ReadableStream:typeof ReadableStream<"u"?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${e}`)}},getMultipartRequestOptions:async(o,s)=>({...s,body:new tX(o)}),getDefaultAgent:o=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/openai/openai-node#file-uploads")},isFsReadStream:o=>!1}}np||eX(rX(),{auto:!0});class Pe extends Error{}let or=class xE extends Pe{constructor(e,t,r,n){super(`${xE.makeMessage(e,t,r)}`),this.status=e,this.headers=n,this.request_id=n==null?void 0:n["x-request-id"],this.error=t;const i=t;this.code=i==null?void 0:i.code,this.param=i==null?void 0:i.param,this.type=i==null?void 0:i.type}static makeMessage(e,t,r){const n=t!=null&&t.message?typeof t.message=="string"?t.message:JSON.stringify(t.message):t?JSON.stringify(t):r;return e&&n?`${e} ${n}`:e?`${e} status code (no body)`:n||"(no status code or body)"}static generate(e,t,r,n){if(!e||!n)return new _b({message:r,cause:NE(t)});const i=t==null?void 0:t.error;return e===400?new SV(e,i,r,n):e===401?new EV(e,i,r,n):e===403?new RV(e,i,r,n):e===404?new CV(e,i,r,n):e===409?new PV(e,i,r,n):e===422?new jV(e,i,r,n):e===429?new TV(e,i,r,n):e>=500?new MV(e,i,r,n):new xE(e,i,r,n)}},gr=class extends or{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}},_b=class extends or{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),t&&(this.cause=t)}},yb=class extends _b{constructor({message:e}={}){super({message:e??"Request timed out."})}},SV=class extends or{},EV=class extends or{},RV=class extends or{},CV=class extends or{},PV=class extends or{},jV=class extends or{},TV=class extends or{},MV=class extends or{};class AV extends Pe{constructor(){super("Could not parse response content as the length limit was reached")}}class IV extends Pe{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}var v_=function(a,e,t,r,n){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?a!==e||!n:!e.has(a))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?n.call(a,t):n?n.value=t:e.set(a,t),t},fl=function(a,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?a!==e||!r:!e.has(a))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(a):r?r.value:e.get(a)},pr;let bb=class{constructor(){pr.set(this,void 0),this.buffer=new Uint8Array,v_(this,pr,null,"f")}decode(e){if(e==null)return[];const t=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?new TextEncoder().encode(e):e;let r=new Uint8Array(this.buffer.length+t.length);r.set(this.buffer),r.set(t,this.buffer.length),this.buffer=r;const n=[];let i;for(;(i=nX(this.buffer,fl(this,pr,"f")))!=null;){if(i.carriage&&fl(this,pr,"f")==null){v_(this,pr,i.index,"f");continue}if(fl(this,pr,"f")!=null&&(i.index!==fl(this,pr,"f")+1||i.carriage)){n.push(this.decodeText(this.buffer.slice(0,fl(this,pr,"f")-1))),this.buffer=this.buffer.slice(fl(this,pr,"f")),v_(this,pr,null,"f");continue}const o=fl(this,pr,"f")!==null?i.preceding-1:i.preceding,s=this.decodeText(this.buffer.slice(0,o));n.push(s),this.buffer=this.buffer.slice(i.index),v_(this,pr,null,"f")}return n}decodeText(e){if(e==null)return"";if(typeof e=="string")return e;if(typeof Buffer<"u"){if(e instanceof Buffer)return e.toString();if(e instanceof Uint8Array)return Buffer.from(e).toString();throw new Pe(`Unexpected: received non-Uint8Array (${e.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if(typeof TextDecoder<"u"){if(e instanceof Uint8Array||e instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(e);throw new Pe(`Unexpected: received non-Uint8Array/ArrayBuffer (${e.constructor.name}) in a web platform. Please report this error.`)}throw new Pe("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){return this.buffer.length?this.decode(`
`):[]}};pr=new WeakMap;bb.NEWLINE_CHARS=new Set([`
`,"\r"]);bb.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function nX(a,e){for(let n=e??0;n<a.length;n++){if(a[n]===10)return{preceding:n,index:n+1,carriage:!1};if(a[n]===13)return{preceding:n,index:n+1,carriage:!0}}return null}function iX(a){for(let r=0;r<a.length-1;r++){if(a[r]===10&&a[r+1]===10||a[r]===13&&a[r+1]===13)return r+2;if(a[r]===13&&a[r+1]===10&&r+3<a.length&&a[r+2]===13&&a[r+3]===10)return r+4}return-1}function DV(a){if(a[Symbol.asyncIterator])return a;const e=a.getReader();return{async next(){try{const t=await e.read();return t!=null&&t.done&&e.releaseLock(),t}catch(t){throw e.releaseLock(),t}},async return(){const t=e.cancel();return e.releaseLock(),await t,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}let Pp=class Lh{constructor(e,t){this.iterator=e,this.controller=t}static fromSSEResponse(e,t){let r=!1;async function*n(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let i=!1;try{for await(const o of aX(e,t))if(!i){if(o.data.startsWith("[DONE]")){i=!0;continue}if(o.event===null||o.event.startsWith("response.")){let s;try{s=JSON.parse(o.data)}catch(u){throw console.error("Could not parse message into JSON:",o.data),console.error("From chunk:",o.raw),u}if(s&&s.error)throw new or(void 0,s.error,void 0,void 0);yield s}else{let s;try{s=JSON.parse(o.data)}catch(u){throw console.error("Could not parse message into JSON:",o.data),console.error("From chunk:",o.raw),u}if(o.event=="error")throw new or(void 0,s.error,s.message,void 0);yield{event:o.event,data:s}}}i=!0}catch(o){if(o instanceof Error&&o.name==="AbortError")return;throw o}finally{i||t.abort()}}return new Lh(n,t)}static fromReadableStream(e,t){let r=!1;async function*n(){const o=new bb,s=DV(e);for await(const u of s)for(const l of o.decode(u))yield l;for(const u of o.flush())yield u}async function*i(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let o=!1;try{for await(const s of n())o||s&&(yield JSON.parse(s));o=!0}catch(s){if(s instanceof Error&&s.name==="AbortError")return;throw s}finally{o||t.abort()}}return new Lh(i,t)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],t=[],r=this.iterator(),n=i=>({next:()=>{if(i.length===0){const o=r.next();e.push(o),t.push(o)}return i.shift()}});return[new Lh(()=>n(e),this.controller),new Lh(()=>n(t),this.controller)]}toReadableStream(){const e=this;let t;const r=new TextEncoder;return new mV({async start(){t=e[Symbol.asyncIterator]()},async pull(n){try{const{value:i,done:o}=await t.next();if(o)return n.close();const s=r.encode(JSON.stringify(i)+`
`);n.enqueue(s)}catch(i){n.error(i)}},async cancel(){var n;await((n=t.return)==null?void 0:n.call(t))}})}};async function*aX(a,e){if(!a.body)throw e.abort(),new Pe("Attempted to iterate over a response with no body");const t=new sX,r=new bb,n=DV(a.body);for await(const i of oX(n))for(const o of r.decode(i)){const s=t.decode(o);s&&(yield s)}for(const i of r.flush()){const o=t.decode(i);o&&(yield o)}}async function*oX(a){let e=new Uint8Array;for await(const t of a){if(t==null)continue;const r=t instanceof ArrayBuffer?new Uint8Array(t):typeof t=="string"?new TextEncoder().encode(t):t;let n=new Uint8Array(e.length+r.length);n.set(e),n.set(r,e.length),e=n;let i;for(;(i=iX(e))!==-1;)yield e.slice(0,i),e=e.slice(i)}e.length>0&&(yield e)}let sX=class{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const i={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],i}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,r,n]=uX(e,":");return n.startsWith(" ")&&(n=n.substring(1)),t==="event"?this.event=n:t==="data"&&this.data.push(n),null}};function uX(a,e){const t=a.indexOf(e);return t!==-1?[a.substring(0,t),e,a.substring(t+e.length)]:[a,"",""]}const xV=a=>a!=null&&typeof a=="object"&&typeof a.url=="string"&&typeof a.blob=="function",$V=a=>a!=null&&typeof a=="object"&&typeof a.name=="string"&&typeof a.lastModified=="number"&&mb(a),mb=a=>a!=null&&typeof a=="object"&&typeof a.size=="number"&&typeof a.type=="string"&&typeof a.text=="function"&&typeof a.slice=="function"&&typeof a.arrayBuffer=="function",lX=a=>$V(a)||xV(a)||OV(a);async function NV(a,e,t){var n;if(a=await a,$V(a))return a;if(xV(a)){const i=await a.blob();e||(e=new URL(a.url).pathname.split(/[\\/]/).pop()??"unknown_file");const o=mb(i)?[await i.arrayBuffer()]:[i];return new DE(o,e,t)}const r=await cX(a);if(e||(e=dX(a)??"unknown_file"),!(t!=null&&t.type)){const i=(n=r[0])==null?void 0:n.type;typeof i=="string"&&(t={...t,type:i})}return new DE(r,e,t)}async function cX(a){var t;let e=[];if(typeof a=="string"||ArrayBuffer.isView(a)||a instanceof ArrayBuffer)e.push(a);else if(mb(a))e.push(await a.arrayBuffer());else if(hX(a))for await(const r of a)e.push(r);else throw new Error(`Unexpected data type: ${typeof a}; constructor: ${(t=a==null?void 0:a.constructor)==null?void 0:t.name}; props: ${fX(a)}`);return e}function fX(a){return`[${Object.getOwnPropertyNames(a).map(t=>`"${t}"`).join(", ")}]`}function dX(a){var e;return mg(a.name)||mg(a.filename)||((e=mg(a.path))==null?void 0:e.split(/[\\/]/).pop())}const mg=a=>{if(typeof a=="string")return a;if(typeof Buffer<"u"&&a instanceof Buffer)return String(a)},hX=a=>a!=null&&typeof a=="object"&&typeof a[Symbol.asyncIterator]=="function",e1=a=>a&&typeof a=="object"&&a.body&&a[Symbol.toStringTag]==="MultipartBody",Pf=async a=>{const e=await pX(a.body);return gV(e,a)},pX=async a=>{const e=new bV;return await Promise.all(Object.entries(a||{}).map(([t,r])=>$E(e,t,r))),e},$E=async(a,e,t)=>{if(t!==void 0){if(t==null)throw new TypeError(`Received null for "${e}"; to pass null in FormData, you must use the string 'null'`);if(typeof t=="string"||typeof t=="number"||typeof t=="boolean")a.append(e,String(t));else if(lX(t)){const r=await NV(t);a.append(e,r)}else if(Array.isArray(t))await Promise.all(t.map(r=>$E(a,e+"[]",r)));else if(typeof t=="object")await Promise.all(Object.entries(t).map(([r,n])=>$E(a,`${e}[${r}]`,n)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${t} instead`)}};var ff={},_X=function(a,e,t,r,n){if(typeof e=="function"?a!==e||!0:!e.has(a))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(a,t),t},yX=function(a,e,t,r){if(typeof e=="function"?a!==e||!0:!e.has(a))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(a):r?r.value:e.get(a)},w_;async function qV(a){var o;const{response:e}=a;if(a.options.stream)return df("response",e.status,e.url,e.headers,e.body),a.options.__streamClass?a.options.__streamClass.fromSSEResponse(e,a.controller):Pp.fromSSEResponse(e,a.controller);if(e.status===204)return null;if(a.options.__binaryResponse)return e;const t=e.headers.get("content-type"),r=(o=t==null?void 0:t.split(";")[0])==null?void 0:o.trim();if((r==null?void 0:r.includes("application/json"))||(r==null?void 0:r.endsWith("+json"))){const s=await e.json();return df("response",e.status,e.url,e.headers,s),zV(s,e)}const i=await e.text();return df("response",e.status,e.url,e.headers,i),i}function zV(a,e){return!a||typeof a!="object"||Array.isArray(a)?a:Object.defineProperty(a,"_request_id",{value:e.headers.get("x-request-id"),enumerable:!1})}let BV=class UV extends Promise{constructor(e,t=qV){super(r=>{r(null)}),this.responsePromise=e,this.parseResponse=t}_thenUnwrap(e){return new UV(this.responsePromise,async t=>zV(e(await this.parseResponse(t),t),t.response))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t,request_id:t.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}},bX=class{constructor({baseURL:e,maxRetries:t=2,timeout:r=6e5,httpAgent:n,fetch:i}){this.baseURL=e,this.maxRetries=gg("maxRetries",t),this.timeout=gg("timeout",r),this.httpAgent=n,this.fetch=i??yV}authHeaders(e){return{}}defaultHeaders(e){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...SX(),...this.authHeaders(e)}}validateHeaders(e,t){}defaultIdempotencyKey(){return`stainless-node-retry-${PX()}`}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,r){return this.request(Promise.resolve(r).then(async n=>{const i=n&&mb(n==null?void 0:n.body)?new DataView(await n.body.arrayBuffer()):(n==null?void 0:n.body)instanceof DataView?n.body:(n==null?void 0:n.body)instanceof ArrayBuffer?new DataView(n.body):n&&ArrayBuffer.isView(n==null?void 0:n.body)?new DataView(n.body.buffer):n==null?void 0:n.body;return{method:e,path:t,...n,body:i}}))}getAPIList(e,t,r){return this.requestAPIList(t,{method:"get",path:e,...r})}calculateContentLength(e){if(typeof e=="string"){if(typeof Buffer<"u")return Buffer.byteLength(e,"utf8").toString();if(typeof TextEncoder<"u")return new TextEncoder().encode(e).length.toString()}else if(ArrayBuffer.isView(e))return e.byteLength.toString();return null}buildRequest(e,{retryCount:t=0}={}){var y;e={...e};const{method:r,path:n,query:i,headers:o={}}=e,s=ArrayBuffer.isView(e.body)||e.__binaryRequest&&typeof e.body=="string"?e.body:e1(e.body)?e.body.body:e.body?JSON.stringify(e.body,null,2):null,u=this.calculateContentLength(s),l=this.buildURL(n,i);"timeout"in e&&gg("timeout",e.timeout),e.timeout=e.timeout??this.timeout;const c=e.httpAgent??this.httpAgent??vV(l),f=e.timeout+1e3;typeof((y=c==null?void 0:c.options)==null?void 0:y.timeout)=="number"&&f>(c.options.timeout??0)&&(c.options.timeout=f),this.idempotencyHeader&&r!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),o[this.idempotencyHeader]=e.idempotencyKey);const p=this.buildHeaders({options:e,headers:o,contentLength:u,retryCount:t});return{req:{method:r,...s&&{body:s},headers:p,...c&&{agent:c},signal:e.signal??null},url:l,timeout:e.timeout}}buildHeaders({options:e,headers:t,contentLength:r,retryCount:n}){const i={};r&&(i["content-length"]=r);const o=this.defaultHeaders(e);return i1(i,o),i1(i,t),e1(e.body)&&np!=="node"&&delete i["content-type"],O_(o,"x-stainless-retry-count")===void 0&&O_(t,"x-stainless-retry-count")===void 0&&(i["x-stainless-retry-count"]=String(n)),O_(o,"x-stainless-timeout")===void 0&&O_(t,"x-stainless-timeout")===void 0&&e.timeout&&(i["x-stainless-timeout"]=String(e.timeout)),this.validateHeaders(i,t),i}async prepareOptions(e){}async prepareRequest(e,{url:t,options:r}){}parseHeaders(e){return e?Symbol.iterator in e?Object.fromEntries(Array.from(e).map(t=>[...t])):{...e}:{}}makeStatusError(e,t,r,n){return or.generate(e,t,r,n)}request(e,t=null){return new BV(this.makeRequest(e,t))}async makeRequest(e,t){var f,p;const r=await e,n=r.maxRetries??this.maxRetries;t==null&&(t=n),await this.prepareOptions(r);const{req:i,url:o,timeout:s}=this.buildRequest(r,{retryCount:n-t});if(await this.prepareRequest(i,{url:o,options:r}),df("request",o,r,i.headers),(f=r.signal)!=null&&f.aborted)throw new gr;const u=new AbortController,l=await this.fetchWithTimeout(o,i,s,u).catch(NE);if(l instanceof Error){if((p=r.signal)!=null&&p.aborted)throw new gr;if(t)return this.retryRequest(r,t);throw l.name==="AbortError"?new yb:new _b({cause:l})}const c=gX(l.headers);if(!l.ok){if(t&&this.shouldRetry(l)){const b=`retrying, ${t} attempts remaining`;return df(`response (error; ${b})`,l.status,o,c),this.retryRequest(r,t,c)}const h=await l.text().catch(b=>NE(b).message),y=EX(h),d=y?void 0:h;throw df(`response (error; ${t?"(error; no more retries left)":"(error; not retryable)"})`,l.status,o,c,d),this.makeStatusError(l.status,y,d,c)}return{response:l,options:r,controller:u}}requestAPIList(e,t){const r=this.makeRequest(t,null);return new mX(this,r,e)}buildURL(e,t){const r=CX(e)?new URL(e):new URL(this.baseURL+(this.baseURL.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),n=this.defaultQuery();return LV(n)||(t={...n,...t}),typeof t=="object"&&t&&!Array.isArray(t)&&(r.search=this.stringifyQuery(t)),r.toString()}stringifyQuery(e){return Object.entries(e).filter(([t,r])=>typeof r<"u").map(([t,r])=>{if(typeof r=="string"||typeof r=="number"||typeof r=="boolean")return`${encodeURIComponent(t)}=${encodeURIComponent(r)}`;if(r===null)return`${encodeURIComponent(t)}=`;throw new Pe(`Cannot stringify type ${typeof r}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}async fetchWithTimeout(e,t,r,n){const{signal:i,...o}=t||{};i&&i.addEventListener("abort",()=>n.abort());const s=setTimeout(()=>n.abort(),r),u={signal:n.signal,...o};return u.method&&(u.method=u.method.toUpperCase()),this.fetch.call(void 0,e,u).finally(()=>{clearTimeout(s)})}shouldRetry(e){const t=e.headers.get("x-should-retry");return t==="true"?!0:t==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,t,r){let n;const i=r==null?void 0:r["retry-after-ms"];if(i){const s=parseFloat(i);Number.isNaN(s)||(n=s)}const o=r==null?void 0:r["retry-after"];if(o&&!n){const s=parseFloat(o);Number.isNaN(s)?n=Date.parse(o)-Date.now():n=s*1e3}if(!(n&&0<=n&&n<60*1e3)){const s=e.maxRetries??this.maxRetries;n=this.calculateDefaultRetryTimeoutMillis(t,s)}return await Hp(n),this.makeRequest(e,t-1)}calculateDefaultRetryTimeoutMillis(e,t){const i=t-e,o=Math.min(.5*Math.pow(2,i),8),s=1-Math.random()*.25;return o*s*1e3}getUserAgent(){return`${this.constructor.name}/JS ${Jc}`}},FV=class{constructor(e,t,r,n){w_.set(this,void 0),_X(this,w_,e),this.options=n,this.response=t,this.body=r}hasNextPage(){return this.getPaginatedItems().length?this.nextPageInfo()!=null:!1}async getNextPage(){const e=this.nextPageInfo();if(!e)throw new Pe("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");const t={...this.options};if("params"in e&&typeof t.query=="object")t.query={...t.query,...e.params};else if("url"in e){const r=[...Object.entries(t.query||{}),...e.url.searchParams.entries()];for(const[n,i]of r)e.url.searchParams.set(n,i);t.query=void 0,t.path=e.url.toString()}return await yX(this,w_,"f").requestAPIList(this.constructor,t)}async*iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async*[(w_=new WeakMap,Symbol.asyncIterator)](){for await(const e of this.iterPages())for(const t of e.getPaginatedItems())yield t}},mX=class extends BV{constructor(e,t,r){super(t,async n=>new r(e,n.response,await qV(n),n.options))}async*[Symbol.asyncIterator](){const e=await this;for await(const t of e)yield t}};const gX=a=>new Proxy(Object.fromEntries(a.entries()),{get(e,t){const r=t.toString();return e[r.toLowerCase()]||e[r]}}),vX={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0,__metadata:!0,__binaryRequest:!0,__binaryResponse:!0,__streamClass:!0},St=a=>typeof a=="object"&&a!==null&&!LV(a)&&Object.keys(a).every(e=>VV(vX,e)),wX=()=>{var e;if(typeof Deno<"u"&&Deno.build!=null)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Jc,"X-Stainless-OS":r1(Deno.build.os),"X-Stainless-Arch":t1(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:((e=Deno.version)==null?void 0:e.deno)??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Jc,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":process.version};if(Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Jc,"X-Stainless-OS":r1(process.platform),"X-Stainless-Arch":t1(process.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":process.version};const a=OX();return a?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Jc,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${a.browser}`,"X-Stainless-Runtime-Version":a.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Jc,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function OX(){if(typeof navigator>"u"||!navigator)return null;const a=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:t}of a){const r=t.exec(navigator.userAgent);if(r){const n=r[1]||0,i=r[2]||0,o=r[3]||0;return{browser:e,version:`${n}.${i}.${o}`}}}return null}const t1=a=>a==="x32"?"x32":a==="x86_64"||a==="x64"?"x64":a==="arm"?"arm":a==="aarch64"||a==="arm64"?"arm64":a?`other:${a}`:"unknown",r1=a=>(a=a.toLowerCase(),a.includes("ios")?"iOS":a==="android"?"Android":a==="darwin"?"MacOS":a==="win32"?"Windows":a==="freebsd"?"FreeBSD":a==="openbsd"?"OpenBSD":a==="linux"?"Linux":a?`Other:${a}`:"Unknown");let n1;const SX=()=>n1??(n1=wX()),EX=a=>{try{return JSON.parse(a)}catch{return}},RX=/^[a-z][a-z0-9+.-]*:/i,CX=a=>RX.test(a),Hp=a=>new Promise(e=>setTimeout(e,a)),gg=(a,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new Pe(`${a} must be an integer`);if(e<0)throw new Pe(`${a} must be a positive integer`);return e},NE=a=>{if(a instanceof Error)return a;if(typeof a=="object"&&a!==null)try{return new Error(JSON.stringify(a))}catch{}return new Error(a)},mc=a=>{var e,t,r,n;if(typeof process<"u")return((e=ff==null?void 0:ff[a])==null?void 0:e.trim())??void 0;if(typeof Deno<"u")return(n=(r=(t=Deno.env)==null?void 0:t.get)==null?void 0:r.call(t,a))==null?void 0:n.trim()};function LV(a){if(!a)return!0;for(const e in a)return!1;return!0}function VV(a,e){return Object.prototype.hasOwnProperty.call(a,e)}function i1(a,e){for(const t in e){if(!VV(e,t))continue;const r=t.toLowerCase();if(!r)continue;const n=e[t];n===null?delete a[r]:n!==void 0&&(a[r]=n)}}const a1=new Set(["authorization","api-key"]);function df(a,...e){if(typeof process<"u"&&(ff==null?void 0:ff.DEBUG)==="true"){const t=e.map(r=>{if(!r)return r;if(r.headers){const i={...r,headers:{...r.headers}};for(const o in r.headers)a1.has(o.toLowerCase())&&(i.headers[o]="REDACTED");return i}let n=null;for(const i in r)a1.has(i.toLowerCase())&&(n??(n={...r}),n[i]="REDACTED");return n??r});console.log(`OpenAI:DEBUG:${a}`,...t)}}const PX=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,a=>{const e=Math.random()*16|0;return(a==="x"?e:e&3|8).toString(16)}),jX=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u",TX=a=>typeof(a==null?void 0:a.get)=="function",O_=(a,e)=>{var r;const t=e.toLowerCase();if(TX(a)){const n=((r=e[0])==null?void 0:r.toUpperCase())+e.substring(1).replace(/([^\w])(\w)/g,(i,o,s)=>o+s.toUpperCase());for(const i of[e,t,e.toUpperCase(),n]){const o=a.get(i);if(o)return o}}for(const[n,i]of Object.entries(a))if(n.toLowerCase()===t)return Array.isArray(i)?(i.length<=1||console.warn(`Received ${i.length} entries for the ${e} header, using the first entry.`),i[0]):i};function ay(a){return a!=null&&typeof a=="object"&&!Array.isArray(a)}let NR=class extends FV{constructor(e,t,r,n){super(e,t,r,n),this.data=r.data||[],this.object=r.object}getPaginatedItems(){return this.data??[]}nextPageParams(){return null}nextPageInfo(){return null}};class sr extends FV{constructor(e,t,r,n){super(e,t,r,n),this.data=r.data||[],this.has_more=r.has_more||!1}getPaginatedItems(){return this.data??[]}hasNextPage(){return this.has_more===!1?!1:super.hasNextPage()}nextPageParams(){const e=this.nextPageInfo();if(!e)return null;if("params"in e)return e.params;const t=Object.fromEntries(e.url.searchParams);return Object.keys(t).length?t:null}nextPageInfo(){var r;const e=this.getPaginatedItems();if(!e.length)return null;const t=(r=e[e.length-1])==null?void 0:r.id;return t?{params:{after:t}}:null}}let Ge=class{constructor(e){this._client=e}},GV=class extends Ge{list(e,t={},r){return St(t)?this.list(e,{},t):this._client.getAPIList(`/chat/completions/${e}/messages`,MX,{query:t,...r})}},gb=class extends Ge{constructor(){super(...arguments),this.messages=new GV(this._client)}create(e,t){return this._client.post("/chat/completions",{body:e,...t,stream:e.stream??!1})}retrieve(e,t){return this._client.get(`/chat/completions/${e}`,t)}update(e,t,r){return this._client.post(`/chat/completions/${e}`,{body:t,...r})}list(e={},t){return St(e)?this.list({},e):this._client.getAPIList("/chat/completions",vb,{query:e,...t})}del(e,t){return this._client.delete(`/chat/completions/${e}`,t)}};class vb extends sr{}class MX extends sr{}gb.ChatCompletionsPage=vb;gb.Messages=GV;let wb=class extends Ge{constructor(){super(...arguments),this.completions=new gb(this._client)}};wb.Completions=gb;wb.ChatCompletionsPage=vb;class kV extends Ge{create(e,t){return this._client.post("/audio/speech",{body:e,...t,headers:{Accept:"application/octet-stream",...t==null?void 0:t.headers},__binaryResponse:!0})}}let HV=class extends Ge{create(e,t){return this._client.post("/audio/transcriptions",Pf({body:e,...t,__metadata:{model:e.model}}))}},WV=class extends Ge{create(e,t){return this._client.post("/audio/translations",Pf({body:e,...t,__metadata:{model:e.model}}))}},Wp=class extends Ge{constructor(){super(...arguments),this.transcriptions=new HV(this._client),this.translations=new WV(this._client),this.speech=new kV(this._client)}};Wp.Transcriptions=HV;Wp.Translations=WV;Wp.Speech=kV;let qR=class extends Ge{create(e,t){return this._client.post("/batches",{body:e,...t})}retrieve(e,t){return this._client.get(`/batches/${e}`,t)}list(e={},t){return St(e)?this.list({},e):this._client.getAPIList("/batches",zR,{query:e,...t})}cancel(e,t){return this._client.post(`/batches/${e}/cancel`,t)}};class zR extends sr{}qR.BatchesPage=zR;class BR extends Ge{create(e,t){return this._client.post("/assistants",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}retrieve(e,t){return this._client.get(`/assistants/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}update(e,t,r){return this._client.post(`/assistants/${e}`,{body:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}list(e={},t){return St(e)?this.list({},e):this._client.getAPIList("/assistants",UR,{query:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}del(e,t){return this._client.delete(`/assistants/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}}class UR extends sr{}BR.AssistantsPage=UR;function o1(a){return typeof a.parse=="function"}const hf=a=>(a==null?void 0:a.role)==="assistant",KV=a=>(a==null?void 0:a.role)==="function",JV=a=>(a==null?void 0:a.role)==="tool";var Ns=function(a,e,t,r,n){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?a!==e||!n:!e.has(a))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?n.call(a,t):n?n.value=t:e.set(a,t),t},ot=function(a,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?a!==e||!r:!e.has(a))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(a):r?r.value:e.get(a)},qE,oy,sy,Vh,Gh,uy,kh,gu,Hh,By,Uy,Xc,XV;class FR{constructor(){qE.add(this),this.controller=new AbortController,oy.set(this,void 0),sy.set(this,()=>{}),Vh.set(this,()=>{}),Gh.set(this,void 0),uy.set(this,()=>{}),kh.set(this,()=>{}),gu.set(this,{}),Hh.set(this,!1),By.set(this,!1),Uy.set(this,!1),Xc.set(this,!1),Ns(this,oy,new Promise((e,t)=>{Ns(this,sy,e,"f"),Ns(this,Vh,t,"f")}),"f"),Ns(this,Gh,new Promise((e,t)=>{Ns(this,uy,e,"f"),Ns(this,kh,t,"f")}),"f"),ot(this,oy,"f").catch(()=>{}),ot(this,Gh,"f").catch(()=>{})}_run(e){setTimeout(()=>{e().then(()=>{this._emitFinal(),this._emit("end")},ot(this,qE,"m",XV).bind(this))},0)}_connected(){this.ended||(ot(this,sy,"f").call(this),this._emit("connect"))}get ended(){return ot(this,Hh,"f")}get errored(){return ot(this,By,"f")}get aborted(){return ot(this,Uy,"f")}abort(){this.controller.abort()}on(e,t){return(ot(this,gu,"f")[e]||(ot(this,gu,"f")[e]=[])).push({listener:t}),this}off(e,t){const r=ot(this,gu,"f")[e];if(!r)return this;const n=r.findIndex(i=>i.listener===t);return n>=0&&r.splice(n,1),this}once(e,t){return(ot(this,gu,"f")[e]||(ot(this,gu,"f")[e]=[])).push({listener:t,once:!0}),this}emitted(e){return new Promise((t,r)=>{Ns(this,Xc,!0,"f"),e!=="error"&&this.once("error",r),this.once(e,t)})}async done(){Ns(this,Xc,!0,"f"),await ot(this,Gh,"f")}_emit(e,...t){if(ot(this,Hh,"f"))return;e==="end"&&(Ns(this,Hh,!0,"f"),ot(this,uy,"f").call(this));const r=ot(this,gu,"f")[e];if(r&&(ot(this,gu,"f")[e]=r.filter(n=>!n.once),r.forEach(({listener:n})=>n(...t))),e==="abort"){const n=t[0];!ot(this,Xc,"f")&&!(r!=null&&r.length)&&Promise.reject(n),ot(this,Vh,"f").call(this,n),ot(this,kh,"f").call(this,n),this._emit("end");return}if(e==="error"){const n=t[0];!ot(this,Xc,"f")&&!(r!=null&&r.length)&&Promise.reject(n),ot(this,Vh,"f").call(this,n),ot(this,kh,"f").call(this,n),this._emit("end")}}_emitFinal(){}}oy=new WeakMap,sy=new WeakMap,Vh=new WeakMap,Gh=new WeakMap,uy=new WeakMap,kh=new WeakMap,gu=new WeakMap,Hh=new WeakMap,By=new WeakMap,Uy=new WeakMap,Xc=new WeakMap,qE=new WeakSet,XV=function(e){if(Ns(this,By,!0,"f"),e instanceof Error&&e.name==="AbortError"&&(e=new gr),e instanceof gr)return Ns(this,Uy,!0,"f"),this._emit("abort",e);if(e instanceof Pe)return this._emit("error",e);if(e instanceof Error){const t=new Pe(e.message);return t.cause=e,this._emit("error",t)}return this._emit("error",new Pe(String(e)))};function AX(a,e){const t={...a};return Object.defineProperties(t,{$brand:{value:"auto-parseable-response-format",enumerable:!1},$parseRaw:{value:e,enumerable:!1}}),t}function LR(a){return(a==null?void 0:a.$brand)==="auto-parseable-response-format"}function IX(a,{parser:e,callback:t}){const r={...a};return Object.defineProperties(r,{$brand:{value:"auto-parseable-tool",enumerable:!1},$parseRaw:{value:e,enumerable:!1},$callback:{value:t,enumerable:!1}}),r}function Kp(a){return(a==null?void 0:a.$brand)==="auto-parseable-tool"}function DX(a,e){return!e||!ZV(e)?{...a,choices:a.choices.map(t=>({...t,message:{...t.message,parsed:null,...t.message.tool_calls?{tool_calls:t.message.tool_calls}:void 0}}))}:VR(a,e)}function VR(a,e){const t=a.choices.map(r=>{var n;if(r.finish_reason==="length")throw new AV;if(r.finish_reason==="content_filter")throw new IV;return{...r,message:{...r.message,...r.message.tool_calls?{tool_calls:((n=r.message.tool_calls)==null?void 0:n.map(i=>$X(e,i)))??void 0}:void 0,parsed:r.message.content&&!r.message.refusal?xX(e,r.message.content):null}}});return{...a,choices:t}}function xX(a,e){var t,r;return((t=a.response_format)==null?void 0:t.type)!=="json_schema"?null:((r=a.response_format)==null?void 0:r.type)==="json_schema"?"$parseRaw"in a.response_format?a.response_format.$parseRaw(e):JSON.parse(e):null}function $X(a,e){var r;const t=(r=a.tools)==null?void 0:r.find(n=>{var i;return((i=n.function)==null?void 0:i.name)===e.function.name});return{...e,function:{...e.function,parsed_arguments:Kp(t)?t.$parseRaw(e.function.arguments):t!=null&&t.function.strict?JSON.parse(e.function.arguments):null}}}function NX(a,e){var r;if(!a)return!1;const t=(r=a.tools)==null?void 0:r.find(n=>{var i;return((i=n.function)==null?void 0:i.name)===e.function.name});return Kp(t)||(t==null?void 0:t.function.strict)||!1}function ZV(a){var e;return LR(a.response_format)?!0:((e=a.tools)==null?void 0:e.some(t=>Kp(t)||t.type==="function"&&t.function.strict===!0))??!1}function qX(a){for(const e of a??[]){if(e.type!=="function")throw new Pe(`Currently only \`function\` tool types support auto-parsing; Received \`${e.type}\``);if(e.function.strict!==!0)throw new Pe(`The \`${e.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}var er=function(a,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?a!==e||!r:!e.has(a))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(a):r?r.value:e.get(a)},Dt,zE,Fy,BE,UE,FE,QV,LE;const s1=10;class YV extends FR{constructor(){super(...arguments),Dt.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(e){var r;this._chatCompletions.push(e),this._emit("chatCompletion",e);const t=(r=e.choices[0])==null?void 0:r.message;return t&&this._addMessage(t),e}_addMessage(e,t=!0){if("content"in e||(e.content=null),this.messages.push(e),t){if(this._emit("message",e),(KV(e)||JV(e))&&e.content)this._emit("functionCallResult",e.content);else if(hf(e)&&e.function_call)this._emit("functionCall",e.function_call);else if(hf(e)&&e.tool_calls)for(const r of e.tool_calls)r.type==="function"&&this._emit("functionCall",r.function)}}async finalChatCompletion(){await this.done();const e=this._chatCompletions[this._chatCompletions.length-1];if(!e)throw new Pe("stream ended without producing a ChatCompletion");return e}async finalContent(){return await this.done(),er(this,Dt,"m",zE).call(this)}async finalMessage(){return await this.done(),er(this,Dt,"m",Fy).call(this)}async finalFunctionCall(){return await this.done(),er(this,Dt,"m",BE).call(this)}async finalFunctionCallResult(){return await this.done(),er(this,Dt,"m",UE).call(this)}async totalUsage(){return await this.done(),er(this,Dt,"m",FE).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){const e=this._chatCompletions[this._chatCompletions.length-1];e&&this._emit("finalChatCompletion",e);const t=er(this,Dt,"m",Fy).call(this);t&&this._emit("finalMessage",t);const r=er(this,Dt,"m",zE).call(this);r&&this._emit("finalContent",r);const n=er(this,Dt,"m",BE).call(this);n&&this._emit("finalFunctionCall",n);const i=er(this,Dt,"m",UE).call(this);i!=null&&this._emit("finalFunctionCallResult",i),this._chatCompletions.some(o=>o.usage)&&this._emit("totalUsage",er(this,Dt,"m",FE).call(this))}async _createChatCompletion(e,t,r){const n=r==null?void 0:r.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),er(this,Dt,"m",QV).call(this,t);const i=await e.chat.completions.create({...t,stream:!1},{...r,signal:this.controller.signal});return this._connected(),this._addChatCompletion(VR(i,t))}async _runChatCompletion(e,t,r){for(const n of t.messages)this._addMessage(n,!1);return await this._createChatCompletion(e,t,r)}async _runFunctions(e,t,r){var p;const n="function",{function_call:i="auto",stream:o,...s}=t,u=typeof i!="string"&&(i==null?void 0:i.name),{maxChatCompletions:l=s1}=r||{},c={};for(const h of t.functions)c[h.name||h.function.name]=h;const f=t.functions.map(h=>({name:h.name||h.function.name,parameters:h.parameters,description:h.description}));for(const h of t.messages)this._addMessage(h,!1);for(let h=0;h<l;++h){const d=(p=(await this._createChatCompletion(e,{...s,function_call:i,functions:f,messages:[...this.messages]},r)).choices[0])==null?void 0:p.message;if(!d)throw new Pe("missing message in ChatCompletion response");if(!d.function_call)return;const{name:_,arguments:m}=d.function_call,b=c[_];if(b){if(u&&u!==_){const S=`Invalid function_call: ${JSON.stringify(_)}. ${JSON.stringify(u)} requested. Please try again`;this._addMessage({role:n,name:_,content:S});continue}}else{const S=`Invalid function_call: ${JSON.stringify(_)}. Available options are: ${f.map(R=>JSON.stringify(R.name)).join(", ")}. Please try again`;this._addMessage({role:n,name:_,content:S});continue}let g;try{g=o1(b)?await b.parse(m):m}catch(S){this._addMessage({role:n,name:_,content:S instanceof Error?S.message:String(S)});continue}const v=await b.function(g,this),w=er(this,Dt,"m",LE).call(this,v);if(this._addMessage({role:n,name:_,content:w}),u)return}}async _runTools(e,t,r){var h,y,d;const n="tool",{tool_choice:i="auto",stream:o,...s}=t,u=typeof i!="string"&&((h=i==null?void 0:i.function)==null?void 0:h.name),{maxChatCompletions:l=s1}=r||{},c=t.tools.map(_=>{if(Kp(_)){if(!_.$callback)throw new Pe("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:_.$callback,name:_.function.name,description:_.function.description||"",parameters:_.function.parameters,parse:_.$parseRaw,strict:!0}}}return _}),f={};for(const _ of c)_.type==="function"&&(f[_.function.name||_.function.function.name]=_.function);const p="tools"in t?c.map(_=>_.type==="function"?{type:"function",function:{name:_.function.name||_.function.function.name,parameters:_.function.parameters,description:_.function.description,strict:_.function.strict}}:_):void 0;for(const _ of t.messages)this._addMessage(_,!1);for(let _=0;_<l;++_){const b=(y=(await this._createChatCompletion(e,{...s,tool_choice:i,tools:p,messages:[...this.messages]},r)).choices[0])==null?void 0:y.message;if(!b)throw new Pe("missing message in ChatCompletion response");if(!((d=b.tool_calls)!=null&&d.length))return;for(const g of b.tool_calls){if(g.type!=="function")continue;const v=g.id,{name:w,arguments:S}=g.function,R=f[w];if(R){if(u&&u!==w){const M=`Invalid tool_call: ${JSON.stringify(w)}. ${JSON.stringify(u)} requested. Please try again`;this._addMessage({role:n,tool_call_id:v,content:M});continue}}else{const M=`Invalid tool_call: ${JSON.stringify(w)}. Available options are: ${Object.keys(f).map(K=>JSON.stringify(K)).join(", ")}. Please try again`;this._addMessage({role:n,tool_call_id:v,content:M});continue}let P;try{P=o1(R)?await R.parse(S):S}catch(M){const K=M instanceof Error?M.message:String(M);this._addMessage({role:n,tool_call_id:v,content:K});continue}const C=await R.function(P,this),T=er(this,Dt,"m",LE).call(this,C);if(this._addMessage({role:n,tool_call_id:v,content:T}),u)return}}}}Dt=new WeakSet,zE=function(){return er(this,Dt,"m",Fy).call(this).content??null},Fy=function(){let e=this.messages.length;for(;e-- >0;){const t=this.messages[e];if(hf(t)){const{function_call:r,...n}=t,i={...n,content:t.content??null,refusal:t.refusal??null};return r&&(i.function_call=r),i}}throw new Pe("stream ended without producing a ChatCompletionMessage with role=assistant")},BE=function(){var e,t;for(let r=this.messages.length-1;r>=0;r--){const n=this.messages[r];if(hf(n)&&(n!=null&&n.function_call))return n.function_call;if(hf(n)&&((e=n==null?void 0:n.tool_calls)!=null&&e.length))return(t=n.tool_calls.at(-1))==null?void 0:t.function}},UE=function(){for(let e=this.messages.length-1;e>=0;e--){const t=this.messages[e];if(KV(t)&&t.content!=null||JV(t)&&t.content!=null&&typeof t.content=="string"&&this.messages.some(r=>{var n;return r.role==="assistant"&&((n=r.tool_calls)==null?void 0:n.some(i=>i.type==="function"&&i.id===t.tool_call_id))}))return t.content}},FE=function(){const e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:t}of this._chatCompletions)t&&(e.completion_tokens+=t.completion_tokens,e.prompt_tokens+=t.prompt_tokens,e.total_tokens+=t.total_tokens);return e},QV=function(e){if(e.n!=null&&e.n>1)throw new Pe("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},LE=function(e){return typeof e=="string"?e:e===void 0?"undefined":JSON.stringify(e)};class jp extends YV{static runFunctions(e,t,r){const n=new jp,i={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runFunctions"}};return n._run(()=>n._runFunctions(e,t,i)),n}static runTools(e,t,r){const n=new jp,i={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runTools"}};return n._run(()=>n._runTools(e,t,i)),n}_addMessage(e,t=!0){super._addMessage(e,t),hf(e)&&e.content&&this._emit("content",e.content)}}const e3=1,t3=2,r3=4,n3=8,i3=16,a3=32,o3=64,s3=128,u3=256,l3=s3|u3,c3=i3|a3|l3|o3,f3=e3|t3|c3,d3=r3|n3,zX=f3|d3,vt={STR:e3,NUM:t3,ARR:r3,OBJ:n3,NULL:i3,BOOL:a3,NAN:o3,INFINITY:s3,MINUS_INFINITY:u3,INF:l3,SPECIAL:c3,ATOM:f3,COLLECTION:d3,ALL:zX};class BX extends Error{}class UX extends Error{}function FX(a,e=vt.ALL){if(typeof a!="string")throw new TypeError(`expecting str, got ${typeof a}`);if(!a.trim())throw new Error(`${a} is empty`);return LX(a.trim(),e)}const LX=(a,e)=>{const t=a.length;let r=0;const n=p=>{throw new BX(`${p} at position ${r}`)},i=p=>{throw new UX(`${p} at position ${r}`)},o=()=>(f(),r>=t&&n("Unexpected end of input"),a[r]==='"'?s():a[r]==="{"?u():a[r]==="["?l():a.substring(r,r+4)==="null"||vt.NULL&e&&t-r<4&&"null".startsWith(a.substring(r))?(r+=4,null):a.substring(r,r+4)==="true"||vt.BOOL&e&&t-r<4&&"true".startsWith(a.substring(r))?(r+=4,!0):a.substring(r,r+5)==="false"||vt.BOOL&e&&t-r<5&&"false".startsWith(a.substring(r))?(r+=5,!1):a.substring(r,r+8)==="Infinity"||vt.INFINITY&e&&t-r<8&&"Infinity".startsWith(a.substring(r))?(r+=8,1/0):a.substring(r,r+9)==="-Infinity"||vt.MINUS_INFINITY&e&&1<t-r&&t-r<9&&"-Infinity".startsWith(a.substring(r))?(r+=9,-1/0):a.substring(r,r+3)==="NaN"||vt.NAN&e&&t-r<3&&"NaN".startsWith(a.substring(r))?(r+=3,NaN):c()),s=()=>{const p=r;let h=!1;for(r++;r<t&&(a[r]!=='"'||h&&a[r-1]==="\\");)h=a[r]==="\\"?!h:!1,r++;if(a.charAt(r)=='"')try{return JSON.parse(a.substring(p,++r-Number(h)))}catch(y){i(String(y))}else if(vt.STR&e)try{return JSON.parse(a.substring(p,r-Number(h))+'"')}catch{return JSON.parse(a.substring(p,a.lastIndexOf("\\"))+'"')}n("Unterminated string literal")},u=()=>{r++,f();const p={};try{for(;a[r]!=="}";){if(f(),r>=t&&vt.OBJ&e)return p;const h=s();f(),r++;try{const y=o();Object.defineProperty(p,h,{value:y,writable:!0,enumerable:!0,configurable:!0})}catch(y){if(vt.OBJ&e)return p;throw y}f(),a[r]===","&&r++}}catch{if(vt.OBJ&e)return p;n("Expected '}' at end of object")}return r++,p},l=()=>{r++;const p=[];try{for(;a[r]!=="]";)p.push(o()),f(),a[r]===","&&r++}catch{if(vt.ARR&e)return p;n("Expected ']' at end of array")}return r++,p},c=()=>{if(r===0){a==="-"&&vt.NUM&e&&n("Not sure what '-' is");try{return JSON.parse(a)}catch(h){if(vt.NUM&e)try{return a[a.length-1]==="."?JSON.parse(a.substring(0,a.lastIndexOf("."))):JSON.parse(a.substring(0,a.lastIndexOf("e")))}catch{}i(String(h))}}const p=r;for(a[r]==="-"&&r++;a[r]&&!",]}".includes(a[r]);)r++;r==t&&!(vt.NUM&e)&&n("Unterminated number literal");try{return JSON.parse(a.substring(p,r))}catch{a.substring(p,r)==="-"&&vt.NUM&e&&n("Not sure what '-' is");try{return JSON.parse(a.substring(p,a.lastIndexOf("e")))}catch(y){i(String(y))}}},f=()=>{for(;r<t&&` 
\r	`.includes(a[r]);)r++};return o()},u1=a=>FX(a,vt.ALL^vt.NUM);var Uc=function(a,e,t,r,n){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?a!==e||!n:!e.has(a))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?n.call(a,t):n?n.value=t:e.set(a,t),t},et=function(a,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?a!==e||!r:!e.has(a))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(a):r?r.value:e.get(a)},_t,cu,Fc,Au,vg,S_,wg,Og,Sg,E_,Eg,l1;class Tp extends YV{constructor(e){super(),_t.add(this),cu.set(this,void 0),Fc.set(this,void 0),Au.set(this,void 0),Uc(this,cu,e,"f"),Uc(this,Fc,[],"f")}get currentChatCompletionSnapshot(){return et(this,Au,"f")}static fromReadableStream(e){const t=new Tp(null);return t._run(()=>t._fromReadableStream(e)),t}static createChatCompletion(e,t,r){const n=new Tp(t);return n._run(()=>n._runChatCompletion(e,{...t,stream:!0},{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),n}async _createChatCompletion(e,t,r){var o;super._createChatCompletion;const n=r==null?void 0:r.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),et(this,_t,"m",vg).call(this);const i=await e.chat.completions.create({...t,stream:!0},{...r,signal:this.controller.signal});this._connected();for await(const s of i)et(this,_t,"m",wg).call(this,s);if((o=i.controller.signal)!=null&&o.aborted)throw new gr;return this._addChatCompletion(et(this,_t,"m",E_).call(this))}async _fromReadableStream(e,t){var o;const r=t==null?void 0:t.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),et(this,_t,"m",vg).call(this),this._connected();const n=Pp.fromReadableStream(e,this.controller);let i;for await(const s of n)i&&i!==s.id&&this._addChatCompletion(et(this,_t,"m",E_).call(this)),et(this,_t,"m",wg).call(this,s),i=s.id;if((o=n.controller.signal)!=null&&o.aborted)throw new gr;return this._addChatCompletion(et(this,_t,"m",E_).call(this))}[(cu=new WeakMap,Fc=new WeakMap,Au=new WeakMap,_t=new WeakSet,vg=function(){this.ended||Uc(this,Au,void 0,"f")},S_=function(t){let r=et(this,Fc,"f")[t.index];return r||(r={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},et(this,Fc,"f")[t.index]=r,r)},wg=function(t){var n,i,o,s,u,l,c,f,p,h,y,d,_,m,b;if(this.ended)return;const r=et(this,_t,"m",l1).call(this,t);this._emit("chunk",t,r);for(const g of t.choices){const v=r.choices[g.index];g.delta.content!=null&&((n=v.message)==null?void 0:n.role)==="assistant"&&((i=v.message)!=null&&i.content)&&(this._emit("content",g.delta.content,v.message.content),this._emit("content.delta",{delta:g.delta.content,snapshot:v.message.content,parsed:v.message.parsed})),g.delta.refusal!=null&&((o=v.message)==null?void 0:o.role)==="assistant"&&((s=v.message)!=null&&s.refusal)&&this._emit("refusal.delta",{delta:g.delta.refusal,snapshot:v.message.refusal}),((u=g.logprobs)==null?void 0:u.content)!=null&&((l=v.message)==null?void 0:l.role)==="assistant"&&this._emit("logprobs.content.delta",{content:(c=g.logprobs)==null?void 0:c.content,snapshot:((f=v.logprobs)==null?void 0:f.content)??[]}),((p=g.logprobs)==null?void 0:p.refusal)!=null&&((h=v.message)==null?void 0:h.role)==="assistant"&&this._emit("logprobs.refusal.delta",{refusal:(y=g.logprobs)==null?void 0:y.refusal,snapshot:((d=v.logprobs)==null?void 0:d.refusal)??[]});const w=et(this,_t,"m",S_).call(this,v);v.finish_reason&&(et(this,_t,"m",Sg).call(this,v),w.current_tool_call_index!=null&&et(this,_t,"m",Og).call(this,v,w.current_tool_call_index));for(const S of g.delta.tool_calls??[])w.current_tool_call_index!==S.index&&(et(this,_t,"m",Sg).call(this,v),w.current_tool_call_index!=null&&et(this,_t,"m",Og).call(this,v,w.current_tool_call_index)),w.current_tool_call_index=S.index;for(const S of g.delta.tool_calls??[]){const R=(_=v.message.tool_calls)==null?void 0:_[S.index];R!=null&&R.type&&((R==null?void 0:R.type)==="function"?this._emit("tool_calls.function.arguments.delta",{name:(m=R.function)==null?void 0:m.name,index:S.index,arguments:R.function.arguments,parsed_arguments:R.function.parsed_arguments,arguments_delta:((b=S.function)==null?void 0:b.arguments)??""}):(R==null||R.type,void 0))}}},Og=function(t,r){var o,s,u;if(et(this,_t,"m",S_).call(this,t).done_tool_calls.has(r))return;const i=(o=t.message.tool_calls)==null?void 0:o[r];if(!i)throw new Error("no tool call snapshot");if(!i.type)throw new Error("tool call snapshot missing `type`");if(i.type==="function"){const l=(u=(s=et(this,cu,"f"))==null?void 0:s.tools)==null?void 0:u.find(c=>c.type==="function"&&c.function.name===i.function.name);this._emit("tool_calls.function.arguments.done",{name:i.function.name,index:r,arguments:i.function.arguments,parsed_arguments:Kp(l)?l.$parseRaw(i.function.arguments):l!=null&&l.function.strict?JSON.parse(i.function.arguments):null})}else i.type},Sg=function(t){var n,i;const r=et(this,_t,"m",S_).call(this,t);if(t.message.content&&!r.content_done){r.content_done=!0;const o=et(this,_t,"m",Eg).call(this);this._emit("content.done",{content:t.message.content,parsed:o?o.$parseRaw(t.message.content):null})}t.message.refusal&&!r.refusal_done&&(r.refusal_done=!0,this._emit("refusal.done",{refusal:t.message.refusal})),(n=t.logprobs)!=null&&n.content&&!r.logprobs_content_done&&(r.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:t.logprobs.content})),(i=t.logprobs)!=null&&i.refusal&&!r.logprobs_refusal_done&&(r.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:t.logprobs.refusal}))},E_=function(){if(this.ended)throw new Pe("stream has ended, this shouldn't happen");const t=et(this,Au,"f");if(!t)throw new Pe("request ended without sending any chunks");return Uc(this,Au,void 0,"f"),Uc(this,Fc,[],"f"),VX(t,et(this,cu,"f"))},Eg=function(){var r;const t=(r=et(this,cu,"f"))==null?void 0:r.response_format;return LR(t)?t:null},l1=function(t){var r,n,i,o;let s=et(this,Au,"f");const{choices:u,...l}=t;s?Object.assign(s,l):s=Uc(this,Au,{...l,choices:[]},"f");for(const{delta:c,finish_reason:f,index:p,logprobs:h=null,...y}of t.choices){let d=s.choices[p];if(d||(d=s.choices[p]={finish_reason:f,index:p,message:{},logprobs:h,...y}),h)if(!d.logprobs)d.logprobs=Object.assign({},h);else{const{content:S,refusal:R,...P}=h;Object.assign(d.logprobs,P),S&&((r=d.logprobs).content??(r.content=[]),d.logprobs.content.push(...S)),R&&((n=d.logprobs).refusal??(n.refusal=[]),d.logprobs.refusal.push(...R))}if(f&&(d.finish_reason=f,et(this,cu,"f")&&ZV(et(this,cu,"f")))){if(f==="length")throw new AV;if(f==="content_filter")throw new IV}if(Object.assign(d,y),!c)continue;const{content:_,refusal:m,function_call:b,role:g,tool_calls:v,...w}=c;if(Object.assign(d.message,w),m&&(d.message.refusal=(d.message.refusal||"")+m),g&&(d.message.role=g),b&&(d.message.function_call?(b.name&&(d.message.function_call.name=b.name),b.arguments&&((i=d.message.function_call).arguments??(i.arguments=""),d.message.function_call.arguments+=b.arguments)):d.message.function_call=b),_&&(d.message.content=(d.message.content||"")+_,!d.message.refusal&&et(this,_t,"m",Eg).call(this)&&(d.message.parsed=u1(d.message.content))),v){d.message.tool_calls||(d.message.tool_calls=[]);for(const{index:S,id:R,type:P,function:C,...T}of v){const M=(o=d.message.tool_calls)[S]??(o[S]={});Object.assign(M,T),R&&(M.id=R),P&&(M.type=P),C&&(M.function??(M.function={name:C.name??"",arguments:""})),C!=null&&C.name&&(M.function.name=C.name),C!=null&&C.arguments&&(M.function.arguments+=C.arguments,NX(et(this,cu,"f"),M)&&(M.function.parsed_arguments=u1(M.function.arguments)))}}}return s},Symbol.asyncIterator)](){const e=[],t=[];let r=!1;return this.on("chunk",n=>{const i=t.shift();i?i.resolve(n):e.push(n)}),this.on("end",()=>{r=!0;for(const n of t)n.resolve(void 0);t.length=0}),this.on("abort",n=>{r=!0;for(const i of t)i.reject(n);t.length=0}),this.on("error",n=>{r=!0;for(const i of t)i.reject(n);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((i,o)=>t.push({resolve:i,reject:o})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new Pp(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function VX(a,e){const{id:t,choices:r,created:n,model:i,system_fingerprint:o,...s}=a,u={...s,id:t,choices:r.map(({message:l,finish_reason:c,index:f,logprobs:p,...h})=>{if(!c)throw new Pe(`missing finish_reason for choice ${f}`);const{content:y=null,function_call:d,tool_calls:_,...m}=l,b=l.role;if(!b)throw new Pe(`missing role for choice ${f}`);if(d){const{arguments:g,name:v}=d;if(g==null)throw new Pe(`missing function_call.arguments for choice ${f}`);if(!v)throw new Pe(`missing function_call.name for choice ${f}`);return{...h,message:{content:y,function_call:{arguments:g,name:v},role:b,refusal:l.refusal??null},finish_reason:c,index:f,logprobs:p}}return _?{...h,index:f,finish_reason:c,logprobs:p,message:{...m,role:b,content:y,refusal:l.refusal??null,tool_calls:_.map((g,v)=>{const{function:w,type:S,id:R,...P}=g,{arguments:C,name:T,...M}=w||{};if(R==null)throw new Pe(`missing choices[${f}].tool_calls[${v}].id
${R_(a)}`);if(S==null)throw new Pe(`missing choices[${f}].tool_calls[${v}].type
${R_(a)}`);if(T==null)throw new Pe(`missing choices[${f}].tool_calls[${v}].function.name
${R_(a)}`);if(C==null)throw new Pe(`missing choices[${f}].tool_calls[${v}].function.arguments
${R_(a)}`);return{...P,id:R,type:S,function:{...M,name:T,arguments:C}}})}}:{...h,message:{...m,content:y,role:b,refusal:l.refusal??null},finish_reason:c,index:f,logprobs:p}}),created:n,model:i,object:"chat.completion",...o?{system_fingerprint:o}:{}};return DX(u,e)}function R_(a){return JSON.stringify(a)}class pf extends Tp{static fromReadableStream(e){const t=new pf(null);return t._run(()=>t._fromReadableStream(e)),t}static runFunctions(e,t,r){const n=new pf(null),i={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runFunctions"}};return n._run(()=>n._runFunctions(e,t,i)),n}static runTools(e,t,r){const n=new pf(t),i={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runTools"}};return n._run(()=>n._runTools(e,t,i)),n}}let h3=class extends Ge{parse(e,t){return qX(e.tools),this._client.chat.completions.create(e,{...t,headers:{...t==null?void 0:t.headers,"X-Stainless-Helper-Method":"beta.chat.completions.parse"}})._thenUnwrap(r=>VR(r,e))}runFunctions(e,t){return e.stream?pf.runFunctions(this._client,e,t):jp.runFunctions(this._client,e,t)}runTools(e,t){return e.stream?pf.runTools(this._client,e,t):jp.runTools(this._client,e,t)}stream(e,t){return Tp.createChatCompletion(this._client,e,t)}},VE=class extends Ge{constructor(){super(...arguments),this.completions=new h3(this._client)}};(function(a){a.Completions=h3})(VE||(VE={}));class p3 extends Ge{create(e,t){return this._client.post("/realtime/sessions",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}}class GR extends Ge{constructor(){super(...arguments),this.sessions=new p3(this._client)}}GR.Sessions=p3;var Ce=function(a,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?a!==e||!r:!e.has(a))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(a):r?r.value:e.get(a)},lr=function(a,e,t,r,n){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?a!==e||!n:!e.has(a))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?n.call(a,t):n?n.value=t:e.set(a,t),t},Pt,GE,eu,ly,qs,gc,af,yc,Ly,yr,cy,fy,ip,Wh,Kh,c1,f1,d1,h1,p1,_1,y1;class Us extends FR{constructor(){super(...arguments),Pt.add(this),GE.set(this,[]),eu.set(this,{}),ly.set(this,{}),qs.set(this,void 0),gc.set(this,void 0),af.set(this,void 0),yc.set(this,void 0),Ly.set(this,void 0),yr.set(this,void 0),cy.set(this,void 0),fy.set(this,void 0),ip.set(this,void 0)}[(GE=new WeakMap,eu=new WeakMap,ly=new WeakMap,qs=new WeakMap,gc=new WeakMap,af=new WeakMap,yc=new WeakMap,Ly=new WeakMap,yr=new WeakMap,cy=new WeakMap,fy=new WeakMap,ip=new WeakMap,Pt=new WeakSet,Symbol.asyncIterator)](){const e=[],t=[];let r=!1;return this.on("event",n=>{const i=t.shift();i?i.resolve(n):e.push(n)}),this.on("end",()=>{r=!0;for(const n of t)n.resolve(void 0);t.length=0}),this.on("abort",n=>{r=!0;for(const i of t)i.reject(n);t.length=0}),this.on("error",n=>{r=!0;for(const i of t)i.reject(n);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((i,o)=>t.push({resolve:i,reject:o})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(e){const t=new Us;return t._run(()=>t._fromReadableStream(e)),t}async _fromReadableStream(e,t){var i;const r=t==null?void 0:t.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),this._connected();const n=Pp.fromReadableStream(e,this.controller);for await(const o of n)Ce(this,Pt,"m",Wh).call(this,o);if((i=n.controller.signal)!=null&&i.aborted)throw new gr;return this._addRun(Ce(this,Pt,"m",Kh).call(this))}toReadableStream(){return new Pp(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(e,t,r,n,i){const o=new Us;return o._run(()=>o._runToolAssistantStream(e,t,r,n,{...i,headers:{...i==null?void 0:i.headers,"X-Stainless-Helper-Method":"stream"}})),o}async _createToolAssistantStream(e,t,r,n,i){var l;const o=i==null?void 0:i.signal;o&&(o.aborted&&this.controller.abort(),o.addEventListener("abort",()=>this.controller.abort()));const s={...n,stream:!0},u=await e.submitToolOutputs(t,r,s,{...i,signal:this.controller.signal});this._connected();for await(const c of u)Ce(this,Pt,"m",Wh).call(this,c);if((l=u.controller.signal)!=null&&l.aborted)throw new gr;return this._addRun(Ce(this,Pt,"m",Kh).call(this))}static createThreadAssistantStream(e,t,r){const n=new Us;return n._run(()=>n._threadAssistantStream(e,t,{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),n}static createAssistantStream(e,t,r,n){const i=new Us;return i._run(()=>i._runAssistantStream(e,t,r,{...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"stream"}})),i}currentEvent(){return Ce(this,cy,"f")}currentRun(){return Ce(this,fy,"f")}currentMessageSnapshot(){return Ce(this,qs,"f")}currentRunStepSnapshot(){return Ce(this,ip,"f")}async finalRunSteps(){return await this.done(),Object.values(Ce(this,eu,"f"))}async finalMessages(){return await this.done(),Object.values(Ce(this,ly,"f"))}async finalRun(){if(await this.done(),!Ce(this,gc,"f"))throw Error("Final run was not received.");return Ce(this,gc,"f")}async _createThreadAssistantStream(e,t,r){var s;const n=r==null?void 0:r.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort()));const i={...t,stream:!0},o=await e.createAndRun(i,{...r,signal:this.controller.signal});this._connected();for await(const u of o)Ce(this,Pt,"m",Wh).call(this,u);if((s=o.controller.signal)!=null&&s.aborted)throw new gr;return this._addRun(Ce(this,Pt,"m",Kh).call(this))}async _createAssistantStream(e,t,r,n){var u;const i=n==null?void 0:n.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort()));const o={...r,stream:!0},s=await e.create(t,o,{...n,signal:this.controller.signal});this._connected();for await(const l of s)Ce(this,Pt,"m",Wh).call(this,l);if((u=s.controller.signal)!=null&&u.aborted)throw new gr;return this._addRun(Ce(this,Pt,"m",Kh).call(this))}static accumulateDelta(e,t){for(const[r,n]of Object.entries(t)){if(!e.hasOwnProperty(r)){e[r]=n;continue}let i=e[r];if(i==null){e[r]=n;continue}if(r==="index"||r==="type"){e[r]=n;continue}if(typeof i=="string"&&typeof n=="string")i+=n;else if(typeof i=="number"&&typeof n=="number")i+=n;else if(ay(i)&&ay(n))i=this.accumulateDelta(i,n);else if(Array.isArray(i)&&Array.isArray(n)){if(i.every(o=>typeof o=="string"||typeof o=="number")){i.push(...n);continue}for(const o of n){if(!ay(o))throw new Error(`Expected array delta entry to be an object but got: ${o}`);const s=o.index;if(s==null)throw console.error(o),new Error("Expected array delta entry to have an `index` property");if(typeof s!="number")throw new Error(`Expected array delta entry \`index\` property to be a number but got ${s}`);const u=i[s];u==null?i.push(o):i[s]=this.accumulateDelta(u,o)}continue}else throw Error(`Unhandled record type: ${r}, deltaValue: ${n}, accValue: ${i}`);e[r]=i}return e}_addRun(e){return e}async _threadAssistantStream(e,t,r){return await this._createThreadAssistantStream(t,e,r)}async _runAssistantStream(e,t,r,n){return await this._createAssistantStream(t,e,r,n)}async _runToolAssistantStream(e,t,r,n,i){return await this._createToolAssistantStream(r,e,t,n,i)}}Wh=function(e){if(!this.ended)switch(lr(this,cy,e,"f"),Ce(this,Pt,"m",d1).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.incomplete":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":Ce(this,Pt,"m",y1).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":Ce(this,Pt,"m",f1).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":Ce(this,Pt,"m",c1).call(this,e);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},Kh=function(){if(this.ended)throw new Pe("stream has ended, this shouldn't happen");if(!Ce(this,gc,"f"))throw Error("Final run has not been received");return Ce(this,gc,"f")},c1=function(e){const[t,r]=Ce(this,Pt,"m",p1).call(this,e,Ce(this,qs,"f"));lr(this,qs,t,"f"),Ce(this,ly,"f")[t.id]=t;for(const n of r){const i=t.content[n.index];(i==null?void 0:i.type)=="text"&&this._emit("textCreated",i.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,t),e.data.delta.content)for(const n of e.data.delta.content){if(n.type=="text"&&n.text){let i=n.text,o=t.content[n.index];if(o&&o.type=="text")this._emit("textDelta",i,o.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(n.index!=Ce(this,af,"f")){if(Ce(this,yc,"f"))switch(Ce(this,yc,"f").type){case"text":this._emit("textDone",Ce(this,yc,"f").text,Ce(this,qs,"f"));break;case"image_file":this._emit("imageFileDone",Ce(this,yc,"f").image_file,Ce(this,qs,"f"));break}lr(this,af,n.index,"f")}lr(this,yc,t.content[n.index],"f")}break;case"thread.message.completed":case"thread.message.incomplete":if(Ce(this,af,"f")!==void 0){const n=e.data.content[Ce(this,af,"f")];if(n)switch(n.type){case"image_file":this._emit("imageFileDone",n.image_file,Ce(this,qs,"f"));break;case"text":this._emit("textDone",n.text,Ce(this,qs,"f"));break}}Ce(this,qs,"f")&&this._emit("messageDone",e.data),lr(this,qs,void 0,"f")}},f1=function(e){const t=Ce(this,Pt,"m",h1).call(this,e);switch(lr(this,ip,t,"f"),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":const r=e.data.delta;if(r.step_details&&r.step_details.type=="tool_calls"&&r.step_details.tool_calls&&t.step_details.type=="tool_calls")for(const i of r.step_details.tool_calls)i.index==Ce(this,Ly,"f")?this._emit("toolCallDelta",i,t.step_details.tool_calls[i.index]):(Ce(this,yr,"f")&&this._emit("toolCallDone",Ce(this,yr,"f")),lr(this,Ly,i.index,"f"),lr(this,yr,t.step_details.tool_calls[i.index],"f"),Ce(this,yr,"f")&&this._emit("toolCallCreated",Ce(this,yr,"f")));this._emit("runStepDelta",e.data.delta,t);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":lr(this,ip,void 0,"f"),e.data.step_details.type=="tool_calls"&&Ce(this,yr,"f")&&(this._emit("toolCallDone",Ce(this,yr,"f")),lr(this,yr,void 0,"f")),this._emit("runStepDone",e.data,t);break}},d1=function(e){Ce(this,GE,"f").push(e),this._emit("event",e)},h1=function(e){switch(e.event){case"thread.run.step.created":return Ce(this,eu,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let t=Ce(this,eu,"f")[e.data.id];if(!t)throw Error("Received a RunStepDelta before creation of a snapshot");let r=e.data;if(r.delta){const n=Us.accumulateDelta(t,r.delta);Ce(this,eu,"f")[e.data.id]=n}return Ce(this,eu,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":Ce(this,eu,"f")[e.data.id]=e.data;break}if(Ce(this,eu,"f")[e.data.id])return Ce(this,eu,"f")[e.data.id];throw new Error("No snapshot available")},p1=function(e,t){let r=[];switch(e.event){case"thread.message.created":return[e.data,r];case"thread.message.delta":if(!t)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let n=e.data;if(n.delta.content)for(const i of n.delta.content)if(i.index in t.content){let o=t.content[i.index];t.content[i.index]=Ce(this,Pt,"m",_1).call(this,i,o)}else t.content[i.index]=i,r.push(i);return[t,r];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(t)return[t,r];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},_1=function(e,t){return Us.accumulateDelta(t,e)},y1=function(e){switch(lr(this,fy,e.data,"f"),e.event){case"thread.run.created":break;case"thread.run.queued":break;case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":lr(this,gc,e.data,"f"),Ce(this,yr,"f")&&(this._emit("toolCallDone",Ce(this,yr,"f")),lr(this,yr,void 0,"f"));break}};let kR=class extends Ge{create(e,t,r){return this._client.post(`/threads/${e}/messages`,{body:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(e,t,r){return this._client.get(`/threads/${e}/messages/${t}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(e,t,r,n){return this._client.post(`/threads/${e}/messages/${t}`,{body:r,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}list(e,t={},r){return St(t)?this.list(e,{},t):this._client.getAPIList(`/threads/${e}/messages`,HR,{query:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(e,t,r){return this._client.delete(`/threads/${e}/messages/${t}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}};class HR extends sr{}kR.MessagesPage=HR;class WR extends Ge{retrieve(e,t,r,n={},i){return St(n)?this.retrieve(e,t,r,{},n):this._client.get(`/threads/${e}/runs/${t}/steps/${r}`,{query:n,...i,headers:{"OpenAI-Beta":"assistants=v2",...i==null?void 0:i.headers}})}list(e,t,r={},n){return St(r)?this.list(e,t,{},r):this._client.getAPIList(`/threads/${e}/runs/${t}/steps`,KR,{query:r,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}}class KR extends sr{}WR.RunStepsPage=KR;class Jp extends Ge{constructor(){super(...arguments),this.steps=new WR(this._client)}create(e,t,r){const{include:n,...i}=t;return this._client.post(`/threads/${e}/runs`,{query:{include:n},body:i,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers},stream:t.stream??!1})}retrieve(e,t,r){return this._client.get(`/threads/${e}/runs/${t}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(e,t,r,n){return this._client.post(`/threads/${e}/runs/${t}`,{body:r,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}list(e,t={},r){return St(t)?this.list(e,{},t):this._client.getAPIList(`/threads/${e}/runs`,JR,{query:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}cancel(e,t,r){return this._client.post(`/threads/${e}/runs/${t}/cancel`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}async createAndPoll(e,t,r){const n=await this.create(e,t,r);return await this.poll(e,n.id,r)}createAndStream(e,t,r){return Us.createAssistantStream(e,this._client.beta.threads.runs,t,r)}async poll(e,t,r){const n={...r==null?void 0:r.headers,"X-Stainless-Poll-Helper":"true"};for(r!=null&&r.pollIntervalMs&&(n["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){const{data:i,response:o}=await this.retrieve(e,t,{...r,headers:{...r==null?void 0:r.headers,...n}}).withResponse();switch(i.status){case"queued":case"in_progress":case"cancelling":let s=5e3;if(r!=null&&r.pollIntervalMs)s=r.pollIntervalMs;else{const u=o.headers.get("openai-poll-after-ms");if(u){const l=parseInt(u);isNaN(l)||(s=l)}}await Hp(s);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return i}}}stream(e,t,r){return Us.createAssistantStream(e,this._client.beta.threads.runs,t,r)}submitToolOutputs(e,t,r,n){return this._client.post(`/threads/${e}/runs/${t}/submit_tool_outputs`,{body:r,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers},stream:r.stream??!1})}async submitToolOutputsAndPoll(e,t,r,n){const i=await this.submitToolOutputs(e,t,r,n);return await this.poll(e,i.id,n)}submitToolOutputsStream(e,t,r,n){return Us.createToolAssistantStream(e,t,this._client.beta.threads.runs,r,n)}}class JR extends sr{}Jp.RunsPage=JR;Jp.Steps=WR;Jp.RunStepsPage=KR;class qf extends Ge{constructor(){super(...arguments),this.runs=new Jp(this._client),this.messages=new kR(this._client)}create(e={},t){return St(e)?this.create({},e):this._client.post("/threads",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}retrieve(e,t){return this._client.get(`/threads/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}update(e,t,r){return this._client.post(`/threads/${e}`,{body:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(e,t){return this._client.delete(`/threads/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}createAndRun(e,t){return this._client.post("/threads/runs",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers},stream:e.stream??!1})}async createAndRunPoll(e,t){const r=await this.createAndRun(e,t);return await this.runs.poll(r.thread_id,r.id,t)}createAndRunStream(e,t){return Us.createThreadAssistantStream(e,this._client.beta.threads,t)}}qf.Runs=Jp;qf.RunsPage=JR;qf.Messages=kR;qf.MessagesPage=HR;let zf=class extends Ge{constructor(){super(...arguments),this.realtime=new GR(this._client),this.chat=new VE(this._client),this.assistants=new BR(this._client),this.threads=new qf(this._client)}};zf.Realtime=GR;zf.Assistants=BR;zf.AssistantsPage=UR;zf.Threads=qf;let _3=class extends Ge{create(e,t){return this._client.post("/completions",{body:e,...t,stream:e.stream??!1})}},y3=class extends Ge{create(e,t){return this._client.post("/embeddings",{body:e,...t})}},XR=class extends Ge{create(e,t){return this._client.post("/files",Pf({body:e,...t}))}retrieve(e,t){return this._client.get(`/files/${e}`,t)}list(e={},t){return St(e)?this.list({},e):this._client.getAPIList("/files",ZR,{query:e,...t})}del(e,t){return this._client.delete(`/files/${e}`,t)}content(e,t){return this._client.get(`/files/${e}/content`,{...t,headers:{Accept:"application/binary",...t==null?void 0:t.headers},__binaryResponse:!0})}retrieveContent(e,t){return this._client.get(`/files/${e}/content`,t)}async waitForProcessing(e,{pollInterval:t=5e3,maxWait:r=30*60*1e3}={}){const n=new Set(["processed","error","deleted"]),i=Date.now();let o=await this.retrieve(e);for(;!o.status||!n.has(o.status);)if(await Hp(t),o=await this.retrieve(e),Date.now()-i>r)throw new yb({message:`Giving up on waiting for file ${e} to finish processing after ${r} milliseconds.`});return o}};class ZR extends sr{}XR.FileObjectsPage=ZR;class QR extends Ge{list(e,t={},r){return St(t)?this.list(e,{},t):this._client.getAPIList(`/fine_tuning/jobs/${e}/checkpoints`,YR,{query:t,...r})}}class YR extends sr{}QR.FineTuningJobCheckpointsPage=YR;class Bf extends Ge{constructor(){super(...arguments),this.checkpoints=new QR(this._client)}create(e,t){return this._client.post("/fine_tuning/jobs",{body:e,...t})}retrieve(e,t){return this._client.get(`/fine_tuning/jobs/${e}`,t)}list(e={},t){return St(e)?this.list({},e):this._client.getAPIList("/fine_tuning/jobs",eC,{query:e,...t})}cancel(e,t){return this._client.post(`/fine_tuning/jobs/${e}/cancel`,t)}listEvents(e,t={},r){return St(t)?this.listEvents(e,{},t):this._client.getAPIList(`/fine_tuning/jobs/${e}/events`,tC,{query:t,...r})}}class eC extends sr{}class tC extends sr{}Bf.FineTuningJobsPage=eC;Bf.FineTuningJobEventsPage=tC;Bf.Checkpoints=QR;Bf.FineTuningJobCheckpointsPage=YR;class Xp extends Ge{constructor(){super(...arguments),this.jobs=new Bf(this._client)}}Xp.Jobs=Bf;Xp.FineTuningJobsPage=eC;Xp.FineTuningJobEventsPage=tC;class b3 extends Ge{createVariation(e,t){return this._client.post("/images/variations",Pf({body:e,...t}))}edit(e,t){return this._client.post("/images/edits",Pf({body:e,...t}))}generate(e,t){return this._client.post("/images/generations",{body:e,...t})}}let rC=class extends Ge{retrieve(e,t){return this._client.get(`/models/${e}`,t)}list(e){return this._client.getAPIList("/models",nC,e)}del(e,t){return this._client.delete(`/models/${e}`,t)}};class nC extends NR{}rC.ModelsPage=nC;class m3 extends Ge{create(e,t){return this._client.post("/moderations",{body:e,...t})}}function GX(a,e){return!e||!HX(e)?{...a,output_parsed:null,output:a.output.map(t=>t.type==="function_call"?{...t,parsed_arguments:null}:t.type==="message"?{...t,content:t.content.map(r=>({...r,parsed:null}))}:t)}:g3(a,e)}function g3(a,e){const t=a.output.map(n=>{if(n.type==="function_call")return{...n,parsed_arguments:JX(e,n)};if(n.type==="message"){const i=n.content.map(o=>o.type==="output_text"?{...o,parsed:kX(e,o.text)}:o);return{...n,content:i}}return n}),r=Object.assign({},a,{output:t});return Object.getOwnPropertyDescriptor(a,"output_text")||v3(r),Object.defineProperty(r,"output_parsed",{enumerable:!0,get(){for(const n of r.output)if(n.type==="message"){for(const i of n.content)if(i.type==="output_text"&&i.parsed!==null)return i.parsed}return null}}),r}function kX(a,e){var t,r,n,i;return((r=(t=a.text)==null?void 0:t.format)==null?void 0:r.type)!=="json_schema"?null:"$parseRaw"in((n=a.text)==null?void 0:n.format)?((i=a.text)==null?void 0:i.format).$parseRaw(e):JSON.parse(e)}function HX(a){var e;return!!LR((e=a.text)==null?void 0:e.format)}function WX(a){return(a==null?void 0:a.$brand)==="auto-parseable-tool"}function KX(a,e){return a.find(t=>t.type==="function"&&t.name===e)}function JX(a,e){const t=KX(a.tools??[],e.name);return{...e,...e,parsed_arguments:WX(t)?t.$parseRaw(e.arguments):t!=null&&t.strict?JSON.parse(e.arguments):null}}function v3(a){const e=[];for(const t of a.output)if(t.type==="message")for(const r of t.content)r.type==="output_text"&&e.push(r.text);a.output_text=e.join("")}class iC extends Ge{list(e,t={},r){return St(t)?this.list(e,{},t):this._client.getAPIList(`/responses/${e}/input_items`,aC,{query:t,...r})}}class aC extends sr{}iC.ResponseItemListDataPage=aC;var Lc=function(a,e,t,r,n){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?a!==e||!n:!e.has(a))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?n.call(a,t):n?n.value=t:e.set(a,t),t},Iu=function(a,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?a!==e||!r:!e.has(a))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(a):r?r.value:e.get(a)},Vc,C_,Du,P_,b1,m1,g1,v1;class oC extends FR{constructor(e){super(),Vc.add(this),C_.set(this,void 0),Du.set(this,void 0),P_.set(this,void 0),Lc(this,C_,e,"f")}static createResponse(e,t,r){const n=new oC(t);return n._run(()=>n._createResponse(e,t,{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),n}async _createResponse(e,t,r){var o;const n=r==null?void 0:r.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),Iu(this,Vc,"m",b1).call(this);const i=await e.responses.create({...t,stream:!0},{...r,signal:this.controller.signal});this._connected();for await(const s of i)Iu(this,Vc,"m",m1).call(this,s);if((o=i.controller.signal)!=null&&o.aborted)throw new gr;return Iu(this,Vc,"m",g1).call(this)}[(C_=new WeakMap,Du=new WeakMap,P_=new WeakMap,Vc=new WeakSet,b1=function(){this.ended||Lc(this,Du,void 0,"f")},m1=function(t){if(this.ended)return;const r=Iu(this,Vc,"m",v1).call(this,t);switch(this._emit("event",t),t.type){case"response.output_text.delta":{const n=r.output[t.output_index];if(!n)throw new Pe(`missing output at index ${t.output_index}`);if(n.type==="message"){const i=n.content[t.content_index];if(!i)throw new Pe(`missing content at index ${t.content_index}`);if(i.type!=="output_text")throw new Pe(`expected content to be 'output_text', got ${i.type}`);this._emit("response.output_text.delta",{...t,snapshot:i.text})}break}case"response.function_call_arguments.delta":{const n=r.output[t.output_index];if(!n)throw new Pe(`missing output at index ${t.output_index}`);n.type==="function_call"&&this._emit("response.function_call_arguments.delta",{...t,snapshot:n.arguments});break}default:this._emit(t.type,t);break}},g1=function(){if(this.ended)throw new Pe("stream has ended, this shouldn't happen");const t=Iu(this,Du,"f");if(!t)throw new Pe("request ended without sending any events");Lc(this,Du,void 0,"f");const r=XX(t,Iu(this,C_,"f"));return Lc(this,P_,r,"f"),r},v1=function(t){let r=Iu(this,Du,"f");if(!r){if(t.type!=="response.created")throw new Pe(`When snapshot hasn't been set yet, expected 'response.created' event, got ${t.type}`);return r=Lc(this,Du,t.response,"f"),r}switch(t.type){case"response.output_item.added":{r.output.push(t.item);break}case"response.content_part.added":{const n=r.output[t.output_index];if(!n)throw new Pe(`missing output at index ${t.output_index}`);n.type==="message"&&n.content.push(t.part);break}case"response.output_text.delta":{const n=r.output[t.output_index];if(!n)throw new Pe(`missing output at index ${t.output_index}`);if(n.type==="message"){const i=n.content[t.content_index];if(!i)throw new Pe(`missing content at index ${t.content_index}`);if(i.type!=="output_text")throw new Pe(`expected content to be 'output_text', got ${i.type}`);i.text+=t.delta}break}case"response.function_call_arguments.delta":{const n=r.output[t.output_index];if(!n)throw new Pe(`missing output at index ${t.output_index}`);n.type==="function_call"&&(n.arguments+=t.delta);break}case"response.completed":{Lc(this,Du,t.response,"f");break}}return r},Symbol.asyncIterator)](){const e=[],t=[];let r=!1;return this.on("event",n=>{const i=t.shift();i?i.resolve(n):e.push(n)}),this.on("end",()=>{r=!0;for(const n of t)n.resolve(void 0);t.length=0}),this.on("abort",n=>{r=!0;for(const i of t)i.reject(n);t.length=0}),this.on("error",n=>{r=!0;for(const i of t)i.reject(n);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((i,o)=>t.push({resolve:i,reject:o})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}async finalResponse(){await this.done();const e=Iu(this,P_,"f");if(!e)throw new Pe("stream ended without producing a ChatCompletion");return e}}function XX(a,e){return GX(a,e)}class Ob extends Ge{constructor(){super(...arguments),this.inputItems=new iC(this._client)}create(e,t){return this._client.post("/responses",{body:e,...t,stream:e.stream??!1})._thenUnwrap(r=>("object"in r&&r.object==="response"&&v3(r),r))}retrieve(e,t={},r){return St(t)?this.retrieve(e,{},t):this._client.get(`/responses/${e}`,{query:t,...r})}del(e,t){return this._client.delete(`/responses/${e}`,{...t,headers:{Accept:"*/*",...t==null?void 0:t.headers}})}parse(e,t){return this._client.responses.create(e,t)._thenUnwrap(r=>g3(r,e))}stream(e,t){return oC.createResponse(this._client,e,t)}}Ob.InputItems=iC;Ob.ResponseItemListDataPage=aC;class w3 extends Ge{create(e,t,r){return this._client.post(`/uploads/${e}/parts`,Pf({body:t,...r}))}}class sC extends Ge{constructor(){super(...arguments),this.parts=new w3(this._client)}create(e,t){return this._client.post("/uploads",{body:e,...t})}cancel(e,t){return this._client.post(`/uploads/${e}/cancel`,t)}complete(e,t,r){return this._client.post(`/uploads/${e}/complete`,{body:t,...r})}}sC.Parts=w3;const ZX=async a=>{const e=await Promise.allSettled(a),t=e.filter(n=>n.status==="rejected");if(t.length){for(const n of t)console.error(n.reason);throw new Error(`${t.length} promise(s) failed - see the above errors`)}const r=[];for(const n of e)n.status==="fulfilled"&&r.push(n.value);return r};class Sb extends Ge{create(e,t,r){return this._client.post(`/vector_stores/${e}/files`,{body:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(e,t,r){return this._client.get(`/vector_stores/${e}/files/${t}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(e,t,r,n){return this._client.post(`/vector_stores/${e}/files/${t}`,{body:r,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}list(e,t={},r){return St(t)?this.list(e,{},t):this._client.getAPIList(`/vector_stores/${e}/files`,Eb,{query:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(e,t,r){return this._client.delete(`/vector_stores/${e}/files/${t}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}async createAndPoll(e,t,r){const n=await this.create(e,t,r);return await this.poll(e,n.id,r)}async poll(e,t,r){const n={...r==null?void 0:r.headers,"X-Stainless-Poll-Helper":"true"};for(r!=null&&r.pollIntervalMs&&(n["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){const i=await this.retrieve(e,t,{...r,headers:n}).withResponse(),o=i.data;switch(o.status){case"in_progress":let s=5e3;if(r!=null&&r.pollIntervalMs)s=r.pollIntervalMs;else{const u=i.response.headers.get("openai-poll-after-ms");if(u){const l=parseInt(u);isNaN(l)||(s=l)}}await Hp(s);break;case"failed":case"completed":return o}}}async upload(e,t,r){const n=await this._client.files.create({file:t,purpose:"assistants"},r);return this.create(e,{file_id:n.id},r)}async uploadAndPoll(e,t,r){const n=await this.upload(e,t,r);return await this.poll(e,n.id,r)}content(e,t,r){return this._client.getAPIList(`/vector_stores/${e}/files/${t}/content`,uC,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}}class Eb extends sr{}class uC extends NR{}Sb.VectorStoreFilesPage=Eb;Sb.FileContentResponsesPage=uC;class O3 extends Ge{create(e,t,r){return this._client.post(`/vector_stores/${e}/file_batches`,{body:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(e,t,r){return this._client.get(`/vector_stores/${e}/file_batches/${t}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}cancel(e,t,r){return this._client.post(`/vector_stores/${e}/file_batches/${t}/cancel`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}async createAndPoll(e,t,r){const n=await this.create(e,t);return await this.poll(e,n.id,r)}listFiles(e,t,r={},n){return St(r)?this.listFiles(e,t,{},r):this._client.getAPIList(`/vector_stores/${e}/file_batches/${t}/files`,Eb,{query:r,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}async poll(e,t,r){const n={...r==null?void 0:r.headers,"X-Stainless-Poll-Helper":"true"};for(r!=null&&r.pollIntervalMs&&(n["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){const{data:i,response:o}=await this.retrieve(e,t,{...r,headers:n}).withResponse();switch(i.status){case"in_progress":let s=5e3;if(r!=null&&r.pollIntervalMs)s=r.pollIntervalMs;else{const u=o.headers.get("openai-poll-after-ms");if(u){const l=parseInt(u);isNaN(l)||(s=l)}}await Hp(s);break;case"failed":case"cancelled":case"completed":return i}}}async uploadAndPoll(e,{files:t,fileIds:r=[]},n){if(t==null||t.length==0)throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");const i=(n==null?void 0:n.maxConcurrency)??5,o=Math.min(i,t.length),s=this._client,u=t.values(),l=[...r];async function c(p){for(let h of p){const y=await s.files.create({file:h,purpose:"assistants"},n);l.push(y.id)}}const f=Array(o).fill(u).map(c);return await ZX(f),await this.createAndPoll(e,{file_ids:l})}}class Yu extends Ge{constructor(){super(...arguments),this.files=new Sb(this._client),this.fileBatches=new O3(this._client)}create(e,t){return this._client.post("/vector_stores",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}retrieve(e,t){return this._client.get(`/vector_stores/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}update(e,t,r){return this._client.post(`/vector_stores/${e}`,{body:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}list(e={},t){return St(e)?this.list({},e):this._client.getAPIList("/vector_stores",lC,{query:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}del(e,t){return this._client.delete(`/vector_stores/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}search(e,t,r){return this._client.getAPIList(`/vector_stores/${e}/search`,cC,{body:t,method:"post",...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}}class lC extends sr{}class cC extends NR{}Yu.VectorStoresPage=lC;Yu.VectorStoreSearchResponsesPage=cC;Yu.Files=Sb;Yu.VectorStoreFilesPage=Eb;Yu.FileContentResponsesPage=uC;Yu.FileBatches=O3;var QX={},S3;let $e=class extends bX{constructor({baseURL:e=mc("OPENAI_BASE_URL"),apiKey:t=mc("OPENAI_API_KEY"),organization:r=mc("OPENAI_ORG_ID")??null,project:n=mc("OPENAI_PROJECT_ID")??null,...i}={}){if(t===void 0)throw new Pe("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");const o={apiKey:t,organization:r,project:n,...i,baseURL:e||"https://api.openai.com/v1"};if(!o.dangerouslyAllowBrowser&&jX())throw new Pe(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new OpenAI({ apiKey, dangerouslyAllowBrowser: true });

https://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety
`);super({baseURL:o.baseURL,timeout:o.timeout??6e5,httpAgent:o.httpAgent,maxRetries:o.maxRetries,fetch:o.fetch}),this.completions=new _3(this),this.chat=new wb(this),this.embeddings=new y3(this),this.files=new XR(this),this.images=new b3(this),this.audio=new Wp(this),this.moderations=new m3(this),this.models=new rC(this),this.fineTuning=new Xp(this),this.vectorStores=new Yu(this),this.beta=new zf(this),this.batches=new qR(this),this.uploads=new sC(this),this.responses=new Ob(this),this._options=o,this.apiKey=t,this.organization=r,this.project=n}defaultQuery(){return this._options.defaultQuery}defaultHeaders(e){return{...super.defaultHeaders(e),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project,...this._options.defaultHeaders}}authHeaders(e){return{Authorization:`Bearer ${this.apiKey}`}}stringifyQuery(e){return YJ(e,{arrayFormat:"brackets"})}};S3=$e;$e.OpenAI=S3;$e.DEFAULT_TIMEOUT=6e5;$e.OpenAIError=Pe;$e.APIError=or;$e.APIConnectionError=_b;$e.APIConnectionTimeoutError=yb;$e.APIUserAbortError=gr;$e.NotFoundError=CV;$e.ConflictError=PV;$e.RateLimitError=TV;$e.BadRequestError=SV;$e.AuthenticationError=EV;$e.InternalServerError=MV;$e.PermissionDeniedError=RV;$e.UnprocessableEntityError=jV;$e.toFile=NV;$e.fileFromPath=wV;$e.Completions=_3;$e.Chat=wb;$e.ChatCompletionsPage=vb;$e.Embeddings=y3;$e.Files=XR;$e.FileObjectsPage=ZR;$e.Images=b3;$e.Audio=Wp;$e.Moderations=m3;$e.Models=rC;$e.ModelsPage=nC;$e.FineTuning=Xp;$e.VectorStores=Yu;$e.VectorStoresPage=lC;$e.VectorStoreSearchResponsesPage=cC;$e.Beta=zf;$e.Batches=qR;$e.BatchesPage=zR;$e.Uploads=sC;$e.Responses=Ob;let E3=class extends $e{constructor({baseURL:e=mc("OPENAI_BASE_URL"),apiKey:t=mc("AZURE_OPENAI_API_KEY"),apiVersion:r=mc("OPENAI_API_VERSION"),endpoint:n,deployment:i,azureADTokenProvider:o,dangerouslyAllowBrowser:s,...u}={}){if(!r)throw new Pe("The OPENAI_API_VERSION environment variable is missing or empty; either provide it, or instantiate the AzureOpenAI client with an apiVersion option, like new AzureOpenAI({ apiVersion: 'My API Version' }).");if(typeof o=="function"&&(s=!0),!o&&!t)throw new Pe("Missing credentials. Please pass one of `apiKey` and `azureADTokenProvider`, or set the `AZURE_OPENAI_API_KEY` environment variable.");if(o&&t)throw new Pe("The `apiKey` and `azureADTokenProvider` arguments are mutually exclusive; only one can be passed at a time.");if(t??(t=w1),u.defaultQuery={...u.defaultQuery,"api-version":r},e){if(n)throw new Pe("baseURL and endpoint are mutually exclusive")}else{if(n||(n=QX.AZURE_OPENAI_ENDPOINT),!n)throw new Pe("Must provide one of the `baseURL` or `endpoint` arguments, or the `AZURE_OPENAI_ENDPOINT` environment variable");e=`${n}/openai`}super({apiKey:t,baseURL:e,...u,...s!==void 0?{dangerouslyAllowBrowser:s}:{}}),this.apiVersion="",this._azureADTokenProvider=o,this.apiVersion=r,this.deploymentName=i}buildRequest(e,t={}){var r;if(YX.has(e.path)&&e.method==="post"&&e.body!==void 0){if(!ay(e.body))throw new Error("Expected request body to be an object");const n=this.deploymentName||e.body.model||((r=e.__metadata)==null?void 0:r.model);n!==void 0&&!this.baseURL.includes("/deployments")&&(e.path=`/deployments/${n}${e.path}`)}return super.buildRequest(e,t)}async _getAzureADToken(){if(typeof this._azureADTokenProvider=="function"){const e=await this._azureADTokenProvider();if(!e||typeof e!="string")throw new Pe(`Expected 'azureADTokenProvider' argument to return a string but it returned ${e}`);return e}}authHeaders(e){return{}}async prepareOptions(e){var r;if((r=e.headers)!=null&&r["api-key"])return super.prepareOptions(e);const t=await this._getAzureADToken();if(e.headers??(e.headers={}),t)e.headers.Authorization=`Bearer ${t}`;else if(this.apiKey!==w1)e.headers["api-key"]=this.apiKey;else throw new Pe("Unable to handle auth");return super.prepareOptions(e)}};const YX=new Set(["/completions","/chat/completions","/embeddings","/audio/transcriptions","/audio/translations","/audio/speech","/images/generations"]),w1="<Missing Key>";/*
 * [js-sha1]{@link https://github.com/emn178/js-sha1}
 *
 * @version 0.6.0
 * @author Chen, Yi-Cyuan [emn178@gmail.com]
 * @copyright Chen, Yi-Cyuan 2014-2017
 * @license MIT
 */var e7=typeof window=="object"?window:{},qe="0123456789abcdef".split(""),t7=[-2147483648,8388608,32768,128],Br=[24,16,8,0],gt=[];function Ks(a){a?(gt[0]=gt[16]=gt[1]=gt[2]=gt[3]=gt[4]=gt[5]=gt[6]=gt[7]=gt[8]=gt[9]=gt[10]=gt[11]=gt[12]=gt[13]=gt[14]=gt[15]=0,this.blocks=gt):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.h0=1732584193,this.h1=4023233417,this.h2=2562383102,this.h3=271733878,this.h4=3285377520,this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0}Ks.prototype.update=function(a){if(!this.finalized){var e=typeof a!="string";e&&a.constructor===e7.ArrayBuffer&&(a=new Uint8Array(a));for(var t,r=0,n,i=a.length||0,o=this.blocks;r<i;){if(this.hashed&&(this.hashed=!1,o[0]=this.block,o[16]=o[1]=o[2]=o[3]=o[4]=o[5]=o[6]=o[7]=o[8]=o[9]=o[10]=o[11]=o[12]=o[13]=o[14]=o[15]=0),e)for(n=this.start;r<i&&n<64;++r)o[n>>2]|=a[r]<<Br[n++&3];else for(n=this.start;r<i&&n<64;++r)t=a.charCodeAt(r),t<128?o[n>>2]|=t<<Br[n++&3]:t<2048?(o[n>>2]|=(192|t>>6)<<Br[n++&3],o[n>>2]|=(128|t&63)<<Br[n++&3]):t<55296||t>=57344?(o[n>>2]|=(224|t>>12)<<Br[n++&3],o[n>>2]|=(128|t>>6&63)<<Br[n++&3],o[n>>2]|=(128|t&63)<<Br[n++&3]):(t=65536+((t&1023)<<10|a.charCodeAt(++r)&1023),o[n>>2]|=(240|t>>18)<<Br[n++&3],o[n>>2]|=(128|t>>12&63)<<Br[n++&3],o[n>>2]|=(128|t>>6&63)<<Br[n++&3],o[n>>2]|=(128|t&63)<<Br[n++&3]);this.lastByteIndex=n,this.bytes+=n-this.start,n>=64?(this.block=o[16],this.start=n-64,this.hash(),this.hashed=!0):this.start=n}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}};Ks.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var a=this.blocks,e=this.lastByteIndex;a[16]=this.block,a[e>>2]|=t7[e&3],this.block=a[16],e>=56&&(this.hashed||this.hash(),a[0]=this.block,a[16]=a[1]=a[2]=a[3]=a[4]=a[5]=a[6]=a[7]=a[8]=a[9]=a[10]=a[11]=a[12]=a[13]=a[14]=a[15]=0),a[14]=this.hBytes<<3|this.bytes>>>29,a[15]=this.bytes<<3,this.hash()}};Ks.prototype.hash=function(){var a=this.h0,e=this.h1,t=this.h2,r=this.h3,n=this.h4,i,o,s,u=this.blocks;for(o=16;o<80;++o)s=u[o-3]^u[o-8]^u[o-14]^u[o-16],u[o]=s<<1|s>>>31;for(o=0;o<20;o+=5)i=e&t|~e&r,s=a<<5|a>>>27,n=s+i+n+1518500249+u[o]<<0,e=e<<30|e>>>2,i=a&e|~a&t,s=n<<5|n>>>27,r=s+i+r+1518500249+u[o+1]<<0,a=a<<30|a>>>2,i=n&a|~n&e,s=r<<5|r>>>27,t=s+i+t+1518500249+u[o+2]<<0,n=n<<30|n>>>2,i=r&n|~r&a,s=t<<5|t>>>27,e=s+i+e+1518500249+u[o+3]<<0,r=r<<30|r>>>2,i=t&r|~t&n,s=e<<5|e>>>27,a=s+i+a+1518500249+u[o+4]<<0,t=t<<30|t>>>2;for(;o<40;o+=5)i=e^t^r,s=a<<5|a>>>27,n=s+i+n+1859775393+u[o]<<0,e=e<<30|e>>>2,i=a^e^t,s=n<<5|n>>>27,r=s+i+r+1859775393+u[o+1]<<0,a=a<<30|a>>>2,i=n^a^e,s=r<<5|r>>>27,t=s+i+t+1859775393+u[o+2]<<0,n=n<<30|n>>>2,i=r^n^a,s=t<<5|t>>>27,e=s+i+e+1859775393+u[o+3]<<0,r=r<<30|r>>>2,i=t^r^n,s=e<<5|e>>>27,a=s+i+a+1859775393+u[o+4]<<0,t=t<<30|t>>>2;for(;o<60;o+=5)i=e&t|e&r|t&r,s=a<<5|a>>>27,n=s+i+n-1894007588+u[o]<<0,e=e<<30|e>>>2,i=a&e|a&t|e&t,s=n<<5|n>>>27,r=s+i+r-1894007588+u[o+1]<<0,a=a<<30|a>>>2,i=n&a|n&e|a&e,s=r<<5|r>>>27,t=s+i+t-1894007588+u[o+2]<<0,n=n<<30|n>>>2,i=r&n|r&a|n&a,s=t<<5|t>>>27,e=s+i+e-1894007588+u[o+3]<<0,r=r<<30|r>>>2,i=t&r|t&n|r&n,s=e<<5|e>>>27,a=s+i+a-1894007588+u[o+4]<<0,t=t<<30|t>>>2;for(;o<80;o+=5)i=e^t^r,s=a<<5|a>>>27,n=s+i+n-899497514+u[o]<<0,e=e<<30|e>>>2,i=a^e^t,s=n<<5|n>>>27,r=s+i+r-899497514+u[o+1]<<0,a=a<<30|a>>>2,i=n^a^e,s=r<<5|r>>>27,t=s+i+t-899497514+u[o+2]<<0,n=n<<30|n>>>2,i=r^n^a,s=t<<5|t>>>27,e=s+i+e-899497514+u[o+3]<<0,r=r<<30|r>>>2,i=t^r^n,s=e<<5|e>>>27,a=s+i+a-899497514+u[o+4]<<0,t=t<<30|t>>>2;this.h0=this.h0+a<<0,this.h1=this.h1+e<<0,this.h2=this.h2+t<<0,this.h3=this.h3+r<<0,this.h4=this.h4+n<<0};Ks.prototype.hex=function(){this.finalize();var a=this.h0,e=this.h1,t=this.h2,r=this.h3,n=this.h4;return qe[a>>28&15]+qe[a>>24&15]+qe[a>>20&15]+qe[a>>16&15]+qe[a>>12&15]+qe[a>>8&15]+qe[a>>4&15]+qe[a&15]+qe[e>>28&15]+qe[e>>24&15]+qe[e>>20&15]+qe[e>>16&15]+qe[e>>12&15]+qe[e>>8&15]+qe[e>>4&15]+qe[e&15]+qe[t>>28&15]+qe[t>>24&15]+qe[t>>20&15]+qe[t>>16&15]+qe[t>>12&15]+qe[t>>8&15]+qe[t>>4&15]+qe[t&15]+qe[r>>28&15]+qe[r>>24&15]+qe[r>>20&15]+qe[r>>16&15]+qe[r>>12&15]+qe[r>>8&15]+qe[r>>4&15]+qe[r&15]+qe[n>>28&15]+qe[n>>24&15]+qe[n>>20&15]+qe[n>>16&15]+qe[n>>12&15]+qe[n>>8&15]+qe[n>>4&15]+qe[n&15]};Ks.prototype.toString=Ks.prototype.hex;Ks.prototype.digest=function(){this.finalize();var a=this.h0,e=this.h1,t=this.h2,r=this.h3,n=this.h4;return[a>>24&255,a>>16&255,a>>8&255,a&255,e>>24&255,e>>16&255,e>>8&255,e&255,t>>24&255,t>>16&255,t>>8&255,t&255,r>>24&255,r>>16&255,r>>8&255,r&255,n>>24&255,n>>16&255,n>>8&255,n&255]};Ks.prototype.array=Ks.prototype.digest;Ks.prototype.arrayBuffer=function(){this.finalize();var a=new ArrayBuffer(20),e=new DataView(a);return e.setUint32(0,this.h0),e.setUint32(4,this.h1),e.setUint32(8,this.h2),e.setUint32(12,this.h3),e.setUint32(16,this.h4),a};const r7=a=>new Ks(!0).update(a).hex(),O1=(...a)=>r7(a.join("_"));class n7{}const i7=new Map;class fC extends n7{constructor(e){super(),Object.defineProperty(this,"cache",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.cache=e??new Map}lookup(e,t){return Promise.resolve(this.cache.get(O1(e,t))??null)}async update(e,t,r){this.cache.set(O1(e,t),r)}static global(){return new fC(i7)}}const a7=a=>a.startsWith("gpt-3.5-turbo-16k")?"gpt-3.5-turbo-16k":a.startsWith("gpt-3.5-turbo-")?"gpt-3.5-turbo":a.startsWith("gpt-4-32k")?"gpt-4-32k":a.startsWith("gpt-4-")?"gpt-4":a.startsWith("gpt-4o")?"gpt-4o":a;function Zp(a){return typeof a!="object"||!a?!1:!!("type"in a&&a.type==="function"&&"function"in a&&typeof a.function=="object"&&a.function&&"name"in a.function&&"parameters"in a.function)}const o7=()=>!1;class s7 extends ct{get lc_attributes(){return{callbacks:void 0,verbose:void 0}}constructor(e){super(e),Object.defineProperty(this,"verbose",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"callbacks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.verbose=e.verbose??o7(),this.callbacks=e.callbacks,this.tags=e.tags??[],this.metadata=e.metadata??{}}}class R3 extends s7{get callKeys(){return["stop","timeout","signal","tags","metadata","callbacks"]}constructor({callbacks:e,callbackManager:t,...r}){const{cache:n,...i}=r;super({callbacks:e??t,...i}),Object.defineProperty(this,"caller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cache",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_encoding",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),typeof n=="object"?this.cache=n:n?this.cache=fC.global():this.cache=void 0,this.caller=new Vp(r??{})}async getNumTokens(e){if(typeof e!="string")return 0;let t=Math.ceil(e.length/4);if(!this._encoding)try{this._encoding=await BJ("modelName"in this?a7(this.modelName):"gpt2")}catch(r){console.warn("Failed to calculate number of tokens, falling back to approximate count",r)}if(this._encoding)try{t=this._encoding.encode(e).length}catch(r){console.warn("Failed to calculate number of tokens, falling back to approximate count",r)}return t}static _convertInputToPromptValue(e){return typeof e=="string"?new aV(e):Array.isArray(e)?new oV(e.map(Uu)):e}_identifyingParams(){return{}}_getSerializedCacheKeyParametersForCall({config:e,...t}){const r={...this._identifyingParams(),...t,_type:this._llmType(),_model:this._modelType()};return Object.entries(r).filter(([o,s])=>s!==void 0).map(([o,s])=>`${o}:${JSON.stringify(s)}`).sort().join(",")}serialize(){return{...this._identifyingParams(),_type:this._llmType(),_model:this._modelType()}}static async deserialize(e){throw new Error("Use .toJSON() instead")}}function jf(a){return typeof(a==null?void 0:a.parse)=="function"}class Ar extends R3{constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","chat_models",this._llmType()]}),Object.defineProperty(this,"disableStreaming",{enumerable:!0,configurable:!0,writable:!0,value:!1})}_separateRunnableConfigFromCallOptionsCompat(e){const[t,r]=super._separateRunnableConfigFromCallOptions(e);return r.signal=t.signal,[t,r]}async invoke(e,t){const r=Ar._convertInputToPromptValue(e);return(await this.generatePrompt([r],t,t==null?void 0:t.callbacks)).generations[0][0].message}async*_streamResponseChunks(e,t,r){throw new Error("Not implemented.")}async*_streamIterator(e,t){var r;if(this._streamResponseChunks===Ar.prototype._streamResponseChunks||this.disableStreaming)yield this.invoke(e,t);else{const i=Ar._convertInputToPromptValue(e).toChatMessages(),[o,s]=this._separateRunnableConfigFromCallOptionsCompat(t),u={...o.metadata,...this.getLsParams(s)},l=await Ot.configure(o.callbacks,this.callbacks,o.tags,this.tags,u,this.metadata,{verbose:this.verbose}),c={options:s,invocation_params:this==null?void 0:this.invocationParams(s),batch_size:1},f=await(l==null?void 0:l.handleChatModelStart(this.toJSON(),[i],o.runId,void 0,c,void 0,void 0,o.runName));let p,h;try{for await(const y of this._streamResponseChunks(i,s,f==null?void 0:f[0])){if(y.message.id==null){const d=(r=f==null?void 0:f.at(0))==null?void 0:r.runId;d!=null&&y.message._updateId(`run-${d}`)}y.message.response_metadata={...y.generationInfo,...y.message.response_metadata},yield y.message,p?p=p.concat(y):p=y,bP(y.message)&&y.message.usage_metadata!==void 0&&(h={tokenUsage:{promptTokens:y.message.usage_metadata.input_tokens,completionTokens:y.message.usage_metadata.output_tokens,totalTokens:y.message.usage_metadata.total_tokens}})}}catch(y){throw await Promise.all((f??[]).map(d=>d==null?void 0:d.handleLLMError(y))),y}await Promise.all((f??[]).map(y=>y==null?void 0:y.handleLLMEnd({generations:[[p]],llmOutput:h})))}}getLsParams(e){const t=this.getName().startsWith("Chat")?this.getName().replace("Chat",""):this.getName();return{ls_model_type:"chat",ls_stop:e.stop,ls_provider:t}}async _generateUncached(e,t,r,n){var f,p;const i=e.map(h=>h.map(Uu));let o;if(n!==void 0&&n.length===i.length)o=n;else{const h={...r.metadata,...this.getLsParams(t)},y=await Ot.configure(r.callbacks,this.callbacks,r.tags,this.tags,h,this.metadata,{verbose:this.verbose}),d={options:t,invocation_params:this==null?void 0:this.invocationParams(t),batch_size:1};o=await(y==null?void 0:y.handleChatModelStart(this.toJSON(),i,r.runId,void 0,d,void 0,void 0,r.runName))}const s=[],u=[];if(!!(o!=null&&o[0].handlers.find(S4))&&!this.disableStreaming&&i.length===1&&this._streamResponseChunks!==Ar.prototype._streamResponseChunks)try{const h=await this._streamResponseChunks(i[0],t,o==null?void 0:o[0]);let y,d;for await(const _ of h){if(_.message.id==null){const m=(f=o==null?void 0:o.at(0))==null?void 0:f.runId;m!=null&&_.message._updateId(`run-${m}`)}y===void 0?y=_:y=Dr(y,_),bP(_.message)&&_.message.usage_metadata!==void 0&&(d={tokenUsage:{promptTokens:_.message.usage_metadata.input_tokens,completionTokens:_.message.usage_metadata.output_tokens,totalTokens:_.message.usage_metadata.total_tokens}})}if(y===void 0)throw new Error("Received empty response from chat model call.");s.push([y]),await(o==null?void 0:o[0].handleLLMEnd({generations:s,llmOutput:d}))}catch(h){throw await(o==null?void 0:o[0].handleLLMError(h)),h}else{const h=await Promise.allSettled(i.map((y,d)=>this._generate(y,{...t,promptIndex:d},o==null?void 0:o[d])));await Promise.all(h.map(async(y,d)=>{var _,m,b;if(y.status==="fulfilled"){const g=y.value;for(const v of g.generations){if(v.message.id==null){const w=(_=o==null?void 0:o.at(0))==null?void 0:_.runId;w!=null&&v.message._updateId(`run-${w}`)}v.message.response_metadata={...v.generationInfo,...v.message.response_metadata}}return g.generations.length===1&&(g.generations[0].message.response_metadata={...g.llmOutput,...g.generations[0].message.response_metadata}),s[d]=g.generations,u[d]=g.llmOutput,(m=o==null?void 0:o[d])==null?void 0:m.handleLLMEnd({generations:[g.generations],llmOutput:g.llmOutput})}else return await((b=o==null?void 0:o[d])==null?void 0:b.handleLLMError(y.reason)),Promise.reject(y.reason)}))}const c={generations:s,llmOutput:u.length?(p=this._combineLLMOutput)==null?void 0:p.call(this,...u):void 0};return Object.defineProperty(c,xy,{value:o?{runIds:o==null?void 0:o.map(h=>h.runId)}:void 0,configurable:!0}),c}async _generateCached({messages:e,cache:t,llmStringKey:r,parsedOptions:n,handledOptions:i}){const o=e.map(_=>_.map(Uu)),s={...i.metadata,...this.getLsParams(n)},u=await Ot.configure(i.callbacks,this.callbacks,i.tags,this.tags,s,this.metadata,{verbose:this.verbose}),l={options:n,invocation_params:this==null?void 0:this.invocationParams(n),batch_size:1},c=await(u==null?void 0:u.handleChatModelStart(this.toJSON(),o,i.runId,void 0,l,void 0,void 0,i.runName)),f=[],h=(await Promise.allSettled(o.map(async(_,m)=>{const b=Ar._convertInputToPromptValue(_).toString(),g=await t.lookup(b,r);return g==null&&f.push(m),g}))).map((_,m)=>({result:_,runManager:c==null?void 0:c[m]})).filter(({result:_})=>_.status==="fulfilled"&&_.value!=null||_.status==="rejected"),y=[];await Promise.all(h.map(async({result:_,runManager:m},b)=>{if(_.status==="fulfilled"){const g=_.value;return y[b]=g.map(v=>("message"in v&&If(v.message)&&ru(v.message)&&(v.message.usage_metadata={input_tokens:0,output_tokens:0,total_tokens:0}),v.generationInfo={...v.generationInfo,tokenUsage:{}},v)),g.length&&await(m==null?void 0:m.handleLLMNewToken(g[0].text)),m==null?void 0:m.handleLLMEnd({generations:[g]},void 0,void 0,void 0,{cached:!0})}else return await(m==null?void 0:m.handleLLMError(_.reason,void 0,void 0,void 0,{cached:!0})),Promise.reject(_.reason)}));const d={generations:y,missingPromptIndices:f,startedRunManagers:c};return Object.defineProperty(d,xy,{value:c?{runIds:c==null?void 0:c.map(_=>_.runId)}:void 0,configurable:!0}),d}async generate(e,t,r){let n;Array.isArray(t)?n={stop:t}:n=t;const i=e.map(y=>y.map(Uu)),[o,s]=this._separateRunnableConfigFromCallOptionsCompat(n);if(o.callbacks=o.callbacks??r,!this.cache)return this._generateUncached(i,s,o);const{cache:u}=this,l=this._getSerializedCacheKeyParametersForCall(s),{generations:c,missingPromptIndices:f,startedRunManagers:p}=await this._generateCached({messages:i,cache:u,llmStringKey:l,parsedOptions:s,handledOptions:o});let h={};if(f.length>0){const y=await this._generateUncached(f.map(d=>i[d]),s,o,p!==void 0?f.map(d=>p==null?void 0:p[d]):void 0);await Promise.all(y.generations.map(async(d,_)=>{const m=f[_];c[m]=d;const b=Ar._convertInputToPromptValue(i[m]).toString();return u.update(b,l,d)})),h=y.llmOutput??{}}return{generations:c,llmOutput:h}}invocationParams(e){return{}}_modelType(){return"base_chat_model"}serialize(){return{...this.invocationParams(),_type:this._llmType(),_model:this._modelType()}}async generatePrompt(e,t,r){const n=e.map(i=>i.toChatMessages());return this.generate(n,t,r)}async call(e,t,r){return(await this.generate([e.map(Uu)],t,r)).generations[0][0].message}async callPrompt(e,t,r){const n=e.toChatMessages();return this.call(n,t,r)}async predictMessages(e,t,r){return this.call(e,t,r)}async predict(e,t,r){const n=new ku(e),i=await this.call([n],t,r);if(typeof i.content!="string")throw new Error("Cannot use predict when output is not a string.");return i.content}withStructuredOutput(e,t){if(typeof this.bindTools!="function")throw new Error('Chat model must implement ".bindTools()" to use withStructuredOutput.');if(t!=null&&t.strict)throw new Error('"strict" mode is not supported for this model by default.');const r=e,n=t==null?void 0:t.name,i=r.description??"A function available to call.",o=t==null?void 0:t.method,s=t==null?void 0:t.includeRaw;if(o==="jsonMode")throw new Error('Base withStructuredOutput implementation only supports "functionCalling" as a method.');let u=n??"extract",l;jf(r)?l=[{type:"function",function:{name:u,description:i,parameters:au(r)}}]:("name"in r&&(u=r.name),l=[{type:"function",function:{name:u,description:i,parameters:r}}]);const c=this.bindTools(l),f=Gp.from(d=>{if(!d.tool_calls||d.tool_calls.length===0)throw new Error("No tool calls found in the response.");const _=d.tool_calls.find(m=>m.name===u);if(!_)throw new Error(`No tool call found with name ${u}.`);return _.args});if(!s)return c.pipe(f).withConfig({runName:"StructuredOutput"});const p=ou.assign({parsed:(d,_)=>f.invoke(d.raw,_)}),h=ou.assign({parsed:()=>null}),y=p.withFallbacks({fallbacks:[h]});return mr.from([{raw:c},y]).withConfig({runName:"StructuredOutputRunnable"})}}class dC extends ct{parseResultWithPrompt(e,t,r){return this.parseResult(e,r)}_baseMessageToString(e){return typeof e.content=="string"?e.content:this._baseMessageContentToString(e.content)}_baseMessageContentToString(e){return JSON.stringify(e)}async invoke(e,t){return typeof e=="string"?this._callWithConfig(async(r,n)=>this.parseResult([{text:r}],n==null?void 0:n.callbacks),e,{...t,runType:"parser"}):this._callWithConfig(async(r,n)=>this.parseResult([{message:r,text:this._baseMessageToString(r)}],n==null?void 0:n.callbacks),e,{...t,runType:"parser"})}}class C3 extends dC{parseResult(e,t){return this.parse(e[0].text,t)}async parseWithPrompt(e,t,r){return this.parse(e,r)}_type(){throw new Error("_type not implemented")}}class Tf extends Error{constructor(e,t,r,n=!1){if(super(e),Object.defineProperty(this,"llmOutput",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"observation",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"sendToLLM",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.llmOutput=t,this.observation=r,this.sendToLLM=n,n&&(r===void 0||t===void 0))throw new Error("Arguments 'observation' & 'llmOutput' are required if 'sendToLlm' is true");ib(this,"OUTPUT_PARSING_FAILURE")}}function kE(a,e){const t=typeof a;if(t!==typeof e)return!1;if(Array.isArray(a)){if(!Array.isArray(e))return!1;const r=a.length;if(r!==e.length)return!1;for(let n=0;n<r;n++)if(!kE(a[n],e[n]))return!1;return!0}if(t==="object"){if(!a||!e)return a===e;const r=Object.keys(a),n=Object.keys(e);if(r.length!==n.length)return!1;for(const o of r)if(!kE(a[o],e[o]))return!1;return!0}return a===e}class u7 extends C3{async*_transform(e){for await(const t of e)typeof t=="string"?yield this.parseResult([{text:t}]):yield this.parseResult([{message:t,text:this._baseMessageToString(t)}])}async*transform(e,t){yield*this._transformStreamWithConfig(e,this._transform.bind(this),{...t,runType:"parser"})}}class P3 extends u7{constructor(e){super(e),Object.defineProperty(this,"diff",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this.diff=(e==null?void 0:e.diff)??this.diff}async*_transform(e){let t,r;for await(const n of e){if(typeof n!="string"&&typeof n.content!="string")throw new Error("Cannot handle non-string output.");let i;if(q9(n)){if(typeof n.content!="string")throw new Error("Cannot handle non-string message output.");i=new rr({message:n,text:n.content})}else if(If(n)){if(typeof n.content!="string")throw new Error("Cannot handle non-string message output.");i=new rr({message:L9(n),text:n.content})}else i=new Ru({text:n});r===void 0?r=i:r=r.concat(i);const o=await this.parsePartialResult([r]);o!=null&&!kE(o,t)&&(this.diff?yield this._diff(t,o):yield o,t=o)}}getFormatInstructions(){return""}}class HE extends C3{static lc_name(){return"StructuredOutputParser"}toJSON(){return this.toJSONNotImplemented()}constructor(e){super(e),Object.defineProperty(this,"schema",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","structured"]})}static fromZodSchema(e){return new this(e)}static fromNamesAndDescriptions(e){const t=Oc.object(Object.fromEntries(Object.entries(e).map(([r,n])=>[r,Oc.string().describe(n)])));return new this(t)}getFormatInstructions(){return`You must format your output as a JSON value that adheres to a given "JSON Schema" instance.

"JSON Schema" is a declarative language that allows you to annotate and validate JSON documents.

For example, the example "JSON Schema" instance {{"properties": {{"foo": {{"description": "a list of test words", "type": "array", "items": {{"type": "string"}}}}}}, "required": ["foo"]}}}}
would match an object with one required property, "foo". The "type" property specifies "foo" must be an "array", and the "description" property semantically describes it as "a list of test words". The items within "foo" must be strings.
Thus, the object {{"foo": ["bar", "baz"]}} is a well-formatted instance of this example "JSON Schema". The object {{"properties": {{"foo": ["bar", "baz"]}}}} is not well-formatted.

Your output will be parsed and type-checked according to the provided schema instance, so make sure all fields in your output match the schema exactly and there are no trailing commas!

Here is the JSON Schema instance your output must adhere to. Include the enclosing markdown codeblock:
\`\`\`json
${JSON.stringify(au(this.schema))}
\`\`\`
`}async parse(e){try{const r=(e.includes("```")?e.trim().split(/```(?:json)?/)[1]:e.trim()).replace(/"([^"\\]*(\\.[^"\\]*)*)"/g,(n,i)=>`"${i.replace(/\n/g,"\\n")}"`).replace(/\n/g,"");return await this.schema.parseAsync(JSON.parse(r))}catch(t){throw new Tf(`Failed to parse. Text: "${e}". Error: ${t}`,e)}}}class WE extends P3{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","output_parsers"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0})}static lc_name(){return"JsonOutputParser"}_diff(e,t){if(t)return e?AK(e,t):[{op:"replace",path:"",value:t}]}async parsePartialResult(e){return yP(e[0].text)}async parse(e){return yP(e,JSON.parse)}getFormatInstructions(){return""}}function hC(a,e){if(a.function===void 0)return;let t;if(e!=null&&e.partial)try{t=yR(a.function.arguments??"{}")}catch{return}else try{t=JSON.parse(a.function.arguments)}catch(n){throw new Tf([`Function "${a.function.name}" arguments:`,"",a.function.arguments,"","are not valid JSON.",`Error: ${n.message}`].join(`
`))}const r={name:a.function.name,args:t,type:"tool_call"};return e!=null&&e.returnId&&(r.id=a.id),r}function j3(a){if(a.id===void 0)throw new Error('All OpenAI tool calls must have an "id" field.');return{id:a.id,type:"function",function:{name:a.name,arguments:JSON.stringify(a.args)}}}function T3(a,e){var t,r;return{name:(t=a.function)==null?void 0:t.name,args:(r=a.function)==null?void 0:r.arguments,id:a.id,error:e,type:"invalid_tool_call"}}class l7 extends P3{static lc_name(){return"JsonOutputToolsParser"}constructor(e){super(e),Object.defineProperty(this,"returnId",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","openai_tools"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),this.returnId=(e==null?void 0:e.returnId)??this.returnId}_diff(){throw new Error("Not supported.")}async parse(){throw new Error("Not implemented.")}async parseResult(e){return await this.parsePartialResult(e,!1)}async parsePartialResult(e,t=!0){var o;const r=e[0].message;let n;if(ru(r)&&((o=r.tool_calls)!=null&&o.length)?n=r.tool_calls.map(s=>{const{id:u,...l}=s;return this.returnId?{id:u,...l}:l}):r.additional_kwargs.tool_calls!==void 0&&(n=JSON.parse(JSON.stringify(r.additional_kwargs.tool_calls)).map(u=>hC(u,{returnId:this.returnId,partial:t}))),!n)return[];const i=[];for(const s of n)if(s!==void 0){const u={type:s.name,args:s.args,id:s.id};i.push(u)}return i}}class Vy extends l7{static lc_name(){return"JsonOutputKeyToolsParser"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","openai_tools"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"returnId",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"keyName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"returnSingle",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"zodSchema",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.keyName=e.keyName,this.returnSingle=e.returnSingle??this.returnSingle,this.zodSchema=e.zodSchema}async _validateResult(e){if(this.zodSchema===void 0)return e;const t=await this.zodSchema.safeParseAsync(e);if(t.success)return t.data;throw new Tf(`Failed to parse. Text: "${JSON.stringify(e,null,2)}". Error: ${JSON.stringify(t.error.errors)}`,JSON.stringify(e,null,2))}async parsePartialResult(e){const r=(await super.parsePartialResult(e)).filter(i=>i.type===this.keyName);let n=r;if(r.length)return this.returnId||(n=r.map(i=>i.args)),this.returnSingle?n[0]:n}async parseResult(e){const r=(await super.parsePartialResult(e,!1)).filter(o=>o.type===this.keyName);let n=r;return r.length?(this.returnId||(n=r.map(o=>o.args)),this.returnSingle?this._validateResult(n[0]):await Promise.all(n.map(o=>this._validateResult(o)))):void 0}}const c7=Symbol("Let zodToJsonSchema decide on which parser to use"),S1={name:void 0,$refStrategy:"root",effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",nullableStrategy:"from-target",removeAdditionalStrategy:"passthrough",definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"},f7=a=>typeof a=="string"?{...S1,basePath:["#"],definitions:{},name:a}:{...S1,basePath:["#"],definitions:{},...a},KE=a=>"_def"in a?a._def:a;function d7(a){if(!a)return!0;for(const e in a)return!1;return!0}const h7=a=>{const e=f7(a),t=e.name!==void 0?[...e.basePath,e.definitionPath,e.name]:e.basePath;return{...e,currentPath:t,propertyPath:void 0,seenRefs:new Set,seen:new Map(Object.entries(e.definitions).map(([r,n])=>[KE(n),{def:KE(n),path:[...e.basePath,e.definitionPath,r],jsonSchema:void 0}]))}};function M3(a,e,t,r){r!=null&&r.errorMessages&&t&&(a.errorMessage={...a.errorMessage,[e]:t})}function Qe(a,e,t,r,n){a[e]=t,M3(a,e,r,n)}function p7(){return{}}function _7(a,e){var r,n;const t={type:"array"};return((n=(r=a.type)==null?void 0:r._def)==null?void 0:n.typeName)!==oe.ZodAny&&(t.items=He(a.type._def,{...e,currentPath:[...e.currentPath,"items"]})),a.minLength&&Qe(t,"minItems",a.minLength.value,a.minLength.message,e),a.maxLength&&Qe(t,"maxItems",a.maxLength.value,a.maxLength.message,e),a.exactLength&&(Qe(t,"minItems",a.exactLength.value,a.exactLength.message,e),Qe(t,"maxItems",a.exactLength.value,a.exactLength.message,e)),t}function y7(a,e){const t={type:"integer",format:"int64"};if(!a.checks)return t;for(const r of a.checks)switch(r.kind){case"min":e.target==="jsonSchema7"?r.inclusive?Qe(t,"minimum",r.value,r.message,e):Qe(t,"exclusiveMinimum",r.value,r.message,e):(r.inclusive||(t.exclusiveMinimum=!0),Qe(t,"minimum",r.value,r.message,e));break;case"max":e.target==="jsonSchema7"?r.inclusive?Qe(t,"maximum",r.value,r.message,e):Qe(t,"exclusiveMaximum",r.value,r.message,e):(r.inclusive||(t.exclusiveMaximum=!0),Qe(t,"maximum",r.value,r.message,e));break;case"multipleOf":Qe(t,"multipleOf",r.value,r.message,e);break}return t}function b7(){return{type:"boolean"}}function m7(a,e){return He(a.type._def,e)}const g7=(a,e)=>He(a.innerType._def,e);function A3(a,e,t){const r=t??e.dateStrategy;if(Array.isArray(r))return{anyOf:r.map((n,i)=>A3(a,e,n))};switch(r){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return v7(a,e)}}const v7=(a,e)=>{const t={type:"integer",format:"unix-time"};if(e.target==="openApi3")return t;for(const r of a.checks)switch(r.kind){case"min":Qe(t,"minimum",r.value,r.message,e);break;case"max":Qe(t,"maximum",r.value,r.message,e);break}return t};function w7(a,e){return{...He(a.innerType._def,e),default:a.defaultValue()}}function O7(a,e,t){return e.effectStrategy==="input"?He(a.schema._def,e,t):{}}function S7(a){return{type:"string",enum:[...a.values]}}const E7=a=>"type"in a&&a.type==="string"?!1:"allOf"in a;function R7(a,e){const t=[He(a.left._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),He(a.right._def,{...e,currentPath:[...e.currentPath,"allOf","1"]})].filter(i=>!!i);let r=e.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0;const n=[];return t.forEach(i=>{if(E7(i))n.push(...i.allOf),i.unevaluatedProperties===void 0&&(r=void 0);else{let o=i;if("additionalProperties"in i&&i.additionalProperties===!1){const{additionalProperties:s,...u}=i;o=u}else r=void 0;n.push(o)}}),n.length?{allOf:n,...r}:void 0}function C7(a,e){const t=typeof a.value;return t!=="bigint"&&t!=="number"&&t!=="boolean"&&t!=="string"?{type:Array.isArray(a.value)?"array":"object"}:e.target==="openApi3"?{type:t==="bigint"?"integer":t,enum:[a.value]}:{type:t==="bigint"?"integer":t,const:a.value}}let Rg;const dl={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(Rg===void 0&&(Rg=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),Rg),base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/};function I3(a,e){const t={type:"string"};function r(n){return e.patternStrategy==="escape"?P7(n):n}if(a.checks)for(const n of a.checks)switch(n.kind){case"min":Qe(t,"minLength",typeof t.minLength=="number"?Math.max(t.minLength,n.value):n.value,n.message,e);break;case"max":Qe(t,"maxLength",typeof t.maxLength=="number"?Math.min(t.maxLength,n.value):n.value,n.message,e);break;case"email":switch(e.emailStrategy){case"format:email":Ur(t,"email",n.message,e);break;case"format:idn-email":Ur(t,"idn-email",n.message,e);break;case"pattern:zod":Fr(t,dl.email,n.message,e);break}break;case"url":Ur(t,"uri",n.message,e);break;case"uuid":Ur(t,"uuid",n.message,e);break;case"regex":Fr(t,n.regex,n.message,e);break;case"cuid":Fr(t,dl.cuid,n.message,e);break;case"cuid2":Fr(t,dl.cuid2,n.message,e);break;case"startsWith":Fr(t,RegExp(`^${r(n.value)}`),n.message,e);break;case"endsWith":Fr(t,RegExp(`${r(n.value)}$`),n.message,e);break;case"datetime":Ur(t,"date-time",n.message,e);break;case"date":Ur(t,"date",n.message,e);break;case"time":Ur(t,"time",n.message,e);break;case"duration":Ur(t,"duration",n.message,e);break;case"length":Qe(t,"minLength",typeof t.minLength=="number"?Math.max(t.minLength,n.value):n.value,n.message,e),Qe(t,"maxLength",typeof t.maxLength=="number"?Math.min(t.maxLength,n.value):n.value,n.message,e);break;case"includes":{Fr(t,RegExp(r(n.value)),n.message,e);break}case"ip":{n.version!=="v6"&&Ur(t,"ipv4",n.message,e),n.version!=="v4"&&Ur(t,"ipv6",n.message,e);break}case"emoji":Fr(t,dl.emoji,n.message,e);break;case"ulid":{Fr(t,dl.ulid,n.message,e);break}case"base64":{switch(e.base64Strategy){case"format:binary":{Ur(t,"binary",n.message,e);break}case"contentEncoding:base64":{Qe(t,"contentEncoding","base64",n.message,e);break}case"pattern:zod":{Fr(t,dl.base64,n.message,e);break}}break}case"nanoid":Fr(t,dl.nanoid,n.message,e)}return t}const P7=a=>Array.from(a).map(e=>/[a-zA-Z0-9]/.test(e)?e:`\\${e}`).join(""),Ur=(a,e,t,r)=>{var n;a.format||(n=a.anyOf)!=null&&n.some(i=>i.format)?(a.anyOf||(a.anyOf=[]),a.format&&(a.anyOf.push({format:a.format,...a.errorMessage&&r.errorMessages&&{errorMessage:{format:a.errorMessage.format}}}),delete a.format,a.errorMessage&&(delete a.errorMessage.format,Object.keys(a.errorMessage).length===0&&delete a.errorMessage)),a.anyOf.push({format:e,...t&&r.errorMessages&&{errorMessage:{format:t}}})):Qe(a,"format",e,t,r)},Fr=(a,e,t,r)=>{var n;a.pattern||(n=a.allOf)!=null&&n.some(i=>i.pattern)?(a.allOf||(a.allOf=[]),a.pattern&&(a.allOf.push({pattern:a.pattern,...a.errorMessage&&r.errorMessages&&{errorMessage:{pattern:a.errorMessage.pattern}}}),delete a.pattern,a.errorMessage&&(delete a.errorMessage.pattern,Object.keys(a.errorMessage).length===0&&delete a.errorMessage)),a.allOf.push({pattern:E1(e,r),...t&&r.errorMessages&&{errorMessage:{pattern:t}}})):Qe(a,"pattern",E1(e,r),t,r)},E1=(a,e)=>{var l;const t=typeof a=="function"?a():a;if(!e.applyRegexFlags||!t.flags)return t.source;const r={i:t.flags.includes("i"),m:t.flags.includes("m"),s:t.flags.includes("s")},n=r.i?t.source.toLowerCase():t.source;let i="",o=!1,s=!1,u=!1;for(let c=0;c<n.length;c++){if(o){i+=n[c],o=!1;continue}if(r.i){if(s){if(n[c].match(/[a-z]/)){u?(i+=n[c],i+=`${n[c-2]}-${n[c]}`.toUpperCase(),u=!1):n[c+1]==="-"&&((l=n[c+2])!=null&&l.match(/[a-z]/))?(i+=n[c],u=!0):i+=`${n[c]}${n[c].toUpperCase()}`;continue}}else if(n[c].match(/[a-z]/)){i+=`[${n[c]}${n[c].toUpperCase()}]`;continue}}if(r.m){if(n[c]==="^"){i+=`(^|(?<=[\r
]))`;continue}else if(n[c]==="$"){i+=`($|(?=[\r
]))`;continue}}if(r.s&&n[c]==="."){i+=s?`${n[c]}\r
`:`[${n[c]}\r
]`;continue}i+=n[c],n[c]==="\\"?o=!0:s&&n[c]==="]"?s=!1:!s&&n[c]==="["&&(s=!0)}try{const c=new RegExp(i)}catch{return console.warn(`Could not convert regex pattern at ${e.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),t.source}return i};function D3(a,e){var r,n,i,o;if(e.target==="openApi3"&&((r=a.keyType)==null?void 0:r._def.typeName)===oe.ZodEnum)return{type:"object",required:a.keyType._def.values,properties:a.keyType._def.values.reduce((s,u)=>({...s,[u]:He(a.valueType._def,{...e,currentPath:[...e.currentPath,"properties",u]})??{}}),{}),additionalProperties:!1};const t={type:"object",additionalProperties:He(a.valueType._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??{}};if(e.target==="openApi3")return t;if(((n=a.keyType)==null?void 0:n._def.typeName)===oe.ZodString&&((i=a.keyType._def.checks)!=null&&i.length)){const s=Object.entries(I3(a.keyType._def,e)).reduce((u,[l,c])=>l==="type"?u:{...u,[l]:c},{});return{...t,propertyNames:s}}else if(((o=a.keyType)==null?void 0:o._def.typeName)===oe.ZodEnum)return{...t,propertyNames:{enum:a.keyType._def.values}};return t}function j7(a,e){if(e.mapStrategy==="record")return D3(a,e);const t=He(a.keyType._def,{...e,currentPath:[...e.currentPath,"items","items","0"]})||{},r=He(a.valueType._def,{...e,currentPath:[...e.currentPath,"items","items","1"]})||{};return{type:"array",maxItems:125,items:{type:"array",items:[t,r],minItems:2,maxItems:2}}}function T7(a){const e=a.values,r=Object.keys(a.values).filter(i=>typeof e[e[i]]!="number").map(i=>e[i]),n=Array.from(new Set(r.map(i=>typeof i)));return{type:n.length===1?n[0]==="string"?"string":"number":["string","number"],enum:r}}function M7(){return{not:{}}}function A7(a){return a.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}const Gy={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function I7(a,e){if(e.target==="openApi3")return R1(a,e);const t=a.options instanceof Map?Array.from(a.options.values()):a.options;if(t.every(r=>r._def.typeName in Gy&&(!r._def.checks||!r._def.checks.length))){const r=t.reduce((n,i)=>{const o=Gy[i._def.typeName];return o&&!n.includes(o)?[...n,o]:n},[]);return{type:r.length>1?r:r[0]}}else if(t.every(r=>r._def.typeName==="ZodLiteral"&&!r.description)){const r=t.reduce((n,i)=>{const o=typeof i._def.value;switch(o){case"string":case"number":case"boolean":return[...n,o];case"bigint":return[...n,"integer"];case"object":if(i._def.value===null)return[...n,"null"];case"symbol":case"undefined":case"function":default:return n}},[]);if(r.length===t.length){const n=r.filter((i,o,s)=>s.indexOf(i)===o);return{type:n.length>1?n:n[0],enum:t.reduce((i,o)=>i.includes(o._def.value)?i:[...i,o._def.value],[])}}}else if(t.every(r=>r._def.typeName==="ZodEnum"))return{type:"string",enum:t.reduce((r,n)=>[...r,...n._def.values.filter(i=>!r.includes(i))],[])};return R1(a,e)}const R1=(a,e)=>{const t=(a.options instanceof Map?Array.from(a.options.values()):a.options).map((r,n)=>He(r._def,{...e,currentPath:[...e.currentPath,"anyOf",`${n}`]})).filter(r=>!!r&&(!e.strictUnions||typeof r=="object"&&Object.keys(r).length>0));return t.length?{anyOf:t}:void 0};function D7(a,e){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(a.innerType._def.typeName)&&(!a.innerType._def.checks||!a.innerType._def.checks.length))return e.target==="openApi3"||e.nullableStrategy==="property"?{type:Gy[a.innerType._def.typeName],nullable:!0}:{type:[Gy[a.innerType._def.typeName],"null"]};if(e.target==="openApi3"){const r=He(a.innerType._def,{...e,currentPath:[...e.currentPath]});return r&&"$ref"in r?{allOf:[r],nullable:!0}:r&&{...r,nullable:!0}}const t=He(a.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","0"]});return t&&{anyOf:[t,{type:"null"}]}}function x7(a,e){const t={type:"number"};if(!a.checks)return t;for(const r of a.checks)switch(r.kind){case"int":t.type="integer",M3(t,"type",r.message,e);break;case"min":e.target==="jsonSchema7"?r.inclusive?Qe(t,"minimum",r.value,r.message,e):Qe(t,"exclusiveMinimum",r.value,r.message,e):(r.inclusive||(t.exclusiveMinimum=!0),Qe(t,"minimum",r.value,r.message,e));break;case"max":e.target==="jsonSchema7"?r.inclusive?Qe(t,"maximum",r.value,r.message,e):Qe(t,"exclusiveMaximum",r.value,r.message,e):(r.inclusive||(t.exclusiveMaximum=!0),Qe(t,"maximum",r.value,r.message,e));break;case"multipleOf":Qe(t,"multipleOf",r.value,r.message,e);break}return t}function $7(a,e){return e.removeAdditionalStrategy==="strict"?a.catchall._def.typeName==="ZodNever"?a.unknownKeys!=="strict":He(a.catchall._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??!0:a.catchall._def.typeName==="ZodNever"?a.unknownKeys==="passthrough":He(a.catchall._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??!0}function N7(a,e){const t={type:"object",...Object.entries(a.shape()).reduce((r,[n,i])=>{if(i===void 0||i._def===void 0)return r;const o=He(i._def,{...e,currentPath:[...e.currentPath,"properties",n],propertyPath:[...e.currentPath,"properties",n]});return o===void 0?r:{properties:{...r.properties,[n]:o},required:i.isOptional()&&!e.openaiStrictMode?r.required:[...r.required,n]}},{properties:{},required:[]}),additionalProperties:$7(a,e)};return t.required.length||delete t.required,t}const q7=(a,e)=>{var r;if(e.currentPath.toString()===((r=e.propertyPath)==null?void 0:r.toString()))return He(a.innerType._def,e);const t=He(a.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","1"]});return t?{anyOf:[{not:{}},t]}:{}},z7=(a,e)=>{if(e.pipeStrategy==="input")return He(a.in._def,e);if(e.pipeStrategy==="output")return He(a.out._def,e);const t=He(a.in._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),r=He(a.out._def,{...e,currentPath:[...e.currentPath,"allOf",t?"1":"0"]});return{allOf:[t,r].filter(n=>n!==void 0)}};function B7(a,e){return He(a.type._def,e)}function U7(a,e){const r={type:"array",uniqueItems:!0,items:He(a.valueType._def,{...e,currentPath:[...e.currentPath,"items"]})};return a.minSize&&Qe(r,"minItems",a.minSize.value,a.minSize.message,e),a.maxSize&&Qe(r,"maxItems",a.maxSize.value,a.maxSize.message,e),r}function F7(a,e){return a.rest?{type:"array",minItems:a.items.length,items:a.items.map((t,r)=>He(t._def,{...e,currentPath:[...e.currentPath,"items",`${r}`]})).reduce((t,r)=>r===void 0?t:[...t,r],[]),additionalItems:He(a.rest._def,{...e,currentPath:[...e.currentPath,"additionalItems"]})}:{type:"array",minItems:a.items.length,maxItems:a.items.length,items:a.items.map((t,r)=>He(t._def,{...e,currentPath:[...e.currentPath,"items",`${r}`]})).reduce((t,r)=>r===void 0?t:[...t,r],[])}}function L7(){return{not:{}}}function V7(){return{}}const G7=(a,e)=>He(a.innerType._def,e);function He(a,e,t=!1){var o;const r=e.seen.get(a);if(e.override){const s=(o=e.override)==null?void 0:o.call(e,a,e,r,t);if(s!==c7)return s}if(r&&!t){const s=k7(r,e);if(s!==void 0)return"$ref"in s&&e.seenRefs.add(s.$ref),s}const n={def:a,path:e.currentPath,jsonSchema:void 0};e.seen.set(a,n);const i=W7(a,a.typeName,e,t);return i&&K7(a,e,i),n.jsonSchema=i,i}const k7=(a,e)=>{switch(e.$refStrategy){case"root":return{$ref:a.path.join("/")};case"extract-to-root":const t=a.path.slice(e.basePath.length+1).join("_");return t!==e.name&&e.nameStrategy==="duplicate-ref"&&(e.definitions[t]=a.def),{$ref:[...e.basePath,e.definitionPath,t].join("/")};case"relative":return{$ref:H7(e.currentPath,a.path)};case"none":case"seen":return a.path.length<e.currentPath.length&&a.path.every((r,n)=>e.currentPath[n]===r)?(console.warn(`Recursive reference detected at ${e.currentPath.join("/")}! Defaulting to any`),{}):e.$refStrategy==="seen"?{}:void 0}},H7=(a,e)=>{let t=0;for(;t<a.length&&t<e.length&&a[t]===e[t];t++);return[(a.length-t).toString(),...e.slice(t)].join("/")},W7=(a,e,t,r)=>{switch(e){case oe.ZodString:return I3(a,t);case oe.ZodNumber:return x7(a,t);case oe.ZodObject:return N7(a,t);case oe.ZodBigInt:return y7(a,t);case oe.ZodBoolean:return b7();case oe.ZodDate:return A3(a,t);case oe.ZodUndefined:return L7();case oe.ZodNull:return A7(t);case oe.ZodArray:return _7(a,t);case oe.ZodUnion:case oe.ZodDiscriminatedUnion:return I7(a,t);case oe.ZodIntersection:return R7(a,t);case oe.ZodTuple:return F7(a,t);case oe.ZodRecord:return D3(a,t);case oe.ZodLiteral:return C7(a,t);case oe.ZodEnum:return S7(a);case oe.ZodNativeEnum:return T7(a);case oe.ZodNullable:return D7(a,t);case oe.ZodOptional:return q7(a,t);case oe.ZodMap:return j7(a,t);case oe.ZodSet:return U7(a,t);case oe.ZodLazy:return He(a.getter()._def,t);case oe.ZodPromise:return B7(a,t);case oe.ZodNaN:case oe.ZodNever:return M7();case oe.ZodEffects:return O7(a,t,r);case oe.ZodAny:return p7();case oe.ZodUnknown:return V7();case oe.ZodDefault:return w7(a,t);case oe.ZodBranded:return m7(a,t);case oe.ZodReadonly:return G7(a,t);case oe.ZodCatch:return g7(a,t);case oe.ZodPipeline:return z7(a,t);case oe.ZodFunction:case oe.ZodVoid:case oe.ZodSymbol:return;default:return(n=>{})()}},K7=(a,e,t)=>(a.description&&(t.description=a.description,e.markdownDescription&&(t.markdownDescription=a.description)),t),J7=(a,e)=>{const t=h7(e),r=typeof e=="string"?e:(e==null?void 0:e.nameStrategy)==="title"||e==null?void 0:e.name,n=He(a._def,r===void 0?t:{...t,currentPath:[...t.basePath,t.definitionPath,r]},!1)??{},i=typeof e=="object"&&e.name!==void 0&&e.nameStrategy==="title"?e.name:void 0;i!==void 0&&(n.title=i);const o=(()=>{if(d7(t.definitions))return;const u={},l=new Set;for(let c=0;c<500;c++){const f=Object.entries(t.definitions).filter(([p])=>!l.has(p));if(f.length===0)break;for(const[p,h]of f)u[p]=He(KE(h),{...t,currentPath:[...t.basePath,t.definitionPath,p]},!0)??{},l.add(p)}return u})(),s=r===void 0?o?{...n,[t.definitionPath]:o}:n:t.nameStrategy==="duplicate-ref"?{...n,...o||t.seenRefs.size?{[t.definitionPath]:{...o,...t.seenRefs.size?{[r]:n}:void 0}}:void 0}:{$ref:[...t.$refStrategy==="relative"?[]:t.basePath,t.definitionPath,r].join("/"),[t.definitionPath]:{...o,[r]:n}};return t.target==="jsonSchema7"?s.$schema="http://json-schema.org/draft-07/schema#":t.target==="jsonSchema2019-09"&&(s.$schema="https://json-schema.org/draft/2019-09/schema#"),s};function x3(a,e){return J7(a,{openaiStrictMode:!0,name:e.name,nameStrategy:"duplicate-ref",$refStrategy:"extract-to-root",nullableStrategy:"property"})}function X7(a,e,t){return AX({type:"json_schema",json_schema:{...t,name:e,strict:!0,schema:x3(a,{name:e})}},r=>a.parse(JSON.parse(r)))}function Z7(a){return IX({type:"function",function:{name:a.name,parameters:x3(a.parameters,{name:a.name}),strict:!0,...a.description?{description:a.description}:void 0}},{callback:a.function,parser:e=>a.parameters.parse(JSON.parse(e))})}function Rb(a){const{azureOpenAIApiDeploymentName:e,azureOpenAIApiInstanceName:t,azureOpenAIApiKey:r,azureOpenAIBasePath:n,baseURL:i,azureADTokenProvider:o,azureOpenAIEndpoint:s}=a;if((r||o)&&n&&e)return`${n}/${e}`;if((r||o)&&s&&e)return`${s}/openai/deployments/${e}`;if(r||o){if(!t)throw new Error("azureOpenAIApiInstanceName is required when using azureOpenAIApiKey");if(!e)throw new Error("azureOpenAIApiDeploymentName is a required parameter when using azureOpenAIApiKey");return`https://${t}.openai.azure.com/openai/deployments/${e}`}return i}function $3(a,e){const t=typeof e=="number"?void 0:e;return{name:a.name,description:a.description,parameters:au(a.schema),...(t==null?void 0:t.strict)!==void 0?{strict:t.strict}:{}}}function Q7(a,e){let t;return Uf(a)?t={type:"function",function:$3(a)}:t=a,t}function Y7(a){return a!==void 0&&Array.isArray(a.lc_namespace)}function eZ(a){return a!==void 0&&ct.isRunnable(a)&&"lc_name"in a.constructor&&typeof a.constructor.lc_name=="function"&&a.constructor.lc_name()==="RunnableToolLike"}function tZ(a){return!!a&&typeof a=="object"&&"name"in a&&"schema"in a&&jf(a.schema)}function Uf(a){return tZ(a)||eZ(a)||Y7(a)}function j_(a,e){return a.lc_error_code=e,a.message=`${a.message}

Troubleshooting URL: https://js.langchain.com/docs/troubleshooting/errors/${e}/
`,a}function ky(a){let e;return a.constructor.name===yb.name?(e=new Error(a.message),e.name="TimeoutError"):a.constructor.name===gr.name?(e=new Error(a.message),e.name="AbortError"):a.status===400&&a.message.includes("tool_calls")?e=j_(a,"INVALID_TOOL_RESULTS"):a.status===401?e=j_(a,"MODEL_AUTHENTICATION"):a.status===429?e=j_(a,"MODEL_RATE_LIMIT"):a.status===404?e=j_(a,"MODEL_NOT_FOUND"):e=a,e}function rZ(a){if(a)return a==="any"||a==="required"?"required":a==="auto"?"auto":a==="none"?"none":typeof a=="string"?{type:"function",function:{name:a}}:a}function nZ(a){return a.anyOf!==void 0&&Array.isArray(a.anyOf)}function iZ(a){const e=["namespace functions {",""];for(const t of a)t.description&&e.push(`// ${t.description}`),Object.keys(t.parameters.properties??{}).length>0?(e.push(`type ${t.name} = (_: {`),e.push(N3(t.parameters,0)),e.push("}) => any;")):e.push(`type ${t.name} = () => any;`),e.push("");return e.push("} // namespace functions"),e.join(`
`)}function N3(a,e){var r;const t=[];for(const[n,i]of Object.entries(a.properties??{}))i.description&&e<2&&t.push(`// ${i.description}`),(r=a.required)!=null&&r.includes(n)?t.push(`${n}: ${Hy(i,e)},`):t.push(`${n}?: ${Hy(i,e)},`);return t.map(n=>" ".repeat(e)+n).join(`
`)}function Hy(a,e){if(nZ(a))return a.anyOf.map(t=>Hy(t,e)).join(" | ");switch(a.type){case"string":return a.enum?a.enum.map(t=>`"${t}"`).join(" | "):"string";case"number":return a.enum?a.enum.map(t=>`${t}`).join(" | "):"number";case"integer":return a.enum?a.enum.map(t=>`${t}`).join(" | "):"number";case"boolean":return"boolean";case"null":return"null";case"object":return["{",N3(a,e+2),"}"].join(`
`);case"array":return a.items?`${Hy(a.items,e)}[]`:"any[]";default:return""}}function aZ(a,e){let t;if(Uf(a)){const r=Z7({name:a.name,parameters:a.schema,description:a.description});r.function.parameters?t={type:r.type,function:{name:r.function.name,description:r.function.description,parameters:r.function.parameters,...(e==null?void 0:e.strict)!==void 0?{strict:e.strict}:{}}}:t={type:"function",function:$3(a,e)}}else t=a;return(e==null?void 0:e.strict)!==void 0&&(t.function.strict=e.strict),t}function oZ(a){return a.role!=="system"&&a.role!=="developer"&&a.role!=="assistant"&&a.role!=="user"&&a.role!=="function"&&a.role!=="tool"&&console.warn(`Unknown message role: ${a.role}`),a.role}function q3(a){const e=a._getType();switch(e){case"system":return"system";case"ai":return"assistant";case"human":return"user";case"function":return"function";case"tool":return"tool";case"generic":{if(!Ac.isInstance(a))throw new Error("Invalid generic chat message");return oZ(a)}default:throw new Error(`Unknown message type: ${e}`)}}function sZ(a,e,t){const r=a.tool_calls;switch(a.role){case"assistant":{const n=[],i=[];for(const u of r??[])try{n.push(hC(u,{returnId:!0}))}catch(l){i.push(T3(u,l.message))}const o={function_call:a.function_call,tool_calls:r};t!==void 0&&(o.__raw_response=e);const s={model_name:e.model,...e.system_fingerprint?{usage:{...e.usage},system_fingerprint:e.system_fingerprint}:{}};return a.audio&&(o.audio=a.audio),new Hs({content:a.content||"",tool_calls:n,invalid_tool_calls:i,additional_kwargs:o,response_metadata:s,id:e.id})}default:return new Ac(a.content||"",a.role??"unknown")}}function uZ(a,e,t,r){var u,l;const n=a.role??t,i=a.content??"";let o;a.function_call?o={function_call:a.function_call}:a.tool_calls?o={tool_calls:a.tool_calls}:o={},r&&(o.__raw_response=e),a.audio&&(o.audio={...a.audio,index:e.choices[0].index});const s={usage:{...e.usage}};if(n==="user")return new Up({content:i,response_metadata:s});if(n==="assistant"){const c=[];if(Array.isArray(a.tool_calls))for(const f of a.tool_calls)c.push({name:(u=f.function)==null?void 0:u.name,args:(l=f.function)==null?void 0:l.arguments,id:f.id,index:f.index,type:"tool_call_chunk"});return new it({content:i,tool_call_chunks:c,additional_kwargs:o,id:e.id,response_metadata:s})}else return n==="system"?new wf({content:i,response_metadata:s}):n==="developer"?new wf({content:i,response_metadata:s,additional_kwargs:{__openai_role__:"developer"}}):n==="function"?new ob({content:i,additional_kwargs:o,name:a.name,response_metadata:s}):n==="tool"?new bR({content:i,additional_kwargs:o,tool_call_id:a.tool_call_id,response_metadata:s}):new Bp({content:i,role:n,response_metadata:s})}function C1(a,e){return a.flatMap(t=>{var i;let r=q3(t);r==="system"&&(e!=null&&e.startsWith("o1"))&&(r="developer");const n={role:r,content:t.content};if(t.name!=null&&(n.name=t.name),t.additional_kwargs.function_call!=null&&(n.function_call=t.additional_kwargs.function_call,n.content=null),ru(t)&&((i=t.tool_calls)!=null&&i.length)?(n.tool_calls=t.tool_calls.map(j3),n.content=null):(t.additional_kwargs.tool_calls!=null&&(n.tool_calls=t.additional_kwargs.tool_calls),t.tool_call_id!=null&&(n.tool_call_id=t.tool_call_id)),t.additional_kwargs.audio&&typeof t.additional_kwargs.audio=="object"&&"id"in t.additional_kwargs.audio){const o={role:"assistant",audio:{id:t.additional_kwargs.audio.id}};return[n,o]}return n})}function P1(a,e){return Zp(a)?(e==null?void 0:e.strict)!==void 0?{...a,function:{...a.function,strict:e.strict}}:a:aZ(a,e)}class pC extends Ar{static lc_name(){return"ChatOpenAI"}get callKeys(){return[...super.callKeys,"options","function_call","functions","tools","tool_choice","promptIndex","response_format","seed","reasoning_effort"]}get lc_secrets(){return{openAIApiKey:"OPENAI_API_KEY",apiKey:"OPENAI_API_KEY",azureOpenAIApiKey:"AZURE_OPENAI_API_KEY",organization:"OPENAI_ORGANIZATION"}}get lc_aliases(){return{modelName:"model",openAIApiKey:"openai_api_key",apiKey:"openai_api_key",azureOpenAIApiVersion:"azure_openai_api_version",azureOpenAIApiKey:"azure_openai_api_key",azureOpenAIApiInstanceName:"azure_openai_api_instance_name",azureOpenAIApiDeploymentName:"azure_openai_api_deployment_name"}}constructor(e,t){var r,n,i,o,s,u,l,c,f;if(super(e??{}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"temperature",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"topP",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"frequencyPenalty",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"presencePenalty",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"n",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"logitBias",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"modelName",{enumerable:!0,configurable:!0,writable:!0,value:"gpt-3.5-turbo"}),Object.defineProperty(this,"model",{enumerable:!0,configurable:!0,writable:!0,value:"gpt-3.5-turbo"}),Object.defineProperty(this,"modelKwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stop",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stopSequences",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"user",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"streaming",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"streamUsage",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"maxTokens",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"logprobs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"topLogprobs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"openAIApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiVersion",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureADTokenProvider",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiInstanceName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiDeploymentName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIBasePath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIEndpoint",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"organization",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"__includeRawResponse",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"clientConfig",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"supportsStrictToolCalling",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"audio",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"modalities",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"reasoningEffort",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.openAIApiKey=(e==null?void 0:e.apiKey)??(e==null?void 0:e.openAIApiKey)??((r=e==null?void 0:e.configuration)==null?void 0:r.apiKey)??We("OPENAI_API_KEY"),this.apiKey=this.openAIApiKey,this.azureOpenAIApiKey=(e==null?void 0:e.azureOpenAIApiKey)??We("AZURE_OPENAI_API_KEY"),this.azureADTokenProvider=(e==null?void 0:e.azureADTokenProvider)??void 0,!this.azureOpenAIApiKey&&!this.apiKey&&!this.azureADTokenProvider)throw new Error("OpenAI or Azure OpenAI API key or Token Provider not found");if(this.azureOpenAIApiInstanceName=(e==null?void 0:e.azureOpenAIApiInstanceName)??We("AZURE_OPENAI_API_INSTANCE_NAME"),this.azureOpenAIApiDeploymentName=(e==null?void 0:e.azureOpenAIApiDeploymentName)??We("AZURE_OPENAI_API_DEPLOYMENT_NAME"),this.azureOpenAIApiVersion=(e==null?void 0:e.azureOpenAIApiVersion)??We("AZURE_OPENAI_API_VERSION"),this.azureOpenAIBasePath=(e==null?void 0:e.azureOpenAIBasePath)??We("AZURE_OPENAI_BASE_PATH"),this.organization=((n=e==null?void 0:e.configuration)==null?void 0:n.organization)??We("OPENAI_ORGANIZATION"),this.azureOpenAIEndpoint=(e==null?void 0:e.azureOpenAIEndpoint)??We("AZURE_OPENAI_ENDPOINT"),this.modelName=(e==null?void 0:e.model)??(e==null?void 0:e.modelName)??this.model,this.model=this.modelName,this.modelKwargs=(e==null?void 0:e.modelKwargs)??{},this.timeout=e==null?void 0:e.timeout,this.temperature=(e==null?void 0:e.temperature)??this.temperature,this.topP=(e==null?void 0:e.topP)??this.topP,this.frequencyPenalty=(e==null?void 0:e.frequencyPenalty)??this.frequencyPenalty,this.presencePenalty=(e==null?void 0:e.presencePenalty)??this.presencePenalty,this.maxTokens=e==null?void 0:e.maxTokens,this.logprobs=e==null?void 0:e.logprobs,this.topLogprobs=e==null?void 0:e.topLogprobs,this.n=(e==null?void 0:e.n)??this.n,this.logitBias=e==null?void 0:e.logitBias,this.stop=(e==null?void 0:e.stopSequences)??(e==null?void 0:e.stop),this.stopSequences=this==null?void 0:this.stop,this.user=e==null?void 0:e.user,this.__includeRawResponse=e==null?void 0:e.__includeRawResponse,this.audio=e==null?void 0:e.audio,this.modalities=e==null?void 0:e.modalities,this.reasoningEffort=e==null?void 0:e.reasoningEffort,this.azureOpenAIApiKey||this.azureADTokenProvider){if(!this.azureOpenAIApiInstanceName&&!this.azureOpenAIBasePath&&!this.azureOpenAIEndpoint)throw new Error("Azure OpenAI API instance name not found");if(!this.azureOpenAIApiDeploymentName&&this.azureOpenAIBasePath){const p=this.azureOpenAIBasePath.split("/openai/deployments/");if(p.length===2){const[,h]=p;this.azureOpenAIApiDeploymentName=h}}if(!this.azureOpenAIApiDeploymentName)throw new Error("Azure OpenAI API deployment name not found");if(!this.azureOpenAIApiVersion)throw new Error("Azure OpenAI API version not found");this.apiKey=this.apiKey??"",this.streamUsage=!1}this.model==="o1"&&(this.disableStreaming=!0),this.streaming=(e==null?void 0:e.streaming)??!1,this.streamUsage=(e==null?void 0:e.streamUsage)??this.streamUsage,this.clientConfig={apiKey:this.apiKey,organization:this.organization,baseURL:(t==null?void 0:t.basePath)??((i=e==null?void 0:e.configuration)==null?void 0:i.basePath),dangerouslyAllowBrowser:!0,defaultHeaders:((o=t==null?void 0:t.baseOptions)==null?void 0:o.headers)??((u=(s=e==null?void 0:e.configuration)==null?void 0:s.baseOptions)==null?void 0:u.headers),defaultQuery:((l=t==null?void 0:t.baseOptions)==null?void 0:l.params)??((f=(c=e==null?void 0:e.configuration)==null?void 0:c.baseOptions)==null?void 0:f.params),...t,...e==null?void 0:e.configuration},(e==null?void 0:e.supportsStrictToolCalling)!==void 0&&(this.supportsStrictToolCalling=e.supportsStrictToolCalling)}getLsParams(e){const t=this.invocationParams(e);return{ls_provider:"openai",ls_model_name:this.model,ls_model_type:"chat",ls_temperature:t.temperature??void 0,ls_max_tokens:t.max_tokens??void 0,ls_stop:e.stop}}bindTools(e,t){let r;return(t==null?void 0:t.strict)!==void 0?r=t.strict:this.supportsStrictToolCalling!==void 0&&(r=this.supportsStrictToolCalling),this.bind({tools:e.map(n=>P1(n,{strict:r})),...t})}createResponseFormat(e){return e&&e.type==="json_schema"&&e.json_schema.schema&&T_(e.json_schema.schema)?X7(e.json_schema.schema,e.json_schema.name,{description:e.json_schema.description}):e}invocationParams(e,t){var s;let r;(e==null?void 0:e.strict)!==void 0?r=e.strict:this.supportsStrictToolCalling!==void 0&&(r=this.supportsStrictToolCalling);let n={};(e==null?void 0:e.stream_options)!==void 0?n={stream_options:e.stream_options}:this.streamUsage&&(this.streaming||t!=null&&t.streaming)&&(n={stream_options:{include_usage:!0}});const i={model:this.model,temperature:this.temperature,top_p:this.topP,frequency_penalty:this.frequencyPenalty,presence_penalty:this.presencePenalty,max_tokens:this.maxTokens===-1?void 0:this.maxTokens,logprobs:this.logprobs,top_logprobs:this.topLogprobs,n:this.n,logit_bias:this.logitBias,stop:(e==null?void 0:e.stop)??this.stopSequences,user:this.user,stream:this.streaming,functions:e==null?void 0:e.functions,function_call:e==null?void 0:e.function_call,tools:(s=e==null?void 0:e.tools)!=null&&s.length?e.tools.map(u=>P1(u,{strict:r})):void 0,tool_choice:rZ(e==null?void 0:e.tool_choice),response_format:this.createResponseFormat(e==null?void 0:e.response_format),seed:e==null?void 0:e.seed,...n,parallel_tool_calls:e==null?void 0:e.parallel_tool_calls,...this.audio||e!=null&&e.audio?{audio:this.audio||(e==null?void 0:e.audio)}:{},...this.modalities||e!=null&&e.modalities?{modalities:this.modalities||(e==null?void 0:e.modalities)}:{},...this.modelKwargs};(e==null?void 0:e.prediction)!==void 0&&(i.prediction=e.prediction);const o=(e==null?void 0:e.reasoning_effort)??this.reasoningEffort;return o!==void 0&&(i.reasoning_effort=o),i}_identifyingParams(){return{model_name:this.model,...this.invocationParams(),...this.clientConfig}}async*_streamResponseChunks(e,t,r){var l,c,f,p,h,y,d,_,m,b;const n=C1(e,this.model),i={...this.invocationParams(t,{streaming:!0}),messages:n,stream:!0};let o;const s=await this.completionWithRetry(i,t);let u;for await(const g of s){const v=(l=g==null?void 0:g.choices)==null?void 0:l[0];if(g.usage&&(u=g.usage),!v)continue;const{delta:w}=v;if(!w)continue;const S=uZ(w,g,o,this.__includeRawResponse);o=w.role??o;const R={prompt:t.promptIndex??0,completion:v.index??0};if(typeof S.content!="string"){console.log("[WARNING]: Received non-string content from OpenAI. This is currently not supported.");continue}const P={...R};v.finish_reason!=null&&(P.finish_reason=v.finish_reason,P.system_fingerprint=g.system_fingerprint,P.model_name=g.model),this.logprobs&&(P.logprobs=v.logprobs);const C=new rr({message:S,text:S.content,generationInfo:P});yield C,await(r==null?void 0:r.handleLLMNewToken(C.text??"",R,void 0,void 0,void 0,{chunk:C}))}if(u){const g={...((c=u.prompt_tokens_details)==null?void 0:c.audio_tokens)!==null&&{audio:(f=u.prompt_tokens_details)==null?void 0:f.audio_tokens},...((p=u.prompt_tokens_details)==null?void 0:p.cached_tokens)!==null&&{cache_read:(h=u.prompt_tokens_details)==null?void 0:h.cached_tokens}},v={...((y=u.completion_tokens_details)==null?void 0:y.audio_tokens)!==null&&{audio:(d=u.completion_tokens_details)==null?void 0:d.audio_tokens},...((_=u.completion_tokens_details)==null?void 0:_.reasoning_tokens)!==null&&{reasoning:(m=u.completion_tokens_details)==null?void 0:m.reasoning_tokens}};yield new rr({message:new it({content:"",response_metadata:{usage:{...u}},usage_metadata:{input_tokens:u.prompt_tokens,output_tokens:u.completion_tokens,total_tokens:u.total_tokens,...Object.keys(g).length>0&&{input_token_details:g},...Object.keys(v).length>0&&{output_token_details:v}}}),text:""})}if((b=t.signal)!=null&&b.aborted)throw new Error("AbortError")}identifyingParams(){return this._identifyingParams()}async _generate(e,t,r){var s,u;const n={},i=this.invocationParams(t),o=C1(e,this.model);if(i.stream){const l=this._streamResponseChunks(e,t,r),c={};for await(const _ of l){_.message.response_metadata={..._.generationInfo,..._.message.response_metadata};const m=((s=_.generationInfo)==null?void 0:s.completion)??0;c[m]===void 0?c[m]=_:c[m]=c[m].concat(_)}const f=Object.entries(c).sort(([_],[m])=>parseInt(_,10)-parseInt(m,10)).map(([_,m])=>m),{functions:p,function_call:h}=this.invocationParams(t),y=await this.getEstimatedTokenCountFromPrompt(e,p,h),d=await this.getNumTokensFromGenerations(f);return n.input_tokens=y,n.output_tokens=d,n.total_tokens=y+d,{generations:f,llmOutput:{estimatedTokenUsage:{promptTokens:n.input_tokens,completionTokens:n.output_tokens,totalTokens:n.total_tokens}}}}else{let l;t.response_format&&t.response_format.type==="json_schema"?l=await this.betaParsedCompletionWithRetry({...i,stream:!1,messages:o},{signal:t==null?void 0:t.signal,...t==null?void 0:t.options}):l=await this.completionWithRetry({...i,stream:!1,messages:o},{signal:t==null?void 0:t.signal,...t==null?void 0:t.options});const{completion_tokens:c,prompt_tokens:f,total_tokens:p,prompt_tokens_details:h,completion_tokens_details:y}=(l==null?void 0:l.usage)??{};c&&(n.output_tokens=(n.output_tokens??0)+c),f&&(n.input_tokens=(n.input_tokens??0)+f),p&&(n.total_tokens=(n.total_tokens??0)+p),((h==null?void 0:h.audio_tokens)!==null||(h==null?void 0:h.cached_tokens)!==null)&&(n.input_token_details={...(h==null?void 0:h.audio_tokens)!==null&&{audio:h==null?void 0:h.audio_tokens},...(h==null?void 0:h.cached_tokens)!==null&&{cache_read:h==null?void 0:h.cached_tokens}}),((y==null?void 0:y.audio_tokens)!==null||(y==null?void 0:y.reasoning_tokens)!==null)&&(n.output_token_details={...(y==null?void 0:y.audio_tokens)!==null&&{audio:y==null?void 0:y.audio_tokens},...(y==null?void 0:y.reasoning_tokens)!==null&&{reasoning:y==null?void 0:y.reasoning_tokens}});const d=[];for(const _ of(l==null?void 0:l.choices)??[]){const b={text:((u=_.message)==null?void 0:u.content)??"",message:sZ(_.message??{role:"assistant"},l,this.__includeRawResponse)};b.generationInfo={..._.finish_reason?{finish_reason:_.finish_reason}:{},..._.logprobs?{logprobs:_.logprobs}:{}},ru(b.message)&&(b.message.usage_metadata=n),b.message=new Hs(Object.fromEntries(Object.entries(b.message).filter(([g])=>!g.startsWith("lc_")))),d.push(b)}return{generations:d,llmOutput:{tokenUsage:{promptTokens:n.input_tokens,completionTokens:n.output_tokens,totalTokens:n.total_tokens}}}}}async getEstimatedTokenCountFromPrompt(e,t,r){let n=(await this.getNumTokensFromMessages(e)).totalCount;if(t&&r!=="auto"){const i=iZ(t);n+=await this.getNumTokens(i),n+=9}return t&&e.find(i=>i._getType()==="system")&&(n-=4),r==="none"?n+=1:typeof r=="object"&&(n+=await this.getNumTokens(r.name)+4),n}async getNumTokensFromGenerations(e){return(await Promise.all(e.map(async r=>{var n;return(n=r.message.additional_kwargs)!=null&&n.function_call?(await this.getNumTokensFromMessages([r.message])).countPerMessage[0]:await this.getNumTokens(r.message.content)}))).reduce((r,n)=>r+n,0)}async getNumTokensFromMessages(e){let t=0,r=0,n=0;this.model==="gpt-3.5-turbo-0301"?(r=4,n=-1):(r=3,n=1);const i=await Promise.all(e.map(async o=>{var p,h,y,d,_,m;const s=await this.getNumTokens(o.content),u=await this.getNumTokens(q3(o)),l=o.name!==void 0?n+await this.getNumTokens(o.name):0;let c=s+r+u+l;const f=o;if(f._getType()==="function"&&(c-=2),(p=f.additional_kwargs)!=null&&p.function_call&&(c+=3),(h=f==null?void 0:f.additional_kwargs.function_call)!=null&&h.name&&(c+=await this.getNumTokens((y=f.additional_kwargs.function_call)==null?void 0:y.name)),(d=f.additional_kwargs.function_call)!=null&&d.arguments)try{c+=await this.getNumTokens(JSON.stringify(JSON.parse((_=f.additional_kwargs.function_call)==null?void 0:_.arguments)))}catch(b){console.error("Error parsing function arguments",b,JSON.stringify(f.additional_kwargs.function_call)),c+=await this.getNumTokens((m=f.additional_kwargs.function_call)==null?void 0:m.arguments)}return t+=c,c}));return t+=3,{totalCount:t,countPerMessage:i}}async completionWithRetry(e,t){const r=this._getClientOptions(t);return this.caller.call(async()=>{try{return await this.client.chat.completions.create(e,r)}catch(n){throw ky(n)}})}async betaParsedCompletionWithRetry(e,t){const r=this._getClientOptions(t);return this.caller.call(async()=>{try{return await this.client.beta.chat.completions.parse(e,r)}catch(n){throw ky(n)}})}_getClientOptions(e){if(!this.client){const r={azureOpenAIApiDeploymentName:this.azureOpenAIApiDeploymentName,azureOpenAIApiInstanceName:this.azureOpenAIApiInstanceName,azureOpenAIApiKey:this.azureOpenAIApiKey,azureOpenAIBasePath:this.azureOpenAIBasePath,baseURL:this.clientConfig.baseURL,azureOpenAIEndpoint:this.azureOpenAIEndpoint},n=Rb(r),i={...this.clientConfig,baseURL:n,timeout:this.timeout,maxRetries:0};i.baseURL||delete i.baseURL,this.client=new $e(i)}const t={...this.clientConfig,...e};return this.azureOpenAIApiKey&&(t.headers={"api-key":this.azureOpenAIApiKey,...t.headers},t.query={"api-version":this.azureOpenAIApiVersion,...t.query}),t}_llmType(){return"openai"}_combineLLMOutput(...e){return e.reduce((t,r)=>(r&&r.tokenUsage&&(t.tokenUsage.completionTokens+=r.tokenUsage.completionTokens??0,t.tokenUsage.promptTokens+=r.tokenUsage.promptTokens??0,t.tokenUsage.totalTokens+=r.tokenUsage.totalTokens??0),t),{tokenUsage:{completionTokens:0,promptTokens:0,totalTokens:0}})}withStructuredOutput(e,t){let r,n,i,o;lZ(e)?(r=e.schema,n=e.name,i=e.method,o=e.includeRaw):(r=e,n=t==null?void 0:t.name,i=t==null?void 0:t.method,o=t==null?void 0:t.includeRaw);let s,u;if((t==null?void 0:t.strict)!==void 0&&i==="jsonMode")throw new Error("Argument `strict` is only supported for `method` = 'function_calling'");if(i==="jsonMode")s=this.bind({response_format:{type:"json_object"}}),T_(r)?u=HE.fromZodSchema(r):u=new WE;else if(i==="jsonSchema")s=this.bind({response_format:{type:"json_schema",json_schema:{name:n??"extract",description:r.description,schema:r,strict:t==null?void 0:t.strict}}}),T_(r)?u=HE.fromZodSchema(r):u=new WE;else{let p=n??"extract";if(T_(r)){const h=au(r);s=this.bind({tools:[{type:"function",function:{name:p,description:h.description,parameters:h}}],tool_choice:{type:"function",function:{name:p}},...(t==null?void 0:t.strict)!==void 0?{strict:t.strict}:{}}),u=new Vy({returnSingle:!0,keyName:p,zodSchema:r})}else{let h;typeof r.name=="string"&&typeof r.parameters=="object"&&r.parameters!=null?(h=r,p=r.name):(p=r.title??p,h={name:p,description:r.description??"",parameters:r}),s=this.bind({tools:[{type:"function",function:h}],tool_choice:{type:"function",function:{name:p}},...(t==null?void 0:t.strict)!==void 0?{strict:t.strict}:{}}),u=new Vy({returnSingle:!0,keyName:p})}}if(!o)return s.pipe(u);const l=ou.assign({parsed:(p,h)=>u.invoke(p.raw,h)}),c=ou.assign({parsed:()=>null}),f=l.withFallbacks({fallbacks:[c]});return mr.from([{raw:s},f])}}function T_(a){return typeof(a==null?void 0:a.parse)=="function"}function lZ(a){return a!==void 0&&typeof a.schema=="object"}class cZ extends pC{_llmType(){return"azure_openai"}get lc_aliases(){return{openAIApiKey:"openai_api_key",openAIApiVersion:"openai_api_version",openAIBasePath:"openai_api_base",deploymentName:"deployment_name",azureOpenAIEndpoint:"azure_endpoint",azureOpenAIApiVersion:"openai_api_version",azureOpenAIBasePath:"openai_api_base",azureOpenAIApiDeploymentName:"deployment_name"}}constructor(e){const t=e&&{...e};t&&(t.azureOpenAIApiDeploymentName=t.azureOpenAIApiDeploymentName??t.deploymentName,t.azureOpenAIApiKey=t.azureOpenAIApiKey??t.openAIApiKey,t.azureOpenAIApiVersion=t.azureOpenAIApiVersion??t.openAIApiVersion),super(t)}getLsParams(e){const t=super.getLsParams(e);return t.ls_provider="azure",t}_getClientOptions(e){var r;if(!this.client){const n={azureOpenAIApiDeploymentName:this.azureOpenAIApiDeploymentName,azureOpenAIApiInstanceName:this.azureOpenAIApiInstanceName,azureOpenAIApiKey:this.azureOpenAIApiKey,azureOpenAIBasePath:this.azureOpenAIBasePath,azureADTokenProvider:this.azureADTokenProvider,baseURL:this.clientConfig.baseURL,azureOpenAIEndpoint:this.azureOpenAIEndpoint},i=Rb(n),o={...this.clientConfig,baseURL:i,timeout:this.timeout,maxRetries:0};this.azureADTokenProvider||(o.apiKey=n.azureOpenAIApiKey),o.baseURL||delete o.baseURL,o.defaultHeaders={...o.defaultHeaders,"User-Agent":(r=o.defaultHeaders)!=null&&r["User-Agent"]?`${o.defaultHeaders["User-Agent"]}: langchainjs-azure-openai-v2`:"langchainjs-azure-openai-v2"},this.client=new E3({apiVersion:this.azureOpenAIApiVersion,azureADTokenProvider:this.azureADTokenProvider,deployment:this.azureOpenAIApiDeploymentName,...o})}const t={...this.clientConfig,...e};return this.azureOpenAIApiKey&&(t.headers={"api-key":this.azureOpenAIApiKey,...t.headers},t.query={"api-version":this.azureOpenAIApiVersion,...t.query}),t}toJSON(){const e=super.toJSON();function t(r){return typeof r=="object"&&r!=null}if(t(e)&&t(e.kwargs)){if(delete e.kwargs.azure_openai_base_path,delete e.kwargs.azure_openai_api_deployment_name,delete e.kwargs.azure_openai_api_key,delete e.kwargs.azure_openai_api_version,delete e.kwargs.azure_open_ai_base_path,!e.kwargs.azure_endpoint&&this.azureOpenAIEndpoint&&(e.kwargs.azure_endpoint=this.azureOpenAIEndpoint),!e.kwargs.azure_endpoint&&this.azureOpenAIBasePath){const r=this.azureOpenAIBasePath.split("/openai/deployments/");if(r.length===2&&r[0].startsWith("http")){const[n]=r;e.kwargs.azure_endpoint=n}}if(!e.kwargs.azure_endpoint&&this.azureOpenAIApiInstanceName&&(e.kwargs.azure_endpoint=`https://${this.azureOpenAIApiInstanceName}.openai.azure.com/`),!e.kwargs.deployment_name&&this.azureOpenAIApiDeploymentName&&(e.kwargs.deployment_name=this.azureOpenAIApiDeploymentName),!e.kwargs.deployment_name&&this.azureOpenAIBasePath){const r=this.azureOpenAIBasePath.split("/openai/deployments/");if(r.length===2){const[,n]=r;e.kwargs.deployment_name=n}}e.kwargs.azure_endpoint&&e.kwargs.deployment_name&&e.kwargs.openai_api_base&&delete e.kwargs.openai_api_base,e.kwargs.azure_openai_api_instance_name&&e.kwargs.azure_endpoint&&delete e.kwargs.azure_openai_api_instance_name}return e}}class of extends R3{constructor({concurrency:e,...t}){super(e?{maxConcurrency:e,...t}:t),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","llms",this._llmType()]})}async invoke(e,t){const r=of._convertInputToPromptValue(e);return(await this.generatePrompt([r],t,t==null?void 0:t.callbacks)).generations[0][0].text}async*_streamResponseChunks(e,t,r){throw new Error("Not implemented.")}_separateRunnableConfigFromCallOptionsCompat(e){const[t,r]=super._separateRunnableConfigFromCallOptions(e);return r.signal=t.signal,[t,r]}async*_streamIterator(e,t){if(this._streamResponseChunks===of.prototype._streamResponseChunks)yield this.invoke(e,t);else{const r=of._convertInputToPromptValue(e),[n,i]=this._separateRunnableConfigFromCallOptionsCompat(t),o=await Ot.configure(n.callbacks,this.callbacks,n.tags,this.tags,n.metadata,this.metadata,{verbose:this.verbose}),s={options:i,invocation_params:this==null?void 0:this.invocationParams(i),batch_size:1},u=await(o==null?void 0:o.handleLLMStart(this.toJSON(),[r.toString()],n.runId,void 0,s,void 0,void 0,n.runName));let l=new Ru({text:""});try{for await(const c of this._streamResponseChunks(r.toString(),i,u==null?void 0:u[0]))l?l=l.concat(c):l=c,typeof c.text=="string"&&(yield c.text)}catch(c){throw await Promise.all((u??[]).map(f=>f==null?void 0:f.handleLLMError(c))),c}await Promise.all((u??[]).map(c=>c==null?void 0:c.handleLLMEnd({generations:[[l]]})))}}async generatePrompt(e,t,r){const n=e.map(i=>i.toString());return this.generate(n,t,r)}invocationParams(e){return{}}_flattenLLMResult(e){const t=[];for(let r=0;r<e.generations.length;r+=1){const n=e.generations[r];if(r===0)t.push({generations:[n],llmOutput:e.llmOutput});else{const i=e.llmOutput?{...e.llmOutput,tokenUsage:{}}:void 0;t.push({generations:[n],llmOutput:i})}}return t}async _generateUncached(e,t,r,n){let i;if(n!==void 0&&n.length===e.length)i=n;else{const l=await Ot.configure(r.callbacks,this.callbacks,r.tags,this.tags,r.metadata,this.metadata,{verbose:this.verbose}),c={options:t,invocation_params:this==null?void 0:this.invocationParams(t),batch_size:e.length};i=await(l==null?void 0:l.handleLLMStart(this.toJSON(),e,r.runId,void 0,c,void 0,void 0,r==null?void 0:r.runName))}const o=!!(i!=null&&i[0].handlers.find(S4));let s;if(o&&e.length===1&&this._streamResponseChunks!==of.prototype._streamResponseChunks)try{const l=await this._streamResponseChunks(e[0],t,i==null?void 0:i[0]);let c;for await(const f of l)c===void 0?c=f:c=Dr(c,f);if(c===void 0)throw new Error("Received empty response from chat model call.");s={generations:[[c]],llmOutput:{}},await(i==null?void 0:i[0].handleLLMEnd(s))}catch(l){throw await(i==null?void 0:i[0].handleLLMError(l)),l}else{try{s=await this._generate(e,t,i==null?void 0:i[0])}catch(c){throw await Promise.all((i??[]).map(f=>f==null?void 0:f.handleLLMError(c))),c}const l=this._flattenLLMResult(s);await Promise.all((i??[]).map((c,f)=>c==null?void 0:c.handleLLMEnd(l[f])))}const u=(i==null?void 0:i.map(l=>l.runId))||void 0;return Object.defineProperty(s,xy,{value:u?{runIds:u}:void 0,configurable:!0}),s}async _generateCached({prompts:e,cache:t,llmStringKey:r,parsedOptions:n,handledOptions:i,runId:o}){const s=await Ot.configure(i.callbacks,this.callbacks,i.tags,this.tags,i.metadata,this.metadata,{verbose:this.verbose}),u={options:n,invocation_params:this==null?void 0:this.invocationParams(n),batch_size:e.length},l=await(s==null?void 0:s.handleLLMStart(this.toJSON(),e,o,void 0,u,void 0,void 0,i==null?void 0:i.runName)),c=[],p=(await Promise.allSettled(e.map(async(d,_)=>{const m=await t.lookup(d,r);return m==null&&c.push(_),m}))).map((d,_)=>({result:d,runManager:l==null?void 0:l[_]})).filter(({result:d})=>d.status==="fulfilled"&&d.value!=null||d.status==="rejected"),h=[];await Promise.all(p.map(async({result:d,runManager:_},m)=>{if(d.status==="fulfilled"){const b=d.value;return h[m]=b.map(g=>(g.generationInfo={...g.generationInfo,tokenUsage:{}},g)),b.length&&await(_==null?void 0:_.handleLLMNewToken(b[0].text)),_==null?void 0:_.handleLLMEnd({generations:[b]},void 0,void 0,void 0,{cached:!0})}else return await(_==null?void 0:_.handleLLMError(d.reason,void 0,void 0,void 0,{cached:!0})),Promise.reject(d.reason)}));const y={generations:h,missingPromptIndices:c,startedRunManagers:l};return Object.defineProperty(y,xy,{value:l?{runIds:l==null?void 0:l.map(d=>d.runId)}:void 0,configurable:!0}),y}async generate(e,t,r){if(!Array.isArray(e))throw new Error("Argument 'prompts' is expected to be a string[]");let n;Array.isArray(t)?n={stop:t}:n=t;const[i,o]=this._separateRunnableConfigFromCallOptionsCompat(n);if(i.callbacks=i.callbacks??r,!this.cache)return this._generateUncached(e,o,i);const{cache:s}=this,u=this._getSerializedCacheKeyParametersForCall(o),{generations:l,missingPromptIndices:c,startedRunManagers:f}=await this._generateCached({prompts:e,cache:s,llmStringKey:u,parsedOptions:o,handledOptions:i,runId:i.runId});let p={};if(c.length>0){const h=await this._generateUncached(c.map(y=>e[y]),o,i,f!==void 0?c.map(y=>f==null?void 0:f[y]):void 0);await Promise.all(h.generations.map(async(y,d)=>{const _=c[d];return l[_]=y,s.update(e[_],u,y)})),p=h.llmOutput??{}}return{generations:l,llmOutput:p}}async call(e,t,r){const{generations:n}=await this.generate([e],t,r);return n[0][0].text}async predict(e,t,r){return this.call(e,t,r)}async predictMessages(e,t,r){const n=mR(e),i=await this.call(n,t,r);return new Hs(i)}_identifyingParams(){return{}}serialize(){return{...this._identifyingParams(),_type:this._llmType(),_model:this._modelType()}}_modelType(){return"base_llm"}}class z3 extends of{async _generate(e,t,r){return{generations:await Promise.all(e.map((i,o)=>this._call(i,{...t,promptIndex:o},r).then(s=>[{text:s}])))}}}const _C=(a,e)=>a.reduce((t,r,n)=>{const i=Math.floor(n/e),o=t[i]||[];return t[i]=o.concat([r]),t},[]);let B3=class{constructor(e){Object.defineProperty(this,"caller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.caller=new Vp(e??{})}};class JE extends B3{constructor(e,t){var l,c,f;const r={maxConcurrency:2,...e};super(r),Object.defineProperty(this,"modelName",{enumerable:!0,configurable:!0,writable:!0,value:"text-embedding-ada-002"}),Object.defineProperty(this,"model",{enumerable:!0,configurable:!0,writable:!0,value:"text-embedding-ada-002"}),Object.defineProperty(this,"batchSize",{enumerable:!0,configurable:!0,writable:!0,value:512}),Object.defineProperty(this,"stripNewLines",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"dimensions",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiVersion",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureADTokenProvider",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiInstanceName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiDeploymentName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIBasePath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"organization",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"clientConfig",{enumerable:!0,configurable:!0,writable:!0,value:void 0});let n=(r==null?void 0:r.apiKey)??(r==null?void 0:r.openAIApiKey)??We("OPENAI_API_KEY");const i=(r==null?void 0:r.azureOpenAIApiKey)??We("AZURE_OPENAI_API_KEY");if(this.azureADTokenProvider=(e==null?void 0:e.azureADTokenProvider)??void 0,!i&&!n&&!this.azureADTokenProvider)throw new Error("OpenAI or Azure OpenAI API key or Token Provider not found");const o=(r==null?void 0:r.azureOpenAIApiInstanceName)??We("AZURE_OPENAI_API_INSTANCE_NAME"),s=((r==null?void 0:r.azureOpenAIApiEmbeddingsDeploymentName)||(r==null?void 0:r.azureOpenAIApiDeploymentName))??(We("AZURE_OPENAI_API_EMBEDDINGS_DEPLOYMENT_NAME")||We("AZURE_OPENAI_API_DEPLOYMENT_NAME")),u=(r==null?void 0:r.azureOpenAIApiVersion)??We("AZURE_OPENAI_API_VERSION");if(this.azureOpenAIBasePath=(r==null?void 0:r.azureOpenAIBasePath)??We("AZURE_OPENAI_BASE_PATH"),this.organization=((l=r==null?void 0:r.configuration)==null?void 0:l.organization)??We("OPENAI_ORGANIZATION"),this.modelName=(r==null?void 0:r.model)??(r==null?void 0:r.modelName)??this.model,this.model=this.modelName,this.batchSize=(r==null?void 0:r.batchSize)??(i?1:this.batchSize),this.stripNewLines=(r==null?void 0:r.stripNewLines)??this.stripNewLines,this.timeout=r==null?void 0:r.timeout,this.dimensions=r==null?void 0:r.dimensions,this.azureOpenAIApiVersion=u,this.azureOpenAIApiKey=i,this.azureOpenAIApiInstanceName=o,this.azureOpenAIApiDeploymentName=s,this.azureOpenAIApiKey||this.azureADTokenProvider){if(!this.azureOpenAIApiInstanceName&&!this.azureOpenAIBasePath)throw new Error("Azure OpenAI API instance name not found");if(!this.azureOpenAIApiDeploymentName)throw new Error("Azure OpenAI API deployment name not found");if(!this.azureOpenAIApiVersion)throw new Error("Azure OpenAI API version not found");n=n??""}this.clientConfig={apiKey:n,organization:this.organization,baseURL:t==null?void 0:t.basePath,dangerouslyAllowBrowser:!0,defaultHeaders:(c=t==null?void 0:t.baseOptions)==null?void 0:c.headers,defaultQuery:(f=t==null?void 0:t.baseOptions)==null?void 0:f.params,...t,...e==null?void 0:e.configuration}}async embedDocuments(e){const t=_C(this.stripNewLines?e.map(o=>o.replace(/\n/g," ")):e,this.batchSize),r=t.map(o=>{const s={model:this.model,input:o};return this.dimensions&&(s.dimensions=this.dimensions),this.embeddingWithRetry(s)}),n=await Promise.all(r),i=[];for(let o=0;o<n.length;o+=1){const s=t[o],{data:u}=n[o];for(let l=0;l<s.length;l+=1)i.push(u[l].embedding)}return i}async embedQuery(e){const t={model:this.model,input:this.stripNewLines?e.replace(/\n/g," "):e};this.dimensions&&(t.dimensions=this.dimensions);const{data:r}=await this.embeddingWithRetry(t);return r[0].embedding}async embeddingWithRetry(e){if(!this.client){const r={azureOpenAIApiDeploymentName:this.azureOpenAIApiDeploymentName,azureOpenAIApiInstanceName:this.azureOpenAIApiInstanceName,azureOpenAIApiKey:this.azureOpenAIApiKey,azureOpenAIBasePath:this.azureOpenAIBasePath,baseURL:this.clientConfig.baseURL},n=Rb(r),i={...this.clientConfig,baseURL:n,timeout:this.timeout,maxRetries:0};i.baseURL||delete i.baseURL,this.client=new $e(i)}const t={};return this.azureOpenAIApiKey&&(t.headers={"api-key":this.azureOpenAIApiKey,...t.headers},t.query={"api-version":this.azureOpenAIApiVersion,...t.query}),this.caller.call(async()=>{try{return await this.client.embeddings.create(e,t)}catch(r){throw ky(r)}})}}class fZ extends JE{constructor(e,t){const r={...e};Object.entries(r).length&&(r.azureOpenAIApiDeploymentName=r.azureOpenAIApiDeploymentName??r.deploymentName,r.azureOpenAIApiKey=r.azureOpenAIApiKey??r.apiKey,r.azureOpenAIApiVersion=r.azureOpenAIApiVersion??r.openAIApiVersion),super(r,t)}async embeddingWithRetry(e){var r;if(!this.client){const n={azureOpenAIApiDeploymentName:this.azureOpenAIApiDeploymentName,azureOpenAIApiInstanceName:this.azureOpenAIApiInstanceName,azureOpenAIApiKey:this.azureOpenAIApiKey,azureOpenAIBasePath:this.azureOpenAIBasePath,azureADTokenProvider:this.azureADTokenProvider,baseURL:this.clientConfig.baseURL},i=Rb(n),o={...this.clientConfig,baseURL:i,timeout:this.timeout,maxRetries:0};this.azureADTokenProvider||(o.apiKey=n.azureOpenAIApiKey),o.baseURL||delete o.baseURL,o.defaultHeaders={...o.defaultHeaders,"User-Agent":(r=o.defaultHeaders)!=null&&r["User-Agent"]?`${o.defaultHeaders["User-Agent"]}: langchainjs-azure-openai-v2`:"langchainjs-azure-openai-v2"},this.client=new E3({apiVersion:this.azureOpenAIApiVersion,azureADTokenProvider:this.azureADTokenProvider,deployment:this.azureOpenAIApiDeploymentName,...o})}const t={};return this.azureOpenAIApiKey&&(t.headers={"api-key":this.azureOpenAIApiKey,...t.headers},t.query={"api-version":this.azureOpenAIApiVersion,...t.query}),this.caller.call(async()=>{try{return await this.client.embeddings.create(e,t)}catch(n){throw ky(n)}})}}const Zc="0.37.0";let j1=!1,ap,U3,XE,F3,L3,V3;function dZ(a,e={auto:!1}){if(j1)throw new Error(`you must \`import '@anthropic-ai/sdk/shims/${a.kind}'\` before importing anything else from @anthropic-ai/sdk`);if(ap)throw new Error(`can't \`import '@anthropic-ai/sdk/shims/${a.kind}'\` after \`import '@anthropic-ai/sdk/shims/${ap}'\``);j1=e.auto,ap=a.kind,U3=a.fetch,XE=a.File,F3=a.ReadableStream,L3=a.getDefaultAgent,V3=a.fileFromPath}let hZ=class{constructor(e){this.body=e}get[Symbol.toStringTag](){return"MultipartBody"}};function pZ({manuallyImported:a}={}){const e=a?"You may need to use polyfills":"Add one of these imports before your first `import  from '@anthropic-ai/sdk'`:\n- `import '@anthropic-ai/sdk/shims/node'` (if you're running on Node)\n- `import '@anthropic-ai/sdk/shims/web'` (otherwise)\n";let t,r,n,i;try{t=fetch,r=Request,n=Response,i=Headers}catch(o){throw new Error(`this environment is missing the following Web Fetch API type: ${o.message}. ${e}`)}return{kind:"web",fetch:t,Request:r,Response:n,Headers:i,FormData:typeof FormData<"u"?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${e}`)}},Blob:typeof Blob<"u"?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${e}`)}},File:typeof File<"u"?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${e}`)}},ReadableStream:typeof ReadableStream<"u"?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${e}`)}},getMultipartRequestOptions:async(o,s)=>({...s,body:new hZ(o)}),getDefaultAgent:o=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/anthropics/anthropic-sdk-typescript#file-uploads")},isFsReadStream:o=>!1}}ap||dZ(pZ(),{auto:!0});class Le extends Error{}let Or=class ZE extends Le{constructor(e,t,r,n){super(`${ZE.makeMessage(e,t,r)}`),this.status=e,this.headers=n,this.request_id=n==null?void 0:n["request-id"],this.error=t}static makeMessage(e,t,r){const n=t!=null&&t.message?typeof t.message=="string"?t.message:JSON.stringify(t.message):t?JSON.stringify(t):r;return e&&n?`${e} ${n}`:e?`${e} status code (no body)`:n||"(no status code or body)"}static generate(e,t,r,n){if(!e||!n)return new Cb({message:r,cause:QE(t)});const i=t;return e===400?new k3(e,i,r,n):e===401?new H3(e,i,r,n):e===403?new W3(e,i,r,n):e===404?new K3(e,i,r,n):e===409?new J3(e,i,r,n):e===422?new X3(e,i,r,n):e===429?new Z3(e,i,r,n):e>=500?new Q3(e,i,r,n):new ZE(e,i,r,n)}},Fs=class extends Or{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}},Cb=class extends Or{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),t&&(this.cause=t)}},G3=class extends Cb{constructor({message:e}={}){super({message:e??"Request timed out."})}},k3=class extends Or{},H3=class extends Or{},W3=class extends Or{},K3=class extends Or{},J3=class extends Or{},X3=class extends Or{},Z3=class extends Or{},Q3=class extends Or{};var M_=function(a,e,t,r,n){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?a!==e||!n:!e.has(a))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?n.call(a,t):n?n.value=t:e.set(a,t),t},hl=function(a,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?a!==e||!r:!e.has(a))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(a):r?r.value:e.get(a)},_r;let Qp=class{constructor(){_r.set(this,void 0),this.buffer=new Uint8Array,M_(this,_r,null,"f")}decode(e){if(e==null)return[];const t=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?new TextEncoder().encode(e):e;let r=new Uint8Array(this.buffer.length+t.length);r.set(this.buffer),r.set(t,this.buffer.length),this.buffer=r;const n=[];let i;for(;(i=_Z(this.buffer,hl(this,_r,"f")))!=null;){if(i.carriage&&hl(this,_r,"f")==null){M_(this,_r,i.index,"f");continue}if(hl(this,_r,"f")!=null&&(i.index!==hl(this,_r,"f")+1||i.carriage)){n.push(this.decodeText(this.buffer.slice(0,hl(this,_r,"f")-1))),this.buffer=this.buffer.slice(hl(this,_r,"f")),M_(this,_r,null,"f");continue}const o=hl(this,_r,"f")!==null?i.preceding-1:i.preceding,s=this.decodeText(this.buffer.slice(0,o));n.push(s),this.buffer=this.buffer.slice(i.index),M_(this,_r,null,"f")}return n}decodeText(e){if(e==null)return"";if(typeof e=="string")return e;if(typeof Buffer<"u"){if(e instanceof Buffer)return e.toString();if(e instanceof Uint8Array)return Buffer.from(e).toString();throw new Le(`Unexpected: received non-Uint8Array (${e.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if(typeof TextDecoder<"u"){if(e instanceof Uint8Array||e instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(e);throw new Le(`Unexpected: received non-Uint8Array/ArrayBuffer (${e.constructor.name}) in a web platform. Please report this error.`)}throw new Le("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){return this.buffer.length?this.decode(`
`):[]}};_r=new WeakMap;Qp.NEWLINE_CHARS=new Set([`
`,"\r"]);Qp.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function _Z(a,e){for(let n=e??0;n<a.length;n++){if(a[n]===10)return{preceding:n,index:n+1,carriage:!1};if(a[n]===13)return{preceding:n,index:n+1,carriage:!0}}return null}function yZ(a){for(let r=0;r<a.length-1;r++){if(a[r]===10&&a[r+1]===10||a[r]===13&&a[r+1]===13)return r+2;if(a[r]===13&&a[r+1]===10&&r+3<a.length&&a[r+2]===13&&a[r+3]===10)return r+4}return-1}function yC(a){if(a[Symbol.asyncIterator])return a;const e=a.getReader();return{async next(){try{const t=await e.read();return t!=null&&t.done&&e.releaseLock(),t}catch(t){throw e.releaseLock(),t}},async return(){const t=e.cancel();return e.releaseLock(),await t,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}let Mp=class Jh{constructor(e,t){this.iterator=e,this.controller=t}static fromSSEResponse(e,t){let r=!1;async function*n(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let i=!1;try{for await(const o of bZ(e,t)){if(o.event==="completion")try{yield JSON.parse(o.data)}catch(s){throw console.error("Could not parse message into JSON:",o.data),console.error("From chunk:",o.raw),s}if(o.event==="message_start"||o.event==="message_delta"||o.event==="message_stop"||o.event==="content_block_start"||o.event==="content_block_delta"||o.event==="content_block_stop")try{yield JSON.parse(o.data)}catch(s){throw console.error("Could not parse message into JSON:",o.data),console.error("From chunk:",o.raw),s}if(o.event!=="ping"&&o.event==="error")throw Or.generate(void 0,`SSE Error: ${o.data}`,o.data,n8(e.headers))}i=!0}catch(o){if(o instanceof Error&&o.name==="AbortError")return;throw o}finally{i||t.abort()}}return new Jh(n,t)}static fromReadableStream(e,t){let r=!1;async function*n(){const o=new Qp,s=yC(e);for await(const u of s)for(const l of o.decode(u))yield l;for(const u of o.flush())yield u}async function*i(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let o=!1;try{for await(const s of n())o||s&&(yield JSON.parse(s));o=!0}catch(s){if(s instanceof Error&&s.name==="AbortError")return;throw s}finally{o||t.abort()}}return new Jh(i,t)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],t=[],r=this.iterator(),n=i=>({next:()=>{if(i.length===0){const o=r.next();e.push(o),t.push(o)}return i.shift()}});return[new Jh(()=>n(e),this.controller),new Jh(()=>n(t),this.controller)]}toReadableStream(){const e=this;let t;const r=new TextEncoder;return new F3({async start(){t=e[Symbol.asyncIterator]()},async pull(n){try{const{value:i,done:o}=await t.next();if(o)return n.close();const s=r.encode(JSON.stringify(i)+`
`);n.enqueue(s)}catch(i){n.error(i)}},async cancel(){var n;await((n=t.return)==null?void 0:n.call(t))}})}};async function*bZ(a,e){if(!a.body)throw e.abort(),new Le("Attempted to iterate over a response with no body");const t=new gZ,r=new Qp,n=yC(a.body);for await(const i of mZ(n))for(const o of r.decode(i)){const s=t.decode(o);s&&(yield s)}for(const i of r.flush()){const o=t.decode(i);o&&(yield o)}}async function*mZ(a){let e=new Uint8Array;for await(const t of a){if(t==null)continue;const r=t instanceof ArrayBuffer?new Uint8Array(t):typeof t=="string"?new TextEncoder().encode(t):t;let n=new Uint8Array(e.length+r.length);n.set(e),n.set(r,e.length),e=n;let i;for(;(i=yZ(e))!==-1;)yield e.slice(0,i),e=e.slice(i)}e.length>0&&(yield e)}let gZ=class{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const i={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],i}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,r,n]=vZ(e,":");return n.startsWith(" ")&&(n=n.substring(1)),t==="event"?this.event=n:t==="data"&&this.data.push(n),null}};function vZ(a,e){const t=a.indexOf(e);return t!==-1?[a.substring(0,t),e,a.substring(t+e.length)]:[a,"",""]}const wZ=a=>a!=null&&typeof a=="object"&&typeof a.url=="string"&&typeof a.blob=="function",OZ=a=>a!=null&&typeof a=="object"&&typeof a.name=="string"&&typeof a.lastModified=="number"&&Pb(a),Pb=a=>a!=null&&typeof a=="object"&&typeof a.size=="number"&&typeof a.type=="string"&&typeof a.text=="function"&&typeof a.slice=="function"&&typeof a.arrayBuffer=="function";async function SZ(a,e,t){var n;if(a=await a,OZ(a))return a;if(wZ(a)){const i=await a.blob();e||(e=new URL(a.url).pathname.split(/[\\/]/).pop()??"unknown_file");const o=Pb(i)?[await i.arrayBuffer()]:[i];return new XE(o,e,t)}const r=await EZ(a);if(e||(e=CZ(a)??"unknown_file"),!(t!=null&&t.type)){const i=(n=r[0])==null?void 0:n.type;typeof i=="string"&&(t={...t,type:i})}return new XE(r,e,t)}async function EZ(a){var t;let e=[];if(typeof a=="string"||ArrayBuffer.isView(a)||a instanceof ArrayBuffer)e.push(a);else if(Pb(a))e.push(await a.arrayBuffer());else if(PZ(a))for await(const r of a)e.push(r);else throw new Error(`Unexpected data type: ${typeof a}; constructor: ${(t=a==null?void 0:a.constructor)==null?void 0:t.name}; props: ${RZ(a)}`);return e}function RZ(a){return`[${Object.getOwnPropertyNames(a).map(t=>`"${t}"`).join(", ")}]`}function CZ(a){var e;return Cg(a.name)||Cg(a.filename)||((e=Cg(a.path))==null?void 0:e.split(/[\\/]/).pop())}const Cg=a=>{if(typeof a=="string")return a;if(typeof Buffer<"u"&&a instanceof Buffer)return String(a)},PZ=a=>a!=null&&typeof a=="object"&&typeof a[Symbol.asyncIterator]=="function",T1=a=>a&&typeof a=="object"&&a.body&&a[Symbol.toStringTag]==="MultipartBody";var _f={},jZ=function(a,e,t,r,n){if(typeof e=="function"?a!==e||!0:!e.has(a))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(a,t),t},TZ=function(a,e,t,r){if(typeof e=="function"?a!==e||!0:!e.has(a))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(a):r?r.value:e.get(a)},A_;async function Y3(a){const{response:e}=a;if(a.options.stream)return yf("response",e.status,e.url,e.headers,e.body),a.options.__streamClass?a.options.__streamClass.fromSSEResponse(e,a.controller):Mp.fromSSEResponse(e,a.controller);if(e.status===204)return null;if(a.options.__binaryResponse)return e;const t=e.headers.get("content-type");if((t==null?void 0:t.includes("application/json"))||(t==null?void 0:t.includes("application/vnd.api+json"))){const i=await e.json();return yf("response",e.status,e.url,e.headers,i),e8(i,e)}const n=await e.text();return yf("response",e.status,e.url,e.headers,n),n}function e8(a,e){return!a||typeof a!="object"||Array.isArray(a)?a:Object.defineProperty(a,"_request_id",{value:e.headers.get("request-id"),enumerable:!1})}let t8=class r8 extends Promise{constructor(e,t=Y3){super(r=>{r(null)}),this.responsePromise=e,this.parseResponse=t}_thenUnwrap(e){return new r8(this.responsePromise,async t=>e8(e(await this.parseResponse(t),t),t.response))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t,request_id:t.headers.get("request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}},MZ=class{constructor({baseURL:e,maxRetries:t=2,timeout:r=6e5,httpAgent:n,fetch:i}){this.baseURL=e,this.maxRetries=Pg("maxRetries",t),this.timeout=Pg("timeout",r),this.httpAgent=n,this.fetch=i??U3}authHeaders(e){return{}}defaultHeaders(e){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...NZ(),...this.authHeaders(e)}}validateHeaders(e,t){}defaultIdempotencyKey(){return`stainless-node-retry-${FZ()}`}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,r){return this.request(Promise.resolve(r).then(async n=>{const i=n&&Pb(n==null?void 0:n.body)?new DataView(await n.body.arrayBuffer()):(n==null?void 0:n.body)instanceof DataView?n.body:(n==null?void 0:n.body)instanceof ArrayBuffer?new DataView(n.body):n&&ArrayBuffer.isView(n==null?void 0:n.body)?new DataView(n.body.buffer):n==null?void 0:n.body;return{method:e,path:t,...n,body:i}}))}getAPIList(e,t,r){return this.requestAPIList(t,{method:"get",path:e,...r})}calculateContentLength(e){if(typeof e=="string"){if(typeof Buffer<"u")return Buffer.byteLength(e,"utf8").toString();if(typeof TextEncoder<"u")return new TextEncoder().encode(e).length.toString()}else if(ArrayBuffer.isView(e))return e.byteLength.toString();return null}buildRequest(e,{retryCount:t=0}={}){var y;e={...e};const{method:r,path:n,query:i,headers:o={}}=e,s=ArrayBuffer.isView(e.body)||e.__binaryRequest&&typeof e.body=="string"?e.body:T1(e.body)?e.body.body:e.body?JSON.stringify(e.body,null,2):null,u=this.calculateContentLength(s),l=this.buildURL(n,i);"timeout"in e&&Pg("timeout",e.timeout),e.timeout=e.timeout??this.timeout;const c=e.httpAgent??this.httpAgent??L3(l),f=e.timeout+1e3;typeof((y=c==null?void 0:c.options)==null?void 0:y.timeout)=="number"&&f>(c.options.timeout??0)&&(c.options.timeout=f),this.idempotencyHeader&&r!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),o[this.idempotencyHeader]=e.idempotencyKey);const p=this.buildHeaders({options:e,headers:o,contentLength:u,retryCount:t});return{req:{method:r,...s&&{body:s},headers:p,...c&&{agent:c},signal:e.signal??null},url:l,timeout:e.timeout}}buildHeaders({options:e,headers:t,contentLength:r,retryCount:n}){const i={};r&&(i["content-length"]=r);const o=this.defaultHeaders(e);return D1(i,o),D1(i,t),T1(e.body)&&ap!=="node"&&delete i["content-type"],I_(o,"x-stainless-retry-count")===void 0&&I_(t,"x-stainless-retry-count")===void 0&&(i["x-stainless-retry-count"]=String(n)),I_(o,"x-stainless-timeout")===void 0&&I_(t,"x-stainless-timeout")===void 0&&e.timeout&&(i["x-stainless-timeout"]=String(e.timeout)),this.validateHeaders(i,t),i}_calculateNonstreamingTimeout(e){if(3600*e/128e3>600)throw new Le("Streaming is strongly recommended for operations that may take longer than 10 minutes. See https://github.com/anthropics/anthropic-sdk-python#streaming-responses for more details");return 600*1e3}async prepareOptions(e){}async prepareRequest(e,{url:t,options:r}){}parseHeaders(e){return e?Symbol.iterator in e?Object.fromEntries(Array.from(e).map(t=>[...t])):{...e}:{}}makeStatusError(e,t,r,n){return Or.generate(e,t,r,n)}request(e,t=null){return new t8(this.makeRequest(e,t))}async makeRequest(e,t){var f,p;const r=await e,n=r.maxRetries??this.maxRetries;t==null&&(t=n),await this.prepareOptions(r);const{req:i,url:o,timeout:s}=this.buildRequest(r,{retryCount:n-t});if(await this.prepareRequest(i,{url:o,options:r}),yf("request",o,r,i.headers),(f=r.signal)!=null&&f.aborted)throw new Fs;const u=new AbortController,l=await this.fetchWithTimeout(o,i,s,u).catch(QE);if(l instanceof Error){if((p=r.signal)!=null&&p.aborted)throw new Fs;if(t)return this.retryRequest(r,t);throw l.name==="AbortError"?new G3:new Cb({cause:l})}const c=n8(l.headers);if(!l.ok){if(t&&this.shouldRetry(l)){const b=`retrying, ${t} attempts remaining`;return yf(`response (error; ${b})`,l.status,o,c),this.retryRequest(r,t,c)}const h=await l.text().catch(b=>QE(b).message),y=qZ(h),d=y?void 0:h;throw yf(`response (error; ${t?"(error; no more retries left)":"(error; not retryable)"})`,l.status,o,c,d),this.makeStatusError(l.status,y,d,c)}return{response:l,options:r,controller:u}}requestAPIList(e,t){const r=this.makeRequest(t,null);return new IZ(this,r,e)}buildURL(e,t){const r=BZ(e)?new URL(e):new URL(this.baseURL+(this.baseURL.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),n=this.defaultQuery();return Wy(n)||(t={...n,...t}),typeof t=="object"&&t&&!Array.isArray(t)&&(r.search=this.stringifyQuery(t)),r.toString()}stringifyQuery(e){return Object.entries(e).filter(([t,r])=>typeof r<"u").map(([t,r])=>{if(typeof r=="string"||typeof r=="number"||typeof r=="boolean")return`${encodeURIComponent(t)}=${encodeURIComponent(r)}`;if(r===null)return`${encodeURIComponent(t)}=`;throw new Le(`Cannot stringify type ${typeof r}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}async fetchWithTimeout(e,t,r,n){const{signal:i,...o}=t||{};i&&i.addEventListener("abort",()=>n.abort());const s=setTimeout(()=>n.abort(),r),u={signal:n.signal,...o};u.method&&(u.method=u.method.toUpperCase());const l=60*1e3,c=setTimeout(()=>{var f,p;if(u&&((f=u==null?void 0:u.agent)!=null&&f.sockets))for(const h of Object.values((p=u==null?void 0:u.agent)==null?void 0:p.sockets).flat())h!=null&&h.setKeepAlive&&h.setKeepAlive(!0,l)},l);return this.fetch.call(void 0,e,u).finally(()=>{clearTimeout(s),clearTimeout(c)})}shouldRetry(e){const t=e.headers.get("x-should-retry");return t==="true"?!0:t==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,t,r){let n;const i=r==null?void 0:r["retry-after-ms"];if(i){const s=parseFloat(i);Number.isNaN(s)||(n=s)}const o=r==null?void 0:r["retry-after"];if(o&&!n){const s=parseFloat(o);Number.isNaN(s)?n=Date.parse(o)-Date.now():n=s*1e3}if(!(n&&0<=n&&n<60*1e3)){const s=e.maxRetries??this.maxRetries;n=this.calculateDefaultRetryTimeoutMillis(t,s)}return await UZ(n),this.makeRequest(e,t-1)}calculateDefaultRetryTimeoutMillis(e,t){const i=t-e,o=Math.min(.5*Math.pow(2,i),8),s=1-Math.random()*.25;return o*s*1e3}getUserAgent(){return`${this.constructor.name}/JS ${Zc}`}};class AZ{constructor(e,t,r,n){A_.set(this,void 0),jZ(this,A_,e),this.options=n,this.response=t,this.body=r}hasNextPage(){return this.getPaginatedItems().length?this.nextPageInfo()!=null:!1}async getNextPage(){const e=this.nextPageInfo();if(!e)throw new Le("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");const t={...this.options};if("params"in e&&typeof t.query=="object")t.query={...t.query,...e.params};else if("url"in e){const r=[...Object.entries(t.query||{}),...e.url.searchParams.entries()];for(const[n,i]of r)e.url.searchParams.set(n,i);t.query=void 0,t.path=e.url.toString()}return await TZ(this,A_,"f").requestAPIList(this.constructor,t)}async*iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async*[(A_=new WeakMap,Symbol.asyncIterator)](){for await(const e of this.iterPages())for(const t of e.getPaginatedItems())yield t}}let IZ=class extends t8{constructor(e,t,r){super(t,async n=>new r(e,n.response,await Y3(n),n.options))}async*[Symbol.asyncIterator](){const e=await this;for await(const t of e)yield t}};const n8=a=>new Proxy(Object.fromEntries(a.entries()),{get(e,t){const r=t.toString();return e[r.toLowerCase()]||e[r]}}),DZ={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0,__binaryRequest:!0,__binaryResponse:!0,__streamClass:!0},Bu=a=>typeof a=="object"&&a!==null&&!Wy(a)&&Object.keys(a).every(e=>i8(DZ,e)),xZ=()=>{var e;if(typeof Deno<"u"&&Deno.build!=null)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Zc,"X-Stainless-OS":A1(Deno.build.os),"X-Stainless-Arch":M1(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:((e=Deno.version)==null?void 0:e.deno)??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Zc,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":process.version};if(Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Zc,"X-Stainless-OS":A1(process.platform),"X-Stainless-Arch":M1(process.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":process.version};const a=$Z();return a?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Zc,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${a.browser}`,"X-Stainless-Runtime-Version":a.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Zc,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function $Z(){if(typeof navigator>"u"||!navigator)return null;const a=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:t}of a){const r=t.exec(navigator.userAgent);if(r){const n=r[1]||0,i=r[2]||0,o=r[3]||0;return{browser:e,version:`${n}.${i}.${o}`}}}return null}const M1=a=>a==="x32"?"x32":a==="x86_64"||a==="x64"?"x64":a==="arm"?"arm":a==="aarch64"||a==="arm64"?"arm64":a?`other:${a}`:"unknown",A1=a=>(a=a.toLowerCase(),a.includes("ios")?"iOS":a==="android"?"Android":a==="darwin"?"MacOS":a==="win32"?"Windows":a==="freebsd"?"FreeBSD":a==="openbsd"?"OpenBSD":a==="linux"?"Linux":a?`Other:${a}`:"Unknown");let I1;const NZ=()=>I1??(I1=xZ()),qZ=a=>{try{return JSON.parse(a)}catch{return}},zZ=/^[a-z][a-z0-9+.-]*:/i,BZ=a=>zZ.test(a),UZ=a=>new Promise(e=>setTimeout(e,a)),Pg=(a,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new Le(`${a} must be an integer`);if(e<0)throw new Le(`${a} must be a positive integer`);return e},QE=a=>{if(a instanceof Error)return a;if(typeof a=="object"&&a!==null)try{return new Error(JSON.stringify(a))}catch{}return new Error(String(a))},jg=a=>{var e,t,r,n;if(typeof process<"u")return((e=_f==null?void 0:_f[a])==null?void 0:e.trim())??void 0;if(typeof Deno<"u")return(n=(r=(t=Deno.env)==null?void 0:t.get)==null?void 0:r.call(t,a))==null?void 0:n.trim()};function Wy(a){if(!a)return!0;for(const e in a)return!1;return!0}function i8(a,e){return Object.prototype.hasOwnProperty.call(a,e)}function D1(a,e){for(const t in e){if(!i8(e,t))continue;const r=t.toLowerCase();if(!r)continue;const n=e[t];n===null?delete a[r]:n!==void 0&&(a[r]=n)}}function yf(a,...e){typeof process<"u"&&(_f==null?void 0:_f.DEBUG)==="true"&&console.log(`Anthropic:DEBUG:${a}`,...e)}const FZ=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,a=>{const e=Math.random()*16|0;return(a==="x"?e:e&3|8).toString(16)}),LZ=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u",VZ=a=>typeof(a==null?void 0:a.get)=="function",I_=(a,e)=>{var r;const t=e.toLowerCase();if(VZ(a)){const n=((r=e[0])==null?void 0:r.toUpperCase())+e.substring(1).replace(/([^\w])(\w)/g,(i,o,s)=>o+s.toUpperCase());for(const i of[e,t,e.toUpperCase(),n]){const o=a.get(i);if(o)return o}}for(const[n,i]of Object.entries(a))if(n.toLowerCase()===t)return Array.isArray(i)?(i.length<=1||console.warn(`Received ${i.length} entries for the ${e} header, using the first entry.`),i[0]):i};class jb extends AZ{constructor(e,t,r,n){super(e,t,r,n),this.data=r.data||[],this.has_more=r.has_more||!1,this.first_id=r.first_id||null,this.last_id=r.last_id||null}getPaginatedItems(){return this.data??[]}hasNextPage(){return this.has_more===!1?!1:super.hasNextPage()}nextPageParams(){const e=this.nextPageInfo();if(!e)return null;if("params"in e)return e.params;const t=Object.fromEntries(e.url.searchParams);return Object.keys(t).length?t:null}nextPageInfo(){var t;if((t=this.options.query)!=null&&t.before_id){const r=this.first_id;return r?{params:{before_id:r}}:null}const e=this.last_id;return e?{params:{after_id:e}}:null}}let el=class{constructor(e){this._client=e}},bC=class extends el{retrieve(e,t){return this._client.get(`/v1/models/${e}?beta=true`,t)}list(e={},t){return Bu(e)?this.list({},e):this._client.getAPIList("/v1/models?beta=true",mC,{query:e,...t})}};class mC extends jb{}bC.BetaModelInfosPage=mC;class Tb{constructor(e,t){this.iterator=e,this.controller=t}async*decoder(){const e=new Qp;for await(const t of this.iterator)for(const r of e.decode(t))yield JSON.parse(r);for(const t of e.flush())yield JSON.parse(t)}[Symbol.asyncIterator](){return this.decoder()}static fromResponse(e,t){if(!e.body)throw t.abort(),new Le("Attempted to iterate over a response with no body");return new Tb(yC(e.body),t)}}let gC=class extends el{create(e,t){const{betas:r,...n}=e;return this._client.post("/v1/messages/batches?beta=true",{body:n,...t,headers:{"anthropic-beta":[...r??[],"message-batches-2024-09-24"].toString(),...t==null?void 0:t.headers}})}retrieve(e,t={},r){if(Bu(t))return this.retrieve(e,{},t);const{betas:n}=t;return this._client.get(`/v1/messages/batches/${e}?beta=true`,{...r,headers:{"anthropic-beta":[...n??[],"message-batches-2024-09-24"].toString(),...r==null?void 0:r.headers}})}list(e={},t){if(Bu(e))return this.list({},e);const{betas:r,...n}=e;return this._client.getAPIList("/v1/messages/batches?beta=true",vC,{query:n,...t,headers:{"anthropic-beta":[...r??[],"message-batches-2024-09-24"].toString(),...t==null?void 0:t.headers}})}delete(e,t={},r){if(Bu(t))return this.delete(e,{},t);const{betas:n}=t;return this._client.delete(`/v1/messages/batches/${e}?beta=true`,{...r,headers:{"anthropic-beta":[...n??[],"message-batches-2024-09-24"].toString(),...r==null?void 0:r.headers}})}cancel(e,t={},r){if(Bu(t))return this.cancel(e,{},t);const{betas:n}=t;return this._client.post(`/v1/messages/batches/${e}/cancel?beta=true`,{...r,headers:{"anthropic-beta":[...n??[],"message-batches-2024-09-24"].toString(),...r==null?void 0:r.headers}})}async results(e,t={},r){if(Bu(t))return this.results(e,{},t);const n=await this.retrieve(e);if(!n.results_url)throw new Le(`No batch \`results_url\`; Has it finished processing? ${n.processing_status} - ${n.id}`);const{betas:i}=t;return this._client.get(n.results_url,{...r,headers:{"anthropic-beta":[...i??[],"message-batches-2024-09-24"].toString(),Accept:"application/binary",...r==null?void 0:r.headers},__binaryResponse:!0})._thenUnwrap((o,s)=>Tb.fromResponse(s.response,s.controller))}};class vC extends jb{}gC.BetaMessageBatchesPage=vC;const GZ=a=>{let e=0,t=[];for(;e<a.length;){let r=a[e];if(r==="\\"){e++;continue}if(r==="{"){t.push({type:"brace",value:"{"}),e++;continue}if(r==="}"){t.push({type:"brace",value:"}"}),e++;continue}if(r==="["){t.push({type:"paren",value:"["}),e++;continue}if(r==="]"){t.push({type:"paren",value:"]"}),e++;continue}if(r===":"){t.push({type:"separator",value:":"}),e++;continue}if(r===","){t.push({type:"delimiter",value:","}),e++;continue}if(r==='"'){let s="",u=!1;for(r=a[++e];r!=='"';){if(e===a.length){u=!0;break}if(r==="\\"){if(e++,e===a.length){u=!0;break}s+=r+a[e],r=a[++e]}else s+=r,r=a[++e]}r=a[++e],u||t.push({type:"string",value:s});continue}if(r&&/\s/.test(r)){e++;continue}let i=/[0-9]/;if(r&&i.test(r)||r==="-"||r==="."){let s="";for(r==="-"&&(s+=r,r=a[++e]);r&&i.test(r)||r===".";)s+=r,r=a[++e];t.push({type:"number",value:s});continue}let o=/[a-z]/i;if(r&&o.test(r)){let s="";for(;r&&o.test(r)&&e!==a.length;)s+=r,r=a[++e];if(s=="true"||s=="false"||s==="null")t.push({type:"name",value:s});else{e++;continue}continue}e++}return t},Qc=a=>{if(a.length===0)return a;let e=a[a.length-1];switch(e.type){case"separator":return a=a.slice(0,a.length-1),Qc(a);case"number":let t=e.value[e.value.length-1];if(t==="."||t==="-")return a=a.slice(0,a.length-1),Qc(a);case"string":let r=a[a.length-2];if((r==null?void 0:r.type)==="delimiter")return a=a.slice(0,a.length-1),Qc(a);if((r==null?void 0:r.type)==="brace"&&r.value==="{")return a=a.slice(0,a.length-1),Qc(a);break;case"delimiter":return a=a.slice(0,a.length-1),Qc(a)}return a},kZ=a=>{let e=[];return a.map(t=>{t.type==="brace"&&(t.value==="{"?e.push("}"):e.splice(e.lastIndexOf("}"),1)),t.type==="paren"&&(t.value==="["?e.push("]"):e.splice(e.lastIndexOf("]"),1))}),e.length>0&&e.reverse().map(t=>{t==="}"?a.push({type:"brace",value:"}"}):t==="]"&&a.push({type:"paren",value:"]"})}),a},HZ=a=>{let e="";return a.map(t=>{switch(t.type){case"string":e+='"'+t.value+'"';break;default:e+=t.value;break}}),e},a8=a=>JSON.parse(HZ(kZ(Qc(GZ(a)))));var At=function(a,e,t,r,n){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?a!==e||!n:!e.has(a))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?n.call(a,t):n?n.value=t:e.set(a,t),t},Be=function(a,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?a!==e||!r:!e.has(a))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(a):r?r.value:e.get(a)},Pr,xu,Xf,D_,Zf,Qf,x_,Yf,fu,ed,$_,N_,Gc,q_,z_,Tg,x1,Mg,Ag,Ig,Dg,$1;const N1="__json_buf";class Ky{constructor(){Pr.add(this),this.messages=[],this.receivedMessages=[],xu.set(this,void 0),this.controller=new AbortController,Xf.set(this,void 0),D_.set(this,()=>{}),Zf.set(this,()=>{}),Qf.set(this,void 0),x_.set(this,()=>{}),Yf.set(this,()=>{}),fu.set(this,{}),ed.set(this,!1),$_.set(this,!1),N_.set(this,!1),Gc.set(this,!1),q_.set(this,void 0),z_.set(this,void 0),Mg.set(this,e=>{if(At(this,$_,!0,"f"),e instanceof Error&&e.name==="AbortError"&&(e=new Fs),e instanceof Fs)return At(this,N_,!0,"f"),this._emit("abort",e);if(e instanceof Le)return this._emit("error",e);if(e instanceof Error){const t=new Le(e.message);return t.cause=e,this._emit("error",t)}return this._emit("error",new Le(String(e)))}),At(this,Xf,new Promise((e,t)=>{At(this,D_,e,"f"),At(this,Zf,t,"f")}),"f"),At(this,Qf,new Promise((e,t)=>{At(this,x_,e,"f"),At(this,Yf,t,"f")}),"f"),Be(this,Xf,"f").catch(()=>{}),Be(this,Qf,"f").catch(()=>{})}get response(){return Be(this,q_,"f")}get request_id(){return Be(this,z_,"f")}async withResponse(){const e=await Be(this,Xf,"f");if(!e)throw new Error("Could not resolve a `Response` object");return{data:this,response:e,request_id:e.headers.get("request-id")}}static fromReadableStream(e){const t=new Ky;return t._run(()=>t._fromReadableStream(e)),t}static createMessage(e,t,r){const n=new Ky;for(const i of t.messages)n._addMessageParam(i);return n._run(()=>n._createMessage(e,{...t,stream:!0},{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),n}_run(e){e().then(()=>{this._emitFinal(),this._emit("end")},Be(this,Mg,"f"))}_addMessageParam(e){this.messages.push(e)}_addMessage(e,t=!0){this.receivedMessages.push(e),t&&this._emit("message",e)}async _createMessage(e,t,r){var s;const n=r==null?void 0:r.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),Be(this,Pr,"m",Ag).call(this);const{response:i,data:o}=await e.create({...t,stream:!0},{...r,signal:this.controller.signal}).withResponse();this._connected(i);for await(const u of o)Be(this,Pr,"m",Ig).call(this,u);if((s=o.controller.signal)!=null&&s.aborted)throw new Fs;Be(this,Pr,"m",Dg).call(this)}_connected(e){this.ended||(At(this,q_,e,"f"),At(this,z_,e==null?void 0:e.headers.get("request-id"),"f"),Be(this,D_,"f").call(this,e),this._emit("connect"))}get ended(){return Be(this,ed,"f")}get errored(){return Be(this,$_,"f")}get aborted(){return Be(this,N_,"f")}abort(){this.controller.abort()}on(e,t){return(Be(this,fu,"f")[e]||(Be(this,fu,"f")[e]=[])).push({listener:t}),this}off(e,t){const r=Be(this,fu,"f")[e];if(!r)return this;const n=r.findIndex(i=>i.listener===t);return n>=0&&r.splice(n,1),this}once(e,t){return(Be(this,fu,"f")[e]||(Be(this,fu,"f")[e]=[])).push({listener:t,once:!0}),this}emitted(e){return new Promise((t,r)=>{At(this,Gc,!0,"f"),e!=="error"&&this.once("error",r),this.once(e,t)})}async done(){At(this,Gc,!0,"f"),await Be(this,Qf,"f")}get currentMessage(){return Be(this,xu,"f")}async finalMessage(){return await this.done(),Be(this,Pr,"m",Tg).call(this)}async finalText(){return await this.done(),Be(this,Pr,"m",x1).call(this)}_emit(e,...t){if(Be(this,ed,"f"))return;e==="end"&&(At(this,ed,!0,"f"),Be(this,x_,"f").call(this));const r=Be(this,fu,"f")[e];if(r&&(Be(this,fu,"f")[e]=r.filter(n=>!n.once),r.forEach(({listener:n})=>n(...t))),e==="abort"){const n=t[0];!Be(this,Gc,"f")&&!(r!=null&&r.length)&&Promise.reject(n),Be(this,Zf,"f").call(this,n),Be(this,Yf,"f").call(this,n),this._emit("end");return}if(e==="error"){const n=t[0];!Be(this,Gc,"f")&&!(r!=null&&r.length)&&Promise.reject(n),Be(this,Zf,"f").call(this,n),Be(this,Yf,"f").call(this,n),this._emit("end")}}_emitFinal(){this.receivedMessages.at(-1)&&this._emit("finalMessage",Be(this,Pr,"m",Tg).call(this))}async _fromReadableStream(e,t){var i;const r=t==null?void 0:t.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),Be(this,Pr,"m",Ag).call(this),this._connected(null);const n=Mp.fromReadableStream(e,this.controller);for await(const o of n)Be(this,Pr,"m",Ig).call(this,o);if((i=n.controller.signal)!=null&&i.aborted)throw new Fs;Be(this,Pr,"m",Dg).call(this)}[(xu=new WeakMap,Xf=new WeakMap,D_=new WeakMap,Zf=new WeakMap,Qf=new WeakMap,x_=new WeakMap,Yf=new WeakMap,fu=new WeakMap,ed=new WeakMap,$_=new WeakMap,N_=new WeakMap,Gc=new WeakMap,q_=new WeakMap,z_=new WeakMap,Mg=new WeakMap,Pr=new WeakSet,Tg=function(){if(this.receivedMessages.length===0)throw new Le("stream ended without producing a Message with role=assistant");return this.receivedMessages.at(-1)},x1=function(){if(this.receivedMessages.length===0)throw new Le("stream ended without producing a Message with role=assistant");const t=this.receivedMessages.at(-1).content.filter(r=>r.type==="text").map(r=>r.text);if(t.length===0)throw new Le("stream ended without producing a content block with type=text");return t.join(" ")},Ag=function(){this.ended||At(this,xu,void 0,"f")},Ig=function(t){if(this.ended)return;const r=Be(this,Pr,"m",$1).call(this,t);switch(this._emit("streamEvent",t,r),t.type){case"content_block_delta":{const n=r.content.at(-1);switch(t.delta.type){case"text_delta":{n.type==="text"&&this._emit("text",t.delta.text,n.text||"");break}case"citations_delta":{n.type==="text"&&this._emit("citation",t.delta.citation,n.citations??[]);break}case"input_json_delta":{n.type==="tool_use"&&n.input&&this._emit("inputJson",t.delta.partial_json,n.input);break}case"thinking_delta":{n.type==="thinking"&&this._emit("thinking",t.delta.thinking,n.thinking);break}case"signature_delta":{n.type==="thinking"&&this._emit("signature",n.signature);break}default:t.delta}break}case"message_stop":{this._addMessageParam(r),this._addMessage(r,!0);break}case"content_block_stop":{this._emit("contentBlock",r.content.at(-1));break}case"message_start":{At(this,xu,r,"f");break}}},Dg=function(){if(this.ended)throw new Le("stream has ended, this shouldn't happen");const t=Be(this,xu,"f");if(!t)throw new Le("request ended without sending any chunks");return At(this,xu,void 0,"f"),t},$1=function(t){let r=Be(this,xu,"f");if(t.type==="message_start"){if(r)throw new Le(`Unexpected event order, got ${t.type} before receiving "message_stop"`);return t.message}if(!r)throw new Le(`Unexpected event order, got ${t.type} before "message_start"`);switch(t.type){case"message_stop":return r;case"message_delta":return r.stop_reason=t.delta.stop_reason,r.stop_sequence=t.delta.stop_sequence,r.usage.output_tokens=t.usage.output_tokens,r;case"content_block_start":return r.content.push(t.content_block),r;case"content_block_delta":{const n=r.content.at(t.index);switch(t.delta.type){case"text_delta":{(n==null?void 0:n.type)==="text"&&(n.text+=t.delta.text);break}case"citations_delta":{(n==null?void 0:n.type)==="text"&&(n.citations??(n.citations=[]),n.citations.push(t.delta.citation));break}case"input_json_delta":{if((n==null?void 0:n.type)==="tool_use"){let i=n[N1]||"";i+=t.delta.partial_json,Object.defineProperty(n,N1,{value:i,enumerable:!1,writable:!0}),i&&(n.input=a8(i))}break}case"thinking_delta":{(n==null?void 0:n.type)==="thinking"&&(n.thinking+=t.delta.thinking);break}case"signature_delta":{(n==null?void 0:n.type)==="thinking"&&(n.signature=t.delta.signature);break}default:t.delta}return r}case"content_block_stop":return r}},Symbol.asyncIterator)](){const e=[],t=[];let r=!1;return this.on("streamEvent",n=>{const i=t.shift();i?i.resolve(n):e.push(n)}),this.on("end",()=>{r=!0;for(const n of t)n.resolve(void 0);t.length=0}),this.on("abort",n=>{r=!0;for(const i of t)i.reject(n);t.length=0}),this.on("error",n=>{r=!0;for(const i of t)i.reject(n);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((i,o)=>t.push({resolve:i,reject:o})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new Mp(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}const q1={"claude-1.3":"November 6th, 2024","claude-1.3-100k":"November 6th, 2024","claude-instant-1.1":"November 6th, 2024","claude-instant-1.1-100k":"November 6th, 2024","claude-instant-1.2":"November 6th, 2024","claude-3-sonnet-20240229":"July 21st, 2025","claude-2.1":"July 21st, 2025","claude-2.0":"July 21st, 2025"};let Mb=class extends el{constructor(){super(...arguments),this.batches=new gC(this._client)}create(e,t){const{betas:r,...n}=e;return n.model in q1&&console.warn(`The model '${n.model}' is deprecated and will reach end-of-life on ${q1[n.model]}
Please migrate to a newer model. Visit https://docs.anthropic.com/en/docs/resources/model-deprecations for more information.`),this._client.post("/v1/messages?beta=true",{body:n,timeout:this._client._options.timeout??(n.stream?6e5:this._client._calculateNonstreamingTimeout(n.max_tokens)),...t,headers:{...(r==null?void 0:r.toString())!=null?{"anthropic-beta":r==null?void 0:r.toString()}:void 0,...t==null?void 0:t.headers},stream:e.stream??!1})}stream(e,t){return Ky.createMessage(this,e,t)}countTokens(e,t){const{betas:r,...n}=e;return this._client.post("/v1/messages/count_tokens?beta=true",{body:n,...t,headers:{"anthropic-beta":[...r??[],"token-counting-2024-11-01"].toString(),...t==null?void 0:t.headers}})}};Mb.Batches=gC;Mb.BetaMessageBatchesPage=vC;class Yp extends el{constructor(){super(...arguments),this.models=new bC(this._client),this.messages=new Mb(this._client)}}Yp.Models=bC;Yp.BetaModelInfosPage=mC;Yp.Messages=Mb;let o8=class extends el{create(e,t){return this._client.post("/v1/complete",{body:e,timeout:this._client._options.timeout??6e5,...t,stream:e.stream??!1})}};class wC extends el{create(e,t){return this._client.post("/v1/messages/batches",{body:e,...t})}retrieve(e,t){return this._client.get(`/v1/messages/batches/${e}`,t)}list(e={},t){return Bu(e)?this.list({},e):this._client.getAPIList("/v1/messages/batches",OC,{query:e,...t})}delete(e,t){return this._client.delete(`/v1/messages/batches/${e}`,t)}cancel(e,t){return this._client.post(`/v1/messages/batches/${e}/cancel`,t)}async results(e,t){const r=await this.retrieve(e);if(!r.results_url)throw new Le(`No batch \`results_url\`; Has it finished processing? ${r.processing_status} - ${r.id}`);return this._client.get(r.results_url,{...t,headers:{Accept:"application/binary",...t==null?void 0:t.headers},__binaryResponse:!0})._thenUnwrap((n,i)=>Tb.fromResponse(i.response,i.controller))}}class OC extends jb{}wC.MessageBatchesPage=OC;var It=function(a,e,t,r,n){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?a!==e||!n:!e.has(a))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?n.call(a,t):n?n.value=t:e.set(a,t),t},Ue=function(a,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?a!==e||!r:!e.has(a))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(a):r?r.value:e.get(a)},jr,$u,td,B_,rd,nd,U_,id,du,ad,F_,L_,kc,V_,G_,xg,z1,$g,Ng,qg,zg,B1;const U1="__json_buf";class Jy{constructor(){jr.add(this),this.messages=[],this.receivedMessages=[],$u.set(this,void 0),this.controller=new AbortController,td.set(this,void 0),B_.set(this,()=>{}),rd.set(this,()=>{}),nd.set(this,void 0),U_.set(this,()=>{}),id.set(this,()=>{}),du.set(this,{}),ad.set(this,!1),F_.set(this,!1),L_.set(this,!1),kc.set(this,!1),V_.set(this,void 0),G_.set(this,void 0),$g.set(this,e=>{if(It(this,F_,!0,"f"),e instanceof Error&&e.name==="AbortError"&&(e=new Fs),e instanceof Fs)return It(this,L_,!0,"f"),this._emit("abort",e);if(e instanceof Le)return this._emit("error",e);if(e instanceof Error){const t=new Le(e.message);return t.cause=e,this._emit("error",t)}return this._emit("error",new Le(String(e)))}),It(this,td,new Promise((e,t)=>{It(this,B_,e,"f"),It(this,rd,t,"f")}),"f"),It(this,nd,new Promise((e,t)=>{It(this,U_,e,"f"),It(this,id,t,"f")}),"f"),Ue(this,td,"f").catch(()=>{}),Ue(this,nd,"f").catch(()=>{})}get response(){return Ue(this,V_,"f")}get request_id(){return Ue(this,G_,"f")}async withResponse(){const e=await Ue(this,td,"f");if(!e)throw new Error("Could not resolve a `Response` object");return{data:this,response:e,request_id:e.headers.get("request-id")}}static fromReadableStream(e){const t=new Jy;return t._run(()=>t._fromReadableStream(e)),t}static createMessage(e,t,r){const n=new Jy;for(const i of t.messages)n._addMessageParam(i);return n._run(()=>n._createMessage(e,{...t,stream:!0},{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),n}_run(e){e().then(()=>{this._emitFinal(),this._emit("end")},Ue(this,$g,"f"))}_addMessageParam(e){this.messages.push(e)}_addMessage(e,t=!0){this.receivedMessages.push(e),t&&this._emit("message",e)}async _createMessage(e,t,r){var s;const n=r==null?void 0:r.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),Ue(this,jr,"m",Ng).call(this);const{response:i,data:o}=await e.create({...t,stream:!0},{...r,signal:this.controller.signal}).withResponse();this._connected(i);for await(const u of o)Ue(this,jr,"m",qg).call(this,u);if((s=o.controller.signal)!=null&&s.aborted)throw new Fs;Ue(this,jr,"m",zg).call(this)}_connected(e){this.ended||(It(this,V_,e,"f"),It(this,G_,e==null?void 0:e.headers.get("request-id"),"f"),Ue(this,B_,"f").call(this,e),this._emit("connect"))}get ended(){return Ue(this,ad,"f")}get errored(){return Ue(this,F_,"f")}get aborted(){return Ue(this,L_,"f")}abort(){this.controller.abort()}on(e,t){return(Ue(this,du,"f")[e]||(Ue(this,du,"f")[e]=[])).push({listener:t}),this}off(e,t){const r=Ue(this,du,"f")[e];if(!r)return this;const n=r.findIndex(i=>i.listener===t);return n>=0&&r.splice(n,1),this}once(e,t){return(Ue(this,du,"f")[e]||(Ue(this,du,"f")[e]=[])).push({listener:t,once:!0}),this}emitted(e){return new Promise((t,r)=>{It(this,kc,!0,"f"),e!=="error"&&this.once("error",r),this.once(e,t)})}async done(){It(this,kc,!0,"f"),await Ue(this,nd,"f")}get currentMessage(){return Ue(this,$u,"f")}async finalMessage(){return await this.done(),Ue(this,jr,"m",xg).call(this)}async finalText(){return await this.done(),Ue(this,jr,"m",z1).call(this)}_emit(e,...t){if(Ue(this,ad,"f"))return;e==="end"&&(It(this,ad,!0,"f"),Ue(this,U_,"f").call(this));const r=Ue(this,du,"f")[e];if(r&&(Ue(this,du,"f")[e]=r.filter(n=>!n.once),r.forEach(({listener:n})=>n(...t))),e==="abort"){const n=t[0];!Ue(this,kc,"f")&&!(r!=null&&r.length)&&Promise.reject(n),Ue(this,rd,"f").call(this,n),Ue(this,id,"f").call(this,n),this._emit("end");return}if(e==="error"){const n=t[0];!Ue(this,kc,"f")&&!(r!=null&&r.length)&&Promise.reject(n),Ue(this,rd,"f").call(this,n),Ue(this,id,"f").call(this,n),this._emit("end")}}_emitFinal(){this.receivedMessages.at(-1)&&this._emit("finalMessage",Ue(this,jr,"m",xg).call(this))}async _fromReadableStream(e,t){var i;const r=t==null?void 0:t.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),Ue(this,jr,"m",Ng).call(this),this._connected(null);const n=Mp.fromReadableStream(e,this.controller);for await(const o of n)Ue(this,jr,"m",qg).call(this,o);if((i=n.controller.signal)!=null&&i.aborted)throw new Fs;Ue(this,jr,"m",zg).call(this)}[($u=new WeakMap,td=new WeakMap,B_=new WeakMap,rd=new WeakMap,nd=new WeakMap,U_=new WeakMap,id=new WeakMap,du=new WeakMap,ad=new WeakMap,F_=new WeakMap,L_=new WeakMap,kc=new WeakMap,V_=new WeakMap,G_=new WeakMap,$g=new WeakMap,jr=new WeakSet,xg=function(){if(this.receivedMessages.length===0)throw new Le("stream ended without producing a Message with role=assistant");return this.receivedMessages.at(-1)},z1=function(){if(this.receivedMessages.length===0)throw new Le("stream ended without producing a Message with role=assistant");const t=this.receivedMessages.at(-1).content.filter(r=>r.type==="text").map(r=>r.text);if(t.length===0)throw new Le("stream ended without producing a content block with type=text");return t.join(" ")},Ng=function(){this.ended||It(this,$u,void 0,"f")},qg=function(t){if(this.ended)return;const r=Ue(this,jr,"m",B1).call(this,t);switch(this._emit("streamEvent",t,r),t.type){case"content_block_delta":{const n=r.content.at(-1);switch(t.delta.type){case"text_delta":{n.type==="text"&&this._emit("text",t.delta.text,n.text||"");break}case"citations_delta":{n.type==="text"&&this._emit("citation",t.delta.citation,n.citations??[]);break}case"input_json_delta":{n.type==="tool_use"&&n.input&&this._emit("inputJson",t.delta.partial_json,n.input);break}case"thinking_delta":{n.type==="thinking"&&this._emit("thinking",t.delta.thinking,n.thinking);break}case"signature_delta":{n.type==="thinking"&&this._emit("signature",n.signature);break}default:t.delta}break}case"message_stop":{this._addMessageParam(r),this._addMessage(r,!0);break}case"content_block_stop":{this._emit("contentBlock",r.content.at(-1));break}case"message_start":{It(this,$u,r,"f");break}}},zg=function(){if(this.ended)throw new Le("stream has ended, this shouldn't happen");const t=Ue(this,$u,"f");if(!t)throw new Le("request ended without sending any chunks");return It(this,$u,void 0,"f"),t},B1=function(t){let r=Ue(this,$u,"f");if(t.type==="message_start"){if(r)throw new Le(`Unexpected event order, got ${t.type} before receiving "message_stop"`);return t.message}if(!r)throw new Le(`Unexpected event order, got ${t.type} before "message_start"`);switch(t.type){case"message_stop":return r;case"message_delta":return r.stop_reason=t.delta.stop_reason,r.stop_sequence=t.delta.stop_sequence,r.usage.output_tokens=t.usage.output_tokens,r;case"content_block_start":return r.content.push(t.content_block),r;case"content_block_delta":{const n=r.content.at(t.index);switch(t.delta.type){case"text_delta":{(n==null?void 0:n.type)==="text"&&(n.text+=t.delta.text);break}case"citations_delta":{(n==null?void 0:n.type)==="text"&&(n.citations??(n.citations=[]),n.citations.push(t.delta.citation));break}case"input_json_delta":{if((n==null?void 0:n.type)==="tool_use"){let i=n[U1]||"";i+=t.delta.partial_json,Object.defineProperty(n,U1,{value:i,enumerable:!1,writable:!0}),i&&(n.input=a8(i))}break}case"thinking_delta":{(n==null?void 0:n.type)==="thinking"&&(n.thinking+=t.delta.thinking);break}case"signature_delta":{(n==null?void 0:n.type)==="thinking"&&(n.signature=t.delta.signature);break}default:t.delta}return r}case"content_block_stop":return r}},Symbol.asyncIterator)](){const e=[],t=[];let r=!1;return this.on("streamEvent",n=>{const i=t.shift();i?i.resolve(n):e.push(n)}),this.on("end",()=>{r=!0;for(const n of t)n.resolve(void 0);t.length=0}),this.on("abort",n=>{r=!0;for(const i of t)i.reject(n);t.length=0}),this.on("error",n=>{r=!0;for(const i of t)i.reject(n);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((i,o)=>t.push({resolve:i,reject:o})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new Mp(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}class Ab extends el{constructor(){super(...arguments),this.batches=new wC(this._client)}create(e,t){return e.model in F1&&console.warn(`The model '${e.model}' is deprecated and will reach end-of-life on ${F1[e.model]}
Please migrate to a newer model. Visit https://docs.anthropic.com/en/docs/resources/model-deprecations for more information.`),this._client.post("/v1/messages",{body:e,timeout:this._client._options.timeout??(e.stream?6e5:this._client._calculateNonstreamingTimeout(e.max_tokens)),...t,stream:e.stream??!1})}stream(e,t){return Jy.createMessage(this,e,t)}countTokens(e,t){return this._client.post("/v1/messages/count_tokens",{body:e,...t})}}const F1={"claude-1.3":"November 6th, 2024","claude-1.3-100k":"November 6th, 2024","claude-instant-1.1":"November 6th, 2024","claude-instant-1.1-100k":"November 6th, 2024","claude-instant-1.2":"November 6th, 2024","claude-3-sonnet-20240229":"July 21st, 2025","claude-2.1":"July 21st, 2025","claude-2.0":"July 21st, 2025"};Ab.Batches=wC;Ab.MessageBatchesPage=OC;let SC=class extends el{retrieve(e,t){return this._client.get(`/v1/models/${e}`,t)}list(e={},t){return Bu(e)?this.list({},e):this._client.getAPIList("/v1/models",EC,{query:e,...t})}};class EC extends jb{}SC.ModelInfosPage=EC;var s8;class rt extends MZ{constructor({baseURL:e=jg("ANTHROPIC_BASE_URL"),apiKey:t=jg("ANTHROPIC_API_KEY")??null,authToken:r=jg("ANTHROPIC_AUTH_TOKEN")??null,...n}={}){const i={apiKey:t,authToken:r,...n,baseURL:e||"https://api.anthropic.com"};if(!i.dangerouslyAllowBrowser&&LZ())throw new Le(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new Anthropic({ apiKey, dangerouslyAllowBrowser: true });
`);super({baseURL:i.baseURL,timeout:i.timeout??6e5,httpAgent:i.httpAgent,maxRetries:i.maxRetries,fetch:i.fetch}),this.completions=new o8(this),this.messages=new Ab(this),this.models=new SC(this),this.beta=new Yp(this),this._options=i,this.apiKey=t,this.authToken=r}defaultQuery(){return this._options.defaultQuery}defaultHeaders(e){return{...super.defaultHeaders(e),...this._options.dangerouslyAllowBrowser?{"anthropic-dangerous-direct-browser-access":"true"}:void 0,"anthropic-version":"2023-06-01",...this._options.defaultHeaders}}validateHeaders(e,t){if(!(this.apiKey&&e["x-api-key"])&&t["x-api-key"]!==null&&!(this.authToken&&e.authorization)&&t.authorization!==null)throw new Error('Could not resolve authentication method. Expected either apiKey or authToken to be set. Or for one of the "X-Api-Key" or "Authorization" headers to be explicitly omitted')}authHeaders(e){const t=this.apiKeyAuth(e),r=this.bearerAuth(e);return t!=null&&!Wy(t)?t:r!=null&&!Wy(r)?r:{}}apiKeyAuth(e){return this.apiKey==null?{}:{"X-Api-Key":this.apiKey}}bearerAuth(e){return this.authToken==null?{}:{Authorization:`Bearer ${this.authToken}`}}}s8=rt;rt.Anthropic=s8;rt.HUMAN_PROMPT=`

Human:`;rt.AI_PROMPT=`

Assistant:`;rt.DEFAULT_TIMEOUT=6e5;rt.AnthropicError=Le;rt.APIError=Or;rt.APIConnectionError=Cb;rt.APIConnectionTimeoutError=G3;rt.APIUserAbortError=Fs;rt.NotFoundError=K3;rt.ConflictError=J3;rt.RateLimitError=Z3;rt.BadRequestError=k3;rt.AuthenticationError=H3;rt.InternalServerError=Q3;rt.PermissionDeniedError=W3;rt.UnprocessableEntityError=X3;rt.toFile=SZ;rt.fileFromPath=V3;rt.Completions=o8;rt.Messages=Ab;rt.Models=SC;rt.ModelInfosPage=EC;rt.Beta=Yp;const{HUMAN_PROMPT:nhe,AI_PROMPT:ihe}=rt;class L1 extends dC{static lc_name(){return"AnthropicToolsOutputParser"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","anthropic","output_parsers"]}),Object.defineProperty(this,"returnId",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"keyName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"returnSingle",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"zodSchema",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.keyName=e.keyName,this.returnSingle=e.returnSingle??this.returnSingle,this.zodSchema=e.zodSchema}async _validateResult(e){let t=e;if(typeof e=="string")try{t=JSON.parse(e)}catch(n){throw new Tf(`Failed to parse. Text: "${JSON.stringify(e,null,2)}". Error: ${JSON.stringify(n.message)}`,e)}else t=e;if(this.zodSchema===void 0)return t;const r=await this.zodSchema.safeParseAsync(t);if(r.success)return r.data;throw new Tf(`Failed to parse. Text: "${JSON.stringify(e,null,2)}". Error: ${JSON.stringify(r.error.errors)}`,JSON.stringify(t,null,2))}async parseResult(e){const t=e.flatMap(i=>{const{message:o}=i;return Array.isArray(o.content)?u8(o.content)[0]:[]});if(t[0]===void 0)throw new Error("No parseable tool calls provided to AnthropicToolsOutputParser.");const[r]=t;return await this._validateResult(r.args)}}function u8(a){const e=[];for(const t of a)t.type==="tool_use"&&e.push({name:t.name,args:t.input,id:t.id,type:"tool_call"});return e}function WZ(a){if(a)return a==="any"?{type:"any"}:a==="auto"?{type:"auto"}:typeof a=="string"?{type:"tool",name:a}:a}function V1(a){const e=/^data:(image\/.+);base64,(.+)$/,t=a.match(e);if(t===null)throw new Error(["Anthropic only supports base64-encoded images currently.","Example: data:image/png;base64,/9j/4AAQSk..."].join(`

`));return{type:"base64",media_type:t[1]??"",data:t[2]??""}}function KZ(a){const e=[];for(const t of a)if(t._getType()==="tool")if(typeof t.content=="string"){const r=e[e.length-1];(r==null?void 0:r._getType())==="human"&&Array.isArray(r.content)&&"type"in r.content[0]&&r.content[0].type==="tool_result"?r.content.push({type:"tool_result",content:t.content,tool_use_id:t.tool_call_id}):e.push(new ku({content:[{type:"tool_result",content:t.content,tool_use_id:t.tool_call_id}]}))}else e.push(new ku({content:[{type:"tool_result",content:YE(t.content),tool_use_id:t.tool_call_id}]}));else e.push(t);return e}function G1(a){if(a.id===void 0)throw new Error('Anthropic requires all tool calls to have an "id".');return{type:"tool_use",id:a.id,name:a.name,input:a.args}}function YE(a){const e=["tool_use","tool_result","input_json_delta"],t=["text","text_delta"];return typeof a=="string"?a:a.map(n=>{const i="cache_control"in n?n.cache_control:void 0;if(n.type==="image_url"){let o;return typeof n.image_url=="string"?o=V1(n.image_url):o=V1(n.image_url.url),{type:"image",source:o,...i?{cache_control:i}:{}}}else{if(n.type==="document")return{...n,...i?{cache_control:i}:{}};if(n.type==="thinking")return{type:"thinking",thinking:n.thinking,signature:n.signature,...i?{cache_control:i}:{}};if(n.type==="redacted_thinking")return{type:"redacted_thinking",data:n.data,...i?{cache_control:i}:{}};if(t.find(o=>o===n.type)&&"text"in n)return{type:"text",text:n.text,...i?{cache_control:i}:{}};if(e.find(o=>o===n.type)){const o={...n};if("index"in o&&delete o.index,o.type==="input_json_delta"&&(o.type="tool_use"),"input"in o)try{o.input=JSON.parse(o.input)}catch{}return{...o,...i?{cache_control:i}:{}}}else throw new Error("Unsupported message content format")}})}function k1(a){const e=KZ(a);let t;e.length>0&&e[0]._getType()==="system"&&(t=a[0].content);const n=(t!==void 0?e.slice(1):e).map(i=>{var s;let o;if(i._getType()==="human")o="user";else if(i._getType()==="ai")o="assistant";else if(i._getType()==="tool")o="user";else throw i._getType()==="system"?new Error("System messages are only permitted as the first passed message."):new Error(`Message type "${i._getType()}" is not supported.`);if(ru(i)&&((s=i.tool_calls)!=null&&s.length)){if(typeof i.content=="string")return i.content===""?{role:o,content:i.tool_calls.map(G1)}:{role:o,content:[{type:"text",text:i.content},...i.tool_calls.map(G1)]};{const{content:u}=i;return!i.tool_calls.every(c=>u.find(f=>(f.type==="tool_use"||f.type==="input_json_delta")&&f.id===c.id))&&console.warn('The "tool_calls" field on a message is only respected if content is a string.'),{role:o,content:YE(i.content)}}}else return{role:o,content:YE(i.content)}});return{messages:JZ(n),system:t}}function JZ(a){if(!a||a.length<=1)return a;const e=[];let t=a[0];const r=i=>typeof i=="string"?[{type:"text",text:i}]:i,n=i=>i.role!=="user"||typeof i.content=="string"?!1:Array.isArray(i.content)&&i.content.every(o=>o.type==="tool_result");for(let i=1;i<a.length;i+=1){const o=a[i];n(t)&&n(o)?t={...t,content:[...r(t.content),...r(o.content)]}:(e.push(t),t=o)}return e.push(t),e}function XZ(a,e){var t;if(a.type==="message_start"){const{content:r,usage:n,...i}=a.message,o={};for(const[f,p]of Object.entries(i))p!=null&&(o[f]=p);const{input_tokens:s,output_tokens:u,...l}=n??{},c={input_tokens:s,output_tokens:u,total_tokens:s+u,input_token_details:{cache_creation:l.cache_creation_input_tokens,cache_read:l.cache_read_input_tokens}};return{chunk:new it({content:e.coerceContentToString?"":[],additional_kwargs:o,usage_metadata:e.streamUsage?c:void 0,response_metadata:{usage:{...l}},id:a.message.id})}}else if(a.type==="message_delta"){const r={input_tokens:0,output_tokens:a.usage.output_tokens,total_tokens:a.usage.output_tokens,input_token_details:{cache_creation:a.usage.cache_creation_input_tokens,cache_read:a.usage.cache_read_input_tokens}};return{chunk:new it({content:e.coerceContentToString?"":[],additional_kwargs:{...a.delta},usage_metadata:e.streamUsage?r:void 0})}}else if(a.type==="content_block_start"&&["tool_use","document"].includes(a.content_block.type)){const r=a.content_block;let n;return r.type==="tool_use"?n=[{id:r.id,index:a.index,name:r.name,args:""}]:n=[],{chunk:new it({content:e.coerceContentToString?"":[{index:a.index,...a.content_block,input:""}],additional_kwargs:{},tool_call_chunks:n})}}else if(a.type==="content_block_delta"&&["text_delta","citations_delta","thinking_delta","signature_delta"].includes(a.delta.type)){if(e.coerceContentToString&&"text"in a.delta)return{chunk:new it({content:a.delta.text})};{const r=a.delta;return"citation"in r&&(r.citations=[r.citation],delete r.citation),r.type==="thinking_delta"||r.type==="signature_delta"?{chunk:new it({content:[{index:a.index,...r,type:"thinking"}]})}:{chunk:new it({content:[{index:a.index,...r,type:"text"}]})}}}else{if(a.type==="content_block_delta"&&a.delta.type==="input_json_delta")return{chunk:new it({content:e.coerceContentToString?"":[{index:a.index,input:a.delta.partial_json,type:a.delta.type}],additional_kwargs:{},tool_call_chunks:[{index:a.index,args:a.delta.partial_json}]})};if(a.type==="content_block_start"&&a.content_block.type==="text"){const r=(t=a.content_block)==null?void 0:t.text;if(r!==void 0)return{chunk:new it({content:e.coerceContentToString?r:[{index:a.index,...a.content_block}],additional_kwargs:{}})}}else{if(a.type==="content_block_start"&&a.content_block.type==="redacted_thinking")return{chunk:new it({content:e.coerceContentToString?"":[{index:a.index,...a.content_block}]})};if(a.type==="content_block_start"&&a.content_block.type==="thinking"){const r=a.content_block.thinking;return{chunk:new it({content:e.coerceContentToString?r:[{index:a.index,...a.content_block}]})}}}}return null}function ZZ(a,e){const t=e.usage,r=t!=null?{input_tokens:t.input_tokens??0,output_tokens:t.output_tokens??0,total_tokens:(t.input_tokens??0)+(t.output_tokens??0),input_token_details:{cache_creation:t.cache_creation_input_tokens,cache_read:t.cache_read_input_tokens}}:void 0;if(a.length===1&&a[0].type==="text")return[{text:a[0].text,message:new Hs({content:a[0].text,additional_kwargs:e,usage_metadata:r,response_metadata:e,id:e.id})}];{const n=u8(a);return[{text:"",message:new Hs({content:a,additional_kwargs:e,tool_calls:n,usage_metadata:r,response_metadata:e,id:e.id})}]}}function k_(a,e){return a.lc_error_code=e,a.message=`${a.message}

Troubleshooting URL: https://js.langchain.com/docs/troubleshooting/errors/${e}/
`,a}function H1(a){let e;return a.status===400&&a.message.includes("tool")?e=k_(a,"INVALID_TOOL_RESULTS"):a.status===401?e=k_(a,"MODEL_AUTHENTICATION"):a.status===404?e=k_(a,"MODEL_NOT_FOUND"):a.status===429?e=k_(a,"MODEL_RATE_LIMIT"):e=a,e}function QZ(a){return!!(a.tools&&a.tools.length>0)}function YZ(a){for(const e of a.messages??[])if(typeof e.content!="string"){for(const t of e.content??[])if(typeof t=="object"&&t!=null&&t.type==="document"&&typeof t.citations=="object"&&t.citations.enabled)return!0}return!1}function eQ(a){return!!(a.thinking&&a.thinking.type==="enabled")}function tQ(a){return"input_schema"in a}function rQ(a){if(typeof a.content=="string")return a.content;if(Array.isArray(a.content)&&a.content.length>=1&&"input"in a.content[0])return typeof a.content[0].input=="string"?a.content[0].input:JSON.stringify(a.content[0].input);if(Array.isArray(a.content)&&a.content.length>=1&&"text"in a.content[0])return a.content[0].text}class nQ extends Ar{static lc_name(){return"ChatAnthropic"}get lc_secrets(){return{anthropicApiKey:"ANTHROPIC_API_KEY",apiKey:"ANTHROPIC_API_KEY"}}get lc_aliases(){return{modelName:"model"}}constructor(e){if(super(e??{}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"anthropicApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiUrl",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"temperature",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"topK",{enumerable:!0,configurable:!0,writable:!0,value:-1}),Object.defineProperty(this,"topP",{enumerable:!0,configurable:!0,writable:!0,value:-1}),Object.defineProperty(this,"maxTokens",{enumerable:!0,configurable:!0,writable:!0,value:2048}),Object.defineProperty(this,"modelName",{enumerable:!0,configurable:!0,writable:!0,value:"claude-2.1"}),Object.defineProperty(this,"model",{enumerable:!0,configurable:!0,writable:!0,value:"claude-2.1"}),Object.defineProperty(this,"invocationKwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stopSequences",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"streaming",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"clientOptions",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"thinking",{enumerable:!0,configurable:!0,writable:!0,value:{type:"disabled"}}),Object.defineProperty(this,"batchClient",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"streamingClient",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"streamUsage",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"createClient",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.anthropicApiKey=(e==null?void 0:e.apiKey)??(e==null?void 0:e.anthropicApiKey)??We("ANTHROPIC_API_KEY"),!this.anthropicApiKey&&!(e!=null&&e.createClient))throw new Error("Anthropic API key not found");this.clientOptions=(e==null?void 0:e.clientOptions)??{},this.apiKey=this.anthropicApiKey,this.apiUrl=e==null?void 0:e.anthropicApiUrl,this.modelName=(e==null?void 0:e.model)??(e==null?void 0:e.modelName)??this.model,this.model=this.modelName,this.invocationKwargs=(e==null?void 0:e.invocationKwargs)??{},this.temperature=(e==null?void 0:e.temperature)??this.temperature,this.topK=(e==null?void 0:e.topK)??this.topK,this.topP=(e==null?void 0:e.topP)??this.topP,this.maxTokens=(e==null?void 0:e.maxTokensToSample)??(e==null?void 0:e.maxTokens)??this.maxTokens,this.stopSequences=(e==null?void 0:e.stopSequences)??this.stopSequences,this.streaming=(e==null?void 0:e.streaming)??!1,this.streamUsage=(e==null?void 0:e.streamUsage)??this.streamUsage,this.thinking=(e==null?void 0:e.thinking)??this.thinking,this.createClient=(e==null?void 0:e.createClient)??(t=>new rt(t))}getLsParams(e){const t=this.invocationParams(e);return{ls_provider:"anthropic",ls_model_name:this.model,ls_model_type:"chat",ls_temperature:t.temperature??void 0,ls_max_tokens:t.max_tokens??void 0,ls_stop:e.stop}}formatStructuredToolToAnthropic(e){if(!(!e||!e.length))return e.map(t=>{if(tQ(t))return t;if(Zp(t))return{name:t.function.name,description:t.function.description,input_schema:t.function.parameters};if(Uf(t))return{name:t.name,description:t.description,input_schema:au(t.schema)};throw new Error(`Unknown tool type passed to ChatAnthropic: ${JSON.stringify(t,null,2)}`)})}bindTools(e,t){return this.bind({tools:this.formatStructuredToolToAnthropic(e),...t})}invocationParams(e){const t=WZ(e==null?void 0:e.tool_choice);if(this.thinking.type==="enabled"){if(this.topK!==-1)throw new Error("topK is not supported when thinking is enabled");if(this.topP!==-1)throw new Error("topP is not supported when thinking is enabled");if(this.temperature!==1)throw new Error("temperature is not supported when thinking is enabled");return{model:this.model,stop_sequences:(e==null?void 0:e.stop)??this.stopSequences,stream:this.streaming,max_tokens:this.maxTokens,tools:this.formatStructuredToolToAnthropic(e==null?void 0:e.tools),tool_choice:t,thinking:this.thinking,...this.invocationKwargs}}return{model:this.model,temperature:this.temperature,top_k:this.topK,top_p:this.topP,stop_sequences:(e==null?void 0:e.stop)??this.stopSequences,stream:this.streaming,max_tokens:this.maxTokens,tools:this.formatStructuredToolToAnthropic(e==null?void 0:e.tools),tool_choice:t,thinking:this.thinking,...this.invocationKwargs}}_identifyingParams(){return{model_name:this.model,...this.invocationParams()}}identifyingParams(){return{model_name:this.model,...this.invocationParams()}}async*_streamResponseChunks(e,t,r){var l;const n=this.invocationParams(t),i=k1(e),o={...n,...i,stream:!0},s=!QZ(o)&&!YZ(o)&&!eQ(o),u=await this.createStreamWithRetry(o,{headers:t.headers});for await(const c of u){if((l=t.signal)!=null&&l.aborted)throw u.controller.abort(),new Error("AbortError: User aborted the request.");const f=this.streamUsage??t.streamUsage,p=XZ(c,{streamUsage:f,coerceContentToString:s});if(!p)continue;const{chunk:h}=p,y=rQ(h),d=new rr({message:new it({content:h.content,additional_kwargs:h.additional_kwargs,tool_call_chunks:h.tool_call_chunks,usage_metadata:f?h.usage_metadata:void 0,response_metadata:h.response_metadata,id:h.id}),text:y??""});yield d,await(r==null?void 0:r.handleLLMNewToken(y??"",void 0,void 0,void 0,void 0,{chunk:d}))}}async _generateNonStreaming(e,t,r){const n=await this.completionWithRetry({...t,stream:!1,...k1(e)},r),{content:i,...o}=n,s=ZZ(i,o),{role:u,type:l,...c}=o;return{generations:s,llmOutput:c}}async _generate(e,t,r){if(this.stopSequences&&t.stop)throw new Error('"stopSequence" parameter found in input and default params');const n=this.invocationParams(t);if(n.stream){let i;const o=this._streamResponseChunks(e,t,r);for await(const s of o)i===void 0?i=s:i=i.concat(s);if(i===void 0)throw new Error("No chunks returned from Anthropic API.");return{generations:[{text:i.text,message:i.message}]}}else return this._generateNonStreaming(e,n,{signal:t.signal,headers:t.headers})}async createStreamWithRetry(e,t){if(!this.streamingClient){const n=this.apiUrl?{baseURL:this.apiUrl}:void 0;this.streamingClient=this.createClient({dangerouslyAllowBrowser:!0,...this.clientOptions,...n,apiKey:this.apiKey,maxRetries:0})}const r=async()=>{try{return await this.streamingClient.messages.create({...e,...this.invocationKwargs,stream:!0},t)}catch(n){throw H1(n)}};return this.caller.call(r)}async completionWithRetry(e,t){if(!this.batchClient){const n=this.apiUrl?{baseURL:this.apiUrl}:void 0;this.batchClient=this.createClient({dangerouslyAllowBrowser:!0,...this.clientOptions,...n,apiKey:this.apiKey,maxRetries:0})}const r=async()=>{try{return await this.batchClient.messages.create({...e,...this.invocationKwargs},t)}catch(n){throw H1(n)}};return this.caller.callWithOptions({signal:t.signal??void 0},r)}_llmType(){return"anthropic"}withStructuredOutput(e,t){var y;const r=e,n=t==null?void 0:t.name,i=t==null?void 0:t.method,o=t==null?void 0:t.includeRaw;if(i==="jsonMode")throw new Error('Anthropic only supports "functionCalling" as a method.');let s=n??"extract",u,l;if(jf(r)){const d=au(r);l=[{name:s,description:d.description??"A function available to call.",input_schema:d}],u=new L1({returnSingle:!0,keyName:s,zodSchema:r})}else{let d;typeof r.name=="string"&&typeof r.description=="string"&&typeof r.input_schema=="object"&&r.input_schema!=null?(d=r,s=r.name):d={name:s,description:r.description??"",input_schema:r},l=[d],u=new L1({returnSingle:!0,keyName:s})}let c;if(((y=this.thinking)==null?void 0:y.type)==="enabled"){const d="Anthropic structured output relies on forced tool calling, which is not supported when `thinking` is enabled. This method will raise OutputParserException if tool calls are not generated. Consider disabling `thinking` or adjust your prompt to ensure the tool is called.";console.warn(d),c=this.bind({tools:l});const _=m=>{if(!m.tool_calls||m.tool_calls.length===0)throw new Error(d);return m};c=c.pipe(_)}else c=this.bind({tools:l,tool_choice:{type:"tool",name:s}});if(!o)return c.pipe(u).withConfig({runName:"ChatAnthropicStructuredOutput"});const f=ou.assign({parsed:(d,_)=>u.invoke(d.raw,_)}),p=ou.assign({parsed:()=>null}),h=f.withFallbacks({fallbacks:[p]});return mr.from([{raw:c},h]).withConfig({runName:"StructuredOutputRunnable"})}}class iQ extends nQ{}class aQ extends pC{static lc_name(){return"ChatFireworks"}_llmType(){return"fireworks"}get lc_secrets(){return{fireworksApiKey:"FIREWORKS_API_KEY",apiKey:"FIREWORKS_API_KEY"}}constructor(e){const t=(e==null?void 0:e.apiKey)||(e==null?void 0:e.fireworksApiKey)||We("FIREWORKS_API_KEY");if(!t)throw new Error('Fireworks API key not found. Please set the FIREWORKS_API_KEY environment variable or provide the key into "fireworksApiKey"');super({...e,model:(e==null?void 0:e.model)||(e==null?void 0:e.modelName)||"accounts/fireworks/models/llama-v3p1-8b-instruct",apiKey:t,configuration:{baseURL:"https://api.fireworks.ai/inference/v1"},streamUsage:!1}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"fireworksApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.fireworksApiKey=t,this.apiKey=t}getLsParams(e){const t=super.getLsParams(e);return t.ls_provider="fireworks",t}toJSON(){const e=super.toJSON();return"kwargs"in e&&typeof e.kwargs=="object"&&e.kwargs!=null&&(delete e.kwargs.openai_api_key,delete e.kwargs.configuration),e}async completionWithRetry(e,t){return delete e.frequency_penalty,delete e.presence_penalty,delete e.logit_bias,delete e.functions,e.stream===!0?super.completionWithRetry(e,t):super.completionWithRetry(e,t)}}function oQ(a){return a!=null&&typeof a=="object"&&"on"in a}async function sQ(a,e){if(oQ(a))return new Promise(r=>{a.on("readable",()=>{let n;for(;;){if(n=a.read(),n==null){e(new Uint8Array,!0);break}e(n)}r()})});const t=a.getReader();for(;;){const r=await t.read();if(r.done){e(new Uint8Array,!0);break}e(r.value)}}function uQ(a){let e,t,r,n=!1;return function(o,s){if(s){a(o,0,!0);return}e===void 0?(e=o,t=0,r=-1):e=cQ(e,o);const u=e.length;let l=0;for(;t<u;){n&&(e[t]===10&&(l=++t),n=!1);let c=-1;for(;t<u&&c===-1;++t)switch(e[t]){case 58:r===-1&&(r=t-l);break;case 13:n=!0;case 10:c=t;break}if(c===-1)break;a(e.subarray(l,c),r),l=t,r=-1}l===u?e=void 0:l!==0&&(e=e.subarray(l),t-=l)}}function lQ(a,e,t){let r=Bg();const n=new TextDecoder;return function(o,s,u){if(u){dQ(r)||(a==null||a(r),r=Bg());return}if(o.length===0)a==null||a(r),r=Bg();else if(s>0){const l=n.decode(o.subarray(0,s)),c=s+(o[s+1]===32?2:1),f=n.decode(o.subarray(c));switch(l){case"data":r.data=r.data?r.data+`
`+f:f;break;case"event":r.event=f;break}}}}function cQ(a,e){const t=new Uint8Array(a.length+e.length);return t.set(a),t.set(e,a.length),t}function Bg(){return{data:"",event:"",id:"",retry:void 0}}function fQ(a){const e=new ReadableStream({async start(t){const r=lQ(i=>{i.data&&t.enqueue(i.data)});await sQ(a,uQ((i,o,s)=>{r(i,o,s),s&&t.close()}))}});return ir.fromReadableStream(e)}function dQ(a){return a.data===""&&a.event===""&&a.id===""&&a.retry===void 0}class hQ extends z3{static lc_name(){return"TogetherAI"}constructor(e){super(e),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"temperature",{enumerable:!0,configurable:!0,writable:!0,value:.7}),Object.defineProperty(this,"topP",{enumerable:!0,configurable:!0,writable:!0,value:.7}),Object.defineProperty(this,"topK",{enumerable:!0,configurable:!0,writable:!0,value:50}),Object.defineProperty(this,"modelName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"model",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"streaming",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"repetitionPenalty",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"logprobs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxTokens",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"safetyModel",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stop",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"inferenceAPIUrl",{enumerable:!0,configurable:!0,writable:!0,value:"https://api.together.xyz/inference"});const t=e.apiKey??We("TOGETHER_AI_API_KEY");if(!t)throw new Error("TOGETHER_AI_API_KEY not found.");if(!e.model&&!e.modelName)throw new Error("Model name is required for TogetherAI.");this.apiKey=t,this.temperature=(e==null?void 0:e.temperature)??this.temperature,this.topK=(e==null?void 0:e.topK)??this.topK,this.topP=(e==null?void 0:e.topP)??this.topP,this.modelName=e.model??e.modelName??"",this.model=this.modelName,this.streaming=e.streaming??this.streaming,this.repetitionPenalty=e.repetitionPenalty??this.repetitionPenalty,this.logprobs=e.logprobs,this.safetyModel=e.safetyModel,this.maxTokens=e.maxTokens,this.stop=e.stop}_llmType(){return"together_ai"}constructHeaders(){return{accept:"application/json","content-type":"application/json",Authorization:`Bearer ${this.apiKey}`}}constructBody(e,t){return{model:(t==null?void 0:t.model)??(t==null?void 0:t.modelName)??(this==null?void 0:this.model),prompt:e,temperature:(this==null?void 0:this.temperature)??(t==null?void 0:t.temperature),top_k:(this==null?void 0:this.topK)??(t==null?void 0:t.topK),top_p:(this==null?void 0:this.topP)??(t==null?void 0:t.topP),repetition_penalty:(this==null?void 0:this.repetitionPenalty)??(t==null?void 0:t.repetitionPenalty),logprobs:(this==null?void 0:this.logprobs)??(t==null?void 0:t.logprobs),stream_tokens:this==null?void 0:this.streaming,safety_model:(this==null?void 0:this.safetyModel)??(t==null?void 0:t.safetyModel),max_tokens:(this==null?void 0:this.maxTokens)??(t==null?void 0:t.maxTokens),stop:(this==null?void 0:this.stop)??(t==null?void 0:t.stop)}}async completionWithRetry(e,t){return this.caller.call(async()=>{const r=await fetch(this.inferenceAPIUrl,{method:"POST",headers:{...this.constructHeaders()},body:JSON.stringify(this.constructBody(e,t))});if(r.status===200)return r.json();const n=await r.json();throw new Error(`Error getting prompt completion from Together AI. ${JSON.stringify(n,null,2)}`)})}async _call(e,t){var n,i,o;const r=await this.completionWithRetry(e,t);return r.output?((n=r.output.choices[0])==null?void 0:n.text)??"":((o=(i=r.choices)==null?void 0:i[0])==null?void 0:o.text)??""}async*_streamResponseChunks(e,t,r){const n=await fetch(this.inferenceAPIUrl,{method:"POST",headers:{...this.constructHeaders()},body:JSON.stringify(this.constructBody(e,t))});if(n.status!==200){const o=await n.json();throw new Error(`Error getting prompt completion from Together AI. ${JSON.stringify(o,null,2)}`)}const i=fQ(n.body);for await(const o of i)if(o!=="[DONE]"){const s=JSON.parse(o),u=new Ru({text:s.choices[0].text??""});yield u,r==null||r.handleLLMNewToken(u.text??"")}}}var W1;(function(a){a.STRING="string",a.NUMBER="number",a.INTEGER="integer",a.BOOLEAN="boolean",a.ARRAY="array",a.OBJECT="object"})(W1||(W1={}));/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var K1;(function(a){a.LANGUAGE_UNSPECIFIED="language_unspecified",a.PYTHON="python"})(K1||(K1={}));var J1;(function(a){a.OUTCOME_UNSPECIFIED="outcome_unspecified",a.OUTCOME_OK="outcome_ok",a.OUTCOME_FAILED="outcome_failed",a.OUTCOME_DEADLINE_EXCEEDED="outcome_deadline_exceeded"})(J1||(J1={}));/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X1=["user","model","function","system"];var Z1;(function(a){a.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",a.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",a.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",a.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",a.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT"})(Z1||(Z1={}));var Q1;(function(a){a.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",a.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",a.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",a.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",a.BLOCK_NONE="BLOCK_NONE"})(Q1||(Q1={}));var Y1;(function(a){a.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",a.NEGLIGIBLE="NEGLIGIBLE",a.LOW="LOW",a.MEDIUM="MEDIUM",a.HIGH="HIGH"})(Y1||(Y1={}));var eT;(function(a){a.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",a.SAFETY="SAFETY",a.OTHER="OTHER"})(eT||(eT={}));var op;(function(a){a.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",a.STOP="STOP",a.MAX_TOKENS="MAX_TOKENS",a.SAFETY="SAFETY",a.RECITATION="RECITATION",a.LANGUAGE="LANGUAGE",a.OTHER="OTHER"})(op||(op={}));var tT;(function(a){a.TASK_TYPE_UNSPECIFIED="TASK_TYPE_UNSPECIFIED",a.RETRIEVAL_QUERY="RETRIEVAL_QUERY",a.RETRIEVAL_DOCUMENT="RETRIEVAL_DOCUMENT",a.SEMANTIC_SIMILARITY="SEMANTIC_SIMILARITY",a.CLASSIFICATION="CLASSIFICATION",a.CLUSTERING="CLUSTERING"})(tT||(tT={}));var sf;(function(a){a.MODE_UNSPECIFIED="MODE_UNSPECIFIED",a.AUTO="AUTO",a.ANY="ANY",a.NONE="NONE"})(sf||(sf={}));var rT;(function(a){a.MODE_UNSPECIFIED="MODE_UNSPECIFIED",a.MODE_DYNAMIC="MODE_DYNAMIC"})(rT||(rT={}));/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tr extends Error{constructor(e){super(`[GoogleGenerativeAI Error]: ${e}`)}}class Hc extends tr{constructor(e,t){super(e),this.response=t}}class l8 extends tr{constructor(e,t,r,n){super(e),this.status=t,this.statusText=r,this.errorDetails=n}}class Vu extends tr{}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pQ="https://generativelanguage.googleapis.com",_Q="v1beta",yQ="0.21.0",bQ="genai-js";var jc;(function(a){a.GENERATE_CONTENT="generateContent",a.STREAM_GENERATE_CONTENT="streamGenerateContent",a.COUNT_TOKENS="countTokens",a.EMBED_CONTENT="embedContent",a.BATCH_EMBED_CONTENTS="batchEmbedContents"})(jc||(jc={}));class mQ{constructor(e,t,r,n,i){this.model=e,this.task=t,this.apiKey=r,this.stream=n,this.requestOptions=i}toString(){var e,t;const r=((e=this.requestOptions)===null||e===void 0?void 0:e.apiVersion)||_Q;let i=`${((t=this.requestOptions)===null||t===void 0?void 0:t.baseUrl)||pQ}/${r}/${this.model}:${this.task}`;return this.stream&&(i+="?alt=sse"),i}}function gQ(a){const e=[];return a!=null&&a.apiClient&&e.push(a.apiClient),e.push(`${bQ}/${yQ}`),e.join(" ")}async function vQ(a){var e;const t=new Headers;t.append("Content-Type","application/json"),t.append("x-goog-api-client",gQ(a.requestOptions)),t.append("x-goog-api-key",a.apiKey);let r=(e=a.requestOptions)===null||e===void 0?void 0:e.customHeaders;if(r){if(!(r instanceof Headers))try{r=new Headers(r)}catch(n){throw new Vu(`unable to convert customHeaders value ${JSON.stringify(r)} to Headers: ${n.message}`)}for(const[n,i]of r.entries()){if(n==="x-goog-api-key")throw new Vu(`Cannot set reserved header name ${n}`);if(n==="x-goog-api-client")throw new Vu(`Header name ${n} can only be set using the apiClient field`);t.append(n,i)}}return t}async function wQ(a,e,t,r,n,i){const o=new mQ(a,e,t,r,i);return{url:o.toString(),fetchOptions:Object.assign(Object.assign({},RQ(i)),{method:"POST",headers:await vQ(o),body:n})}}async function e_(a,e,t,r,n,i={},o=fetch){const{url:s,fetchOptions:u}=await wQ(a,e,t,r,n,i);return OQ(s,u,o)}async function OQ(a,e,t=fetch){let r;try{r=await t(a,e)}catch(n){SQ(n,a)}return r.ok||await EQ(r,a),r}function SQ(a,e){let t=a;throw a instanceof l8||a instanceof Vu||(t=new tr(`Error fetching from ${e.toString()}: ${a.message}`),t.stack=a.stack),t}async function EQ(a,e){let t="",r;try{const n=await a.json();t=n.error.message,n.error.details&&(t+=` ${JSON.stringify(n.error.details)}`,r=n.error.details)}catch{}throw new l8(`Error fetching from ${e.toString()}: [${a.status} ${a.statusText}] ${t}`,a.status,a.statusText,r)}function RQ(a){const e={};if((a==null?void 0:a.signal)!==void 0||(a==null?void 0:a.timeout)>=0){const t=new AbortController;(a==null?void 0:a.timeout)>=0&&setTimeout(()=>t.abort(),a.timeout),a!=null&&a.signal&&a.signal.addEventListener("abort",()=>{t.abort()}),e.signal=t.signal}return e}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RC(a){return a.text=()=>{if(a.candidates&&a.candidates.length>0){if(a.candidates.length>1&&console.warn(`This response had ${a.candidates.length} candidates. Returning text from the first candidate only. Access response.candidates directly to use the other candidates.`),dy(a.candidates[0]))throw new Hc(`${qu(a)}`,a);return CQ(a)}else if(a.promptFeedback)throw new Hc(`Text not available. ${qu(a)}`,a);return""},a.functionCall=()=>{if(a.candidates&&a.candidates.length>0){if(a.candidates.length>1&&console.warn(`This response had ${a.candidates.length} candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates.`),dy(a.candidates[0]))throw new Hc(`${qu(a)}`,a);return console.warn("response.functionCall() is deprecated. Use response.functionCalls() instead."),nT(a)[0]}else if(a.promptFeedback)throw new Hc(`Function call not available. ${qu(a)}`,a)},a.functionCalls=()=>{if(a.candidates&&a.candidates.length>0){if(a.candidates.length>1&&console.warn(`This response had ${a.candidates.length} candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates.`),dy(a.candidates[0]))throw new Hc(`${qu(a)}`,a);return nT(a)}else if(a.promptFeedback)throw new Hc(`Function call not available. ${qu(a)}`,a)},a}function CQ(a){var e,t,r,n;const i=[];if(!((t=(e=a.candidates)===null||e===void 0?void 0:e[0].content)===null||t===void 0)&&t.parts)for(const o of(n=(r=a.candidates)===null||r===void 0?void 0:r[0].content)===null||n===void 0?void 0:n.parts)o.text&&i.push(o.text),o.executableCode&&i.push("\n```"+o.executableCode.language+`
`+o.executableCode.code+"\n```\n"),o.codeExecutionResult&&i.push("\n```\n"+o.codeExecutionResult.output+"\n```\n");return i.length>0?i.join(""):""}function nT(a){var e,t,r,n;const i=[];if(!((t=(e=a.candidates)===null||e===void 0?void 0:e[0].content)===null||t===void 0)&&t.parts)for(const o of(n=(r=a.candidates)===null||r===void 0?void 0:r[0].content)===null||n===void 0?void 0:n.parts)o.functionCall&&i.push(o.functionCall);if(i.length>0)return i}const PQ=[op.RECITATION,op.SAFETY,op.LANGUAGE];function dy(a){return!!a.finishReason&&PQ.includes(a.finishReason)}function qu(a){var e,t,r;let n="";if((!a.candidates||a.candidates.length===0)&&a.promptFeedback)n+="Response was blocked",!((e=a.promptFeedback)===null||e===void 0)&&e.blockReason&&(n+=` due to ${a.promptFeedback.blockReason}`),!((t=a.promptFeedback)===null||t===void 0)&&t.blockReasonMessage&&(n+=`: ${a.promptFeedback.blockReasonMessage}`);else if(!((r=a.candidates)===null||r===void 0)&&r[0]){const i=a.candidates[0];dy(i)&&(n+=`Candidate was blocked due to ${i.finishReason}`,i.finishMessage&&(n+=`: ${i.finishMessage}`))}return n}function Ap(a){return this instanceof Ap?(this.v=a,this):new Ap(a)}function jQ(a,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(a,e||[]),n,i=[];return n={},o("next"),o("throw"),o("return"),n[Symbol.asyncIterator]=function(){return this},n;function o(p){r[p]&&(n[p]=function(h){return new Promise(function(y,d){i.push([p,h,y,d])>1||s(p,h)})})}function s(p,h){try{u(r[p](h))}catch(y){f(i[0][3],y)}}function u(p){p.value instanceof Ap?Promise.resolve(p.value.v).then(l,c):f(i[0][2],p)}function l(p){s("next",p)}function c(p){s("throw",p)}function f(p,h){p(h),i.shift(),i.length&&s(i[0][0],i[0][1])}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iT=/^data\: (.*)(?:\n\n|\r\r|\r\n\r\n)/;function TQ(a){const e=a.body.pipeThrough(new TextDecoderStream("utf8",{fatal:!0})),t=IQ(e),[r,n]=t.tee();return{stream:AQ(r),response:MQ(n)}}async function MQ(a){const e=[],t=a.getReader();for(;;){const{done:r,value:n}=await t.read();if(r)return RC(DQ(e));e.push(n)}}function AQ(a){return jQ(this,arguments,function*(){const t=a.getReader();for(;;){const{value:r,done:n}=yield Ap(t.read());if(n)break;yield yield Ap(RC(r))}})}function IQ(a){const e=a.getReader();return new ReadableStream({start(r){let n="";return i();function i(){return e.read().then(({value:o,done:s})=>{if(s){if(n.trim()){r.error(new tr("Failed to parse stream"));return}r.close();return}n+=o;let u=n.match(iT),l;for(;u;){try{l=JSON.parse(u[1])}catch{r.error(new tr(`Error parsing JSON response: "${u[1]}"`));return}r.enqueue(l),n=n.substring(u[0].length),u=n.match(iT)}return i()})}}})}function DQ(a){const e=a[a.length-1],t={promptFeedback:e==null?void 0:e.promptFeedback};for(const r of a){if(r.candidates)for(const n of r.candidates){const i=n.index;if(t.candidates||(t.candidates=[]),t.candidates[i]||(t.candidates[i]={index:n.index}),t.candidates[i].citationMetadata=n.citationMetadata,t.candidates[i].groundingMetadata=n.groundingMetadata,t.candidates[i].finishReason=n.finishReason,t.candidates[i].finishMessage=n.finishMessage,t.candidates[i].safetyRatings=n.safetyRatings,n.content&&n.content.parts){t.candidates[i].content||(t.candidates[i].content={role:n.content.role||"user",parts:[]});const o={};for(const s of n.content.parts)s.text&&(o.text=s.text),s.functionCall&&(o.functionCall=s.functionCall),s.executableCode&&(o.executableCode=s.executableCode),s.codeExecutionResult&&(o.codeExecutionResult=s.codeExecutionResult),Object.keys(o).length===0&&(o.text=""),t.candidates[i].content.parts.push(o)}}r.usageMetadata&&(t.usageMetadata=r.usageMetadata)}return t}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function c8(a,e,t,r){const n=await e_(e,jc.STREAM_GENERATE_CONTENT,a,!0,JSON.stringify(t),r);return TQ(n)}async function f8(a,e,t,r){const i=await(await e_(e,jc.GENERATE_CONTENT,a,!1,JSON.stringify(t),r)).json();return{response:RC(i)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function d8(a){if(a!=null){if(typeof a=="string")return{role:"system",parts:[{text:a}]};if(a.text)return{role:"system",parts:[a]};if(a.parts)return a.role?a:{role:"system",parts:a.parts}}}function Ip(a){let e=[];if(typeof a=="string")e=[{text:a}];else for(const t of a)typeof t=="string"?e.push({text:t}):e.push(t);return xQ(e)}function xQ(a){const e={role:"user",parts:[]},t={role:"function",parts:[]};let r=!1,n=!1;for(const i of a)"functionResponse"in i?(t.parts.push(i),n=!0):(e.parts.push(i),r=!0);if(r&&n)throw new tr("Within a single message, FunctionResponse cannot be mixed with other type of part in the request for sending chat message.");if(!r&&!n)throw new tr("No content is provided for sending chat message.");return r?e:t}function $Q(a,e){var t;let r={model:e==null?void 0:e.model,generationConfig:e==null?void 0:e.generationConfig,safetySettings:e==null?void 0:e.safetySettings,tools:e==null?void 0:e.tools,toolConfig:e==null?void 0:e.toolConfig,systemInstruction:e==null?void 0:e.systemInstruction,cachedContent:(t=e==null?void 0:e.cachedContent)===null||t===void 0?void 0:t.name,contents:[]};const n=a.generateContentRequest!=null;if(a.contents){if(n)throw new Vu("CountTokensRequest must have one of contents or generateContentRequest, not both.");r.contents=a.contents}else if(n)r=Object.assign(Object.assign({},r),a.generateContentRequest);else{const i=Ip(a);r.contents=[i]}return{generateContentRequest:r}}function aT(a){let e;return a.contents?e=a:e={contents:[Ip(a)]},a.systemInstruction&&(e.systemInstruction=d8(a.systemInstruction)),e}function NQ(a){return typeof a=="string"||Array.isArray(a)?{content:Ip(a)}:a}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oT=["text","inlineData","functionCall","functionResponse","executableCode","codeExecutionResult"],qQ={user:["text","inlineData"],function:["functionResponse"],model:["text","functionCall","executableCode","codeExecutionResult"],system:["text"]};function zQ(a){let e=!1;for(const t of a){const{role:r,parts:n}=t;if(!e&&r!=="user")throw new tr(`First content should be with role 'user', got ${r}`);if(!X1.includes(r))throw new tr(`Each item should include role field. Got ${r} but valid roles are: ${JSON.stringify(X1)}`);if(!Array.isArray(n))throw new tr("Content should have 'parts' property with an array of Parts");if(n.length===0)throw new tr("Each Content should have at least one part");const i={text:0,inlineData:0,functionCall:0,functionResponse:0,fileData:0,executableCode:0,codeExecutionResult:0};for(const s of n)for(const u of oT)u in s&&(i[u]+=1);const o=qQ[r];for(const s of oT)if(!o.includes(s)&&i[s]>0)throw new tr(`Content with role '${r}' can't contain '${s}' part`);e=!0}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sT="SILENT_ERROR";class BQ{constructor(e,t,r,n={}){this.model=t,this.params=r,this._requestOptions=n,this._history=[],this._sendPromise=Promise.resolve(),this._apiKey=e,r!=null&&r.history&&(zQ(r.history),this._history=r.history)}async getHistory(){return await this._sendPromise,this._history}async sendMessage(e,t={}){var r,n,i,o,s,u;await this._sendPromise;const l=Ip(e),c={safetySettings:(r=this.params)===null||r===void 0?void 0:r.safetySettings,generationConfig:(n=this.params)===null||n===void 0?void 0:n.generationConfig,tools:(i=this.params)===null||i===void 0?void 0:i.tools,toolConfig:(o=this.params)===null||o===void 0?void 0:o.toolConfig,systemInstruction:(s=this.params)===null||s===void 0?void 0:s.systemInstruction,cachedContent:(u=this.params)===null||u===void 0?void 0:u.cachedContent,contents:[...this._history,l]},f=Object.assign(Object.assign({},this._requestOptions),t);let p;return this._sendPromise=this._sendPromise.then(()=>f8(this._apiKey,this.model,c,f)).then(h=>{var y;if(h.response.candidates&&h.response.candidates.length>0){this._history.push(l);const d=Object.assign({parts:[],role:"model"},(y=h.response.candidates)===null||y===void 0?void 0:y[0].content);this._history.push(d)}else{const d=qu(h.response);d&&console.warn(`sendMessage() was unsuccessful. ${d}. Inspect response object for details.`)}p=h}),await this._sendPromise,p}async sendMessageStream(e,t={}){var r,n,i,o,s,u;await this._sendPromise;const l=Ip(e),c={safetySettings:(r=this.params)===null||r===void 0?void 0:r.safetySettings,generationConfig:(n=this.params)===null||n===void 0?void 0:n.generationConfig,tools:(i=this.params)===null||i===void 0?void 0:i.tools,toolConfig:(o=this.params)===null||o===void 0?void 0:o.toolConfig,systemInstruction:(s=this.params)===null||s===void 0?void 0:s.systemInstruction,cachedContent:(u=this.params)===null||u===void 0?void 0:u.cachedContent,contents:[...this._history,l]},f=Object.assign(Object.assign({},this._requestOptions),t),p=c8(this._apiKey,this.model,c,f);return this._sendPromise=this._sendPromise.then(()=>p).catch(h=>{throw new Error(sT)}).then(h=>h.response).then(h=>{if(h.candidates&&h.candidates.length>0){this._history.push(l);const y=Object.assign({},h.candidates[0].content);y.role||(y.role="model"),this._history.push(y)}else{const y=qu(h);y&&console.warn(`sendMessageStream() was unsuccessful. ${y}. Inspect response object for details.`)}}).catch(h=>{h.message!==sT&&console.error(h)}),p}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function UQ(a,e,t,r){return(await e_(e,jc.COUNT_TOKENS,a,!1,JSON.stringify(t),r)).json()}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function FQ(a,e,t,r){return(await e_(e,jc.EMBED_CONTENT,a,!1,JSON.stringify(t),r)).json()}async function LQ(a,e,t,r){const n=t.requests.map(o=>Object.assign(Object.assign({},o),{model:e}));return(await e_(e,jc.BATCH_EMBED_CONTENTS,a,!1,JSON.stringify({requests:n}),r)).json()}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uT{constructor(e,t,r={}){this.apiKey=e,this._requestOptions=r,t.model.includes("/")?this.model=t.model:this.model=`models/${t.model}`,this.generationConfig=t.generationConfig||{},this.safetySettings=t.safetySettings||[],this.tools=t.tools,this.toolConfig=t.toolConfig,this.systemInstruction=d8(t.systemInstruction),this.cachedContent=t.cachedContent}async generateContent(e,t={}){var r;const n=aT(e),i=Object.assign(Object.assign({},this._requestOptions),t);return f8(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(r=this.cachedContent)===null||r===void 0?void 0:r.name},n),i)}async generateContentStream(e,t={}){var r;const n=aT(e),i=Object.assign(Object.assign({},this._requestOptions),t);return c8(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(r=this.cachedContent)===null||r===void 0?void 0:r.name},n),i)}startChat(e){var t;return new BQ(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(t=this.cachedContent)===null||t===void 0?void 0:t.name},e),this._requestOptions)}async countTokens(e,t={}){const r=$Q(e,{model:this.model,generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:this.cachedContent}),n=Object.assign(Object.assign({},this._requestOptions),t);return UQ(this.apiKey,this.model,r,n)}async embedContent(e,t={}){const r=NQ(e),n=Object.assign(Object.assign({},this._requestOptions),t);return FQ(this.apiKey,this.model,r,n)}async batchEmbedContents(e,t={}){const r=Object.assign(Object.assign({},this._requestOptions),t);return LQ(this.apiKey,this.model,e,r)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lT{constructor(e){this.apiKey=e}getGenerativeModel(e,t){if(!e.model)throw new tr("Must provide a model name. Example: genai.getGenerativeModel({ model: 'my-model-name' })");return new uT(this.apiKey,e,t)}getGenerativeModelFromCachedContent(e,t,r){if(!e.name)throw new Vu("Cached content must contain a `name` field.");if(!e.model)throw new Vu("Cached content must contain a `model` field.");const n=["model","systemInstruction"];for(const o of n)if(t!=null&&t[o]&&e[o]&&(t==null?void 0:t[o])!==e[o]){if(o==="model"){const s=t.model.startsWith("models/")?t.model.replace("models/",""):t.model,u=e.model.startsWith("models/")?e.model.replace("models/",""):e.model;if(s===u)continue}throw new Vu(`Different value for "${o}" specified in modelParams (${t[o]}) and cachedContent (${e[o]})`)}const i=Object.assign(Object.assign({},t),{model:e.model,tools:e.tools,toolConfig:e.toolConfig,systemInstruction:e.systemInstruction,cachedContent:e});return new uT(this.apiKey,i,r)}}function Dp(a){if(typeof a=="object"&&a!==null){const e={...a};"additionalProperties"in e&&delete e.additionalProperties,"$schema"in e&&delete e.$schema;for(const t in e)t in e&&(Array.isArray(e[t])?e[t]=e[t].map(Dp):typeof e[t]=="object"&&e[t]!==null&&(e[t]=Dp(e[t])));return e}return a}function h8(a){const e=Dp(au(a)),{$schema:t,...r}=e;return r}function VQ(a){const e=Dp(a),{$schema:t,...r}=e;return r}function GQ(a){const e=a._getType();return Ac.isInstance(a)?a.role:e==="tool"?e:a.name??e}function kQ(a){switch(a){case"ai":case"model":return"model";case"system":return"system";case"human":return"user";case"tool":case"function":return"function";default:throw new Error(`Unknown / unsupported author: ${a}`)}}function HQ(a){if("mimeType"in a&&"data"in a)return{inlineData:{mimeType:a.mimeType,data:a.data}};if("mimeType"in a&&"fileUri"in a)return{fileData:{mimeType:a.mimeType,fileUri:a.fileUri}};throw new Error("Invalid media content")}function WQ(a,e){if(typeof a.content=="string"&&a.content!=="")return[{text:a.content}];let t=[],r=[],n=[];return"tool_calls"in a&&Array.isArray(a.tool_calls)&&a.tool_calls.length>0?t=a.tool_calls.map(i=>({functionCall:{name:i.name,args:i.args}})):a.getType()==="tool"&&a.name&&a.content?r=[{functionResponse:{name:a.name,response:a.content}}]:Array.isArray(a.content)&&(n=a.content.map(i=>{var o;if(i.type==="text")return{text:i.text};if(i.type==="executableCode")return{executableCode:i.executableCode};if(i.type==="codeExecutionResult")return{codeExecutionResult:i.codeExecutionResult};if(i.type==="image_url"){if(!e)throw new Error("This model does not support images");let s;if(typeof i.image_url=="string")s=i.image_url;else if(typeof i.image_url=="object"&&"url"in i.image_url)s=i.image_url.url;else throw new Error("Please provide image as base64 encoded data URL");const[u,l]=s.split(",");if(!u.startsWith("data:"))throw new Error("Please provide image as base64 encoded data URL");const[c,f]=u.replace(/^data:/,"").split(";");if(f!=="base64")throw new Error("Please provide image as base64 encoded data URL");return{inlineData:{data:l,mimeType:c}}}else{if(i.type==="media")return HQ(i);if(i.type==="tool_use")return{functionCall:{name:i.name,args:i.input}};if((o=i.type)!=null&&o.includes("/")&&i.type.split("/").length===2&&"data"in i&&typeof i.data=="string")return{inlineData:{mimeType:i.type,data:i.data}}}throw new Error(`Unknown content type ${i.type}`)})),[...n,...t,...r]}function cT(a,e,t=!1){return a.reduce((r,n,i)=>{if(!If(n))throw new Error("Unsupported message input");const o=GQ(n);if(o==="system"&&i!==0)throw new Error("System message should be the first one");const s=kQ(o),u=r.content[r.content.length];if(!r.mergeWithPreviousContent&&u&&u.role===s)throw new Error("Google Generative AI requires alternate messages between authors");const l=WQ(n,e);if(r.mergeWithPreviousContent){const p=r.content[r.content.length-1];if(!p)throw new Error("There was a problem parsing your system message. Please try a prompt without one.");return p.parts.push(...l),{mergeWithPreviousContent:!1,content:r.content}}let c=s;(c==="function"||c==="system"&&!t)&&(c="user");const f={role:c,parts:l};return{mergeWithPreviousContent:o==="system"&&!t,content:[...r.content,f]}},{content:[],mergeWithPreviousContent:!1}).content}function KQ(a,e){var l,c,f;if(!a.candidates||a.candidates.length===0||!a.candidates[0])return{generations:[],llmOutput:{filters:a.promptFeedback}};const t=a.functionCalls(),[r]=a.candidates,{content:n,...i}=r;let o;(n==null?void 0:n.parts.length)===1&&n.parts[0].text?o=n.parts[0].text:o=n.parts.map(p=>"text"in p?{type:"text",text:p.text}:"executableCode"in p?{type:"executableCode",executableCode:p.executableCode}:"codeExecutionResult"in p?{type:"codeExecutionResult",codeExecutionResult:p.codeExecutionResult}:p);let s="";return typeof o=="string"?s=o:"text"in o[0]&&(s=o[0].text),{generations:[{text:s,message:new Hs({content:o,tool_calls:t==null?void 0:t.map(p=>({...p,type:"tool_call"})),additional_kwargs:{...i},usage_metadata:e==null?void 0:e.usageMetadata}),generationInfo:i}],llmOutput:{tokenUsage:{promptTokens:(l=e==null?void 0:e.usageMetadata)==null?void 0:l.input_tokens,completionTokens:(c=e==null?void 0:e.usageMetadata)==null?void 0:c.output_tokens,totalTokens:(f=e==null?void 0:e.usageMetadata)==null?void 0:f.total_tokens}}}}function JQ(a,e){if(!a.candidates||a.candidates.length===0)return null;const t=a.functionCalls(),[r]=a.candidates,{content:n,...i}=r;let o;n!=null&&n.parts&&n.parts.every(l=>"text"in l)?o=n.parts.map(l=>l.text).join(""):n.parts&&(o=n.parts.map(l=>"text"in l?{type:"text",text:l.text}:"executableCode"in l?{type:"executableCode",executableCode:l.executableCode}:"codeExecutionResult"in l?{type:"codeExecutionResult",codeExecutionResult:l.codeExecutionResult}:l));let s="";o&&typeof o=="string"?s=o:o&&typeof o=="object"&&"text"in o[0]&&(s=o[0].text);const u=[];return t&&u.push(...t.map(l=>({...l,args:JSON.stringify(l.args),index:e.index,type:"tool_call_chunk"}))),new rr({text:s,message:new it({content:o||"",name:n?n.role:void 0,tool_call_chunks:u,additional_kwargs:{},usage_metadata:e.usageMetadata}),generationInfo:i})}function XQ(a){return a.every(e=>"functionDeclarations"in e&&Array.isArray(e.functionDeclarations))?a:[{functionDeclarations:a.map(e=>{if(Uf(e)){const t=h8(e.schema);return{name:e.name,description:e.description,parameters:t}}return Zp(e)?{name:e.function.name,description:e.function.description??"A function available to call.",parameters:VQ(e.function.parameters)}:e})}]}class fT extends dC{static lc_name(){return"GoogleGenerativeAIToolsOutputParser"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","google_genai","output_parsers"]}),Object.defineProperty(this,"returnId",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"keyName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"returnSingle",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"zodSchema",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.keyName=e.keyName,this.returnSingle=e.returnSingle??this.returnSingle,this.zodSchema=e.zodSchema}async _validateResult(e){if(this.zodSchema===void 0)return e;const t=await this.zodSchema.safeParseAsync(e);if(t.success)return t.data;throw new Tf(`Failed to parse. Text: "${JSON.stringify(e,null,2)}". Error: ${JSON.stringify(t.error.errors)}`,JSON.stringify(e,null,2))}async parseResult(e){const t=e.flatMap(i=>{const{message:o}=i;return!("tool_calls"in o)||!Array.isArray(o.tool_calls)?[]:o.tool_calls});if(t[0]===void 0)throw new Error("No parseable tool calls provided to GoogleGenerativeAIToolsOutputParser.");const[r]=t;return await this._validateResult(r.args)}}function dT(a,e){const t=ZQ(a),r=YQ(t,e);return{tools:t,toolConfig:r}}function ZQ(a){let e=[];const t=[];return a.forEach(n=>{if(Uf(n)){const[i]=XQ([n]);i.functionDeclarations&&e.push(...i.functionDeclarations)}else if(Zp(n)){const{functionDeclarations:i}=QQ(n);if(i)e.push(...i);else throw new Error("Failed to convert OpenAI structured tool to GenerativeAI tool")}else t.push(n)}),t.find(n=>"functionDeclarations"in n)?t.map(n=>{if((e==null?void 0:e.length)>0&&"functionDeclarations"in n){const i={functionDeclarations:[...n.functionDeclarations||[],...e]};return e=[],i}return n}):[...t,...e.length>0?[{functionDeclarations:e}]:[]]}function QQ(a){return{functionDeclarations:[{name:a.function.name,description:a.function.description,parameters:Dp(a.function.parameters)}]}}function YQ(a,e){if(!a.length||!e)return;const{toolChoice:t,allowedFunctionNames:r}=e,n={any:sf.ANY,auto:sf.AUTO,none:sf.NONE};if(t&&["any","auto","none"].includes(t))return{functionCallingConfig:{mode:n[t]??"MODE_UNSPECIFIED",allowedFunctionNames:r}};if(typeof t=="string"||r)return{functionCallingConfig:{mode:sf.ANY,allowedFunctionNames:[...r??[],...t&&typeof t=="string"?[t]:[]]}}}class eY extends Ar{static lc_name(){return"ChatGoogleGenerativeAI"}get lc_secrets(){return{apiKey:"GOOGLE_API_KEY"}}get lc_aliases(){return{apiKey:"google_api_key"}}get _isMultimodalModel(){return this.model.includes("vision")||this.model.startsWith("gemini-1.5")||this.model.startsWith("gemini-2")}constructor(e){var t,r;if(super(e??{}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","chat_models","google_genai"]}),Object.defineProperty(this,"modelName",{enumerable:!0,configurable:!0,writable:!0,value:"gemini-pro"}),Object.defineProperty(this,"model",{enumerable:!0,configurable:!0,writable:!0,value:"gemini-pro"}),Object.defineProperty(this,"temperature",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxOutputTokens",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"topP",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"topK",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stopSequences",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"safetySettings",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"streaming",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"streamUsage",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"convertSystemMessageToHumanContent",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.modelName=((t=e==null?void 0:e.model)==null?void 0:t.replace(/^models\//,""))??((r=e==null?void 0:e.modelName)==null?void 0:r.replace(/^models\//,""))??this.model,this.model=this.modelName,this.maxOutputTokens=(e==null?void 0:e.maxOutputTokens)??this.maxOutputTokens,this.maxOutputTokens&&this.maxOutputTokens<0)throw new Error("`maxOutputTokens` must be a positive integer");if(this.temperature=(e==null?void 0:e.temperature)??this.temperature,this.temperature&&(this.temperature<0||this.temperature>2))throw new Error("`temperature` must be in the range of [0.0,2.0]");if(this.topP=(e==null?void 0:e.topP)??this.topP,this.topP&&this.topP<0)throw new Error("`topP` must be a positive integer");if(this.topP&&this.topP>1)throw new Error("`topP` must be below 1.");if(this.topK=(e==null?void 0:e.topK)??this.topK,this.topK&&this.topK<0)throw new Error("`topK` must be a positive integer");if(this.stopSequences=(e==null?void 0:e.stopSequences)??this.stopSequences,this.apiKey=(e==null?void 0:e.apiKey)??We("GOOGLE_API_KEY"),!this.apiKey)throw new Error("Please set an API key for Google GenerativeAI in the environment variable GOOGLE_API_KEY or in the `apiKey` field of the ChatGoogleGenerativeAI constructor");if(this.safetySettings=(e==null?void 0:e.safetySettings)??this.safetySettings,this.safetySettings&&this.safetySettings.length>0&&new Set(this.safetySettings.map(i=>i.category)).size!==this.safetySettings.length)throw new Error("The categories in `safetySettings` array must be unique");this.streaming=(e==null?void 0:e.streaming)??this.streaming,this.client=new lT(this.apiKey).getGenerativeModel({model:this.model,safetySettings:this.safetySettings,generationConfig:{candidateCount:1,stopSequences:this.stopSequences,maxOutputTokens:this.maxOutputTokens,temperature:this.temperature,topP:this.topP,topK:this.topK,...e!=null&&e.json?{responseMimeType:"application/json"}:{}}},{apiVersion:e==null?void 0:e.apiVersion,baseUrl:e==null?void 0:e.baseUrl}),this.streamUsage=(e==null?void 0:e.streamUsage)??this.streamUsage}useCachedContent(e,t,r){this.apiKey&&(this.client=new lT(this.apiKey).getGenerativeModelFromCachedContent(e,t,r))}get useSystemInstruction(){return typeof this.convertSystemMessageToHumanContent=="boolean"?!this.convertSystemMessageToHumanContent:this.computeUseSystemInstruction}get computeUseSystemInstruction(){return this.modelName==="gemini-1.0-pro-001"||this.modelName.startsWith("gemini-pro-vision")||this.modelName.startsWith("gemini-1.0-pro-vision")?!1:this.modelName!=="gemini-pro"}getLsParams(e){return{ls_provider:"google_genai",ls_model_name:this.model,ls_model_type:"chat",ls_temperature:this.client.generationConfig.temperature,ls_max_tokens:this.client.generationConfig.maxOutputTokens,ls_stop:e.stop}}_combineLLMOutput(){return[]}_llmType(){return"googlegenerativeai"}bindTools(e,t){var r;return this.bind({tools:(r=dT(e))==null?void 0:r.tools,...t})}invocationParams(e){var r;const t=(r=e==null?void 0:e.tools)!=null&&r.length?dT(e.tools,{toolChoice:e.tool_choice,allowedFunctionNames:e.allowedFunctionNames}):void 0;return{...t!=null&&t.tools?{tools:t.tools}:{},...t!=null&&t.toolConfig?{toolConfig:t.toolConfig}:{}}}async _generate(e,t,r){var c;const n=cT(e,this._isMultimodalModel,this.useSystemInstruction);let i=n;if(n[0].role==="system"){const[f]=n;this.client.systemInstruction=f,i=n.slice(1)}const o=this.invocationParams(t);if(this.streaming){const f={},p=this._streamResponseChunks(e,t,r),h={};for await(const d of p){const _=((c=d.generationInfo)==null?void 0:c.completion)??0;h[_]===void 0?h[_]=d:h[_]=h[_].concat(d)}return{generations:Object.entries(h).sort(([d],[_])=>parseInt(d,10)-parseInt(_,10)).map(([d,_])=>_),llmOutput:{estimatedTokenUsage:f}}}const s=await this.completionWithRetry({...o,contents:i});let u;if("usageMetadata"in s.response){const f=s.response.usageMetadata;u={input_tokens:f.promptTokenCount??0,output_tokens:f.candidatesTokenCount??0,total_tokens:f.totalTokenCount??0}}const l=KQ(s.response,{usageMetadata:u});return await(r==null?void 0:r.handleLLMNewToken(l.generations[0].text??"")),l}async*_streamResponseChunks(e,t,r){const n=cT(e,this._isMultimodalModel,this.useSystemInstruction);let i=n;if(n[0].role==="system"){const[f]=n;this.client.systemInstruction=f,i=n.slice(1)}const s={...this.invocationParams(t),contents:i},u=await this.caller.callWithOptions({signal:t==null?void 0:t.signal},async()=>{const{stream:f}=await this.client.generateContentStream(s);return f});let l,c=0;for await(const f of u){if("usageMetadata"in f&&this.streamUsage!==!1&&t.streamUsage!==!1){const h=f.usageMetadata;if(!l)l={input_tokens:h.promptTokenCount??0,output_tokens:h.candidatesTokenCount??0,total_tokens:h.totalTokenCount??0};else{const y=(h.candidatesTokenCount??0)-l.output_tokens;l={input_tokens:0,output_tokens:y,total_tokens:y}}}const p=JQ(f,{usageMetadata:l,index:c});c+=1,p&&(yield p,await(r==null?void 0:r.handleLLMNewToken(p.text??"")))}}async completionWithRetry(e,t){return this.caller.callWithOptions({signal:t==null?void 0:t.signal},async()=>{var r;try{return await this.client.generateContent(e)}catch(n){throw(r=n.message)!=null&&r.includes("400 Bad Request")&&(n.status=400),n}})}withStructuredOutput(e,t){const r=e,n=t==null?void 0:t.name,i=t==null?void 0:t.method,o=t==null?void 0:t.includeRaw;if(i==="jsonMode")throw new Error('ChatGoogleGenerativeAI only supports "functionCalling" as a method.');let s=n??"extract",u,l;if(jf(r)){const y=h8(r);l=[{functionDeclarations:[{name:s,description:y.description??"A function available to call.",parameters:y}]}],u=new fT({returnSingle:!0,keyName:s,zodSchema:r})}else{let y;typeof r.name=="string"&&typeof r.parameters=="object"&&r.parameters!=null?(y=r,s=r.name):y={name:s,description:r.description??"",parameters:r},l=[{functionDeclarations:[y]}],u=new fT({returnSingle:!0,keyName:s})}const c=this.bind({tools:l,tool_choice:s});if(!o)return c.pipe(u).withConfig({runName:"ChatGoogleGenerativeAIStructuredOutput"});const f=ou.assign({parsed:(y,d)=>u.invoke(y.raw,d)}),p=ou.assign({parsed:()=>null}),h=f.withFallbacks({fallbacks:[p]});return mr.from([{raw:c},h]).withConfig({runName:"StructuredOutputRunnable"})}}var hu={},pl={},Lr={},_l={},yl={},Ug={},hT;function tY(){return hT||(hT=1,Object.defineProperty(Ug,"__esModule",{value:!0})),Ug}var od={},pT;function rY(){return pT||(pT=1,Object.defineProperty(od,"__esModule",{value:!0}),od.V2ChatStreamRequestSafetyMode=void 0,od.V2ChatStreamRequestSafetyMode={Contextual:"CONTEXTUAL",Strict:"STRICT",Off:"OFF"}),od}var sd={},_T;function nY(){return _T||(_T=1,Object.defineProperty(sd,"__esModule",{value:!0}),sd.V2ChatStreamRequestToolChoice=void 0,sd.V2ChatStreamRequestToolChoice={Required:"REQUIRED",None:"NONE"}),sd}var Fg={},yT;function iY(){return yT||(yT=1,Object.defineProperty(Fg,"__esModule",{value:!0})),Fg}var ud={},bT;function aY(){return bT||(bT=1,Object.defineProperty(ud,"__esModule",{value:!0}),ud.V2ChatRequestSafetyMode=void 0,ud.V2ChatRequestSafetyMode={Contextual:"CONTEXTUAL",Strict:"STRICT",Off:"OFF"}),ud}var ld={},mT;function oY(){return mT||(mT=1,Object.defineProperty(ld,"__esModule",{value:!0}),ld.V2ChatRequestToolChoice=void 0,ld.V2ChatRequestToolChoice={Required:"REQUIRED",None:"NONE"}),ld}var cd={},gT;function sY(){return gT||(gT=1,Object.defineProperty(cd,"__esModule",{value:!0}),cd.V2EmbedRequestTruncate=void 0,cd.V2EmbedRequestTruncate={None:"NONE",Start:"START",End:"END"}),cd}var Lg={},vT;function uY(){return vT||(vT=1,Object.defineProperty(Lg,"__esModule",{value:!0})),Lg}var Vg={},wT;function lY(){return wT||(wT=1,Object.defineProperty(Vg,"__esModule",{value:!0})),Vg}var Gg={},OT;function cY(){return OT||(OT=1,Object.defineProperty(Gg,"__esModule",{value:!0})),Gg}var ST;function p8(){return ST||(ST=1,function(a){var e=yl&&yl.__createBinding||(Object.create?function(r,n,i,o){o===void 0&&(o=i);var s=Object.getOwnPropertyDescriptor(n,i);(!s||("get"in s?!n.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(r,o,s)}:function(r,n,i,o){o===void 0&&(o=i),r[o]=n[i]}),t=yl&&yl.__exportStar||function(r,n){for(var i in r)i!=="default"&&!Object.prototype.hasOwnProperty.call(n,i)&&e(n,r,i)};Object.defineProperty(a,"__esModule",{value:!0}),t(tY(),a),t(rY(),a),t(nY(),a),t(iY(),a),t(aY(),a),t(oY(),a),t(sY(),a),t(uY(),a),t(lY(),a),t(cY(),a)}(yl)),yl}var bl={},kg={},ET;function _8(){return ET||(ET=1,Object.defineProperty(kg,"__esModule",{value:!0})),kg}var RT;function fY(){return RT||(RT=1,function(a){var e=bl&&bl.__createBinding||(Object.create?function(r,n,i,o){o===void 0&&(o=i);var s=Object.getOwnPropertyDescriptor(n,i);(!s||("get"in s?!n.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(r,o,s)}:function(r,n,i,o){o===void 0&&(o=i),r[o]=n[i]}),t=bl&&bl.__exportStar||function(r,n){for(var i in r)i!=="default"&&!Object.prototype.hasOwnProperty.call(n,i)&&e(n,r,i)};Object.defineProperty(a,"__esModule",{value:!0}),t(_8(),a)}(bl)),bl}var CT;function dY(){return CT||(CT=1,function(a){var e=_l&&_l.__createBinding||(Object.create?function(r,n,i,o){o===void 0&&(o=i);var s=Object.getOwnPropertyDescriptor(n,i);(!s||("get"in s?!n.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(r,o,s)}:function(r,n,i,o){o===void 0&&(o=i),r[o]=n[i]}),t=_l&&_l.__exportStar||function(r,n){for(var i in r)i!=="default"&&!Object.prototype.hasOwnProperty.call(n,i)&&e(n,r,i)};Object.defineProperty(a,"__esModule",{value:!0}),t(p8(),a),t(fY(),a)}(_l)),_l}var ml={},gl={},fd={},PT;function hY(){return PT||(PT=1,Object.defineProperty(fd,"__esModule",{value:!0}),fd.CreateEmbedJobRequestTruncate=void 0,fd.CreateEmbedJobRequestTruncate={Start:"START",End:"END"}),fd}var jT;function y8(){return jT||(jT=1,function(a){var e=gl&&gl.__createBinding||(Object.create?function(r,n,i,o){o===void 0&&(o=i);var s=Object.getOwnPropertyDescriptor(n,i);(!s||("get"in s?!n.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(r,o,s)}:function(r,n,i,o){o===void 0&&(o=i),r[o]=n[i]}),t=gl&&gl.__exportStar||function(r,n){for(var i in r)i!=="default"&&!Object.prototype.hasOwnProperty.call(n,i)&&e(n,r,i)};Object.defineProperty(a,"__esModule",{value:!0}),t(hY(),a)}(gl)),gl}var vl={},Hg={},TT;function b8(){return TT||(TT=1,Object.defineProperty(Hg,"__esModule",{value:!0})),Hg}var MT;function pY(){return MT||(MT=1,function(a){var e=vl&&vl.__createBinding||(Object.create?function(r,n,i,o){o===void 0&&(o=i);var s=Object.getOwnPropertyDescriptor(n,i);(!s||("get"in s?!n.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(r,o,s)}:function(r,n,i,o){o===void 0&&(o=i),r[o]=n[i]}),t=vl&&vl.__exportStar||function(r,n){for(var i in r)i!=="default"&&!Object.prototype.hasOwnProperty.call(n,i)&&e(n,r,i)};Object.defineProperty(a,"__esModule",{value:!0}),t(b8(),a)}(vl)),vl}var AT;function _Y(){return AT||(AT=1,function(a){var e=ml&&ml.__createBinding||(Object.create?function(r,n,i,o){o===void 0&&(o=i);var s=Object.getOwnPropertyDescriptor(n,i);(!s||("get"in s?!n.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(r,o,s)}:function(r,n,i,o){o===void 0&&(o=i),r[o]=n[i]}),t=ml&&ml.__exportStar||function(r,n){for(var i in r)i!=="default"&&!Object.prototype.hasOwnProperty.call(n,i)&&e(n,r,i)};Object.defineProperty(a,"__esModule",{value:!0}),t(y8(),a),t(pY(),a)}(ml)),ml}var wl={},Ol={},Wg={},IT;function yY(){return IT||(IT=1,Object.defineProperty(Wg,"__esModule",{value:!0})),Wg}var Kg={},DT;function bY(){return DT||(DT=1,Object.defineProperty(Kg,"__esModule",{value:!0})),Kg}var Jg={},xT;function mY(){return xT||(xT=1,Object.defineProperty(Jg,"__esModule",{value:!0})),Jg}var Xg={},$T;function gY(){return $T||($T=1,Object.defineProperty(Xg,"__esModule",{value:!0})),Xg}var Zg={},NT;function vY(){return NT||(NT=1,Object.defineProperty(Zg,"__esModule",{value:!0})),Zg}var qT;function m8(){return qT||(qT=1,function(a){var e=Ol&&Ol.__createBinding||(Object.create?function(r,n,i,o){o===void 0&&(o=i);var s=Object.getOwnPropertyDescriptor(n,i);(!s||("get"in s?!n.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(r,o,s)}:function(r,n,i,o){o===void 0&&(o=i),r[o]=n[i]}),t=Ol&&Ol.__exportStar||function(r,n){for(var i in r)i!=="default"&&!Object.prototype.hasOwnProperty.call(n,i)&&e(n,r,i)};Object.defineProperty(a,"__esModule",{value:!0}),t(yY(),a),t(bY(),a),t(mY(),a),t(gY(),a),t(vY(),a)}(Ol)),Ol}var Sl={},Qg={},zT;function g8(){return zT||(zT=1,Object.defineProperty(Qg,"__esModule",{value:!0})),Qg}var BT;function wY(){return BT||(BT=1,function(a){var e=Sl&&Sl.__createBinding||(Object.create?function(r,n,i,o){o===void 0&&(o=i);var s=Object.getOwnPropertyDescriptor(n,i);(!s||("get"in s?!n.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(r,o,s)}:function(r,n,i,o){o===void 0&&(o=i),r[o]=n[i]}),t=Sl&&Sl.__exportStar||function(r,n){for(var i in r)i!=="default"&&!Object.prototype.hasOwnProperty.call(n,i)&&e(n,r,i)};Object.defineProperty(a,"__esModule",{value:!0}),t(g8(),a)}(Sl)),Sl}var UT;function OY(){return UT||(UT=1,function(a){var e=wl&&wl.__createBinding||(Object.create?function(r,n,i,o){o===void 0&&(o=i);var s=Object.getOwnPropertyDescriptor(n,i);(!s||("get"in s?!n.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(r,o,s)}:function(r,n,i,o){o===void 0&&(o=i),r[o]=n[i]}),t=wl&&wl.__exportStar||function(r,n){for(var i in r)i!=="default"&&!Object.prototype.hasOwnProperty.call(n,i)&&e(n,r,i)};Object.defineProperty(a,"__esModule",{value:!0}),t(m8(),a),t(wY(),a)}(wl)),wl}var El={},Vr={},Rl={},Cl={},dd={},FT;function SY(){return FT||(FT=1,Object.defineProperty(dd,"__esModule",{value:!0}),dd.BaseType=void 0,dd.BaseType={BaseTypeUnspecified:"BASE_TYPE_UNSPECIFIED",BaseTypeGenerative:"BASE_TYPE_GENERATIVE",BaseTypeClassification:"BASE_TYPE_CLASSIFICATION",BaseTypeRerank:"BASE_TYPE_RERANK",BaseTypeChat:"BASE_TYPE_CHAT"}),dd}var hd={},LT;function EY(){return LT||(LT=1,Object.defineProperty(hd,"__esModule",{value:!0}),hd.Strategy=void 0,hd.Strategy={StrategyUnspecified:"STRATEGY_UNSPECIFIED",StrategyVanilla:"STRATEGY_VANILLA",StrategyTfew:"STRATEGY_TFEW"}),hd}var Yg={},VT;function RY(){return VT||(VT=1,Object.defineProperty(Yg,"__esModule",{value:!0})),Yg}var pd={},GT;function CY(){return GT||(GT=1,Object.defineProperty(pd,"__esModule",{value:!0}),pd.LoraTargetModules=void 0,pd.LoraTargetModules={LoraTargetModulesUnspecified:"LORA_TARGET_MODULES_UNSPECIFIED",LoraTargetModulesQv:"LORA_TARGET_MODULES_QV",LoraTargetModulesQkvo:"LORA_TARGET_MODULES_QKVO",LoraTargetModulesQkvoFfn:"LORA_TARGET_MODULES_QKVO_FFN"}),pd}var ev={},kT;function PY(){return kT||(kT=1,Object.defineProperty(ev,"__esModule",{value:!0})),ev}var tv={},HT;function jY(){return HT||(HT=1,Object.defineProperty(tv,"__esModule",{value:!0})),tv}var rv={},WT;function TY(){return WT||(WT=1,Object.defineProperty(rv,"__esModule",{value:!0})),rv}var _d={},KT;function MY(){return KT||(KT=1,Object.defineProperty(_d,"__esModule",{value:!0}),_d.Status=void 0,_d.Status={StatusUnspecified:"STATUS_UNSPECIFIED",StatusFinetuning:"STATUS_FINETUNING",StatusDeployingApi:"STATUS_DEPLOYING_API",StatusReady:"STATUS_READY",StatusFailed:"STATUS_FAILED",StatusDeleted:"STATUS_DELETED",StatusTemporarilyOffline:"STATUS_TEMPORARILY_OFFLINE",StatusPaused:"STATUS_PAUSED",StatusQueued:"STATUS_QUEUED"}),_d}var nv={},JT;function AY(){return JT||(JT=1,Object.defineProperty(nv,"__esModule",{value:!0})),nv}var iv={},XT;function IY(){return XT||(XT=1,Object.defineProperty(iv,"__esModule",{value:!0})),iv}var av={},ZT;function DY(){return ZT||(ZT=1,Object.defineProperty(av,"__esModule",{value:!0})),av}var ov={},QT;function xY(){return QT||(QT=1,Object.defineProperty(ov,"__esModule",{value:!0})),ov}var sv={},YT;function $Y(){return YT||(YT=1,Object.defineProperty(sv,"__esModule",{value:!0})),sv}var uv={},eM;function NY(){return eM||(eM=1,Object.defineProperty(uv,"__esModule",{value:!0})),uv}var lv={},tM;function qY(){return tM||(tM=1,Object.defineProperty(lv,"__esModule",{value:!0})),lv}var cv={},rM;function zY(){return rM||(rM=1,Object.defineProperty(cv,"__esModule",{value:!0})),cv}var fv={},nM;function BY(){return nM||(nM=1,Object.defineProperty(fv,"__esModule",{value:!0})),fv}var dv={},iM;function UY(){return iM||(iM=1,Object.defineProperty(dv,"__esModule",{value:!0})),dv}var aM;function v8(){return aM||(aM=1,function(a){var e=Cl&&Cl.__createBinding||(Object.create?function(r,n,i,o){o===void 0&&(o=i);var s=Object.getOwnPropertyDescriptor(n,i);(!s||("get"in s?!n.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(r,o,s)}:function(r,n,i,o){o===void 0&&(o=i),r[o]=n[i]}),t=Cl&&Cl.__exportStar||function(r,n){for(var i in r)i!=="default"&&!Object.prototype.hasOwnProperty.call(n,i)&&e(n,r,i)};Object.defineProperty(a,"__esModule",{value:!0}),t(SY(),a),t(EY(),a),t(RY(),a),t(CY(),a),t(PY(),a),t(jY(),a),t(TY(),a),t(MY(),a),t(AY(),a),t(IY(),a),t(DY(),a),t(xY(),a),t($Y(),a),t(NY(),a),t(qY(),a),t(zY(),a),t(BY(),a),t(UY(),a)}(Cl)),Cl}var oM;function FY(){return oM||(oM=1,function(a){var e=Rl&&Rl.__createBinding||(Object.create?function(r,n,i,o){o===void 0&&(o=i);var s=Object.getOwnPropertyDescriptor(n,i);(!s||("get"in s?!n.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(r,o,s)}:function(r,n,i,o){o===void 0&&(o=i),r[o]=n[i]}),t=Rl&&Rl.__exportStar||function(r,n){for(var i in r)i!=="default"&&!Object.prototype.hasOwnProperty.call(n,i)&&e(n,r,i)};Object.defineProperty(a,"__esModule",{value:!0}),t(v8(),a)}(Rl)),Rl}var sM;function LY(){return sM||(sM=1,function(a){var e=Vr&&Vr.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),t=Vr&&Vr.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),r=Vr&&Vr.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&e(o,i,s);return t(o,i),o},n=Vr&&Vr.__exportStar||function(i,o){for(var s in i)s!=="default"&&!Object.prototype.hasOwnProperty.call(o,s)&&e(o,i,s)};Object.defineProperty(a,"__esModule",{value:!0}),a.finetuning=void 0,a.finetuning=r(FY()),n(v8(),a)}(Vr)),Vr}var Pl={},hv={},uM;function w8(){return uM||(uM=1,Object.defineProperty(hv,"__esModule",{value:!0})),hv}var lM;function VY(){return lM||(lM=1,function(a){var e=Pl&&Pl.__createBinding||(Object.create?function(r,n,i,o){o===void 0&&(o=i);var s=Object.getOwnPropertyDescriptor(n,i);(!s||("get"in s?!n.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(r,o,s)}:function(r,n,i,o){o===void 0&&(o=i),r[o]=n[i]}),t=Pl&&Pl.__exportStar||function(r,n){for(var i in r)i!=="default"&&!Object.prototype.hasOwnProperty.call(n,i)&&e(n,r,i)};Object.defineProperty(a,"__esModule",{value:!0}),t(w8(),a)}(Pl)),Pl}var cM;function GY(){return cM||(cM=1,function(a){var e=El&&El.__createBinding||(Object.create?function(r,n,i,o){o===void 0&&(o=i);var s=Object.getOwnPropertyDescriptor(n,i);(!s||("get"in s?!n.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(r,o,s)}:function(r,n,i,o){o===void 0&&(o=i),r[o]=n[i]}),t=El&&El.__exportStar||function(r,n){for(var i in r)i!=="default"&&!Object.prototype.hasOwnProperty.call(n,i)&&e(n,r,i)};Object.defineProperty(a,"__esModule",{value:!0}),t(LY(),a),t(VY(),a)}(El)),El}var jl={},Tl={},pv={},fM;function O8(){return fM||(fM=1,Object.defineProperty(pv,"__esModule",{value:!0})),pv}var dM;function kY(){return dM||(dM=1,function(a){var e=Tl&&Tl.__createBinding||(Object.create?function(r,n,i,o){o===void 0&&(o=i);var s=Object.getOwnPropertyDescriptor(n,i);(!s||("get"in s?!n.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(r,o,s)}:function(r,n,i,o){o===void 0&&(o=i),r[o]=n[i]}),t=Tl&&Tl.__exportStar||function(r,n){for(var i in r)i!=="default"&&!Object.prototype.hasOwnProperty.call(n,i)&&e(n,r,i)};Object.defineProperty(a,"__esModule",{value:!0}),t(O8(),a)}(Tl)),Tl}var hM;function HY(){return hM||(hM=1,function(a){var e=jl&&jl.__createBinding||(Object.create?function(r,n,i,o){o===void 0&&(o=i);var s=Object.getOwnPropertyDescriptor(n,i);(!s||("get"in s?!n.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(r,o,s)}:function(r,n,i,o){o===void 0&&(o=i),r[o]=n[i]}),t=jl&&jl.__exportStar||function(r,n){for(var i in r)i!=="default"&&!Object.prototype.hasOwnProperty.call(n,i)&&e(n,r,i)};Object.defineProperty(a,"__esModule",{value:!0}),t(kY(),a)}(jl)),jl}var Ml={},Al={},_v={},pM;function S8(){return pM||(pM=1,Object.defineProperty(_v,"__esModule",{value:!0})),_v}var _M;function WY(){return _M||(_M=1,function(a){var e=Al&&Al.__createBinding||(Object.create?function(r,n,i,o){o===void 0&&(o=i);var s=Object.getOwnPropertyDescriptor(n,i);(!s||("get"in s?!n.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(r,o,s)}:function(r,n,i,o){o===void 0&&(o=i),r[o]=n[i]}),t=Al&&Al.__exportStar||function(r,n){for(var i in r)i!=="default"&&!Object.prototype.hasOwnProperty.call(n,i)&&e(n,r,i)};Object.defineProperty(a,"__esModule",{value:!0}),t(S8(),a)}(Al)),Al}var yM;function KY(){return yM||(yM=1,function(a){var e=Ml&&Ml.__createBinding||(Object.create?function(r,n,i,o){o===void 0&&(o=i);var s=Object.getOwnPropertyDescriptor(n,i);(!s||("get"in s?!n.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(r,o,s)}:function(r,n,i,o){o===void 0&&(o=i),r[o]=n[i]}),t=Ml&&Ml.__exportStar||function(r,n){for(var i in r)i!=="default"&&!Object.prototype.hasOwnProperty.call(n,i)&&e(n,r,i)};Object.defineProperty(a,"__esModule",{value:!0}),t(WY(),a)}(Ml)),Ml}var bM;function JY(){return bM||(bM=1,function(a){var e=Lr&&Lr.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),t=Lr&&Lr.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),r=Lr&&Lr.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&e(o,i,s);return t(o,i),o},n=Lr&&Lr.__exportStar||function(i,o){for(var s in i)s!=="default"&&!Object.prototype.hasOwnProperty.call(o,s)&&e(o,i,s)};Object.defineProperty(a,"__esModule",{value:!0}),a.models=a.connectors=a.finetuning=a.datasets=a.embedJobs=a.v2=void 0,a.v2=r(dY()),n(p8(),a),a.embedJobs=r(_Y()),n(y8(),a),a.datasets=r(OY()),n(m8(),a),a.finetuning=r(GY()),a.connectors=r(HY()),a.models=r(KY()),n(_8(),a),n(b8(),a),n(g8(),a),n(O8(),a),n(S8(),a),n(w8(),a)}(Lr)),Lr}var Il={},yd={},mM;function XY(){return mM||(mM=1,Object.defineProperty(yd,"__esModule",{value:!0}),yd.ChatStreamRequestPromptTruncation=void 0,yd.ChatStreamRequestPromptTruncation={Off:"OFF",Auto:"AUTO",AutoPreserveOrder:"AUTO_PRESERVE_ORDER"}),yd}var bd={},gM;function ZY(){return gM||(gM=1,Object.defineProperty(bd,"__esModule",{value:!0}),bd.ChatStreamRequestCitationQuality=void 0,bd.ChatStreamRequestCitationQuality={Fast:"fast",Accurate:"accurate",Off:"off"}),bd}var yv={},vM;function QY(){return vM||(vM=1,Object.defineProperty(yv,"__esModule",{value:!0})),yv}var md={},wM;function YY(){return wM||(wM=1,Object.defineProperty(md,"__esModule",{value:!0}),md.ChatStreamRequestSafetyMode=void 0,md.ChatStreamRequestSafetyMode={Contextual:"CONTEXTUAL",Strict:"STRICT",None:"NONE"}),md}var gd={},OM;function eee(){return OM||(OM=1,Object.defineProperty(gd,"__esModule",{value:!0}),gd.ChatRequestPromptTruncation=void 0,gd.ChatRequestPromptTruncation={Off:"OFF",Auto:"AUTO",AutoPreserveOrder:"AUTO_PRESERVE_ORDER"}),gd}var vd={},SM;function tee(){return SM||(SM=1,Object.defineProperty(vd,"__esModule",{value:!0}),vd.ChatRequestCitationQuality=void 0,vd.ChatRequestCitationQuality={Fast:"fast",Accurate:"accurate",Off:"off"}),vd}var bv={},EM;function ree(){return EM||(EM=1,Object.defineProperty(bv,"__esModule",{value:!0})),bv}var wd={},RM;function nee(){return RM||(RM=1,Object.defineProperty(wd,"__esModule",{value:!0}),wd.ChatRequestSafetyMode=void 0,wd.ChatRequestSafetyMode={Contextual:"CONTEXTUAL",Strict:"STRICT",None:"NONE"}),wd}var Od={},CM;function iee(){return CM||(CM=1,Object.defineProperty(Od,"__esModule",{value:!0}),Od.GenerateStreamRequestTruncate=void 0,Od.GenerateStreamRequestTruncate={None:"NONE",Start:"START",End:"END"}),Od}var Sd={},PM;function aee(){return PM||(PM=1,Object.defineProperty(Sd,"__esModule",{value:!0}),Sd.GenerateStreamRequestReturnLikelihoods=void 0,Sd.GenerateStreamRequestReturnLikelihoods={Generation:"GENERATION",All:"ALL",None:"NONE"}),Sd}var Ed={},jM;function oee(){return jM||(jM=1,Object.defineProperty(Ed,"__esModule",{value:!0}),Ed.GenerateRequestTruncate=void 0,Ed.GenerateRequestTruncate={None:"NONE",Start:"START",End:"END"}),Ed}var Rd={},TM;function see(){return TM||(TM=1,Object.defineProperty(Rd,"__esModule",{value:!0}),Rd.GenerateRequestReturnLikelihoods=void 0,Rd.GenerateRequestReturnLikelihoods={Generation:"GENERATION",All:"ALL",None:"NONE"}),Rd}var Cd={},MM;function uee(){return MM||(MM=1,Object.defineProperty(Cd,"__esModule",{value:!0}),Cd.EmbedRequestTruncate=void 0,Cd.EmbedRequestTruncate={None:"NONE",Start:"START",End:"END"}),Cd}var mv={},AM;function lee(){return AM||(AM=1,Object.defineProperty(mv,"__esModule",{value:!0})),mv}var gv={},IM;function cee(){return IM||(IM=1,Object.defineProperty(gv,"__esModule",{value:!0})),gv}var vv={},DM;function fee(){return DM||(DM=1,Object.defineProperty(vv,"__esModule",{value:!0})),vv}var wv={},xM;function dee(){return xM||(xM=1,Object.defineProperty(wv,"__esModule",{value:!0})),wv}var Ov={},$M;function hee(){return $M||($M=1,Object.defineProperty(Ov,"__esModule",{value:!0})),Ov}var Pd={},NM;function pee(){return NM||(NM=1,Object.defineProperty(Pd,"__esModule",{value:!0}),Pd.ClassifyRequestTruncate=void 0,Pd.ClassifyRequestTruncate={None:"NONE",Start:"START",End:"END"}),Pd}var Sv={},qM;function _ee(){return qM||(qM=1,Object.defineProperty(Sv,"__esModule",{value:!0})),Sv}var jd={},zM;function yee(){return zM||(zM=1,Object.defineProperty(jd,"__esModule",{value:!0}),jd.ClassifyResponseClassificationsItemClassificationType=void 0,jd.ClassifyResponseClassificationsItemClassificationType={SingleLabel:"single-label",MultiLabel:"multi-label"}),jd}var Ev={},BM;function bee(){return BM||(BM=1,Object.defineProperty(Ev,"__esModule",{value:!0})),Ev}var Rv={},UM;function mee(){return UM||(UM=1,Object.defineProperty(Rv,"__esModule",{value:!0})),Rv}var Td={},FM;function gee(){return FM||(FM=1,Object.defineProperty(Td,"__esModule",{value:!0}),Td.SummarizeRequestLength=void 0,Td.SummarizeRequestLength={Short:"short",Medium:"medium",Long:"long"}),Td}var Md={},LM;function vee(){return LM||(LM=1,Object.defineProperty(Md,"__esModule",{value:!0}),Md.SummarizeRequestFormat=void 0,Md.SummarizeRequestFormat={Paragraph:"paragraph",Bullets:"bullets"}),Md}var Ad={},VM;function wee(){return VM||(VM=1,Object.defineProperty(Ad,"__esModule",{value:!0}),Ad.SummarizeRequestExtractiveness=void 0,Ad.SummarizeRequestExtractiveness={Low:"low",Medium:"medium",High:"high"}),Ad}var Cv={},GM;function Oee(){return GM||(GM=1,Object.defineProperty(Cv,"__esModule",{value:!0})),Cv}var Pv={},kM;function See(){return kM||(kM=1,Object.defineProperty(Pv,"__esModule",{value:!0})),Pv}var jv={},HM;function Eee(){return HM||(HM=1,Object.defineProperty(jv,"__esModule",{value:!0})),jv}var Tv={},WM;function Ree(){return WM||(WM=1,Object.defineProperty(Tv,"__esModule",{value:!0})),Tv}var Mv={},KM;function Cee(){return KM||(KM=1,Object.defineProperty(Mv,"__esModule",{value:!0})),Mv}var Av={},JM;function Pee(){return JM||(JM=1,Object.defineProperty(Av,"__esModule",{value:!0})),Av}var Iv={},XM;function jee(){return XM||(XM=1,Object.defineProperty(Iv,"__esModule",{value:!0})),Iv}var Dv={},ZM;function Tee(){return ZM||(ZM=1,Object.defineProperty(Dv,"__esModule",{value:!0})),Dv}var xv={},QM;function Mee(){return QM||(QM=1,Object.defineProperty(xv,"__esModule",{value:!0})),xv}var $v={},YM;function Aee(){return YM||(YM=1,Object.defineProperty($v,"__esModule",{value:!0})),$v}var Nv={},eA;function Iee(){return eA||(eA=1,Object.defineProperty(Nv,"__esModule",{value:!0})),Nv}var qv={},tA;function Dee(){return tA||(tA=1,Object.defineProperty(qv,"__esModule",{value:!0})),qv}var zv={},rA;function xee(){return rA||(rA=1,Object.defineProperty(zv,"__esModule",{value:!0})),zv}var Bv={},nA;function $ee(){return nA||(nA=1,Object.defineProperty(Bv,"__esModule",{value:!0})),Bv}var Uv={},iA;function Nee(){return iA||(iA=1,Object.defineProperty(Uv,"__esModule",{value:!0})),Uv}var Fv={},aA;function qee(){return aA||(aA=1,Object.defineProperty(Fv,"__esModule",{value:!0})),Fv}var Id={},oA;function zee(){return oA||(oA=1,Object.defineProperty(Id,"__esModule",{value:!0}),Id.ChatCitationType=void 0,Id.ChatCitationType={TextContent:"TEXT_CONTENT",Plan:"PLAN"}),Id}var Lv={},sA;function Bee(){return sA||(sA=1,Object.defineProperty(Lv,"__esModule",{value:!0})),Lv}var Vv={},uA;function Uee(){return uA||(uA=1,Object.defineProperty(Vv,"__esModule",{value:!0})),Vv}var Gv={},lA;function Fee(){return lA||(lA=1,Object.defineProperty(Gv,"__esModule",{value:!0})),Gv}var kv={},cA;function Lee(){return cA||(cA=1,Object.defineProperty(kv,"__esModule",{value:!0})),kv}var Dd={},fA;function Vee(){return fA||(fA=1,Object.defineProperty(Dd,"__esModule",{value:!0}),Dd.FinishReason=void 0,Dd.FinishReason={Complete:"COMPLETE",StopSequence:"STOP_SEQUENCE",Error:"ERROR",ErrorToxic:"ERROR_TOXIC",ErrorLimit:"ERROR_LIMIT",UserCancel:"USER_CANCEL",MaxTokens:"MAX_TOKENS"}),Dd}var Hv={},dA;function Gee(){return dA||(dA=1,Object.defineProperty(Hv,"__esModule",{value:!0})),Hv}var Wv={},hA;function kee(){return hA||(hA=1,Object.defineProperty(Wv,"__esModule",{value:!0})),Wv}var Kv={},pA;function Hee(){return pA||(pA=1,Object.defineProperty(Kv,"__esModule",{value:!0})),Kv}var Jv={},_A;function Wee(){return _A||(_A=1,Object.defineProperty(Jv,"__esModule",{value:!0})),Jv}var Xv={},yA;function Kee(){return yA||(yA=1,Object.defineProperty(Xv,"__esModule",{value:!0})),Xv}var Zv={},bA;function Jee(){return bA||(bA=1,Object.defineProperty(Zv,"__esModule",{value:!0})),Zv}var Qv={},mA;function Xee(){return mA||(mA=1,Object.defineProperty(Qv,"__esModule",{value:!0})),Qv}var Yv={},gA;function Zee(){return gA||(gA=1,Object.defineProperty(Yv,"__esModule",{value:!0})),Yv}var ew={},vA;function Qee(){return vA||(vA=1,Object.defineProperty(ew,"__esModule",{value:!0})),ew}var tw={},wA;function Yee(){return wA||(wA=1,Object.defineProperty(tw,"__esModule",{value:!0})),tw}var rw={},OA;function ete(){return OA||(OA=1,Object.defineProperty(rw,"__esModule",{value:!0})),rw}var nw={},SA;function tte(){return SA||(SA=1,Object.defineProperty(nw,"__esModule",{value:!0})),nw}var xd={},EA;function rte(){return EA||(EA=1,Object.defineProperty(xd,"__esModule",{value:!0}),xd.ChatStreamEndEventFinishReason=void 0,xd.ChatStreamEndEventFinishReason={Complete:"COMPLETE",ErrorLimit:"ERROR_LIMIT",MaxTokens:"MAX_TOKENS",Error:"ERROR",ErrorToxic:"ERROR_TOXIC"}),xd}var iw={},RA;function nte(){return RA||(RA=1,Object.defineProperty(iw,"__esModule",{value:!0})),iw}var aw={},CA;function ite(){return CA||(CA=1,Object.defineProperty(aw,"__esModule",{value:!0})),aw}var ow={},PA;function ate(){return PA||(PA=1,Object.defineProperty(ow,"__esModule",{value:!0})),ow}var sw={},jA;function ote(){return jA||(jA=1,Object.defineProperty(sw,"__esModule",{value:!0})),sw}var uw={},TA;function ste(){return TA||(TA=1,Object.defineProperty(uw,"__esModule",{value:!0})),uw}var lw={},MA;function ute(){return MA||(MA=1,Object.defineProperty(lw,"__esModule",{value:!0})),lw}var cw={},AA;function lte(){return AA||(AA=1,Object.defineProperty(cw,"__esModule",{value:!0})),cw}var fw={},IA;function cte(){return IA||(IA=1,Object.defineProperty(fw,"__esModule",{value:!0})),fw}var dw={},DA;function fte(){return DA||(DA=1,Object.defineProperty(dw,"__esModule",{value:!0})),dw}var hw={},xA;function dte(){return xA||(xA=1,Object.defineProperty(hw,"__esModule",{value:!0})),hw}var pw={},$A;function hte(){return $A||($A=1,Object.defineProperty(pw,"__esModule",{value:!0})),pw}var _w={},NA;function pte(){return NA||(NA=1,Object.defineProperty(_w,"__esModule",{value:!0})),_w}var yw={},qA;function _te(){return qA||(qA=1,Object.defineProperty(yw,"__esModule",{value:!0})),yw}var bw={},zA;function yte(){return zA||(zA=1,Object.defineProperty(bw,"__esModule",{value:!0})),bw}var mw={},BA;function bte(){return BA||(BA=1,Object.defineProperty(mw,"__esModule",{value:!0})),mw}var gw={},UA;function mte(){return UA||(UA=1,Object.defineProperty(gw,"__esModule",{value:!0})),gw}var $d={},FA;function gte(){return FA||(FA=1,Object.defineProperty($d,"__esModule",{value:!0}),$d.CitationType=void 0,$d.CitationType={TextContent:"TEXT_CONTENT",Plan:"PLAN"}),$d}var vw={},LA;function vte(){return LA||(LA=1,Object.defineProperty(vw,"__esModule",{value:!0})),vw}var ww={},VA;function wte(){return VA||(VA=1,Object.defineProperty(ww,"__esModule",{value:!0})),ww}var Ow={},GA;function Ote(){return GA||(GA=1,Object.defineProperty(Ow,"__esModule",{value:!0})),Ow}var Sw={},kA;function Ste(){return kA||(kA=1,Object.defineProperty(Sw,"__esModule",{value:!0})),Sw}var Ew={},HA;function Ete(){return HA||(HA=1,Object.defineProperty(Ew,"__esModule",{value:!0})),Ew}var Rw={},WA;function Rte(){return WA||(WA=1,Object.defineProperty(Rw,"__esModule",{value:!0})),Rw}var Cw={},KA;function Cte(){return KA||(KA=1,Object.defineProperty(Cw,"__esModule",{value:!0})),Cw}var Pw={},JA;function Pte(){return JA||(JA=1,Object.defineProperty(Pw,"__esModule",{value:!0})),Pw}var jw={},XA;function jte(){return XA||(XA=1,Object.defineProperty(jw,"__esModule",{value:!0})),jw}var Tw={},ZA;function Tte(){return ZA||(ZA=1,Object.defineProperty(Tw,"__esModule",{value:!0})),Tw}var Mw={},QA;function Mte(){return QA||(QA=1,Object.defineProperty(Mw,"__esModule",{value:!0})),Mw}var Aw={},YA;function Ate(){return YA||(YA=1,Object.defineProperty(Aw,"__esModule",{value:!0})),Aw}var Iw={},eI;function Ite(){return eI||(eI=1,Object.defineProperty(Iw,"__esModule",{value:!0})),Iw}var Dw={},tI;function Dte(){return tI||(tI=1,Object.defineProperty(Dw,"__esModule",{value:!0})),Dw}var xw={},rI;function xte(){return rI||(rI=1,Object.defineProperty(xw,"__esModule",{value:!0})),xw}var $w={},nI;function $te(){return nI||(nI=1,Object.defineProperty($w,"__esModule",{value:!0})),$w}var Nd={},iI;function Nte(){return iI||(iI=1,Object.defineProperty(Nd,"__esModule",{value:!0}),Nd.CitationOptionsMode=void 0,Nd.CitationOptionsMode={Fast:"FAST",Accurate:"ACCURATE",Off:"OFF"}),Nd}var Nw={},aI;function qte(){return aI||(aI=1,Object.defineProperty(Nw,"__esModule",{value:!0})),Nw}var qw={},oI;function zte(){return oI||(oI=1,Object.defineProperty(qw,"__esModule",{value:!0})),qw}var zw={},sI;function Bte(){return sI||(sI=1,Object.defineProperty(zw,"__esModule",{value:!0})),zw}var Bw={},uI;function Ute(){return uI||(uI=1,Object.defineProperty(Bw,"__esModule",{value:!0})),Bw}var qd={},lI;function Fte(){return lI||(lI=1,Object.defineProperty(qd,"__esModule",{value:!0}),qd.ChatFinishReason=void 0,qd.ChatFinishReason={Complete:"COMPLETE",StopSequence:"STOP_SEQUENCE",MaxTokens:"MAX_TOKENS",ToolCall:"TOOL_CALL",Error:"ERROR"}),qd}var Uw={},cI;function Lte(){return cI||(cI=1,Object.defineProperty(Uw,"__esModule",{value:!0})),Uw}var Fw={},fI;function Vte(){return fI||(fI=1,Object.defineProperty(Fw,"__esModule",{value:!0})),Fw}var Lw={},dI;function Gte(){return dI||(dI=1,Object.defineProperty(Lw,"__esModule",{value:!0})),Lw}var Vw={},hI;function kte(){return hI||(hI=1,Object.defineProperty(Vw,"__esModule",{value:!0})),Vw}var Gw={},pI;function Hte(){return pI||(pI=1,Object.defineProperty(Gw,"__esModule",{value:!0})),Gw}var kw={},_I;function Wte(){return _I||(_I=1,Object.defineProperty(kw,"__esModule",{value:!0})),kw}var Hw={},yI;function Kte(){return yI||(yI=1,Object.defineProperty(Hw,"__esModule",{value:!0})),Hw}var Ww={},bI;function Jte(){return bI||(bI=1,Object.defineProperty(Ww,"__esModule",{value:!0})),Ww}var Kw={},mI;function Xte(){return mI||(mI=1,Object.defineProperty(Kw,"__esModule",{value:!0})),Kw}var Jw={},gI;function Zte(){return gI||(gI=1,Object.defineProperty(Jw,"__esModule",{value:!0})),Jw}var Xw={},vI;function Qte(){return vI||(vI=1,Object.defineProperty(Xw,"__esModule",{value:!0})),Xw}var Zw={},wI;function Yte(){return wI||(wI=1,Object.defineProperty(Zw,"__esModule",{value:!0})),Zw}var Qw={},OI;function ere(){return OI||(OI=1,Object.defineProperty(Qw,"__esModule",{value:!0})),Qw}var Yw={},SI;function tre(){return SI||(SI=1,Object.defineProperty(Yw,"__esModule",{value:!0})),Yw}var e0={},EI;function rre(){return EI||(EI=1,Object.defineProperty(e0,"__esModule",{value:!0})),e0}var t0={},RI;function nre(){return RI||(RI=1,Object.defineProperty(t0,"__esModule",{value:!0})),t0}var r0={},CI;function ire(){return CI||(CI=1,Object.defineProperty(r0,"__esModule",{value:!0})),r0}var n0={},PI;function are(){return PI||(PI=1,Object.defineProperty(n0,"__esModule",{value:!0})),n0}var i0={},jI;function ore(){return jI||(jI=1,Object.defineProperty(i0,"__esModule",{value:!0})),i0}var a0={},TI;function sre(){return TI||(TI=1,Object.defineProperty(a0,"__esModule",{value:!0})),a0}var o0={},MI;function ure(){return MI||(MI=1,Object.defineProperty(o0,"__esModule",{value:!0})),o0}var s0={},AI;function lre(){return AI||(AI=1,Object.defineProperty(s0,"__esModule",{value:!0})),s0}var u0={},II;function cre(){return II||(II=1,Object.defineProperty(u0,"__esModule",{value:!0})),u0}var l0={},DI;function fre(){return DI||(DI=1,Object.defineProperty(l0,"__esModule",{value:!0})),l0}var c0={},xI;function dre(){return xI||(xI=1,Object.defineProperty(c0,"__esModule",{value:!0})),c0}var f0={},$I;function hre(){return $I||($I=1,Object.defineProperty(f0,"__esModule",{value:!0})),f0}var d0={},NI;function pre(){return NI||(NI=1,Object.defineProperty(d0,"__esModule",{value:!0})),d0}var h0={},qI;function _re(){return qI||(qI=1,Object.defineProperty(h0,"__esModule",{value:!0})),h0}var p0={},zI;function yre(){return zI||(zI=1,Object.defineProperty(p0,"__esModule",{value:!0})),p0}var _0={},BI;function bre(){return BI||(BI=1,Object.defineProperty(_0,"__esModule",{value:!0})),_0}var y0={},UI;function mre(){return UI||(UI=1,Object.defineProperty(y0,"__esModule",{value:!0})),y0}var b0={},FI;function gre(){return FI||(FI=1,Object.defineProperty(b0,"__esModule",{value:!0})),b0}var m0={},LI;function vre(){return LI||(LI=1,Object.defineProperty(m0,"__esModule",{value:!0})),m0}var g0={},VI;function wre(){return VI||(VI=1,Object.defineProperty(g0,"__esModule",{value:!0})),g0}var v0={},GI;function Ore(){return GI||(GI=1,Object.defineProperty(v0,"__esModule",{value:!0})),v0}var w0={},kI;function Sre(){return kI||(kI=1,Object.defineProperty(w0,"__esModule",{value:!0})),w0}var O0={},HI;function Ere(){return HI||(HI=1,Object.defineProperty(O0,"__esModule",{value:!0})),O0}var S0={},WI;function Rre(){return WI||(WI=1,Object.defineProperty(S0,"__esModule",{value:!0})),S0}var E0={},KI;function Cre(){return KI||(KI=1,Object.defineProperty(E0,"__esModule",{value:!0})),E0}var R0={},JI;function Pre(){return JI||(JI=1,Object.defineProperty(R0,"__esModule",{value:!0})),R0}var C0={},XI;function jre(){return XI||(XI=1,Object.defineProperty(C0,"__esModule",{value:!0})),C0}var P0={},ZI;function Tre(){return ZI||(ZI=1,Object.defineProperty(P0,"__esModule",{value:!0})),P0}var j0={},QI;function Mre(){return QI||(QI=1,Object.defineProperty(j0,"__esModule",{value:!0})),j0}var T0={},YI;function Are(){return YI||(YI=1,Object.defineProperty(T0,"__esModule",{value:!0})),T0}var M0={},eD;function Ire(){return eD||(eD=1,Object.defineProperty(M0,"__esModule",{value:!0})),M0}var A0={},tD;function Dre(){return tD||(tD=1,Object.defineProperty(A0,"__esModule",{value:!0})),A0}var I0={},rD;function xre(){return rD||(rD=1,Object.defineProperty(I0,"__esModule",{value:!0})),I0}var D0={},nD;function $re(){return nD||(nD=1,Object.defineProperty(D0,"__esModule",{value:!0})),D0}var x0={},iD;function Nre(){return iD||(iD=1,Object.defineProperty(x0,"__esModule",{value:!0})),x0}var zd={},aD;function qre(){return aD||(aD=1,Object.defineProperty(zd,"__esModule",{value:!0}),zd.EmbedInputType=void 0,zd.EmbedInputType={SearchDocument:"search_document",SearchQuery:"search_query",Classification:"classification",Clustering:"clustering",Image:"image"}),zd}var Bd={},oD;function zre(){return oD||(oD=1,Object.defineProperty(Bd,"__esModule",{value:!0}),Bd.EmbeddingType=void 0,Bd.EmbeddingType={Float:"float",Int8:"int8",Uint8:"uint8",Binary:"binary",Ubinary:"ubinary"}),Bd}var $0={},sD;function Bre(){return sD||(sD=1,Object.defineProperty($0,"__esModule",{value:!0})),$0}var N0={},uD;function Ure(){return uD||(uD=1,Object.defineProperty(N0,"__esModule",{value:!0})),N0}var q0={},lD;function Fre(){return lD||(lD=1,Object.defineProperty(q0,"__esModule",{value:!0})),q0}var z0={},cD;function Lre(){return cD||(cD=1,Object.defineProperty(z0,"__esModule",{value:!0})),z0}var Ud={},fD;function Vre(){return fD||(fD=1,Object.defineProperty(Ud,"__esModule",{value:!0}),Ud.EmbedJobStatus=void 0,Ud.EmbedJobStatus={Processing:"processing",Complete:"complete",Cancelling:"cancelling",Cancelled:"cancelled",Failed:"failed"}),Ud}var Fd={},dD;function Gre(){return dD||(dD=1,Object.defineProperty(Fd,"__esModule",{value:!0}),Fd.EmbedJobTruncate=void 0,Fd.EmbedJobTruncate={Start:"START",End:"END"}),Fd}var B0={},hD;function kre(){return hD||(hD=1,Object.defineProperty(B0,"__esModule",{value:!0})),B0}var U0={},pD;function Hre(){return pD||(pD=1,Object.defineProperty(U0,"__esModule",{value:!0})),U0}var F0={},_D;function Wre(){return _D||(_D=1,Object.defineProperty(F0,"__esModule",{value:!0})),F0}var L0={},yD;function Kre(){return yD||(yD=1,Object.defineProperty(L0,"__esModule",{value:!0})),L0}var V0={},bD;function Jre(){return bD||(bD=1,Object.defineProperty(V0,"__esModule",{value:!0})),V0}var Ld={},mD;function Xre(){return mD||(mD=1,Object.defineProperty(Ld,"__esModule",{value:!0}),Ld.DatasetValidationStatus=void 0,Ld.DatasetValidationStatus={Unknown:"unknown",Queued:"queued",Processing:"processing",Failed:"failed",Validated:"validated",Skipped:"skipped"}),Ld}var Vd={},gD;function Zre(){return gD||(gD=1,Object.defineProperty(Vd,"__esModule",{value:!0}),Vd.DatasetType=void 0,Vd.DatasetType={EmbedInput:"embed-input",EmbedResult:"embed-result",ClusterResult:"cluster-result",ClusterOutliers:"cluster-outliers",RerankerFinetuneInput:"reranker-finetune-input",SingleLabelClassificationFinetuneInput:"single-label-classification-finetune-input",ChatFinetuneInput:"chat-finetune-input",MultiLabelClassificationFinetuneInput:"multi-label-classification-finetune-input"}),Vd}var G0={},vD;function Qre(){return vD||(vD=1,Object.defineProperty(G0,"__esModule",{value:!0})),G0}var k0={},wD;function Yre(){return wD||(wD=1,Object.defineProperty(k0,"__esModule",{value:!0})),k0}var H0={},OD;function ene(){return OD||(OD=1,Object.defineProperty(H0,"__esModule",{value:!0})),H0}var W0={},SD;function tne(){return SD||(SD=1,Object.defineProperty(W0,"__esModule",{value:!0})),W0}var K0={},ED;function rne(){return ED||(ED=1,Object.defineProperty(K0,"__esModule",{value:!0})),K0}var J0={},RD;function nne(){return RD||(RD=1,Object.defineProperty(J0,"__esModule",{value:!0})),J0}var X0={},CD;function ine(){return CD||(CD=1,Object.defineProperty(X0,"__esModule",{value:!0})),X0}var Z0={},PD;function ane(){return PD||(PD=1,Object.defineProperty(Z0,"__esModule",{value:!0})),Z0}var Q0={},jD;function one(){return jD||(jD=1,Object.defineProperty(Q0,"__esModule",{value:!0})),Q0}var Y0={},TD;function sne(){return TD||(TD=1,Object.defineProperty(Y0,"__esModule",{value:!0})),Y0}var eO={},MD;function une(){return MD||(MD=1,Object.defineProperty(eO,"__esModule",{value:!0})),eO}var tO={},AD;function lne(){return AD||(AD=1,Object.defineProperty(tO,"__esModule",{value:!0})),tO}var Gd={},ID;function cne(){return ID||(ID=1,Object.defineProperty(Gd,"__esModule",{value:!0}),Gd.ConnectorAuthStatus=void 0,Gd.ConnectorAuthStatus={Valid:"valid",Expired:"expired"}),Gd}var rO={},DD;function fne(){return DD||(DD=1,Object.defineProperty(rO,"__esModule",{value:!0})),rO}var nO={},xD;function dne(){return xD||(xD=1,Object.defineProperty(nO,"__esModule",{value:!0})),nO}var iO={},$D;function hne(){return $D||($D=1,Object.defineProperty(iO,"__esModule",{value:!0})),iO}var kd={},ND;function pne(){return ND||(ND=1,Object.defineProperty(kd,"__esModule",{value:!0}),kd.AuthTokenType=void 0,kd.AuthTokenType={Bearer:"bearer",Basic:"basic",Noscheme:"noscheme"}),kd}var aO={},qD;function _ne(){return qD||(qD=1,Object.defineProperty(aO,"__esModule",{value:!0})),aO}var oO={},zD;function yne(){return zD||(zD=1,Object.defineProperty(oO,"__esModule",{value:!0})),oO}var sO={},BD;function bne(){return BD||(BD=1,Object.defineProperty(sO,"__esModule",{value:!0})),sO}var uO={},UD;function mne(){return UD||(UD=1,Object.defineProperty(uO,"__esModule",{value:!0})),uO}var lO={},FD;function gne(){return FD||(FD=1,Object.defineProperty(lO,"__esModule",{value:!0})),lO}var cO={},LD;function vne(){return LD||(LD=1,Object.defineProperty(cO,"__esModule",{value:!0})),cO}var Hd={},VD;function wne(){return VD||(VD=1,Object.defineProperty(Hd,"__esModule",{value:!0}),Hd.CompatibleEndpoint=void 0,Hd.CompatibleEndpoint={Chat:"chat",Embed:"embed",Classify:"classify",Summarize:"summarize",Rerank:"rerank",Rate:"rate",Generate:"generate"}),Hd}var fO={},GD;function One(){return GD||(GD=1,Object.defineProperty(fO,"__esModule",{value:!0})),fO}var dO={},kD;function Sne(){return kD||(kD=1,Object.defineProperty(dO,"__esModule",{value:!0})),dO}var HD;function Ene(){return HD||(HD=1,function(a){var e=Il&&Il.__createBinding||(Object.create?function(r,n,i,o){o===void 0&&(o=i);var s=Object.getOwnPropertyDescriptor(n,i);(!s||("get"in s?!n.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(r,o,s)}:function(r,n,i,o){o===void 0&&(o=i),r[o]=n[i]}),t=Il&&Il.__exportStar||function(r,n){for(var i in r)i!=="default"&&!Object.prototype.hasOwnProperty.call(n,i)&&e(n,r,i)};Object.defineProperty(a,"__esModule",{value:!0}),t(XY(),a),t(ZY(),a),t(QY(),a),t(YY(),a),t(eee(),a),t(tee(),a),t(ree(),a),t(nee(),a),t(iee(),a),t(aee(),a),t(oee(),a),t(see(),a),t(uee(),a),t(lee(),a),t(cee(),a),t(fee(),a),t(dee(),a),t(hee(),a),t(pee(),a),t(_ee(),a),t(yee(),a),t(bee(),a),t(mee(),a),t(gee(),a),t(vee(),a),t(wee(),a),t(Oee(),a),t(See(),a),t(Eee(),a),t(Ree(),a),t(Cee(),a),t(Pee(),a),t(jee(),a),t(Tee(),a),t(Mee(),a),t(Aee(),a),t(Iee(),a),t(Dee(),a),t(xee(),a),t($ee(),a),t(Nee(),a),t(qee(),a),t(zee(),a),t(Bee(),a),t(Uee(),a),t(Fee(),a),t(Lee(),a),t(Vee(),a),t(Gee(),a),t(kee(),a),t(Hee(),a),t(Wee(),a),t(Kee(),a),t(Jee(),a),t(Xee(),a),t(Zee(),a),t(Qee(),a),t(Yee(),a),t(ete(),a),t(tte(),a),t(rte(),a),t(nte(),a),t(ite(),a),t(ate(),a),t(ote(),a),t(ste(),a),t(ute(),a),t(lte(),a),t(cte(),a),t(fte(),a),t(dte(),a),t(hte(),a),t(pte(),a),t(_te(),a),t(yte(),a),t(bte(),a),t(mte(),a),t(gte(),a),t(vte(),a),t(wte(),a),t(Ote(),a),t(Ste(),a),t(Ete(),a),t(Rte(),a),t(Cte(),a),t(Pte(),a),t(jte(),a),t(Tte(),a),t(Mte(),a),t(Ate(),a),t(Ite(),a),t(Dte(),a),t(xte(),a),t($te(),a),t(Nte(),a),t(qte(),a),t(zte(),a),t(Bte(),a),t(Ute(),a),t(Fte(),a),t(Lte(),a),t(Vte(),a),t(Gte(),a),t(kte(),a),t(Hte(),a),t(Wte(),a),t(Kte(),a),t(Jte(),a),t(Xte(),a),t(Zte(),a),t(Qte(),a),t(Yte(),a),t(ere(),a),t(tre(),a),t(rre(),a),t(nre(),a),t(ire(),a),t(are(),a),t(ore(),a),t(sre(),a),t(ure(),a),t(lre(),a),t(cre(),a),t(fre(),a),t(dre(),a),t(hre(),a),t(pre(),a),t(_re(),a),t(yre(),a),t(bre(),a),t(mre(),a),t(gre(),a),t(vre(),a),t(wre(),a),t(Ore(),a),t(Sre(),a),t(Ere(),a),t(Rre(),a),t(Cre(),a),t(Pre(),a),t(jre(),a),t(Tre(),a),t(Mre(),a),t(Are(),a),t(Ire(),a),t(Dre(),a),t(xre(),a),t($re(),a),t(Nre(),a),t(qre(),a),t(zre(),a),t(Bre(),a),t(Ure(),a),t(Fre(),a),t(Lre(),a),t(Vre(),a),t(Gre(),a),t(kre(),a),t(Hre(),a),t(Wre(),a),t(Kre(),a),t(Jre(),a),t(Xre(),a),t(Zre(),a),t(Qre(),a),t(Yre(),a),t(ene(),a),t(tne(),a),t(rne(),a),t(nne(),a),t(ine(),a),t(ane(),a),t(one(),a),t(sne(),a),t(une(),a),t(lne(),a),t(cne(),a),t(fne(),a),t(dne(),a),t(hne(),a),t(pne(),a),t(_ne(),a),t(yne(),a),t(bne(),a),t(mne(),a),t(gne(),a),t(vne(),a),t(wne(),a),t(One(),a),t(Sne(),a)}(Il)),Il}var Dl={},Gr={},hO={},Wd={},WD;function Rne(){if(WD)return Wd;WD=1,Object.defineProperty(Wd,"__esModule",{value:!0}),Wd.CohereError=void 0;let a=class E8 extends Error{constructor({message:r,statusCode:n,body:i}){super(e({message:r,statusCode:n,body:i})),Object.setPrototypeOf(this,E8.prototype),n!=null&&(this.statusCode=n),i!==void 0&&(this.body=i)}};Wd.CohereError=a;function e({message:t,statusCode:r,body:n}){let i=[];return t!=null&&i.push(t),r!=null&&i.push(`Status code: ${r.toString()}`),n!=null&&i.push(`Body: ${JSON.stringify(n,void 0,2)}`),i.join(`
`)}return Wd}var Kd={},KD;function Cne(){if(KD)return Kd;KD=1,Object.defineProperty(Kd,"__esModule",{value:!0}),Kd.CohereTimeoutError=void 0;let a=class R8 extends Error{constructor(t){super(t),Object.setPrototypeOf(this,R8.prototype)}};return Kd.CohereTimeoutError=a,Kd}var JD;function dt(){return JD||(JD=1,function(a){Object.defineProperty(a,"__esModule",{value:!0}),a.CohereTimeoutError=a.CohereError=void 0;var e=Rne();Object.defineProperty(a,"CohereError",{enumerable:!0,get:function(){return e.CohereError}});var t=Cne();Object.defineProperty(a,"CohereTimeoutError",{enumerable:!0,get:function(){return t.CohereTimeoutError}})}(hO)),hO}var XD;function Pne(){if(XD)return Gr;XD=1;var a=Gr&&Gr.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),e=Gr&&Gr.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),t=Gr&&Gr.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&a(o,i,s);return e(o,i),o};Object.defineProperty(Gr,"__esModule",{value:!0}),Gr.BadRequestError=void 0;const r=t(dt());class n extends r.CohereError{constructor(o){super({message:"BadRequestError",statusCode:400,body:o}),Object.setPrototypeOf(this,n.prototype)}}return Gr.BadRequestError=n,Gr}var kr={},ZD;function jne(){if(ZD)return kr;ZD=1;var a=kr&&kr.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),e=kr&&kr.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),t=kr&&kr.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&a(o,i,s);return e(o,i),o};Object.defineProperty(kr,"__esModule",{value:!0}),kr.UnauthorizedError=void 0;const r=t(dt());let n=class C8 extends r.CohereError{constructor(o){super({message:"UnauthorizedError",statusCode:401,body:o}),Object.setPrototypeOf(this,C8.prototype)}};return kr.UnauthorizedError=n,kr}var Hr={},QD;function Tne(){if(QD)return Hr;QD=1;var a=Hr&&Hr.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),e=Hr&&Hr.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),t=Hr&&Hr.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&a(o,i,s);return e(o,i),o};Object.defineProperty(Hr,"__esModule",{value:!0}),Hr.ForbiddenError=void 0;const r=t(dt());let n=class P8 extends r.CohereError{constructor(o){super({message:"ForbiddenError",statusCode:403,body:o}),Object.setPrototypeOf(this,P8.prototype)}};return Hr.ForbiddenError=n,Hr}var Wr={},YD;function Mne(){if(YD)return Wr;YD=1;var a=Wr&&Wr.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),e=Wr&&Wr.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),t=Wr&&Wr.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&a(o,i,s);return e(o,i),o};Object.defineProperty(Wr,"__esModule",{value:!0}),Wr.NotFoundError=void 0;const r=t(dt());class n extends r.CohereError{constructor(o){super({message:"NotFoundError",statusCode:404,body:o}),Object.setPrototypeOf(this,n.prototype)}}return Wr.NotFoundError=n,Wr}var Kr={},ex;function Ane(){if(ex)return Kr;ex=1;var a=Kr&&Kr.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),e=Kr&&Kr.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),t=Kr&&Kr.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&a(o,i,s);return e(o,i),o};Object.defineProperty(Kr,"__esModule",{value:!0}),Kr.UnprocessableEntityError=void 0;const r=t(dt());class n extends r.CohereError{constructor(o){super({message:"UnprocessableEntityError",statusCode:422,body:o}),Object.setPrototypeOf(this,n.prototype)}}return Kr.UnprocessableEntityError=n,Kr}var Jr={},tx;function Ine(){if(tx)return Jr;tx=1;var a=Jr&&Jr.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),e=Jr&&Jr.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),t=Jr&&Jr.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&a(o,i,s);return e(o,i),o};Object.defineProperty(Jr,"__esModule",{value:!0}),Jr.TooManyRequestsError=void 0;const r=t(dt());let n=class j8 extends r.CohereError{constructor(o){super({message:"TooManyRequestsError",statusCode:429,body:o}),Object.setPrototypeOf(this,j8.prototype)}};return Jr.TooManyRequestsError=n,Jr}var Xr={},rx;function Dne(){if(rx)return Xr;rx=1;var a=Xr&&Xr.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),e=Xr&&Xr.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),t=Xr&&Xr.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&a(o,i,s);return e(o,i),o};Object.defineProperty(Xr,"__esModule",{value:!0}),Xr.InvalidTokenError=void 0;const r=t(dt());let n=class T8 extends r.CohereError{constructor(o){super({message:"InvalidTokenError",statusCode:498,body:o}),Object.setPrototypeOf(this,T8.prototype)}};return Xr.InvalidTokenError=n,Xr}var Zr={},nx;function xne(){if(nx)return Zr;nx=1;var a=Zr&&Zr.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),e=Zr&&Zr.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),t=Zr&&Zr.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&a(o,i,s);return e(o,i),o};Object.defineProperty(Zr,"__esModule",{value:!0}),Zr.ClientClosedRequestError=void 0;const r=t(dt());let n=class M8 extends r.CohereError{constructor(o){super({message:"ClientClosedRequestError",statusCode:499,body:o}),Object.setPrototypeOf(this,M8.prototype)}};return Zr.ClientClosedRequestError=n,Zr}var Qr={},ix;function $ne(){if(ix)return Qr;ix=1;var a=Qr&&Qr.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),e=Qr&&Qr.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),t=Qr&&Qr.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&a(o,i,s);return e(o,i),o};Object.defineProperty(Qr,"__esModule",{value:!0}),Qr.InternalServerError=void 0;const r=t(dt());class n extends r.CohereError{constructor(o){super({message:"InternalServerError",statusCode:500,body:o}),Object.setPrototypeOf(this,n.prototype)}}return Qr.InternalServerError=n,Qr}var Yr={},ax;function Nne(){if(ax)return Yr;ax=1;var a=Yr&&Yr.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),e=Yr&&Yr.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),t=Yr&&Yr.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&a(o,i,s);return e(o,i),o};Object.defineProperty(Yr,"__esModule",{value:!0}),Yr.NotImplementedError=void 0;const r=t(dt());let n=class A8 extends r.CohereError{constructor(o){super({message:"NotImplementedError",statusCode:501,body:o}),Object.setPrototypeOf(this,A8.prototype)}};return Yr.NotImplementedError=n,Yr}var en={},ox;function qne(){if(ox)return en;ox=1;var a=en&&en.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),e=en&&en.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),t=en&&en.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&a(o,i,s);return e(o,i),o};Object.defineProperty(en,"__esModule",{value:!0}),en.ServiceUnavailableError=void 0;const r=t(dt());let n=class I8 extends r.CohereError{constructor(o){super({message:"ServiceUnavailableError",statusCode:503,body:o}),Object.setPrototypeOf(this,I8.prototype)}};return en.ServiceUnavailableError=n,en}var tn={},sx;function zne(){if(sx)return tn;sx=1;var a=tn&&tn.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),e=tn&&tn.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),t=tn&&tn.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&a(o,i,s);return e(o,i),o};Object.defineProperty(tn,"__esModule",{value:!0}),tn.GatewayTimeoutError=void 0;const r=t(dt());let n=class D8 extends r.CohereError{constructor(o){super({message:"GatewayTimeoutError",statusCode:504,body:o}),Object.setPrototypeOf(this,D8.prototype)}};return tn.GatewayTimeoutError=n,tn}var ux;function Bne(){return ux||(ux=1,function(a){var e=Dl&&Dl.__createBinding||(Object.create?function(r,n,i,o){o===void 0&&(o=i);var s=Object.getOwnPropertyDescriptor(n,i);(!s||("get"in s?!n.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(r,o,s)}:function(r,n,i,o){o===void 0&&(o=i),r[o]=n[i]}),t=Dl&&Dl.__exportStar||function(r,n){for(var i in r)i!=="default"&&!Object.prototype.hasOwnProperty.call(n,i)&&e(n,r,i)};Object.defineProperty(a,"__esModule",{value:!0}),t(Pne(),a),t(jne(),a),t(Tne(),a),t(Mne(),a),t(Ane(),a),t(Ine(),a),t(Dne(),a),t(xne(),a),t($ne(),a),t(Nne(),a),t(qne(),a),t(zne(),a)}(Dl)),Dl}var xl={},pO={},lx;function Une(){return lx||(lx=1,Object.defineProperty(pO,"__esModule",{value:!0})),pO}var cx;function Fne(){return cx||(cx=1,function(a){var e=xl&&xl.__createBinding||(Object.create?function(r,n,i,o){o===void 0&&(o=i);var s=Object.getOwnPropertyDescriptor(n,i);(!s||("get"in s?!n.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(r,o,s)}:function(r,n,i,o){o===void 0&&(o=i),r[o]=n[i]}),t=xl&&xl.__exportStar||function(r,n){for(var i in r)i!=="default"&&!Object.prototype.hasOwnProperty.call(n,i)&&e(n,r,i)};Object.defineProperty(a,"__esModule",{value:!0}),t(Une(),a)}(xl)),xl}var fx;function tl(){return fx||(fx=1,function(a){var e=pl&&pl.__createBinding||(Object.create?function(r,n,i,o){o===void 0&&(o=i);var s=Object.getOwnPropertyDescriptor(n,i);(!s||("get"in s?!n.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(r,o,s)}:function(r,n,i,o){o===void 0&&(o=i),r[o]=n[i]}),t=pl&&pl.__exportStar||function(r,n){for(var i in r)i!=="default"&&!Object.prototype.hasOwnProperty.call(n,i)&&e(n,r,i)};Object.defineProperty(a,"__esModule",{value:!0}),t(JY(),a),t(Ene(),a),t(Bne(),a),t(Fne(),a)}(pl)),pl}var Jd={},cr={};function Lne(a,e,t,r){function n(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function s(c){try{l(r.next(c))}catch(f){o(f)}}function u(c){try{l(r.throw(c))}catch(f){o(f)}}function l(c){c.done?i(c.value):n(c.value).then(s,u)}l((r=r.apply(a,e||[])).next())})}function Vne(a,e){var t={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,n,i,o=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return o.next=s(0),o.throw=s(1),o.return=s(2),typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(l){return function(c){return u([l,c])}}function u(l){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,l[0]&&(t=0)),t;)try{if(r=1,n&&(i=l[0]&2?n.return:l[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,l[1])).done)return i;switch(n=0,i&&(l=[l[0]&2,i.value]),l[0]){case 0:case 1:i=l;break;case 4:return t.label++,{value:l[1],done:!1};case 5:t.label++,n=l[1],l=[0];continue;case 7:l=t.ops.pop(),t.trys.pop();continue;default:if(i=t.trys,!(i=i.length>0&&i[i.length-1])&&(l[0]===6||l[0]===2)){t=0;continue}if(l[0]===3&&(!i||l[1]>i[0]&&l[1]<i[3])){t.label=l[1];break}if(l[0]===6&&t.label<i[1]){t.label=i[1],i=l;break}if(i&&t.label<i[2]){t.label=i[2],t.ops.push(l);break}i[2]&&t.ops.pop(),t.trys.pop();continue}l=e.call(a,t)}catch(c){l=[6,c],n=0}finally{r=i=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}var Mr=64,Gne=32,kne=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Hne=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],Wne=Math.pow(2,53)-1,hy=function(){function a(){this.state=Int32Array.from(Hne),this.temp=new Int32Array(64),this.buffer=new Uint8Array(64),this.bufferLength=0,this.bytesHashed=0,this.finished=!1}return a.prototype.update=function(e){if(this.finished)throw new Error("Attempted to update an already finished hash.");var t=0,r=e.byteLength;if(this.bytesHashed+=r,this.bytesHashed*8>Wne)throw new Error("Cannot hash more than 2^53 - 1 bits");for(;r>0;)this.buffer[this.bufferLength++]=e[t++],r--,this.bufferLength===Mr&&(this.hashBuffer(),this.bufferLength=0)},a.prototype.digest=function(){if(!this.finished){var e=this.bytesHashed*8,t=new DataView(this.buffer.buffer,this.buffer.byteOffset,this.buffer.byteLength),r=this.bufferLength;if(t.setUint8(this.bufferLength++,128),r%Mr>=Mr-8){for(var n=this.bufferLength;n<Mr;n++)t.setUint8(n,0);this.hashBuffer(),this.bufferLength=0}for(var n=this.bufferLength;n<Mr-8;n++)t.setUint8(n,0);t.setUint32(Mr-8,Math.floor(e/4294967296),!0),t.setUint32(Mr-4,e),this.hashBuffer(),this.finished=!0}for(var i=new Uint8Array(Gne),n=0;n<8;n++)i[n*4]=this.state[n]>>>24&255,i[n*4+1]=this.state[n]>>>16&255,i[n*4+2]=this.state[n]>>>8&255,i[n*4+3]=this.state[n]>>>0&255;return i},a.prototype.hashBuffer=function(){for(var e=this,t=e.buffer,r=e.state,n=r[0],i=r[1],o=r[2],s=r[3],u=r[4],l=r[5],c=r[6],f=r[7],p=0;p<Mr;p++){if(p<16)this.temp[p]=(t[p*4]&255)<<24|(t[p*4+1]&255)<<16|(t[p*4+2]&255)<<8|t[p*4+3]&255;else{var h=this.temp[p-2],y=(h>>>17|h<<15)^(h>>>19|h<<13)^h>>>10;h=this.temp[p-15];var d=(h>>>7|h<<25)^(h>>>18|h<<14)^h>>>3;this.temp[p]=(y+this.temp[p-7]|0)+(d+this.temp[p-16]|0)}var _=(((u>>>6|u<<26)^(u>>>11|u<<21)^(u>>>25|u<<7))+(u&l^~u&c)|0)+(f+(kne[p]+this.temp[p]|0)|0)|0,m=((n>>>2|n<<30)^(n>>>13|n<<19)^(n>>>22|n<<10))+(n&i^n&o^i&o)|0;f=c,c=l,l=u,u=s+_|0,s=o,o=i,i=n,n=_+m|0}r[0]+=n,r[1]+=i,r[2]+=o,r[3]+=s,r[4]+=u,r[5]+=l,r[6]+=c,r[7]+=f},a}();const Kne=a=>new TextEncoder().encode(a);var Jne=typeof Buffer<"u"&&Buffer.from?function(a){return Buffer.from(a,"utf8")}:Kne;function x8(a){return a instanceof Uint8Array?a:typeof a=="string"?Jne(a):ArrayBuffer.isView(a)?new Uint8Array(a.buffer,a.byteOffset,a.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(a)}function Xne(a){return typeof a=="string"?a.length===0:a.byteLength===0}var Zne=function(){function a(e){this.secret=e,this.hash=new hy,this.reset()}return a.prototype.update=function(e){if(!(Xne(e)||this.error))try{this.hash.update(x8(e))}catch(t){this.error=t}},a.prototype.digestSync=function(){if(this.error)throw this.error;return this.outer?(this.outer.finished||this.outer.update(this.hash.digest()),this.outer.digest()):this.hash.digest()},a.prototype.digest=function(){return Lne(this,void 0,void 0,function(){return Vne(this,function(e){return[2,this.digestSync()]})})},a.prototype.reset=function(){if(this.hash=new hy,this.secret){this.outer=new hy;var e=Qne(this.secret),t=new Uint8Array(Mr);t.set(e);for(var r=0;r<Mr;r++)e[r]^=54,t[r]^=92;this.hash.update(e),this.outer.update(t);for(var r=0;r<e.byteLength;r++)e[r]=0}},a}();function Qne(a){var e=x8(a);if(e.byteLength>Mr){var t=new hy;t.update(e),e=t.digest()}var r=new Uint8Array(Mr);return r.set(e),r}const Yne=Object.freeze(Object.defineProperty({__proto__:null,Sha256:Zne},Symbol.toStringTag,{value:"Module"})),eie=Mc(Yne);class CC extends Error{constructor(e,t=!0){var i;let r,n=!0;typeof t=="boolean"?(r=void 0,n=t):t!=null&&typeof t=="object"&&(r=t.logger,n=t.tryNextLink??!0),super(e),this.name="ProviderError",this.tryNextLink=n,Object.setPrototypeOf(this,CC.prototype),(i=r==null?void 0:r.debug)==null||i.call(r,`@smithy/property-provider ${n?"->":"(!)"} ${e}`)}static from(e,t=!0){return Object.assign(new this(e.message,t),e)}}class wr extends CC{constructor(e,t=!0){super(e,t),this.name="CredentialsProviderError",Object.setPrototypeOf(this,wr.prototype)}}function $8(a){return Promise.all(Object.keys(a).reduce((e,t)=>{const r=a[t];return typeof r=="string"?e.push([t,r]):e.push(r().then(n=>[t,n])),e},[])).then(e=>e.reduce((t,[r,n])=>(t[r]=n,t),{}))}function N8(a){return async e=>{var l;(l=a.logger)==null||l.debug("@aws-sdk/credential-provider-cognito-identity - fromCognitoIdentity");const{GetCredentialsForIdentityCommand:t,CognitoIdentityClient:r}=await Lu(async()=>{const{GetCredentialsForIdentityCommand:c,CognitoIdentityClient:f}=await import("./loadCognitoIdentity.js");return{GetCredentialsForIdentityCommand:c,CognitoIdentityClient:f}},__vite__mapDeps([0,1]),import.meta.url),n=c=>{var f,p,h;return((f=a.clientConfig)==null?void 0:f[c])??((p=a.parentClientConfig)==null?void 0:p[c])??((h=e==null?void 0:e.callerClientConfig)==null?void 0:h[c])},{Credentials:{AccessKeyId:i=tie(a.logger),Expiration:o,SecretKey:s=nie(a.logger),SessionToken:u}=rie(a.logger)}=await(a.client??new r(Object.assign({},a.clientConfig??{},{region:n("region"),profile:n("profile")}))).send(new t({CustomRoleArn:a.customRoleArn,IdentityId:a.identityId,Logins:a.logins?await $8(a.logins):void 0}));return{identityId:a.identityId,accessKeyId:i,secretAccessKey:s,sessionToken:u,expiration:o}}}function tie(a){throw new wr("Response from Amazon Cognito contained no access key ID",{logger:a})}function rie(a){throw new wr("Response from Amazon Cognito contained no credentials",{logger:a})}function nie(a){throw new wr("Response from Amazon Cognito contained no secret key",{logger:a})}const _O="IdentityIds";class iie{constructor(e="aws:cognito-identity-ids"){Zs(this,"dbName");this.dbName=e}getItem(e){return this.withObjectStore("readonly",t=>{const r=t.get(e);return new Promise(n=>{r.onerror=()=>n(null),r.onsuccess=()=>n(r.result?r.result.value:null)})}).catch(()=>null)}removeItem(e){return this.withObjectStore("readwrite",t=>{const r=t.delete(e);return new Promise((n,i)=>{r.onerror=()=>i(r.error),r.onsuccess=()=>n()})})}setItem(e,t){return this.withObjectStore("readwrite",r=>{const n=r.put({id:e,value:t});return new Promise((i,o)=>{n.onerror=()=>o(n.error),n.onsuccess=()=>i()})})}getDb(){const e=self.indexedDB.open(this.dbName,1);return new Promise((t,r)=>{e.onsuccess=()=>{t(e.result)},e.onerror=()=>{r(e.error)},e.onblocked=()=>{r(new Error("Unable to access DB"))},e.onupgradeneeded=()=>{const n=e.result;n.onerror=()=>{r(new Error("Failed to create object store"))},n.createObjectStore(_O,{keyPath:"id"})}})}withObjectStore(e,t){return this.getDb().then(r=>{const n=r.transaction(_O,e);return n.oncomplete=()=>r.close(),new Promise((i,o)=>{n.onerror=()=>o(n.error),i(t(n.objectStore(_O)))}).catch(i=>{throw r.close(),i})})}}class aie{constructor(e={}){Zs(this,"store");this.store=e}getItem(e){return e in this.store?this.store[e]:null}removeItem(e){delete this.store[e]}setItem(e,t){this.store[e]=t}}const oie=new aie;function sie(){return typeof self=="object"&&self.indexedDB?new iie:typeof window=="object"&&window.localStorage?window.localStorage:oie}function uie({accountId:a,cache:e=sie(),client:t,clientConfig:r,customRoleArn:n,identityPoolId:i,logins:o,userIdentifier:s=!o||Object.keys(o).length===0?"ANONYMOUS":void 0,logger:u,parentClientConfig:l}){u==null||u.debug("@aws-sdk/credential-provider-cognito-identity - fromCognitoIdentity");const c=s?`aws:cognito-identity-credentials:${i}:${s}`:void 0;let f=async p=>{const{GetIdCommand:h,CognitoIdentityClient:y}=await Lu(async()=>{const{GetIdCommand:b,CognitoIdentityClient:g}=await import("./loadCognitoIdentity.js");return{GetIdCommand:b,CognitoIdentityClient:g}},__vite__mapDeps([0,1]),import.meta.url),d=b=>{var g;return(r==null?void 0:r[b])??(l==null?void 0:l[b])??((g=p==null?void 0:p.callerClientConfig)==null?void 0:g[b])},_=t??new y(Object.assign({},r??{},{region:d("region"),profile:d("profile")}));let m=c&&await e.getItem(c);if(!m){const{IdentityId:b=lie(u)}=await _.send(new h({AccountId:a,IdentityPoolId:i,Logins:o?await $8(o):void 0}));m=b,c&&Promise.resolve(e.setItem(c,m)).catch(()=>{})}return f=N8({client:_,customRoleArn:n,logins:o,identityId:m}),f(p)};return p=>f(p).catch(async h=>{throw c&&Promise.resolve(e.removeItem(c)).catch(()=>{}),h})}function lie(a){throw new wr("Response from Amazon Cognito contained no identity ID",{logger:a})}const cie=a=>N8({...a}),fie=a=>uie({...a});var dx;(function(a){a.HEADER="header",a.QUERY="query"})(dx||(dx={}));var hx;(function(a){a.HEADER="header",a.QUERY="query"})(hx||(hx={}));var px;(function(a){a.HTTP="http",a.HTTPS="https"})(px||(px={}));var _x;(function(a){a.MD5="md5",a.CRC32="crc32",a.CRC32C="crc32c",a.SHA1="sha1",a.SHA256="sha256"})(_x||(_x={}));var yx;(function(a){a[a.HEADER=0]="HEADER",a[a.TRAILER=1]="TRAILER"})(yx||(yx={}));var bx;(function(a){a.PROFILE="profile",a.SSO_SESSION="sso-session",a.SERVICES="services"})(bx||(bx={}));var mx;(function(a){a.HTTP_0_9="http/0.9",a.HTTP_1_0="http/1.0",a.TDS_8_0="tds/8.0"})(mx||(mx={}));let gx=class{constructor(e){this.statusCode=e.statusCode,this.reason=e.reason,this.headers=e.headers||{},this.body=e.body}static isInstance(e){if(!e)return!1;const t=e;return typeof t.statusCode=="number"&&typeof t.headers=="object"}};const yO=a=>encodeURIComponent(a).replace(/[!'()*]/g,die),die=a=>`%${a.charCodeAt(0).toString(16).toUpperCase()}`;function hie(a){const e=[];for(let t of Object.keys(a).sort()){const r=a[t];if(t=yO(t),Array.isArray(r))for(let n=0,i=r.length;n<i;n++)e.push(`${t}=${yO(r[n])}`);else{let n=t;(r||typeof r=="string")&&(n+=`=${yO(r)}`),e.push(n)}}return e.join("&")}function vx(a,e){return new Request(a,e)}function pie(a=0){return new Promise((e,t)=>{a&&setTimeout(()=>{const r=new Error(`Request did not complete within ${a} ms`);r.name="TimeoutError",t(r)},a)})}const bO={supported:void 0};class PC{static create(e){return typeof(e==null?void 0:e.handle)=="function"?e:new PC(e)}constructor(e){typeof e=="function"?this.configProvider=e().then(t=>t||{}):(this.config=e??{},this.configProvider=Promise.resolve(this.config)),bO.supported===void 0&&(bO.supported=typeof Request<"u"&&"keepalive"in vx("https://[::1]"))}destroy(){}async handle(e,{abortSignal:t}={}){var m;this.config||(this.config=await this.configProvider);const r=this.config.requestTimeout,n=this.config.keepAlive===!0,i=this.config.credentials;if(t!=null&&t.aborted){const b=new Error("Request aborted");return b.name="AbortError",Promise.reject(b)}let o=e.path;const s=hie(e.query||{});s&&(o+=`?${s}`),e.fragment&&(o+=`#${e.fragment}`);let u="";if(e.username!=null||e.password!=null){const b=e.username??"",g=e.password??"";u=`${b}:${g}@`}const{port:l,method:c}=e,f=`${e.protocol}//${u}${e.hostname}${l?`:${l}`:""}${o}`,p=c==="GET"||c==="HEAD"?void 0:e.body,h={body:p,headers:new Headers(e.headers),method:c,credentials:i};(m=this.config)!=null&&m.cache&&(h.cache=this.config.cache),p&&(h.duplex="half"),typeof AbortController<"u"&&(h.signal=t),bO.supported&&(h.keepalive=n),typeof this.config.requestInit=="function"&&Object.assign(h,this.config.requestInit(e));let y=()=>{};const d=vx(f,h),_=[fetch(d).then(b=>{const g=b.headers,v={};for(const S of g.entries())v[S[0]]=S[1];return b.body!=null?{response:new gx({headers:v,reason:b.statusText,statusCode:b.status,body:b.body})}:b.blob().then(S=>({response:new gx({headers:v,reason:b.statusText,statusCode:b.status,body:S})}))}),pie(r)];return t&&_.push(new Promise((b,g)=>{const v=()=>{const w=new Error("Request aborted");w.name="AbortError",g(w)};if(typeof t.addEventListener=="function"){const w=t;w.addEventListener("abort",v,{once:!0}),y=()=>w.removeEventListener("abort",v)}else t.onabort=v})),Promise.race(_).finally(y)}updateHttpClientConfig(e,t){this.config=void 0,this.configProvider=this.configProvider.then(r=>(r[e]=t,r))}httpHandlerConfigs(){return this.config??{}}}const Qu={},Ff=new Array(64);for(let a=0,e=65,t=90;a+e<=t;a++){const r=String.fromCharCode(a+e);Qu[r]=a,Ff[a]=r}for(let a=0,e=97,t=122;a+e<=t;a++){const r=String.fromCharCode(a+e),n=a+26;Qu[r]=n,Ff[n]=r}for(let a=0;a<10;a++){Qu[a.toString(10)]=a+52;const e=a.toString(10),t=a+52;Qu[e]=t,Ff[t]=e}Qu["+"]=62;Ff[62]="+";Qu["/"]=63;Ff[63]="/";const bf=6,sp=8,_ie=63,yie=a=>{let e=a.length/4*3;a.slice(-2)==="=="?e-=2:a.slice(-1)==="="&&e--;const t=new ArrayBuffer(e),r=new DataView(t);for(let n=0;n<a.length;n+=4){let i=0,o=0;for(let l=n,c=n+3;l<=c;l++)if(a[l]!=="="){if(!(a[l]in Qu))throw new TypeError(`Invalid character ${a[l]} in base64 string.`);i|=Qu[a[l]]<<(c-l)*bf,o+=bf}else i>>=bf;const s=n/4*3;i>>=o%sp;const u=Math.floor(o/sp);for(let l=0;l<u;l++){const c=(u-l-1)*sp;r.setUint8(s+l,(i&255<<c)>>c)}}return new Uint8Array(t)},bie=a=>new TextEncoder().encode(a);function mie(a){let e;typeof a=="string"?e=bie(a):e=a;const t=typeof e=="object"&&typeof e.length=="number",r=typeof e=="object"&&typeof e.byteOffset=="number"&&typeof e.byteLength=="number";if(!t&&!r)throw new Error("@smithy/util-base64: toBase64 encoder function only accepts string | Uint8Array.");let n="";for(let i=0;i<e.length;i+=3){let o=0,s=0;for(let l=i,c=Math.min(i+3,e.length);l<c;l++)o|=e[l]<<(c-l-1)*sp,s+=sp;const u=Math.ceil(s/bf);o<<=u*bf-s;for(let l=1;l<=u;l++){const c=(u-l)*bf;n+=Ff[(o&_ie<<c)>>c]}n+="==".slice(0,4-u)}return n}const gie=async a=>{var e;return typeof Blob=="function"&&a instanceof Blob||((e=a.constructor)==null?void 0:e.name)==="Blob"?Blob.prototype.arrayBuffer!==void 0?new Uint8Array(await a.arrayBuffer()):vie(a):wie(a)};async function vie(a){const e=await Oie(a),t=yie(e);return new Uint8Array(t)}async function wie(a){const e=[],t=a.getReader();let r=!1,n=0;for(;!r;){const{done:s,value:u}=await t.read();u&&(e.push(u),n+=u.length),r=s}const i=new Uint8Array(n);let o=0;for(const s of e)i.set(s,o),o+=s.length;return i}function Oie(a){return new Promise((e,t)=>{const r=new FileReader;r.onloadend=()=>{if(r.readyState!==2)return t(new Error("Reader aborted too early"));const n=r.result??"",i=n.indexOf(","),o=i>-1?i+1:n.length;e(n.substring(o))},r.onabort=()=>t(new Error("Read aborted")),r.onerror=()=>t(r.error),r.readAsDataURL(a)})}const Sie="169.254.170.2",Eie="169.254.170.23",Rie="[fd00:ec2::23]",Cie=(a,e)=>{if(a.protocol!=="https:"&&!(a.hostname===Sie||a.hostname===Eie||a.hostname===Rie)){if(a.hostname.includes("[")){if(a.hostname==="[::1]"||a.hostname==="[0000:0000:0000:0000:0000:0000:0000:0001]")return}else{if(a.hostname==="localhost")return;const t=a.hostname.split("."),r=n=>{const i=parseInt(n,10);return 0<=i&&i<=255};if(t[0]==="127"&&r(t[1])&&r(t[2])&&r(t[3])&&t.length===4)return}throw new wr(`URL not accepted. It must either be HTTPS or match one of the following:
  - loopback CIDR 127.0.0.0/8 or [::1/128]
  - ECS container host 169.254.170.2
  - EKS container host 169.254.170.23 or [fd00:ec2::23]`,{logger:e})}};let Pie=class eR{constructor(e){this.method=e.method||"GET",this.hostname=e.hostname||"localhost",this.port=e.port,this.query=e.query||{},this.headers=e.headers||{},this.body=e.body,this.protocol=e.protocol?e.protocol.slice(-1)!==":"?`${e.protocol}:`:e.protocol:"https:",this.path=e.path?e.path.charAt(0)!=="/"?`/${e.path}`:e.path:"/",this.username=e.username,this.password=e.password,this.fragment=e.fragment}static clone(e){const t=new eR({...e,headers:{...e.headers}});return t.query&&(t.query=jie(t.query)),t}static isInstance(e){if(!e)return!1;const t=e;return"method"in t&&"protocol"in t&&"hostname"in t&&"path"in t&&typeof t.query=="object"&&typeof t.headers=="object"}clone(){return eR.clone(this)}};function jie(a){return Object.keys(a).reduce((e,t)=>{const r=a[t];return{...e,[t]:Array.isArray(r)?[...r]:r}},{})}const Tie=a=>{if(typeof a=="string")return a;if(typeof a!="object"||typeof a.byteOffset!="number"||typeof a.byteLength!="number")throw new Error("@smithy/util-utf8: toUtf8 encoder function only accepts string | Uint8Array.");return new TextDecoder("utf-8").decode(a)},wx=a=>{var e;return typeof ReadableStream=="function"&&(((e=a==null?void 0:a.constructor)==null?void 0:e.name)===ReadableStream.name||a instanceof ReadableStream)},q8={},tR={};for(let a=0;a<256;a++){let e=a.toString(16).toLowerCase();e.length===1&&(e=`0${e}`),q8[a]=e,tR[e]=a}function ohe(a){if(a.length%2!==0)throw new Error("Hex encoded strings must have an even number length");const e=new Uint8Array(a.length/2);for(let t=0;t<a.length;t+=2){const r=a.slice(t,t+2).toLowerCase();if(r in tR)e[t/2]=tR[r];else throw new Error(`Cannot decode unrecognized sequence ${r} as hexadecimal`)}return e}function Mie(a){let e="";for(let t=0;t<a.byteLength;t++)e+=q8[a[t]];return e}const Ox="The stream has already been transformed.",Aie=a=>{var n,i;if(!Sx(a)&&!wx(a)){const o=((i=(n=a==null?void 0:a.__proto__)==null?void 0:n.constructor)==null?void 0:i.name)||a;throw new Error(`Unexpected stream implementation, expect Blob or ReadableStream, got ${o}`)}let e=!1;const t=async()=>{if(e)throw new Error(Ox);return e=!0,await gie(a)},r=o=>{if(typeof o.stream!="function")throw new Error(`Cannot transform payload Blob to web stream. Please make sure the Blob.stream() is polyfilled.
If you are using React Native, this API is not yet supported, see: https://react-native.canny.io/feature-requests/p/fetch-streaming-body`);return o.stream()};return Object.assign(a,{transformToByteArray:t,transformToString:async o=>{const s=await t();if(o==="base64")return mie(s);if(o==="hex")return Mie(s);if(o===void 0||o==="utf8"||o==="utf-8")return Tie(s);if(typeof TextDecoder=="function")return new TextDecoder(o).decode(s);throw new Error("TextDecoder is not available, please make sure polyfill is provided.")},transformToWebStream:()=>{if(e)throw new Error(Ox);if(e=!0,Sx(a))return r(a);if(wx(a))return a;throw new Error(`Cannot transform payload to web stream, got ${a}`)}})},Sx=a=>typeof Blob=="function"&&a instanceof Blob,rR=a=>{if(a!=null){if(typeof a=="string"){const e=parseFloat(a);if(!Number.isNaN(e))return String(e)!==String(a)&&U8.warn(B8(`Expected number but observed string: ${a}`)),e}if(typeof a=="number")return a;throw new TypeError(`Expected number, got ${typeof a}: ${a}`)}},Iie=Math.ceil(2**127*(2-2**-23)),Ex=a=>{const e=rR(a);if(e!==void 0&&!Number.isNaN(e)&&e!==1/0&&e!==-1/0&&Math.abs(e)>Iie)throw new TypeError(`Expected 32-bit float, got ${a}`);return e},Die=a=>{if(a!=null){if(Number.isInteger(a)&&!Number.isNaN(a))return a;throw new TypeError(`Expected integer, got ${typeof a}: ${a}`)}},Rx=a=>jC(a,32),Cx=a=>jC(a,16),Px=a=>jC(a,8),jC=(a,e)=>{const t=Die(a);if(t!==void 0&&xie(t,e)!==t)throw new TypeError(`Expected ${e}-bit integer, got ${a}`);return t},xie=(a,e)=>{switch(e){case 32:return Int32Array.of(a)[0];case 16:return Int16Array.of(a)[0];case 8:return Int8Array.of(a)[0]}},she=(a,e)=>{if(a==null)throw new TypeError("Expected a non-null value");return a},uhe=a=>{if(a!=null){if(typeof a=="string")return a;if(["boolean","number","bigint"].includes(typeof a))return U8.warn(B8(`Expected string, got ${typeof a}: ${a}`)),String(a);throw new TypeError(`Expected string, got ${typeof a}: ${a}`)}},$ie=a=>rR(typeof a=="string"?t_(a):a),Nie=a=>Ex(typeof a=="string"?t_(a):a),qie=/(-?(?:0|[1-9]\d*)(?:\.\d+)?(?:[eE][+-]?\d+)?)|(-?Infinity)|(NaN)/g,t_=a=>{const e=a.match(qie);if(e===null||e[0].length!==a.length)throw new TypeError("Expected real number, got implicit NaN");return parseFloat(a)},lhe=a=>Rx(typeof a=="string"?t_(a):a),z8=a=>Cx(typeof a=="string"?t_(a):a),zie=a=>Px(typeof a=="string"?t_(a):a),B8=a=>String(new TypeError(a).stack||a).split(`
`).slice(0,5).filter(e=>!e.includes("stackTraceWarning")).join(`
`),U8={warn:console.warn},Bie=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],Uie=new RegExp(/^(\d{4})-(\d{2})-(\d{2})[tT](\d{2}):(\d{2}):(\d{2})(?:\.(\d+))?[zZ]$/),Fie=a=>{if(a==null)return;if(typeof a!="string")throw new TypeError("RFC-3339 date-times must be expressed as strings");const e=Uie.exec(a);if(!e)throw new TypeError("Invalid RFC-3339 date-time value");const[t,r,n,i,o,s,u,l]=e,c=z8(TC(r)),f=Ec(n,"month",1,12),p=Ec(i,"day",1,31);return F8(c,f,p,{hours:o,minutes:s,seconds:u,fractionalMilliseconds:l})},Lie=new RegExp(/^(\d{4})-(\d{2})-(\d{2})[tT](\d{2}):(\d{2}):(\d{2})(?:\.(\d+))?(([-+]\d{2}\:\d{2})|[zZ])$/),che=a=>{if(a==null)return;if(typeof a!="string")throw new TypeError("RFC-3339 date-times must be expressed as strings");const e=Lie.exec(a);if(!e)throw new TypeError("Invalid RFC-3339 date-time value");const[t,r,n,i,o,s,u,l,c]=e,f=z8(TC(r)),p=Ec(n,"month",1,12),h=Ec(i,"day",1,31),y=F8(f,p,h,{hours:o,minutes:s,seconds:u,fractionalMilliseconds:l});return c.toUpperCase()!="Z"&&y.setTime(y.getTime()-Wie(c)),y},fhe=a=>{if(a==null)return;let e;if(typeof a=="number")e=a;else if(typeof a=="string")e=$ie(a);else if(typeof a=="object"&&a.tag===1)e=a.value;else throw new TypeError("Epoch timestamps must be expressed as floating point numbers or their string representation");if(Number.isNaN(e)||e===1/0||e===-1/0)throw new TypeError("Epoch timestamps must be valid, non-Infinite, non-NaN numerics");return new Date(Math.round(e*1e3))},F8=(a,e,t,r)=>{const n=e-1;return Gie(a,n,t),new Date(Date.UTC(a,n,t,Ec(r.hours,"hour",0,23),Ec(r.minutes,"minute",0,59),Ec(r.seconds,"seconds",0,60),Hie(r.fractionalMilliseconds)))},Vie=[31,28,31,30,31,30,31,31,30,31,30,31],Gie=(a,e,t)=>{let r=Vie[e];if(e===1&&kie(a)&&(r=29),t>r)throw new TypeError(`Invalid day for ${Bie[e]} in ${a}: ${t}`)},kie=a=>a%4===0&&(a%100!==0||a%400===0),Ec=(a,e,t,r)=>{const n=zie(TC(a));if(n<t||n>r)throw new TypeError(`${e} must be between ${t} and ${r}, inclusive`);return n},Hie=a=>a==null?0:Nie("0."+a)*1e3,Wie=a=>{const e=a[0];let t=1;if(e=="+")t=1;else if(e=="-")t=-1;else throw new TypeError(`Offset direction, ${e}, must be "+" or "-"`);const r=Number(a.substring(1,3)),n=Number(a.substring(4,6));return t*(r*60+n)*60*1e3},TC=a=>{let e=0;for(;e<a.length-1&&a.charAt(e)==="0";)e++;return e===0?a:a.slice(e)};function Kie(a){return new Pie({protocol:a.protocol,hostname:a.hostname,port:Number(a.port),path:a.pathname,query:Array.from(a.searchParams.entries()).reduce((e,[t,r])=>(e[t]=r,e),{}),fragment:a.hash})}async function Jie(a,e){const r=await Aie(a.body).transformToString();if(a.statusCode===200){const n=JSON.parse(r);if(typeof n.AccessKeyId!="string"||typeof n.SecretAccessKey!="string"||typeof n.Token!="string"||typeof n.Expiration!="string")throw new wr("HTTP credential provider response not of the required format, an object matching: { AccessKeyId: string, SecretAccessKey: string, Token: string, Expiration: string(rfc3339) }",{logger:e});return{accessKeyId:n.AccessKeyId,secretAccessKey:n.SecretAccessKey,sessionToken:n.Token,expiration:Fie(n.Expiration)}}if(a.statusCode>=400&&a.statusCode<500){let n={};try{n=JSON.parse(r)}catch{}throw Object.assign(new wr(`Server responded with status: ${a.statusCode}`,{logger:e}),{Code:n.Code,Message:n.Message})}throw new wr(`Server responded with status: ${a.statusCode}`,{logger:e})}const Xie=(a,e,t)=>async()=>{for(let r=0;r<e;++r)try{return await a()}catch{await new Promise(i=>setTimeout(i,t))}return await a()},Zie=(a={})=>{var i;(i=a.logger)==null||i.debug("@aws-sdk/credential-provider-http - fromHttp");let e;const t=a.credentialsFullUri;if(t)e=t;else throw new wr("No HTTP credential provider host provided.",{logger:a.logger});const r=new URL(e);Cie(r,a.logger);const n=new PC;return Xie(async()=>{const o=Kie(r);a.authorizationToken&&(o.headers.Authorization=a.authorizationToken);const s=await n.handle(o);return Jie(s.response)},a.maxRetries??3,a.timeout??1e3)},Qie=(a,e)=>(t,r)=>async n=>{var o,s,u,l;const{response:i}=await t(n);try{const c=await e(i,a);return{response:i,output:c}}catch(c){if(Object.defineProperty(c,"$response",{value:i}),!("$metadata"in c)){const f="Deserialization error: to see the raw response, inspect the hidden field {error}.$response on this object.";try{c.message+=`
  `+f}catch{!r.logger||((s=(o=r.logger)==null?void 0:o.constructor)==null?void 0:s.name)==="NoOpLogger"?console.warn(f):(l=(u=r.logger)==null?void 0:u.warn)==null||l.call(u,f)}typeof c.$responseBodyText<"u"&&c.$response&&(c.$response.body=c.$responseBodyText)}throw c}},Yie=(a,e)=>(t,r)=>async n=>{var s;const i=(s=r.endpointV2)!=null&&s.url&&a.urlParser?async()=>a.urlParser(r.endpointV2.url):a.endpoint;if(!i)throw new Error("No valid endpoint provider available.");const o=await e(n.input,{...a,endpoint:i});return t({...n,request:o})},eae={name:"deserializerMiddleware",step:"deserialize",tags:["DESERIALIZER"],override:!0},L8={name:"serializerMiddleware",step:"serialize",tags:["SERIALIZER"],override:!0};function dhe(a,e,t){return{applyToStack:r=>{r.add(Qie(a,t),eae),r.add(Yie(a,e),L8)}}}L8.name;const tae=a=>{if(typeof a=="function")return a;const e=Promise.resolve(a);return()=>e},rae="us-east-1",nae=(a,e)=>{let t;return async(r={})=>{var c,f,p,h,y,d;const{callerClientConfig:n}=r,i=a.logger??(n==null?void 0:n.logger);i==null||i.debug("@aws-sdk/credential-providers - fromTemporaryCredentials (STS)");const o={...a.params,RoleSessionName:a.params.RoleSessionName??"aws-sdk-js-"+Date.now()};if(o!=null&&o.SerialNumber){if(!a.mfaCodeProvider)throw new wr("Temporary credential requires multi-factor authentication, but no MFA code callback was provided.",{tryNextLink:!1,logger:i});o.TokenCode=await a.mfaCodeProvider(o==null?void 0:o.SerialNumber)}const{AssumeRoleCommand:s,STSClient:u}=await Lu(async()=>{const{AssumeRoleCommand:_,STSClient:m}=await import("./loadSts.js").then(b=>b.l);return{AssumeRoleCommand:_,STSClient:m}},__vite__mapDeps([2,1]),import.meta.url);if(!t){const _=typeof e=="function"?e():void 0,m=[a.masterCredentials,(c=a.clientConfig)==null?void 0:c.credentials,void(n==null?void 0:n.credentials),(f=n==null?void 0:n.credentialDefaultProvider)==null?void 0:f.call(n),_];let b="STS client default credentials";if(m[0])b="options.masterCredentials";else if(m[1])b="options.clientConfig.credentials";else{if(m[2])throw b="caller client's credentials",new Error("fromTemporaryCredentials recursion in callerClientConfig.credentials");m[3]?b="caller client's credentialDefaultProvider":m[4]&&(b="AWS SDK default credentials")}const g=[(p=a.clientConfig)==null?void 0:p.region,n==null?void 0:n.region,rae];let v="default partition's default region";g[0]?v="options.clientConfig.region":g[1]&&(v="caller client's region");const w=[jx((h=a.clientConfig)==null?void 0:h.requestHandler),jx(n==null?void 0:n.requestHandler)];let S="STS default requestHandler";w[0]?S="options.clientConfig.requestHandler":w[1]&&(S="caller client's requestHandler"),(y=i==null?void 0:i.debug)==null||y.call(i,`@aws-sdk/credential-providers - fromTemporaryCredentials STS client init with ${v}=${await tae(H_(g))()}, ${b}, ${S}.`),t=new u({...a.clientConfig,credentials:H_(m),logger:i,profile:((d=a.clientConfig)==null?void 0:d.profile)??(n==null?void 0:n.profile),region:H_(g),requestHandler:H_(w)})}if(a.clientPlugins)for(const _ of a.clientPlugins)t.middlewareStack.use(_);const{Credentials:l}=await t.send(new s(o));if(!l||!l.AccessKeyId||!l.SecretAccessKey)throw new wr(`Invalid response from STS.assumeRole call with role ${o.RoleArn}`,{logger:i});return{accessKeyId:l.AccessKeyId,secretAccessKey:l.SecretAccessKey,sessionToken:l.SessionToken,expiration:l.Expiration,credentialScope:l.CredentialScope}}},jx=a=>{var e;return((e=a==null?void 0:a.metadata)==null?void 0:e.handlerProtocol)==="h2"?void 0:a},H_=a=>{for(const e of a)if(e!==void 0)return e},iae={},aae=Object.freeze(Object.defineProperty({__proto__:null,default:iae},Symbol.toStringTag,{value:"Module"})),oae=a=>async e=>{var c;(c=a.logger)==null||c.debug("@aws-sdk/credential-provider-web-identity - fromWebToken");const{roleArn:t,roleSessionName:r,webIdentityToken:n,providerId:i,policyArns:o,policy:s,durationSeconds:u}=a;let{roleAssumerWithWebIdentity:l}=a;if(!l){const{getDefaultRoleAssumerWithWebIdentity:f}=await Lu(async()=>{const{getDefaultRoleAssumerWithWebIdentity:p}=await import("./index.js");return{getDefaultRoleAssumerWithWebIdentity:p}},__vite__mapDeps([3,2,1]),import.meta.url);l=f({...a.clientConfig,credentialProviderLogger:a.logger,parentClientConfig:{...e==null?void 0:e.callerClientConfig,...a.parentClientConfig}},a.clientPlugins)}return l({RoleArn:t,RoleSessionName:r??`aws-sdk-js-session-${Date.now()}`,WebIdentityToken:n,ProviderId:i,PolicyArns:o,Policy:s,DurationSeconds:u})},sae=a=>oae({...a}),uae=Object.freeze(Object.defineProperty({__proto__:null,fromCognitoIdentity:cie,fromCognitoIdentityPool:fie,fromHttp:Zie,fromTemporaryCredentials:nae,fromWebToken:sae},Symbol.toStringTag,{value:"Module"})),lae=Mc(uae);var Tx;(function(a){a.HEADER="header",a.QUERY="query"})(Tx||(Tx={}));var Mx;(function(a){a.HTTP="http",a.HTTPS="https"})(Mx||(Mx={}));var nR;(function(a){a[a.HEADER=0]="HEADER",a[a.TRAILER=1]="TRAILER"})(nR||(nR={}));var Ax;(function(a){a.HTTP_0_9="http/0.9",a.HTTP_1_0="http/1.0",a.TDS_8_0="tds/8.0"})(Ax||(Ax={}));class cae{constructor({name:e,kind:t=nR.HEADER,values:r=[]}){this.name=e,this.kind=t,this.values=r}add(e){this.values.push(e)}set(e){this.values=e}remove(e){this.values=this.values.filter(t=>t!==e)}toString(){return this.values.map(e=>e.includes(",")||e.includes(" ")?`"${e}"`:e).join(", ")}get(){return this.values}}class fae{constructor({fields:e=[],encoding:t="utf-8"}){this.entries={},e.forEach(this.setField.bind(this)),this.encoding=t}setField(e){this.entries[e.name.toLowerCase()]=e}getField(e){return this.entries[e.toLowerCase()]}removeField(e){delete this.entries[e.toLowerCase()]}getByType(e){return Object.values(this.entries).filter(t=>t.kind===e)}}class MC{constructor(e){this.method=e.method||"GET",this.hostname=e.hostname||"localhost",this.port=e.port,this.query=e.query||{},this.headers=e.headers||{},this.body=e.body,this.protocol=e.protocol?e.protocol.slice(-1)!==":"?`${e.protocol}:`:e.protocol:"https:",this.path=e.path?e.path.charAt(0)!=="/"?`/${e.path}`:e.path:"/",this.username=e.username,this.password=e.password,this.fragment=e.fragment}static isInstance(e){if(!e)return!1;const t=e;return"method"in t&&"protocol"in t&&"hostname"in t&&"path"in t&&typeof t.query=="object"&&typeof t.headers=="object"}clone(){const e=new MC({...this,headers:{...this.headers}});return e.query&&(e.query=dae(e.query)),e}}function dae(a){return Object.keys(a).reduce((e,t)=>{const r=a[t];return{...e,[t]:Array.isArray(r)?[...r]:r}},{})}class hae{constructor(e){this.statusCode=e.statusCode,this.reason=e.reason,this.headers=e.headers||{},this.body=e.body}static isInstance(e){if(!e)return!1;const t=e;return typeof t.statusCode=="number"&&typeof t.headers=="object"}}function pae(a){return/^[a-z0-9][a-z0-9\.\-]*[a-z0-9]$/.test(a)}const _ae=Object.freeze(Object.defineProperty({__proto__:null,Field:cae,Fields:fae,HttpRequest:MC,HttpResponse:hae,isValidHostname:pae},Symbol.toStringTag,{value:"Module"})),yae=Mc(_ae);var mO={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var iR=function(a,e){return iR=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])},iR(a,e)};function bae(a,e){iR(a,e);function t(){this.constructor=a}a.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var aR=function(){return aR=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},aR.apply(this,arguments)};function mae(a,e){var t={};for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&e.indexOf(r)<0&&(t[r]=a[r]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,r=Object.getOwnPropertySymbols(a);n<r.length;n++)e.indexOf(r[n])<0&&Object.prototype.propertyIsEnumerable.call(a,r[n])&&(t[r[n]]=a[r[n]]);return t}function gae(a,e,t,r){var n=arguments.length,i=n<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,t):r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(a,e,t,r);else for(var s=a.length-1;s>=0;s--)(o=a[s])&&(i=(n<3?o(i):n>3?o(e,t,i):o(e,t))||i);return n>3&&i&&Object.defineProperty(e,t,i),i}function vae(a,e){return function(t,r){e(t,r,a)}}function wae(a,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(a,e)}function Oae(a,e,t,r){function n(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function s(c){try{l(r.next(c))}catch(f){o(f)}}function u(c){try{l(r.throw(c))}catch(f){o(f)}}function l(c){c.done?i(c.value):n(c.value).then(s,u)}l((r=r.apply(a,e||[])).next())})}function Sae(a,e){var t={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,n,i,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(l){return function(c){return u([l,c])}}function u(l){if(r)throw new TypeError("Generator is already executing.");for(;t;)try{if(r=1,n&&(i=l[0]&2?n.return:l[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,l[1])).done)return i;switch(n=0,i&&(l=[l[0]&2,i.value]),l[0]){case 0:case 1:i=l;break;case 4:return t.label++,{value:l[1],done:!1};case 5:t.label++,n=l[1],l=[0];continue;case 7:l=t.ops.pop(),t.trys.pop();continue;default:if(i=t.trys,!(i=i.length>0&&i[i.length-1])&&(l[0]===6||l[0]===2)){t=0;continue}if(l[0]===3&&(!i||l[1]>i[0]&&l[1]<i[3])){t.label=l[1];break}if(l[0]===6&&t.label<i[1]){t.label=i[1],i=l;break}if(i&&t.label<i[2]){t.label=i[2],t.ops.push(l);break}i[2]&&t.ops.pop(),t.trys.pop();continue}l=e.call(a,t)}catch(c){l=[6,c],n=0}finally{r=i=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function Eae(a,e,t,r){r===void 0&&(r=t),a[r]=e[t]}function Rae(a,e){for(var t in a)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=a[t])}function oR(a){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&a[e],r=0;if(t)return t.call(a);if(a&&typeof a.length=="number")return{next:function(){return a&&r>=a.length&&(a=void 0),{value:a&&a[r++],done:!a}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function V8(a,e){var t=typeof Symbol=="function"&&a[Symbol.iterator];if(!t)return a;var r=t.call(a),n,i=[],o;try{for(;(e===void 0||e-- >0)&&!(n=r.next()).done;)i.push(n.value)}catch(s){o={error:s}}finally{try{n&&!n.done&&(t=r.return)&&t.call(r)}finally{if(o)throw o.error}}return i}function Cae(){for(var a=[],e=0;e<arguments.length;e++)a=a.concat(V8(arguments[e]));return a}function Pae(){for(var a=0,e=0,t=arguments.length;e<t;e++)a+=arguments[e].length;for(var r=Array(a),n=0,e=0;e<t;e++)for(var i=arguments[e],o=0,s=i.length;o<s;o++,n++)r[n]=i[o];return r}function xp(a){return this instanceof xp?(this.v=a,this):new xp(a)}function jae(a,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(a,e||[]),n,i=[];return n={},o("next"),o("throw"),o("return"),n[Symbol.asyncIterator]=function(){return this},n;function o(p){r[p]&&(n[p]=function(h){return new Promise(function(y,d){i.push([p,h,y,d])>1||s(p,h)})})}function s(p,h){try{u(r[p](h))}catch(y){f(i[0][3],y)}}function u(p){p.value instanceof xp?Promise.resolve(p.value.v).then(l,c):f(i[0][2],p)}function l(p){s("next",p)}function c(p){s("throw",p)}function f(p,h){p(h),i.shift(),i.length&&s(i[0][0],i[0][1])}}function Tae(a){var e,t;return e={},r("next"),r("throw",function(n){throw n}),r("return"),e[Symbol.iterator]=function(){return this},e;function r(n,i){e[n]=a[n]?function(o){return(t=!t)?{value:xp(a[n](o)),done:n==="return"}:i?i(o):o}:i}}function Mae(a){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=a[Symbol.asyncIterator],t;return e?e.call(a):(a=typeof oR=="function"?oR(a):a[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(i){t[i]=a[i]&&function(o){return new Promise(function(s,u){o=a[i](o),n(s,u,o.done,o.value)})}}function n(i,o,s,u){Promise.resolve(u).then(function(l){i({value:l,done:s})},o)}}function Aae(a,e){return Object.defineProperty?Object.defineProperty(a,"raw",{value:e}):a.raw=e,a}function Iae(a){if(a&&a.__esModule)return a;var e={};if(a!=null)for(var t in a)Object.hasOwnProperty.call(a,t)&&(e[t]=a[t]);return e.default=a,e}function Dae(a){return a&&a.__esModule?a:{default:a}}function xae(a,e){if(!e.has(a))throw new TypeError("attempted to get private field on non-instance");return e.get(a)}function $ae(a,e,t){if(!e.has(a))throw new TypeError("attempted to set private field on non-instance");return e.set(a,t),t}const Nae=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return aR},__asyncDelegator:Tae,__asyncGenerator:jae,__asyncValues:Mae,__await:xp,__awaiter:Oae,__classPrivateFieldGet:xae,__classPrivateFieldSet:$ae,__createBinding:Eae,__decorate:gae,__exportStar:Rae,__extends:bae,__generator:Sae,__importDefault:Dae,__importStar:Iae,__makeTemplateObject:Aae,__metadata:wae,__param:vae,__read:V8,__rest:mae,__spread:Cae,__spreadArrays:Pae,__values:oR},Symbol.toStringTag,{value:"Module"})),G8=Mc(Nae);var gO={},Xd={};const qae=a=>{const e=[];for(let t=0,r=a.length;t<r;t++){const n=a.charCodeAt(t);if(n<128)e.push(n);else if(n<2048)e.push(n>>6|192,n&63|128);else if(t+1<a.length&&(n&64512)===55296&&(a.charCodeAt(t+1)&64512)===56320){const i=65536+((n&1023)<<10)+(a.charCodeAt(++t)&1023);e.push(i>>18|240,i>>12&63|128,i>>6&63|128,i&63|128)}else e.push(n>>12|224,n>>6&63|128,n&63|128)}return Uint8Array.from(e)},zae=a=>{let e="";for(let t=0,r=a.length;t<r;t++){const n=a[t];if(n<128)e+=String.fromCharCode(n);else if(192<=n&&n<224){const i=a[++t];e+=String.fromCharCode((n&31)<<6|i&63)}else if(240<=n&&n<365){const o="%"+[n,a[++t],a[++t],a[++t]].map(s=>s.toString(16)).join("%");e+=decodeURIComponent(o)}else e+=String.fromCharCode((n&15)<<12|(a[++t]&63)<<6|a[++t]&63)}return e};function Bae(a){return new TextEncoder().encode(a)}function Uae(a){return new TextDecoder("utf-8").decode(a)}const Fae=a=>typeof TextEncoder=="function"?Bae(a):qae(a),Lae=a=>typeof TextDecoder=="function"?Uae(a):zae(a),Vae=Object.freeze(Object.defineProperty({__proto__:null,fromUtf8:Fae,toUtf8:Lae},Symbol.toStringTag,{value:"Module"})),Gae=Mc(Vae);var Ix;function kae(){if(Ix)return Xd;Ix=1,Object.defineProperty(Xd,"__esModule",{value:!0}),Xd.convertToBuffer=void 0;var a=Gae,e=typeof Buffer<"u"&&Buffer.from?function(r){return Buffer.from(r,"utf8")}:a.fromUtf8;function t(r){return r instanceof Uint8Array?r:typeof r=="string"?e(r):ArrayBuffer.isView(r)?new Uint8Array(r.buffer,r.byteOffset,r.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(r)}return Xd.convertToBuffer=t,Xd}var Zd={},Dx;function Hae(){if(Dx)return Zd;Dx=1,Object.defineProperty(Zd,"__esModule",{value:!0}),Zd.isEmptyData=void 0;function a(e){return typeof e=="string"?e.length===0:e.byteLength===0}return Zd.isEmptyData=a,Zd}var Qd={},xx;function Wae(){if(xx)return Qd;xx=1,Object.defineProperty(Qd,"__esModule",{value:!0}),Qd.numToUint8=void 0;function a(e){return new Uint8Array([(e&4278190080)>>24,(e&16711680)>>16,(e&65280)>>8,e&255])}return Qd.numToUint8=a,Qd}var Yd={},$x;function Kae(){if($x)return Yd;$x=1,Object.defineProperty(Yd,"__esModule",{value:!0}),Yd.uint32ArrayFrom=void 0;function a(e){if(!Uint32Array.from){for(var t=new Uint32Array(e.length),r=0;r<e.length;)t[r]=e[r],r+=1;return t}return Uint32Array.from(e)}return Yd.uint32ArrayFrom=a,Yd}var Nx;function k8(){return Nx||(Nx=1,function(a){Object.defineProperty(a,"__esModule",{value:!0}),a.uint32ArrayFrom=a.numToUint8=a.isEmptyData=a.convertToBuffer=void 0;var e=kae();Object.defineProperty(a,"convertToBuffer",{enumerable:!0,get:function(){return e.convertToBuffer}});var t=Hae();Object.defineProperty(a,"isEmptyData",{enumerable:!0,get:function(){return t.isEmptyData}});var r=Wae();Object.defineProperty(a,"numToUint8",{enumerable:!0,get:function(){return r.numToUint8}});var n=Kae();Object.defineProperty(a,"uint32ArrayFrom",{enumerable:!0,get:function(){return n.uint32ArrayFrom}})}(gO)),gO}var eh={},qx;function Jae(){if(qx)return eh;qx=1,Object.defineProperty(eh,"__esModule",{value:!0}),eh.AwsCrc32=void 0;var a=G8,e=k8(),t=H8(),r=function(){function n(){this.crc32=new t.Crc32}return n.prototype.update=function(i){(0,e.isEmptyData)(i)||this.crc32.update((0,e.convertToBuffer)(i))},n.prototype.digest=function(){return a.__awaiter(this,void 0,void 0,function(){return a.__generator(this,function(i){return[2,(0,e.numToUint8)(this.crc32.digest())]})})},n.prototype.reset=function(){this.crc32=new t.Crc32},n}();return eh.AwsCrc32=r,eh}var zx;function H8(){return zx||(zx=1,function(a){Object.defineProperty(a,"__esModule",{value:!0}),a.AwsCrc32=a.Crc32=a.crc32=void 0;var e=G8,t=k8();function r(u){return new n().update(u).digest()}a.crc32=r;var n=function(){function u(){this.checksum=4294967295}return u.prototype.update=function(l){var c,f;try{for(var p=e.__values(l),h=p.next();!h.done;h=p.next()){var y=h.value;this.checksum=this.checksum>>>8^o[(this.checksum^y)&255]}}catch(d){c={error:d}}finally{try{h&&!h.done&&(f=p.return)&&f.call(p)}finally{if(c)throw c.error}}return this},u.prototype.digest=function(){return(this.checksum^4294967295)>>>0},u}();a.Crc32=n;var i=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],o=(0,t.uint32ArrayFrom)(i),s=Jae();Object.defineProperty(a,"AwsCrc32",{enumerable:!0,get:function(){return s.AwsCrc32}})}(mO)),mO}H8();const W8={},sR={};for(let a=0;a<256;a++){let e=a.toString(16).toLowerCase();e.length===1&&(e=`0${e}`),W8[a]=e,sR[e]=a}function Xae(a){if(a.length%2!==0)throw new Error("Hex encoded strings must have an even number length");const e=new Uint8Array(a.length/2);for(let t=0;t<a.length;t+=2){const r=a.slice(t,t+2).toLowerCase();if(r in sR)e[t/2]=sR[r];else throw new Error(`Cannot decode unrecognized sequence ${r} as hexadecimal`)}return e}function Ir(a){let e="";for(let t=0;t<a.byteLength;t++)e+=W8[a[t]];return e}class up{constructor(e){if(this.bytes=e,e.byteLength!==8)throw new Error("Int64 buffers must be exactly 8 bytes")}static fromNumber(e){if(e>9223372036854776e3||e<-9223372036854776e3)throw new Error(`${e} is too large (or, if negative, too small) to represent as an Int64`);const t=new Uint8Array(8);for(let r=7,n=Math.abs(Math.round(e));r>-1&&n>0;r--,n/=256)t[r]=n;return e<0&&Bx(t),new up(t)}valueOf(){const e=this.bytes.slice(0),t=e[0]&128;return t&&Bx(e),parseInt(Ir(e),16)*(t?-1:1)}toString(){return String(this.valueOf())}}function Bx(a){for(let e=0;e<8;e++)a[e]^=255;for(let e=7;e>-1&&(a[e]++,a[e]===0);e--);}class Zae{constructor(e,t){this.toUtf8=e,this.fromUtf8=t}format(e){const t=[];for(const i of Object.keys(e)){const o=this.fromUtf8(i);t.push(Uint8Array.from([o.byteLength]),o,this.formatHeaderValue(e[i]))}const r=new Uint8Array(t.reduce((i,o)=>i+o.byteLength,0));let n=0;for(const i of t)r.set(i,n),n+=i.byteLength;return r}formatHeaderValue(e){switch(e.type){case"boolean":return Uint8Array.from([e.value?0:1]);case"byte":return Uint8Array.from([2,e.value]);case"short":const t=new DataView(new ArrayBuffer(3));return t.setUint8(0,3),t.setInt16(1,e.value,!1),new Uint8Array(t.buffer);case"integer":const r=new DataView(new ArrayBuffer(5));return r.setUint8(0,4),r.setInt32(1,e.value,!1),new Uint8Array(r.buffer);case"long":const n=new Uint8Array(9);return n[0]=5,n.set(e.value.bytes,1),n;case"binary":const i=new DataView(new ArrayBuffer(3+e.value.byteLength));i.setUint8(0,6),i.setUint16(1,e.value.byteLength,!1);const o=new Uint8Array(i.buffer);return o.set(e.value,3),o;case"string":const s=this.fromUtf8(e.value),u=new DataView(new ArrayBuffer(3+s.byteLength));u.setUint8(0,7),u.setUint16(1,s.byteLength,!1);const l=new Uint8Array(u.buffer);return l.set(s,3),l;case"timestamp":const c=new Uint8Array(9);return c[0]=8,c.set(up.fromNumber(e.value.valueOf()).bytes,1),c;case"uuid":if(!ooe.test(e.value))throw new Error(`Invalid UUID received: ${e.value}`);const f=new Uint8Array(17);return f[0]=9,f.set(Xae(e.value.replace(/\-/g,"")),1),f}}parse(e){const t={};let r=0;for(;r<e.byteLength;){const n=e.getUint8(r++),i=this.toUtf8(new Uint8Array(e.buffer,e.byteOffset+r,n));switch(r+=n,e.getUint8(r++)){case 0:t[i]={type:Fx,value:!0};break;case 1:t[i]={type:Fx,value:!1};break;case 2:t[i]={type:Qae,value:e.getInt8(r++)};break;case 3:t[i]={type:Yae,value:e.getInt16(r,!1)},r+=2;break;case 4:t[i]={type:eoe,value:e.getInt32(r,!1)},r+=4;break;case 5:t[i]={type:toe,value:new up(new Uint8Array(e.buffer,e.byteOffset+r,8))},r+=8;break;case 6:const o=e.getUint16(r,!1);r+=2,t[i]={type:roe,value:new Uint8Array(e.buffer,e.byteOffset+r,o)},r+=o;break;case 7:const s=e.getUint16(r,!1);r+=2,t[i]={type:noe,value:this.toUtf8(new Uint8Array(e.buffer,e.byteOffset+r,s))},r+=s;break;case 8:t[i]={type:ioe,value:new Date(new up(new Uint8Array(e.buffer,e.byteOffset+r,8)).valueOf())},r+=8;break;case 9:const u=new Uint8Array(e.buffer,e.byteOffset+r,16);r+=16,t[i]={type:aoe,value:`${Ir(u.subarray(0,4))}-${Ir(u.subarray(4,6))}-${Ir(u.subarray(6,8))}-${Ir(u.subarray(8,10))}-${Ir(u.subarray(10))}`};break;default:throw new Error("Unrecognized header type tag")}}return t}}var Ux;(function(a){a[a.boolTrue=0]="boolTrue",a[a.boolFalse=1]="boolFalse",a[a.byte=2]="byte",a[a.short=3]="short",a[a.integer=4]="integer",a[a.long=5]="long",a[a.byteArray=6]="byteArray",a[a.string=7]="string",a[a.timestamp=8]="timestamp",a[a.uuid=9]="uuid"})(Ux||(Ux={}));const Fx="boolean",Qae="byte",Yae="short",eoe="integer",toe="long",roe="binary",noe="string",ioe="timestamp",aoe="uuid",ooe=/^[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}$/,Lx=a=>{if(typeof a=="function")return a;const e=Promise.resolve(a);return()=>e},K8=a=>new TextEncoder().encode(a),lp=a=>typeof a=="string"?K8(a):ArrayBuffer.isView(a)?new Uint8Array(a.buffer,a.byteOffset,a.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(a),soe=a=>new TextDecoder("utf-8").decode(a),uoe="X-Amz-Algorithm",loe="X-Amz-Credential",J8="X-Amz-Date",coe="X-Amz-SignedHeaders",foe="X-Amz-Expires",X8="X-Amz-Signature",Z8="X-Amz-Security-Token",Q8="authorization",Y8=J8.toLowerCase(),doe="date",hoe=[Q8,Y8,doe],poe=X8.toLowerCase(),uR="x-amz-content-sha256",_oe=Z8.toLowerCase(),yoe={authorization:!0,"cache-control":!0,connection:!0,expect:!0,from:!0,"keep-alive":!0,"max-forwards":!0,pragma:!0,referer:!0,te:!0,trailer:!0,"transfer-encoding":!0,upgrade:!0,"user-agent":!0,"x-amzn-trace-id":!0},boe=/^proxy-/,moe=/^sec-/,vO="AWS4-HMAC-SHA256",goe="AWS4-HMAC-SHA256-PAYLOAD",voe="UNSIGNED-PAYLOAD",woe=50,eG="aws4_request",Ooe=60*60*24*7,uf={},py=[],_y=(a,e,t)=>`${a}/${e}/${t}/${eG}`,tG=async(a,e,t,r,n)=>{const i=await Vx(a,e.secretAccessKey,e.accessKeyId),o=`${t}:${r}:${n}:${Ir(i)}:${e.sessionToken}`;if(o in uf)return uf[o];for(py.push(o);py.length>woe;)delete uf[py.shift()];let s=`AWS4${e.secretAccessKey}`;for(const u of[t,r,n,eG])s=await Vx(a,s,u);return uf[o]=s},Soe=()=>{py.length=0,Object.keys(uf).forEach(a=>{delete uf[a]})},Vx=(a,e,t)=>{const r=new a(e);return r.update(lp(t)),r.digest()},lR=({headers:a},e,t)=>{const r={};for(const n of Object.keys(a).sort()){if(a[n]==null)continue;const i=n.toLowerCase();(i in yoe||e!=null&&e.has(i)||boe.test(i)||moe.test(i))&&(!t||t&&!t.has(i))||(r[i]=a[n].trim().replace(/\s+/g," "))}return r},W_=a=>encodeURIComponent(a).replace(/[!'()*]/g,Eoe),Eoe=a=>`%${a.charCodeAt(0).toString(16).toUpperCase()}`,rG=({query:a={}})=>{const e=[],t={};for(const r of Object.keys(a).sort()){if(r.toLowerCase()===poe)continue;e.push(r);const n=a[r];typeof n=="string"?t[r]=`${W_(r)}=${W_(n)}`:Array.isArray(n)&&(t[r]=n.slice(0).sort().reduce((i,o)=>i.concat([`${W_(r)}=${W_(o)}`]),[]).join("&"))}return e.map(r=>t[r]).filter(r=>r).join("&")},Roe=a=>typeof ArrayBuffer=="function"&&a instanceof ArrayBuffer||Object.prototype.toString.call(a)==="[object ArrayBuffer]",yy=async({headers:a,body:e},t)=>{for(const r of Object.keys(a))if(r.toLowerCase()===uR)return a[r];if(e==null)return"e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855";if(typeof e=="string"||ArrayBuffer.isView(e)||Roe(e)){const r=new t;return r.update(lp(e)),Ir(await r.digest())}return voe},Coe=(a,e)=>{a=a.toLowerCase();for(const t of Object.keys(e))if(a===t.toLowerCase())return!0;return!1},nG=({headers:a,query:e,...t})=>({...t,headers:{...a},query:e?Poe(e):void 0}),Poe=a=>Object.keys(a).reduce((e,t)=>{const r=a[t];return{...e,[t]:Array.isArray(r)?[...r]:r}},{}),iG=(a,e={})=>{var n;const{headers:t,query:r={}}=typeof a.clone=="function"?a.clone():nG(a);for(const i of Object.keys(t)){const o=i.toLowerCase();o.slice(0,6)==="x-amz-"&&!((n=e.unhoistableHeaders)!=null&&n.has(o))&&(r[i]=t[i],delete t[i])}return{...a,headers:t,query:r}},cR=a=>{a=typeof a.clone=="function"?a.clone():nG(a);for(const e of Object.keys(a.headers))hoe.indexOf(e.toLowerCase())>-1&&delete a.headers[e];return a},joe=a=>Toe(a).toISOString().replace(/\.\d{3}Z$/,"Z"),Toe=a=>typeof a=="number"?new Date(a*1e3):typeof a=="string"?Number(a)?new Date(Number(a)*1e3):new Date(a):a;class Moe{constructor({applyChecksum:e,credentials:t,region:r,service:n,sha256:i,uriEscapePath:o=!0}){this.headerMarshaller=new Zae(soe,K8),this.service=n,this.sha256=i,this.uriEscapePath=o,this.applyChecksum=typeof e=="boolean"?e:!0,this.regionProvider=Lx(r),this.credentialProvider=Lx(t)}async presign(e,t={}){const{signingDate:r=new Date,expiresIn:n=3600,unsignableHeaders:i,unhoistableHeaders:o,signableHeaders:s,signingRegion:u,signingService:l}=t,c=await this.credentialProvider();this.validateResolvedCredentials(c);const f=u??await this.regionProvider(),{longDate:p,shortDate:h}=K_(r);if(n>Ooe)return Promise.reject("Signature version 4 presigned URLs must have an expiration date less than one week in the future");const y=_y(h,f,l??this.service),d=iG(cR(e),{unhoistableHeaders:o});c.sessionToken&&(d.query[Z8]=c.sessionToken),d.query[uoe]=vO,d.query[loe]=`${c.accessKeyId}/${y}`,d.query[J8]=p,d.query[foe]=n.toString(10);const _=lR(d,i,s);return d.query[coe]=Gx(_),d.query[X8]=await this.getSignature(p,y,this.getSigningKey(c,f,h,l),this.createCanonicalRequest(d,_,await yy(e,this.sha256))),d}async sign(e,t){return typeof e=="string"?this.signString(e,t):e.headers&&e.payload?this.signEvent(e,t):e.message?this.signMessage(e,t):this.signRequest(e,t)}async signEvent({headers:e,payload:t},{signingDate:r=new Date,priorSignature:n,signingRegion:i,signingService:o}){const s=i??await this.regionProvider(),{shortDate:u,longDate:l}=K_(r),c=_y(u,s,o??this.service),f=await yy({headers:{},body:t},this.sha256),p=new this.sha256;p.update(e);const h=Ir(await p.digest()),y=[goe,l,c,n,h,f].join(`
`);return this.signString(y,{signingDate:r,signingRegion:s,signingService:o})}async signMessage(e,{signingDate:t=new Date,signingRegion:r,signingService:n}){return this.signEvent({headers:this.headerMarshaller.format(e.message.headers),payload:e.message.body},{signingDate:t,signingRegion:r,signingService:n,priorSignature:e.priorSignature}).then(o=>({message:e.message,signature:o}))}async signString(e,{signingDate:t=new Date,signingRegion:r,signingService:n}={}){const i=await this.credentialProvider();this.validateResolvedCredentials(i);const o=r??await this.regionProvider(),{shortDate:s}=K_(t),u=new this.sha256(await this.getSigningKey(i,o,s,n));return u.update(lp(e)),Ir(await u.digest())}async signRequest(e,{signingDate:t=new Date,signableHeaders:r,unsignableHeaders:n,signingRegion:i,signingService:o}={}){const s=await this.credentialProvider();this.validateResolvedCredentials(s);const u=i??await this.regionProvider(),l=cR(e),{longDate:c,shortDate:f}=K_(t),p=_y(f,u,o??this.service);l.headers[Y8]=c,s.sessionToken&&(l.headers[_oe]=s.sessionToken);const h=await yy(l,this.sha256);!Coe(uR,l.headers)&&this.applyChecksum&&(l.headers[uR]=h);const y=lR(l,n,r),d=await this.getSignature(c,p,this.getSigningKey(s,u,f,o),this.createCanonicalRequest(l,y,h));return l.headers[Q8]=`${vO} Credential=${s.accessKeyId}/${p}, SignedHeaders=${Gx(y)}, Signature=${d}`,l}createCanonicalRequest(e,t,r){const n=Object.keys(t).sort();return`${e.method}
${this.getCanonicalPath(e)}
${rG(e)}
${n.map(i=>`${i}:${t[i]}`).join(`
`)}

${n.join(";")}
${r}`}async createStringToSign(e,t,r){const n=new this.sha256;n.update(lp(r));const i=await n.digest();return`${vO}
${e}
${t}
${Ir(i)}`}getCanonicalPath({path:e}){if(this.uriEscapePath){const t=[];for(const i of e.split("/"))(i==null?void 0:i.length)!==0&&i!=="."&&(i===".."?t.pop():t.push(i));const r=`${e!=null&&e.startsWith("/")?"/":""}${t.join("/")}${t.length>0&&(e!=null&&e.endsWith("/"))?"/":""}`;return encodeURIComponent(r).replace(/%2F/g,"/")}return e}async getSignature(e,t,r,n){const i=await this.createStringToSign(e,t,n),o=new this.sha256(await r);return o.update(lp(i)),Ir(await o.digest())}getSigningKey(e,t,r,n){return tG(this.sha256,e,r,t,n||this.service)}validateResolvedCredentials(e){if(typeof e!="object"||typeof e.accessKeyId!="string"||typeof e.secretAccessKey!="string")throw new Error("Resolved credential object is not valid")}}const K_=a=>{const e=joe(a).replace(/[\-:]/g,"");return{longDate:e,shortDate:e.slice(0,8)}},Gx=a=>Object.keys(a).sort().join(";"),Aoe=Object.freeze(Object.defineProperty({__proto__:null,SignatureV4:Moe,clearCredentialCache:Soe,createScope:_y,getCanonicalHeaders:lR,getCanonicalQuery:rG,getPayloadHash:yy,getSigningKey:tG,moveHeadersToQuery:iG,prepareRequest:cR},Symbol.toStringTag,{value:"Module"})),Ioe=Mc(Aoe);var wO={exports:{}},OO={exports:{}},SO={},J_={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */var kx;function Doe(){return kx||(kx=1,J_.read=function(a,e,t,r,n){var i,o,s=n*8-r-1,u=(1<<s)-1,l=u>>1,c=-7,f=t?n-1:0,p=t?-1:1,h=a[e+f];for(f+=p,i=h&(1<<-c)-1,h>>=-c,c+=s;c>0;i=i*256+a[e+f],f+=p,c-=8);for(o=i&(1<<-c)-1,i>>=-c,c+=r;c>0;o=o*256+a[e+f],f+=p,c-=8);if(i===0)i=1-l;else{if(i===u)return o?NaN:(h?-1:1)*(1/0);o=o+Math.pow(2,r),i=i-l}return(h?-1:1)*o*Math.pow(2,i-r)},J_.write=function(a,e,t,r,n,i){var o,s,u,l=i*8-n-1,c=(1<<l)-1,f=c>>1,p=n===23?Math.pow(2,-24)-Math.pow(2,-77):0,h=r?0:i-1,y=r?1:-1,d=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,o=c):(o=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-o))<1&&(o--,u*=2),o+f>=1?e+=p/u:e+=p*Math.pow(2,1-f),e*u>=2&&(o++,u/=2),o+f>=c?(s=0,o=c):o+f>=1?(s=(e*u-1)*Math.pow(2,n),o=o+f):(s=e*Math.pow(2,f-1)*Math.pow(2,n),o=0));n>=8;a[t+h]=s&255,h+=y,s/=256,n-=8);for(o=o<<n|s,l+=n;l>0;a[t+h]=o&255,h+=y,o/=256,l-=8);a[t+h-y]|=d*128}),J_}/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var Hx;function rl(){return Hx||(Hx=1,function(a){const e=cV(),t=Doe(),r=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;a.Buffer=s,a.SlowBuffer=b,a.INSPECT_MAX_BYTES=50;const n=2147483647;a.kMaxLength=n,s.TYPED_ARRAY_SUPPORT=i(),!s.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function i(){try{const j=new Uint8Array(1),O={foo:function(){return 42}};return Object.setPrototypeOf(O,Uint8Array.prototype),Object.setPrototypeOf(j,O),j.foo()===42}catch{return!1}}Object.defineProperty(s.prototype,"parent",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.buffer}}),Object.defineProperty(s.prototype,"offset",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.byteOffset}});function o(j){if(j>n)throw new RangeError('The value "'+j+'" is invalid for option "size"');const O=new Uint8Array(j);return Object.setPrototypeOf(O,s.prototype),O}function s(j,O,E){if(typeof j=="number"){if(typeof O=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return f(j)}return u(j,O,E)}s.poolSize=8192;function u(j,O,E){if(typeof j=="string")return p(j,O);if(ArrayBuffer.isView(j))return y(j);if(j==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof j);if(ae(j,ArrayBuffer)||j&&ae(j.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(ae(j,SharedArrayBuffer)||j&&ae(j.buffer,SharedArrayBuffer)))return d(j,O,E);if(typeof j=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const D=j.valueOf&&j.valueOf();if(D!=null&&D!==j)return s.from(D,O,E);const L=_(j);if(L)return L;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof j[Symbol.toPrimitive]=="function")return s.from(j[Symbol.toPrimitive]("string"),O,E);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof j)}s.from=function(j,O,E){return u(j,O,E)},Object.setPrototypeOf(s.prototype,Uint8Array.prototype),Object.setPrototypeOf(s,Uint8Array);function l(j){if(typeof j!="number")throw new TypeError('"size" argument must be of type number');if(j<0)throw new RangeError('The value "'+j+'" is invalid for option "size"')}function c(j,O,E){return l(j),j<=0?o(j):O!==void 0?typeof E=="string"?o(j).fill(O,E):o(j).fill(O):o(j)}s.alloc=function(j,O,E){return c(j,O,E)};function f(j){return l(j),o(j<0?0:m(j)|0)}s.allocUnsafe=function(j){return f(j)},s.allocUnsafeSlow=function(j){return f(j)};function p(j,O){if((typeof O!="string"||O==="")&&(O="utf8"),!s.isEncoding(O))throw new TypeError("Unknown encoding: "+O);const E=g(j,O)|0;let D=o(E);const L=D.write(j,O);return L!==E&&(D=D.slice(0,L)),D}function h(j){const O=j.length<0?0:m(j.length)|0,E=o(O);for(let D=0;D<O;D+=1)E[D]=j[D]&255;return E}function y(j){if(ae(j,Uint8Array)){const O=new Uint8Array(j);return d(O.buffer,O.byteOffset,O.byteLength)}return h(j)}function d(j,O,E){if(O<0||j.byteLength<O)throw new RangeError('"offset" is outside of buffer bounds');if(j.byteLength<O+(E||0))throw new RangeError('"length" is outside of buffer bounds');let D;return O===void 0&&E===void 0?D=new Uint8Array(j):E===void 0?D=new Uint8Array(j,O):D=new Uint8Array(j,O,E),Object.setPrototypeOf(D,s.prototype),D}function _(j){if(s.isBuffer(j)){const O=m(j.length)|0,E=o(O);return E.length===0||j.copy(E,0,0,O),E}if(j.length!==void 0)return typeof j.length!="number"||Ae(j.length)?o(0):h(j);if(j.type==="Buffer"&&Array.isArray(j.data))return h(j.data)}function m(j){if(j>=n)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+n.toString(16)+" bytes");return j|0}function b(j){return+j!=j&&(j=0),s.alloc(+j)}s.isBuffer=function(O){return O!=null&&O._isBuffer===!0&&O!==s.prototype},s.compare=function(O,E){if(ae(O,Uint8Array)&&(O=s.from(O,O.offset,O.byteLength)),ae(E,Uint8Array)&&(E=s.from(E,E.offset,E.byteLength)),!s.isBuffer(O)||!s.isBuffer(E))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(O===E)return 0;let D=O.length,L=E.length;for(let re=0,ce=Math.min(D,L);re<ce;++re)if(O[re]!==E[re]){D=O[re],L=E[re];break}return D<L?-1:L<D?1:0},s.isEncoding=function(O){switch(String(O).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},s.concat=function(O,E){if(!Array.isArray(O))throw new TypeError('"list" argument must be an Array of Buffers');if(O.length===0)return s.alloc(0);let D;if(E===void 0)for(E=0,D=0;D<O.length;++D)E+=O[D].length;const L=s.allocUnsafe(E);let re=0;for(D=0;D<O.length;++D){let ce=O[D];if(ae(ce,Uint8Array))re+ce.length>L.length?(s.isBuffer(ce)||(ce=s.from(ce)),ce.copy(L,re)):Uint8Array.prototype.set.call(L,ce,re);else if(s.isBuffer(ce))ce.copy(L,re);else throw new TypeError('"list" argument must be an Array of Buffers');re+=ce.length}return L};function g(j,O){if(s.isBuffer(j))return j.length;if(ArrayBuffer.isView(j)||ae(j,ArrayBuffer))return j.byteLength;if(typeof j!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof j);const E=j.length,D=arguments.length>2&&arguments[2]===!0;if(!D&&E===0)return 0;let L=!1;for(;;)switch(O){case"ascii":case"latin1":case"binary":return E;case"utf8":case"utf-8":return fe(j).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return E*2;case"hex":return E>>>1;case"base64":return le(j).length;default:if(L)return D?-1:fe(j).length;O=(""+O).toLowerCase(),L=!0}}s.byteLength=g;function v(j,O,E){let D=!1;if((O===void 0||O<0)&&(O=0),O>this.length||((E===void 0||E>this.length)&&(E=this.length),E<=0)||(E>>>=0,O>>>=0,E<=O))return"";for(j||(j="utf8");;)switch(j){case"hex":return ee(this,O,E);case"utf8":case"utf-8":return B(this,O,E);case"ascii":return se(this,O,E);case"latin1":case"binary":return F(this,O,E);case"base64":return q(this,O,E);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return A(this,O,E);default:if(D)throw new TypeError("Unknown encoding: "+j);j=(j+"").toLowerCase(),D=!0}}s.prototype._isBuffer=!0;function w(j,O,E){const D=j[O];j[O]=j[E],j[E]=D}s.prototype.swap16=function(){const O=this.length;if(O%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let E=0;E<O;E+=2)w(this,E,E+1);return this},s.prototype.swap32=function(){const O=this.length;if(O%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let E=0;E<O;E+=4)w(this,E,E+3),w(this,E+1,E+2);return this},s.prototype.swap64=function(){const O=this.length;if(O%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let E=0;E<O;E+=8)w(this,E,E+7),w(this,E+1,E+6),w(this,E+2,E+5),w(this,E+3,E+4);return this},s.prototype.toString=function(){const O=this.length;return O===0?"":arguments.length===0?B(this,0,O):v.apply(this,arguments)},s.prototype.toLocaleString=s.prototype.toString,s.prototype.equals=function(O){if(!s.isBuffer(O))throw new TypeError("Argument must be a Buffer");return this===O?!0:s.compare(this,O)===0},s.prototype.inspect=function(){let O="";const E=a.INSPECT_MAX_BYTES;return O=this.toString("hex",0,E).replace(/(.{2})/g,"$1 ").trim(),this.length>E&&(O+=" ... "),"<Buffer "+O+">"},r&&(s.prototype[r]=s.prototype.inspect),s.prototype.compare=function(O,E,D,L,re){if(ae(O,Uint8Array)&&(O=s.from(O,O.offset,O.byteLength)),!s.isBuffer(O))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof O);if(E===void 0&&(E=0),D===void 0&&(D=O?O.length:0),L===void 0&&(L=0),re===void 0&&(re=this.length),E<0||D>O.length||L<0||re>this.length)throw new RangeError("out of range index");if(L>=re&&E>=D)return 0;if(L>=re)return-1;if(E>=D)return 1;if(E>>>=0,D>>>=0,L>>>=0,re>>>=0,this===O)return 0;let ce=re-L,Me=D-E;const Je=Math.min(ce,Me),X=this.slice(L,re),Y=O.slice(E,D);for(let Ee=0;Ee<Je;++Ee)if(X[Ee]!==Y[Ee]){ce=X[Ee],Me=Y[Ee];break}return ce<Me?-1:Me<ce?1:0};function S(j,O,E,D,L){if(j.length===0)return-1;if(typeof E=="string"?(D=E,E=0):E>2147483647?E=2147483647:E<-2147483648&&(E=-2147483648),E=+E,Ae(E)&&(E=L?0:j.length-1),E<0&&(E=j.length+E),E>=j.length){if(L)return-1;E=j.length-1}else if(E<0)if(L)E=0;else return-1;if(typeof O=="string"&&(O=s.from(O,D)),s.isBuffer(O))return O.length===0?-1:R(j,O,E,D,L);if(typeof O=="number")return O=O&255,typeof Uint8Array.prototype.indexOf=="function"?L?Uint8Array.prototype.indexOf.call(j,O,E):Uint8Array.prototype.lastIndexOf.call(j,O,E):R(j,[O],E,D,L);throw new TypeError("val must be string, number or Buffer")}function R(j,O,E,D,L){let re=1,ce=j.length,Me=O.length;if(D!==void 0&&(D=String(D).toLowerCase(),D==="ucs2"||D==="ucs-2"||D==="utf16le"||D==="utf-16le")){if(j.length<2||O.length<2)return-1;re=2,ce/=2,Me/=2,E/=2}function Je(Y,Ee){return re===1?Y[Ee]:Y.readUInt16BE(Ee*re)}let X;if(L){let Y=-1;for(X=E;X<ce;X++)if(Je(j,X)===Je(O,Y===-1?0:X-Y)){if(Y===-1&&(Y=X),X-Y+1===Me)return Y*re}else Y!==-1&&(X-=X-Y),Y=-1}else for(E+Me>ce&&(E=ce-Me),X=E;X>=0;X--){let Y=!0;for(let Ee=0;Ee<Me;Ee++)if(Je(j,X+Ee)!==Je(O,Ee)){Y=!1;break}if(Y)return X}return-1}s.prototype.includes=function(O,E,D){return this.indexOf(O,E,D)!==-1},s.prototype.indexOf=function(O,E,D){return S(this,O,E,D,!0)},s.prototype.lastIndexOf=function(O,E,D){return S(this,O,E,D,!1)};function P(j,O,E,D){E=Number(E)||0;const L=j.length-E;D?(D=Number(D),D>L&&(D=L)):D=L;const re=O.length;D>re/2&&(D=re/2);let ce;for(ce=0;ce<D;++ce){const Me=parseInt(O.substr(ce*2,2),16);if(Ae(Me))return ce;j[E+ce]=Me}return ce}function C(j,O,E,D){return de(fe(O,j.length-E),j,E,D)}function T(j,O,E,D){return de(_e(O),j,E,D)}function M(j,O,E,D){return de(le(O),j,E,D)}function K(j,O,E,D){return de(G(O,j.length-E),j,E,D)}s.prototype.write=function(O,E,D,L){if(E===void 0)L="utf8",D=this.length,E=0;else if(D===void 0&&typeof E=="string")L=E,D=this.length,E=0;else if(isFinite(E))E=E>>>0,isFinite(D)?(D=D>>>0,L===void 0&&(L="utf8")):(L=D,D=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const re=this.length-E;if((D===void 0||D>re)&&(D=re),O.length>0&&(D<0||E<0)||E>this.length)throw new RangeError("Attempt to write outside buffer bounds");L||(L="utf8");let ce=!1;for(;;)switch(L){case"hex":return P(this,O,E,D);case"utf8":case"utf-8":return C(this,O,E,D);case"ascii":case"latin1":case"binary":return T(this,O,E,D);case"base64":return M(this,O,E,D);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return K(this,O,E,D);default:if(ce)throw new TypeError("Unknown encoding: "+L);L=(""+L).toLowerCase(),ce=!0}},s.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function q(j,O,E){return O===0&&E===j.length?e.fromByteArray(j):e.fromByteArray(j.slice(O,E))}function B(j,O,E){E=Math.min(j.length,E);const D=[];let L=O;for(;L<E;){const re=j[L];let ce=null,Me=re>239?4:re>223?3:re>191?2:1;if(L+Me<=E){let Je,X,Y,Ee;switch(Me){case 1:re<128&&(ce=re);break;case 2:Je=j[L+1],(Je&192)===128&&(Ee=(re&31)<<6|Je&63,Ee>127&&(ce=Ee));break;case 3:Je=j[L+1],X=j[L+2],(Je&192)===128&&(X&192)===128&&(Ee=(re&15)<<12|(Je&63)<<6|X&63,Ee>2047&&(Ee<55296||Ee>57343)&&(ce=Ee));break;case 4:Je=j[L+1],X=j[L+2],Y=j[L+3],(Je&192)===128&&(X&192)===128&&(Y&192)===128&&(Ee=(re&15)<<18|(Je&63)<<12|(X&63)<<6|Y&63,Ee>65535&&Ee<1114112&&(ce=Ee))}}ce===null?(ce=65533,Me=1):ce>65535&&(ce-=65536,D.push(ce>>>10&1023|55296),ce=56320|ce&1023),D.push(ce),L+=Me}return Q(D)}const H=4096;function Q(j){const O=j.length;if(O<=H)return String.fromCharCode.apply(String,j);let E="",D=0;for(;D<O;)E+=String.fromCharCode.apply(String,j.slice(D,D+=H));return E}function se(j,O,E){let D="";E=Math.min(j.length,E);for(let L=O;L<E;++L)D+=String.fromCharCode(j[L]&127);return D}function F(j,O,E){let D="";E=Math.min(j.length,E);for(let L=O;L<E;++L)D+=String.fromCharCode(j[L]);return D}function ee(j,O,E){const D=j.length;(!O||O<0)&&(O=0),(!E||E<0||E>D)&&(E=D);let L="";for(let re=O;re<E;++re)L+=at[j[re]];return L}function A(j,O,E){const D=j.slice(O,E);let L="";for(let re=0;re<D.length-1;re+=2)L+=String.fromCharCode(D[re]+D[re+1]*256);return L}s.prototype.slice=function(O,E){const D=this.length;O=~~O,E=E===void 0?D:~~E,O<0?(O+=D,O<0&&(O=0)):O>D&&(O=D),E<0?(E+=D,E<0&&(E=0)):E>D&&(E=D),E<O&&(E=O);const L=this.subarray(O,E);return Object.setPrototypeOf(L,s.prototype),L};function J(j,O,E){if(j%1!==0||j<0)throw new RangeError("offset is not uint");if(j+O>E)throw new RangeError("Trying to access beyond buffer length")}s.prototype.readUintLE=s.prototype.readUIntLE=function(O,E,D){O=O>>>0,E=E>>>0,D||J(O,E,this.length);let L=this[O],re=1,ce=0;for(;++ce<E&&(re*=256);)L+=this[O+ce]*re;return L},s.prototype.readUintBE=s.prototype.readUIntBE=function(O,E,D){O=O>>>0,E=E>>>0,D||J(O,E,this.length);let L=this[O+--E],re=1;for(;E>0&&(re*=256);)L+=this[O+--E]*re;return L},s.prototype.readUint8=s.prototype.readUInt8=function(O,E){return O=O>>>0,E||J(O,1,this.length),this[O]},s.prototype.readUint16LE=s.prototype.readUInt16LE=function(O,E){return O=O>>>0,E||J(O,2,this.length),this[O]|this[O+1]<<8},s.prototype.readUint16BE=s.prototype.readUInt16BE=function(O,E){return O=O>>>0,E||J(O,2,this.length),this[O]<<8|this[O+1]},s.prototype.readUint32LE=s.prototype.readUInt32LE=function(O,E){return O=O>>>0,E||J(O,4,this.length),(this[O]|this[O+1]<<8|this[O+2]<<16)+this[O+3]*16777216},s.prototype.readUint32BE=s.prototype.readUInt32BE=function(O,E){return O=O>>>0,E||J(O,4,this.length),this[O]*16777216+(this[O+1]<<16|this[O+2]<<8|this[O+3])},s.prototype.readBigUInt64LE=Ne(function(O){O=O>>>0,z(O,"offset");const E=this[O],D=this[O+7];(E===void 0||D===void 0)&&V(O,this.length-8);const L=E+this[++O]*2**8+this[++O]*2**16+this[++O]*2**24,re=this[++O]+this[++O]*2**8+this[++O]*2**16+D*2**24;return BigInt(L)+(BigInt(re)<<BigInt(32))}),s.prototype.readBigUInt64BE=Ne(function(O){O=O>>>0,z(O,"offset");const E=this[O],D=this[O+7];(E===void 0||D===void 0)&&V(O,this.length-8);const L=E*2**24+this[++O]*2**16+this[++O]*2**8+this[++O],re=this[++O]*2**24+this[++O]*2**16+this[++O]*2**8+D;return(BigInt(L)<<BigInt(32))+BigInt(re)}),s.prototype.readIntLE=function(O,E,D){O=O>>>0,E=E>>>0,D||J(O,E,this.length);let L=this[O],re=1,ce=0;for(;++ce<E&&(re*=256);)L+=this[O+ce]*re;return re*=128,L>=re&&(L-=Math.pow(2,8*E)),L},s.prototype.readIntBE=function(O,E,D){O=O>>>0,E=E>>>0,D||J(O,E,this.length);let L=E,re=1,ce=this[O+--L];for(;L>0&&(re*=256);)ce+=this[O+--L]*re;return re*=128,ce>=re&&(ce-=Math.pow(2,8*E)),ce},s.prototype.readInt8=function(O,E){return O=O>>>0,E||J(O,1,this.length),this[O]&128?(255-this[O]+1)*-1:this[O]},s.prototype.readInt16LE=function(O,E){O=O>>>0,E||J(O,2,this.length);const D=this[O]|this[O+1]<<8;return D&32768?D|4294901760:D},s.prototype.readInt16BE=function(O,E){O=O>>>0,E||J(O,2,this.length);const D=this[O+1]|this[O]<<8;return D&32768?D|4294901760:D},s.prototype.readInt32LE=function(O,E){return O=O>>>0,E||J(O,4,this.length),this[O]|this[O+1]<<8|this[O+2]<<16|this[O+3]<<24},s.prototype.readInt32BE=function(O,E){return O=O>>>0,E||J(O,4,this.length),this[O]<<24|this[O+1]<<16|this[O+2]<<8|this[O+3]},s.prototype.readBigInt64LE=Ne(function(O){O=O>>>0,z(O,"offset");const E=this[O],D=this[O+7];(E===void 0||D===void 0)&&V(O,this.length-8);const L=this[O+4]+this[O+5]*2**8+this[O+6]*2**16+(D<<24);return(BigInt(L)<<BigInt(32))+BigInt(E+this[++O]*2**8+this[++O]*2**16+this[++O]*2**24)}),s.prototype.readBigInt64BE=Ne(function(O){O=O>>>0,z(O,"offset");const E=this[O],D=this[O+7];(E===void 0||D===void 0)&&V(O,this.length-8);const L=(E<<24)+this[++O]*2**16+this[++O]*2**8+this[++O];return(BigInt(L)<<BigInt(32))+BigInt(this[++O]*2**24+this[++O]*2**16+this[++O]*2**8+D)}),s.prototype.readFloatLE=function(O,E){return O=O>>>0,E||J(O,4,this.length),t.read(this,O,!0,23,4)},s.prototype.readFloatBE=function(O,E){return O=O>>>0,E||J(O,4,this.length),t.read(this,O,!1,23,4)},s.prototype.readDoubleLE=function(O,E){return O=O>>>0,E||J(O,8,this.length),t.read(this,O,!0,52,8)},s.prototype.readDoubleBE=function(O,E){return O=O>>>0,E||J(O,8,this.length),t.read(this,O,!1,52,8)};function te(j,O,E,D,L,re){if(!s.isBuffer(j))throw new TypeError('"buffer" argument must be a Buffer instance');if(O>L||O<re)throw new RangeError('"value" argument is out of bounds');if(E+D>j.length)throw new RangeError("Index out of range")}s.prototype.writeUintLE=s.prototype.writeUIntLE=function(O,E,D,L){if(O=+O,E=E>>>0,D=D>>>0,!L){const Me=Math.pow(2,8*D)-1;te(this,O,E,D,Me,0)}let re=1,ce=0;for(this[E]=O&255;++ce<D&&(re*=256);)this[E+ce]=O/re&255;return E+D},s.prototype.writeUintBE=s.prototype.writeUIntBE=function(O,E,D,L){if(O=+O,E=E>>>0,D=D>>>0,!L){const Me=Math.pow(2,8*D)-1;te(this,O,E,D,Me,0)}let re=D-1,ce=1;for(this[E+re]=O&255;--re>=0&&(ce*=256);)this[E+re]=O/ce&255;return E+D},s.prototype.writeUint8=s.prototype.writeUInt8=function(O,E,D){return O=+O,E=E>>>0,D||te(this,O,E,1,255,0),this[E]=O&255,E+1},s.prototype.writeUint16LE=s.prototype.writeUInt16LE=function(O,E,D){return O=+O,E=E>>>0,D||te(this,O,E,2,65535,0),this[E]=O&255,this[E+1]=O>>>8,E+2},s.prototype.writeUint16BE=s.prototype.writeUInt16BE=function(O,E,D){return O=+O,E=E>>>0,D||te(this,O,E,2,65535,0),this[E]=O>>>8,this[E+1]=O&255,E+2},s.prototype.writeUint32LE=s.prototype.writeUInt32LE=function(O,E,D){return O=+O,E=E>>>0,D||te(this,O,E,4,4294967295,0),this[E+3]=O>>>24,this[E+2]=O>>>16,this[E+1]=O>>>8,this[E]=O&255,E+4},s.prototype.writeUint32BE=s.prototype.writeUInt32BE=function(O,E,D){return O=+O,E=E>>>0,D||te(this,O,E,4,4294967295,0),this[E]=O>>>24,this[E+1]=O>>>16,this[E+2]=O>>>8,this[E+3]=O&255,E+4};function Z(j,O,E,D,L){ue(O,D,L,j,E,7);let re=Number(O&BigInt(4294967295));j[E++]=re,re=re>>8,j[E++]=re,re=re>>8,j[E++]=re,re=re>>8,j[E++]=re;let ce=Number(O>>BigInt(32)&BigInt(4294967295));return j[E++]=ce,ce=ce>>8,j[E++]=ce,ce=ce>>8,j[E++]=ce,ce=ce>>8,j[E++]=ce,E}function he(j,O,E,D,L){ue(O,D,L,j,E,7);let re=Number(O&BigInt(4294967295));j[E+7]=re,re=re>>8,j[E+6]=re,re=re>>8,j[E+5]=re,re=re>>8,j[E+4]=re;let ce=Number(O>>BigInt(32)&BigInt(4294967295));return j[E+3]=ce,ce=ce>>8,j[E+2]=ce,ce=ce>>8,j[E+1]=ce,ce=ce>>8,j[E]=ce,E+8}s.prototype.writeBigUInt64LE=Ne(function(O,E=0){return Z(this,O,E,BigInt(0),BigInt("0xffffffffffffffff"))}),s.prototype.writeBigUInt64BE=Ne(function(O,E=0){return he(this,O,E,BigInt(0),BigInt("0xffffffffffffffff"))}),s.prototype.writeIntLE=function(O,E,D,L){if(O=+O,E=E>>>0,!L){const Je=Math.pow(2,8*D-1);te(this,O,E,D,Je-1,-Je)}let re=0,ce=1,Me=0;for(this[E]=O&255;++re<D&&(ce*=256);)O<0&&Me===0&&this[E+re-1]!==0&&(Me=1),this[E+re]=(O/ce>>0)-Me&255;return E+D},s.prototype.writeIntBE=function(O,E,D,L){if(O=+O,E=E>>>0,!L){const Je=Math.pow(2,8*D-1);te(this,O,E,D,Je-1,-Je)}let re=D-1,ce=1,Me=0;for(this[E+re]=O&255;--re>=0&&(ce*=256);)O<0&&Me===0&&this[E+re+1]!==0&&(Me=1),this[E+re]=(O/ce>>0)-Me&255;return E+D},s.prototype.writeInt8=function(O,E,D){return O=+O,E=E>>>0,D||te(this,O,E,1,127,-128),O<0&&(O=255+O+1),this[E]=O&255,E+1},s.prototype.writeInt16LE=function(O,E,D){return O=+O,E=E>>>0,D||te(this,O,E,2,32767,-32768),this[E]=O&255,this[E+1]=O>>>8,E+2},s.prototype.writeInt16BE=function(O,E,D){return O=+O,E=E>>>0,D||te(this,O,E,2,32767,-32768),this[E]=O>>>8,this[E+1]=O&255,E+2},s.prototype.writeInt32LE=function(O,E,D){return O=+O,E=E>>>0,D||te(this,O,E,4,2147483647,-2147483648),this[E]=O&255,this[E+1]=O>>>8,this[E+2]=O>>>16,this[E+3]=O>>>24,E+4},s.prototype.writeInt32BE=function(O,E,D){return O=+O,E=E>>>0,D||te(this,O,E,4,2147483647,-2147483648),O<0&&(O=4294967295+O+1),this[E]=O>>>24,this[E+1]=O>>>16,this[E+2]=O>>>8,this[E+3]=O&255,E+4},s.prototype.writeBigInt64LE=Ne(function(O,E=0){return Z(this,O,E,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),s.prototype.writeBigInt64BE=Ne(function(O,E=0){return he(this,O,E,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function ye(j,O,E,D,L,re){if(E+D>j.length)throw new RangeError("Index out of range");if(E<0)throw new RangeError("Index out of range")}function ve(j,O,E,D,L){return O=+O,E=E>>>0,L||ye(j,O,E,4),t.write(j,O,E,D,23,4),E+4}s.prototype.writeFloatLE=function(O,E,D){return ve(this,O,E,!0,D)},s.prototype.writeFloatBE=function(O,E,D){return ve(this,O,E,!1,D)};function W(j,O,E,D,L){return O=+O,E=E>>>0,L||ye(j,O,E,8),t.write(j,O,E,D,52,8),E+8}s.prototype.writeDoubleLE=function(O,E,D){return W(this,O,E,!0,D)},s.prototype.writeDoubleBE=function(O,E,D){return W(this,O,E,!1,D)},s.prototype.copy=function(O,E,D,L){if(!s.isBuffer(O))throw new TypeError("argument should be a Buffer");if(D||(D=0),!L&&L!==0&&(L=this.length),E>=O.length&&(E=O.length),E||(E=0),L>0&&L<D&&(L=D),L===D||O.length===0||this.length===0)return 0;if(E<0)throw new RangeError("targetStart out of bounds");if(D<0||D>=this.length)throw new RangeError("Index out of range");if(L<0)throw new RangeError("sourceEnd out of bounds");L>this.length&&(L=this.length),O.length-E<L-D&&(L=O.length-E+D);const re=L-D;return this===O&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(E,D,L):Uint8Array.prototype.set.call(O,this.subarray(D,L),E),re},s.prototype.fill=function(O,E,D,L){if(typeof O=="string"){if(typeof E=="string"?(L=E,E=0,D=this.length):typeof D=="string"&&(L=D,D=this.length),L!==void 0&&typeof L!="string")throw new TypeError("encoding must be a string");if(typeof L=="string"&&!s.isEncoding(L))throw new TypeError("Unknown encoding: "+L);if(O.length===1){const ce=O.charCodeAt(0);(L==="utf8"&&ce<128||L==="latin1")&&(O=ce)}}else typeof O=="number"?O=O&255:typeof O=="boolean"&&(O=Number(O));if(E<0||this.length<E||this.length<D)throw new RangeError("Out of range index");if(D<=E)return this;E=E>>>0,D=D===void 0?this.length:D>>>0,O||(O=0);let re;if(typeof O=="number")for(re=E;re<D;++re)this[re]=O;else{const ce=s.isBuffer(O)?O:s.from(O,L),Me=ce.length;if(Me===0)throw new TypeError('The value "'+O+'" is invalid for argument "value"');for(re=0;re<D-E;++re)this[re+E]=ce[re%Me]}return this};const U={};function N(j,O,E){U[j]=class extends E{constructor(){super(),Object.defineProperty(this,"message",{value:O.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${j}]`,this.stack,delete this.name}get code(){return j}set code(L){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:L,writable:!0})}toString(){return`${this.name} [${j}]: ${this.message}`}}}N("ERR_BUFFER_OUT_OF_BOUNDS",function(j){return j?`${j} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),N("ERR_INVALID_ARG_TYPE",function(j,O){return`The "${j}" argument must be of type number. Received type ${typeof O}`},TypeError),N("ERR_OUT_OF_RANGE",function(j,O,E){let D=`The value of "${j}" is out of range.`,L=E;return Number.isInteger(E)&&Math.abs(E)>2**32?L=k(String(E)):typeof E=="bigint"&&(L=String(E),(E>BigInt(2)**BigInt(32)||E<-(BigInt(2)**BigInt(32)))&&(L=k(L)),L+="n"),D+=` It must be ${O}. Received ${L}`,D},RangeError);function k(j){let O="",E=j.length;const D=j[0]==="-"?1:0;for(;E>=D+4;E-=3)O=`_${j.slice(E-3,E)}${O}`;return`${j.slice(0,E)}${O}`}function ie(j,O,E){z(O,"offset"),(j[O]===void 0||j[O+E]===void 0)&&V(O,j.length-(E+1))}function ue(j,O,E,D,L,re){if(j>E||j<O){const ce=typeof O=="bigint"?"n":"";let Me;throw O===0||O===BigInt(0)?Me=`>= 0${ce} and < 2${ce} ** ${(re+1)*8}${ce}`:Me=`>= -(2${ce} ** ${(re+1)*8-1}${ce}) and < 2 ** ${(re+1)*8-1}${ce}`,new U.ERR_OUT_OF_RANGE("value",Me,j)}ie(D,L,re)}function z(j,O){if(typeof j!="number")throw new U.ERR_INVALID_ARG_TYPE(O,"number",j)}function V(j,O,E){throw Math.floor(j)!==j?(z(j,E),new U.ERR_OUT_OF_RANGE("offset","an integer",j)):O<0?new U.ERR_BUFFER_OUT_OF_BOUNDS:new U.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${O}`,j)}const ne=/[^+/0-9A-Za-z-_]/g;function pe(j){if(j=j.split("=")[0],j=j.trim().replace(ne,""),j.length<2)return"";for(;j.length%4!==0;)j=j+"=";return j}function fe(j,O){O=O||1/0;let E;const D=j.length;let L=null;const re=[];for(let ce=0;ce<D;++ce){if(E=j.charCodeAt(ce),E>55295&&E<57344){if(!L){if(E>56319){(O-=3)>-1&&re.push(239,191,189);continue}else if(ce+1===D){(O-=3)>-1&&re.push(239,191,189);continue}L=E;continue}if(E<56320){(O-=3)>-1&&re.push(239,191,189),L=E;continue}E=(L-55296<<10|E-56320)+65536}else L&&(O-=3)>-1&&re.push(239,191,189);if(L=null,E<128){if((O-=1)<0)break;re.push(E)}else if(E<2048){if((O-=2)<0)break;re.push(E>>6|192,E&63|128)}else if(E<65536){if((O-=3)<0)break;re.push(E>>12|224,E>>6&63|128,E&63|128)}else if(E<1114112){if((O-=4)<0)break;re.push(E>>18|240,E>>12&63|128,E>>6&63|128,E&63|128)}else throw new Error("Invalid code point")}return re}function _e(j){const O=[];for(let E=0;E<j.length;++E)O.push(j.charCodeAt(E)&255);return O}function G(j,O){let E,D,L;const re=[];for(let ce=0;ce<j.length&&!((O-=2)<0);++ce)E=j.charCodeAt(ce),D=E>>8,L=E%256,re.push(L),re.push(D);return re}function le(j){return e.toByteArray(pe(j))}function de(j,O,E,D){let L;for(L=0;L<D&&!(L+E>=O.length||L>=j.length);++L)O[L+E]=j[L];return L}function ae(j,O){return j instanceof O||j!=null&&j.constructor!=null&&j.constructor.name!=null&&j.constructor.name===O.name}function Ae(j){return j!==j}const at=function(){const j="0123456789abcdef",O=new Array(256);for(let E=0;E<16;++E){const D=E*16;for(let L=0;L<16;++L)O[D+L]=j[E]+j[L]}return O}();function Ne(j){return typeof BigInt>"u"?Et:j}function Et(){throw new Error("BigInt not supported")}}(SO)),SO}var EO,Wx;function ut(){if(Wx)return EO;Wx=1;class a extends Error{constructor(t){if(!Array.isArray(t))throw new TypeError(`Expected input to be an Array, got ${typeof t}`);let r="";for(let n=0;n<t.length;n++)r+=`    ${t[n].stack}
`;super(r),this.name="AggregateError",this.errors=t}}return EO={AggregateError:a,ArrayIsArray(e){return Array.isArray(e)},ArrayPrototypeIncludes(e,t){return e.includes(t)},ArrayPrototypeIndexOf(e,t){return e.indexOf(t)},ArrayPrototypeJoin(e,t){return e.join(t)},ArrayPrototypeMap(e,t){return e.map(t)},ArrayPrototypePop(e,t){return e.pop(t)},ArrayPrototypePush(e,t){return e.push(t)},ArrayPrototypeSlice(e,t,r){return e.slice(t,r)},Error,FunctionPrototypeCall(e,t,...r){return e.call(t,...r)},FunctionPrototypeSymbolHasInstance(e,t){return Function.prototype[Symbol.hasInstance].call(e,t)},MathFloor:Math.floor,Number,NumberIsInteger:Number.isInteger,NumberIsNaN:Number.isNaN,NumberMAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER,NumberMIN_SAFE_INTEGER:Number.MIN_SAFE_INTEGER,NumberParseInt:Number.parseInt,ObjectDefineProperties(e,t){return Object.defineProperties(e,t)},ObjectDefineProperty(e,t,r){return Object.defineProperty(e,t,r)},ObjectGetOwnPropertyDescriptor(e,t){return Object.getOwnPropertyDescriptor(e,t)},ObjectKeys(e){return Object.keys(e)},ObjectSetPrototypeOf(e,t){return Object.setPrototypeOf(e,t)},Promise,PromisePrototypeCatch(e,t){return e.catch(t)},PromisePrototypeThen(e,t,r){return e.then(t,r)},PromiseReject(e){return Promise.reject(e)},PromiseResolve(e){return Promise.resolve(e)},ReflectApply:Reflect.apply,RegExpPrototypeTest(e,t){return e.test(t)},SafeSet:Set,String,StringPrototypeSlice(e,t,r){return e.slice(t,r)},StringPrototypeToLowerCase(e){return e.toLowerCase()},StringPrototypeToUpperCase(e){return e.toUpperCase()},StringPrototypeTrim(e){return e.trim()},Symbol,SymbolFor:Symbol.for,SymbolAsyncIterator:Symbol.asyncIterator,SymbolHasInstance:Symbol.hasInstance,SymbolIterator:Symbol.iterator,SymbolDispose:Symbol.dispose||Symbol("Symbol.dispose"),SymbolAsyncDispose:Symbol.asyncDispose||Symbol("Symbol.asyncDispose"),TypedArrayPrototypeSet(e,t,r){return e.set(t,r)},Boolean,Uint8Array},EO}var RO={exports:{}},CO,Kx;function aG(){return Kx||(Kx=1,CO={format(a,...e){return a.replace(/%([sdifj])/g,function(...[t,r]){const n=e.shift();return r==="f"?n.toFixed(6):r==="j"?JSON.stringify(n):r==="s"&&typeof n=="object"?`${n.constructor!==Object?n.constructor.name:""} {}`.trim():n.toString()})},inspect(a){switch(typeof a){case"string":if(a.includes("'"))if(a.includes('"')){if(!a.includes("`")&&!a.includes("${"))return`\`${a}\``}else return`"${a}"`;return`'${a}'`;case"number":return isNaN(a)?"NaN":Object.is(a,-0)?String(a):a;case"bigint":return`${String(a)}n`;case"boolean":case"undefined":return String(a);case"object":return"{}"}}}),CO}var PO,Jx;function Qt(){if(Jx)return PO;Jx=1;const{format:a,inspect:e}=aG(),{AggregateError:t}=ut(),r=globalThis.AggregateError||t,n=Symbol("kIsNodeError"),i=["string","function","number","object","Function","Object","boolean","bigint","symbol"],o=/^([A-Z][a-z0-9]*)+$/,s="__node_internal_",u={};function l(_,m){if(!_)throw new u.ERR_INTERNAL_ASSERTION(m)}function c(_){let m="",b=_.length;const g=_[0]==="-"?1:0;for(;b>=g+4;b-=3)m=`_${_.slice(b-3,b)}${m}`;return`${_.slice(0,b)}${m}`}function f(_,m,b){if(typeof m=="function")return l(m.length<=b.length,`Code: ${_}; The provided arguments length (${b.length}) does not match the required ones (${m.length}).`),m(...b);const g=(m.match(/%[dfijoOs]/g)||[]).length;return l(g===b.length,`Code: ${_}; The provided arguments length (${b.length}) does not match the required ones (${g}).`),b.length===0?m:a(m,...b)}function p(_,m,b){b||(b=Error);class g extends b{constructor(...w){super(f(_,m,w))}toString(){return`${this.name} [${_}]: ${this.message}`}}Object.defineProperties(g.prototype,{name:{value:b.name,writable:!0,enumerable:!1,configurable:!0},toString:{value(){return`${this.name} [${_}]: ${this.message}`},writable:!0,enumerable:!1,configurable:!0}}),g.prototype.code=_,g.prototype[n]=!0,u[_]=g}function h(_){const m=s+_.name;return Object.defineProperty(_,"name",{value:m}),_}function y(_,m){if(_&&m&&_!==m){if(Array.isArray(m.errors))return m.errors.push(_),m;const b=new r([m,_],m.message);return b.code=m.code,b}return _||m}class d extends Error{constructor(m="The operation was aborted",b=void 0){if(b!==void 0&&typeof b!="object")throw new u.ERR_INVALID_ARG_TYPE("options","Object",b);super(m,b),this.code="ABORT_ERR",this.name="AbortError"}}return p("ERR_ASSERTION","%s",Error),p("ERR_INVALID_ARG_TYPE",(_,m,b)=>{l(typeof _=="string","'name' must be a string"),Array.isArray(m)||(m=[m]);let g="The ";_.endsWith(" argument")?g+=`${_} `:g+=`"${_}" ${_.includes(".")?"property":"argument"} `,g+="must be ";const v=[],w=[],S=[];for(const P of m)l(typeof P=="string","All expected entries have to be of type string"),i.includes(P)?v.push(P.toLowerCase()):o.test(P)?w.push(P):(l(P!=="object",'The value "object" should be written as "Object"'),S.push(P));if(w.length>0){const P=v.indexOf("object");P!==-1&&(v.splice(v,P,1),w.push("Object"))}if(v.length>0){switch(v.length){case 1:g+=`of type ${v[0]}`;break;case 2:g+=`one of type ${v[0]} or ${v[1]}`;break;default:{const P=v.pop();g+=`one of type ${v.join(", ")}, or ${P}`}}(w.length>0||S.length>0)&&(g+=" or ")}if(w.length>0){switch(w.length){case 1:g+=`an instance of ${w[0]}`;break;case 2:g+=`an instance of ${w[0]} or ${w[1]}`;break;default:{const P=w.pop();g+=`an instance of ${w.join(", ")}, or ${P}`}}S.length>0&&(g+=" or ")}switch(S.length){case 0:break;case 1:S[0].toLowerCase()!==S[0]&&(g+="an "),g+=`${S[0]}`;break;case 2:g+=`one of ${S[0]} or ${S[1]}`;break;default:{const P=S.pop();g+=`one of ${S.join(", ")}, or ${P}`}}if(b==null)g+=`. Received ${b}`;else if(typeof b=="function"&&b.name)g+=`. Received function ${b.name}`;else if(typeof b=="object"){var R;if((R=b.constructor)!==null&&R!==void 0&&R.name)g+=`. Received an instance of ${b.constructor.name}`;else{const P=e(b,{depth:-1});g+=`. Received ${P}`}}else{let P=e(b,{colors:!1});P.length>25&&(P=`${P.slice(0,25)}...`),g+=`. Received type ${typeof b} (${P})`}return g},TypeError),p("ERR_INVALID_ARG_VALUE",(_,m,b="is invalid")=>{let g=e(m);return g.length>128&&(g=g.slice(0,128)+"..."),`The ${_.includes(".")?"property":"argument"} '${_}' ${b}. Received ${g}`},TypeError),p("ERR_INVALID_RETURN_VALUE",(_,m,b)=>{var g;const v=b!=null&&(g=b.constructor)!==null&&g!==void 0&&g.name?`instance of ${b.constructor.name}`:`type ${typeof b}`;return`Expected ${_} to be returned from the "${m}" function but got ${v}.`},TypeError),p("ERR_MISSING_ARGS",(..._)=>{l(_.length>0,"At least one arg needs to be specified");let m;const b=_.length;switch(_=(Array.isArray(_)?_:[_]).map(g=>`"${g}"`).join(" or "),b){case 1:m+=`The ${_[0]} argument`;break;case 2:m+=`The ${_[0]} and ${_[1]} arguments`;break;default:{const g=_.pop();m+=`The ${_.join(", ")}, and ${g} arguments`}break}return`${m} must be specified`},TypeError),p("ERR_OUT_OF_RANGE",(_,m,b)=>{l(m,'Missing "range" argument');let g;if(Number.isInteger(b)&&Math.abs(b)>2**32)g=c(String(b));else if(typeof b=="bigint"){g=String(b);const v=BigInt(2)**BigInt(32);(b>v||b<-v)&&(g=c(g)),g+="n"}else g=e(b);return`The value of "${_}" is out of range. It must be ${m}. Received ${g}`},RangeError),p("ERR_MULTIPLE_CALLBACK","Callback called multiple times",Error),p("ERR_METHOD_NOT_IMPLEMENTED","The %s method is not implemented",Error),p("ERR_STREAM_ALREADY_FINISHED","Cannot call %s after a stream was finished",Error),p("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable",Error),p("ERR_STREAM_DESTROYED","Cannot call %s after a stream was destroyed",Error),p("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),p("ERR_STREAM_PREMATURE_CLOSE","Premature close",Error),p("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF",Error),p("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event",Error),p("ERR_STREAM_WRITE_AFTER_END","write after end",Error),p("ERR_UNKNOWN_ENCODING","Unknown encoding: %s",TypeError),PO={AbortError:d,aggregateTwoErrors:h(y),hideStackFrames:h,codes:u},PO}var th={exports:{}},Xx;function $p(){if(Xx)return th.exports;Xx=1;const{AbortController:a,AbortSignal:e}=typeof self<"u"?self:typeof window<"u"?window:void 0;return th.exports=a,th.exports.AbortSignal=e,th.exports.default=a,th.exports}var X_={exports:{}},Zx;function Ib(){if(Zx)return X_.exports;Zx=1;var a=typeof Reflect=="object"?Reflect:null,e=a&&typeof a.apply=="function"?a.apply:function(w,S,R){return Function.prototype.apply.call(w,S,R)},t;a&&typeof a.ownKeys=="function"?t=a.ownKeys:Object.getOwnPropertySymbols?t=function(w){return Object.getOwnPropertyNames(w).concat(Object.getOwnPropertySymbols(w))}:t=function(w){return Object.getOwnPropertyNames(w)};function r(v){console&&console.warn&&console.warn(v)}var n=Number.isNaN||function(w){return w!==w};function i(){i.init.call(this)}X_.exports=i,X_.exports.once=m,i.EventEmitter=i,i.prototype._events=void 0,i.prototype._eventsCount=0,i.prototype._maxListeners=void 0;var o=10;function s(v){if(typeof v!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof v)}Object.defineProperty(i,"defaultMaxListeners",{enumerable:!0,get:function(){return o},set:function(v){if(typeof v!="number"||v<0||n(v))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+v+".");o=v}}),i.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},i.prototype.setMaxListeners=function(w){if(typeof w!="number"||w<0||n(w))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+w+".");return this._maxListeners=w,this};function u(v){return v._maxListeners===void 0?i.defaultMaxListeners:v._maxListeners}i.prototype.getMaxListeners=function(){return u(this)},i.prototype.emit=function(w){for(var S=[],R=1;R<arguments.length;R++)S.push(arguments[R]);var P=w==="error",C=this._events;if(C!==void 0)P=P&&C.error===void 0;else if(!P)return!1;if(P){var T;if(S.length>0&&(T=S[0]),T instanceof Error)throw T;var M=new Error("Unhandled error."+(T?" ("+T.message+")":""));throw M.context=T,M}var K=C[w];if(K===void 0)return!1;if(typeof K=="function")e(K,this,S);else for(var q=K.length,B=y(K,q),R=0;R<q;++R)e(B[R],this,S);return!0};function l(v,w,S,R){var P,C,T;if(s(S),C=v._events,C===void 0?(C=v._events=Object.create(null),v._eventsCount=0):(C.newListener!==void 0&&(v.emit("newListener",w,S.listener?S.listener:S),C=v._events),T=C[w]),T===void 0)T=C[w]=S,++v._eventsCount;else if(typeof T=="function"?T=C[w]=R?[S,T]:[T,S]:R?T.unshift(S):T.push(S),P=u(v),P>0&&T.length>P&&!T.warned){T.warned=!0;var M=new Error("Possible EventEmitter memory leak detected. "+T.length+" "+String(w)+" listeners added. Use emitter.setMaxListeners() to increase limit");M.name="MaxListenersExceededWarning",M.emitter=v,M.type=w,M.count=T.length,r(M)}return v}i.prototype.addListener=function(w,S){return l(this,w,S,!1)},i.prototype.on=i.prototype.addListener,i.prototype.prependListener=function(w,S){return l(this,w,S,!0)};function c(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function f(v,w,S){var R={fired:!1,wrapFn:void 0,target:v,type:w,listener:S},P=c.bind(R);return P.listener=S,R.wrapFn=P,P}i.prototype.once=function(w,S){return s(S),this.on(w,f(this,w,S)),this},i.prototype.prependOnceListener=function(w,S){return s(S),this.prependListener(w,f(this,w,S)),this},i.prototype.removeListener=function(w,S){var R,P,C,T,M;if(s(S),P=this._events,P===void 0)return this;if(R=P[w],R===void 0)return this;if(R===S||R.listener===S)--this._eventsCount===0?this._events=Object.create(null):(delete P[w],P.removeListener&&this.emit("removeListener",w,R.listener||S));else if(typeof R!="function"){for(C=-1,T=R.length-1;T>=0;T--)if(R[T]===S||R[T].listener===S){M=R[T].listener,C=T;break}if(C<0)return this;C===0?R.shift():d(R,C),R.length===1&&(P[w]=R[0]),P.removeListener!==void 0&&this.emit("removeListener",w,M||S)}return this},i.prototype.off=i.prototype.removeListener,i.prototype.removeAllListeners=function(w){var S,R,P;if(R=this._events,R===void 0)return this;if(R.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):R[w]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete R[w]),this;if(arguments.length===0){var C=Object.keys(R),T;for(P=0;P<C.length;++P)T=C[P],T!=="removeListener"&&this.removeAllListeners(T);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(S=R[w],typeof S=="function")this.removeListener(w,S);else if(S!==void 0)for(P=S.length-1;P>=0;P--)this.removeListener(w,S[P]);return this};function p(v,w,S){var R=v._events;if(R===void 0)return[];var P=R[w];return P===void 0?[]:typeof P=="function"?S?[P.listener||P]:[P]:S?_(P):y(P,P.length)}i.prototype.listeners=function(w){return p(this,w,!0)},i.prototype.rawListeners=function(w){return p(this,w,!1)},i.listenerCount=function(v,w){return typeof v.listenerCount=="function"?v.listenerCount(w):h.call(v,w)},i.prototype.listenerCount=h;function h(v){var w=this._events;if(w!==void 0){var S=w[v];if(typeof S=="function")return 1;if(S!==void 0)return S.length}return 0}i.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]};function y(v,w){for(var S=new Array(w),R=0;R<w;++R)S[R]=v[R];return S}function d(v,w){for(;w+1<v.length;w++)v[w]=v[w+1];v.pop()}function _(v){for(var w=new Array(v.length),S=0;S<w.length;++S)w[S]=v[S].listener||v[S];return w}function m(v,w){return new Promise(function(S,R){function P(T){v.removeListener(w,C),R(T)}function C(){typeof v.removeListener=="function"&&v.removeListener("error",P),S([].slice.call(arguments))}g(v,w,C,{once:!0}),w!=="error"&&b(v,P,{once:!0})})}function b(v,w,S){typeof v.on=="function"&&g(v,"error",w,S)}function g(v,w,S,R){if(typeof v.on=="function")R.once?v.once(w,S):v.on(w,S);else if(typeof v.addEventListener=="function")v.addEventListener(w,function P(C){R.once&&v.removeEventListener(w,P),S(C)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof v)}return X_.exports}var Qx;function nr(){return Qx||(Qx=1,function(a){const e=rl(),{format:t,inspect:r}=aG(),{codes:{ERR_INVALID_ARG_TYPE:n}}=Qt(),{kResistStopPropagation:i,AggregateError:o,SymbolDispose:s}=ut(),u=globalThis.AbortSignal||$p().AbortSignal,l=globalThis.AbortController||$p().AbortController,c=Object.getPrototypeOf(async function(){}).constructor,f=globalThis.Blob||e.Blob,p=typeof f<"u"?function(_){return _ instanceof f}:function(_){return!1},h=(d,_)=>{if(d!==void 0&&(d===null||typeof d!="object"||!("aborted"in d)))throw new n(_,"AbortSignal",d)},y=(d,_)=>{if(typeof d!="function")throw new n(_,"Function",d)};a.exports={AggregateError:o,kEmptyObject:Object.freeze({}),once(d){let _=!1;return function(...m){_||(_=!0,d.apply(this,m))}},createDeferredPromise:function(){let d,_;return{promise:new Promise((b,g)=>{d=b,_=g}),resolve:d,reject:_}},promisify(d){return new Promise((_,m)=>{d((b,...g)=>b?m(b):_(...g))})},debuglog(){return function(){}},format:t,inspect:r,types:{isAsyncFunction(d){return d instanceof c},isArrayBufferView(d){return ArrayBuffer.isView(d)}},isBlob:p,deprecate(d,_){return d},addAbortListener:Ib().addAbortListener||function(_,m){if(_===void 0)throw new n("signal","AbortSignal",_);h(_,"signal"),y(m,"listener");let b;return _.aborted?queueMicrotask(()=>m()):(_.addEventListener("abort",m,{__proto__:null,once:!0,[i]:!0}),b=()=>{_.removeEventListener("abort",m)}),{__proto__:null,[s](){var g;(g=b)===null||g===void 0||g()}}},AbortSignalAny:u.any||function(_){if(_.length===1)return _[0];const m=new l,b=()=>m.abort();return _.forEach(g=>{h(g,"signals"),g.addEventListener("abort",b,{once:!0})}),m.signal.addEventListener("abort",()=>{_.forEach(g=>g.removeEventListener("abort",b))},{once:!0}),m.signal}},a.exports.promisify.custom=Symbol.for("nodejs.util.promisify.custom")}(RO)),RO.exports}var Z_={},jO,Yx;function r_(){if(Yx)return jO;Yx=1;const{ArrayIsArray:a,ArrayPrototypeIncludes:e,ArrayPrototypeJoin:t,ArrayPrototypeMap:r,NumberIsInteger:n,NumberIsNaN:i,NumberMAX_SAFE_INTEGER:o,NumberMIN_SAFE_INTEGER:s,NumberParseInt:u,ObjectPrototypeHasOwnProperty:l,RegExpPrototypeExec:c,String:f,StringPrototypeToUpperCase:p,StringPrototypeTrim:h}=ut(),{hideStackFrames:y,codes:{ERR_SOCKET_BAD_PORT:d,ERR_INVALID_ARG_TYPE:_,ERR_INVALID_ARG_VALUE:m,ERR_OUT_OF_RANGE:b,ERR_UNKNOWN_SIGNAL:g}}=Qt(),{normalizeEncoding:v}=nr(),{isAsyncFunction:w,isArrayBufferView:S}=nr().types,R={};function P(G){return G===(G|0)}function C(G){return G===G>>>0}const T=/^[0-7]+$/,M="must be a 32-bit unsigned integer or an octal string";function K(G,le,de){if(typeof G>"u"&&(G=de),typeof G=="string"){if(c(T,G)===null)throw new m(le,G,M);G=u(G,8)}return H(G,le),G}const q=y((G,le,de=s,ae=o)=>{if(typeof G!="number")throw new _(le,"number",G);if(!n(G))throw new b(le,"an integer",G);if(G<de||G>ae)throw new b(le,`>= ${de} && <= ${ae}`,G)}),B=y((G,le,de=-2147483648,ae=2147483647)=>{if(typeof G!="number")throw new _(le,"number",G);if(!n(G))throw new b(le,"an integer",G);if(G<de||G>ae)throw new b(le,`>= ${de} && <= ${ae}`,G)}),H=y((G,le,de=!1)=>{if(typeof G!="number")throw new _(le,"number",G);if(!n(G))throw new b(le,"an integer",G);const ae=de?1:0,Ae=4294967295;if(G<ae||G>Ae)throw new b(le,`>= ${ae} && <= ${Ae}`,G)});function Q(G,le){if(typeof G!="string")throw new _(le,"string",G)}function se(G,le,de=void 0,ae){if(typeof G!="number")throw new _(le,"number",G);if(de!=null&&G<de||ae!=null&&G>ae||(de!=null||ae!=null)&&i(G))throw new b(le,`${de!=null?`>= ${de}`:""}${de!=null&&ae!=null?" && ":""}${ae!=null?`<= ${ae}`:""}`,G)}const F=y((G,le,de)=>{if(!e(de,G)){const Ae="must be one of: "+t(r(de,at=>typeof at=="string"?`'${at}'`:f(at)),", ");throw new m(le,G,Ae)}});function ee(G,le){if(typeof G!="boolean")throw new _(le,"boolean",G)}function A(G,le,de){return G==null||!l(G,le)?de:G[le]}const J=y((G,le,de=null)=>{const ae=A(de,"allowArray",!1),Ae=A(de,"allowFunction",!1);if(!A(de,"nullable",!1)&&G===null||!ae&&a(G)||typeof G!="object"&&(!Ae||typeof G!="function"))throw new _(le,"Object",G)}),te=y((G,le)=>{if(G!=null&&typeof G!="object"&&typeof G!="function")throw new _(le,"a dictionary",G)}),Z=y((G,le,de=0)=>{if(!a(G))throw new _(le,"Array",G);if(G.length<de){const ae=`must be longer than ${de}`;throw new m(le,G,ae)}});function he(G,le){Z(G,le);for(let de=0;de<G.length;de++)Q(G[de],`${le}[${de}]`)}function ye(G,le){Z(G,le);for(let de=0;de<G.length;de++)ee(G[de],`${le}[${de}]`)}function ve(G,le){Z(G,le);for(let de=0;de<G.length;de++){const ae=G[de],Ae=`${le}[${de}]`;if(ae==null)throw new _(Ae,"AbortSignal",ae);ie(ae,Ae)}}function W(G,le="signal"){if(Q(G,le),R[G]===void 0)throw R[p(G)]!==void 0?new g(G+" (signals must use all capital letters)"):new g(G)}const U=y((G,le="buffer")=>{if(!S(G))throw new _(le,["Buffer","TypedArray","DataView"],G)});function N(G,le){const de=v(le),ae=G.length;if(de==="hex"&&ae%2!==0)throw new m("encoding",le,`is invalid for data of length ${ae}`)}function k(G,le="Port",de=!0){if(typeof G!="number"&&typeof G!="string"||typeof G=="string"&&h(G).length===0||+G!==+G>>>0||G>65535||G===0&&!de)throw new d(le,G,de);return G|0}const ie=y((G,le)=>{if(G!==void 0&&(G===null||typeof G!="object"||!("aborted"in G)))throw new _(le,"AbortSignal",G)}),ue=y((G,le)=>{if(typeof G!="function")throw new _(le,"Function",G)}),z=y((G,le)=>{if(typeof G!="function"||w(G))throw new _(le,"Function",G)}),V=y((G,le)=>{if(G!==void 0)throw new _(le,"undefined",G)});function ne(G,le,de){if(!e(de,G))throw new _(le,`('${t(de,"|")}')`,G)}const pe=/^(?:<[^>]*>)(?:\s*;\s*[^;"\s]+(?:=(")?[^;"\s]*\1)?)*$/;function fe(G,le){if(typeof G>"u"||!c(pe,G))throw new m(le,G,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}function _e(G){if(typeof G=="string")return fe(G,"hints"),G;if(a(G)){const le=G.length;let de="";if(le===0)return de;for(let ae=0;ae<le;ae++){const Ae=G[ae];fe(Ae,"hints"),de+=Ae,ae!==le-1&&(de+=", ")}return de}throw new m("hints",G,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}return jO={isInt32:P,isUint32:C,parseFileMode:K,validateArray:Z,validateStringArray:he,validateBooleanArray:ye,validateAbortSignalArray:ve,validateBoolean:ee,validateBuffer:U,validateDictionary:te,validateEncoding:N,validateFunction:ue,validateInt32:B,validateInteger:q,validateNumber:se,validateObject:J,validateOneOf:F,validatePlainFunction:z,validatePort:k,validateSignalName:W,validateString:Q,validateUint32:H,validateUndefined:V,validateUnion:ne,validateAbortSignal:ie,validateLinkHeaderValue:_e},jO}var Q_={exports:{}},TO={exports:{}},e$;function Ic(){if(e$)return TO.exports;e$=1;var a=TO.exports={},e,t;function r(){throw new Error("setTimeout has not been defined")}function n(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?e=setTimeout:e=r}catch{e=r}try{typeof clearTimeout=="function"?t=clearTimeout:t=n}catch{t=n}})();function i(d){if(e===setTimeout)return setTimeout(d,0);if((e===r||!e)&&setTimeout)return e=setTimeout,setTimeout(d,0);try{return e(d,0)}catch{try{return e.call(null,d,0)}catch{return e.call(this,d,0)}}}function o(d){if(t===clearTimeout)return clearTimeout(d);if((t===n||!t)&&clearTimeout)return t=clearTimeout,clearTimeout(d);try{return t(d)}catch{try{return t.call(null,d)}catch{return t.call(this,d)}}}var s=[],u=!1,l,c=-1;function f(){!u||!l||(u=!1,l.length?s=l.concat(s):c=-1,s.length&&p())}function p(){if(!u){var d=i(f);u=!0;for(var _=s.length;_;){for(l=s,s=[];++c<_;)l&&l[c].run();c=-1,_=s.length}l=null,u=!1,o(d)}}a.nextTick=function(d){var _=new Array(arguments.length-1);if(arguments.length>1)for(var m=1;m<arguments.length;m++)_[m-1]=arguments[m];s.push(new h(d,_)),s.length===1&&!u&&i(p)};function h(d,_){this.fun=d,this.array=_}h.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={};function y(){}return a.on=y,a.addListener=y,a.once=y,a.off=y,a.removeListener=y,a.removeAllListeners=y,a.emit=y,a.prependListener=y,a.prependOnceListener=y,a.listeners=function(d){return[]},a.binding=function(d){throw new Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(d){throw new Error("process.chdir is not supported")},a.umask=function(){return 0},TO.exports}var MO,t$;function Pu(){if(t$)return MO;t$=1;const{SymbolAsyncIterator:a,SymbolIterator:e,SymbolFor:t}=ut(),r=t("nodejs.stream.destroyed"),n=t("nodejs.stream.errored"),i=t("nodejs.stream.readable"),o=t("nodejs.stream.writable"),s=t("nodejs.stream.disturbed"),u=t("nodejs.webstream.isClosedPromise"),l=t("nodejs.webstream.controllerErrorFunction");function c(A,J=!1){var te;return!!(A&&typeof A.pipe=="function"&&typeof A.on=="function"&&(!J||typeof A.pause=="function"&&typeof A.resume=="function")&&(!A._writableState||((te=A._readableState)===null||te===void 0?void 0:te.readable)!==!1)&&(!A._writableState||A._readableState))}function f(A){var J;return!!(A&&typeof A.write=="function"&&typeof A.on=="function"&&(!A._readableState||((J=A._writableState)===null||J===void 0?void 0:J.writable)!==!1))}function p(A){return!!(A&&typeof A.pipe=="function"&&A._readableState&&typeof A.on=="function"&&typeof A.write=="function")}function h(A){return A&&(A._readableState||A._writableState||typeof A.write=="function"&&typeof A.on=="function"||typeof A.pipe=="function"&&typeof A.on=="function")}function y(A){return!!(A&&!h(A)&&typeof A.pipeThrough=="function"&&typeof A.getReader=="function"&&typeof A.cancel=="function")}function d(A){return!!(A&&!h(A)&&typeof A.getWriter=="function"&&typeof A.abort=="function")}function _(A){return!!(A&&!h(A)&&typeof A.readable=="object"&&typeof A.writable=="object")}function m(A){return y(A)||d(A)||_(A)}function b(A,J){return A==null?!1:J===!0?typeof A[a]=="function":J===!1?typeof A[e]=="function":typeof A[a]=="function"||typeof A[e]=="function"}function g(A){if(!h(A))return null;const J=A._writableState,te=A._readableState,Z=J||te;return!!(A.destroyed||A[r]||Z!=null&&Z.destroyed)}function v(A){if(!f(A))return null;if(A.writableEnded===!0)return!0;const J=A._writableState;return J!=null&&J.errored?!1:typeof(J==null?void 0:J.ended)!="boolean"?null:J.ended}function w(A,J){if(!f(A))return null;if(A.writableFinished===!0)return!0;const te=A._writableState;return te!=null&&te.errored?!1:typeof(te==null?void 0:te.finished)!="boolean"?null:!!(te.finished||J===!1&&te.ended===!0&&te.length===0)}function S(A){if(!c(A))return null;if(A.readableEnded===!0)return!0;const J=A._readableState;return!J||J.errored?!1:typeof(J==null?void 0:J.ended)!="boolean"?null:J.ended}function R(A,J){if(!c(A))return null;const te=A._readableState;return te!=null&&te.errored?!1:typeof(te==null?void 0:te.endEmitted)!="boolean"?null:!!(te.endEmitted||J===!1&&te.ended===!0&&te.length===0)}function P(A){return A&&A[i]!=null?A[i]:typeof(A==null?void 0:A.readable)!="boolean"?null:g(A)?!1:c(A)&&A.readable&&!R(A)}function C(A){return A&&A[o]!=null?A[o]:typeof(A==null?void 0:A.writable)!="boolean"?null:g(A)?!1:f(A)&&A.writable&&!v(A)}function T(A,J){return h(A)?g(A)?!0:!((J==null?void 0:J.readable)!==!1&&P(A)||(J==null?void 0:J.writable)!==!1&&C(A)):null}function M(A){var J,te;return h(A)?A.writableErrored?A.writableErrored:(J=(te=A._writableState)===null||te===void 0?void 0:te.errored)!==null&&J!==void 0?J:null:null}function K(A){var J,te;return h(A)?A.readableErrored?A.readableErrored:(J=(te=A._readableState)===null||te===void 0?void 0:te.errored)!==null&&J!==void 0?J:null:null}function q(A){if(!h(A))return null;if(typeof A.closed=="boolean")return A.closed;const J=A._writableState,te=A._readableState;return typeof(J==null?void 0:J.closed)=="boolean"||typeof(te==null?void 0:te.closed)=="boolean"?(J==null?void 0:J.closed)||(te==null?void 0:te.closed):typeof A._closed=="boolean"&&B(A)?A._closed:null}function B(A){return typeof A._closed=="boolean"&&typeof A._defaultKeepAlive=="boolean"&&typeof A._removedConnection=="boolean"&&typeof A._removedContLen=="boolean"}function H(A){return typeof A._sent100=="boolean"&&B(A)}function Q(A){var J;return typeof A._consuming=="boolean"&&typeof A._dumped=="boolean"&&((J=A.req)===null||J===void 0?void 0:J.upgradeOrConnect)===void 0}function se(A){if(!h(A))return null;const J=A._writableState,te=A._readableState,Z=J||te;return!Z&&H(A)||!!(Z&&Z.autoDestroy&&Z.emitClose&&Z.closed===!1)}function F(A){var J;return!!(A&&((J=A[s])!==null&&J!==void 0?J:A.readableDidRead||A.readableAborted))}function ee(A){var J,te,Z,he,ye,ve,W,U,N,k;return!!(A&&((J=(te=(Z=(he=(ye=(ve=A[n])!==null&&ve!==void 0?ve:A.readableErrored)!==null&&ye!==void 0?ye:A.writableErrored)!==null&&he!==void 0?he:(W=A._readableState)===null||W===void 0?void 0:W.errorEmitted)!==null&&Z!==void 0?Z:(U=A._writableState)===null||U===void 0?void 0:U.errorEmitted)!==null&&te!==void 0?te:(N=A._readableState)===null||N===void 0?void 0:N.errored)!==null&&J!==void 0?J:!((k=A._writableState)===null||k===void 0)&&k.errored))}return MO={isDestroyed:g,kIsDestroyed:r,isDisturbed:F,kIsDisturbed:s,isErrored:ee,kIsErrored:n,isReadable:P,kIsReadable:i,kIsClosedPromise:u,kControllerErrorFunction:l,kIsWritable:o,isClosed:q,isDuplexNodeStream:p,isFinished:T,isIterable:b,isReadableNodeStream:c,isReadableStream:y,isReadableEnded:S,isReadableFinished:R,isReadableErrored:K,isNodeStream:h,isWebStream:m,isWritable:C,isWritableNodeStream:f,isWritableStream:d,isWritableEnded:v,isWritableFinished:w,isWritableErrored:M,isServerRequest:Q,isServerResponse:H,willEmitClose:se,isTransformStream:_},MO}var r$;function nl(){if(r$)return Q_.exports;r$=1;const a=Ic(),{AbortError:e,codes:t}=Qt(),{ERR_INVALID_ARG_TYPE:r,ERR_STREAM_PREMATURE_CLOSE:n}=t,{kEmptyObject:i,once:o}=nr(),{validateAbortSignal:s,validateFunction:u,validateObject:l,validateBoolean:c}=r_(),{Promise:f,PromisePrototypeThen:p,SymbolDispose:h}=ut(),{isClosed:y,isReadable:d,isReadableNodeStream:_,isReadableStream:m,isReadableFinished:b,isReadableErrored:g,isWritable:v,isWritableNodeStream:w,isWritableStream:S,isWritableFinished:R,isWritableErrored:P,isNodeStream:C,willEmitClose:T,kIsClosedPromise:M}=Pu();let K;function q(F){return F.setHeader&&typeof F.abort=="function"}const B=()=>{};function H(F,ee,A){var J,te;if(arguments.length===2?(A=ee,ee=i):ee==null?ee=i:l(ee,"options"),u(A,"callback"),s(ee.signal,"options.signal"),A=o(A),m(F)||S(F))return Q(F,ee,A);if(!C(F))throw new r("stream",["ReadableStream","WritableStream","Stream"],F);const Z=(J=ee.readable)!==null&&J!==void 0?J:_(F),he=(te=ee.writable)!==null&&te!==void 0?te:w(F),ye=F._writableState,ve=F._readableState,W=()=>{F.writable||k()};let U=T(F)&&_(F)===Z&&w(F)===he,N=R(F,!1);const k=()=>{N=!0,F.destroyed&&(U=!1),!(U&&(!F.readable||Z))&&(!Z||ie)&&A.call(F)};let ie=b(F,!1);const ue=()=>{ie=!0,F.destroyed&&(U=!1),!(U&&(!F.writable||he))&&(!he||N)&&A.call(F)},z=G=>{A.call(F,G)};let V=y(F);const ne=()=>{V=!0;const G=P(F)||g(F);if(G&&typeof G!="boolean")return A.call(F,G);if(Z&&!ie&&_(F,!0)&&!b(F,!1))return A.call(F,new n);if(he&&!N&&!R(F,!1))return A.call(F,new n);A.call(F)},pe=()=>{V=!0;const G=P(F)||g(F);if(G&&typeof G!="boolean")return A.call(F,G);A.call(F)},fe=()=>{F.req.on("finish",k)};q(F)?(F.on("complete",k),U||F.on("abort",ne),F.req?fe():F.on("request",fe)):he&&!ye&&(F.on("end",W),F.on("close",W)),!U&&typeof F.aborted=="boolean"&&F.on("aborted",ne),F.on("end",ue),F.on("finish",k),ee.error!==!1&&F.on("error",z),F.on("close",ne),V?a.nextTick(ne):ye!=null&&ye.errorEmitted||ve!=null&&ve.errorEmitted?U||a.nextTick(pe):(!Z&&(!U||d(F))&&(N||v(F)===!1)||!he&&(!U||v(F))&&(ie||d(F)===!1)||ve&&F.req&&F.aborted)&&a.nextTick(pe);const _e=()=>{A=B,F.removeListener("aborted",ne),F.removeListener("complete",k),F.removeListener("abort",ne),F.removeListener("request",fe),F.req&&F.req.removeListener("finish",k),F.removeListener("end",W),F.removeListener("close",W),F.removeListener("finish",k),F.removeListener("end",ue),F.removeListener("error",z),F.removeListener("close",ne)};if(ee.signal&&!V){const G=()=>{const le=A;_e(),le.call(F,new e(void 0,{cause:ee.signal.reason}))};if(ee.signal.aborted)a.nextTick(G);else{K=K||nr().addAbortListener;const le=K(ee.signal,G),de=A;A=o((...ae)=>{le[h](),de.apply(F,ae)})}}return _e}function Q(F,ee,A){let J=!1,te=B;if(ee.signal)if(te=()=>{J=!0,A.call(F,new e(void 0,{cause:ee.signal.reason}))},ee.signal.aborted)a.nextTick(te);else{K=K||nr().addAbortListener;const he=K(ee.signal,te),ye=A;A=o((...ve)=>{he[h](),ye.apply(F,ve)})}const Z=(...he)=>{J||a.nextTick(()=>A.apply(F,he))};return p(F[M].promise,Z,Z),B}function se(F,ee){var A;let J=!1;return ee===null&&(ee=i),(A=ee)!==null&&A!==void 0&&A.cleanup&&(c(ee.cleanup,"cleanup"),J=ee.cleanup),new f((te,Z)=>{const he=H(F,ee,ye=>{J&&he(),ye?Z(ye):te()})})}return Q_.exports=H,Q_.exports.finished=se,Q_.exports}var AO,n$;function Lf(){if(n$)return AO;n$=1;const a=Ic(),{aggregateTwoErrors:e,codes:{ERR_MULTIPLE_CALLBACK:t},AbortError:r}=Qt(),{Symbol:n}=ut(),{kIsDestroyed:i,isDestroyed:o,isFinished:s,isServerRequest:u}=Pu(),l=n("kDestroy"),c=n("kConstruct");function f(T,M,K){T&&(T.stack,M&&!M.errored&&(M.errored=T),K&&!K.errored&&(K.errored=T))}function p(T,M){const K=this._readableState,q=this._writableState,B=q||K;return q!=null&&q.destroyed||K!=null&&K.destroyed?(typeof M=="function"&&M(),this):(f(T,q,K),q&&(q.destroyed=!0),K&&(K.destroyed=!0),B.constructed?h(this,T,M):this.once(l,function(H){h(this,e(H,T),M)}),this)}function h(T,M,K){let q=!1;function B(H){if(q)return;q=!0;const Q=T._readableState,se=T._writableState;f(H,se,Q),se&&(se.closed=!0),Q&&(Q.closed=!0),typeof K=="function"&&K(H),H?a.nextTick(y,T,H):a.nextTick(d,T)}try{T._destroy(M||null,B)}catch(H){B(H)}}function y(T,M){_(T,M),d(T)}function d(T){const M=T._readableState,K=T._writableState;K&&(K.closeEmitted=!0),M&&(M.closeEmitted=!0),(K!=null&&K.emitClose||M!=null&&M.emitClose)&&T.emit("close")}function _(T,M){const K=T._readableState,q=T._writableState;q!=null&&q.errorEmitted||K!=null&&K.errorEmitted||(q&&(q.errorEmitted=!0),K&&(K.errorEmitted=!0),T.emit("error",M))}function m(){const T=this._readableState,M=this._writableState;T&&(T.constructed=!0,T.closed=!1,T.closeEmitted=!1,T.destroyed=!1,T.errored=null,T.errorEmitted=!1,T.reading=!1,T.ended=T.readable===!1,T.endEmitted=T.readable===!1),M&&(M.constructed=!0,M.destroyed=!1,M.closed=!1,M.closeEmitted=!1,M.errored=null,M.errorEmitted=!1,M.finalCalled=!1,M.prefinished=!1,M.ended=M.writable===!1,M.ending=M.writable===!1,M.finished=M.writable===!1)}function b(T,M,K){const q=T._readableState,B=T._writableState;if(B!=null&&B.destroyed||q!=null&&q.destroyed)return this;q!=null&&q.autoDestroy||B!=null&&B.autoDestroy?T.destroy(M):M&&(M.stack,B&&!B.errored&&(B.errored=M),q&&!q.errored&&(q.errored=M),K?a.nextTick(_,T,M):_(T,M))}function g(T,M){if(typeof T._construct!="function")return;const K=T._readableState,q=T._writableState;K&&(K.constructed=!1),q&&(q.constructed=!1),T.once(c,M),!(T.listenerCount(c)>1)&&a.nextTick(v,T)}function v(T){let M=!1;function K(q){if(M){b(T,q??new t);return}M=!0;const B=T._readableState,H=T._writableState,Q=H||B;B&&(B.constructed=!0),H&&(H.constructed=!0),Q.destroyed?T.emit(l,q):q?b(T,q,!0):a.nextTick(w,T)}try{T._construct(q=>{a.nextTick(K,q)})}catch(q){a.nextTick(K,q)}}function w(T){T.emit(c)}function S(T){return(T==null?void 0:T.setHeader)&&typeof T.abort=="function"}function R(T){T.emit("close")}function P(T,M){T.emit("error",M),a.nextTick(R,T)}function C(T,M){!T||o(T)||(!M&&!s(T)&&(M=new r),u(T)?(T.socket=null,T.destroy(M)):S(T)?T.abort():S(T.req)?T.req.abort():typeof T.destroy=="function"?T.destroy(M):typeof T.close=="function"?T.close():M?a.nextTick(P,T,M):a.nextTick(R,T),T.destroyed||(T[i]=!0))}return AO={construct:g,destroyer:C,destroy:p,undestroy:m,errorOrDestroy:b},AO}var IO,i$;function AC(){if(i$)return IO;i$=1;const{ArrayIsArray:a,ObjectSetPrototypeOf:e}=ut(),{EventEmitter:t}=Ib();function r(i){t.call(this,i)}e(r.prototype,t.prototype),e(r,t),r.prototype.pipe=function(i,o){const s=this;function u(d){i.writable&&i.write(d)===!1&&s.pause&&s.pause()}s.on("data",u);function l(){s.readable&&s.resume&&s.resume()}i.on("drain",l),!i._isStdio&&(!o||o.end!==!1)&&(s.on("end",f),s.on("close",p));let c=!1;function f(){c||(c=!0,i.end())}function p(){c||(c=!0,typeof i.destroy=="function"&&i.destroy())}function h(d){y(),t.listenerCount(this,"error")===0&&this.emit("error",d)}n(s,"error",h),n(i,"error",h);function y(){s.removeListener("data",u),i.removeListener("drain",l),s.removeListener("end",f),s.removeListener("close",p),s.removeListener("error",h),i.removeListener("error",h),s.removeListener("end",y),s.removeListener("close",y),i.removeListener("close",y)}return s.on("end",y),s.on("close",y),i.on("close",y),i.emit("pipe",s),i};function n(i,o,s){if(typeof i.prependListener=="function")return i.prependListener(o,s);!i._events||!i._events[o]?i.on(o,s):a(i._events[o])?i._events[o].unshift(s):i._events[o]=[s,i._events[o]]}return IO={Stream:r,prependListener:n},IO}var DO={exports:{}},a$;function Db(){return a$||(a$=1,function(a){const{SymbolDispose:e}=ut(),{AbortError:t,codes:r}=Qt(),{isNodeStream:n,isWebStream:i,kControllerErrorFunction:o}=Pu(),s=nl(),{ERR_INVALID_ARG_TYPE:u}=r;let l;const c=(f,p)=>{if(typeof f!="object"||!("aborted"in f))throw new u(p,"AbortSignal",f)};a.exports.addAbortSignal=function(p,h){if(c(p,"signal"),!n(h)&&!i(h))throw new u("stream",["ReadableStream","WritableStream","Stream"],h);return a.exports.addAbortSignalNoValidate(p,h)},a.exports.addAbortSignalNoValidate=function(f,p){if(typeof f!="object"||!("aborted"in f))return p;const h=n(p)?()=>{p.destroy(new t(void 0,{cause:f.reason}))}:()=>{p[o](new t(void 0,{cause:f.reason}))};if(f.aborted)h();else{l=l||nr().addAbortListener;const y=l(f,h);s(p,y[e])}return p}}(DO)),DO.exports}var xO,o$;function xoe(){if(o$)return xO;o$=1;const{StringPrototypeSlice:a,SymbolIterator:e,TypedArrayPrototypeSet:t,Uint8Array:r}=ut(),{Buffer:n}=rl(),{inspect:i}=nr();return xO=class{constructor(){this.head=null,this.tail=null,this.length=0}push(s){const u={data:s,next:null};this.length>0?this.tail.next=u:this.head=u,this.tail=u,++this.length}unshift(s){const u={data:s,next:this.head};this.length===0&&(this.tail=u),this.head=u,++this.length}shift(){if(this.length===0)return;const s=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,s}clear(){this.head=this.tail=null,this.length=0}join(s){if(this.length===0)return"";let u=this.head,l=""+u.data;for(;(u=u.next)!==null;)l+=s+u.data;return l}concat(s){if(this.length===0)return n.alloc(0);const u=n.allocUnsafe(s>>>0);let l=this.head,c=0;for(;l;)t(u,l.data,c),c+=l.data.length,l=l.next;return u}consume(s,u){const l=this.head.data;if(s<l.length){const c=l.slice(0,s);return this.head.data=l.slice(s),c}return s===l.length?this.shift():u?this._getString(s):this._getBuffer(s)}first(){return this.head.data}*[e](){for(let s=this.head;s;s=s.next)yield s.data}_getString(s){let u="",l=this.head,c=0;do{const f=l.data;if(s>f.length)u+=f,s-=f.length;else{s===f.length?(u+=f,++c,l.next?this.head=l.next:this.head=this.tail=null):(u+=a(f,0,s),this.head=l,l.data=a(f,s));break}++c}while((l=l.next)!==null);return this.length-=c,u}_getBuffer(s){const u=n.allocUnsafe(s),l=s;let c=this.head,f=0;do{const p=c.data;if(s>p.length)t(u,p,l-s),s-=p.length;else{s===p.length?(t(u,p,l-s),++f,c.next?this.head=c.next:this.head=this.tail=null):(t(u,new r(p.buffer,p.byteOffset,s),l-s),this.head=c,c.data=p.slice(s));break}++f}while((c=c.next)!==null);return this.length-=f,u}[Symbol.for("nodejs.util.inspect.custom")](s,u){return i(this,{...u,depth:0,customInspect:!1})}},xO}var $O,s$;function xb(){if(s$)return $O;s$=1;const{MathFloor:a,NumberIsInteger:e}=ut(),{validateInteger:t}=r_(),{ERR_INVALID_ARG_VALUE:r}=Qt().codes;let n=16*1024,i=16;function o(c,f,p){return c.highWaterMark!=null?c.highWaterMark:f?c[p]:null}function s(c){return c?i:n}function u(c,f){t(f,"value",0),c?i=f:n=f}function l(c,f,p,h){const y=o(f,h,p);if(y!=null){if(!e(y)||y<0){const d=h?`options.${p}`:"options.highWaterMark";throw new r(d,y)}return a(y)}return s(c.objectMode)}return $O={getHighWaterMark:l,getDefaultHighWaterMark:s,setDefaultHighWaterMark:u},$O}var NO={},Y_={exports:{}};/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */var u$;function $oe(){return u$||(u$=1,function(a,e){var t=rl(),r=t.Buffer;function n(o,s){for(var u in o)s[u]=o[u]}r.from&&r.alloc&&r.allocUnsafe&&r.allocUnsafeSlow?a.exports=t:(n(t,e),e.Buffer=i);function i(o,s,u){return r(o,s,u)}i.prototype=Object.create(r.prototype),n(r,i),i.from=function(o,s,u){if(typeof o=="number")throw new TypeError("Argument must not be a number");return r(o,s,u)},i.alloc=function(o,s,u){if(typeof o!="number")throw new TypeError("Argument must be a number");var l=r(o);return s!==void 0?typeof u=="string"?l.fill(s,u):l.fill(s):l.fill(0),l},i.allocUnsafe=function(o){if(typeof o!="number")throw new TypeError("Argument must be a number");return r(o)},i.allocUnsafeSlow=function(o){if(typeof o!="number")throw new TypeError("Argument must be a number");return t.SlowBuffer(o)}}(Y_,Y_.exports)),Y_.exports}var l$;function Noe(){if(l$)return NO;l$=1;var a=$oe().Buffer,e=a.isEncoding||function(m){switch(m=""+m,m&&m.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function t(m){if(!m)return"utf8";for(var b;;)switch(m){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return m;default:if(b)return;m=(""+m).toLowerCase(),b=!0}}function r(m){var b=t(m);if(typeof b!="string"&&(a.isEncoding===e||!e(m)))throw new Error("Unknown encoding: "+m);return b||m}NO.StringDecoder=n;function n(m){this.encoding=r(m);var b;switch(this.encoding){case"utf16le":this.text=f,this.end=p,b=4;break;case"utf8":this.fillLast=u,b=4;break;case"base64":this.text=h,this.end=y,b=3;break;default:this.write=d,this.end=_;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=a.allocUnsafe(b)}n.prototype.write=function(m){if(m.length===0)return"";var b,g;if(this.lastNeed){if(b=this.fillLast(m),b===void 0)return"";g=this.lastNeed,this.lastNeed=0}else g=0;return g<m.length?b?b+this.text(m,g):this.text(m,g):b||""},n.prototype.end=c,n.prototype.text=l,n.prototype.fillLast=function(m){if(this.lastNeed<=m.length)return m.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);m.copy(this.lastChar,this.lastTotal-this.lastNeed,0,m.length),this.lastNeed-=m.length};function i(m){return m<=127?0:m>>5===6?2:m>>4===14?3:m>>3===30?4:m>>6===2?-1:-2}function o(m,b,g){var v=b.length-1;if(v<g)return 0;var w=i(b[v]);return w>=0?(w>0&&(m.lastNeed=w-1),w):--v<g||w===-2?0:(w=i(b[v]),w>=0?(w>0&&(m.lastNeed=w-2),w):--v<g||w===-2?0:(w=i(b[v]),w>=0?(w>0&&(w===2?w=0:m.lastNeed=w-3),w):0))}function s(m,b,g){if((b[0]&192)!==128)return m.lastNeed=0,"";if(m.lastNeed>1&&b.length>1){if((b[1]&192)!==128)return m.lastNeed=1,"";if(m.lastNeed>2&&b.length>2&&(b[2]&192)!==128)return m.lastNeed=2,""}}function u(m){var b=this.lastTotal-this.lastNeed,g=s(this,m);if(g!==void 0)return g;if(this.lastNeed<=m.length)return m.copy(this.lastChar,b,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);m.copy(this.lastChar,b,0,m.length),this.lastNeed-=m.length}function l(m,b){var g=o(this,m,b);if(!this.lastNeed)return m.toString("utf8",b);this.lastTotal=g;var v=m.length-(g-this.lastNeed);return m.copy(this.lastChar,0,v),m.toString("utf8",b,v)}function c(m){var b=m&&m.length?this.write(m):"";return this.lastNeed?b+"":b}function f(m,b){if((m.length-b)%2===0){var g=m.toString("utf16le",b);if(g){var v=g.charCodeAt(g.length-1);if(v>=55296&&v<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=m[m.length-2],this.lastChar[1]=m[m.length-1],g.slice(0,-1)}return g}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=m[m.length-1],m.toString("utf16le",b,m.length-1)}function p(m){var b=m&&m.length?this.write(m):"";if(this.lastNeed){var g=this.lastTotal-this.lastNeed;return b+this.lastChar.toString("utf16le",0,g)}return b}function h(m,b){var g=(m.length-b)%3;return g===0?m.toString("base64",b):(this.lastNeed=3-g,this.lastTotal=3,g===1?this.lastChar[0]=m[m.length-1]:(this.lastChar[0]=m[m.length-2],this.lastChar[1]=m[m.length-1]),m.toString("base64",b,m.length-g))}function y(m){var b=m&&m.length?this.write(m):"";return this.lastNeed?b+this.lastChar.toString("base64",0,3-this.lastNeed):b}function d(m){return m.toString(this.encoding)}function _(m){return m&&m.length?this.write(m):""}return NO}var qO,c$;function oG(){if(c$)return qO;c$=1;const a=Ic(),{PromisePrototypeThen:e,SymbolAsyncIterator:t,SymbolIterator:r}=ut(),{Buffer:n}=rl(),{ERR_INVALID_ARG_TYPE:i,ERR_STREAM_NULL_VALUES:o}=Qt().codes;function s(u,l,c){let f;if(typeof l=="string"||l instanceof n)return new u({objectMode:!0,...c,read(){this.push(l),this.push(null)}});let p;if(l&&l[t])p=!0,f=l[t]();else if(l&&l[r])p=!1,f=l[r]();else throw new i("iterable",["Iterable"],l);const h=new u({objectMode:!0,highWaterMark:1,...c});let y=!1;h._read=function(){y||(y=!0,_())},h._destroy=function(m,b){e(d(m),()=>a.nextTick(b,m),g=>a.nextTick(b,g||m))};async function d(m){const b=m!=null,g=typeof f.throw=="function";if(b&&g){const{value:v,done:w}=await f.throw(m);if(await v,w)return}if(typeof f.return=="function"){const{value:v}=await f.return();await v}}async function _(){for(;;){try{const{value:m,done:b}=p?await f.next():f.next();if(b)h.push(null);else{const g=m&&typeof m.then=="function"?await m:m;if(g===null)throw y=!1,new o;if(h.push(g))continue;y=!1}}catch(m){h.destroy(m)}break}}return h}return qO=s,qO}var zO,f$;function $b(){if(f$)return zO;f$=1;const a=Ic(),{ArrayPrototypeIndexOf:e,NumberIsInteger:t,NumberIsNaN:r,NumberParseInt:n,ObjectDefineProperties:i,ObjectKeys:o,ObjectSetPrototypeOf:s,Promise:u,SafeSet:l,SymbolAsyncDispose:c,SymbolAsyncIterator:f,Symbol:p}=ut();zO=ae,ae.ReadableState=de;const{EventEmitter:h}=Ib(),{Stream:y,prependListener:d}=AC(),{Buffer:_}=rl(),{addAbortSignal:m}=Db(),b=nl();let g=nr().debuglog("stream",I=>{g=I});const v=xoe(),w=Lf(),{getHighWaterMark:S,getDefaultHighWaterMark:R}=xb(),{aggregateTwoErrors:P,codes:{ERR_INVALID_ARG_TYPE:C,ERR_METHOD_NOT_IMPLEMENTED:T,ERR_OUT_OF_RANGE:M,ERR_STREAM_PUSH_AFTER_EOF:K,ERR_STREAM_UNSHIFT_AFTER_END_EVENT:q},AbortError:B}=Qt(),{validateObject:H}=r_(),Q=p("kPaused"),{StringDecoder:se}=Noe(),F=oG();s(ae.prototype,y.prototype),s(ae,y);const ee=()=>{},{errorOrDestroy:A}=w,J=1,te=2,Z=4,he=8,ye=16,ve=32,W=64,U=128,N=256,k=512,ie=1024,ue=2048,z=4096,V=8192,ne=16384,pe=32768,fe=65536,_e=1<<17,G=1<<18;function le(I){return{enumerable:!1,get(){return(this.state&I)!==0},set(x){x?this.state|=I:this.state&=~I}}}i(de.prototype,{objectMode:le(J),ended:le(te),endEmitted:le(Z),reading:le(he),constructed:le(ye),sync:le(ve),needReadable:le(W),emittedReadable:le(U),readableListening:le(N),resumeScheduled:le(k),errorEmitted:le(ie),emitClose:le(ue),autoDestroy:le(z),destroyed:le(V),closed:le(ne),closeEmitted:le(pe),multiAwaitDrain:le(fe),readingMore:le(_e),dataEmitted:le(G)});function de(I,x,me){typeof me!="boolean"&&(me=x instanceof Cu()),this.state=ue|z|ye|ve,I&&I.objectMode&&(this.state|=J),me&&I&&I.readableObjectMode&&(this.state|=J),this.highWaterMark=I?S(this,I,"readableHighWaterMark",me):R(!1),this.buffer=new v,this.length=0,this.pipes=[],this.flowing=null,this[Q]=null,I&&I.emitClose===!1&&(this.state&=-2049),I&&I.autoDestroy===!1&&(this.state&=-4097),this.errored=null,this.defaultEncoding=I&&I.defaultEncoding||"utf8",this.awaitDrainWriters=null,this.decoder=null,this.encoding=null,I&&I.encoding&&(this.decoder=new se(I.encoding),this.encoding=I.encoding)}function ae(I){if(!(this instanceof ae))return new ae(I);const x=this instanceof Cu();this._readableState=new de(I,this,x),I&&(typeof I.read=="function"&&(this._read=I.read),typeof I.destroy=="function"&&(this._destroy=I.destroy),typeof I.construct=="function"&&(this._construct=I.construct),I.signal&&!x&&m(I.signal,this)),y.call(this,I),w.construct(this,()=>{this._readableState.needReadable&&L(this,this._readableState)})}ae.prototype.destroy=w.destroy,ae.prototype._undestroy=w.undestroy,ae.prototype._destroy=function(I,x){x(I)},ae.prototype[h.captureRejectionSymbol]=function(I){this.destroy(I)},ae.prototype[c]=function(){let I;return this.destroyed||(I=this.readableEnded?null:new B,this.destroy(I)),new u((x,me)=>b(this,ge=>ge&&ge!==I?me(ge):x(null)))},ae.prototype.push=function(I,x){return Ae(this,I,x,!1)},ae.prototype.unshift=function(I,x){return Ae(this,I,x,!0)};function Ae(I,x,me,ge){g("readableAddChunk",x);const Se=I._readableState;let lt;if((Se.state&J)===0&&(typeof x=="string"?(me=me||Se.defaultEncoding,Se.encoding!==me&&(ge&&Se.encoding?x=_.from(x,me).toString(Se.encoding):(x=_.from(x,me),me=""))):x instanceof _?me="":y._isUint8Array(x)?(x=y._uint8ArrayToBuffer(x),me=""):x!=null&&(lt=new C("chunk",["string","Buffer","Uint8Array"],x))),lt)A(I,lt);else if(x===null)Se.state&=-9,O(I,Se);else if((Se.state&J)!==0||x&&x.length>0)if(ge)if((Se.state&Z)!==0)A(I,new q);else{if(Se.destroyed||Se.errored)return!1;at(I,Se,x,!0)}else if(Se.ended)A(I,new K);else{if(Se.destroyed||Se.errored)return!1;Se.state&=-9,Se.decoder&&!me?(x=Se.decoder.write(x),Se.objectMode||x.length!==0?at(I,Se,x,!1):L(I,Se)):at(I,Se,x,!1)}else ge||(Se.state&=-9,L(I,Se));return!Se.ended&&(Se.length<Se.highWaterMark||Se.length===0)}function at(I,x,me,ge){x.flowing&&x.length===0&&!x.sync&&I.listenerCount("data")>0?((x.state&fe)!==0?x.awaitDrainWriters.clear():x.awaitDrainWriters=null,x.dataEmitted=!0,I.emit("data",me)):(x.length+=x.objectMode?1:me.length,ge?x.buffer.unshift(me):x.buffer.push(me),(x.state&W)!==0&&E(I)),L(I,x)}ae.prototype.isPaused=function(){const I=this._readableState;return I[Q]===!0||I.flowing===!1},ae.prototype.setEncoding=function(I){const x=new se(I);this._readableState.decoder=x,this._readableState.encoding=this._readableState.decoder.encoding;const me=this._readableState.buffer;let ge="";for(const Se of me)ge+=x.write(Se);return me.clear(),ge!==""&&me.push(ge),this._readableState.length=ge.length,this};const Ne=1073741824;function Et(I){if(I>Ne)throw new M("size","<= 1GiB",I);return I--,I|=I>>>1,I|=I>>>2,I|=I>>>4,I|=I>>>8,I|=I>>>16,I++,I}function j(I,x){return I<=0||x.length===0&&x.ended?0:(x.state&J)!==0?1:r(I)?x.flowing&&x.length?x.buffer.first().length:x.length:I<=x.length?I:x.ended?x.length:0}ae.prototype.read=function(I){g("read",I),I===void 0?I=NaN:t(I)||(I=n(I,10));const x=this._readableState,me=I;if(I>x.highWaterMark&&(x.highWaterMark=Et(I)),I!==0&&(x.state&=-129),I===0&&x.needReadable&&((x.highWaterMark!==0?x.length>=x.highWaterMark:x.length>0)||x.ended))return g("read: emitReadable",x.length,x.ended),x.length===0&&x.ended?Rr(this):E(this),null;if(I=j(I,x),I===0&&x.ended)return x.length===0&&Rr(this),null;let ge=(x.state&W)!==0;if(g("need readable",ge),(x.length===0||x.length-I<x.highWaterMark)&&(ge=!0,g("length less than watermark",ge)),x.ended||x.reading||x.destroyed||x.errored||!x.constructed)ge=!1,g("reading, ended or constructing",ge);else if(ge){g("do read"),x.state|=he|ve,x.length===0&&(x.state|=W);try{this._read(x.highWaterMark)}catch(lt){A(this,lt)}x.state&=-33,x.reading||(I=j(me,x))}let Se;return I>0?Se=Ie(I,x):Se=null,Se===null?(x.needReadable=x.length<=x.highWaterMark,I=0):(x.length-=I,x.multiAwaitDrain?x.awaitDrainWriters.clear():x.awaitDrainWriters=null),x.length===0&&(x.ended||(x.needReadable=!0),me!==I&&x.ended&&Rr(this)),Se!==null&&!x.errorEmitted&&!x.closeEmitted&&(x.dataEmitted=!0,this.emit("data",Se)),Se};function O(I,x){if(g("onEofChunk"),!x.ended){if(x.decoder){const me=x.decoder.end();me&&me.length&&(x.buffer.push(me),x.length+=x.objectMode?1:me.length)}x.ended=!0,x.sync?E(I):(x.needReadable=!1,x.emittedReadable=!0,D(I))}}function E(I){const x=I._readableState;g("emitReadable",x.needReadable,x.emittedReadable),x.needReadable=!1,x.emittedReadable||(g("emitReadable",x.flowing),x.emittedReadable=!0,a.nextTick(D,I))}function D(I){const x=I._readableState;g("emitReadable_",x.destroyed,x.length,x.ended),!x.destroyed&&!x.errored&&(x.length||x.ended)&&(I.emit("readable"),x.emittedReadable=!1),x.needReadable=!x.flowing&&!x.ended&&x.length<=x.highWaterMark,Ee(I)}function L(I,x){!x.readingMore&&x.constructed&&(x.readingMore=!0,a.nextTick(re,I,x))}function re(I,x){for(;!x.reading&&!x.ended&&(x.length<x.highWaterMark||x.flowing&&x.length===0);){const me=x.length;if(g("maybeReadMore read 0"),I.read(0),me===x.length)break}x.readingMore=!1}ae.prototype._read=function(I){throw new T("_read()")},ae.prototype.pipe=function(I,x){const me=this,ge=this._readableState;ge.pipes.length===1&&(ge.multiAwaitDrain||(ge.multiAwaitDrain=!0,ge.awaitDrainWriters=new l(ge.awaitDrainWriters?[ge.awaitDrainWriters]:[]))),ge.pipes.push(I),g("pipe count=%d opts=%j",ge.pipes.length,x);const lt=(!x||x.end!==!1)&&I!==a.stdout&&I!==a.stderr?ul:cl;ge.endEmitted?a.nextTick(lt):me.once("end",lt),I.on("unpipe",Tt);function Tt(Nr,Mt){g("onunpipe"),Nr===me&&Mt&&Mt.hasUnpiped===!1&&(Mt.hasUnpiped=!0,l_())}function ul(){g("onend"),I.end()}let $r,$c=!1;function l_(){g("cleanup"),I.removeListener("close",ll),I.removeListener("finish",zc),$r&&I.removeListener("drain",$r),I.removeListener("error",qc),I.removeListener("unpipe",Tt),me.removeListener("end",ul),me.removeListener("end",cl),me.removeListener("data",Nc),$c=!0,$r&&ge.awaitDrainWriters&&(!I._writableState||I._writableState.needDrain)&&$r()}function kf(){$c||(ge.pipes.length===1&&ge.pipes[0]===I?(g("false write response, pause",0),ge.awaitDrainWriters=I,ge.multiAwaitDrain=!1):ge.pipes.length>1&&ge.pipes.includes(I)&&(g("false write response, pause",ge.awaitDrainWriters.size),ge.awaitDrainWriters.add(I)),me.pause()),$r||($r=ce(me,I),I.on("drain",$r))}me.on("data",Nc);function Nc(Nr){g("ondata");const Mt=I.write(Nr);g("dest.write",Mt),Mt===!1&&kf()}function qc(Nr){if(g("onerror",Nr),cl(),I.removeListener("error",qc),I.listenerCount("error")===0){const Mt=I._writableState||I._readableState;Mt&&!Mt.errorEmitted?A(I,Nr):I.emit("error",Nr)}}d(I,"error",qc);function ll(){I.removeListener("finish",zc),cl()}I.once("close",ll);function zc(){g("onfinish"),I.removeListener("close",ll),cl()}I.once("finish",zc);function cl(){g("unpipe"),me.unpipe(I)}return I.emit("pipe",me),I.writableNeedDrain===!0?kf():ge.flowing||(g("pipe resume"),me.resume()),I};function ce(I,x){return function(){const ge=I._readableState;ge.awaitDrainWriters===x?(g("pipeOnDrain",1),ge.awaitDrainWriters=null):ge.multiAwaitDrain&&(g("pipeOnDrain",ge.awaitDrainWriters.size),ge.awaitDrainWriters.delete(x)),(!ge.awaitDrainWriters||ge.awaitDrainWriters.size===0)&&I.listenerCount("data")&&I.resume()}}ae.prototype.unpipe=function(I){const x=this._readableState,me={hasUnpiped:!1};if(x.pipes.length===0)return this;if(!I){const Se=x.pipes;x.pipes=[],this.pause();for(let lt=0;lt<Se.length;lt++)Se[lt].emit("unpipe",this,{hasUnpiped:!1});return this}const ge=e(x.pipes,I);return ge===-1?this:(x.pipes.splice(ge,1),x.pipes.length===0&&this.pause(),I.emit("unpipe",this,me),this)},ae.prototype.on=function(I,x){const me=y.prototype.on.call(this,I,x),ge=this._readableState;return I==="data"?(ge.readableListening=this.listenerCount("readable")>0,ge.flowing!==!1&&this.resume()):I==="readable"&&!ge.endEmitted&&!ge.readableListening&&(ge.readableListening=ge.needReadable=!0,ge.flowing=!1,ge.emittedReadable=!1,g("on readable",ge.length,ge.reading),ge.length?E(this):ge.reading||a.nextTick(Je,this)),me},ae.prototype.addListener=ae.prototype.on,ae.prototype.removeListener=function(I,x){const me=y.prototype.removeListener.call(this,I,x);return I==="readable"&&a.nextTick(Me,this),me},ae.prototype.off=ae.prototype.removeListener,ae.prototype.removeAllListeners=function(I){const x=y.prototype.removeAllListeners.apply(this,arguments);return(I==="readable"||I===void 0)&&a.nextTick(Me,this),x};function Me(I){const x=I._readableState;x.readableListening=I.listenerCount("readable")>0,x.resumeScheduled&&x[Q]===!1?x.flowing=!0:I.listenerCount("data")>0?I.resume():x.readableListening||(x.flowing=null)}function Je(I){g("readable nexttick read 0"),I.read(0)}ae.prototype.resume=function(){const I=this._readableState;return I.flowing||(g("resume"),I.flowing=!I.readableListening,X(this,I)),I[Q]=!1,this};function X(I,x){x.resumeScheduled||(x.resumeScheduled=!0,a.nextTick(Y,I,x))}function Y(I,x){g("resume",x.reading),x.reading||I.read(0),x.resumeScheduled=!1,I.emit("resume"),Ee(I),x.flowing&&!x.reading&&I.read(0)}ae.prototype.pause=function(){return g("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(g("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState[Q]=!0,this};function Ee(I){const x=I._readableState;for(g("flow",x.flowing);x.flowing&&I.read()!==null;);}ae.prototype.wrap=function(I){let x=!1;I.on("data",ge=>{!this.push(ge)&&I.pause&&(x=!0,I.pause())}),I.on("end",()=>{this.push(null)}),I.on("error",ge=>{A(this,ge)}),I.on("close",()=>{this.destroy()}),I.on("destroy",()=>{this.destroy()}),this._read=()=>{x&&I.resume&&(x=!1,I.resume())};const me=o(I);for(let ge=1;ge<me.length;ge++){const Se=me[ge];this[Se]===void 0&&typeof I[Se]=="function"&&(this[Se]=I[Se].bind(I))}return this},ae.prototype[f]=function(){return Xe(this)},ae.prototype.iterator=function(I){return I!==void 0&&H(I,"options"),Xe(this,I)};function Xe(I,x){typeof I.read!="function"&&(I=ae.wrap(I,{objectMode:!0}));const me=tt(I,x);return me.stream=I,me}async function*tt(I,x){let me=ee;function ge(Tt){this===I?(me(),me=ee):me=Tt}I.on("readable",ge);let Se;const lt=b(I,{writable:!1},Tt=>{Se=Tt?P(Se,Tt):null,me(),me=ee});try{for(;;){const Tt=I.destroyed?null:I.read();if(Tt!==null)yield Tt;else{if(Se)throw Se;if(Se===null)return;await new u(ge)}}}catch(Tt){throw Se=P(Se,Tt),Se}finally{(Se||(x==null?void 0:x.destroyOnReturn)!==!1)&&(Se===void 0||I._readableState.autoDestroy)?w.destroyer(I,null):(I.off("readable",ge),lt())}}i(ae.prototype,{readable:{__proto__:null,get(){const I=this._readableState;return!!I&&I.readable!==!1&&!I.destroyed&&!I.errorEmitted&&!I.endEmitted},set(I){this._readableState&&(this._readableState.readable=!!I)}},readableDidRead:{__proto__:null,enumerable:!1,get:function(){return this._readableState.dataEmitted}},readableAborted:{__proto__:null,enumerable:!1,get:function(){return!!(this._readableState.readable!==!1&&(this._readableState.destroyed||this._readableState.errored)&&!this._readableState.endEmitted)}},readableHighWaterMark:{__proto__:null,enumerable:!1,get:function(){return this._readableState.highWaterMark}},readableBuffer:{__proto__:null,enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}},readableFlowing:{__proto__:null,enumerable:!1,get:function(){return this._readableState.flowing},set:function(I){this._readableState&&(this._readableState.flowing=I)}},readableLength:{__proto__:null,enumerable:!1,get(){return this._readableState.length}},readableObjectMode:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.objectMode:!1}},readableEncoding:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.encoding:null}},errored:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.errored:null}},closed:{__proto__:null,get(){return this._readableState?this._readableState.closed:!1}},destroyed:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.destroyed:!1},set(I){this._readableState&&(this._readableState.destroyed=I)}},readableEnded:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.endEmitted:!1}}}),i(de.prototype,{pipesCount:{__proto__:null,get(){return this.pipes.length}},paused:{__proto__:null,get(){return this[Q]!==!1},set(I){this[Q]=!!I}}}),ae._fromList=Ie;function Ie(I,x){if(x.length===0)return null;let me;return x.objectMode?me=x.buffer.shift():!I||I>=x.length?(x.decoder?me=x.buffer.join(""):x.buffer.length===1?me=x.buffer.first():me=x.buffer.concat(x.length),x.buffer.clear()):me=x.buffer.consume(I,x.decoder),me}function Rr(I){const x=I._readableState;g("endReadable",x.endEmitted),x.endEmitted||(x.ended=!0,a.nextTick(uu,x,I))}function uu(I,x){if(g("endReadableNT",I.endEmitted,I.length),!I.errored&&!I.closeEmitted&&!I.endEmitted&&I.length===0){if(I.endEmitted=!0,x.emit("end"),x.writable&&x.allowHalfOpen===!1)a.nextTick(zt,x);else if(I.autoDestroy){const me=x._writableState;(!me||me.autoDestroy&&(me.finished||me.writable===!1))&&x.destroy()}}}function zt(I){I.writable&&!I.writableEnded&&!I.destroyed&&I.end()}ae.from=function(I,x){return F(ae,I,x)};let Cr;function xc(){return Cr===void 0&&(Cr={}),Cr}return ae.fromWeb=function(I,x){return xc().newStreamReadableFromReadableStream(I,x)},ae.toWeb=function(I,x){return xc().newReadableStreamFromStreamReadable(I,x)},ae.wrap=function(I,x){var me,ge;return new ae({objectMode:(me=(ge=I.readableObjectMode)!==null&&ge!==void 0?ge:I.objectMode)!==null&&me!==void 0?me:!0,...x,destroy(Se,lt){w.destroyer(I,Se),lt(Se)}}).wrap(I)},zO}var BO,d$;function IC(){if(d$)return BO;d$=1;const a=Ic(),{ArrayPrototypeSlice:e,Error:t,FunctionPrototypeSymbolHasInstance:r,ObjectDefineProperty:n,ObjectDefineProperties:i,ObjectSetPrototypeOf:o,StringPrototypeToLowerCase:s,Symbol:u,SymbolHasInstance:l}=ut();BO=H,H.WritableState=q;const{EventEmitter:c}=Ib(),f=AC().Stream,{Buffer:p}=rl(),h=Lf(),{addAbortSignal:y}=Db(),{getHighWaterMark:d,getDefaultHighWaterMark:_}=xb(),{ERR_INVALID_ARG_TYPE:m,ERR_METHOD_NOT_IMPLEMENTED:b,ERR_MULTIPLE_CALLBACK:g,ERR_STREAM_CANNOT_PIPE:v,ERR_STREAM_DESTROYED:w,ERR_STREAM_ALREADY_FINISHED:S,ERR_STREAM_NULL_VALUES:R,ERR_STREAM_WRITE_AFTER_END:P,ERR_UNKNOWN_ENCODING:C}=Qt().codes,{errorOrDestroy:T}=h;o(H.prototype,f.prototype),o(H,f);function M(){}const K=u("kOnFinished");function q(z,V,ne){typeof ne!="boolean"&&(ne=V instanceof Cu()),this.objectMode=!!(z&&z.objectMode),ne&&(this.objectMode=this.objectMode||!!(z&&z.writableObjectMode)),this.highWaterMark=z?d(this,z,"writableHighWaterMark",ne):_(!1),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;const pe=!!(z&&z.decodeStrings===!1);this.decodeStrings=!pe,this.defaultEncoding=z&&z.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=A.bind(void 0,V),this.writecb=null,this.writelen=0,this.afterWriteTickInfo=null,B(this),this.pendingcb=0,this.constructed=!0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!z||z.emitClose!==!1,this.autoDestroy=!z||z.autoDestroy!==!1,this.errored=null,this.closed=!1,this.closeEmitted=!1,this[K]=[]}function B(z){z.buffered=[],z.bufferedIndex=0,z.allBuffers=!0,z.allNoop=!0}q.prototype.getBuffer=function(){return e(this.buffered,this.bufferedIndex)},n(q.prototype,"bufferedRequestCount",{__proto__:null,get(){return this.buffered.length-this.bufferedIndex}});function H(z){const V=this instanceof Cu();if(!V&&!r(H,this))return new H(z);this._writableState=new q(z,this,V),z&&(typeof z.write=="function"&&(this._write=z.write),typeof z.writev=="function"&&(this._writev=z.writev),typeof z.destroy=="function"&&(this._destroy=z.destroy),typeof z.final=="function"&&(this._final=z.final),typeof z.construct=="function"&&(this._construct=z.construct),z.signal&&y(z.signal,this)),f.call(this,z),h.construct(this,()=>{const ne=this._writableState;ne.writing||he(this,ne),U(this,ne)})}n(H,l,{__proto__:null,value:function(z){return r(this,z)?!0:this!==H?!1:z&&z._writableState instanceof q}}),H.prototype.pipe=function(){T(this,new v)};function Q(z,V,ne,pe){const fe=z._writableState;if(typeof ne=="function")pe=ne,ne=fe.defaultEncoding;else{if(!ne)ne=fe.defaultEncoding;else if(ne!=="buffer"&&!p.isEncoding(ne))throw new C(ne);typeof pe!="function"&&(pe=M)}if(V===null)throw new R;if(!fe.objectMode)if(typeof V=="string")fe.decodeStrings!==!1&&(V=p.from(V,ne),ne="buffer");else if(V instanceof p)ne="buffer";else if(f._isUint8Array(V))V=f._uint8ArrayToBuffer(V),ne="buffer";else throw new m("chunk",["string","Buffer","Uint8Array"],V);let _e;return fe.ending?_e=new P:fe.destroyed&&(_e=new w("write")),_e?(a.nextTick(pe,_e),T(z,_e,!0),_e):(fe.pendingcb++,se(z,fe,V,ne,pe))}H.prototype.write=function(z,V,ne){return Q(this,z,V,ne)===!0},H.prototype.cork=function(){this._writableState.corked++},H.prototype.uncork=function(){const z=this._writableState;z.corked&&(z.corked--,z.writing||he(this,z))},H.prototype.setDefaultEncoding=function(V){if(typeof V=="string"&&(V=s(V)),!p.isEncoding(V))throw new C(V);return this._writableState.defaultEncoding=V,this};function se(z,V,ne,pe,fe){const _e=V.objectMode?1:ne.length;V.length+=_e;const G=V.length<V.highWaterMark;return G||(V.needDrain=!0),V.writing||V.corked||V.errored||!V.constructed?(V.buffered.push({chunk:ne,encoding:pe,callback:fe}),V.allBuffers&&pe!=="buffer"&&(V.allBuffers=!1),V.allNoop&&fe!==M&&(V.allNoop=!1)):(V.writelen=_e,V.writecb=fe,V.writing=!0,V.sync=!0,z._write(ne,pe,V.onwrite),V.sync=!1),G&&!V.errored&&!V.destroyed}function F(z,V,ne,pe,fe,_e,G){V.writelen=pe,V.writecb=G,V.writing=!0,V.sync=!0,V.destroyed?V.onwrite(new w("write")):ne?z._writev(fe,V.onwrite):z._write(fe,_e,V.onwrite),V.sync=!1}function ee(z,V,ne,pe){--V.pendingcb,pe(ne),Z(V),T(z,ne)}function A(z,V){const ne=z._writableState,pe=ne.sync,fe=ne.writecb;if(typeof fe!="function"){T(z,new g);return}ne.writing=!1,ne.writecb=null,ne.length-=ne.writelen,ne.writelen=0,V?(V.stack,ne.errored||(ne.errored=V),z._readableState&&!z._readableState.errored&&(z._readableState.errored=V),pe?a.nextTick(ee,z,ne,V,fe):ee(z,ne,V,fe)):(ne.buffered.length>ne.bufferedIndex&&he(z,ne),pe?ne.afterWriteTickInfo!==null&&ne.afterWriteTickInfo.cb===fe?ne.afterWriteTickInfo.count++:(ne.afterWriteTickInfo={count:1,cb:fe,stream:z,state:ne},a.nextTick(J,ne.afterWriteTickInfo)):te(z,ne,1,fe))}function J({stream:z,state:V,count:ne,cb:pe}){return V.afterWriteTickInfo=null,te(z,V,ne,pe)}function te(z,V,ne,pe){for(!V.ending&&!z.destroyed&&V.length===0&&V.needDrain&&(V.needDrain=!1,z.emit("drain"));ne-- >0;)V.pendingcb--,pe();V.destroyed&&Z(V),U(z,V)}function Z(z){if(z.writing)return;for(let fe=z.bufferedIndex;fe<z.buffered.length;++fe){var V;const{chunk:_e,callback:G}=z.buffered[fe],le=z.objectMode?1:_e.length;z.length-=le,G((V=z.errored)!==null&&V!==void 0?V:new w("write"))}const ne=z[K].splice(0);for(let fe=0;fe<ne.length;fe++){var pe;ne[fe]((pe=z.errored)!==null&&pe!==void 0?pe:new w("end"))}B(z)}function he(z,V){if(V.corked||V.bufferProcessing||V.destroyed||!V.constructed)return;const{buffered:ne,bufferedIndex:pe,objectMode:fe}=V,_e=ne.length-pe;if(!_e)return;let G=pe;if(V.bufferProcessing=!0,_e>1&&z._writev){V.pendingcb-=_e-1;const le=V.allNoop?M:ae=>{for(let Ae=G;Ae<ne.length;++Ae)ne[Ae].callback(ae)},de=V.allNoop&&G===0?ne:e(ne,G);de.allBuffers=V.allBuffers,F(z,V,!0,V.length,de,"",le),B(V)}else{do{const{chunk:le,encoding:de,callback:ae}=ne[G];ne[G++]=null;const Ae=fe?1:le.length;F(z,V,!1,Ae,le,de,ae)}while(G<ne.length&&!V.writing);G===ne.length?B(V):G>256?(ne.splice(0,G),V.bufferedIndex=0):V.bufferedIndex=G}V.bufferProcessing=!1}H.prototype._write=function(z,V,ne){if(this._writev)this._writev([{chunk:z,encoding:V}],ne);else throw new b("_write()")},H.prototype._writev=null,H.prototype.end=function(z,V,ne){const pe=this._writableState;typeof z=="function"?(ne=z,z=null,V=null):typeof V=="function"&&(ne=V,V=null);let fe;if(z!=null){const _e=Q(this,z,V);_e instanceof t&&(fe=_e)}return pe.corked&&(pe.corked=1,this.uncork()),fe||(!pe.errored&&!pe.ending?(pe.ending=!0,U(this,pe,!0),pe.ended=!0):pe.finished?fe=new S("end"):pe.destroyed&&(fe=new w("end"))),typeof ne=="function"&&(fe||pe.finished?a.nextTick(ne,fe):pe[K].push(ne)),this};function ye(z){return z.ending&&!z.destroyed&&z.constructed&&z.length===0&&!z.errored&&z.buffered.length===0&&!z.finished&&!z.writing&&!z.errorEmitted&&!z.closeEmitted}function ve(z,V){let ne=!1;function pe(fe){if(ne){T(z,fe??g());return}if(ne=!0,V.pendingcb--,fe){const _e=V[K].splice(0);for(let G=0;G<_e.length;G++)_e[G](fe);T(z,fe,V.sync)}else ye(V)&&(V.prefinished=!0,z.emit("prefinish"),V.pendingcb++,a.nextTick(N,z,V))}V.sync=!0,V.pendingcb++;try{z._final(pe)}catch(fe){pe(fe)}V.sync=!1}function W(z,V){!V.prefinished&&!V.finalCalled&&(typeof z._final=="function"&&!V.destroyed?(V.finalCalled=!0,ve(z,V)):(V.prefinished=!0,z.emit("prefinish")))}function U(z,V,ne){ye(V)&&(W(z,V),V.pendingcb===0&&(ne?(V.pendingcb++,a.nextTick((pe,fe)=>{ye(fe)?N(pe,fe):fe.pendingcb--},z,V)):ye(V)&&(V.pendingcb++,N(z,V))))}function N(z,V){V.pendingcb--,V.finished=!0;const ne=V[K].splice(0);for(let pe=0;pe<ne.length;pe++)ne[pe]();if(z.emit("finish"),V.autoDestroy){const pe=z._readableState;(!pe||pe.autoDestroy&&(pe.endEmitted||pe.readable===!1))&&z.destroy()}}i(H.prototype,{closed:{__proto__:null,get(){return this._writableState?this._writableState.closed:!1}},destroyed:{__proto__:null,get(){return this._writableState?this._writableState.destroyed:!1},set(z){this._writableState&&(this._writableState.destroyed=z)}},writable:{__proto__:null,get(){const z=this._writableState;return!!z&&z.writable!==!1&&!z.destroyed&&!z.errored&&!z.ending&&!z.ended},set(z){this._writableState&&(this._writableState.writable=!!z)}},writableFinished:{__proto__:null,get(){return this._writableState?this._writableState.finished:!1}},writableObjectMode:{__proto__:null,get(){return this._writableState?this._writableState.objectMode:!1}},writableBuffer:{__proto__:null,get(){return this._writableState&&this._writableState.getBuffer()}},writableEnded:{__proto__:null,get(){return this._writableState?this._writableState.ending:!1}},writableNeedDrain:{__proto__:null,get(){const z=this._writableState;return z?!z.destroyed&&!z.ending&&z.needDrain:!1}},writableHighWaterMark:{__proto__:null,get(){return this._writableState&&this._writableState.highWaterMark}},writableCorked:{__proto__:null,get(){return this._writableState?this._writableState.corked:0}},writableLength:{__proto__:null,get(){return this._writableState&&this._writableState.length}},errored:{__proto__:null,enumerable:!1,get(){return this._writableState?this._writableState.errored:null}},writableAborted:{__proto__:null,enumerable:!1,get:function(){return!!(this._writableState.writable!==!1&&(this._writableState.destroyed||this._writableState.errored)&&!this._writableState.finished)}}});const k=h.destroy;H.prototype.destroy=function(z,V){const ne=this._writableState;return!ne.destroyed&&(ne.bufferedIndex<ne.buffered.length||ne[K].length)&&a.nextTick(Z,ne),k.call(this,z,V),this},H.prototype._undestroy=h.undestroy,H.prototype._destroy=function(z,V){V(z)},H.prototype[c.captureRejectionSymbol]=function(z){this.destroy(z)};let ie;function ue(){return ie===void 0&&(ie={}),ie}return H.fromWeb=function(z,V){return ue().newStreamWritableFromWritableStream(z,V)},H.toWeb=function(z){return ue().newWritableStreamFromStreamWritable(z)},BO}var UO,h$;function qoe(){if(h$)return UO;h$=1;const a=Ic(),e=rl(),{isReadable:t,isWritable:r,isIterable:n,isNodeStream:i,isReadableNodeStream:o,isWritableNodeStream:s,isDuplexNodeStream:u,isReadableStream:l,isWritableStream:c}=Pu(),f=nl(),{AbortError:p,codes:{ERR_INVALID_ARG_TYPE:h,ERR_INVALID_RETURN_VALUE:y}}=Qt(),{destroyer:d}=Lf(),_=Cu(),m=$b(),b=IC(),{createDeferredPromise:g}=nr(),v=oG(),w=globalThis.Blob||e.Blob,S=typeof w<"u"?function(q){return q instanceof w}:function(q){return!1},R=globalThis.AbortController||$p().AbortController,{FunctionPrototypeCall:P}=ut();class C extends _{constructor(q){super(q),(q==null?void 0:q.readable)===!1&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),(q==null?void 0:q.writable)===!1&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)}}UO=function K(q,B){if(u(q))return q;if(o(q))return M({readable:q});if(s(q))return M({writable:q});if(i(q))return M({writable:!1,readable:!1});if(l(q))return M({readable:m.fromWeb(q)});if(c(q))return M({writable:b.fromWeb(q)});if(typeof q=="function"){const{value:Q,write:se,final:F,destroy:ee}=T(q);if(n(Q))return v(C,Q,{objectMode:!0,write:se,final:F,destroy:ee});const A=Q==null?void 0:Q.then;if(typeof A=="function"){let J;const te=P(A,Q,Z=>{if(Z!=null)throw new y("nully","body",Z)},Z=>{d(J,Z)});return J=new C({objectMode:!0,readable:!1,write:se,final(Z){F(async()=>{try{await te,a.nextTick(Z,null)}catch(he){a.nextTick(Z,he)}})},destroy:ee})}throw new y("Iterable, AsyncIterable or AsyncFunction",B,Q)}if(S(q))return K(q.arrayBuffer());if(n(q))return v(C,q,{objectMode:!0,writable:!1});if(l(q==null?void 0:q.readable)&&c(q==null?void 0:q.writable))return C.fromWeb(q);if(typeof(q==null?void 0:q.writable)=="object"||typeof(q==null?void 0:q.readable)=="object"){const Q=q!=null&&q.readable?o(q==null?void 0:q.readable)?q==null?void 0:q.readable:K(q.readable):void 0,se=q!=null&&q.writable?s(q==null?void 0:q.writable)?q==null?void 0:q.writable:K(q.writable):void 0;return M({readable:Q,writable:se})}const H=q==null?void 0:q.then;if(typeof H=="function"){let Q;return P(H,q,se=>{se!=null&&Q.push(se),Q.push(null)},se=>{d(Q,se)}),Q=new C({objectMode:!0,writable:!1,read(){}})}throw new h(B,["Blob","ReadableStream","WritableStream","Stream","Iterable","AsyncIterable","Function","{ readable, writable } pair","Promise"],q)};function T(K){let{promise:q,resolve:B}=g();const H=new R,Q=H.signal;return{value:K(async function*(){for(;;){const F=q;q=null;const{chunk:ee,done:A,cb:J}=await F;if(a.nextTick(J),A)return;if(Q.aborted)throw new p(void 0,{cause:Q.reason});({promise:q,resolve:B}=g()),yield ee}}(),{signal:Q}),write(F,ee,A){const J=B;B=null,J({chunk:F,done:!1,cb:A})},final(F){const ee=B;B=null,ee({done:!0,cb:F})},destroy(F,ee){H.abort(),ee(F)}}}function M(K){const q=K.readable&&typeof K.readable.read!="function"?m.wrap(K.readable):K.readable,B=K.writable;let H=!!t(q),Q=!!r(B),se,F,ee,A,J;function te(Z){const he=A;A=null,he?he(Z):Z&&J.destroy(Z)}return J=new C({readableObjectMode:!!(q!=null&&q.readableObjectMode),writableObjectMode:!!(B!=null&&B.writableObjectMode),readable:H,writable:Q}),Q&&(f(B,Z=>{Q=!1,Z&&d(q,Z),te(Z)}),J._write=function(Z,he,ye){B.write(Z,he)?ye():se=ye},J._final=function(Z){B.end(),F=Z},B.on("drain",function(){if(se){const Z=se;se=null,Z()}}),B.on("finish",function(){if(F){const Z=F;F=null,Z()}})),H&&(f(q,Z=>{H=!1,Z&&d(q,Z),te(Z)}),q.on("readable",function(){if(ee){const Z=ee;ee=null,Z()}}),q.on("end",function(){J.push(null)}),J._read=function(){for(;;){const Z=q.read();if(Z===null){ee=J._read;return}if(!J.push(Z))return}}),J._destroy=function(Z,he){!Z&&A!==null&&(Z=new p),ee=null,se=null,F=null,A===null?he(Z):(A=he,d(B,Z),d(q,Z))},J}return UO}var FO,p$;function Cu(){if(p$)return FO;p$=1;const{ObjectDefineProperties:a,ObjectGetOwnPropertyDescriptor:e,ObjectKeys:t,ObjectSetPrototypeOf:r}=ut();FO=o;const n=$b(),i=IC();r(o.prototype,n.prototype),r(o,n);{const c=t(i.prototype);for(let f=0;f<c.length;f++){const p=c[f];o.prototype[p]||(o.prototype[p]=i.prototype[p])}}function o(c){if(!(this instanceof o))return new o(c);n.call(this,c),i.call(this,c),c?(this.allowHalfOpen=c.allowHalfOpen!==!1,c.readable===!1&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),c.writable===!1&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)):this.allowHalfOpen=!0}a(o.prototype,{writable:{__proto__:null,...e(i.prototype,"writable")},writableHighWaterMark:{__proto__:null,...e(i.prototype,"writableHighWaterMark")},writableObjectMode:{__proto__:null,...e(i.prototype,"writableObjectMode")},writableBuffer:{__proto__:null,...e(i.prototype,"writableBuffer")},writableLength:{__proto__:null,...e(i.prototype,"writableLength")},writableFinished:{__proto__:null,...e(i.prototype,"writableFinished")},writableCorked:{__proto__:null,...e(i.prototype,"writableCorked")},writableEnded:{__proto__:null,...e(i.prototype,"writableEnded")},writableNeedDrain:{__proto__:null,...e(i.prototype,"writableNeedDrain")},destroyed:{__proto__:null,get(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set(c){this._readableState&&this._writableState&&(this._readableState.destroyed=c,this._writableState.destroyed=c)}}});let s;function u(){return s===void 0&&(s={}),s}o.fromWeb=function(c,f){return u().newStreamDuplexFromReadableWritablePair(c,f)},o.toWeb=function(c){return u().newReadableWritablePairFromDuplex(c)};let l;return o.from=function(c){return l||(l=qoe()),l(c,"body")},FO}var LO,_$;function sG(){if(_$)return LO;_$=1;const{ObjectSetPrototypeOf:a,Symbol:e}=ut();LO=o;const{ERR_METHOD_NOT_IMPLEMENTED:t}=Qt().codes,r=Cu(),{getHighWaterMark:n}=xb();a(o.prototype,r.prototype),a(o,r);const i=e("kCallback");function o(l){if(!(this instanceof o))return new o(l);const c=l?n(this,l,"readableHighWaterMark",!0):null;c===0&&(l={...l,highWaterMark:null,readableHighWaterMark:c,writableHighWaterMark:l.writableHighWaterMark||0}),r.call(this,l),this._readableState.sync=!1,this[i]=null,l&&(typeof l.transform=="function"&&(this._transform=l.transform),typeof l.flush=="function"&&(this._flush=l.flush)),this.on("prefinish",u)}function s(l){typeof this._flush=="function"&&!this.destroyed?this._flush((c,f)=>{if(c){l?l(c):this.destroy(c);return}f!=null&&this.push(f),this.push(null),l&&l()}):(this.push(null),l&&l())}function u(){this._final!==s&&s.call(this)}return o.prototype._final=s,o.prototype._transform=function(l,c,f){throw new t("_transform()")},o.prototype._write=function(l,c,f){const p=this._readableState,h=this._writableState,y=p.length;this._transform(l,c,(d,_)=>{if(d){f(d);return}_!=null&&this.push(_),h.ended||y===p.length||p.length<p.highWaterMark?f():this[i]=f})},o.prototype._read=function(){if(this[i]){const l=this[i];this[i]=null,l()}},LO}var VO,y$;function uG(){if(y$)return VO;y$=1;const{ObjectSetPrototypeOf:a}=ut();VO=t;const e=sG();a(t.prototype,e.prototype),a(t,e);function t(r){if(!(this instanceof t))return new t(r);e.call(this,r)}return t.prototype._transform=function(r,n,i){i(null,r)},VO}var GO,b$;function DC(){if(b$)return GO;b$=1;const a=Ic(),{ArrayIsArray:e,Promise:t,SymbolAsyncIterator:r,SymbolDispose:n}=ut(),i=nl(),{once:o}=nr(),s=Lf(),u=Cu(),{aggregateTwoErrors:l,codes:{ERR_INVALID_ARG_TYPE:c,ERR_INVALID_RETURN_VALUE:f,ERR_MISSING_ARGS:p,ERR_STREAM_DESTROYED:h,ERR_STREAM_PREMATURE_CLOSE:y},AbortError:d}=Qt(),{validateFunction:_,validateAbortSignal:m}=r_(),{isIterable:b,isReadable:g,isReadableNodeStream:v,isNodeStream:w,isTransformStream:S,isWebStream:R,isReadableStream:P,isReadableFinished:C}=Pu(),T=globalThis.AbortController||$p().AbortController;let M,K,q;function B(Z,he,ye){let ve=!1;Z.on("close",()=>{ve=!0});const W=i(Z,{readable:he,writable:ye},U=>{ve=!U});return{destroy:U=>{ve||(ve=!0,s.destroyer(Z,U||new h("pipe")))},cleanup:W}}function H(Z){return _(Z[Z.length-1],"streams[stream.length - 1]"),Z.pop()}function Q(Z){if(b(Z))return Z;if(v(Z))return se(Z);throw new c("val",["Readable","Iterable","AsyncIterable"],Z)}async function*se(Z){K||(K=$b()),yield*K.prototype[r].call(Z)}async function F(Z,he,ye,{end:ve}){let W,U=null;const N=ue=>{if(ue&&(W=ue),U){const z=U;U=null,z()}},k=()=>new t((ue,z)=>{W?z(W):U=()=>{W?z(W):ue()}});he.on("drain",N);const ie=i(he,{readable:!1},N);try{he.writableNeedDrain&&await k();for await(const ue of Z)he.write(ue)||await k();ve&&(he.end(),await k()),ye()}catch(ue){ye(W!==ue?l(W,ue):ue)}finally{ie(),he.off("drain",N)}}async function ee(Z,he,ye,{end:ve}){S(he)&&(he=he.writable);const W=he.getWriter();try{for await(const U of Z)await W.ready,W.write(U).catch(()=>{});await W.ready,ve&&await W.close(),ye()}catch(U){try{await W.abort(U),ye(U)}catch(N){ye(N)}}}function A(...Z){return J(Z,o(H(Z)))}function J(Z,he,ye){if(Z.length===1&&e(Z[0])&&(Z=Z[0]),Z.length<2)throw new p("streams");const ve=new T,W=ve.signal,U=ye==null?void 0:ye.signal,N=[];m(U,"options.signal");function k(){fe(new d)}q=q||nr().addAbortListener;let ie;U&&(ie=q(U,k));let ue,z;const V=[];let ne=0;function pe(de){fe(de,--ne===0)}function fe(de,ae){var Ae;if(de&&(!ue||ue.code==="ERR_STREAM_PREMATURE_CLOSE")&&(ue=de),!(!ue&&!ae)){for(;V.length;)V.shift()(ue);(Ae=ie)===null||Ae===void 0||Ae[n](),ve.abort(),ae&&(ue||N.forEach(at=>at()),a.nextTick(he,ue,z))}}let _e;for(let de=0;de<Z.length;de++){const ae=Z[de],Ae=de<Z.length-1,at=de>0,Ne=Ae||(ye==null?void 0:ye.end)!==!1,Et=de===Z.length-1;if(w(ae)){let j=function(O){O&&O.name!=="AbortError"&&O.code!=="ERR_STREAM_PREMATURE_CLOSE"&&pe(O)};if(Ne){const{destroy:O,cleanup:E}=B(ae,Ae,at);V.push(O),g(ae)&&Et&&N.push(E)}ae.on("error",j),g(ae)&&Et&&N.push(()=>{ae.removeListener("error",j)})}if(de===0)if(typeof ae=="function"){if(_e=ae({signal:W}),!b(_e))throw new f("Iterable, AsyncIterable or Stream","source",_e)}else b(ae)||v(ae)||S(ae)?_e=ae:_e=u.from(ae);else if(typeof ae=="function"){if(S(_e)){var G;_e=Q((G=_e)===null||G===void 0?void 0:G.readable)}else _e=Q(_e);if(_e=ae(_e,{signal:W}),Ae){if(!b(_e,!0))throw new f("AsyncIterable",`transform[${de-1}]`,_e)}else{var le;M||(M=uG());const j=new M({objectMode:!0}),O=(le=_e)===null||le===void 0?void 0:le.then;if(typeof O=="function")ne++,O.call(_e,L=>{z=L,L!=null&&j.write(L),Ne&&j.end(),a.nextTick(pe)},L=>{j.destroy(L),a.nextTick(pe,L)});else if(b(_e,!0))ne++,F(_e,j,pe,{end:Ne});else if(P(_e)||S(_e)){const L=_e.readable||_e;ne++,F(L,j,pe,{end:Ne})}else throw new f("AsyncIterable or Promise","destination",_e);_e=j;const{destroy:E,cleanup:D}=B(_e,!1,!0);V.push(E),Et&&N.push(D)}}else if(w(ae)){if(v(_e)){ne+=2;const j=te(_e,ae,pe,{end:Ne});g(ae)&&Et&&N.push(j)}else if(S(_e)||P(_e)){const j=_e.readable||_e;ne++,F(j,ae,pe,{end:Ne})}else if(b(_e))ne++,F(_e,ae,pe,{end:Ne});else throw new c("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],_e);_e=ae}else if(R(ae)){if(v(_e))ne++,ee(Q(_e),ae,pe,{end:Ne});else if(P(_e)||b(_e))ne++,ee(_e,ae,pe,{end:Ne});else if(S(_e))ne++,ee(_e.readable,ae,pe,{end:Ne});else throw new c("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],_e);_e=ae}else _e=u.from(ae)}return(W!=null&&W.aborted||U!=null&&U.aborted)&&a.nextTick(k),_e}function te(Z,he,ye,{end:ve}){let W=!1;if(he.on("close",()=>{W||ye(new y)}),Z.pipe(he,{end:!1}),ve){let U=function(){W=!0,he.end()};C(Z)?a.nextTick(U):Z.once("end",U)}else ye();return i(Z,{readable:!0,writable:!1},U=>{const N=Z._readableState;U&&U.code==="ERR_STREAM_PREMATURE_CLOSE"&&N&&N.ended&&!N.errored&&!N.errorEmitted?Z.once("end",ye).once("error",ye):ye(U)}),i(he,{readable:!1,writable:!0},ye)}return GO={pipelineImpl:J,pipeline:A},GO}var kO,m$;function lG(){if(m$)return kO;m$=1;const{pipeline:a}=DC(),e=Cu(),{destroyer:t}=Lf(),{isNodeStream:r,isReadable:n,isWritable:i,isWebStream:o,isTransformStream:s,isWritableStream:u,isReadableStream:l}=Pu(),{AbortError:c,codes:{ERR_INVALID_ARG_VALUE:f,ERR_MISSING_ARGS:p}}=Qt(),h=nl();return kO=function(...d){if(d.length===0)throw new p("streams");if(d.length===1)return e.from(d[0]);const _=[...d];if(typeof d[0]=="function"&&(d[0]=e.from(d[0])),typeof d[d.length-1]=="function"){const M=d.length-1;d[M]=e.from(d[M])}for(let M=0;M<d.length;++M)if(!(!r(d[M])&&!o(d[M]))){if(M<d.length-1&&!(n(d[M])||l(d[M])||s(d[M])))throw new f(`streams[${M}]`,_[M],"must be readable");if(M>0&&!(i(d[M])||u(d[M])||s(d[M])))throw new f(`streams[${M}]`,_[M],"must be writable")}let m,b,g,v,w;function S(M){const K=v;v=null,K?K(M):M?w.destroy(M):!T&&!C&&w.destroy()}const R=d[0],P=a(d,S),C=!!(i(R)||u(R)||s(R)),T=!!(n(P)||l(P)||s(P));if(w=new e({writableObjectMode:!!(R!=null&&R.writableObjectMode),readableObjectMode:!!(P!=null&&P.readableObjectMode),writable:C,readable:T}),C){if(r(R))w._write=function(K,q,B){R.write(K,q)?B():m=B},w._final=function(K){R.end(),b=K},R.on("drain",function(){if(m){const K=m;m=null,K()}});else if(o(R)){const q=(s(R)?R.writable:R).getWriter();w._write=async function(B,H,Q){try{await q.ready,q.write(B).catch(()=>{}),Q()}catch(se){Q(se)}},w._final=async function(B){try{await q.ready,q.close().catch(()=>{}),b=B}catch(H){B(H)}}}const M=s(P)?P.readable:P;h(M,()=>{if(b){const K=b;b=null,K()}})}if(T){if(r(P))P.on("readable",function(){if(g){const M=g;g=null,M()}}),P.on("end",function(){w.push(null)}),w._read=function(){for(;;){const M=P.read();if(M===null){g=w._read;return}if(!w.push(M))return}};else if(o(P)){const K=(s(P)?P.readable:P).getReader();w._read=async function(){for(;;)try{const{value:q,done:B}=await K.read();if(!w.push(q))return;if(B){w.push(null);return}}catch{return}}}}return w._destroy=function(M,K){!M&&v!==null&&(M=new c),g=null,m=null,b=null,v===null?K(M):(v=K,r(P)&&t(P,M))},w},kO}var g$;function zoe(){if(g$)return Z_;g$=1;const a=globalThis.AbortController||$p().AbortController,{codes:{ERR_INVALID_ARG_VALUE:e,ERR_INVALID_ARG_TYPE:t,ERR_MISSING_ARGS:r,ERR_OUT_OF_RANGE:n},AbortError:i}=Qt(),{validateAbortSignal:o,validateInteger:s,validateObject:u}=r_(),l=ut().Symbol("kWeak"),c=ut().Symbol("kResistStopPropagation"),{finished:f}=nl(),p=lG(),{addAbortSignalNoValidate:h}=Db(),{isWritable:y,isNodeStream:d}=Pu(),{deprecate:_}=nr(),{ArrayPrototypePush:m,Boolean:b,MathFloor:g,Number:v,NumberIsNaN:w,Promise:S,PromiseReject:R,PromiseResolve:P,PromisePrototypeThen:C,Symbol:T}=ut(),M=T("kEmpty"),K=T("kEof");function q(U,N){if(N!=null&&u(N,"options"),(N==null?void 0:N.signal)!=null&&o(N.signal,"options.signal"),d(U)&&!y(U))throw new e("stream",U,"must be writable");const k=p(this,U);return N!=null&&N.signal&&h(N.signal,k),k}function B(U,N){if(typeof U!="function")throw new t("fn",["Function","AsyncFunction"],U);N!=null&&u(N,"options"),(N==null?void 0:N.signal)!=null&&o(N.signal,"options.signal");let k=1;(N==null?void 0:N.concurrency)!=null&&(k=g(N.concurrency));let ie=k-1;return(N==null?void 0:N.highWaterMark)!=null&&(ie=g(N.highWaterMark)),s(k,"options.concurrency",1),s(ie,"options.highWaterMark",0),ie+=k,(async function*(){const z=nr().AbortSignalAny([N==null?void 0:N.signal].filter(b)),V=this,ne=[],pe={signal:z};let fe,_e,G=!1,le=0;function de(){G=!0,ae()}function ae(){le-=1,Ae()}function Ae(){_e&&!G&&le<k&&ne.length<ie&&(_e(),_e=null)}async function at(){try{for await(let Ne of V){if(G)return;if(z.aborted)throw new i;try{if(Ne=U(Ne,pe),Ne===M)continue;Ne=P(Ne)}catch(Et){Ne=R(Et)}le+=1,C(Ne,ae,de),ne.push(Ne),fe&&(fe(),fe=null),!G&&(ne.length>=ie||le>=k)&&await new S(Et=>{_e=Et})}ne.push(K)}catch(Ne){const Et=R(Ne);C(Et,ae,de),ne.push(Et)}finally{G=!0,fe&&(fe(),fe=null)}}at();try{for(;;){for(;ne.length>0;){const Ne=await ne[0];if(Ne===K)return;if(z.aborted)throw new i;Ne!==M&&(yield Ne),ne.shift(),Ae()}await new S(Ne=>{fe=Ne})}}finally{G=!0,_e&&(_e(),_e=null)}}).call(this)}function H(U=void 0){return U!=null&&u(U,"options"),(U==null?void 0:U.signal)!=null&&o(U.signal,"options.signal"),(async function*(){let k=0;for await(const ue of this){var ie;if(U!=null&&(ie=U.signal)!==null&&ie!==void 0&&ie.aborted)throw new i({cause:U.signal.reason});yield[k++,ue]}}).call(this)}async function Q(U,N=void 0){for await(const k of A.call(this,U,N))return!0;return!1}async function se(U,N=void 0){if(typeof U!="function")throw new t("fn",["Function","AsyncFunction"],U);return!await Q.call(this,async(...k)=>!await U(...k),N)}async function F(U,N){for await(const k of A.call(this,U,N))return k}async function ee(U,N){if(typeof U!="function")throw new t("fn",["Function","AsyncFunction"],U);async function k(ie,ue){return await U(ie,ue),M}for await(const ie of B.call(this,k,N));}function A(U,N){if(typeof U!="function")throw new t("fn",["Function","AsyncFunction"],U);async function k(ie,ue){return await U(ie,ue)?ie:M}return B.call(this,k,N)}class J extends r{constructor(){super("reduce"),this.message="Reduce of an empty stream requires an initial value"}}async function te(U,N,k){var ie;if(typeof U!="function")throw new t("reducer",["Function","AsyncFunction"],U);k!=null&&u(k,"options"),(k==null?void 0:k.signal)!=null&&o(k.signal,"options.signal");let ue=arguments.length>1;if(k!=null&&(ie=k.signal)!==null&&ie!==void 0&&ie.aborted){const fe=new i(void 0,{cause:k.signal.reason});throw this.once("error",()=>{}),await f(this.destroy(fe)),fe}const z=new a,V=z.signal;if(k!=null&&k.signal){const fe={once:!0,[l]:this,[c]:!0};k.signal.addEventListener("abort",()=>z.abort(),fe)}let ne=!1;try{for await(const fe of this){var pe;if(ne=!0,k!=null&&(pe=k.signal)!==null&&pe!==void 0&&pe.aborted)throw new i;ue?N=await U(N,fe,{signal:V}):(N=fe,ue=!0)}if(!ne&&!ue)throw new J}finally{z.abort()}return N}async function Z(U){U!=null&&u(U,"options"),(U==null?void 0:U.signal)!=null&&o(U.signal,"options.signal");const N=[];for await(const ie of this){var k;if(U!=null&&(k=U.signal)!==null&&k!==void 0&&k.aborted)throw new i(void 0,{cause:U.signal.reason});m(N,ie)}return N}function he(U,N){const k=B.call(this,U,N);return(async function*(){for await(const ue of k)yield*ue}).call(this)}function ye(U){if(U=v(U),w(U))return 0;if(U<0)throw new n("number",">= 0",U);return U}function ve(U,N=void 0){return N!=null&&u(N,"options"),(N==null?void 0:N.signal)!=null&&o(N.signal,"options.signal"),U=ye(U),(async function*(){var ie;if(N!=null&&(ie=N.signal)!==null&&ie!==void 0&&ie.aborted)throw new i;for await(const z of this){var ue;if(N!=null&&(ue=N.signal)!==null&&ue!==void 0&&ue.aborted)throw new i;U--<=0&&(yield z)}}).call(this)}function W(U,N=void 0){return N!=null&&u(N,"options"),(N==null?void 0:N.signal)!=null&&o(N.signal,"options.signal"),U=ye(U),(async function*(){var ie;if(N!=null&&(ie=N.signal)!==null&&ie!==void 0&&ie.aborted)throw new i;for await(const z of this){var ue;if(N!=null&&(ue=N.signal)!==null&&ue!==void 0&&ue.aborted)throw new i;if(U-- >0&&(yield z),U<=0)return}}).call(this)}return Z_.streamReturningOperators={asIndexedPairs:_(H,"readable.asIndexedPairs will be removed in a future version."),drop:ve,filter:A,flatMap:he,map:B,take:W,compose:q},Z_.promiseReturningOperators={every:se,forEach:ee,reduce:te,toArray:Z,some:Q,find:F},Z_}var HO,v$;function cG(){if(v$)return HO;v$=1;const{ArrayPrototypePop:a,Promise:e}=ut(),{isIterable:t,isNodeStream:r,isWebStream:n}=Pu(),{pipelineImpl:i}=DC(),{finished:o}=nl();fG();function s(...u){return new e((l,c)=>{let f,p;const h=u[u.length-1];if(h&&typeof h=="object"&&!r(h)&&!t(h)&&!n(h)){const y=a(u);f=y.signal,p=y.end}i(u,(y,d)=>{y?c(y):l(d)},{signal:f,end:p})})}return HO={finished:o,pipeline:s},HO}var w$;function fG(){if(w$)return OO.exports;w$=1;const{Buffer:a}=rl(),{ObjectDefineProperty:e,ObjectKeys:t,ReflectApply:r}=ut(),{promisify:{custom:n}}=nr(),{streamReturningOperators:i,promiseReturningOperators:o}=zoe(),{codes:{ERR_ILLEGAL_CONSTRUCTOR:s}}=Qt(),u=lG(),{setDefaultHighWaterMark:l,getDefaultHighWaterMark:c}=xb(),{pipeline:f}=DC(),{destroyer:p}=Lf(),h=nl(),y=cG(),d=Pu(),_=OO.exports=AC().Stream;_.isDestroyed=d.isDestroyed,_.isDisturbed=d.isDisturbed,_.isErrored=d.isErrored,_.isReadable=d.isReadable,_.isWritable=d.isWritable,_.Readable=$b();for(const b of t(i)){let v=function(...w){if(new.target)throw s();return _.Readable.from(r(g,this,w))};const g=i[b];e(v,"name",{__proto__:null,value:g.name}),e(v,"length",{__proto__:null,value:g.length}),e(_.Readable.prototype,b,{__proto__:null,value:v,enumerable:!1,configurable:!0,writable:!0})}for(const b of t(o)){let v=function(...w){if(new.target)throw s();return r(g,this,w)};const g=o[b];e(v,"name",{__proto__:null,value:g.name}),e(v,"length",{__proto__:null,value:g.length}),e(_.Readable.prototype,b,{__proto__:null,value:v,enumerable:!1,configurable:!0,writable:!0})}_.Writable=IC(),_.Duplex=Cu(),_.Transform=sG(),_.PassThrough=uG(),_.pipeline=f;const{addAbortSignal:m}=Db();return _.addAbortSignal=m,_.finished=h,_.destroy=p,_.compose=u,_.setDefaultHighWaterMark=l,_.getDefaultHighWaterMark=c,e(_,"promises",{__proto__:null,configurable:!0,enumerable:!0,get(){return y}}),e(f,n,{__proto__:null,enumerable:!0,get(){return y.pipeline}}),e(h,n,{__proto__:null,enumerable:!0,get(){return y.finished}}),_.Stream=_,_._isUint8Array=function(g){return g instanceof Uint8Array},_._uint8ArrayToBuffer=function(g){return a.from(g.buffer,g.byteOffset,g.byteLength)},OO.exports}var O$;function by(){return O$||(O$=1,function(a){const e=fG(),t=cG(),r=e.Readable.destroy;a.exports=e.Readable,a.exports._uint8ArrayToBuffer=e._uint8ArrayToBuffer,a.exports._isUint8Array=e._isUint8Array,a.exports.isDisturbed=e.isDisturbed,a.exports.isErrored=e.isErrored,a.exports.isReadable=e.isReadable,a.exports.Readable=e.Readable,a.exports.Writable=e.Writable,a.exports.Duplex=e.Duplex,a.exports.Transform=e.Transform,a.exports.PassThrough=e.PassThrough,a.exports.addAbortSignal=e.addAbortSignal,a.exports.finished=e.finished,a.exports.destroy=e.destroy,a.exports.destroy=r,a.exports.pipeline=e.pipeline,a.exports.compose=e.compose,Object.defineProperty(e,"promises",{configurable:!0,enumerable:!0,get(){return t}}),a.exports.Stream=e.Stream,a.exports.default=a.exports}(wO)),wO.exports}var rn={},WO={},pu={},$l={},KO,S$;function Vf(){return S$||(S$=1,KO=TypeError),KO}const Boe=Mc(aae);var JO,E$;function Nb(){if(E$)return JO;E$=1;var a=typeof Map=="function"&&Map.prototype,e=Object.getOwnPropertyDescriptor&&a?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,t=a&&e&&typeof e.get=="function"?e.get:null,r=a&&Map.prototype.forEach,n=typeof Set=="function"&&Set.prototype,i=Object.getOwnPropertyDescriptor&&n?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,o=n&&i&&typeof i.get=="function"?i.get:null,s=n&&Set.prototype.forEach,u=typeof WeakMap=="function"&&WeakMap.prototype,l=u?WeakMap.prototype.has:null,c=typeof WeakSet=="function"&&WeakSet.prototype,f=c?WeakSet.prototype.has:null,p=typeof WeakRef=="function"&&WeakRef.prototype,h=p?WeakRef.prototype.deref:null,y=Boolean.prototype.valueOf,d=Object.prototype.toString,_=Function.prototype.toString,m=String.prototype.match,b=String.prototype.slice,g=String.prototype.replace,v=String.prototype.toUpperCase,w=String.prototype.toLowerCase,S=RegExp.prototype.test,R=Array.prototype.concat,P=Array.prototype.join,C=Array.prototype.slice,T=Math.floor,M=typeof BigInt=="function"?BigInt.prototype.valueOf:null,K=Object.getOwnPropertySymbols,q=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,B=typeof Symbol=="function"&&typeof Symbol.iterator=="object",H=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===B||!0)?Symbol.toStringTag:null,Q=Object.prototype.propertyIsEnumerable,se=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(X){return X.__proto__}:null);function F(X,Y){if(X===1/0||X===-1/0||X!==X||X&&X>-1e3&&X<1e3||S.call(/e/,Y))return Y;var Ee=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof X=="number"){var Xe=X<0?-T(-X):T(X);if(Xe!==X){var tt=String(Xe),Ie=b.call(Y,tt.length+1);return g.call(tt,Ee,"$&_")+"."+g.call(g.call(Ie,/([0-9]{3})/g,"$&_"),/_$/,"")}}return g.call(Y,Ee,"$&_")}var ee=Boe,A=ee.custom,J=V(A)?A:null,te={__proto__:null,double:'"',single:"'"},Z={__proto__:null,double:/(["\\])/g,single:/(['\\])/g};JO=function X(Y,Ee,Xe,tt){var Ie=Ee||{};if(fe(Ie,"quoteStyle")&&!fe(te,Ie.quoteStyle))throw new TypeError('option "quoteStyle" must be "single" or "double"');if(fe(Ie,"maxStringLength")&&(typeof Ie.maxStringLength=="number"?Ie.maxStringLength<0&&Ie.maxStringLength!==1/0:Ie.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var Rr=fe(Ie,"customInspect")?Ie.customInspect:!0;if(typeof Rr!="boolean"&&Rr!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(fe(Ie,"indent")&&Ie.indent!==null&&Ie.indent!=="	"&&!(parseInt(Ie.indent,10)===Ie.indent&&Ie.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(fe(Ie,"numericSeparator")&&typeof Ie.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var uu=Ie.numericSeparator;if(typeof Y>"u")return"undefined";if(Y===null)return"null";if(typeof Y=="boolean")return Y?"true":"false";if(typeof Y=="string")return j(Y,Ie);if(typeof Y=="number"){if(Y===0)return 1/0/Y>0?"0":"-0";var zt=String(Y);return uu?F(Y,zt):zt}if(typeof Y=="bigint"){var Cr=String(Y)+"n";return uu?F(Y,Cr):Cr}var xc=typeof Ie.depth>"u"?5:Ie.depth;if(typeof Xe>"u"&&(Xe=0),Xe>=xc&&xc>0&&typeof Y=="object")return W(Y)?"[Array]":"[Object]";var I=ce(Ie,Xe);if(typeof tt>"u")tt=[];else if(le(tt,Y)>=0)return"[Circular]";function x(Mt,c_,a9){if(c_&&(tt=C.call(tt),tt.push(c_)),a9){var sP={depth:Ie.depth};return fe(Ie,"quoteStyle")&&(sP.quoteStyle=Ie.quoteStyle),X(Mt,sP,Xe+1,tt)}return X(Mt,Ie,Xe+1,tt)}if(typeof Y=="function"&&!N(Y)){var me=G(Y),ge=Je(Y,x);return"[Function"+(me?": "+me:" (anonymous)")+"]"+(ge.length>0?" { "+P.call(ge,", ")+" }":"")}if(V(Y)){var Se=B?g.call(String(Y),/^(Symbol\(.*\))_[^)]*$/,"$1"):q.call(Y);return typeof Y=="object"&&!B?E(Se):Se}if(Et(Y)){for(var lt="<"+w.call(String(Y.nodeName)),Tt=Y.attributes||[],ul=0;ul<Tt.length;ul++)lt+=" "+Tt[ul].name+"="+he(ye(Tt[ul].value),"double",Ie);return lt+=">",Y.childNodes&&Y.childNodes.length&&(lt+="..."),lt+="</"+w.call(String(Y.nodeName))+">",lt}if(W(Y)){if(Y.length===0)return"[]";var $r=Je(Y,x);return I&&!re($r)?"["+Me($r,I)+"]":"[ "+P.call($r,", ")+" ]"}if(k(Y)){var $c=Je(Y,x);return!("cause"in Error.prototype)&&"cause"in Y&&!Q.call(Y,"cause")?"{ ["+String(Y)+"] "+P.call(R.call("[cause]: "+x(Y.cause),$c),", ")+" }":$c.length===0?"["+String(Y)+"]":"{ ["+String(Y)+"] "+P.call($c,", ")+" }"}if(typeof Y=="object"&&Rr){if(J&&typeof Y[J]=="function"&&ee)return ee(Y,{depth:xc-Xe});if(Rr!=="symbol"&&typeof Y.inspect=="function")return Y.inspect()}if(de(Y)){var l_=[];return r&&r.call(Y,function(Mt,c_){l_.push(x(c_,Y,!0)+" => "+x(Mt,Y))}),L("Map",t.call(Y),l_,I)}if(at(Y)){var kf=[];return s&&s.call(Y,function(Mt){kf.push(x(Mt,Y))}),L("Set",o.call(Y),kf,I)}if(ae(Y))return D("WeakMap");if(Ne(Y))return D("WeakSet");if(Ae(Y))return D("WeakRef");if(ue(Y))return E(x(Number(Y)));if(ne(Y))return E(x(M.call(Y)));if(z(Y))return E(y.call(Y));if(ie(Y))return E(x(String(Y)));if(typeof window<"u"&&Y===window)return"{ [object Window] }";if(typeof globalThis<"u"&&Y===globalThis||typeof vf<"u"&&Y===vf)return"{ [object globalThis] }";if(!U(Y)&&!N(Y)){var Nc=Je(Y,x),qc=se?se(Y)===Object.prototype:Y instanceof Object||Y.constructor===Object,ll=Y instanceof Object?"":"null prototype",zc=!qc&&H&&Object(Y)===Y&&H in Y?b.call(_e(Y),8,-1):ll?"Object":"",cl=qc||typeof Y.constructor!="function"?"":Y.constructor.name?Y.constructor.name+" ":"",Nr=cl+(zc||ll?"["+P.call(R.call([],zc||[],ll||[]),": ")+"] ":"");return Nc.length===0?Nr+"{}":I?Nr+"{"+Me(Nc,I)+"}":Nr+"{ "+P.call(Nc,", ")+" }"}return String(Y)};function he(X,Y,Ee){var Xe=Ee.quoteStyle||Y,tt=te[Xe];return tt+X+tt}function ye(X){return g.call(String(X),/"/g,"&quot;")}function ve(X){return!H||!(typeof X=="object"&&(H in X||typeof X[H]<"u"))}function W(X){return _e(X)==="[object Array]"&&ve(X)}function U(X){return _e(X)==="[object Date]"&&ve(X)}function N(X){return _e(X)==="[object RegExp]"&&ve(X)}function k(X){return _e(X)==="[object Error]"&&ve(X)}function ie(X){return _e(X)==="[object String]"&&ve(X)}function ue(X){return _e(X)==="[object Number]"&&ve(X)}function z(X){return _e(X)==="[object Boolean]"&&ve(X)}function V(X){if(B)return X&&typeof X=="object"&&X instanceof Symbol;if(typeof X=="symbol")return!0;if(!X||typeof X!="object"||!q)return!1;try{return q.call(X),!0}catch{}return!1}function ne(X){if(!X||typeof X!="object"||!M)return!1;try{return M.call(X),!0}catch{}return!1}var pe=Object.prototype.hasOwnProperty||function(X){return X in this};function fe(X,Y){return pe.call(X,Y)}function _e(X){return d.call(X)}function G(X){if(X.name)return X.name;var Y=m.call(_.call(X),/^function\s*([\w$]+)/);return Y?Y[1]:null}function le(X,Y){if(X.indexOf)return X.indexOf(Y);for(var Ee=0,Xe=X.length;Ee<Xe;Ee++)if(X[Ee]===Y)return Ee;return-1}function de(X){if(!t||!X||typeof X!="object")return!1;try{t.call(X);try{o.call(X)}catch{return!0}return X instanceof Map}catch{}return!1}function ae(X){if(!l||!X||typeof X!="object")return!1;try{l.call(X,l);try{f.call(X,f)}catch{return!0}return X instanceof WeakMap}catch{}return!1}function Ae(X){if(!h||!X||typeof X!="object")return!1;try{return h.call(X),!0}catch{}return!1}function at(X){if(!o||!X||typeof X!="object")return!1;try{o.call(X);try{t.call(X)}catch{return!0}return X instanceof Set}catch{}return!1}function Ne(X){if(!f||!X||typeof X!="object")return!1;try{f.call(X,f);try{l.call(X,l)}catch{return!0}return X instanceof WeakSet}catch{}return!1}function Et(X){return!X||typeof X!="object"?!1:typeof HTMLElement<"u"&&X instanceof HTMLElement?!0:typeof X.nodeName=="string"&&typeof X.getAttribute=="function"}function j(X,Y){if(X.length>Y.maxStringLength){var Ee=X.length-Y.maxStringLength,Xe="... "+Ee+" more character"+(Ee>1?"s":"");return j(b.call(X,0,Y.maxStringLength),Y)+Xe}var tt=Z[Y.quoteStyle||"single"];tt.lastIndex=0;var Ie=g.call(g.call(X,tt,"\\$1"),/[\x00-\x1f]/g,O);return he(Ie,"single",Y)}function O(X){var Y=X.charCodeAt(0),Ee={8:"b",9:"t",10:"n",12:"f",13:"r"}[Y];return Ee?"\\"+Ee:"\\x"+(Y<16?"0":"")+v.call(Y.toString(16))}function E(X){return"Object("+X+")"}function D(X){return X+" { ? }"}function L(X,Y,Ee,Xe){var tt=Xe?Me(Ee,Xe):P.call(Ee,", ");return X+" ("+Y+") {"+tt+"}"}function re(X){for(var Y=0;Y<X.length;Y++)if(le(X[Y],`
`)>=0)return!1;return!0}function ce(X,Y){var Ee;if(X.indent==="	")Ee="	";else if(typeof X.indent=="number"&&X.indent>0)Ee=P.call(Array(X.indent+1)," ");else return null;return{base:Ee,prev:P.call(Array(Y+1),Ee)}}function Me(X,Y){if(X.length===0)return"";var Ee=`
`+Y.prev+Y.base;return Ee+P.call(X,","+Ee)+`
`+Y.prev}function Je(X,Y){var Ee=W(X),Xe=[];if(Ee){Xe.length=X.length;for(var tt=0;tt<X.length;tt++)Xe[tt]=fe(X,tt)?Y(X[tt],X):""}var Ie=typeof K=="function"?K(X):[],Rr;if(B){Rr={};for(var uu=0;uu<Ie.length;uu++)Rr["$"+Ie[uu]]=Ie[uu]}for(var zt in X)fe(X,zt)&&(Ee&&String(Number(zt))===zt&&zt<X.length||B&&Rr["$"+zt]instanceof Symbol||(S.call(/[^\w$]/,zt)?Xe.push(Y(zt,X)+": "+Y(X[zt],X)):Xe.push(zt+": "+Y(X[zt],X))));if(typeof K=="function")for(var Cr=0;Cr<Ie.length;Cr++)Q.call(X,Ie[Cr])&&Xe.push("["+Y(Ie[Cr])+"]: "+Y(X[Ie[Cr]],X));return Xe}return JO}var XO,R$;function Uoe(){if(R$)return XO;R$=1;var a=Nb(),e=Vf(),t=function(s,u,l){for(var c=s,f;(f=c.next)!=null;c=f)if(f.key===u)return c.next=f.next,l||(f.next=s.next,s.next=f),f},r=function(s,u){if(s){var l=t(s,u);return l&&l.value}},n=function(s,u,l){var c=t(s,u);c?c.value=l:s.next={key:u,next:s.next,value:l}},i=function(s,u){return s?!!t(s,u):!1},o=function(s,u){if(s)return t(s,u,!0)};return XO=function(){var u,l={assert:function(c){if(!l.has(c))throw new e("Side channel does not contain "+a(c))},delete:function(c){var f=u&&u.next,p=o(u,c);return p&&f&&f===p&&(u=void 0),!!p},get:function(c){return r(u,c)},has:function(c){return i(u,c)},set:function(c,f){u||(u={next:void 0}),n(u,c,f)}};return l},XO}var ZO,C$;function dG(){return C$||(C$=1,ZO=Object),ZO}var QO,P$;function Foe(){return P$||(P$=1,QO=Error),QO}var YO,j$;function Loe(){return j$||(j$=1,YO=EvalError),YO}var eS,T$;function Voe(){return T$||(T$=1,eS=RangeError),eS}var tS,M$;function Goe(){return M$||(M$=1,tS=ReferenceError),tS}var rS,A$;function koe(){return A$||(A$=1,rS=SyntaxError),rS}var nS,I$;function Hoe(){return I$||(I$=1,nS=URIError),nS}var iS,D$;function Woe(){return D$||(D$=1,iS=Math.abs),iS}var aS,x$;function Koe(){return x$||(x$=1,aS=Math.floor),aS}var oS,$$;function Joe(){return $$||($$=1,oS=Math.max),oS}var sS,N$;function Xoe(){return N$||(N$=1,sS=Math.min),sS}var uS,q$;function Zoe(){return q$||(q$=1,uS=Math.pow),uS}var lS,z$;function Qoe(){return z$||(z$=1,lS=Math.round),lS}var cS,B$;function Yoe(){return B$||(B$=1,cS=Number.isNaN||function(e){return e!==e}),cS}var fS,U$;function ese(){if(U$)return fS;U$=1;var a=Yoe();return fS=function(t){return a(t)||t===0?t:t<0?-1:1},fS}var dS,F$;function tse(){return F$||(F$=1,dS=Object.getOwnPropertyDescriptor),dS}var hS,L$;function hG(){if(L$)return hS;L$=1;var a=tse();if(a)try{a([],"length")}catch{a=null}return hS=a,hS}var pS,V$;function rse(){if(V$)return pS;V$=1;var a=Object.defineProperty||!1;if(a)try{a({},"a",{value:1})}catch{a=!1}return pS=a,pS}var _S,G$;function nse(){return G$||(G$=1,_S=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},t=Symbol("test"),r=Object(t);if(typeof t=="string"||Object.prototype.toString.call(t)!=="[object Symbol]"||Object.prototype.toString.call(r)!=="[object Symbol]")return!1;var n=42;e[t]=n;for(var i in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var o=Object.getOwnPropertySymbols(e);if(o.length!==1||o[0]!==t||!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var s=Object.getOwnPropertyDescriptor(e,t);if(s.value!==n||s.enumerable!==!0)return!1}return!0}),_S}var yS,k$;function ise(){if(k$)return yS;k$=1;var a=typeof Symbol<"u"&&Symbol,e=nse();return yS=function(){return typeof a!="function"||typeof Symbol!="function"||typeof a("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:e()},yS}var bS,H$;function pG(){return H$||(H$=1,bS=typeof Reflect<"u"&&Reflect.getPrototypeOf||null),bS}var mS,W$;function _G(){if(W$)return mS;W$=1;var a=dG();return mS=a.getPrototypeOf||null,mS}var gS,K$;function ase(){if(K$)return gS;K$=1;var a="Function.prototype.bind called on incompatible ",e=Object.prototype.toString,t=Math.max,r="[object Function]",n=function(u,l){for(var c=[],f=0;f<u.length;f+=1)c[f]=u[f];for(var p=0;p<l.length;p+=1)c[p+u.length]=l[p];return c},i=function(u,l){for(var c=[],f=l,p=0;f<u.length;f+=1,p+=1)c[p]=u[f];return c},o=function(s,u){for(var l="",c=0;c<s.length;c+=1)l+=s[c],c+1<s.length&&(l+=u);return l};return gS=function(u){var l=this;if(typeof l!="function"||e.apply(l)!==r)throw new TypeError(a+l);for(var c=i(arguments,1),f,p=function(){if(this instanceof f){var m=l.apply(this,n(c,arguments));return Object(m)===m?m:this}return l.apply(u,n(c,arguments))},h=t(0,l.length-c.length),y=[],d=0;d<h;d++)y[d]="$"+d;if(f=Function("binder","return function ("+o(y,",")+"){ return binder.apply(this,arguments); }")(p),l.prototype){var _=function(){};_.prototype=l.prototype,f.prototype=new _,_.prototype=null}return f},gS}var vS,J$;function qb(){if(J$)return vS;J$=1;var a=ase();return vS=Function.prototype.bind||a,vS}var wS,X$;function xC(){return X$||(X$=1,wS=Function.prototype.call),wS}var OS,Z$;function yG(){return Z$||(Z$=1,OS=Function.prototype.apply),OS}var SS,Q$;function ose(){return Q$||(Q$=1,SS=typeof Reflect<"u"&&Reflect&&Reflect.apply),SS}var ES,Y$;function sse(){if(Y$)return ES;Y$=1;var a=qb(),e=yG(),t=xC(),r=ose();return ES=r||a.call(t,e),ES}var RS,eN;function bG(){if(eN)return RS;eN=1;var a=qb(),e=Vf(),t=xC(),r=sse();return RS=function(i){if(i.length<1||typeof i[0]!="function")throw new e("a function is required");return r(a,t,i)},RS}var CS,tN;function use(){if(tN)return CS;tN=1;var a=bG(),e=hG(),t;try{t=[].__proto__===Array.prototype}catch(o){if(!o||typeof o!="object"||!("code"in o)||o.code!=="ERR_PROTO_ACCESS")throw o}var r=!!t&&e&&e(Object.prototype,"__proto__"),n=Object,i=n.getPrototypeOf;return CS=r&&typeof r.get=="function"?a([r.get]):typeof i=="function"?function(s){return i(s==null?s:n(s))}:!1,CS}var PS,rN;function lse(){if(rN)return PS;rN=1;var a=pG(),e=_G(),t=use();return PS=a?function(n){return a(n)}:e?function(n){if(!n||typeof n!="object"&&typeof n!="function")throw new TypeError("getProto: not an object");return e(n)}:t?function(n){return t(n)}:null,PS}var jS,nN;function cse(){if(nN)return jS;nN=1;var a=Function.prototype.call,e=Object.prototype.hasOwnProperty,t=qb();return jS=t.call(a,e),jS}var TS,iN;function $C(){if(iN)return TS;iN=1;var a,e=dG(),t=Foe(),r=Loe(),n=Voe(),i=Goe(),o=koe(),s=Vf(),u=Hoe(),l=Woe(),c=Koe(),f=Joe(),p=Xoe(),h=Zoe(),y=Qoe(),d=ese(),_=Function,m=function(N){try{return _('"use strict"; return ('+N+").constructor;")()}catch{}},b=hG(),g=rse(),v=function(){throw new s},w=b?function(){try{return arguments.callee,v}catch{try{return b(arguments,"callee").get}catch{return v}}}():v,S=ise()(),R=lse(),P=_G(),C=pG(),T=yG(),M=xC(),K={},q=typeof Uint8Array>"u"||!R?a:R(Uint8Array),B={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?a:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?a:ArrayBuffer,"%ArrayIteratorPrototype%":S&&R?R([][Symbol.iterator]()):a,"%AsyncFromSyncIteratorPrototype%":a,"%AsyncFunction%":K,"%AsyncGenerator%":K,"%AsyncGeneratorFunction%":K,"%AsyncIteratorPrototype%":K,"%Atomics%":typeof Atomics>"u"?a:Atomics,"%BigInt%":typeof BigInt>"u"?a:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?a:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?a:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?a:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":t,"%eval%":eval,"%EvalError%":r,"%Float16Array%":typeof Float16Array>"u"?a:Float16Array,"%Float32Array%":typeof Float32Array>"u"?a:Float32Array,"%Float64Array%":typeof Float64Array>"u"?a:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?a:FinalizationRegistry,"%Function%":_,"%GeneratorFunction%":K,"%Int8Array%":typeof Int8Array>"u"?a:Int8Array,"%Int16Array%":typeof Int16Array>"u"?a:Int16Array,"%Int32Array%":typeof Int32Array>"u"?a:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":S&&R?R(R([][Symbol.iterator]())):a,"%JSON%":typeof JSON=="object"?JSON:a,"%Map%":typeof Map>"u"?a:Map,"%MapIteratorPrototype%":typeof Map>"u"||!S||!R?a:R(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":e,"%Object.getOwnPropertyDescriptor%":b,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?a:Promise,"%Proxy%":typeof Proxy>"u"?a:Proxy,"%RangeError%":n,"%ReferenceError%":i,"%Reflect%":typeof Reflect>"u"?a:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?a:Set,"%SetIteratorPrototype%":typeof Set>"u"||!S||!R?a:R(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?a:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":S&&R?R(""[Symbol.iterator]()):a,"%Symbol%":S?Symbol:a,"%SyntaxError%":o,"%ThrowTypeError%":w,"%TypedArray%":q,"%TypeError%":s,"%Uint8Array%":typeof Uint8Array>"u"?a:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?a:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?a:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?a:Uint32Array,"%URIError%":u,"%WeakMap%":typeof WeakMap>"u"?a:WeakMap,"%WeakRef%":typeof WeakRef>"u"?a:WeakRef,"%WeakSet%":typeof WeakSet>"u"?a:WeakSet,"%Function.prototype.call%":M,"%Function.prototype.apply%":T,"%Object.defineProperty%":g,"%Object.getPrototypeOf%":P,"%Math.abs%":l,"%Math.floor%":c,"%Math.max%":f,"%Math.min%":p,"%Math.pow%":h,"%Math.round%":y,"%Math.sign%":d,"%Reflect.getPrototypeOf%":C};if(R)try{null.error}catch(N){var H=R(R(N));B["%Error.prototype%"]=H}var Q=function N(k){var ie;if(k==="%AsyncFunction%")ie=m("async function () {}");else if(k==="%GeneratorFunction%")ie=m("function* () {}");else if(k==="%AsyncGeneratorFunction%")ie=m("async function* () {}");else if(k==="%AsyncGenerator%"){var ue=N("%AsyncGeneratorFunction%");ue&&(ie=ue.prototype)}else if(k==="%AsyncIteratorPrototype%"){var z=N("%AsyncGenerator%");z&&R&&(ie=R(z.prototype))}return B[k]=ie,ie},se={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},F=qb(),ee=cse(),A=F.call(M,Array.prototype.concat),J=F.call(T,Array.prototype.splice),te=F.call(M,String.prototype.replace),Z=F.call(M,String.prototype.slice),he=F.call(M,RegExp.prototype.exec),ye=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,ve=/\\(\\)?/g,W=function(k){var ie=Z(k,0,1),ue=Z(k,-1);if(ie==="%"&&ue!=="%")throw new o("invalid intrinsic syntax, expected closing `%`");if(ue==="%"&&ie!=="%")throw new o("invalid intrinsic syntax, expected opening `%`");var z=[];return te(k,ye,function(V,ne,pe,fe){z[z.length]=pe?te(fe,ve,"$1"):ne||V}),z},U=function(k,ie){var ue=k,z;if(ee(se,ue)&&(z=se[ue],ue="%"+z[0]+"%"),ee(B,ue)){var V=B[ue];if(V===K&&(V=Q(ue)),typeof V>"u"&&!ie)throw new s("intrinsic "+k+" exists, but is not available. Please file an issue!");return{alias:z,name:ue,value:V}}throw new o("intrinsic "+k+" does not exist!")};return TS=function(k,ie){if(typeof k!="string"||k.length===0)throw new s("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof ie!="boolean")throw new s('"allowMissing" argument must be a boolean');if(he(/^%?[^%]*%?$/,k)===null)throw new o("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var ue=W(k),z=ue.length>0?ue[0]:"",V=U("%"+z+"%",ie),ne=V.name,pe=V.value,fe=!1,_e=V.alias;_e&&(z=_e[0],J(ue,A([0,1],_e)));for(var G=1,le=!0;G<ue.length;G+=1){var de=ue[G],ae=Z(de,0,1),Ae=Z(de,-1);if((ae==='"'||ae==="'"||ae==="`"||Ae==='"'||Ae==="'"||Ae==="`")&&ae!==Ae)throw new o("property names with quotes must have matching quotes");if((de==="constructor"||!le)&&(fe=!0),z+="."+de,ne="%"+z+"%",ee(B,ne))pe=B[ne];else if(pe!=null){if(!(de in pe)){if(!ie)throw new s("base intrinsic for "+k+" exists, but the property is not available.");return}if(b&&G+1>=ue.length){var at=b(pe,de);le=!!at,le&&"get"in at&&!("originalValue"in at.get)?pe=at.get:pe=pe[de]}else le=ee(pe,de),pe=pe[de];le&&!fe&&(B[ne]=pe)}}return pe},TS}var MS,aN;function mG(){if(aN)return MS;aN=1;var a=$C(),e=bG(),t=e([a("%String.prototype.indexOf%")]);return MS=function(n,i){var o=a(n,!!i);return typeof o=="function"&&t(n,".prototype.")>-1?e([o]):o},MS}var AS,oN;function gG(){if(oN)return AS;oN=1;var a=$C(),e=mG(),t=Nb(),r=Vf(),n=a("%Map%",!0),i=e("Map.prototype.get",!0),o=e("Map.prototype.set",!0),s=e("Map.prototype.has",!0),u=e("Map.prototype.delete",!0),l=e("Map.prototype.size",!0);return AS=!!n&&function(){var f,p={assert:function(h){if(!p.has(h))throw new r("Side channel does not contain "+t(h))},delete:function(h){if(f){var y=u(f,h);return l(f)===0&&(f=void 0),y}return!1},get:function(h){if(f)return i(f,h)},has:function(h){return f?s(f,h):!1},set:function(h,y){f||(f=new n),o(f,h,y)}};return p},AS}var IS,sN;function fse(){if(sN)return IS;sN=1;var a=$C(),e=mG(),t=Nb(),r=gG(),n=Vf(),i=a("%WeakMap%",!0),o=e("WeakMap.prototype.get",!0),s=e("WeakMap.prototype.set",!0),u=e("WeakMap.prototype.has",!0),l=e("WeakMap.prototype.delete",!0);return IS=i?function(){var f,p,h={assert:function(y){if(!h.has(y))throw new n("Side channel does not contain "+t(y))},delete:function(y){if(i&&y&&(typeof y=="object"||typeof y=="function")){if(f)return l(f,y)}else if(r&&p)return p.delete(y);return!1},get:function(y){return i&&y&&(typeof y=="object"||typeof y=="function")&&f?o(f,y):p&&p.get(y)},has:function(y){return i&&y&&(typeof y=="object"||typeof y=="function")&&f?u(f,y):!!p&&p.has(y)},set:function(y,d){i&&y&&(typeof y=="object"||typeof y=="function")?(f||(f=new i),s(f,y,d)):r&&(p||(p=r()),p.set(y,d))}};return h}:r,IS}var DS,uN;function dse(){if(uN)return DS;uN=1;var a=Vf(),e=Nb(),t=Uoe(),r=gG(),n=fse(),i=n||r||t;return DS=function(){var s,u={assert:function(l){if(!u.has(l))throw new a("Side channel does not contain "+e(l))},delete:function(l){return!!s&&s.delete(l)},get:function(l){return s&&s.get(l)},has:function(l){return!!s&&s.has(l)},set:function(l,c){s||(s=i()),s.set(l,c)}};return u},DS}var xS,lN;function NC(){if(lN)return xS;lN=1;var a=String.prototype.replace,e=/%20/g,t={RFC1738:"RFC1738",RFC3986:"RFC3986"};return xS={default:t.RFC3986,formatters:{RFC1738:function(r){return a.call(r,e,"+")},RFC3986:function(r){return String(r)}},RFC1738:t.RFC1738,RFC3986:t.RFC3986},xS}var $S,cN;function vG(){if(cN)return $S;cN=1;var a=NC(),e=Object.prototype.hasOwnProperty,t=Array.isArray,r=function(){for(var d=[],_=0;_<256;++_)d.push("%"+((_<16?"0":"")+_.toString(16)).toUpperCase());return d}(),n=function(_){for(;_.length>1;){var m=_.pop(),b=m.obj[m.prop];if(t(b)){for(var g=[],v=0;v<b.length;++v)typeof b[v]<"u"&&g.push(b[v]);m.obj[m.prop]=g}}},i=function(_,m){for(var b=m&&m.plainObjects?Object.create(null):{},g=0;g<_.length;++g)typeof _[g]<"u"&&(b[g]=_[g]);return b},o=function d(_,m,b){if(!m)return _;if(typeof m!="object"){if(t(_))_.push(m);else if(_&&typeof _=="object")(b&&(b.plainObjects||b.allowPrototypes)||!e.call(Object.prototype,m))&&(_[m]=!0);else return[_,m];return _}if(!_||typeof _!="object")return[_].concat(m);var g=_;return t(_)&&!t(m)&&(g=i(_,b)),t(_)&&t(m)?(m.forEach(function(v,w){if(e.call(_,w)){var S=_[w];S&&typeof S=="object"&&v&&typeof v=="object"?_[w]=d(S,v,b):_.push(v)}else _[w]=v}),_):Object.keys(m).reduce(function(v,w){var S=m[w];return e.call(v,w)?v[w]=d(v[w],S,b):v[w]=S,v},g)},s=function(_,m){return Object.keys(m).reduce(function(b,g){return b[g]=m[g],b},_)},u=function(d,_,m){var b=d.replace(/\+/g," ");if(m==="iso-8859-1")return b.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(b)}catch{return b}},l=function(_,m,b,g,v){if(_.length===0)return _;var w=_;if(typeof _=="symbol"?w=Symbol.prototype.toString.call(_):typeof _!="string"&&(w=String(_)),b==="iso-8859-1")return escape(w).replace(/%u[0-9a-f]{4}/gi,function(C){return"%26%23"+parseInt(C.slice(2),16)+"%3B"});for(var S="",R=0;R<w.length;++R){var P=w.charCodeAt(R);if(P===45||P===46||P===95||P===126||P>=48&&P<=57||P>=65&&P<=90||P>=97&&P<=122||v===a.RFC1738&&(P===40||P===41)){S+=w.charAt(R);continue}if(P<128){S=S+r[P];continue}if(P<2048){S=S+(r[192|P>>6]+r[128|P&63]);continue}if(P<55296||P>=57344){S=S+(r[224|P>>12]+r[128|P>>6&63]+r[128|P&63]);continue}R+=1,P=65536+((P&1023)<<10|w.charCodeAt(R)&1023),S+=r[240|P>>18]+r[128|P>>12&63]+r[128|P>>6&63]+r[128|P&63]}return S},c=function(_){for(var m=[{obj:{o:_},prop:"o"}],b=[],g=0;g<m.length;++g)for(var v=m[g],w=v.obj[v.prop],S=Object.keys(w),R=0;R<S.length;++R){var P=S[R],C=w[P];typeof C=="object"&&C!==null&&b.indexOf(C)===-1&&(m.push({obj:w,prop:P}),b.push(C))}return n(m),_},f=function(_){return Object.prototype.toString.call(_)==="[object RegExp]"},p=function(_){return!_||typeof _!="object"?!1:!!(_.constructor&&_.constructor.isBuffer&&_.constructor.isBuffer(_))},h=function(_,m){return[].concat(_,m)},y=function(_,m){if(t(_)){for(var b=[],g=0;g<_.length;g+=1)b.push(m(_[g]));return b}return m(_)};return $S={arrayToObject:i,assign:s,combine:h,compact:c,decode:u,encode:l,isBuffer:p,isRegExp:f,maybeMap:y,merge:o},$S}var NS,fN;function hse(){if(fN)return NS;fN=1;var a=dse(),e=vG(),t=NC(),r=Object.prototype.hasOwnProperty,n={brackets:function(_){return _+"[]"},comma:"comma",indices:function(_,m){return _+"["+m+"]"},repeat:function(_){return _}},i=Array.isArray,o=Array.prototype.push,s=function(d,_){o.apply(d,i(_)?_:[_])},u=Date.prototype.toISOString,l=t.default,c={addQueryPrefix:!1,allowDots:!1,charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encoder:e.encode,encodeValuesOnly:!1,format:l,formatter:t.formatters[l],indices:!1,serializeDate:function(_){return u.call(_)},skipNulls:!1,strictNullHandling:!1},f=function(_){return typeof _=="string"||typeof _=="number"||typeof _=="boolean"||typeof _=="symbol"||typeof _=="bigint"},p={},h=function d(_,m,b,g,v,w,S,R,P,C,T,M,K,q,B,H){for(var Q=_,se=H,F=0,ee=!1;(se=se.get(p))!==void 0&&!ee;){var A=se.get(_);if(F+=1,typeof A<"u"){if(A===F)throw new RangeError("Cyclic object value");ee=!0}typeof se.get(p)>"u"&&(F=0)}if(typeof R=="function"?Q=R(m,Q):Q instanceof Date?Q=T(Q):b==="comma"&&i(Q)&&(Q=e.maybeMap(Q,function(ie){return ie instanceof Date?T(ie):ie})),Q===null){if(v)return S&&!q?S(m,c.encoder,B,"key",M):m;Q=""}if(f(Q)||e.isBuffer(Q)){if(S){var J=q?m:S(m,c.encoder,B,"key",M);return[K(J)+"="+K(S(Q,c.encoder,B,"value",M))]}return[K(m)+"="+K(String(Q))]}var te=[];if(typeof Q>"u")return te;var Z;if(b==="comma"&&i(Q))q&&S&&(Q=e.maybeMap(Q,S)),Z=[{value:Q.length>0?Q.join(",")||null:void 0}];else if(i(R))Z=R;else{var he=Object.keys(Q);Z=P?he.sort(P):he}for(var ye=g&&i(Q)&&Q.length===1?m+"[]":m,ve=0;ve<Z.length;++ve){var W=Z[ve],U=typeof W=="object"&&typeof W.value<"u"?W.value:Q[W];if(!(w&&U===null)){var N=i(Q)?typeof b=="function"?b(ye,W):ye:ye+(C?"."+W:"["+W+"]");H.set(_,F);var k=a();k.set(p,H),s(te,d(U,N,b,g,v,w,b==="comma"&&q&&i(Q)?null:S,R,P,C,T,M,K,q,B,k))}}return te},y=function(_){if(!_)return c;if(_.encoder!==null&&typeof _.encoder<"u"&&typeof _.encoder!="function")throw new TypeError("Encoder has to be a function.");var m=_.charset||c.charset;if(typeof _.charset<"u"&&_.charset!=="utf-8"&&_.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var b=t.default;if(typeof _.format<"u"){if(!r.call(t.formatters,_.format))throw new TypeError("Unknown format option provided.");b=_.format}var g=t.formatters[b],v=c.filter;return(typeof _.filter=="function"||i(_.filter))&&(v=_.filter),{addQueryPrefix:typeof _.addQueryPrefix=="boolean"?_.addQueryPrefix:c.addQueryPrefix,allowDots:typeof _.allowDots>"u"?c.allowDots:!!_.allowDots,charset:m,charsetSentinel:typeof _.charsetSentinel=="boolean"?_.charsetSentinel:c.charsetSentinel,delimiter:typeof _.delimiter>"u"?c.delimiter:_.delimiter,encode:typeof _.encode=="boolean"?_.encode:c.encode,encoder:typeof _.encoder=="function"?_.encoder:c.encoder,encodeValuesOnly:typeof _.encodeValuesOnly=="boolean"?_.encodeValuesOnly:c.encodeValuesOnly,filter:v,format:b,formatter:g,serializeDate:typeof _.serializeDate=="function"?_.serializeDate:c.serializeDate,skipNulls:typeof _.skipNulls=="boolean"?_.skipNulls:c.skipNulls,sort:typeof _.sort=="function"?_.sort:null,strictNullHandling:typeof _.strictNullHandling=="boolean"?_.strictNullHandling:c.strictNullHandling}};return NS=function(d,_){var m=d,b=y(_),g,v;typeof b.filter=="function"?(v=b.filter,m=v("",m)):i(b.filter)&&(v=b.filter,g=v);var w=[];if(typeof m!="object"||m===null)return"";var S;_&&_.arrayFormat in n?S=_.arrayFormat:_&&"indices"in _?S=_.indices?"indices":"repeat":S="indices";var R=n[S];if(_&&"commaRoundTrip"in _&&typeof _.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var P=R==="comma"&&_&&_.commaRoundTrip;g||(g=Object.keys(m)),b.sort&&g.sort(b.sort);for(var C=a(),T=0;T<g.length;++T){var M=g[T];b.skipNulls&&m[M]===null||s(w,h(m[M],M,R,P,b.strictNullHandling,b.skipNulls,b.encode?b.encoder:null,b.filter,b.sort,b.allowDots,b.serializeDate,b.format,b.formatter,b.encodeValuesOnly,b.charset,C))}var K=w.join(b.delimiter),q=b.addQueryPrefix===!0?"?":"";return b.charsetSentinel&&(b.charset==="iso-8859-1"?q+="utf8=%26%2310003%3B&":q+="utf8=%E2%9C%93&"),K.length>0?q+K:""},NS}var qS,dN;function pse(){if(dN)return qS;dN=1;var a=vG(),e=Object.prototype.hasOwnProperty,t=Array.isArray,r={allowDots:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decoder:a.decode,delimiter:"&",depth:5,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},n=function(p){return p.replace(/&#(\d+);/g,function(h,y){return String.fromCharCode(parseInt(y,10))})},i=function(p,h){return p&&typeof p=="string"&&h.comma&&p.indexOf(",")>-1?p.split(","):p},o="utf8=%26%2310003%3B",s="utf8=%E2%9C%93",u=function(h,y){var d={__proto__:null},_=y.ignoreQueryPrefix?h.replace(/^\?/,""):h,m=y.parameterLimit===1/0?void 0:y.parameterLimit,b=_.split(y.delimiter,m),g=-1,v,w=y.charset;if(y.charsetSentinel)for(v=0;v<b.length;++v)b[v].indexOf("utf8=")===0&&(b[v]===s?w="utf-8":b[v]===o&&(w="iso-8859-1"),g=v,v=b.length);for(v=0;v<b.length;++v)if(v!==g){var S=b[v],R=S.indexOf("]="),P=R===-1?S.indexOf("="):R+1,C,T;P===-1?(C=y.decoder(S,r.decoder,w,"key"),T=y.strictNullHandling?null:""):(C=y.decoder(S.slice(0,P),r.decoder,w,"key"),T=a.maybeMap(i(S.slice(P+1),y),function(M){return y.decoder(M,r.decoder,w,"value")})),T&&y.interpretNumericEntities&&w==="iso-8859-1"&&(T=n(T)),S.indexOf("[]=")>-1&&(T=t(T)?[T]:T),e.call(d,C)?d[C]=a.combine(d[C],T):d[C]=T}return d},l=function(p,h,y,d){for(var _=d?h:i(h,y),m=p.length-1;m>=0;--m){var b,g=p[m];if(g==="[]"&&y.parseArrays)b=[].concat(_);else{b=y.plainObjects?Object.create(null):{};var v=g.charAt(0)==="["&&g.charAt(g.length-1)==="]"?g.slice(1,-1):g,w=parseInt(v,10);!y.parseArrays&&v===""?b={0:_}:!isNaN(w)&&g!==v&&String(w)===v&&w>=0&&y.parseArrays&&w<=y.arrayLimit?(b=[],b[w]=_):v!=="__proto__"&&(b[v]=_)}_=b}return _},c=function(h,y,d,_){if(h){var m=d.allowDots?h.replace(/\.([^.[]+)/g,"[$1]"):h,b=/(\[[^[\]]*])/,g=/(\[[^[\]]*])/g,v=d.depth>0&&b.exec(m),w=v?m.slice(0,v.index):m,S=[];if(w){if(!d.plainObjects&&e.call(Object.prototype,w)&&!d.allowPrototypes)return;S.push(w)}for(var R=0;d.depth>0&&(v=g.exec(m))!==null&&R<d.depth;){if(R+=1,!d.plainObjects&&e.call(Object.prototype,v[1].slice(1,-1))&&!d.allowPrototypes)return;S.push(v[1])}return v&&S.push("["+m.slice(v.index)+"]"),l(S,y,d,_)}},f=function(h){if(!h)return r;if(h.decoder!==null&&h.decoder!==void 0&&typeof h.decoder!="function")throw new TypeError("Decoder has to be a function.");if(typeof h.charset<"u"&&h.charset!=="utf-8"&&h.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var y=typeof h.charset>"u"?r.charset:h.charset;return{allowDots:typeof h.allowDots>"u"?r.allowDots:!!h.allowDots,allowPrototypes:typeof h.allowPrototypes=="boolean"?h.allowPrototypes:r.allowPrototypes,allowSparse:typeof h.allowSparse=="boolean"?h.allowSparse:r.allowSparse,arrayLimit:typeof h.arrayLimit=="number"?h.arrayLimit:r.arrayLimit,charset:y,charsetSentinel:typeof h.charsetSentinel=="boolean"?h.charsetSentinel:r.charsetSentinel,comma:typeof h.comma=="boolean"?h.comma:r.comma,decoder:typeof h.decoder=="function"?h.decoder:r.decoder,delimiter:typeof h.delimiter=="string"||a.isRegExp(h.delimiter)?h.delimiter:r.delimiter,depth:typeof h.depth=="number"||h.depth===!1?+h.depth:r.depth,ignoreQueryPrefix:h.ignoreQueryPrefix===!0,interpretNumericEntities:typeof h.interpretNumericEntities=="boolean"?h.interpretNumericEntities:r.interpretNumericEntities,parameterLimit:typeof h.parameterLimit=="number"?h.parameterLimit:r.parameterLimit,parseArrays:h.parseArrays!==!1,plainObjects:typeof h.plainObjects=="boolean"?h.plainObjects:r.plainObjects,strictNullHandling:typeof h.strictNullHandling=="boolean"?h.strictNullHandling:r.strictNullHandling}};return qS=function(p,h){var y=f(h);if(p===""||p===null||typeof p>"u")return y.plainObjects?Object.create(null):{};for(var d=typeof p=="string"?u(p,y):p,_=y.plainObjects?Object.create(null):{},m=Object.keys(d),b=0;b<m.length;++b){var g=m[b],v=c(g,d[g],y,typeof p=="string");_=a.merge(_,v,y)}return y.allowSparse===!0?_:a.compact(_)},qS}var zS,hN;function _se(){if(hN)return zS;hN=1;var a=hse(),e=pse(),t=NC();return zS={formats:t,parse:e,stringify:a},zS}var pN;function yse(){if(pN)return $l;pN=1;var a=$l&&$l.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty($l,"__esModule",{value:!0}),$l.createRequestUrl=void 0;const e=a(_se());function t(r,n){return Object.keys(n??{}).length>0?`${r}?${e.default.stringify(n,{arrayFormat:"repeat"})}`:r}return $l.createRequestUrl=t,$l}var fr={},BS={},rh={},_N;function bse(){if(_N)return rh;_N=1;var a,e,t,r,n;Object.defineProperty(rh,"__esModule",{value:!0}),rh.RUNTIME=void 0;const i=typeof window<"u"&&typeof window.document<"u",o=typeof self=="object"&&typeof(self==null?void 0:self.importScripts)=="function"&&(((a=self.constructor)===null||a===void 0?void 0:a.name)==="DedicatedWorkerGlobalScope"||((e=self.constructor)===null||e===void 0?void 0:e.name)==="ServiceWorkerGlobalScope"||((t=self.constructor)===null||t===void 0?void 0:t.name)==="SharedWorkerGlobalScope"),s=typeof Deno<"u"&&typeof Deno.version<"u"&&typeof Deno.version.deno<"u",u=typeof Bun<"u"&&typeof Bun.version<"u",l=typeof process<"u"&&!!process.version&&!!(!((r=process.versions)===null||r===void 0)&&r.node)&&!s&&!u,c=typeof navigator<"u"&&(navigator==null?void 0:navigator.product)==="ReactNative",f=typeof globalThis<"u"&&((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0?void 0:n.userAgent)==="Cloudflare-Workers";rh.RUNTIME=p();function p(){return i?{type:"browser",version:window.navigator.userAgent}:f?{type:"workerd"}:o?{type:"web-worker"}:s?{type:"deno",version:Deno.version.deno}:u?{type:"bun",version:Bun.version}:l?{type:"node",version:process.versions.node,parsedVersion:Number(process.versions.node.split(".")[0])}:c?{type:"react-native"}:{type:"unknown"}}return rh}var yN;function n_(){return yN||(yN=1,function(a){Object.defineProperty(a,"__esModule",{value:!0}),a.RUNTIME=void 0;var e=bse();Object.defineProperty(a,"RUNTIME",{enumerable:!0,get:function(){return e.RUNTIME}})}(BS)),BS}var ey={exports:{}},bN;function mN(){return bN||(bN=1,function(a,e){var t=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof vf<"u")return vf;throw new Error("unable to locate global object")},r=t();a.exports=e=r.fetch,r.fetch&&(e.default=r.fetch.bind(r)),e.Headers=r.Headers,e.Request=r.Request,e.Response=r.Response}(ey,ey.exports)),ey.exports}var gN;function mse(){if(gN)return fr;gN=1;var a=fr&&fr.__createBinding||(Object.create?function(o,s,u,l){l===void 0&&(l=u);var c=Object.getOwnPropertyDescriptor(s,u);(!c||("get"in c?!s.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return s[u]}}),Object.defineProperty(o,l,c)}:function(o,s,u,l){l===void 0&&(l=u),o[l]=s[u]}),e=fr&&fr.__setModuleDefault||(Object.create?function(o,s){Object.defineProperty(o,"default",{enumerable:!0,value:s})}:function(o,s){o.default=s}),t=fr&&fr.__importStar||function(o){if(o&&o.__esModule)return o;var s={};if(o!=null)for(var u in o)u!=="default"&&Object.prototype.hasOwnProperty.call(o,u)&&a(s,o,u);return e(s,o),s},r=fr&&fr.__awaiter||function(o,s,u,l){function c(f){return f instanceof u?f:new u(function(p){p(f)})}return new(u||(u=Promise))(function(f,p){function h(_){try{d(l.next(_))}catch(m){p(m)}}function y(_){try{d(l.throw(_))}catch(m){p(m)}}function d(_){_.done?f(_.value):c(_.value).then(h,y)}d((l=l.apply(o,s||[])).next())})};Object.defineProperty(fr,"__esModule",{value:!0}),fr.getFetchFn=void 0;const n=n_();function i(){return r(this,void 0,void 0,function*(){return n.RUNTIME.type==="node"&&n.RUNTIME.parsedVersion!=null&&n.RUNTIME.parsedVersion>=18?fetch:n.RUNTIME.type==="node"?(yield Promise.resolve().then(()=>t(mN()))).default:typeof fetch=="function"?fetch:(yield Promise.resolve().then(()=>t(mN()))).default})}return fr.getFetchFn=i,fr}var Nl={},vN;function gse(){if(vN)return Nl;vN=1;var a=Nl&&Nl.__awaiter||function(t,r,n,i){function o(s){return s instanceof n?s:new n(function(u){u(s)})}return new(n||(n=Promise))(function(s,u){function l(p){try{f(i.next(p))}catch(h){u(h)}}function c(p){try{f(i.throw(p))}catch(h){u(h)}}function f(p){p.done?s(p.value):o(p.value).then(l,c)}f((i=i.apply(t,r||[])).next())})};Object.defineProperty(Nl,"__esModule",{value:!0}),Nl.getRequestBody=void 0;function e({body:t,type:r}){return a(this,void 0,void 0,function*(){return r.includes("json")?JSON.stringify(t):t})}return Nl.getRequestBody=e,Nl}var ql={},dr={},zl={},wN;function vse(){if(wN)return zl;wN=1;var a=zl&&zl.__awaiter||function(t,r,n,i){function o(s){return s instanceof n?s:new n(function(u){u(s)})}return new(n||(n=Promise))(function(s,u){function l(p){try{f(i.next(p))}catch(h){u(h)}}function c(p){try{f(i.throw(p))}catch(h){u(h)}}function f(p){p.done?s(p.value):o(p.value).then(l,c)}f((i=i.apply(t,r||[])).next())})};Object.defineProperty(zl,"__esModule",{value:!0}),zl.Node18UniversalStreamWrapper=void 0;let e=class pc{constructor(r){this.readableStream=r,this.reader=this.readableStream.getReader(),this.events={data:[],end:[],error:[],readable:[],close:[],pause:[],resume:[]},this.paused=!1,this.resumeCallback=null,this.encoding=null}on(r,n){var i;(i=this.events[r])===null||i===void 0||i.push(n)}off(r,n){var i;this.events[r]=(i=this.events[r])===null||i===void 0?void 0:i.filter(o=>o!==n)}pipe(r){return this.on("data",n=>a(this,void 0,void 0,function*(){if(r instanceof pc)r._write(n);else if(r instanceof WritableStream){const i=r.getWriter();i.write(n).then(()=>i.releaseLock())}else r.write(n)})),this.on("end",()=>a(this,void 0,void 0,function*(){r instanceof pc?r._end():r instanceof WritableStream?r.getWriter().close():r.end()})),this.on("error",n=>a(this,void 0,void 0,function*(){r instanceof pc?r._error(n):r instanceof WritableStream?r.getWriter().abort(n):r.destroy(n)})),this._startReading(),r}pipeTo(r){return this.pipe(r)}unpipe(r){this.off("data",n=>a(this,void 0,void 0,function*(){if(r instanceof pc)r._write(n);else if(r instanceof WritableStream){const i=r.getWriter();i.write(n).then(()=>i.releaseLock())}else r.write(n)})),this.off("end",()=>a(this,void 0,void 0,function*(){r instanceof pc?r._end():r instanceof WritableStream?r.getWriter().close():r.end()})),this.off("error",n=>a(this,void 0,void 0,function*(){r instanceof pc?r._error(n):r instanceof WritableStream?r.getWriter().abort(n):r.destroy(n)}))}destroy(r){this.reader.cancel(r).then(()=>{this._emit("close")}).catch(n=>{this._emit("error",n)})}pause(){this.paused=!0,this._emit("pause")}resume(){this.paused&&(this.paused=!1,this._emit("resume"),this.resumeCallback&&(this.resumeCallback(),this.resumeCallback=null))}get isPaused(){return this.paused}read(){return a(this,void 0,void 0,function*(){this.paused&&(yield new Promise(i=>{this.resumeCallback=i}));const{done:r,value:n}=yield this.reader.read();if(!r)return n})}setEncoding(r){this.encoding=r}text(){return a(this,void 0,void 0,function*(){const r=[];for(;;){const{done:i,value:o}=yield this.reader.read();if(i)break;o&&r.push(o)}return new TextDecoder(this.encoding||"utf-8").decode(yield new Blob(r).arrayBuffer())})}json(){return a(this,void 0,void 0,function*(){const r=yield this.text();return JSON.parse(r)})}_write(r){this._emit("data",r)}_end(){this._emit("end")}_error(r){this._emit("error",r)}_emit(r,n){if(this.events[r])for(const i of this.events[r]||[])i(n)}_startReading(){return a(this,void 0,void 0,function*(){try{for(this._emit("readable");;){this.paused&&(yield new Promise(i=>{this.resumeCallback=i}));const{done:r,value:n}=yield this.reader.read();if(r){this._emit("end"),this._emit("close");break}n&&this._emit("data",n)}}catch(r){this._emit("error",r)}})}[Symbol.asyncIterator](){return{next:()=>a(this,void 0,void 0,function*(){this.paused&&(yield new Promise(i=>{this.resumeCallback=i}));const{done:r,value:n}=yield this.reader.read();return r?{done:!0,value:void 0}:{done:!1,value:n}}),[Symbol.asyncIterator](){return this}}}};return zl.Node18UniversalStreamWrapper=e,zl}var Bl={},ON;function wse(){if(ON)return Bl;ON=1;var a=Bl&&Bl.__awaiter||function(t,r,n,i){function o(s){return s instanceof n?s:new n(function(u){u(s)})}return new(n||(n=Promise))(function(s,u){function l(p){try{f(i.next(p))}catch(h){u(h)}}function c(p){try{f(i.throw(p))}catch(h){u(h)}}function f(p){p.done?s(p.value):o(p.value).then(l,c)}f((i=i.apply(t,r||[])).next())})};Object.defineProperty(Bl,"__esModule",{value:!0}),Bl.UndiciStreamWrapper=void 0;let e=class _c{constructor(r){this.readableStream=r,this.reader=this.readableStream.getReader(),this.events={data:[],end:[],error:[],readable:[],close:[],pause:[],resume:[]},this.paused=!1,this.resumeCallback=null,this.encoding=null}on(r,n){var i;(i=this.events[r])===null||i===void 0||i.push(n)}off(r,n){var i;this.events[r]=(i=this.events[r])===null||i===void 0?void 0:i.filter(o=>o!==n)}pipe(r){return this.on("data",n=>{if(r instanceof _c)r._write(n);else{const i=r.getWriter();i.write(n).then(()=>i.releaseLock())}}),this.on("end",()=>{r instanceof _c?r._end():r.getWriter().close()}),this.on("error",n=>{r instanceof _c?r._error(n):r.getWriter().abort(n)}),this._startReading(),r}pipeTo(r){return this.pipe(r)}unpipe(r){this.off("data",n=>{if(r instanceof _c)r._write(n);else{const i=r.getWriter();i.write(n).then(()=>i.releaseLock())}}),this.off("end",()=>{r instanceof _c?r._end():r.getWriter().close()}),this.off("error",n=>{r instanceof _c?r._error(n):r.getWriter().abort(n)})}destroy(r){this.reader.cancel(r).then(()=>{this._emit("close")}).catch(n=>{this._emit("error",n)})}pause(){this.paused=!0,this._emit("pause")}resume(){this.paused&&(this.paused=!1,this._emit("resume"),this.resumeCallback&&(this.resumeCallback(),this.resumeCallback=null))}get isPaused(){return this.paused}read(){return a(this,void 0,void 0,function*(){this.paused&&(yield new Promise(i=>{this.resumeCallback=i}));const{done:r,value:n}=yield this.reader.read();if(!r)return n})}setEncoding(r){this.encoding=r}text(){return a(this,void 0,void 0,function*(){const r=[];for(;;){const{done:i,value:o}=yield this.reader.read();if(i)break;o&&r.push(o)}return new TextDecoder(this.encoding||"utf-8").decode(yield new Blob(r).arrayBuffer())})}json(){return a(this,void 0,void 0,function*(){const r=yield this.text();return JSON.parse(r)})}_write(r){this._emit("data",r)}_end(){this._emit("end")}_error(r){this._emit("error",r)}_emit(r,n){if(this.events[r])for(const i of this.events[r]||[])i(n)}_startReading(){return a(this,void 0,void 0,function*(){try{for(this._emit("readable");;){this.paused&&(yield new Promise(i=>{this.resumeCallback=i}));const{done:r,value:n}=yield this.reader.read();if(r){this._emit("end"),this._emit("close");break}n&&this._emit("data",n)}}catch(r){this._emit("error",r)}})}[Symbol.asyncIterator](){return{next:()=>a(this,void 0,void 0,function*(){this.paused&&(yield new Promise(i=>{this.resumeCallback=i}));const{done:r,value:n}=yield this.reader.read();return r?{done:!0,value:void 0}:{done:!1,value:n}}),[Symbol.asyncIterator](){return this}}}};return Bl.UndiciStreamWrapper=e,Bl}var _u={},SN;function Ose(){if(SN)return _u;SN=1;var a=_u&&_u.__awaiter||function(r,n,i,o){function s(u){return u instanceof i?u:new i(function(l){l(u)})}return new(i||(i=Promise))(function(u,l){function c(h){try{p(o.next(h))}catch(y){l(y)}}function f(h){try{p(o.throw(h))}catch(y){l(y)}}function p(h){h.done?u(h.value):s(h.value).then(c,f)}p((o=o.apply(r,n||[])).next())})},e=_u&&_u.__asyncValues||function(r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r[Symbol.asyncIterator],i;return n?n.call(r):(r=typeof __values=="function"?__values(r):r[Symbol.iterator](),i={},o("next"),o("throw"),o("return"),i[Symbol.asyncIterator]=function(){return this},i);function o(u){i[u]=r[u]&&function(l){return new Promise(function(c,f){l=r[u](l),s(c,f,l.done,l.value)})}}function s(u,l,c,f){Promise.resolve(f).then(function(p){u({value:p,done:c})},l)}};Object.defineProperty(_u,"__esModule",{value:!0}),_u.NodePre18StreamWrapper=void 0;let t=class{constructor(n){this.readableStream=n}on(n,i){this.readableStream.on(n,i)}off(n,i){this.readableStream.off(n,i)}pipe(n){return this.readableStream.pipe(n),n}pipeTo(n){return this.pipe(n)}unpipe(n){n?this.readableStream.unpipe(n):this.readableStream.unpipe()}destroy(n){this.readableStream.destroy(n)}pause(){this.readableStream.pause()}resume(){this.readableStream.resume()}get isPaused(){return this.readableStream.isPaused()}read(){return a(this,void 0,void 0,function*(){return new Promise((n,i)=>{const o=this.readableStream.read();o?n(o):(this.readableStream.once("readable",()=>{const s=this.readableStream.read();n(s)}),this.readableStream.once("error",i))})})}setEncoding(n){this.readableStream.setEncoding(n),this.encoding=n}text(){var n,i;return a(this,void 0,void 0,function*(){const o=[],s=new TextEncoder;this.readableStream.setEncoding(this.encoding||"utf-8");try{for(var u=e(this.readableStream),l;l=yield u.next(),!l.done;){const f=l.value;o.push(s.encode(f))}}catch(f){n={error:f}}finally{try{l&&!l.done&&(i=u.return)&&(yield i.call(u))}finally{if(n)throw n.error}}return new TextDecoder(this.encoding||"utf-8").decode(Buffer.concat(o))})}json(){return a(this,void 0,void 0,function*(){const n=yield this.text();return JSON.parse(n)})}[Symbol.asyncIterator](){const i=this.readableStream[Symbol.asyncIterator]();return{next(){return a(this,void 0,void 0,function*(){const{value:o,done:s}=yield i.next();return{value:o,done:s}})},[Symbol.asyncIterator](){return this}}}};return _u.NodePre18StreamWrapper=t,_u}var EN;function Sse(){if(EN)return dr;EN=1;var a=dr&&dr.__createBinding||(Object.create?function(o,s,u,l){l===void 0&&(l=u);var c=Object.getOwnPropertyDescriptor(s,u);(!c||("get"in c?!s.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return s[u]}}),Object.defineProperty(o,l,c)}:function(o,s,u,l){l===void 0&&(l=u),o[l]=s[u]}),e=dr&&dr.__setModuleDefault||(Object.create?function(o,s){Object.defineProperty(o,"default",{enumerable:!0,value:s})}:function(o,s){o.default=s}),t=dr&&dr.__importStar||function(o){if(o&&o.__esModule)return o;var s={};if(o!=null)for(var u in o)u!=="default"&&Object.prototype.hasOwnProperty.call(o,u)&&a(s,o,u);return e(s,o),s},r=dr&&dr.__awaiter||function(o,s,u,l){function c(f){return f instanceof u?f:new u(function(p){p(f)})}return new(u||(u=Promise))(function(f,p){function h(_){try{d(l.next(_))}catch(m){p(m)}}function y(_){try{d(l.throw(_))}catch(m){p(m)}}function d(_){_.done?f(_.value):c(_.value).then(h,y)}d((l=l.apply(o,s||[])).next())})};Object.defineProperty(dr,"__esModule",{value:!0}),dr.chooseStreamWrapper=void 0;const n=n_();function i(o){return r(this,void 0,void 0,function*(){return n.RUNTIME.type==="node"&&n.RUNTIME.parsedVersion!=null&&n.RUNTIME.parsedVersion>=18?new(yield Promise.resolve().then(()=>t(vse()))).Node18UniversalStreamWrapper(o):n.RUNTIME.type!=="node"&&typeof fetch=="function"?new(yield Promise.resolve().then(()=>t(wse()))).UndiciStreamWrapper(o):new(yield Promise.resolve().then(()=>t(Ose()))).NodePre18StreamWrapper(o)})}return dr.chooseStreamWrapper=i,dr}var RN;function Ese(){if(RN)return ql;RN=1;var a=ql&&ql.__awaiter||function(r,n,i,o){function s(u){return u instanceof i?u:new i(function(l){l(u)})}return new(i||(i=Promise))(function(u,l){function c(h){try{p(o.next(h))}catch(y){l(y)}}function f(h){try{p(o.throw(h))}catch(y){l(y)}}function p(h){h.done?u(h.value):s(h.value).then(c,f)}p((o=o.apply(r,n||[])).next())})};Object.defineProperty(ql,"__esModule",{value:!0}),ql.getResponseBody=void 0;const e=Sse();function t(r,n){return a(this,void 0,void 0,function*(){if(r.body!=null&&n==="blob")return yield r.blob();if(r.body!=null&&n==="arrayBuffer")return yield r.arrayBuffer();if(r.body!=null&&n==="sse")return r.body;if(r.body!=null&&n==="streaming")return(0,e.chooseStreamWrapper)(r.body);if(r.body!=null&&n==="text")return yield r.text();{const i=yield r.text();if(i.length>0)try{return JSON.parse(i)}catch{return{ok:!1,error:{reason:"non-json",statusCode:r.status,rawBody:i}}}else return}})}return ql.getResponseBody=t,ql}var Ul={},Fl={},CN;function Rse(){if(CN)return Fl;CN=1,Object.defineProperty(Fl,"__esModule",{value:!0}),Fl.anySignal=Fl.getTimeoutSignal=void 0;const a="timeout";function e(r){const n=new AbortController,i=setTimeout(()=>n.abort(a),r);return{signal:n.signal,abortId:i}}Fl.getTimeoutSignal=e;function t(...r){const n=r.length===1&&Array.isArray(r[0])?r[0]:r,i=new AbortController;for(const o of n){if(o.aborted){i.abort(o==null?void 0:o.reason);break}o.addEventListener("abort",()=>i.abort(o==null?void 0:o.reason),{signal:i.signal})}return i.signal}return Fl.anySignal=t,Fl}var PN;function Cse(){if(PN)return Ul;PN=1;var a=Ul&&Ul.__awaiter||function(r,n,i,o){function s(u){return u instanceof i?u:new i(function(l){l(u)})}return new(i||(i=Promise))(function(u,l){function c(h){try{p(o.next(h))}catch(y){l(y)}}function f(h){try{p(o.throw(h))}catch(y){l(y)}}function p(h){h.done?u(h.value):s(h.value).then(c,f)}p((o=o.apply(r,n||[])).next())})};Object.defineProperty(Ul,"__esModule",{value:!0}),Ul.makeRequest=void 0;const e=Rse(),t=(r,n,i,o,s,u,l,c,f)=>a(void 0,void 0,void 0,function*(){const p=[];let h;if(u!=null){const{signal:_,abortId:m}=(0,e.getTimeoutSignal)(u);h=m,p.push(_)}l!=null&&p.push(l);let y=(0,e.anySignal)(p);const d=yield r(n,{method:i,headers:o,body:s,signal:y,credentials:c?"include":void 0,duplex:f});return h!=null&&clearTimeout(h),d});return Ul.makeRequest=t,Ul}var Ll={},jN;function Pse(){if(jN)return Ll;jN=1;var a=Ll&&Ll.__awaiter||function(s,u,l,c){function f(p){return p instanceof l?p:new l(function(h){h(p)})}return new(l||(l=Promise))(function(p,h){function y(m){try{_(c.next(m))}catch(b){h(b)}}function d(m){try{_(c.throw(m))}catch(b){h(b)}}function _(m){m.done?p(m.value):f(m.value).then(y,d)}_((c=c.apply(s,u||[])).next())})};Object.defineProperty(Ll,"__esModule",{value:!0}),Ll.requestWithRetries=void 0;const e=1e3,t=6e4,r=2,n=.2;function i(s){const u=1+(Math.random()*2-1)*n;return s*u}function o(s,u=r){return a(this,void 0,void 0,function*(){let l=yield s();for(let c=0;c<u&&([408,409,429].includes(l.status)||l.status>=500);++c){const f=Math.min(e*Math.pow(2,c),t),p=i(f);yield new Promise(h=>setTimeout(h,p)),l=yield s()}return l})}return Ll.requestWithRetries=o,Ll}var TN;function jse(){if(TN)return pu;TN=1;var a=pu&&pu.__awaiter||function(u,l,c,f){function p(h){return h instanceof c?h:new c(function(y){y(h)})}return new(c||(c=Promise))(function(h,y){function d(b){try{m(f.next(b))}catch(g){y(g)}}function _(b){try{m(f.throw(b))}catch(g){y(g)}}function m(b){b.done?h(b.value):p(b.value).then(d,_)}m((f=f.apply(u,l||[])).next())})};Object.defineProperty(pu,"__esModule",{value:!0}),pu.fetcher=pu.fetcherImpl=void 0;const e=yse(),t=mse(),r=gse(),n=Ese(),i=Cse(),o=Pse();function s(u){return a(this,void 0,void 0,function*(){const l={};if(u.body!==void 0&&u.contentType!=null&&(l["Content-Type"]=u.contentType),u.headers!=null)for(const[h,y]of Object.entries(u.headers))y!=null&&(l[h]=y);const c=(0,e.createRequestUrl)(u.url,u.queryParameters);let f=yield(0,r.getRequestBody)({body:u.body,type:u.requestType==="json"?"json":"other"});const p=yield(0,t.getFetchFn)();try{const h=yield(0,o.requestWithRetries)(()=>a(this,void 0,void 0,function*(){return(0,i.makeRequest)(p,c,u.method,l,f,u.timeoutMs,u.abortSignal,u.withCredentials,u.duplex)}),u.maxRetries);let y=yield(0,n.getResponseBody)(h,u.responseType);return h.status>=200&&h.status<400?{ok:!0,body:y,headers:h.headers}:{ok:!1,error:{reason:"status-code",statusCode:h.status,body:y}}}catch(h){return u.abortSignal!=null&&u.abortSignal.aborted?{ok:!1,error:{reason:"unknown",errorMessage:"The user aborted a request"}}:h instanceof Error&&h.name==="AbortError"?{ok:!1,error:{reason:"timeout"}}:h instanceof Error?{ok:!1,error:{reason:"unknown",errorMessage:h.message}}:{ok:!1,error:{reason:"unknown",errorMessage:JSON.stringify(h)}}}})}return pu.fetcherImpl=s,pu.fetcher=s,pu}var nh={},MN;function Tse(){if(MN)return nh;MN=1,Object.defineProperty(nh,"__esModule",{value:!0}),nh.getHeader=void 0;function a(e,t){for(const[r,n]of Object.entries(e))if(r.toLowerCase()===t.toLowerCase())return n}return nh.getHeader=a,nh}var Vl={},AN;function Mse(){if(AN)return Vl;AN=1;var a=Vl&&Vl.__awaiter||function(e,t,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function u(f){try{c(n.next(f))}catch(p){s(p)}}function l(f){try{c(n.throw(f))}catch(p){s(p)}}function c(f){f.done?o(f.value):i(f.value).then(u,l)}c((n=n.apply(e,t||[])).next())})};return Object.defineProperty(Vl,"__esModule",{value:!0}),Vl.Supplier=void 0,Vl.Supplier={get:e=>a(void 0,void 0,void 0,function*(){return typeof e=="function"?e():e})},Vl}var IN;function Ase(){return IN||(IN=1,function(a){Object.defineProperty(a,"__esModule",{value:!0}),a.Supplier=a.getHeader=a.fetcher=void 0;var e=jse();Object.defineProperty(a,"fetcher",{enumerable:!0,get:function(){return e.fetcher}});var t=Tse();Object.defineProperty(a,"getHeader",{enumerable:!0,get:function(){return t.getHeader}});var r=Mse();Object.defineProperty(a,"Supplier",{enumerable:!0,get:function(){return r.Supplier}})}(WO)),WO}var US={},ih={},my={exports:{}},Ise=my.exports,DN;function Dse(){return DN||(DN=1,function(a,e){(function(t,r){a.exports=r()})(typeof self<"u"?self:typeof window<"u"?window:typeof vf<"u"?vf:Ise,function(){var t="3.7.2",r=t,n=typeof atob=="function",i=typeof btoa=="function",o=typeof Buffer=="function",s=typeof TextDecoder=="function"?new TextDecoder:void 0,u=typeof TextEncoder=="function"?new TextEncoder:void 0,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",c=Array.prototype.slice.call(l),f=function(W){var U={};return W.forEach(function(N,k){return U[N]=k}),U}(c),p=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,h=String.fromCharCode.bind(String),y=typeof Uint8Array.from=="function"?Uint8Array.from.bind(Uint8Array):function(W,U){return U===void 0&&(U=function(N){return N}),new Uint8Array(Array.prototype.slice.call(W,0).map(U))},d=function(W){return W.replace(/=/g,"").replace(/[+\/]/g,function(U){return U=="+"?"-":"_"})},_=function(W){return W.replace(/[^A-Za-z0-9\+\/]/g,"")},m=function(W){for(var U,N,k,ie,ue="",z=W.length%3,V=0;V<W.length;){if((N=W.charCodeAt(V++))>255||(k=W.charCodeAt(V++))>255||(ie=W.charCodeAt(V++))>255)throw new TypeError("invalid character found");U=N<<16|k<<8|ie,ue+=c[U>>18&63]+c[U>>12&63]+c[U>>6&63]+c[U&63]}return z?ue.slice(0,z-3)+"===".substring(z):ue},b=i?function(W){return btoa(W)}:o?function(W){return Buffer.from(W,"binary").toString("base64")}:m,g=o?function(W){return Buffer.from(W).toString("base64")}:function(W){for(var U=4096,N=[],k=0,ie=W.length;k<ie;k+=U)N.push(h.apply(null,W.subarray(k,k+U)));return b(N.join(""))},v=function(W,U){return U===void 0&&(U=!1),U?d(g(W)):g(W)},w=function(W){if(W.length<2){var U=W.charCodeAt(0);return U<128?W:U<2048?h(192|U>>>6)+h(128|U&63):h(224|U>>>12&15)+h(128|U>>>6&63)+h(128|U&63)}else{var U=65536+(W.charCodeAt(0)-55296)*1024+(W.charCodeAt(1)-56320);return h(240|U>>>18&7)+h(128|U>>>12&63)+h(128|U>>>6&63)+h(128|U&63)}},S=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,R=function(W){return W.replace(S,w)},P=o?function(W){return Buffer.from(W,"utf8").toString("base64")}:u?function(W){return g(u.encode(W))}:function(W){return b(R(W))},C=function(W,U){return U===void 0&&(U=!1),U?d(P(W)):P(W)},T=function(W){return C(W,!0)},M=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,K=function(W){switch(W.length){case 4:var U=(7&W.charCodeAt(0))<<18|(63&W.charCodeAt(1))<<12|(63&W.charCodeAt(2))<<6|63&W.charCodeAt(3),N=U-65536;return h((N>>>10)+55296)+h((N&1023)+56320);case 3:return h((15&W.charCodeAt(0))<<12|(63&W.charCodeAt(1))<<6|63&W.charCodeAt(2));default:return h((31&W.charCodeAt(0))<<6|63&W.charCodeAt(1))}},q=function(W){return W.replace(M,K)},B=function(W){if(W=W.replace(/\s+/g,""),!p.test(W))throw new TypeError("malformed base64.");W+="==".slice(2-(W.length&3));for(var U,N="",k,ie,ue=0;ue<W.length;)U=f[W.charAt(ue++)]<<18|f[W.charAt(ue++)]<<12|(k=f[W.charAt(ue++)])<<6|(ie=f[W.charAt(ue++)]),N+=k===64?h(U>>16&255):ie===64?h(U>>16&255,U>>8&255):h(U>>16&255,U>>8&255,U&255);return N},H=n?function(W){return atob(_(W))}:o?function(W){return Buffer.from(W,"base64").toString("binary")}:B,Q=o?function(W){return y(Buffer.from(W,"base64"))}:function(W){return y(H(W),function(U){return U.charCodeAt(0)})},se=function(W){return Q(ee(W))},F=o?function(W){return Buffer.from(W,"base64").toString("utf8")}:s?function(W){return s.decode(Q(W))}:function(W){return q(H(W))},ee=function(W){return _(W.replace(/[-_]/g,function(U){return U=="-"?"+":"/"}))},A=function(W){return F(ee(W))},J=function(W){if(typeof W!="string")return!1;var U=W.replace(/\s+/g,"").replace(/={0,2}$/,"");return!/[^\s0-9a-zA-Z\+/]/.test(U)||!/[^\s0-9a-zA-Z\-_]/.test(U)},te=function(W){return{value:W,enumerable:!1,writable:!0,configurable:!0}},Z=function(){var W=function(U,N){return Object.defineProperty(String.prototype,U,te(N))};W("fromBase64",function(){return A(this)}),W("toBase64",function(U){return C(this,U)}),W("toBase64URI",function(){return C(this,!0)}),W("toBase64URL",function(){return C(this,!0)}),W("toUint8Array",function(){return se(this)})},he=function(){var W=function(U,N){return Object.defineProperty(Uint8Array.prototype,U,te(N))};W("toBase64",function(U){return v(this,U)}),W("toBase64URI",function(){return v(this,!0)}),W("toBase64URL",function(){return v(this,!0)})},ye=function(){Z(),he()},ve={version:t,VERSION:r,atob:H,atobPolyfill:B,btoa:b,btoaPolyfill:m,fromBase64:A,toBase64:C,encode:C,encodeURI:T,encodeURL:T,utob:R,btou:q,decode:A,isValid:J,fromUint8Array:v,toUint8Array:se,extendString:Z,extendUint8Array:he,extendBuiltins:ye};return ve.Base64={},Object.keys(ve).forEach(function(W){return ve.Base64[W]=ve[W]}),ve})}(my)),my.exports}var xN;function xse(){if(xN)return ih;xN=1,Object.defineProperty(ih,"__esModule",{value:!0}),ih.BasicAuth=void 0;const a=Dse(),e=/^Basic /i;return ih.BasicAuth={toAuthorizationHeader:t=>t==null?void 0:`Basic ${a.Base64.encode(`${t.username}:${t.password}`)}`,fromAuthorizationHeader:t=>{const r=t.replace(e,""),n=a.Base64.decode(r),[i,o]=n.split(":",2);if(i==null||o==null)throw new Error("Invalid basic auth");return{username:i,password:o}}},ih}var ah={},$N;function $se(){if($N)return ah;$N=1,Object.defineProperty(ah,"__esModule",{value:!0}),ah.BearerToken=void 0;const a=/^Bearer /i;return ah.BearerToken={toAuthorizationHeader:e=>{if(e!=null)return`Bearer ${e}`},fromAuthorizationHeader:e=>e.replace(a,"").trim()},ah}var NN;function Nse(){return NN||(NN=1,function(a){Object.defineProperty(a,"__esModule",{value:!0}),a.BearerToken=a.BasicAuth=void 0;var e=xse();Object.defineProperty(a,"BasicAuth",{enumerable:!0,get:function(){return e.BasicAuth}});var t=$se();Object.defineProperty(a,"BearerToken",{enumerable:!0,get:function(){return t.BearerToken}})}(US)),US}var FS={},Ft={},qN;function wG(){if(qN)return Ft;qN=1;var a=Ft&&Ft.__awaiter||function(u,l,c,f){function p(h){return h instanceof c?h:new c(function(y){y(h)})}return new(c||(c=Promise))(function(h,y){function d(b){try{m(f.next(b))}catch(g){y(g)}}function _(b){try{m(f.throw(b))}catch(g){y(g)}}function m(b){b.done?h(b.value):p(b.value).then(d,_)}m((f=f.apply(u,l||[])).next())})},e=Ft&&Ft.__asyncValues||function(u){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var l=u[Symbol.asyncIterator],c;return l?l.call(u):(u=typeof __values=="function"?__values(u):u[Symbol.iterator](),c={},f("next"),f("throw"),f("return"),c[Symbol.asyncIterator]=function(){return this},c);function f(h){c[h]=u[h]&&function(y){return new Promise(function(d,_){y=u[h](y),p(d,_,y.done,y.value)})}}function p(h,y,d,_){Promise.resolve(_).then(function(m){h({value:m,done:d})},y)}},t=Ft&&Ft.__await||function(u){return this instanceof t?(this.v=u,this):new t(u)},r=Ft&&Ft.__asyncGenerator||function(u,l,c){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var f=c.apply(u,l||[]),p,h=[];return p={},y("next"),y("throw"),y("return"),p[Symbol.asyncIterator]=function(){return this},p;function y(v){f[v]&&(p[v]=function(w){return new Promise(function(S,R){h.push([v,w,S,R])>1||d(v,w)})})}function d(v,w){try{_(f[v](w))}catch(S){g(h[0][3],S)}}function _(v){v.value instanceof t?Promise.resolve(v.value.v).then(m,b):g(h[0][2],v)}function m(v){d("next",v)}function b(v){d("throw",v)}function g(v,w){v(w),h.shift(),h.length&&d(h[0][0],h[0][1])}};Object.defineProperty(Ft,"__esModule",{value:!0}),Ft.readableStreamAsyncIterable=Ft.Stream=void 0;const n=n_(),i="data:";class o{constructor({stream:l,parse:c,eventShape:f,signal:p}){this.controller=new AbortController,this.stream=l,this.parse=c,f.type==="sse"?(this.prefix=i,this.messageTerminator=`
`,this.streamTerminator=f.streamTerminator):this.messageTerminator=f.messageTerminator,p==null||p.addEventListener("abort",()=>this.controller.abort())}iterMessages(){return r(this,arguments,function*(){var c,f;this.controller.signal;const p=s(this.stream);let h="",y=!1;try{for(var d=e(p),_;_=yield t(d.next()),!_.done;){const m=_.value;h+=this.decodeChunk(m);let b;for(;(b=h.indexOf(this.messageTerminator))>=0;){let g=h.slice(0,b+1);if(h=h.slice(b+1),g.length===0)continue;if(!y&&this.prefix!=null){const w=g.indexOf(this.prefix);if(w===-1)continue;y=!0,g=g.slice(w+this.prefix.length)}if(this.streamTerminator!=null&&g.includes(this.streamTerminator))return yield t(void 0);const v=yield t(this.parse(JSON.parse(g)));yield yield t(v),y=!1}}}catch(m){c={error:m}}finally{try{_&&!_.done&&(f=d.return)&&(yield t(f.call(d)))}finally{if(c)throw c.error}}})}[Symbol.asyncIterator](){return r(this,arguments,function*(){var c,f;try{for(var p=e(this.iterMessages()),h;h=yield t(p.next()),!h.done;){const y=h.value;yield yield t(y)}}catch(y){c={error:y}}finally{try{h&&!h.done&&(f=p.return)&&(yield t(f.call(p)))}finally{if(c)throw c.error}}})}decodeChunk(l){let c="";if(typeof TextDecoder<"u"){const f=new TextDecoder("utf8");c+=f.decode(l)}else n.RUNTIME.type==="node"&&typeof l<"u"&&(c+=Buffer.isBuffer(l)?l:Buffer.from(l));return c}}Ft.Stream=o;function s(u){if(u[Symbol.asyncIterator])return u;const l=u.getReader();return{next(){return a(this,void 0,void 0,function*(){try{const c=yield l.read();return c!=null&&c.done&&l.releaseLock(),c}catch(c){throw l.releaseLock(),c}})},return(){return a(this,void 0,void 0,function*(){const c=l.cancel();return l.releaseLock(),yield c,{done:!0,value:void 0}})},[Symbol.asyncIterator](){return this}}}return Ft.readableStreamAsyncIterable=s,Ft}var zN;function qse(){return zN||(zN=1,function(a){Object.defineProperty(a,"__esModule",{value:!0}),a.Stream=void 0;var e=wG();Object.defineProperty(a,"Stream",{enumerable:!0,get:function(){return e.Stream}})}(FS)),FS}var Gl={},yt={},LS,BN;function zse(){if(BN)return LS;BN=1;var a=Object.defineProperty,e=Object.getOwnPropertyDescriptor,t=Object.getOwnPropertyNames,r=Object.prototype.hasOwnProperty,n=(p,h)=>{for(var y in h)a(p,y,{get:h[y],enumerable:!0})},i=(p,h,y,d)=>{if(h&&typeof h=="object"||typeof h=="function")for(let _ of t(h))!r.call(p,_)&&_!==y&&a(p,_,{get:()=>h[_],enumerable:!(d=e(h,_))||d.enumerable});return p},o=p=>i(a({},"__esModule",{value:!0}),p),s={};n(s,{Blob:()=>c,File:()=>f,FormData:()=>l}),LS=o(s);var u=function(){return typeof globalThis<"u"?globalThis:typeof self<"u"?self:window}(),{FormData:l,Blob:c,File:f}=u;return LS}var VS,UN;function Bse(){if(UN)return VS;UN=1;var a=Object.defineProperty,e=Object.getOwnPropertyDescriptor,t=Object.getOwnPropertyNames,r=Object.prototype.hasOwnProperty,n=(N,k)=>{for(var ie in k)a(N,ie,{get:k[ie],enumerable:!0})},i=(N,k,ie,ue)=>{if(k&&typeof k=="object"||typeof k=="function")for(let z of t(k))!r.call(N,z)&&z!==ie&&a(N,z,{get:()=>k[z],enumerable:!(ue=e(k,z))||ue.enumerable});return N},o=N=>i(a({},"__esModule",{value:!0}),N),s=(N,k,ie)=>{if(!k.has(N))throw TypeError("Cannot "+ie)},u=(N,k,ie)=>(s(N,k,"read from private field"),ie?ie.call(N):k.get(N)),l=(N,k,ie)=>{if(k.has(N))throw TypeError("Cannot add the same private member more than once");k instanceof WeakSet?k.add(N):k.set(N,ie)},c=(N,k,ie,ue)=>(s(N,k,"write to private field"),k.set(N,ie),ie),f=(N,k,ie)=>(s(N,k,"access private method"),ie),p={};n(p,{FormDataEncoder:()=>U,isFile:()=>q,isFormData:()=>M}),VS=o(p);var h=N=>typeof N=="function",y=N=>h(N[Symbol.asyncIterator]),d=65536;function*_(N){if(N.byteLength<=d){yield N;return}let k=0;for(;k<N.byteLength;){const ie=Math.min(N.byteLength-k,d),ue=N.buffer.slice(k,k+ie);k+=ue.byteLength,yield new Uint8Array(ue)}}async function*m(N){const k=N.getReader();for(;;){const{done:ie,value:ue}=await k.read();if(ie)break;yield ue}}async function*b(N){for await(const k of N)yield*_(k)}var g=N=>{if(y(N))return b(N);if(h(N.getReader))return b(m(N));throw new TypeError("Unsupported data source: Expected either ReadableStream or async iterable.")},v="abcdefghijklmnopqrstuvwxyz0123456789";function w(){let N=16,k="";for(;N--;)k+=v[Math.random()*v.length<<0];return k}var S=N=>String(N).replace(/\r|\n/g,(k,ie,ue)=>k==="\r"&&ue[ie+1]!==`
`||k===`
`&&ue[ie-1]!=="\r"?`\r
`:k),R=N=>Object.prototype.toString.call(N).slice(8,-1).toLowerCase();function P(N){if(R(N)!=="object")return!1;const k=Object.getPrototypeOf(N);return k==null?!0:(k.constructor&&k.constructor.toString())===Object.toString()}function C(N,k){if(typeof k=="string"){for(const[ie,ue]of Object.entries(N))if(k.toLowerCase()===ie.toLowerCase())return ue}}var T=N=>new Proxy(N,{get:(k,ie)=>C(k,ie),has:(k,ie)=>C(k,ie)!==void 0}),M=N=>!!(N&&h(N.constructor)&&N[Symbol.toStringTag]==="FormData"&&h(N.append)&&h(N.getAll)&&h(N.entries)&&h(N[Symbol.iterator])),K=N=>String(N).replace(/\r/g,"%0D").replace(/\n/g,"%0A").replace(/"/g,"%22"),q=N=>!!(N&&typeof N=="object"&&h(N.constructor)&&N[Symbol.toStringTag]==="File"&&h(N.stream)&&N.name!=null),B={enableAdditionalHeaders:!1},H={writable:!1,configurable:!1},Q,se,F,ee,A,J,te,Z,he,ye,ve,W,U=class{constructor(N,k,ie){if(l(this,he),l(this,ve),l(this,Q,`\r
`),l(this,se,void 0),l(this,F,void 0),l(this,ee,"-".repeat(2)),l(this,A,new TextEncoder),l(this,J,void 0),l(this,te,void 0),l(this,Z,void 0),!M(N))throw new TypeError("Expected first argument to be a FormData instance.");let ue;if(P(k)?ie=k:ue=k,ue||(ue=w()),typeof ue!="string")throw new TypeError("Expected boundary argument to be a string.");if(ie&&!P(ie))throw new TypeError("Expected options argument to be an object.");c(this,te,Array.from(N.entries())),c(this,Z,{...B,...ie}),c(this,se,u(this,A).encode(u(this,Q))),c(this,F,u(this,se).byteLength),this.boundary=`form-data-boundary-${ue}`,this.contentType=`multipart/form-data; boundary=${this.boundary}`,c(this,J,u(this,A).encode(`${u(this,ee)}${this.boundary}${u(this,ee)}${u(this,Q).repeat(2)}`));const z={"Content-Type":this.contentType},V=f(this,ve,W).call(this);V&&(this.contentLength=V,z["Content-Length"]=V),this.headers=T(Object.freeze(z)),Object.defineProperties(this,{boundary:H,contentType:H,contentLength:H,headers:H})}*values(){for(const[N,k]of u(this,te)){const ie=q(k)?k:u(this,A).encode(S(k));yield f(this,he,ye).call(this,N,ie),yield ie,yield u(this,se)}yield u(this,J)}async*encode(){for(const N of this.values())q(N)?yield*g(N.stream()):yield*_(N)}[Symbol.iterator](){return this.values()}[Symbol.asyncIterator](){return this.encode()}};return Q=new WeakMap,se=new WeakMap,F=new WeakMap,ee=new WeakMap,A=new WeakMap,J=new WeakMap,te=new WeakMap,Z=new WeakMap,he=new WeakSet,ye=function(N,k){let ie="";if(ie+=`${u(this,ee)}${this.boundary}${u(this,Q)}`,ie+=`Content-Disposition: form-data; name="${K(N)}"`,q(k)&&(ie+=`; filename="${K(k.name)}"${u(this,Q)}`,ie+=`Content-Type: ${k.type||"application/octet-stream"}`),u(this,Z).enableAdditionalHeaders===!0){const ue=q(k)?k.size:k.byteLength;ue!=null&&!isNaN(ue)&&(ie+=`${u(this,Q)}Content-Length: ${ue}`)}return u(this,A).encode(`${ie}${u(this,Q).repeat(2)}`)},ve=new WeakSet,W=function(){let N=0;for(const[k,ie]of u(this,te)){const ue=q(ie)?ie:u(this,A).encode(S(ie)),z=q(ue)?ue.size:ue.byteLength;if(z==null||isNaN(z))return;N+=f(this,he,ye).call(this,k,ue).byteLength,N+=z,N+=u(this,F)}return String(N+u(this,J).byteLength)},VS}var GS,FN;function Use(){return FN||(FN=1,GS=typeof self=="object"?self.FormData:window.FormData),GS}var LN;function Fse(){if(LN)return yt;LN=1;var a=yt&&yt.__createBinding||(Object.create?function(c,f,p,h){h===void 0&&(h=p);var y=Object.getOwnPropertyDescriptor(f,p);(!y||("get"in y?!f.__esModule:y.writable||y.configurable))&&(y={enumerable:!0,get:function(){return f[p]}}),Object.defineProperty(c,h,y)}:function(c,f,p,h){h===void 0&&(h=p),c[h]=f[p]}),e=yt&&yt.__setModuleDefault||(Object.create?function(c,f){Object.defineProperty(c,"default",{enumerable:!0,value:f})}:function(c,f){c.default=f}),t=yt&&yt.__importStar||function(c){if(c&&c.__esModule)return c;var f={};if(c!=null)for(var p in c)p!=="default"&&Object.prototype.hasOwnProperty.call(c,p)&&a(f,c,p);return e(f,c),f},r=yt&&yt.__awaiter||function(c,f,p,h){function y(d){return d instanceof p?d:new p(function(_){_(d)})}return new(p||(p=Promise))(function(d,_){function m(v){try{g(h.next(v))}catch(w){_(w)}}function b(v){try{g(h.throw(v))}catch(w){_(w)}}function g(v){v.done?d(v.value):y(v.value).then(m,b)}g((h=h.apply(c,f||[])).next())})};Object.defineProperty(yt,"__esModule",{value:!0}),yt.WebFormData=yt.Node16FormData=yt.Node18FormData=yt.newFormData=void 0;const n=n_();function i(c){return typeof c=="object"&&c!=null&&"name"in c}function o(){return r(this,void 0,void 0,function*(){let c;return n.RUNTIME.type==="node"&&n.RUNTIME.parsedVersion!=null&&n.RUNTIME.parsedVersion>=18?c=new s:n.RUNTIME.type==="node"?c=new u:c=new l,yield c.setup(),c})}yt.newFormData=o;class s{setup(){return r(this,void 0,void 0,function*(){this.fd=new(yield Promise.resolve().then(()=>t(zse()))).FormData})}append(f,p){var h;(h=this.fd)===null||h===void 0||h.append(f,p)}appendFile(f,p,h){var y,d;return r(this,void 0,void 0,function*(){h==null&&i(p)&&(h=p.name),p instanceof(yield Promise.resolve().then(()=>t(by()))).Readable?(y=this.fd)===null||y===void 0||y.append(f,{type:void 0,name:h,[Symbol.toStringTag]:"File",stream(){return p}}):(d=this.fd)===null||d===void 0||d.append(f,p,h)})}getRequest(){return r(this,void 0,void 0,function*(){const f=new(yield Promise.resolve().then(()=>t(Bse()))).FormDataEncoder(this.fd);return{body:yield(yield Promise.resolve().then(()=>t(by()))).Readable.from(f),headers:f.headers,duplex:"half"}})}}yt.Node18FormData=s;class u{setup(){return r(this,void 0,void 0,function*(){this.fd=new(yield Promise.resolve().then(()=>t(Use()))).default})}append(f,p){var h;(h=this.fd)===null||h===void 0||h.append(f,p)}appendFile(f,p,h){var y,d;return r(this,void 0,void 0,function*(){h==null&&i(p)&&(h=p.name);let _;p instanceof(yield Promise.resolve().then(()=>t(by()))).Readable?_=p:_=Buffer.from(yield p.arrayBuffer()),h==null?(y=this.fd)===null||y===void 0||y.append(f,_):(d=this.fd)===null||d===void 0||d.append(f,_,{filename:h})})}getRequest(){return{body:this.fd,headers:this.fd?this.fd.getHeaders():{}}}}yt.Node16FormData=u;class l{setup(){return r(this,void 0,void 0,function*(){this.fd=new FormData})}append(f,p){var h;(h=this.fd)===null||h===void 0||h.append(f,p)}appendFile(f,p,h){var y;return r(this,void 0,void 0,function*(){h==null&&i(p)&&(h=p.name),(y=this.fd)===null||y===void 0||y.append(f,new Blob([p]),h)})}getRequest(){return{body:this.fd,headers:{}}}}return yt.WebFormData=l,yt}var VN;function Lse(){return VN||(VN=1,function(a){var e=Gl&&Gl.__createBinding||(Object.create?function(r,n,i,o){o===void 0&&(o=i);var s=Object.getOwnPropertyDescriptor(n,i);(!s||("get"in s?!n.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(r,o,s)}:function(r,n,i,o){o===void 0&&(o=i),r[o]=n[i]}),t=Gl&&Gl.__exportStar||function(r,n){for(var i in r)i!=="default"&&!Object.prototype.hasOwnProperty.call(n,i)&&e(n,r,i)};Object.defineProperty(a,"__esModule",{value:!0}),t(Fse(),a)}(Gl)),Gl}var kl={},Hl={},kS={},oh={},sh={},GN;function jt(){return GN||(GN=1,Object.defineProperty(sh,"__esModule",{value:!0}),sh.SchemaType=void 0,sh.SchemaType={BIGINT:"bigint",DATE:"date",ENUM:"enum",LIST:"list",STRING_LITERAL:"stringLiteral",BOOLEAN_LITERAL:"booleanLiteral",OBJECT:"object",ANY:"any",BOOLEAN:"boolean",NUMBER:"number",STRING:"string",UNKNOWN:"unknown",RECORD:"record",SET:"set",UNION:"union",UNDISCRIMINATED_UNION:"undiscriminatedUnion",OPTIONAL:"optional"}),sh}var uh={},kN;function ur(){if(kN)return uh;kN=1,Object.defineProperty(uh,"__esModule",{value:!0}),uh.getErrorMessageForIncorrectType=void 0;function a(t,r){return`Expected ${r}. Received ${e(t)}.`}uh.getErrorMessageForIncorrectType=a;function e(t){if(Array.isArray(t))return"list";if(t===null)return"null";if(t instanceof BigInt)return"BigInt";switch(typeof t){case"string":return`"${t}"`;case"bigint":case"number":case"boolean":case"undefined":return`${t}`}return typeof t}return uh}var lh={},HN;function ju(){if(HN)return lh;HN=1,Object.defineProperty(lh,"__esModule",{value:!0}),lh.maybeSkipValidation=void 0;function a(t){return Object.assign(Object.assign({},t),{json:e(t.json),parse:e(t.parse)})}lh.maybeSkipValidation=a;function e(t){return(r,n)=>{const i=t(r,n),{skipValidation:o=!1}=n??{};return!i.ok&&o?(console.warn(["Failed to validate.",...i.errors.map(s=>"  - "+(s.path.length>0?`${s.path.join(".")}: ${s.message}`:s.message))].join(`
`)),{ok:!0,value:r}):i}}return lh}var HS={},yu={},ch={},fh={},WN;function OG(){if(WN)return fh;WN=1,Object.defineProperty(fh,"__esModule",{value:!0}),fh.stringifyValidationError=void 0;function a(e){return e.path.length===0?e.message:`${e.path.join(" -> ")}: ${e.message}`}return fh.stringifyValidationError=a,fh}var KN;function EG(){if(KN)return ch;KN=1,Object.defineProperty(ch,"__esModule",{value:!0}),ch.JsonError=void 0;const a=OG();let e=class SG extends Error{constructor(r){super(r.map(a.stringifyValidationError).join("; ")),this.errors=r,Object.setPrototypeOf(this,SG.prototype)}};return ch.JsonError=e,ch}var dh={},JN;function CG(){if(JN)return dh;JN=1,Object.defineProperty(dh,"__esModule",{value:!0}),dh.ParseError=void 0;const a=OG();let e=class RG extends Error{constructor(r){super(r.map(a.stringifyValidationError).join("; ")),this.errors=r,Object.setPrototypeOf(this,RG.prototype)}};return dh.ParseError=e,dh}var XN;function Vse(){if(XN)return yu;XN=1,Object.defineProperty(yu,"__esModule",{value:!0}),yu.transform=yu.optional=yu.getSchemaUtils=void 0;const a=jt(),e=EG(),t=CG();function r(o){return{optional:()=>n(o),transform:s=>i(o,s),parseOrThrow:(s,u)=>{const l=o.parse(s,u);if(l.ok)return l.value;throw new t.ParseError(l.errors)},jsonOrThrow:(s,u)=>{const l=o.json(s,u);if(l.ok)return l.value;throw new e.JsonError(l.errors)}}}yu.getSchemaUtils=r;function n(o){const s={parse:(u,l)=>u==null?{ok:!0,value:void 0}:o.parse(u,l),json:(u,l)=>l!=null&&l.omitUndefined&&u===void 0?{ok:!0,value:void 0}:u==null?{ok:!0,value:null}:o.json(u,l),getType:()=>a.SchemaType.OPTIONAL};return Object.assign(Object.assign({},s),r(s))}yu.optional=n;function i(o,s){const u={parse:(l,c)=>{const f=o.parse(l,c);return f.ok?{ok:!0,value:s.transform(f.value)}:f},json:(l,c)=>{const f=s.untransform(l);return o.json(f,c)},getType:()=>o.getType()};return Object.assign(Object.assign({},u),r(u))}return yu.transform=i,yu}var ZN;function Sr(){return ZN||(ZN=1,function(a){Object.defineProperty(a,"__esModule",{value:!0}),a.ParseError=a.JsonError=a.transform=a.optional=a.getSchemaUtils=void 0;var e=Vse();Object.defineProperty(a,"getSchemaUtils",{enumerable:!0,get:function(){return e.getSchemaUtils}}),Object.defineProperty(a,"optional",{enumerable:!0,get:function(){return e.optional}}),Object.defineProperty(a,"transform",{enumerable:!0,get:function(){return e.transform}});var t=EG();Object.defineProperty(a,"JsonError",{enumerable:!0,get:function(){return t.JsonError}});var r=CG();Object.defineProperty(a,"ParseError",{enumerable:!0,get:function(){return r.ParseError}})}(HS)),HS}var QN;function Gse(){if(QN)return oh;QN=1,Object.defineProperty(oh,"__esModule",{value:!0}),oh.bigint=void 0;const a=jt(),e=ur(),t=ju(),r=Sr();function n(){const i={parse:(o,{breadcrumbsPrefix:s=[]}={})=>typeof o!="string"?{ok:!1,errors:[{path:s,message:(0,e.getErrorMessageForIncorrectType)(o,"string")}]}:{ok:!0,value:BigInt(o)},json:(o,{breadcrumbsPrefix:s=[]}={})=>typeof o=="bigint"?{ok:!0,value:o.toString()}:{ok:!1,errors:[{path:s,message:(0,e.getErrorMessageForIncorrectType)(o,"bigint")}]},getType:()=>a.SchemaType.BIGINT};return Object.assign(Object.assign({},(0,t.maybeSkipValidation)(i)),(0,r.getSchemaUtils)(i))}return oh.bigint=n,oh}var YN;function kse(){return YN||(YN=1,function(a){Object.defineProperty(a,"__esModule",{value:!0}),a.bigint=void 0;var e=Gse();Object.defineProperty(a,"bigint",{enumerable:!0,get:function(){return e.bigint}})}(kS)),kS}var WS={},hh={},eq;function Hse(){if(eq)return hh;eq=1,Object.defineProperty(hh,"__esModule",{value:!0}),hh.date=void 0;const a=jt(),e=ur(),t=ju(),r=Sr(),n=/^([+-]?\d{4}(?!\d{2}\b))((-?)((0[1-9]|1[0-2])(\3([12]\d|0[1-9]|3[01]))?|W([0-4]\d|5[0-2])(-?[1-7])?|(00[1-9]|0[1-9]\d|[12]\d{2}|3([0-5]\d|6[1-6])))([T\s]((([01]\d|2[0-3])((:?)[0-5]\d)?|24:?00)([.,]\d+(?!:))?)?(\17[0-5]\d([.,]\d+)?)?([zZ]|([+-])([01]\d|2[0-3]):?([0-5]\d)?)?)?)?$/;function i(){const o={parse:(s,{breadcrumbsPrefix:u=[]}={})=>typeof s!="string"?{ok:!1,errors:[{path:u,message:(0,e.getErrorMessageForIncorrectType)(s,"string")}]}:n.test(s)?{ok:!0,value:new Date(s)}:{ok:!1,errors:[{path:u,message:(0,e.getErrorMessageForIncorrectType)(s,"ISO 8601 date string")}]},json:(s,{breadcrumbsPrefix:u=[]}={})=>s instanceof Date?{ok:!0,value:s.toISOString()}:{ok:!1,errors:[{path:u,message:(0,e.getErrorMessageForIncorrectType)(s,"Date object")}]},getType:()=>a.SchemaType.DATE};return Object.assign(Object.assign({},(0,t.maybeSkipValidation)(o)),(0,r.getSchemaUtils)(o))}return hh.date=i,hh}var tq;function Wse(){return tq||(tq=1,function(a){Object.defineProperty(a,"__esModule",{value:!0}),a.date=void 0;var e=Hse();Object.defineProperty(a,"date",{enumerable:!0,get:function(){return e.date}})}(WS)),WS}var KS={},ph={},_h={},rq;function il(){if(rq)return _h;rq=1,Object.defineProperty(_h,"__esModule",{value:!0}),_h.createIdentitySchemaCreator=void 0;const a=Sr(),e=ju();function t(r,n){return()=>{const i={parse:n,json:n,getType:()=>r};return Object.assign(Object.assign({},(0,e.maybeSkipValidation)(i)),(0,a.getSchemaUtils)(i))}}return _h.createIdentitySchemaCreator=t,_h}var nq;function Kse(){if(nq)return ph;nq=1,Object.defineProperty(ph,"__esModule",{value:!0}),ph.enum_=void 0;const a=jt(),e=il(),t=ur();function r(n){const i=new Set(n);return(0,e.createIdentitySchemaCreator)(a.SchemaType.ENUM,(s,{allowUnrecognizedEnumValues:u,breadcrumbsPrefix:l=[]}={})=>typeof s!="string"?{ok:!1,errors:[{path:l,message:(0,t.getErrorMessageForIncorrectType)(s,"string")}]}:!i.has(s)&&!u?{ok:!1,errors:[{path:l,message:(0,t.getErrorMessageForIncorrectType)(s,"enum")}]}:{ok:!0,value:s})()}return ph.enum_=r,ph}var iq;function PG(){return iq||(iq=1,function(a){Object.defineProperty(a,"__esModule",{value:!0}),a.enum_=void 0;var e=Kse();Object.defineProperty(a,"enum_",{enumerable:!0,get:function(){return e.enum_}})}(KS)),KS}var JS={},bu={},aq;function jG(){if(aq)return bu;aq=1,Object.defineProperty(bu,"__esModule",{value:!0}),bu.getMemoizedSchema=bu.constructLazyBaseSchema=bu.lazy=void 0;const a=Sr();function e(n){const i=t(n);return Object.assign(Object.assign({},i),(0,a.getSchemaUtils)(i))}bu.lazy=e;function t(n){return{parse:(i,o)=>r(n).parse(i,o),json:(i,o)=>r(n).json(i,o),getType:()=>r(n).getType()}}bu.constructLazyBaseSchema=t;function r(n){const i=n;return i.__zurg_memoized==null&&(i.__zurg_memoized=n()),i.__zurg_memoized}return bu.getMemoizedSchema=r,bu}var yh={},XS={},Wl={},bh={},oq;function TG(){if(oq)return bh;oq=1,Object.defineProperty(bh,"__esModule",{value:!0}),bh.entries=void 0;function a(e){return Object.entries(e)}return bh.entries=a,bh}var mh={},sq;function MG(){if(sq)return mh;sq=1,Object.defineProperty(mh,"__esModule",{value:!0}),mh.filterObject=void 0;function a(e,t){const r=new Set(t);return Object.entries(e).reduce((n,[i,o])=>(r.has(i)&&(n[i]=o),n),{})}return mh.filterObject=a,mh}var gh={},uq;function zb(){if(uq)return gh;uq=1,Object.defineProperty(gh,"__esModule",{value:!0}),gh.isPlainObject=void 0;function a(e){if(typeof e!="object"||e===null)return!1;if(Object.getPrototypeOf(e)===null)return!0;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}return gh.isPlainObject=a,gh}var vh={},lq;function AG(){if(lq)return vh;lq=1,Object.defineProperty(vh,"__esModule",{value:!0}),vh.keys=void 0;function a(e){return Object.keys(e)}return vh.keys=a,vh}var wh={},cq;function Jse(){if(cq)return wh;cq=1,Object.defineProperty(wh,"__esModule",{value:!0}),wh.partition=void 0;function a(e,t){const r=[],n=[];for(const i of e)t(i)?r.push(i):n.push(i);return[r,n]}return wh.partition=a,wh}var ZS={},Kl={},fq;function Xse(){if(fq)return Kl;fq=1,Object.defineProperty(Kl,"__esModule",{value:!0}),Kl.withParsedProperties=Kl.getObjectLikeUtils=void 0;const a=MG(),e=ur(),t=zb(),r=Sr();function n(o){return{withParsedProperties:s=>i(o,s)}}Kl.getObjectLikeUtils=n;function i(o,s){const u={parse:(l,c)=>{const f=o.parse(l,c);if(!f.ok)return f;const p=Object.entries(s).reduce((h,[y,d])=>Object.assign(Object.assign({},h),{[y]:typeof d=="function"?d(f.value):d}),{});return{ok:!0,value:Object.assign(Object.assign({},f.value),p)}},json:(l,c)=>{var f;if(!(0,t.isPlainObject)(l))return{ok:!1,errors:[{path:(f=c==null?void 0:c.breadcrumbsPrefix)!==null&&f!==void 0?f:[],message:(0,e.getErrorMessageForIncorrectType)(l,"object")}]};const p=new Set(Object.keys(s)),h=(0,a.filterObject)(l,Object.keys(l).filter(y=>!p.has(y)));return o.json(h,c)},getType:()=>o.getType()};return Object.assign(Object.assign(Object.assign({},u),(0,r.getSchemaUtils)(u)),n(u))}return Kl.withParsedProperties=i,Kl}var dq;function Bb(){return dq||(dq=1,function(a){Object.defineProperty(a,"__esModule",{value:!0}),a.withParsedProperties=a.getObjectLikeUtils=void 0;var e=Xse();Object.defineProperty(a,"getObjectLikeUtils",{enumerable:!0,get:function(){return e.getObjectLikeUtils}}),Object.defineProperty(a,"withParsedProperties",{enumerable:!0,get:function(){return e.withParsedProperties}})}(ZS)),ZS}var Jl={},hq;function IG(){if(hq)return Jl;hq=1,Object.defineProperty(Jl,"__esModule",{value:!0}),Jl.isProperty=Jl.property=void 0;function a(t,r){return{rawKey:t,valueSchema:r,isProperty:!0}}Jl.property=a;function e(t){return t.isProperty}return Jl.isProperty=e,Jl}var pq;function DG(){if(pq)return Wl;pq=1,Object.defineProperty(Wl,"__esModule",{value:!0}),Wl.getObjectUtils=Wl.object=void 0;const a=jt(),e=TG(),t=MG(),r=ur(),n=zb(),i=AG(),o=ju(),s=Jse(),u=Bb(),l=Sr(),c=IG();function f(m){const b={_getRawProperties:()=>Object.entries(m).map(([g,v])=>(0,c.isProperty)(v)?v.rawKey:g),_getParsedProperties:()=>(0,i.keys)(m),parse:(g,v)=>{const w={},S=[];for(const[R,P]of(0,e.entries)(m)){const C=(0,c.isProperty)(P)?P.rawKey:R,T=(0,c.isProperty)(P)?P.valueSchema:P,M={rawKey:C,parsedKey:R,valueSchema:T};w[C]=M,d(T)&&S.push(C)}return p({value:g,requiredKeys:S,getProperty:R=>{const P=w[R];if(P!=null)return{transformedKey:P.parsedKey,transform:C=>{var T;return P.valueSchema.parse(C,Object.assign(Object.assign({},v),{breadcrumbsPrefix:[...(T=v==null?void 0:v.breadcrumbsPrefix)!==null&&T!==void 0?T:[],R]}))}}},unrecognizedObjectKeys:v==null?void 0:v.unrecognizedObjectKeys,skipValidation:v==null?void 0:v.skipValidation,breadcrumbsPrefix:v==null?void 0:v.breadcrumbsPrefix,omitUndefined:v==null?void 0:v.omitUndefined})},json:(g,v)=>{const w=[];for(const[S,R]of(0,e.entries)(m)){const P=(0,c.isProperty)(R)?R.valueSchema:R;d(P)&&w.push(S)}return p({value:g,requiredKeys:w,getProperty:S=>{const R=m[S];if(R!=null)return(0,c.isProperty)(R)?{transformedKey:R.rawKey,transform:P=>{var C;return R.valueSchema.json(P,Object.assign(Object.assign({},v),{breadcrumbsPrefix:[...(C=v==null?void 0:v.breadcrumbsPrefix)!==null&&C!==void 0?C:[],S]}))}}:{transformedKey:S,transform:P=>{var C;return R.json(P,Object.assign(Object.assign({},v),{breadcrumbsPrefix:[...(C=v==null?void 0:v.breadcrumbsPrefix)!==null&&C!==void 0?C:[],S]}))}}},unrecognizedObjectKeys:v==null?void 0:v.unrecognizedObjectKeys,skipValidation:v==null?void 0:v.skipValidation,breadcrumbsPrefix:v==null?void 0:v.breadcrumbsPrefix,omitUndefined:v==null?void 0:v.omitUndefined})},getType:()=>a.SchemaType.OBJECT};return Object.assign(Object.assign(Object.assign(Object.assign({},(0,o.maybeSkipValidation)(b)),(0,l.getSchemaUtils)(b)),(0,u.getObjectLikeUtils)(b)),h(b))}Wl.object=f;function p({value:m,requiredKeys:b,getProperty:g,unrecognizedObjectKeys:v="fail",skipValidation:w=!1,breadcrumbsPrefix:S=[]}){if(!(0,n.isPlainObject)(m))return{ok:!1,errors:[{path:S,message:(0,r.getErrorMessageForIncorrectType)(m,"object")}]};const R=new Set(b),P=[],C={};for(const[T,M]of Object.entries(m)){const K=g(T);if(K!=null){R.delete(T);const q=K.transform(M);q.ok?C[K.transformedKey]=q.value:(C[T]=M,P.push(...q.errors))}else switch(v){case"fail":P.push({path:[...S,T],message:`Unexpected key "${T}"`});break;case"strip":break;case"passthrough":C[T]=M;break}}return P.push(...b.filter(T=>R.has(T)).map(T=>({path:S,message:`Missing required key "${T}"`}))),P.length===0||w?{ok:!0,value:C}:{ok:!1,errors:P}}function h(m){return{extend:b=>{const g={_getParsedProperties:()=>[...m._getParsedProperties(),...b._getParsedProperties()],_getRawProperties:()=>[...m._getRawProperties(),...b._getRawProperties()],parse:(v,w)=>y({extensionKeys:b._getRawProperties(),value:v,transformBase:S=>m.parse(S,w),transformExtension:S=>b.parse(S,w)}),json:(v,w)=>y({extensionKeys:b._getParsedProperties(),value:v,transformBase:S=>m.json(S,w),transformExtension:S=>b.json(S,w)}),getType:()=>a.SchemaType.OBJECT};return Object.assign(Object.assign(Object.assign(Object.assign({},g),(0,l.getSchemaUtils)(g)),(0,u.getObjectLikeUtils)(g)),h(g))},passthrough:()=>{const b={_getParsedProperties:()=>m._getParsedProperties(),_getRawProperties:()=>m._getRawProperties(),parse:(g,v)=>{const w=m.parse(g,Object.assign(Object.assign({},v),{unrecognizedObjectKeys:"passthrough"}));return w.ok?{ok:!0,value:Object.assign(Object.assign({},g),w.value)}:w},json:(g,v)=>{const w=m.json(g,Object.assign(Object.assign({},v),{unrecognizedObjectKeys:"passthrough"}));return w.ok?{ok:!0,value:Object.assign(Object.assign({},g),w.value)}:w},getType:()=>a.SchemaType.OBJECT};return Object.assign(Object.assign(Object.assign(Object.assign({},b),(0,l.getSchemaUtils)(b)),(0,u.getObjectLikeUtils)(b)),h(b))}}}Wl.getObjectUtils=h;function y({extensionKeys:m,value:b,transformBase:g,transformExtension:v}){const w=new Set(m),[S,R]=(0,s.partition)((0,i.keys)(b),T=>w.has(T)),P=g((0,t.filterObject)(b,R)),C=v((0,t.filterObject)(b,S));return P.ok&&C.ok?{ok:!0,value:Object.assign(Object.assign({},P.value),C.value)}:{ok:!1,errors:[...P.ok?[]:P.errors,...C.ok?[]:C.errors]}}function d(m){return!_(m)}function _(m){switch(m.getType()){case a.SchemaType.ANY:case a.SchemaType.UNKNOWN:case a.SchemaType.OPTIONAL:return!0;default:return!1}}return Wl}var Oh={},_q;function Zse(){if(_q)return Oh;_q=1,Object.defineProperty(Oh,"__esModule",{value:!0}),Oh.objectWithoutOptionalProperties=void 0;const a=DG();function e(t){return(0,a.object)(t)}return Oh.objectWithoutOptionalProperties=e,Oh}var yq;function xG(){return yq||(yq=1,function(a){Object.defineProperty(a,"__esModule",{value:!0}),a.property=a.isProperty=a.objectWithoutOptionalProperties=a.object=a.getObjectUtils=void 0;var e=DG();Object.defineProperty(a,"getObjectUtils",{enumerable:!0,get:function(){return e.getObjectUtils}}),Object.defineProperty(a,"object",{enumerable:!0,get:function(){return e.object}});var t=Zse();Object.defineProperty(a,"objectWithoutOptionalProperties",{enumerable:!0,get:function(){return t.objectWithoutOptionalProperties}});var r=IG();Object.defineProperty(a,"isProperty",{enumerable:!0,get:function(){return r.isProperty}}),Object.defineProperty(a,"property",{enumerable:!0,get:function(){return r.property}})}(XS)),XS}var bq;function Qse(){if(bq)return yh;bq=1,Object.defineProperty(yh,"__esModule",{value:!0}),yh.lazyObject=void 0;const a=xG(),e=Bb(),t=Sr(),r=jG();function n(i){const o=Object.assign(Object.assign({},(0,r.constructLazyBaseSchema)(i)),{_getRawProperties:()=>(0,r.getMemoizedSchema)(i)._getRawProperties(),_getParsedProperties:()=>(0,r.getMemoizedSchema)(i)._getParsedProperties()});return Object.assign(Object.assign(Object.assign(Object.assign({},o),(0,t.getSchemaUtils)(o)),(0,e.getObjectLikeUtils)(o)),(0,a.getObjectUtils)(o))}return yh.lazyObject=n,yh}var mq;function Yse(){return mq||(mq=1,function(a){Object.defineProperty(a,"__esModule",{value:!0}),a.lazyObject=a.lazy=void 0;var e=jG();Object.defineProperty(a,"lazy",{enumerable:!0,get:function(){return e.lazy}});var t=Qse();Object.defineProperty(a,"lazyObject",{enumerable:!0,get:function(){return t.lazyObject}})}(JS)),JS}var QS={},Sh={},gq;function eue(){if(gq)return Sh;gq=1,Object.defineProperty(Sh,"__esModule",{value:!0}),Sh.list=void 0;const a=jt(),e=ur(),t=ju(),r=Sr();function n(o){const s={parse:(u,l)=>i(u,(c,f)=>{var p;return o.parse(c,Object.assign(Object.assign({},l),{breadcrumbsPrefix:[...(p=l==null?void 0:l.breadcrumbsPrefix)!==null&&p!==void 0?p:[],`[${f}]`]}))}),json:(u,l)=>i(u,(c,f)=>{var p;return o.json(c,Object.assign(Object.assign({},l),{breadcrumbsPrefix:[...(p=l==null?void 0:l.breadcrumbsPrefix)!==null&&p!==void 0?p:[],`[${f}]`]}))}),getType:()=>a.SchemaType.LIST};return Object.assign(Object.assign({},(0,t.maybeSkipValidation)(s)),(0,r.getSchemaUtils)(s))}Sh.list=n;function i(o,s){return Array.isArray(o)?o.map((l,c)=>s(l,c)).reduce((l,c)=>{if(l.ok&&c.ok)return{ok:!0,value:[...l.value,c.value]};const f=[];return l.ok||f.push(...l.errors),c.ok||f.push(...c.errors),{ok:!1,errors:f}},{ok:!0,value:[]}):{ok:!1,errors:[{message:(0,e.getErrorMessageForIncorrectType)(o,"list"),path:[]}]}}return Sh}var vq;function $G(){return vq||(vq=1,function(a){Object.defineProperty(a,"__esModule",{value:!0}),a.list=void 0;var e=eue();Object.defineProperty(a,"list",{enumerable:!0,get:function(){return e.list}})}(QS)),QS}var YS={},Eh={},wq;function tue(){if(wq)return Eh;wq=1,Object.defineProperty(Eh,"__esModule",{value:!0}),Eh.stringLiteral=void 0;const a=jt(),e=il(),t=ur();function r(n){return(0,e.createIdentitySchemaCreator)(a.SchemaType.STRING_LITERAL,(o,{breadcrumbsPrefix:s=[]}={})=>o===n?{ok:!0,value:n}:{ok:!1,errors:[{path:s,message:(0,t.getErrorMessageForIncorrectType)(o,`"${n}"`)}]})()}return Eh.stringLiteral=r,Eh}var Rh={},Oq;function rue(){if(Oq)return Rh;Oq=1,Object.defineProperty(Rh,"__esModule",{value:!0}),Rh.booleanLiteral=void 0;const a=jt(),e=il(),t=ur();function r(n){return(0,e.createIdentitySchemaCreator)(a.SchemaType.BOOLEAN_LITERAL,(o,{breadcrumbsPrefix:s=[]}={})=>o===n?{ok:!0,value:n}:{ok:!1,errors:[{path:s,message:(0,t.getErrorMessageForIncorrectType)(o,`${n.toString()}`)}]})()}return Rh.booleanLiteral=r,Rh}var Sq;function nue(){return Sq||(Sq=1,function(a){Object.defineProperty(a,"__esModule",{value:!0}),a.booleanLiteral=a.stringLiteral=void 0;var e=tue();Object.defineProperty(a,"stringLiteral",{enumerable:!0,get:function(){return e.stringLiteral}});var t=rue();Object.defineProperty(a,"booleanLiteral",{enumerable:!0,get:function(){return t.booleanLiteral}})}(YS)),YS}var eE={},Ch={},Eq;function iue(){if(Eq)return Ch;Eq=1,Object.defineProperty(Ch,"__esModule",{value:!0}),Ch.any=void 0;const a=jt(),e=il();return Ch.any=(0,e.createIdentitySchemaCreator)(a.SchemaType.ANY,t=>({ok:!0,value:t})),Ch}var Ph={},Rq;function aue(){if(Rq)return Ph;Rq=1,Object.defineProperty(Ph,"__esModule",{value:!0}),Ph.boolean=void 0;const a=jt(),e=il(),t=ur();return Ph.boolean=(0,e.createIdentitySchemaCreator)(a.SchemaType.BOOLEAN,(r,{breadcrumbsPrefix:n=[]}={})=>typeof r=="boolean"?{ok:!0,value:r}:{ok:!1,errors:[{path:n,message:(0,t.getErrorMessageForIncorrectType)(r,"boolean")}]}),Ph}var jh={},Cq;function oue(){if(Cq)return jh;Cq=1,Object.defineProperty(jh,"__esModule",{value:!0}),jh.number=void 0;const a=jt(),e=il(),t=ur();return jh.number=(0,e.createIdentitySchemaCreator)(a.SchemaType.NUMBER,(r,{breadcrumbsPrefix:n=[]}={})=>typeof r=="number"?{ok:!0,value:r}:{ok:!1,errors:[{path:n,message:(0,t.getErrorMessageForIncorrectType)(r,"number")}]}),jh}var Th={},Pq;function sue(){if(Pq)return Th;Pq=1,Object.defineProperty(Th,"__esModule",{value:!0}),Th.string=void 0;const a=jt(),e=il(),t=ur();return Th.string=(0,e.createIdentitySchemaCreator)(a.SchemaType.STRING,(r,{breadcrumbsPrefix:n=[]}={})=>typeof r=="string"?{ok:!0,value:r}:{ok:!1,errors:[{path:n,message:(0,t.getErrorMessageForIncorrectType)(r,"string")}]}),Th}var Mh={},jq;function uue(){if(jq)return Mh;jq=1,Object.defineProperty(Mh,"__esModule",{value:!0}),Mh.unknown=void 0;const a=jt(),e=il();return Mh.unknown=(0,e.createIdentitySchemaCreator)(a.SchemaType.UNKNOWN,t=>({ok:!0,value:t})),Mh}var Tq;function lue(){return Tq||(Tq=1,function(a){Object.defineProperty(a,"__esModule",{value:!0}),a.unknown=a.string=a.number=a.boolean=a.any=void 0;var e=iue();Object.defineProperty(a,"any",{enumerable:!0,get:function(){return e.any}});var t=aue();Object.defineProperty(a,"boolean",{enumerable:!0,get:function(){return t.boolean}});var r=oue();Object.defineProperty(a,"number",{enumerable:!0,get:function(){return r.number}});var n=sue();Object.defineProperty(a,"string",{enumerable:!0,get:function(){return n.string}});var i=uue();Object.defineProperty(a,"unknown",{enumerable:!0,get:function(){return i.unknown}})}(eE)),eE}var tE={},Ah={},Mq;function cue(){if(Mq)return Ah;Mq=1,Object.defineProperty(Ah,"__esModule",{value:!0}),Ah.record=void 0;const a=jt(),e=TG(),t=ur(),r=zb(),n=ju(),i=Sr();function o(u,l){const c={parse:(f,p)=>s({value:f,isKeyNumeric:u.getType()===a.SchemaType.NUMBER,transformKey:h=>{var y;return u.parse(h,Object.assign(Object.assign({},p),{breadcrumbsPrefix:[...(y=p==null?void 0:p.breadcrumbsPrefix)!==null&&y!==void 0?y:[],`${h} (key)`]}))},transformValue:(h,y)=>{var d;return l.parse(h,Object.assign(Object.assign({},p),{breadcrumbsPrefix:[...(d=p==null?void 0:p.breadcrumbsPrefix)!==null&&d!==void 0?d:[],`${y}`]}))},breadcrumbsPrefix:p==null?void 0:p.breadcrumbsPrefix}),json:(f,p)=>s({value:f,isKeyNumeric:u.getType()===a.SchemaType.NUMBER,transformKey:h=>{var y;return u.json(h,Object.assign(Object.assign({},p),{breadcrumbsPrefix:[...(y=p==null?void 0:p.breadcrumbsPrefix)!==null&&y!==void 0?y:[],`${h} (key)`]}))},transformValue:(h,y)=>{var d;return l.json(h,Object.assign(Object.assign({},p),{breadcrumbsPrefix:[...(d=p==null?void 0:p.breadcrumbsPrefix)!==null&&d!==void 0?d:[],`${y}`]}))},breadcrumbsPrefix:p==null?void 0:p.breadcrumbsPrefix}),getType:()=>a.SchemaType.RECORD};return Object.assign(Object.assign({},(0,n.maybeSkipValidation)(c)),(0,i.getSchemaUtils)(c))}Ah.record=o;function s({value:u,isKeyNumeric:l,transformKey:c,transformValue:f,breadcrumbsPrefix:p=[]}){return(0,r.isPlainObject)(u)?(0,e.entries)(u).reduce((h,[y,d])=>{if(d==null)return h;const _=h;let m=y;if(l){const w=y.length>0?Number(y):NaN;isNaN(w)||(m=w)}const b=c(m),g=f(d,m);if(_.ok&&b.ok&&g.ok)return{ok:!0,value:Object.assign(Object.assign({},_.value),{[b.value]:g.value})};const v=[];return _.ok||v.push(..._.errors),b.ok||v.push(...b.errors),g.ok||v.push(...g.errors),{ok:!1,errors:v}},{ok:!0,value:{}}):{ok:!1,errors:[{path:p,message:(0,t.getErrorMessageForIncorrectType)(u,"object")}]}}return Ah}var Aq;function fue(){return Aq||(Aq=1,function(a){Object.defineProperty(a,"__esModule",{value:!0}),a.record=void 0;var e=cue();Object.defineProperty(a,"record",{enumerable:!0,get:function(){return e.record}})}(tE)),tE}var rE={},Ih={},Iq;function due(){if(Iq)return Ih;Iq=1,Object.defineProperty(Ih,"__esModule",{value:!0}),Ih.set=void 0;const a=jt(),e=ur(),t=ju(),r=$G(),n=Sr();function i(o){const s=(0,r.list)(o),u={parse:(l,c)=>{const f=s.parse(l,c);return f.ok?{ok:!0,value:new Set(f.value)}:f},json:(l,c)=>{var f;return l instanceof Set?s.json([...l],c):{ok:!1,errors:[{path:(f=c==null?void 0:c.breadcrumbsPrefix)!==null&&f!==void 0?f:[],message:(0,e.getErrorMessageForIncorrectType)(l,"Set")}]}},getType:()=>a.SchemaType.SET};return Object.assign(Object.assign({},(0,t.maybeSkipValidation)(u)),(0,n.getSchemaUtils)(u))}return Ih.set=i,Ih}var Dq;function hue(){return Dq||(Dq=1,function(a){Object.defineProperty(a,"__esModule",{value:!0}),a.set=void 0;var e=due();Object.defineProperty(a,"set",{enumerable:!0,get:function(){return e.set}})}(rE)),rE}var nE={},Dh={},xq;function pue(){if(xq)return Dh;xq=1,Object.defineProperty(Dh,"__esModule",{value:!0}),Dh.undiscriminatedUnion=void 0;const a=jt(),e=ju(),t=Sr();function r(i){const o={parse:(s,u)=>n((l,c)=>l.parse(s,c),i,u),json:(s,u)=>n((l,c)=>l.json(s,c),i,u),getType:()=>a.SchemaType.UNDISCRIMINATED_UNION};return Object.assign(Object.assign({},(0,e.maybeSkipValidation)(o)),(0,t.getSchemaUtils)(o))}Dh.undiscriminatedUnion=r;function n(i,o,s){const u=[];for(const[l,c]of o.entries()){const f=i(c,Object.assign(Object.assign({},s),{skipValidation:!1}));if(f.ok)return f;for(const p of f.errors)u.push({path:p.path,message:`[Variant ${l}] ${p.message}`})}return{ok:!1,errors:u}}return Dh}var $q;function _ue(){return $q||($q=1,function(a){Object.defineProperty(a,"__esModule",{value:!0}),a.undiscriminatedUnion=void 0;var e=pue();Object.defineProperty(a,"undiscriminatedUnion",{enumerable:!0,get:function(){return e.undiscriminatedUnion}})}(nE)),nE}var iE={},xh={},Nq;function yue(){if(Nq)return xh;Nq=1,Object.defineProperty(xh,"__esModule",{value:!0}),xh.discriminant=void 0;function a(e,t){return{parsedDiscriminant:e,rawDiscriminant:t}}return xh.discriminant=a,xh}var Xl={},qq;function bue(){if(qq)return Xl;qq=1;var a=Xl&&Xl.__rest||function(f,p){var h={};for(var y in f)Object.prototype.hasOwnProperty.call(f,y)&&p.indexOf(y)<0&&(h[y]=f[y]);if(f!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,y=Object.getOwnPropertySymbols(f);d<y.length;d++)p.indexOf(y[d])<0&&Object.prototype.propertyIsEnumerable.call(f,y[d])&&(h[y[d]]=f[y[d]]);return h};Object.defineProperty(Xl,"__esModule",{value:!0}),Xl.union=void 0;const e=jt(),t=ur(),r=zb(),n=AG(),i=ju(),o=PG(),s=Bb(),u=Sr();function l(f,p){const h=typeof f=="string"?f:f.rawDiscriminant,y=typeof f=="string"?f:f.parsedDiscriminant,d=(0,o.enum_)((0,n.keys)(p)),_={parse:(m,b)=>c({value:m,discriminant:h,transformedDiscriminant:y,transformDiscriminantValue:g=>{var v;return d.parse(g,{allowUnrecognizedEnumValues:b==null?void 0:b.allowUnrecognizedUnionMembers,breadcrumbsPrefix:[...(v=b==null?void 0:b.breadcrumbsPrefix)!==null&&v!==void 0?v:[],h]})},getAdditionalPropertiesSchema:g=>p[g],allowUnrecognizedUnionMembers:b==null?void 0:b.allowUnrecognizedUnionMembers,transformAdditionalProperties:(g,v)=>v.parse(g,b),breadcrumbsPrefix:b==null?void 0:b.breadcrumbsPrefix}),json:(m,b)=>c({value:m,discriminant:y,transformedDiscriminant:h,transformDiscriminantValue:g=>{var v;return d.json(g,{allowUnrecognizedEnumValues:b==null?void 0:b.allowUnrecognizedUnionMembers,breadcrumbsPrefix:[...(v=b==null?void 0:b.breadcrumbsPrefix)!==null&&v!==void 0?v:[],y]})},getAdditionalPropertiesSchema:g=>p[g],allowUnrecognizedUnionMembers:b==null?void 0:b.allowUnrecognizedUnionMembers,transformAdditionalProperties:(g,v)=>v.json(g,b),breadcrumbsPrefix:b==null?void 0:b.breadcrumbsPrefix}),getType:()=>e.SchemaType.UNION};return Object.assign(Object.assign(Object.assign({},(0,i.maybeSkipValidation)(_)),(0,u.getSchemaUtils)(_)),(0,s.getObjectLikeUtils)(_))}Xl.union=l;function c({value:f,discriminant:p,transformedDiscriminant:h,transformDiscriminantValue:y,getAdditionalPropertiesSchema:d,allowUnrecognizedUnionMembers:_=!1,transformAdditionalProperties:m,breadcrumbsPrefix:b=[]}){if(!(0,r.isPlainObject)(f))return{ok:!1,errors:[{path:b,message:(0,t.getErrorMessageForIncorrectType)(f,"object")}]};const g=f,v=p,w=g[v],S=a(g,[typeof v=="symbol"?v:v+""]);if(w==null)return{ok:!1,errors:[{path:b,message:`Missing discriminant ("${p}")`}]};const R=y(w);if(!R.ok)return{ok:!1,errors:R.errors};const P=d(R.value);if(P==null)return _?{ok:!0,value:Object.assign({[h]:R.value},S)}:{ok:!1,errors:[{path:[...b,p],message:"Unexpected discriminant value"}]};const C=m(S,P);return C.ok?{ok:!0,value:Object.assign({[h]:w},C.value)}:C}return Xl}var zq;function mue(){return zq||(zq=1,function(a){Object.defineProperty(a,"__esModule",{value:!0}),a.union=a.discriminant=void 0;var e=yue();Object.defineProperty(a,"discriminant",{enumerable:!0,get:function(){return e.discriminant}});var t=bue();Object.defineProperty(a,"union",{enumerable:!0,get:function(){return t.union}})}(iE)),iE}var Bq;function gue(){return Bq||(Bq=1,function(a){var e=Hl&&Hl.__createBinding||(Object.create?function(r,n,i,o){o===void 0&&(o=i);var s=Object.getOwnPropertyDescriptor(n,i);(!s||("get"in s?!n.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(r,o,s)}:function(r,n,i,o){o===void 0&&(o=i),r[o]=n[i]}),t=Hl&&Hl.__exportStar||function(r,n){for(var i in r)i!=="default"&&!Object.prototype.hasOwnProperty.call(n,i)&&e(n,r,i)};Object.defineProperty(a,"__esModule",{value:!0}),t(kse(),a),t(Wse(),a),t(PG(),a),t(Yse(),a),t($G(),a),t(nue(),a),t(xG(),a),t(Bb(),a),t(lue(),a),t(fue(),a),t(Sr(),a),t(hue(),a),t(_ue(),a),t(mue(),a)}(Hl)),Hl}var Uq;function vue(){return Uq||(Uq=1,function(a){var e=kl&&kl.__createBinding||(Object.create?function(r,n,i,o){o===void 0&&(o=i);var s=Object.getOwnPropertyDescriptor(n,i);(!s||("get"in s?!n.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(r,o,s)}:function(r,n,i,o){o===void 0&&(o=i),r[o]=n[i]}),t=kl&&kl.__exportStar||function(r,n){for(var i in r)i!=="default"&&!Object.prototype.hasOwnProperty.call(n,i)&&e(n,r,i)};Object.defineProperty(a,"__esModule",{value:!0}),t(gue(),a)}(kl)),kl}var Fq;function $(){return Fq||(Fq=1,function(a){var e=rn&&rn.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),t=rn&&rn.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),r=rn&&rn.__exportStar||function(i,o){for(var s in i)s!=="default"&&!Object.prototype.hasOwnProperty.call(o,s)&&e(o,i,s)},n=rn&&rn.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&e(o,i,s);return t(o,i),o};Object.defineProperty(a,"__esModule",{value:!0}),a.serialization=void 0,r(Ase(),a),r(Nse(),a),r(qse(),a),r(n_(),a),r(Lse(),a),a.serialization=n(vue())}(rn)),rn}var ft={},Lq;function wue(){if(Lq)return ft;Lq=1;var a=ft&&ft.__awaiter||function(y,d,_,m){function b(g){return g instanceof _?g:new _(function(v){v(g)})}return new(_||(_=Promise))(function(g,v){function w(P){try{R(m.next(P))}catch(C){v(C)}}function S(P){try{R(m.throw(P))}catch(C){v(C)}}function R(P){P.done?g(P.value):b(P.value).then(w,S)}R((m=m.apply(y,d||[])).next())})},e=ft&&ft.__asyncValues||function(y){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var d=y[Symbol.asyncIterator],_;return d?d.call(y):(y=typeof __values=="function"?__values(y):y[Symbol.iterator](),_={},m("next"),m("throw"),m("return"),_[Symbol.asyncIterator]=function(){return this},_);function m(g){_[g]=y[g]&&function(v){return new Promise(function(w,S){v=y[g](v),b(w,S,v.done,v.value)})}}function b(g,v,w,S){Promise.resolve(S).then(function(R){g({value:R,done:w})},v)}},t=ft&&ft.__await||function(y){return this instanceof t?(this.v=y,this):new t(y)},r=ft&&ft.__asyncGenerator||function(y,d,_){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var m=_.apply(y,d||[]),b,g=[];return b={},v("next"),v("throw"),v("return"),b[Symbol.asyncIterator]=function(){return this},b;function v(T){m[T]&&(b[T]=function(M){return new Promise(function(K,q){g.push([T,M,K,q])>1||w(T,M)})})}function w(T,M){try{S(m[T](M))}catch(K){C(g[0][3],K)}}function S(T){T.value instanceof t?Promise.resolve(T.value.v).then(R,P):C(g[0][2],T)}function R(T){w("next",T)}function P(T){w("throw",T)}function C(T,M){T(M),g.shift(),g.length&&w(g[0][0],g[0][1])}};Object.defineProperty(ft,"__esModule",{value:!0}),ft.readableStreamAsyncIterable=ft._decodeChunks=ft.LineDecoder=ft._iterSSEMessages=ft.StreamUtils=void 0;const n=dt();class i{constructor(d,_){this.iterator=d,this.controller=_}static fromSSEResponse(d,_){let m=!1;function b(){return r(this,arguments,function*(){var v,w;if(m)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");m=!0;let S=!1;try{try{for(var R=e(o(d,_)),P;P=yield t(R.next()),!P.done;){const C=P.value;if(!S){if(C.data.startsWith("[DONE]")){S=!0;continue}if(C.event===null){let T;try{T=JSON.parse(C.data)}catch(M){throw console.error("Could not parse message into JSON:",C.data),console.error("From chunk:",C.raw),M}if(T&&T.error)throw new n.CohereError({message:`Error: ${T.error}`});yield yield t(T)}else{let T;try{T=JSON.parse(C.data)}catch(M){throw console.error("Could not parse message into JSON:",C.data),console.error("From chunk:",C.raw),M}if(C.event=="error")throw new n.CohereError({message:`Error: ${T.message}, ${T.error}`});yield yield t({event:C.event,data:T})}}}}catch(C){v={error:C}}finally{try{P&&!P.done&&(w=R.return)&&(yield t(w.call(R)))}finally{if(v)throw v.error}}S=!0}catch(C){if(C instanceof Error&&C.name==="AbortError")return yield t(void 0);throw C}finally{S||_==null||_.abort()}})}return new i(b,_)}static fromReadableStream(d,_){let m=!1;function b(){return r(this,arguments,function*(){var w,S;const R=new c,P=h(d);try{for(var C=e(P),T;T=yield t(C.next()),!T.done;){const M=T.value;for(const K of R.decode(M))yield yield t(K)}}catch(M){w={error:M}}finally{try{T&&!T.done&&(S=C.return)&&(yield t(S.call(C)))}finally{if(w)throw w.error}}for(const M of R.flush())yield yield t(M)})}function g(){return r(this,arguments,function*(){var w,S;if(m)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");m=!0;let R=!1;try{try{for(var P=e(b()),C;C=yield t(P.next()),!C.done;){const T=C.value;R||T&&(yield yield t(JSON.parse(T)))}}catch(T){w={error:T}}finally{try{C&&!C.done&&(S=P.return)&&(yield t(S.call(P)))}finally{if(w)throw w.error}}R=!0}catch(T){if(T instanceof Error&&T.name==="AbortError")return yield t(void 0);throw T}finally{R||_==null||_.abort()}})}return new i(g,_)}[Symbol.asyncIterator](){return this.iterator()}tee(){const d=[],_=[],m=this.iterator(),b=g=>({next:()=>{if(g.length===0){const v=m.next();d.push(v),_.push(v)}return g.shift()}});return[new i(()=>b(d),this.controller),new i(()=>b(_),this.controller)]}toReadableStream(){const d=this;let _;const m=new TextEncoder;return new ReadableStream({start(){return a(this,void 0,void 0,function*(){_=d[Symbol.asyncIterator]()})},pull(b){return a(this,void 0,void 0,function*(){try{const{value:g,done:v}=yield _.next();if(v)return b.close();const w=m.encode(JSON.stringify(g)+`
`);b.enqueue(w)}catch(g){b.error(g)}})},cancel(){var b;return a(this,void 0,void 0,function*(){yield(b=_.return)===null||b===void 0?void 0:b.call(_)})}})}}ft.StreamUtils=i;function o(y,d){return r(this,arguments,function*(){var m,b;if(!y.body)throw d==null||d.abort(),new n.CohereError({message:"Attempted to iterate over a response with no body"});const g=new l,v=new c,w=h(y.body);try{for(var S=e(s(w)),R;R=yield t(S.next()),!R.done;){const P=R.value;for(const C of v.decode(P)){const T=g.decode(C);T&&(yield yield t(T))}}}catch(P){m={error:P}}finally{try{R&&!R.done&&(b=S.return)&&(yield t(b.call(S)))}finally{if(m)throw m.error}}for(const P of v.flush()){const C=g.decode(P);C&&(yield yield t(C))}})}ft._iterSSEMessages=o;function s(y){return r(this,arguments,function*(){var _,m;let b=new Uint8Array;try{for(var g=e(y),v;v=yield t(g.next()),!v.done;){const w=v.value;if(w==null)continue;const S=w instanceof ArrayBuffer?new Uint8Array(w):typeof w=="string"?new TextEncoder().encode(w):w;let R=new Uint8Array(b.length+S.length);R.set(b),R.set(S,b.length),b=R;let P;for(;(P=u(b))!==-1;)yield yield t(b.slice(0,P)),b=b.slice(P)}}catch(w){_={error:w}}finally{try{v&&!v.done&&(m=g.return)&&(yield t(m.call(g)))}finally{if(_)throw _.error}}b.length>0&&(yield yield t(b))})}function u(y){for(let m=0;m<y.length-2;m++){if(y[m]===10&&y[m+1]===10||y[m]===13&&y[m+1]===13)return m+2;if(y[m]===13&&y[m+1]===10&&m+3<y.length&&y[m+2]===13&&y[m+3]===10)return m+4}return-1}class l{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(d){if(d.endsWith("\r")&&(d=d.substring(0,d.length-1)),!d){if(!this.event&&!this.data.length)return null;const g={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],g}if(this.chunks.push(d),d.startsWith(":"))return null;let[_,m,b]=p(d,":");return b.startsWith(" ")&&(b=b.substring(1)),_==="event"?this.event=b:_==="data"&&this.data.push(b),null}}class c{constructor(){this.buffer=[],this.trailingCR=!1}decode(d){let _=this.decodeText(d);if(this.trailingCR&&(_="\r"+_,this.trailingCR=!1),_.endsWith("\r")&&(this.trailingCR=!0,_=_.slice(0,-1)),!_)return[];const m=c.NEWLINE_CHARS.has(_[_.length-1]||"");let b=_.split(c.NEWLINE_REGEXP);return m&&b.pop(),b.length===1&&!m?(this.buffer.push(b[0]),[]):(this.buffer.length>0&&(b=[this.buffer.join("")+b[0],...b.slice(1)],this.buffer=[]),m||(this.buffer=[b.pop()||""]),b)}decodeText(d){var _;if(d==null)return"";if(typeof d=="string")return d;if(typeof Buffer<"u"){if(d instanceof Buffer)return d.toString();if(d instanceof Uint8Array)return Buffer.from(d).toString();throw new n.CohereError({message:`Unexpected: received non-Uint8Array (${d.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`})}if(typeof TextDecoder<"u"){if(d instanceof Uint8Array||d instanceof ArrayBuffer)return(_=this.textDecoder)!==null&&_!==void 0||(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(d);throw new n.CohereError({message:`Unexpected: received non-Uint8Array/ArrayBuffer (${d.constructor.name}) in a web platform. Please report this error.`})}throw new n.CohereError({message:"Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error."})}flush(){if(!this.buffer.length&&!this.trailingCR)return[];const d=[this.buffer.join("")];return this.buffer=[],this.trailingCR=!1,d}}ft.LineDecoder=c,c.NEWLINE_CHARS=new Set([`
`,"\r"]),c.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function f(y){const d=new c,_=[];for(const m of y)_.push(...d.decode(m));return _}ft._decodeChunks=f;function p(y,d){const _=y.indexOf(d);return _!==-1?[y.substring(0,_),d,y.substring(_+d.length)]:[y,"",""]}function h(y){if(y[Symbol.asyncIterator])return y;const d=y.getReader();return{next(){return a(this,void 0,void 0,function*(){try{const _=yield d.read();return _!=null&&_.done&&d.releaseLock(),_}catch(_){throw d.releaseLock(),_}})},return(){return a(this,void 0,void 0,function*(){const _=d.cancel();return d.releaseLock(),yield _,{done:!0,value:void 0}})},[Symbol.asyncIterator](){return this}}}return ft.readableStreamAsyncIterable=h,ft}var Zl={},nn={},Ql={},Yl={},an={},on={},Vq;function Ub(){if(Vq)return on;Vq=1;var a=on&&on.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=on&&on.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=on&&on.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(on,"__esModule",{value:!0}),on.Document=void 0;const r=t($());return on.Document=r.serialization.object({data:r.serialization.record(r.serialization.string(),r.serialization.unknown()),id:r.serialization.string().optional()}),on}var Gq;function NG(){if(Gq)return an;Gq=1;var a=an&&an.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),e=an&&an.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),t=an&&an.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&a(o,i,s);return e(o,i),o};Object.defineProperty(an,"__esModule",{value:!0}),an.V2ChatStreamRequestDocumentsItem=void 0;const r=t($()),n=Ub();return an.V2ChatStreamRequestDocumentsItem=r.serialization.undiscriminatedUnion([r.serialization.string(),n.Document]),an}var sn={},kq;function qG(){if(kq)return sn;kq=1;var a=sn&&sn.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=sn&&sn.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=sn&&sn.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(sn,"__esModule",{value:!0}),sn.V2ChatStreamRequestSafetyMode=void 0;const r=t($());return sn.V2ChatStreamRequestSafetyMode=r.serialization.enum_(["CONTEXTUAL","STRICT","OFF"]),sn}var un={},Hq;function zG(){if(Hq)return un;Hq=1;var a=un&&un.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=un&&un.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=un&&un.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(un,"__esModule",{value:!0}),un.V2ChatStreamRequestToolChoice=void 0;const r=t($());return un.V2ChatStreamRequestToolChoice=r.serialization.enum_(["REQUIRED","NONE"]),un}var ln={},Wq;function BG(){if(Wq)return ln;Wq=1;var a=ln&&ln.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),e=ln&&ln.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),t=ln&&ln.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&a(o,i,s);return e(o,i),o};Object.defineProperty(ln,"__esModule",{value:!0}),ln.V2ChatRequestDocumentsItem=void 0;const r=t($()),n=Ub();return ln.V2ChatRequestDocumentsItem=r.serialization.undiscriminatedUnion([r.serialization.string(),n.Document]),ln}var cn={},Kq;function UG(){if(Kq)return cn;Kq=1;var a=cn&&cn.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=cn&&cn.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=cn&&cn.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(cn,"__esModule",{value:!0}),cn.V2ChatRequestSafetyMode=void 0;const r=t($());return cn.V2ChatRequestSafetyMode=r.serialization.enum_(["CONTEXTUAL","STRICT","OFF"]),cn}var fn={},Jq;function FG(){if(Jq)return fn;Jq=1;var a=fn&&fn.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=fn&&fn.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=fn&&fn.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(fn,"__esModule",{value:!0}),fn.V2ChatRequestToolChoice=void 0;const r=t($());return fn.V2ChatRequestToolChoice=r.serialization.enum_(["REQUIRED","NONE"]),fn}var dn={},Xq;function LG(){if(Xq)return dn;Xq=1;var a=dn&&dn.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=dn&&dn.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=dn&&dn.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(dn,"__esModule",{value:!0}),dn.V2EmbedRequestTruncate=void 0;const r=t($());return dn.V2EmbedRequestTruncate=r.serialization.enum_(["NONE","START","END"]),dn}var hn={},Zq;function VG(){if(Zq)return hn;Zq=1;var a=hn&&hn.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=hn&&hn.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=hn&&hn.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(hn,"__esModule",{value:!0}),hn.V2RerankResponseResultsItemDocument=void 0;const r=t($());return hn.V2RerankResponseResultsItemDocument=r.serialization.object({text:r.serialization.string()}),hn}var pn={},Qq;function GG(){if(Qq)return pn;Qq=1;var a=pn&&pn.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),e=pn&&pn.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),t=pn&&pn.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&a(o,i,s);return e(o,i),o};Object.defineProperty(pn,"__esModule",{value:!0}),pn.V2RerankResponseResultsItem=void 0;const r=t($()),n=VG();return pn.V2RerankResponseResultsItem=r.serialization.object({document:n.V2RerankResponseResultsItemDocument.optional(),index:r.serialization.number(),relevanceScore:r.serialization.property("relevance_score",r.serialization.number())}),pn}var _n={},yn={},bn={},Yq;function kG(){if(Yq)return bn;Yq=1;var a=bn&&bn.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=bn&&bn.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=bn&&bn.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(bn,"__esModule",{value:!0}),bn.ApiMetaApiVersion=void 0;const r=t($());return bn.ApiMetaApiVersion=r.serialization.object({version:r.serialization.string(),isDeprecated:r.serialization.property("is_deprecated",r.serialization.boolean().optional()),isExperimental:r.serialization.property("is_experimental",r.serialization.boolean().optional())}),bn}var mn={},ez;function HG(){if(ez)return mn;ez=1;var a=mn&&mn.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=mn&&mn.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=mn&&mn.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(mn,"__esModule",{value:!0}),mn.ApiMetaBilledUnits=void 0;const r=t($());return mn.ApiMetaBilledUnits=r.serialization.object({images:r.serialization.number().optional(),inputTokens:r.serialization.property("input_tokens",r.serialization.number().optional()),outputTokens:r.serialization.property("output_tokens",r.serialization.number().optional()),searchUnits:r.serialization.property("search_units",r.serialization.number().optional()),classifications:r.serialization.number().optional()}),mn}var gn={},tz;function WG(){if(tz)return gn;tz=1;var a=gn&&gn.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=gn&&gn.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=gn&&gn.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(gn,"__esModule",{value:!0}),gn.ApiMetaTokens=void 0;const r=t($());return gn.ApiMetaTokens=r.serialization.object({inputTokens:r.serialization.property("input_tokens",r.serialization.number().optional()),outputTokens:r.serialization.property("output_tokens",r.serialization.number().optional())}),gn}var rz;function Er(){if(rz)return yn;rz=1;var a=yn&&yn.__createBinding||(Object.create?function(s,u,l,c){c===void 0&&(c=l);var f=Object.getOwnPropertyDescriptor(u,l);(!f||("get"in f?!u.__esModule:f.writable||f.configurable))&&(f={enumerable:!0,get:function(){return u[l]}}),Object.defineProperty(s,c,f)}:function(s,u,l,c){c===void 0&&(c=l),s[c]=u[l]}),e=yn&&yn.__setModuleDefault||(Object.create?function(s,u){Object.defineProperty(s,"default",{enumerable:!0,value:u})}:function(s,u){s.default=u}),t=yn&&yn.__importStar||function(s){if(s&&s.__esModule)return s;var u={};if(s!=null)for(var l in s)l!=="default"&&Object.prototype.hasOwnProperty.call(s,l)&&a(u,s,l);return e(u,s),u};Object.defineProperty(yn,"__esModule",{value:!0}),yn.ApiMeta=void 0;const r=t($()),n=kG(),i=HG(),o=WG();return yn.ApiMeta=r.serialization.object({apiVersion:r.serialization.property("api_version",n.ApiMetaApiVersion.optional()),billedUnits:r.serialization.property("billed_units",i.ApiMetaBilledUnits.optional()),tokens:o.ApiMetaTokens.optional(),warnings:r.serialization.list(r.serialization.string()).optional()}),yn}var nz;function Oue(){if(nz)return _n;nz=1;var a=_n&&_n.__createBinding||(Object.create?function(o,s,u,l){l===void 0&&(l=u);var c=Object.getOwnPropertyDescriptor(s,u);(!c||("get"in c?!s.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return s[u]}}),Object.defineProperty(o,l,c)}:function(o,s,u,l){l===void 0&&(l=u),o[l]=s[u]}),e=_n&&_n.__setModuleDefault||(Object.create?function(o,s){Object.defineProperty(o,"default",{enumerable:!0,value:s})}:function(o,s){o.default=s}),t=_n&&_n.__importStar||function(o){if(o&&o.__esModule)return o;var s={};if(o!=null)for(var u in o)u!=="default"&&Object.prototype.hasOwnProperty.call(o,u)&&a(s,o,u);return e(s,o),s};Object.defineProperty(_n,"__esModule",{value:!0}),_n.V2RerankResponse=void 0;const r=t($()),n=GG(),i=Er();return _n.V2RerankResponse=r.serialization.object({id:r.serialization.string().optional(),results:r.serialization.list(n.V2RerankResponseResultsItem),meta:i.ApiMeta.optional()}),_n}var iz;function KG(){return iz||(iz=1,function(a){var e=Yl&&Yl.__createBinding||(Object.create?function(r,n,i,o){o===void 0&&(o=i);var s=Object.getOwnPropertyDescriptor(n,i);(!s||("get"in s?!n.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(r,o,s)}:function(r,n,i,o){o===void 0&&(o=i),r[o]=n[i]}),t=Yl&&Yl.__exportStar||function(r,n){for(var i in r)i!=="default"&&!Object.prototype.hasOwnProperty.call(n,i)&&e(n,r,i)};Object.defineProperty(a,"__esModule",{value:!0}),t(NG(),a),t(qG(),a),t(zG(),a),t(BG(),a),t(UG(),a),t(FG(),a),t(LG(),a),t(VG(),a),t(GG(),a),t(Oue(),a)}(Yl)),Yl}var ec={},aE={},vn={},wn={},On={},Sn={},En={},Rn={},Cn={},az;function Gf(){if(az)return Cn;az=1;var a=Cn&&Cn.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=Cn&&Cn.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=Cn&&Cn.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(Cn,"__esModule",{value:!0}),Cn.TextContent=void 0;const r=t($());return Cn.TextContent=r.serialization.object({text:r.serialization.string()}),Cn}var Pn={},jn={},oz;function JG(){if(oz)return jn;oz=1;var a=jn&&jn.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=jn&&jn.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=jn&&jn.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(jn,"__esModule",{value:!0}),jn.ImageUrl=void 0;const r=t($());return jn.ImageUrl=r.serialization.object({url:r.serialization.string()}),jn}var sz;function XG(){if(sz)return Pn;sz=1;var a=Pn&&Pn.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),e=Pn&&Pn.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),t=Pn&&Pn.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&a(o,i,s);return e(o,i),o};Object.defineProperty(Pn,"__esModule",{value:!0}),Pn.ImageContent=void 0;const r=t($()),n=JG();return Pn.ImageContent=r.serialization.object({imageUrl:r.serialization.property("image_url",n.ImageUrl)}),Pn}var uz;function ZG(){if(uz)return Rn;uz=1;var a=Rn&&Rn.__createBinding||(Object.create?function(o,s,u,l){l===void 0&&(l=u);var c=Object.getOwnPropertyDescriptor(s,u);(!c||("get"in c?!s.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return s[u]}}),Object.defineProperty(o,l,c)}:function(o,s,u,l){l===void 0&&(l=u),o[l]=s[u]}),e=Rn&&Rn.__setModuleDefault||(Object.create?function(o,s){Object.defineProperty(o,"default",{enumerable:!0,value:s})}:function(o,s){o.default=s}),t=Rn&&Rn.__importStar||function(o){if(o&&o.__esModule)return o;var s={};if(o!=null)for(var u in o)u!=="default"&&Object.prototype.hasOwnProperty.call(o,u)&&a(s,o,u);return e(s,o),s};Object.defineProperty(Rn,"__esModule",{value:!0}),Rn.Content=void 0;const r=t($()),n=Gf(),i=XG();return Rn.Content=r.serialization.union("type",{text:n.TextContent,image_url:i.ImageContent}).transform({transform:o=>o,untransform:o=>o}),Rn}var lz;function QG(){if(lz)return En;lz=1;var a=En&&En.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),e=En&&En.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),t=En&&En.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&a(o,i,s);return e(o,i),o};Object.defineProperty(En,"__esModule",{value:!0}),En.UserMessageContent=void 0;const r=t($()),n=ZG();return En.UserMessageContent=r.serialization.undiscriminatedUnion([r.serialization.string(),r.serialization.list(n.Content)]),En}var cz;function YG(){if(cz)return Sn;cz=1;var a=Sn&&Sn.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),e=Sn&&Sn.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),t=Sn&&Sn.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&a(o,i,s);return e(o,i),o};Object.defineProperty(Sn,"__esModule",{value:!0}),Sn.UserMessage=void 0;const r=t($()),n=QG();return Sn.UserMessage=r.serialization.object({content:n.UserMessageContent}),Sn}var Tn={},Mn={},An={},fz;function e6(){if(fz)return An;fz=1;var a=An&&An.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=An&&An.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=An&&An.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(An,"__esModule",{value:!0}),An.ToolCallV2Function=void 0;const r=t($());return An.ToolCallV2Function=r.serialization.object({name:r.serialization.string().optional(),arguments:r.serialization.string().optional()}),An}var dz;function Fb(){if(dz)return Mn;dz=1;var a=Mn&&Mn.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),e=Mn&&Mn.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),t=Mn&&Mn.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&a(o,i,s);return e(o,i),o};Object.defineProperty(Mn,"__esModule",{value:!0}),Mn.ToolCallV2=void 0;const r=t($()),n=e6();return Mn.ToolCallV2=r.serialization.object({id:r.serialization.string().optional(),type:r.serialization.stringLiteral("function").optional(),function:n.ToolCallV2Function.optional()}),Mn}var In={},Dn={},hz;function t6(){if(hz)return Dn;hz=1;var a=Dn&&Dn.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),e=Dn&&Dn.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),t=Dn&&Dn.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&a(o,i,s);return e(o,i),o};Object.defineProperty(Dn,"__esModule",{value:!0}),Dn.AssistantMessageContentItem=void 0;const r=t($()),n=Gf();return Dn.AssistantMessageContentItem=r.serialization.union("type",{text:n.TextContent}).transform({transform:i=>i,untransform:i=>i}),Dn}var pz;function r6(){if(pz)return In;pz=1;var a=In&&In.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),e=In&&In.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),t=In&&In.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&a(o,i,s);return e(o,i),o};Object.defineProperty(In,"__esModule",{value:!0}),In.AssistantMessageContent=void 0;const r=t($()),n=t6();return In.AssistantMessageContent=r.serialization.undiscriminatedUnion([r.serialization.string(),r.serialization.list(n.AssistantMessageContentItem)]),In}var xn={},$n={},Nn={},_z;function n6(){if(_z)return Nn;_z=1;var a=Nn&&Nn.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=Nn&&Nn.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=Nn&&Nn.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(Nn,"__esModule",{value:!0}),Nn.ToolSource=void 0;const r=t($());return Nn.ToolSource=r.serialization.object({id:r.serialization.string().optional(),toolOutput:r.serialization.property("tool_output",r.serialization.record(r.serialization.string(),r.serialization.unknown()).optional())}),Nn}var qn={},yz;function i6(){if(yz)return qn;yz=1;var a=qn&&qn.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=qn&&qn.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=qn&&qn.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(qn,"__esModule",{value:!0}),qn.DocumentSource=void 0;const r=t($());return qn.DocumentSource=r.serialization.object({id:r.serialization.string().optional(),document:r.serialization.record(r.serialization.string(),r.serialization.unknown()).optional()}),qn}var bz;function a6(){if(bz)return $n;bz=1;var a=$n&&$n.__createBinding||(Object.create?function(o,s,u,l){l===void 0&&(l=u);var c=Object.getOwnPropertyDescriptor(s,u);(!c||("get"in c?!s.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return s[u]}}),Object.defineProperty(o,l,c)}:function(o,s,u,l){l===void 0&&(l=u),o[l]=s[u]}),e=$n&&$n.__setModuleDefault||(Object.create?function(o,s){Object.defineProperty(o,"default",{enumerable:!0,value:s})}:function(o,s){o.default=s}),t=$n&&$n.__importStar||function(o){if(o&&o.__esModule)return o;var s={};if(o!=null)for(var u in o)u!=="default"&&Object.prototype.hasOwnProperty.call(o,u)&&a(s,o,u);return e(s,o),s};Object.defineProperty($n,"__esModule",{value:!0}),$n.Source=void 0;const r=t($()),n=n6(),i=i6();return $n.Source=r.serialization.union("type",{tool:n.ToolSource,document:i.DocumentSource}).transform({transform:o=>o,untransform:o=>o}),$n}var zn={},mz;function o6(){if(mz)return zn;mz=1;var a=zn&&zn.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=zn&&zn.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=zn&&zn.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(zn,"__esModule",{value:!0}),zn.CitationType=void 0;const r=t($());return zn.CitationType=r.serialization.enum_(["TEXT_CONTENT","PLAN"]),zn}var gz;function Lb(){if(gz)return xn;gz=1;var a=xn&&xn.__createBinding||(Object.create?function(o,s,u,l){l===void 0&&(l=u);var c=Object.getOwnPropertyDescriptor(s,u);(!c||("get"in c?!s.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return s[u]}}),Object.defineProperty(o,l,c)}:function(o,s,u,l){l===void 0&&(l=u),o[l]=s[u]}),e=xn&&xn.__setModuleDefault||(Object.create?function(o,s){Object.defineProperty(o,"default",{enumerable:!0,value:s})}:function(o,s){o.default=s}),t=xn&&xn.__importStar||function(o){if(o&&o.__esModule)return o;var s={};if(o!=null)for(var u in o)u!=="default"&&Object.prototype.hasOwnProperty.call(o,u)&&a(s,o,u);return e(s,o),s};Object.defineProperty(xn,"__esModule",{value:!0}),xn.Citation=void 0;const r=t($()),n=a6(),i=o6();return xn.Citation=r.serialization.object({start:r.serialization.number().optional(),end:r.serialization.number().optional(),text:r.serialization.string().optional(),sources:r.serialization.list(n.Source).optional(),type:i.CitationType.optional()}),xn}var vz;function s6(){if(vz)return Tn;vz=1;var a=Tn&&Tn.__createBinding||(Object.create?function(s,u,l,c){c===void 0&&(c=l);var f=Object.getOwnPropertyDescriptor(u,l);(!f||("get"in f?!u.__esModule:f.writable||f.configurable))&&(f={enumerable:!0,get:function(){return u[l]}}),Object.defineProperty(s,c,f)}:function(s,u,l,c){c===void 0&&(c=l),s[c]=u[l]}),e=Tn&&Tn.__setModuleDefault||(Object.create?function(s,u){Object.defineProperty(s,"default",{enumerable:!0,value:u})}:function(s,u){s.default=u}),t=Tn&&Tn.__importStar||function(s){if(s&&s.__esModule)return s;var u={};if(s!=null)for(var l in s)l!=="default"&&Object.prototype.hasOwnProperty.call(s,l)&&a(u,s,l);return e(u,s),u};Object.defineProperty(Tn,"__esModule",{value:!0}),Tn.AssistantMessage=void 0;const r=t($()),n=Fb(),i=r6(),o=Lb();return Tn.AssistantMessage=r.serialization.object({toolCalls:r.serialization.property("tool_calls",r.serialization.list(n.ToolCallV2).optional()),toolPlan:r.serialization.property("tool_plan",r.serialization.string().optional()),content:i.AssistantMessageContent.optional(),citations:r.serialization.list(o.Citation).optional()}),Tn}var Bn={},Un={},Fn={},wz;function u6(){if(wz)return Fn;wz=1;var a=Fn&&Fn.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),e=Fn&&Fn.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),t=Fn&&Fn.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&a(o,i,s);return e(o,i),o};Object.defineProperty(Fn,"__esModule",{value:!0}),Fn.SystemMessageContentItem=void 0;const r=t($()),n=Gf();return Fn.SystemMessageContentItem=r.serialization.union("type",{text:n.TextContent}).transform({transform:i=>i,untransform:i=>i}),Fn}var Oz;function l6(){if(Oz)return Un;Oz=1;var a=Un&&Un.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),e=Un&&Un.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),t=Un&&Un.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&a(o,i,s);return e(o,i),o};Object.defineProperty(Un,"__esModule",{value:!0}),Un.SystemMessageContent=void 0;const r=t($()),n=u6();return Un.SystemMessageContent=r.serialization.undiscriminatedUnion([r.serialization.string(),r.serialization.list(n.SystemMessageContentItem)]),Un}var Sz;function c6(){if(Sz)return Bn;Sz=1;var a=Bn&&Bn.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),e=Bn&&Bn.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),t=Bn&&Bn.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&a(o,i,s);return e(o,i),o};Object.defineProperty(Bn,"__esModule",{value:!0}),Bn.SystemMessage=void 0;const r=t($()),n=l6();return Bn.SystemMessage=r.serialization.object({content:n.SystemMessageContent}),Bn}var Ln={},Vn={},Gn={},kn={},Ez;function f6(){if(Ez)return kn;Ez=1;var a=kn&&kn.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),e=kn&&kn.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),t=kn&&kn.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&a(o,i,s);return e(o,i),o};Object.defineProperty(kn,"__esModule",{value:!0}),kn.DocumentContent=void 0;const r=t($()),n=Ub();return kn.DocumentContent=r.serialization.object({document:n.Document}),kn}var Rz;function d6(){if(Rz)return Gn;Rz=1;var a=Gn&&Gn.__createBinding||(Object.create?function(o,s,u,l){l===void 0&&(l=u);var c=Object.getOwnPropertyDescriptor(s,u);(!c||("get"in c?!s.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return s[u]}}),Object.defineProperty(o,l,c)}:function(o,s,u,l){l===void 0&&(l=u),o[l]=s[u]}),e=Gn&&Gn.__setModuleDefault||(Object.create?function(o,s){Object.defineProperty(o,"default",{enumerable:!0,value:s})}:function(o,s){o.default=s}),t=Gn&&Gn.__importStar||function(o){if(o&&o.__esModule)return o;var s={};if(o!=null)for(var u in o)u!=="default"&&Object.prototype.hasOwnProperty.call(o,u)&&a(s,o,u);return e(s,o),s};Object.defineProperty(Gn,"__esModule",{value:!0}),Gn.ToolContent=void 0;const r=t($()),n=Gf(),i=f6();return Gn.ToolContent=r.serialization.union("type",{text:n.TextContent,document:i.DocumentContent}).transform({transform:o=>o,untransform:o=>o}),Gn}var Cz;function h6(){if(Cz)return Vn;Cz=1;var a=Vn&&Vn.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),e=Vn&&Vn.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),t=Vn&&Vn.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&a(o,i,s);return e(o,i),o};Object.defineProperty(Vn,"__esModule",{value:!0}),Vn.ToolMessageV2Content=void 0;const r=t($()),n=d6();return Vn.ToolMessageV2Content=r.serialization.undiscriminatedUnion([r.serialization.string(),r.serialization.list(n.ToolContent)]),Vn}var Pz;function p6(){if(Pz)return Ln;Pz=1;var a=Ln&&Ln.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),e=Ln&&Ln.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),t=Ln&&Ln.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&a(o,i,s);return e(o,i),o};Object.defineProperty(Ln,"__esModule",{value:!0}),Ln.ToolMessageV2=void 0;const r=t($()),n=h6();return Ln.ToolMessageV2=r.serialization.object({toolCallId:r.serialization.property("tool_call_id",r.serialization.string()),content:n.ToolMessageV2Content}),Ln}var jz;function _6(){if(jz)return On;jz=1;var a=On&&On.__createBinding||(Object.create?function(u,l,c,f){f===void 0&&(f=c);var p=Object.getOwnPropertyDescriptor(l,c);(!p||("get"in p?!l.__esModule:p.writable||p.configurable))&&(p={enumerable:!0,get:function(){return l[c]}}),Object.defineProperty(u,f,p)}:function(u,l,c,f){f===void 0&&(f=c),u[f]=l[c]}),e=On&&On.__setModuleDefault||(Object.create?function(u,l){Object.defineProperty(u,"default",{enumerable:!0,value:l})}:function(u,l){u.default=l}),t=On&&On.__importStar||function(u){if(u&&u.__esModule)return u;var l={};if(u!=null)for(var c in u)c!=="default"&&Object.prototype.hasOwnProperty.call(u,c)&&a(l,u,c);return e(l,u),l};Object.defineProperty(On,"__esModule",{value:!0}),On.ChatMessageV2=void 0;const r=t($()),n=YG(),i=s6(),o=c6(),s=p6();return On.ChatMessageV2=r.serialization.union("role",{user:n.UserMessage,assistant:i.AssistantMessage,system:o.SystemMessage,tool:s.ToolMessageV2}).transform({transform:u=>u,untransform:u=>u}),On}var Tz;function qC(){if(Tz)return wn;Tz=1;var a=wn&&wn.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),e=wn&&wn.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),t=wn&&wn.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&a(o,i,s);return e(o,i),o};Object.defineProperty(wn,"__esModule",{value:!0}),wn.ChatMessages=void 0;const r=t($()),n=_6();return wn.ChatMessages=r.serialization.list(n.ChatMessageV2),wn}var Hn={},Wn={},Mz;function y6(){if(Mz)return Wn;Mz=1;var a=Wn&&Wn.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=Wn&&Wn.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=Wn&&Wn.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(Wn,"__esModule",{value:!0}),Wn.ToolV2Function=void 0;const r=t($());return Wn.ToolV2Function=r.serialization.object({name:r.serialization.string(),description:r.serialization.string().optional(),parameters:r.serialization.record(r.serialization.string(),r.serialization.unknown())}),Wn}var Az;function zC(){if(Az)return Hn;Az=1;var a=Hn&&Hn.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),e=Hn&&Hn.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),t=Hn&&Hn.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&a(o,i,s);return e(o,i),o};Object.defineProperty(Hn,"__esModule",{value:!0}),Hn.ToolV2=void 0;const r=t($()),n=y6();return Hn.ToolV2=r.serialization.object({type:r.serialization.stringLiteral("function").optional(),function:n.ToolV2Function.optional()}),Hn}var Kn={},Jn={},Iz;function b6(){if(Iz)return Jn;Iz=1;var a=Jn&&Jn.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=Jn&&Jn.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=Jn&&Jn.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(Jn,"__esModule",{value:!0}),Jn.CitationOptionsMode=void 0;const r=t($());return Jn.CitationOptionsMode=r.serialization.enum_(["FAST","ACCURATE","OFF"]),Jn}var Dz;function BC(){if(Dz)return Kn;Dz=1;var a=Kn&&Kn.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),e=Kn&&Kn.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),t=Kn&&Kn.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&a(o,i,s);return e(o,i),o};Object.defineProperty(Kn,"__esModule",{value:!0}),Kn.CitationOptions=void 0;const r=t($()),n=b6();return Kn.CitationOptions=r.serialization.object({mode:n.CitationOptionsMode.optional()}),Kn}var Xn={},Zn={},xz;function m6(){if(xz)return Zn;xz=1;var a=Zn&&Zn.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=Zn&&Zn.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=Zn&&Zn.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(Zn,"__esModule",{value:!0}),Zn.TextResponseFormatV2=void 0;const r=t($());return Zn.TextResponseFormatV2=r.serialization.object({}),Zn}var Qn={},$z;function g6(){if($z)return Qn;$z=1;var a=Qn&&Qn.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=Qn&&Qn.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=Qn&&Qn.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(Qn,"__esModule",{value:!0}),Qn.JsonResponseFormatV2=void 0;const r=t($());return Qn.JsonResponseFormatV2=r.serialization.object({jsonSchema:r.serialization.property("json_schema",r.serialization.record(r.serialization.string(),r.serialization.unknown()).optional())}),Qn}var Nz;function UC(){if(Nz)return Xn;Nz=1;var a=Xn&&Xn.__createBinding||(Object.create?function(o,s,u,l){l===void 0&&(l=u);var c=Object.getOwnPropertyDescriptor(s,u);(!c||("get"in c?!s.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return s[u]}}),Object.defineProperty(o,l,c)}:function(o,s,u,l){l===void 0&&(l=u),o[l]=s[u]}),e=Xn&&Xn.__setModuleDefault||(Object.create?function(o,s){Object.defineProperty(o,"default",{enumerable:!0,value:s})}:function(o,s){o.default=s}),t=Xn&&Xn.__importStar||function(o){if(o&&o.__esModule)return o;var s={};if(o!=null)for(var u in o)u!=="default"&&Object.prototype.hasOwnProperty.call(o,u)&&a(s,o,u);return e(s,o),s};Object.defineProperty(Xn,"__esModule",{value:!0}),Xn.ResponseFormatV2=void 0;const r=t($()),n=m6(),i=g6();return Xn.ResponseFormatV2=r.serialization.union("type",{text:n.TextResponseFormatV2,json_object:i.JsonResponseFormatV2}).transform({transform:o=>o,untransform:o=>o}),Xn}var qz;function Sue(){if(qz)return vn;qz=1;var a=vn&&vn.__createBinding||(Object.create?function(f,p,h,y){y===void 0&&(y=h);var d=Object.getOwnPropertyDescriptor(p,h);(!d||("get"in d?!p.__esModule:d.writable||d.configurable))&&(d={enumerable:!0,get:function(){return p[h]}}),Object.defineProperty(f,y,d)}:function(f,p,h,y){y===void 0&&(y=h),f[y]=p[h]}),e=vn&&vn.__setModuleDefault||(Object.create?function(f,p){Object.defineProperty(f,"default",{enumerable:!0,value:p})}:function(f,p){f.default=p}),t=vn&&vn.__importStar||function(f){if(f&&f.__esModule)return f;var p={};if(f!=null)for(var h in f)h!=="default"&&Object.prototype.hasOwnProperty.call(f,h)&&a(p,f,h);return e(p,f),p};Object.defineProperty(vn,"__esModule",{value:!0}),vn.V2ChatStreamRequest=void 0;const r=t($()),n=qC(),i=zC(),o=NG(),s=BC(),u=UC(),l=qG(),c=zG();return vn.V2ChatStreamRequest=r.serialization.object({model:r.serialization.string(),messages:n.ChatMessages,tools:r.serialization.list(i.ToolV2).optional(),strictTools:r.serialization.property("strict_tools",r.serialization.boolean().optional()),documents:r.serialization.list(o.V2ChatStreamRequestDocumentsItem).optional(),citationOptions:r.serialization.property("citation_options",s.CitationOptions.optional()),responseFormat:r.serialization.property("response_format",u.ResponseFormatV2.optional()),safetyMode:r.serialization.property("safety_mode",l.V2ChatStreamRequestSafetyMode.optional()),maxTokens:r.serialization.property("max_tokens",r.serialization.number().optional()),stopSequences:r.serialization.property("stop_sequences",r.serialization.list(r.serialization.string()).optional()),temperature:r.serialization.number().optional(),seed:r.serialization.number().optional(),frequencyPenalty:r.serialization.property("frequency_penalty",r.serialization.number().optional()),presencePenalty:r.serialization.property("presence_penalty",r.serialization.number().optional()),k:r.serialization.number().optional(),p:r.serialization.number().optional(),returnPrompt:r.serialization.property("return_prompt",r.serialization.boolean().optional()),logprobs:r.serialization.boolean().optional(),toolChoice:r.serialization.property("tool_choice",c.V2ChatStreamRequestToolChoice.optional())}),vn}var Yn={},zz;function Eue(){if(zz)return Yn;zz=1;var a=Yn&&Yn.__createBinding||(Object.create?function(f,p,h,y){y===void 0&&(y=h);var d=Object.getOwnPropertyDescriptor(p,h);(!d||("get"in d?!p.__esModule:d.writable||d.configurable))&&(d={enumerable:!0,get:function(){return p[h]}}),Object.defineProperty(f,y,d)}:function(f,p,h,y){y===void 0&&(y=h),f[y]=p[h]}),e=Yn&&Yn.__setModuleDefault||(Object.create?function(f,p){Object.defineProperty(f,"default",{enumerable:!0,value:p})}:function(f,p){f.default=p}),t=Yn&&Yn.__importStar||function(f){if(f&&f.__esModule)return f;var p={};if(f!=null)for(var h in f)h!=="default"&&Object.prototype.hasOwnProperty.call(f,h)&&a(p,f,h);return e(p,f),p};Object.defineProperty(Yn,"__esModule",{value:!0}),Yn.V2ChatRequest=void 0;const r=t($()),n=qC(),i=zC(),o=BG(),s=BC(),u=UC(),l=UG(),c=FG();return Yn.V2ChatRequest=r.serialization.object({model:r.serialization.string(),messages:n.ChatMessages,tools:r.serialization.list(i.ToolV2).optional(),strictTools:r.serialization.property("strict_tools",r.serialization.boolean().optional()),documents:r.serialization.list(o.V2ChatRequestDocumentsItem).optional(),citationOptions:r.serialization.property("citation_options",s.CitationOptions.optional()),responseFormat:r.serialization.property("response_format",u.ResponseFormatV2.optional()),safetyMode:r.serialization.property("safety_mode",l.V2ChatRequestSafetyMode.optional()),maxTokens:r.serialization.property("max_tokens",r.serialization.number().optional()),stopSequences:r.serialization.property("stop_sequences",r.serialization.list(r.serialization.string()).optional()),temperature:r.serialization.number().optional(),seed:r.serialization.number().optional(),frequencyPenalty:r.serialization.property("frequency_penalty",r.serialization.number().optional()),presencePenalty:r.serialization.property("presence_penalty",r.serialization.number().optional()),k:r.serialization.number().optional(),p:r.serialization.number().optional(),returnPrompt:r.serialization.property("return_prompt",r.serialization.boolean().optional()),logprobs:r.serialization.boolean().optional(),toolChoice:r.serialization.property("tool_choice",c.V2ChatRequestToolChoice.optional())}),Yn}var ei={},ti={},Bz;function Vb(){if(Bz)return ti;Bz=1;var a=ti&&ti.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=ti&&ti.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=ti&&ti.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(ti,"__esModule",{value:!0}),ti.EmbedInputType=void 0;const r=t($());return ti.EmbedInputType=r.serialization.enum_(["search_document","search_query","classification","clustering","image"]),ti}var ri={},Uz;function Gb(){if(Uz)return ri;Uz=1;var a=ri&&ri.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=ri&&ri.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=ri&&ri.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(ri,"__esModule",{value:!0}),ri.EmbeddingType=void 0;const r=t($());return ri.EmbeddingType=r.serialization.enum_(["float","int8","uint8","binary","ubinary"]),ri}var Fz;function Rue(){if(Fz)return ei;Fz=1;var a=ei&&ei.__createBinding||(Object.create?function(s,u,l,c){c===void 0&&(c=l);var f=Object.getOwnPropertyDescriptor(u,l);(!f||("get"in f?!u.__esModule:f.writable||f.configurable))&&(f={enumerable:!0,get:function(){return u[l]}}),Object.defineProperty(s,c,f)}:function(s,u,l,c){c===void 0&&(c=l),s[c]=u[l]}),e=ei&&ei.__setModuleDefault||(Object.create?function(s,u){Object.defineProperty(s,"default",{enumerable:!0,value:u})}:function(s,u){s.default=u}),t=ei&&ei.__importStar||function(s){if(s&&s.__esModule)return s;var u={};if(s!=null)for(var l in s)l!=="default"&&Object.prototype.hasOwnProperty.call(s,l)&&a(u,s,l);return e(u,s),u};Object.defineProperty(ei,"__esModule",{value:!0}),ei.V2EmbedRequest=void 0;const r=t($()),n=Vb(),i=Gb(),o=LG();return ei.V2EmbedRequest=r.serialization.object({texts:r.serialization.list(r.serialization.string()).optional(),images:r.serialization.list(r.serialization.string()).optional(),model:r.serialization.string(),inputType:r.serialization.property("input_type",n.EmbedInputType),embeddingTypes:r.serialization.property("embedding_types",r.serialization.list(i.EmbeddingType)),truncate:o.V2EmbedRequestTruncate.optional()}),ei}var ni={},Lz;function Cue(){if(Lz)return ni;Lz=1;var a=ni&&ni.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=ni&&ni.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=ni&&ni.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(ni,"__esModule",{value:!0}),ni.V2RerankRequest=void 0;const r=t($());return ni.V2RerankRequest=r.serialization.object({model:r.serialization.string(),query:r.serialization.string(),documents:r.serialization.list(r.serialization.string()),topN:r.serialization.property("top_n",r.serialization.number().optional()),returnDocuments:r.serialization.property("return_documents",r.serialization.boolean().optional()),maxTokensPerDoc:r.serialization.property("max_tokens_per_doc",r.serialization.number().optional())}),ni}var Vz;function v6(){return Vz||(Vz=1,function(a){Object.defineProperty(a,"__esModule",{value:!0}),a.V2RerankRequest=a.V2EmbedRequest=a.V2ChatRequest=a.V2ChatStreamRequest=void 0;var e=Sue();Object.defineProperty(a,"V2ChatStreamRequest",{enumerable:!0,get:function(){return e.V2ChatStreamRequest}});var t=Eue();Object.defineProperty(a,"V2ChatRequest",{enumerable:!0,get:function(){return t.V2ChatRequest}});var r=Rue();Object.defineProperty(a,"V2EmbedRequest",{enumerable:!0,get:function(){return r.V2EmbedRequest}});var n=Cue();Object.defineProperty(a,"V2RerankRequest",{enumerable:!0,get:function(){return n.V2RerankRequest}})}(aE)),aE}var Gz;function Pue(){return Gz||(Gz=1,function(a){var e=ec&&ec.__createBinding||(Object.create?function(r,n,i,o){o===void 0&&(o=i);var s=Object.getOwnPropertyDescriptor(n,i);(!s||("get"in s?!n.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(r,o,s)}:function(r,n,i,o){o===void 0&&(o=i),r[o]=n[i]}),t=ec&&ec.__exportStar||function(r,n){for(var i in r)i!=="default"&&!Object.prototype.hasOwnProperty.call(n,i)&&e(n,r,i)};Object.defineProperty(a,"__esModule",{value:!0}),t(v6(),a)}(ec)),ec}var kz;function jue(){return kz||(kz=1,function(a){var e=Ql&&Ql.__createBinding||(Object.create?function(r,n,i,o){o===void 0&&(o=i);var s=Object.getOwnPropertyDescriptor(n,i);(!s||("get"in s?!n.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(r,o,s)}:function(r,n,i,o){o===void 0&&(o=i),r[o]=n[i]}),t=Ql&&Ql.__exportStar||function(r,n){for(var i in r)i!=="default"&&!Object.prototype.hasOwnProperty.call(n,i)&&e(n,r,i)};Object.defineProperty(a,"__esModule",{value:!0}),t(KG(),a),t(Pue(),a)}(Ql)),Ql}var tc={},rc={},ii={},Hz;function w6(){if(Hz)return ii;Hz=1;var a=ii&&ii.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=ii&&ii.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=ii&&ii.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(ii,"__esModule",{value:!0}),ii.CreateEmbedJobRequestTruncate=void 0;const r=t($());return ii.CreateEmbedJobRequestTruncate=r.serialization.enum_(["START","END"]),ii}var Wz;function O6(){return Wz||(Wz=1,function(a){var e=rc&&rc.__createBinding||(Object.create?function(r,n,i,o){o===void 0&&(o=i);var s=Object.getOwnPropertyDescriptor(n,i);(!s||("get"in s?!n.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(r,o,s)}:function(r,n,i,o){o===void 0&&(o=i),r[o]=n[i]}),t=rc&&rc.__exportStar||function(r,n){for(var i in r)i!=="default"&&!Object.prototype.hasOwnProperty.call(n,i)&&e(n,r,i)};Object.defineProperty(a,"__esModule",{value:!0}),t(w6(),a)}(rc)),rc}var nc={},oE={},ai={},Kz;function Tue(){if(Kz)return ai;Kz=1;var a=ai&&ai.__createBinding||(Object.create?function(s,u,l,c){c===void 0&&(c=l);var f=Object.getOwnPropertyDescriptor(u,l);(!f||("get"in f?!u.__esModule:f.writable||f.configurable))&&(f={enumerable:!0,get:function(){return u[l]}}),Object.defineProperty(s,c,f)}:function(s,u,l,c){c===void 0&&(c=l),s[c]=u[l]}),e=ai&&ai.__setModuleDefault||(Object.create?function(s,u){Object.defineProperty(s,"default",{enumerable:!0,value:u})}:function(s,u){s.default=u}),t=ai&&ai.__importStar||function(s){if(s&&s.__esModule)return s;var u={};if(s!=null)for(var l in s)l!=="default"&&Object.prototype.hasOwnProperty.call(s,l)&&a(u,s,l);return e(u,s),u};Object.defineProperty(ai,"__esModule",{value:!0}),ai.CreateEmbedJobRequest=void 0;const r=t($()),n=Vb(),i=Gb(),o=w6();return ai.CreateEmbedJobRequest=r.serialization.object({model:r.serialization.string(),datasetId:r.serialization.property("dataset_id",r.serialization.string()),inputType:r.serialization.property("input_type",n.EmbedInputType),name:r.serialization.string().optional(),embeddingTypes:r.serialization.property("embedding_types",r.serialization.list(i.EmbeddingType).optional()),truncate:o.CreateEmbedJobRequestTruncate.optional()}),ai}var Jz;function S6(){return Jz||(Jz=1,function(a){Object.defineProperty(a,"__esModule",{value:!0}),a.CreateEmbedJobRequest=void 0;var e=Tue();Object.defineProperty(a,"CreateEmbedJobRequest",{enumerable:!0,get:function(){return e.CreateEmbedJobRequest}})}(oE)),oE}var Xz;function Mue(){return Xz||(Xz=1,function(a){var e=nc&&nc.__createBinding||(Object.create?function(r,n,i,o){o===void 0&&(o=i);var s=Object.getOwnPropertyDescriptor(n,i);(!s||("get"in s?!n.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(r,o,s)}:function(r,n,i,o){o===void 0&&(o=i),r[o]=n[i]}),t=nc&&nc.__exportStar||function(r,n){for(var i in r)i!=="default"&&!Object.prototype.hasOwnProperty.call(n,i)&&e(n,r,i)};Object.defineProperty(a,"__esModule",{value:!0}),t(S6(),a)}(nc)),nc}var Zz;function Aue(){return Zz||(Zz=1,function(a){var e=tc&&tc.__createBinding||(Object.create?function(r,n,i,o){o===void 0&&(o=i);var s=Object.getOwnPropertyDescriptor(n,i);(!s||("get"in s?!n.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(r,o,s)}:function(r,n,i,o){o===void 0&&(o=i),r[o]=n[i]}),t=tc&&tc.__exportStar||function(r,n){for(var i in r)i!=="default"&&!Object.prototype.hasOwnProperty.call(n,i)&&e(n,r,i)};Object.defineProperty(a,"__esModule",{value:!0}),t(O6(),a),t(Mue(),a)}(tc)),tc}var ic={},ac={},oi={},si={},ui={},Qz;function E6(){if(Qz)return ui;Qz=1;var a=ui&&ui.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=ui&&ui.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=ui&&ui.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(ui,"__esModule",{value:!0}),ui.DatasetType=void 0;const r=t($());return ui.DatasetType=r.serialization.enum_(["embed-input","embed-result","cluster-result","cluster-outliers","reranker-finetune-input","single-label-classification-finetune-input","chat-finetune-input","multi-label-classification-finetune-input"]),ui}var li={},Yz;function R6(){if(Yz)return li;Yz=1;var a=li&&li.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=li&&li.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=li&&li.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(li,"__esModule",{value:!0}),li.DatasetValidationStatus=void 0;const r=t($());return li.DatasetValidationStatus=r.serialization.enum_(["unknown","queued","processing","failed","validated","skipped"]),li}var ci={},eB;function C6(){if(eB)return ci;eB=1;var a=ci&&ci.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=ci&&ci.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=ci&&ci.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(ci,"__esModule",{value:!0}),ci.DatasetPart=void 0;const r=t($());return ci.DatasetPart=r.serialization.object({id:r.serialization.string(),name:r.serialization.string(),url:r.serialization.string().optional(),index:r.serialization.number().optional(),sizeBytes:r.serialization.property("size_bytes",r.serialization.number().optional()),numRows:r.serialization.property("num_rows",r.serialization.number().optional()),originalUrl:r.serialization.property("original_url",r.serialization.string().optional()),samples:r.serialization.list(r.serialization.string()).optional()}),ci}var tB;function FC(){if(tB)return si;tB=1;var a=si&&si.__createBinding||(Object.create?function(s,u,l,c){c===void 0&&(c=l);var f=Object.getOwnPropertyDescriptor(u,l);(!f||("get"in f?!u.__esModule:f.writable||f.configurable))&&(f={enumerable:!0,get:function(){return u[l]}}),Object.defineProperty(s,c,f)}:function(s,u,l,c){c===void 0&&(c=l),s[c]=u[l]}),e=si&&si.__setModuleDefault||(Object.create?function(s,u){Object.defineProperty(s,"default",{enumerable:!0,value:u})}:function(s,u){s.default=u}),t=si&&si.__importStar||function(s){if(s&&s.__esModule)return s;var u={};if(s!=null)for(var l in s)l!=="default"&&Object.prototype.hasOwnProperty.call(s,l)&&a(u,s,l);return e(u,s),u};Object.defineProperty(si,"__esModule",{value:!0}),si.Dataset=void 0;const r=t($()),n=E6(),i=R6(),o=C6();return si.Dataset=r.serialization.object({id:r.serialization.string(),name:r.serialization.string(),createdAt:r.serialization.property("created_at",r.serialization.date()),updatedAt:r.serialization.property("updated_at",r.serialization.date()),datasetType:r.serialization.property("dataset_type",n.DatasetType),validationStatus:r.serialization.property("validation_status",i.DatasetValidationStatus),validationError:r.serialization.property("validation_error",r.serialization.string().optional()),schema:r.serialization.string().optional(),requiredFields:r.serialization.property("required_fields",r.serialization.list(r.serialization.string()).optional()),preserveFields:r.serialization.property("preserve_fields",r.serialization.list(r.serialization.string()).optional()),datasetParts:r.serialization.property("dataset_parts",r.serialization.list(o.DatasetPart).optional()),validationWarnings:r.serialization.property("validation_warnings",r.serialization.list(r.serialization.string()).optional())}),si}var rB;function Iue(){if(rB)return oi;rB=1;var a=oi&&oi.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),e=oi&&oi.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),t=oi&&oi.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&a(o,i,s);return e(o,i),o};Object.defineProperty(oi,"__esModule",{value:!0}),oi.DatasetsListResponse=void 0;const r=t($()),n=FC();return oi.DatasetsListResponse=r.serialization.object({datasets:r.serialization.list(n.Dataset).optional()}),oi}var fi={},nB;function Due(){if(nB)return fi;nB=1;var a=fi&&fi.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=fi&&fi.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=fi&&fi.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(fi,"__esModule",{value:!0}),fi.DatasetsCreateResponseDatasetPartsItem=void 0;const r=t($());return fi.DatasetsCreateResponseDatasetPartsItem=r.serialization.object({name:r.serialization.string().optional(),numRows:r.serialization.property("num_rows",r.serialization.number().optional()),samples:r.serialization.list(r.serialization.string()).optional(),partKind:r.serialization.property("part_kind",r.serialization.string().optional())}),fi}var di={},iB;function xue(){if(iB)return di;iB=1;var a=di&&di.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=di&&di.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=di&&di.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(di,"__esModule",{value:!0}),di.DatasetsCreateResponse=void 0;const r=t($());return di.DatasetsCreateResponse=r.serialization.object({id:r.serialization.string().optional()}),di}var hi={},aB;function $ue(){if(aB)return hi;aB=1;var a=hi&&hi.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=hi&&hi.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=hi&&hi.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(hi,"__esModule",{value:!0}),hi.DatasetsGetUsageResponse=void 0;const r=t($());return hi.DatasetsGetUsageResponse=r.serialization.object({organizationUsage:r.serialization.property("organization_usage",r.serialization.number().optional())}),hi}var pi={},oB;function Nue(){if(oB)return pi;oB=1;var a=pi&&pi.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),e=pi&&pi.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),t=pi&&pi.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&a(o,i,s);return e(o,i),o};Object.defineProperty(pi,"__esModule",{value:!0}),pi.DatasetsGetResponse=void 0;const r=t($()),n=FC();return pi.DatasetsGetResponse=r.serialization.object({dataset:n.Dataset}),pi}var sB;function P6(){return sB||(sB=1,function(a){var e=ac&&ac.__createBinding||(Object.create?function(r,n,i,o){o===void 0&&(o=i);var s=Object.getOwnPropertyDescriptor(n,i);(!s||("get"in s?!n.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(r,o,s)}:function(r,n,i,o){o===void 0&&(o=i),r[o]=n[i]}),t=ac&&ac.__exportStar||function(r,n){for(var i in r)i!=="default"&&!Object.prototype.hasOwnProperty.call(n,i)&&e(n,r,i)};Object.defineProperty(a,"__esModule",{value:!0}),t(Iue(),a),t(Due(),a),t(xue(),a),t($ue(),a),t(Nue(),a)}(ac)),ac}var _i={},yi={},uB;function que(){if(uB)return yi;uB=1;var a=yi&&yi.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=yi&&yi.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=yi&&yi.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(yi,"__esModule",{value:!0}),yi.Response=void 0;const r=t($());return yi.Response=r.serialization.record(r.serialization.string(),r.serialization.unknown()),yi}var lB;function zue(){if(lB)return _i;lB=1;var a=_i&&_i.__createBinding||(Object.create?function(r,n,i,o){o===void 0&&(o=i);var s=Object.getOwnPropertyDescriptor(n,i);(!s||("get"in s?!n.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(r,o,s)}:function(r,n,i,o){o===void 0&&(o=i),r[o]=n[i]}),e=_i&&_i.__setModuleDefault||(Object.create?function(r,n){Object.defineProperty(r,"default",{enumerable:!0,value:n})}:function(r,n){r.default=n}),t=_i&&_i.__importStar||function(r){if(r&&r.__esModule)return r;var n={};if(r!=null)for(var i in r)i!=="default"&&Object.prototype.hasOwnProperty.call(r,i)&&a(n,r,i);return e(n,r),n};return Object.defineProperty(_i,"__esModule",{value:!0}),_i.delete=void 0,_i.delete=t(que()),_i}var cB;function Bue(){return cB||(cB=1,function(a){var e=ic&&ic.__createBinding||(Object.create?function(r,n,i,o){o===void 0&&(o=i);var s=Object.getOwnPropertyDescriptor(n,i);(!s||("get"in s?!n.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(r,o,s)}:function(r,n,i,o){o===void 0&&(o=i),r[o]=n[i]}),t=ic&&ic.__exportStar||function(r,n){for(var i in r)i!=="default"&&!Object.prototype.hasOwnProperty.call(n,i)&&e(n,r,i)};Object.defineProperty(a,"__esModule",{value:!0}),t(P6(),a),t(zue(),a)}(ic)),ic}var oc={},bi={},sc={},uc={},mi={},fB;function j6(){if(fB)return mi;fB=1;var a=mi&&mi.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=mi&&mi.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=mi&&mi.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(mi,"__esModule",{value:!0}),mi.BaseType=void 0;const r=t($());return mi.BaseType=r.serialization.enum_(["BASE_TYPE_UNSPECIFIED","BASE_TYPE_GENERATIVE","BASE_TYPE_CLASSIFICATION","BASE_TYPE_RERANK","BASE_TYPE_CHAT"]),mi}var gi={},dB;function T6(){if(dB)return gi;dB=1;var a=gi&&gi.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=gi&&gi.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=gi&&gi.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(gi,"__esModule",{value:!0}),gi.Strategy=void 0;const r=t($());return gi.Strategy=r.serialization.enum_(["STRATEGY_UNSPECIFIED","STRATEGY_VANILLA","STRATEGY_TFEW"]),gi}var vi={},hB;function M6(){if(hB)return vi;hB=1;var a=vi&&vi.__createBinding||(Object.create?function(o,s,u,l){l===void 0&&(l=u);var c=Object.getOwnPropertyDescriptor(s,u);(!c||("get"in c?!s.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return s[u]}}),Object.defineProperty(o,l,c)}:function(o,s,u,l){l===void 0&&(l=u),o[l]=s[u]}),e=vi&&vi.__setModuleDefault||(Object.create?function(o,s){Object.defineProperty(o,"default",{enumerable:!0,value:s})}:function(o,s){o.default=s}),t=vi&&vi.__importStar||function(o){if(o&&o.__esModule)return o;var s={};if(o!=null)for(var u in o)u!=="default"&&Object.prototype.hasOwnProperty.call(o,u)&&a(s,o,u);return e(s,o),s};Object.defineProperty(vi,"__esModule",{value:!0}),vi.BaseModel=void 0;const r=t($()),n=j6(),i=T6();return vi.BaseModel=r.serialization.object({name:r.serialization.string().optional(),version:r.serialization.string().optional(),baseType:r.serialization.property("base_type",n.BaseType),strategy:i.Strategy.optional()}),vi}var wi={},pB;function A6(){if(pB)return wi;pB=1;var a=wi&&wi.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=wi&&wi.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=wi&&wi.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(wi,"__esModule",{value:!0}),wi.LoraTargetModules=void 0;const r=t($());return wi.LoraTargetModules=r.serialization.enum_(["LORA_TARGET_MODULES_UNSPECIFIED","LORA_TARGET_MODULES_QV","LORA_TARGET_MODULES_QKVO","LORA_TARGET_MODULES_QKVO_FFN"]),wi}var Oi={},_B;function I6(){if(_B)return Oi;_B=1;var a=Oi&&Oi.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),e=Oi&&Oi.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),t=Oi&&Oi.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&a(o,i,s);return e(o,i),o};Object.defineProperty(Oi,"__esModule",{value:!0}),Oi.Hyperparameters=void 0;const r=t($()),n=A6();return Oi.Hyperparameters=r.serialization.object({earlyStoppingPatience:r.serialization.property("early_stopping_patience",r.serialization.number().optional()),earlyStoppingThreshold:r.serialization.property("early_stopping_threshold",r.serialization.number().optional()),trainBatchSize:r.serialization.property("train_batch_size",r.serialization.number().optional()),trainEpochs:r.serialization.property("train_epochs",r.serialization.number().optional()),learningRate:r.serialization.property("learning_rate",r.serialization.number().optional()),loraAlpha:r.serialization.property("lora_alpha",r.serialization.number().optional()),loraRank:r.serialization.property("lora_rank",r.serialization.number().optional()),loraTargetModules:r.serialization.property("lora_target_modules",n.LoraTargetModules.optional())}),Oi}var Si={},yB;function D6(){if(yB)return Si;yB=1;var a=Si&&Si.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=Si&&Si.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=Si&&Si.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(Si,"__esModule",{value:!0}),Si.WandbConfig=void 0;const r=t($());return Si.WandbConfig=r.serialization.object({project:r.serialization.string(),apiKey:r.serialization.property("api_key",r.serialization.string()),entity:r.serialization.string().optional()}),Si}var Ei={},bB;function LC(){if(bB)return Ei;bB=1;var a=Ei&&Ei.__createBinding||(Object.create?function(s,u,l,c){c===void 0&&(c=l);var f=Object.getOwnPropertyDescriptor(u,l);(!f||("get"in f?!u.__esModule:f.writable||f.configurable))&&(f={enumerable:!0,get:function(){return u[l]}}),Object.defineProperty(s,c,f)}:function(s,u,l,c){c===void 0&&(c=l),s[c]=u[l]}),e=Ei&&Ei.__setModuleDefault||(Object.create?function(s,u){Object.defineProperty(s,"default",{enumerable:!0,value:u})}:function(s,u){s.default=u}),t=Ei&&Ei.__importStar||function(s){if(s&&s.__esModule)return s;var u={};if(s!=null)for(var l in s)l!=="default"&&Object.prototype.hasOwnProperty.call(s,l)&&a(u,s,l);return e(u,s),u};Object.defineProperty(Ei,"__esModule",{value:!0}),Ei.Settings=void 0;const r=t($()),n=M6(),i=I6(),o=D6();return Ei.Settings=r.serialization.object({baseModel:r.serialization.property("base_model",n.BaseModel),datasetId:r.serialization.property("dataset_id",r.serialization.string()),hyperparameters:i.Hyperparameters.optional(),multiLabel:r.serialization.property("multi_label",r.serialization.boolean().optional()),wandb:o.WandbConfig.optional()}),Ei}var Ri={},mB;function kb(){if(mB)return Ri;mB=1;var a=Ri&&Ri.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=Ri&&Ri.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=Ri&&Ri.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(Ri,"__esModule",{value:!0}),Ri.Status=void 0;const r=t($());return Ri.Status=r.serialization.enum_(["STATUS_UNSPECIFIED","STATUS_FINETUNING","STATUS_DEPLOYING_API","STATUS_READY","STATUS_FAILED","STATUS_DELETED","STATUS_TEMPORARILY_OFFLINE","STATUS_PAUSED","STATUS_QUEUED"]),Ri}var Ci={},gB;function i_(){if(gB)return Ci;gB=1;var a=Ci&&Ci.__createBinding||(Object.create?function(o,s,u,l){l===void 0&&(l=u);var c=Object.getOwnPropertyDescriptor(s,u);(!c||("get"in c?!s.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return s[u]}}),Object.defineProperty(o,l,c)}:function(o,s,u,l){l===void 0&&(l=u),o[l]=s[u]}),e=Ci&&Ci.__setModuleDefault||(Object.create?function(o,s){Object.defineProperty(o,"default",{enumerable:!0,value:s})}:function(o,s){o.default=s}),t=Ci&&Ci.__importStar||function(o){if(o&&o.__esModule)return o;var s={};if(o!=null)for(var u in o)u!=="default"&&Object.prototype.hasOwnProperty.call(o,u)&&a(s,o,u);return e(s,o),s};Object.defineProperty(Ci,"__esModule",{value:!0}),Ci.FinetunedModel=void 0;const r=t($()),n=LC(),i=kb();return Ci.FinetunedModel=r.serialization.object({id:r.serialization.string().optional(),name:r.serialization.string(),creatorId:r.serialization.property("creator_id",r.serialization.string().optional()),organizationId:r.serialization.property("organization_id",r.serialization.string().optional()),settings:n.Settings,status:i.Status.optional(),createdAt:r.serialization.property("created_at",r.serialization.date().optional()),updatedAt:r.serialization.property("updated_at",r.serialization.date().optional()),completedAt:r.serialization.property("completed_at",r.serialization.date().optional()),lastUsed:r.serialization.property("last_used",r.serialization.date().optional())}),Ci}var Pi={},vB;function Uue(){if(vB)return Pi;vB=1;var a=Pi&&Pi.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),e=Pi&&Pi.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),t=Pi&&Pi.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&a(o,i,s);return e(o,i),o};Object.defineProperty(Pi,"__esModule",{value:!0}),Pi.ListFinetunedModelsResponse=void 0;const r=t($()),n=i_();return Pi.ListFinetunedModelsResponse=r.serialization.object({finetunedModels:r.serialization.property("finetuned_models",r.serialization.list(n.FinetunedModel).optional()),nextPageToken:r.serialization.property("next_page_token",r.serialization.string().optional()),totalSize:r.serialization.property("total_size",r.serialization.number().optional())}),Pi}var ji={},wB;function Fue(){if(wB)return ji;wB=1;var a=ji&&ji.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),e=ji&&ji.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),t=ji&&ji.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&a(o,i,s);return e(o,i),o};Object.defineProperty(ji,"__esModule",{value:!0}),ji.CreateFinetunedModelResponse=void 0;const r=t($()),n=i_();return ji.CreateFinetunedModelResponse=r.serialization.object({finetunedModel:r.serialization.property("finetuned_model",n.FinetunedModel.optional())}),ji}var Ti={},OB;function Lue(){if(OB)return Ti;OB=1;var a=Ti&&Ti.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),e=Ti&&Ti.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),t=Ti&&Ti.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&a(o,i,s);return e(o,i),o};Object.defineProperty(Ti,"__esModule",{value:!0}),Ti.GetFinetunedModelResponse=void 0;const r=t($()),n=i_();return Ti.GetFinetunedModelResponse=r.serialization.object({finetunedModel:r.serialization.property("finetuned_model",n.FinetunedModel.optional())}),Ti}var Mi={},SB;function Vue(){if(SB)return Mi;SB=1;var a=Mi&&Mi.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=Mi&&Mi.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=Mi&&Mi.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(Mi,"__esModule",{value:!0}),Mi.DeleteFinetunedModelResponse=void 0;const r=t($());return Mi.DeleteFinetunedModelResponse=r.serialization.record(r.serialization.string(),r.serialization.unknown()),Mi}var Ai={},EB;function Gue(){if(EB)return Ai;EB=1;var a=Ai&&Ai.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),e=Ai&&Ai.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),t=Ai&&Ai.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&a(o,i,s);return e(o,i),o};Object.defineProperty(Ai,"__esModule",{value:!0}),Ai.UpdateFinetunedModelResponse=void 0;const r=t($()),n=i_();return Ai.UpdateFinetunedModelResponse=r.serialization.object({finetunedModel:r.serialization.property("finetuned_model",n.FinetunedModel.optional())}),Ai}var Ii={},RB;function x6(){if(RB)return Ii;RB=1;var a=Ii&&Ii.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),e=Ii&&Ii.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),t=Ii&&Ii.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&a(o,i,s);return e(o,i),o};Object.defineProperty(Ii,"__esModule",{value:!0}),Ii.Event=void 0;const r=t($()),n=kb();return Ii.Event=r.serialization.object({userId:r.serialization.property("user_id",r.serialization.string().optional()),status:n.Status.optional(),createdAt:r.serialization.property("created_at",r.serialization.date().optional())}),Ii}var Di={},CB;function kue(){if(CB)return Di;CB=1;var a=Di&&Di.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),e=Di&&Di.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),t=Di&&Di.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&a(o,i,s);return e(o,i),o};Object.defineProperty(Di,"__esModule",{value:!0}),Di.ListEventsResponse=void 0;const r=t($()),n=x6();return Di.ListEventsResponse=r.serialization.object({events:r.serialization.list(n.Event).optional(),nextPageToken:r.serialization.property("next_page_token",r.serialization.string().optional()),totalSize:r.serialization.property("total_size",r.serialization.number().optional())}),Di}var xi={},PB;function $6(){if(PB)return xi;PB=1;var a=xi&&xi.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=xi&&xi.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=xi&&xi.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(xi,"__esModule",{value:!0}),xi.TrainingStepMetrics=void 0;const r=t($());return xi.TrainingStepMetrics=r.serialization.object({createdAt:r.serialization.property("created_at",r.serialization.date().optional()),stepNumber:r.serialization.property("step_number",r.serialization.number().optional()),metrics:r.serialization.record(r.serialization.string(),r.serialization.number()).optional()}),xi}var $i={},jB;function Hue(){if(jB)return $i;jB=1;var a=$i&&$i.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),e=$i&&$i.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),t=$i&&$i.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&a(o,i,s);return e(o,i),o};Object.defineProperty($i,"__esModule",{value:!0}),$i.ListTrainingStepMetricsResponse=void 0;const r=t($()),n=$6();return $i.ListTrainingStepMetricsResponse=r.serialization.object({stepMetrics:r.serialization.property("step_metrics",r.serialization.list(n.TrainingStepMetrics).optional()),nextPageToken:r.serialization.property("next_page_token",r.serialization.string().optional())}),$i}var TB;function N6(){return TB||(TB=1,function(a){var e=uc&&uc.__createBinding||(Object.create?function(r,n,i,o){o===void 0&&(o=i);var s=Object.getOwnPropertyDescriptor(n,i);(!s||("get"in s?!n.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(r,o,s)}:function(r,n,i,o){o===void 0&&(o=i),r[o]=n[i]}),t=uc&&uc.__exportStar||function(r,n){for(var i in r)i!=="default"&&!Object.prototype.hasOwnProperty.call(n,i)&&e(n,r,i)};Object.defineProperty(a,"__esModule",{value:!0}),t(j6(),a),t(T6(),a),t(M6(),a),t(A6(),a),t(I6(),a),t(D6(),a),t(LC(),a),t(kb(),a),t(i_(),a),t(Uue(),a),t(Fue(),a),t(Lue(),a),t(Vue(),a),t(Gue(),a),t(x6(),a),t(kue(),a),t($6(),a),t(Hue(),a)}(uc)),uc}var MB;function Wue(){return MB||(MB=1,function(a){var e=sc&&sc.__createBinding||(Object.create?function(r,n,i,o){o===void 0&&(o=i);var s=Object.getOwnPropertyDescriptor(n,i);(!s||("get"in s?!n.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(r,o,s)}:function(r,n,i,o){o===void 0&&(o=i),r[o]=n[i]}),t=sc&&sc.__exportStar||function(r,n){for(var i in r)i!=="default"&&!Object.prototype.hasOwnProperty.call(n,i)&&e(n,r,i)};Object.defineProperty(a,"__esModule",{value:!0}),t(N6(),a)}(sc)),sc}var AB;function Kue(){return AB||(AB=1,function(a){var e=bi&&bi.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),t=bi&&bi.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),r=bi&&bi.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&e(o,i,s);return t(o,i),o},n=bi&&bi.__exportStar||function(i,o){for(var s in i)s!=="default"&&!Object.prototype.hasOwnProperty.call(o,s)&&e(o,i,s)};Object.defineProperty(a,"__esModule",{value:!0}),a.finetuning=void 0,a.finetuning=r(Wue()),n(N6(),a)}(bi)),bi}var lc={},sE={},Ni={},IB;function Jue(){if(IB)return Ni;IB=1;var a=Ni&&Ni.__createBinding||(Object.create?function(o,s,u,l){l===void 0&&(l=u);var c=Object.getOwnPropertyDescriptor(s,u);(!c||("get"in c?!s.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return s[u]}}),Object.defineProperty(o,l,c)}:function(o,s,u,l){l===void 0&&(l=u),o[l]=s[u]}),e=Ni&&Ni.__setModuleDefault||(Object.create?function(o,s){Object.defineProperty(o,"default",{enumerable:!0,value:s})}:function(o,s){o.default=s}),t=Ni&&Ni.__importStar||function(o){if(o&&o.__esModule)return o;var s={};if(o!=null)for(var u in o)u!=="default"&&Object.prototype.hasOwnProperty.call(o,u)&&a(s,o,u);return e(s,o),s};Object.defineProperty(Ni,"__esModule",{value:!0}),Ni.FinetuningUpdateFinetunedModelRequest=void 0;const r=t($()),n=LC(),i=kb();return Ni.FinetuningUpdateFinetunedModelRequest=r.serialization.object({name:r.serialization.string(),creatorId:r.serialization.property("creator_id",r.serialization.string().optional()),organizationId:r.serialization.property("organization_id",r.serialization.string().optional()),settings:n.Settings,status:i.Status.optional(),createdAt:r.serialization.property("created_at",r.serialization.date().optional()),updatedAt:r.serialization.property("updated_at",r.serialization.date().optional()),completedAt:r.serialization.property("completed_at",r.serialization.date().optional()),lastUsed:r.serialization.property("last_used",r.serialization.date().optional())}),Ni}var DB;function q6(){return DB||(DB=1,function(a){Object.defineProperty(a,"__esModule",{value:!0}),a.FinetuningUpdateFinetunedModelRequest=void 0;var e=Jue();Object.defineProperty(a,"FinetuningUpdateFinetunedModelRequest",{enumerable:!0,get:function(){return e.FinetuningUpdateFinetunedModelRequest}})}(sE)),sE}var xB;function Xue(){return xB||(xB=1,function(a){var e=lc&&lc.__createBinding||(Object.create?function(r,n,i,o){o===void 0&&(o=i);var s=Object.getOwnPropertyDescriptor(n,i);(!s||("get"in s?!n.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(r,o,s)}:function(r,n,i,o){o===void 0&&(o=i),r[o]=n[i]}),t=lc&&lc.__exportStar||function(r,n){for(var i in r)i!=="default"&&!Object.prototype.hasOwnProperty.call(n,i)&&e(n,r,i)};Object.defineProperty(a,"__esModule",{value:!0}),t(q6(),a)}(lc)),lc}var $B;function Zue(){return $B||($B=1,function(a){var e=oc&&oc.__createBinding||(Object.create?function(r,n,i,o){o===void 0&&(o=i);var s=Object.getOwnPropertyDescriptor(n,i);(!s||("get"in s?!n.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(r,o,s)}:function(r,n,i,o){o===void 0&&(o=i),r[o]=n[i]}),t=oc&&oc.__exportStar||function(r,n){for(var i in r)i!=="default"&&!Object.prototype.hasOwnProperty.call(n,i)&&e(n,r,i)};Object.defineProperty(a,"__esModule",{value:!0}),t(Kue(),a),t(Xue(),a)}(oc)),oc}var cc={},fc={},uE={},qi={},zi={},NB;function VC(){if(NB)return zi;NB=1;var a=zi&&zi.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=zi&&zi.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=zi&&zi.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(zi,"__esModule",{value:!0}),zi.CreateConnectorOAuth=void 0;const r=t($());return zi.CreateConnectorOAuth=r.serialization.object({clientId:r.serialization.property("client_id",r.serialization.string().optional()),clientSecret:r.serialization.property("client_secret",r.serialization.string().optional()),authorizeUrl:r.serialization.property("authorize_url",r.serialization.string().optional()),tokenUrl:r.serialization.property("token_url",r.serialization.string().optional()),scope:r.serialization.string().optional()}),zi}var Bi={},Ui={},qB;function z6(){if(qB)return Ui;qB=1;var a=Ui&&Ui.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=Ui&&Ui.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=Ui&&Ui.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(Ui,"__esModule",{value:!0}),Ui.AuthTokenType=void 0;const r=t($());return Ui.AuthTokenType=r.serialization.enum_(["bearer","basic","noscheme"]),Ui}var zB;function GC(){if(zB)return Bi;zB=1;var a=Bi&&Bi.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),e=Bi&&Bi.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),t=Bi&&Bi.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&a(o,i,s);return e(o,i),o};Object.defineProperty(Bi,"__esModule",{value:!0}),Bi.CreateConnectorServiceAuth=void 0;const r=t($()),n=z6();return Bi.CreateConnectorServiceAuth=r.serialization.object({type:n.AuthTokenType,token:r.serialization.string()}),Bi}var BB;function Que(){if(BB)return qi;BB=1;var a=qi&&qi.__createBinding||(Object.create?function(o,s,u,l){l===void 0&&(l=u);var c=Object.getOwnPropertyDescriptor(s,u);(!c||("get"in c?!s.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return s[u]}}),Object.defineProperty(o,l,c)}:function(o,s,u,l){l===void 0&&(l=u),o[l]=s[u]}),e=qi&&qi.__setModuleDefault||(Object.create?function(o,s){Object.defineProperty(o,"default",{enumerable:!0,value:s})}:function(o,s){o.default=s}),t=qi&&qi.__importStar||function(o){if(o&&o.__esModule)return o;var s={};if(o!=null)for(var u in o)u!=="default"&&Object.prototype.hasOwnProperty.call(o,u)&&a(s,o,u);return e(s,o),s};Object.defineProperty(qi,"__esModule",{value:!0}),qi.CreateConnectorRequest=void 0;const r=t($()),n=VC(),i=GC();return qi.CreateConnectorRequest=r.serialization.object({name:r.serialization.string(),description:r.serialization.string().optional(),url:r.serialization.string(),excludes:r.serialization.list(r.serialization.string()).optional(),oauth:n.CreateConnectorOAuth.optional(),active:r.serialization.boolean().optional(),continueOnFailure:r.serialization.property("continue_on_failure",r.serialization.boolean().optional()),serviceAuth:r.serialization.property("service_auth",i.CreateConnectorServiceAuth.optional())}),qi}var Fi={},UB;function Yue(){if(UB)return Fi;UB=1;var a=Fi&&Fi.__createBinding||(Object.create?function(o,s,u,l){l===void 0&&(l=u);var c=Object.getOwnPropertyDescriptor(s,u);(!c||("get"in c?!s.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return s[u]}}),Object.defineProperty(o,l,c)}:function(o,s,u,l){l===void 0&&(l=u),o[l]=s[u]}),e=Fi&&Fi.__setModuleDefault||(Object.create?function(o,s){Object.defineProperty(o,"default",{enumerable:!0,value:s})}:function(o,s){o.default=s}),t=Fi&&Fi.__importStar||function(o){if(o&&o.__esModule)return o;var s={};if(o!=null)for(var u in o)u!=="default"&&Object.prototype.hasOwnProperty.call(o,u)&&a(s,o,u);return e(s,o),s};Object.defineProperty(Fi,"__esModule",{value:!0}),Fi.UpdateConnectorRequest=void 0;const r=t($()),n=VC(),i=GC();return Fi.UpdateConnectorRequest=r.serialization.object({name:r.serialization.string().optional(),url:r.serialization.string().optional(),excludes:r.serialization.list(r.serialization.string()).optional(),oauth:n.CreateConnectorOAuth.optional(),active:r.serialization.boolean().optional(),continueOnFailure:r.serialization.property("continue_on_failure",r.serialization.boolean().optional()),serviceAuth:r.serialization.property("service_auth",i.CreateConnectorServiceAuth.optional())}),Fi}var FB;function B6(){return FB||(FB=1,function(a){Object.defineProperty(a,"__esModule",{value:!0}),a.UpdateConnectorRequest=a.CreateConnectorRequest=void 0;var e=Que();Object.defineProperty(a,"CreateConnectorRequest",{enumerable:!0,get:function(){return e.CreateConnectorRequest}});var t=Yue();Object.defineProperty(a,"UpdateConnectorRequest",{enumerable:!0,get:function(){return t.UpdateConnectorRequest}})}(uE)),uE}var LB;function ele(){return LB||(LB=1,function(a){var e=fc&&fc.__createBinding||(Object.create?function(r,n,i,o){o===void 0&&(o=i);var s=Object.getOwnPropertyDescriptor(n,i);(!s||("get"in s?!n.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(r,o,s)}:function(r,n,i,o){o===void 0&&(o=i),r[o]=n[i]}),t=fc&&fc.__exportStar||function(r,n){for(var i in r)i!=="default"&&!Object.prototype.hasOwnProperty.call(n,i)&&e(n,r,i)};Object.defineProperty(a,"__esModule",{value:!0}),t(B6(),a)}(fc)),fc}var VB;function tle(){return VB||(VB=1,function(a){var e=cc&&cc.__createBinding||(Object.create?function(r,n,i,o){o===void 0&&(o=i);var s=Object.getOwnPropertyDescriptor(n,i);(!s||("get"in s?!n.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(r,o,s)}:function(r,n,i,o){o===void 0&&(o=i),r[o]=n[i]}),t=cc&&cc.__exportStar||function(r,n){for(var i in r)i!=="default"&&!Object.prototype.hasOwnProperty.call(n,i)&&e(n,r,i)};Object.defineProperty(a,"__esModule",{value:!0}),t(ele(),a)}(cc)),cc}var GB;function rle(){return GB||(GB=1,function(a){var e=nn&&nn.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),t=nn&&nn.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),r=nn&&nn.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&e(o,i,s);return t(o,i),o},n=nn&&nn.__exportStar||function(i,o){for(var s in i)s!=="default"&&!Object.prototype.hasOwnProperty.call(o,s)&&e(o,i,s)};Object.defineProperty(a,"__esModule",{value:!0}),a.connectors=a.finetuning=a.datasets=a.embedJobs=a.v2=void 0,a.v2=r(jue()),n(KG(),a),a.embedJobs=r(Aue()),n(O6(),a),a.datasets=r(Bue()),n(P6(),a),a.finetuning=r(Zue()),n(v6(),a),n(S6(),a),a.connectors=r(tle()),n(B6(),a),n(q6(),a)}(nn)),nn}var dc={},Li={},kB;function U6(){if(kB)return Li;kB=1;var a=Li&&Li.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=Li&&Li.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=Li&&Li.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(Li,"__esModule",{value:!0}),Li.ChatStreamRequestPromptTruncation=void 0;const r=t($());return Li.ChatStreamRequestPromptTruncation=r.serialization.enum_(["OFF","AUTO","AUTO_PRESERVE_ORDER"]),Li}var Vi={},HB;function F6(){if(HB)return Vi;HB=1;var a=Vi&&Vi.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=Vi&&Vi.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=Vi&&Vi.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(Vi,"__esModule",{value:!0}),Vi.ChatStreamRequestCitationQuality=void 0;const r=t($());return Vi.ChatStreamRequestCitationQuality=r.serialization.enum_(["fast","accurate","off"]),Vi}var Gi={},WB;function nle(){if(WB)return Gi;WB=1;var a=Gi&&Gi.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=Gi&&Gi.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=Gi&&Gi.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(Gi,"__esModule",{value:!0}),Gi.ChatStreamRequestConnectorsSearchOptions=void 0;const r=t($());return Gi.ChatStreamRequestConnectorsSearchOptions=r.serialization.object({seed:r.serialization.number().optional()}),Gi}var ki={},KB;function L6(){if(KB)return ki;KB=1;var a=ki&&ki.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=ki&&ki.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=ki&&ki.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(ki,"__esModule",{value:!0}),ki.ChatStreamRequestSafetyMode=void 0;const r=t($());return ki.ChatStreamRequestSafetyMode=r.serialization.enum_(["CONTEXTUAL","STRICT","NONE"]),ki}var Hi={},JB;function V6(){if(JB)return Hi;JB=1;var a=Hi&&Hi.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=Hi&&Hi.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=Hi&&Hi.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(Hi,"__esModule",{value:!0}),Hi.ChatRequestPromptTruncation=void 0;const r=t($());return Hi.ChatRequestPromptTruncation=r.serialization.enum_(["OFF","AUTO","AUTO_PRESERVE_ORDER"]),Hi}var Wi={},XB;function G6(){if(XB)return Wi;XB=1;var a=Wi&&Wi.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=Wi&&Wi.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=Wi&&Wi.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(Wi,"__esModule",{value:!0}),Wi.ChatRequestCitationQuality=void 0;const r=t($());return Wi.ChatRequestCitationQuality=r.serialization.enum_(["fast","accurate","off"]),Wi}var Ki={},ZB;function ile(){if(ZB)return Ki;ZB=1;var a=Ki&&Ki.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=Ki&&Ki.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=Ki&&Ki.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(Ki,"__esModule",{value:!0}),Ki.ChatRequestConnectorsSearchOptions=void 0;const r=t($());return Ki.ChatRequestConnectorsSearchOptions=r.serialization.object({seed:r.serialization.number().optional()}),Ki}var Ji={},QB;function k6(){if(QB)return Ji;QB=1;var a=Ji&&Ji.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=Ji&&Ji.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=Ji&&Ji.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(Ji,"__esModule",{value:!0}),Ji.ChatRequestSafetyMode=void 0;const r=t($());return Ji.ChatRequestSafetyMode=r.serialization.enum_(["CONTEXTUAL","STRICT","NONE"]),Ji}var Xi={},YB;function H6(){if(YB)return Xi;YB=1;var a=Xi&&Xi.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=Xi&&Xi.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=Xi&&Xi.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(Xi,"__esModule",{value:!0}),Xi.GenerateStreamRequestTruncate=void 0;const r=t($());return Xi.GenerateStreamRequestTruncate=r.serialization.enum_(["NONE","START","END"]),Xi}var Zi={},eU;function W6(){if(eU)return Zi;eU=1;var a=Zi&&Zi.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=Zi&&Zi.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=Zi&&Zi.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(Zi,"__esModule",{value:!0}),Zi.GenerateStreamRequestReturnLikelihoods=void 0;const r=t($());return Zi.GenerateStreamRequestReturnLikelihoods=r.serialization.enum_(["GENERATION","ALL","NONE"]),Zi}var Qi={},tU;function K6(){if(tU)return Qi;tU=1;var a=Qi&&Qi.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=Qi&&Qi.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=Qi&&Qi.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(Qi,"__esModule",{value:!0}),Qi.GenerateRequestTruncate=void 0;const r=t($());return Qi.GenerateRequestTruncate=r.serialization.enum_(["NONE","START","END"]),Qi}var Yi={},rU;function J6(){if(rU)return Yi;rU=1;var a=Yi&&Yi.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=Yi&&Yi.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=Yi&&Yi.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(Yi,"__esModule",{value:!0}),Yi.GenerateRequestReturnLikelihoods=void 0;const r=t($());return Yi.GenerateRequestReturnLikelihoods=r.serialization.enum_(["GENERATION","ALL","NONE"]),Yi}var ea={},nU;function X6(){if(nU)return ea;nU=1;var a=ea&&ea.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=ea&&ea.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=ea&&ea.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(ea,"__esModule",{value:!0}),ea.EmbedRequestTruncate=void 0;const r=t($());return ea.EmbedRequestTruncate=r.serialization.enum_(["NONE","START","END"]),ea}var ta={},ra={},na={},iU;function kC(){if(iU)return na;iU=1;var a=na&&na.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=na&&na.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=na&&na.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(na,"__esModule",{value:!0}),na.Image=void 0;const r=t($());return na.Image=r.serialization.object({width:r.serialization.number(),height:r.serialization.number(),format:r.serialization.string(),bitDepth:r.serialization.property("bit_depth",r.serialization.number())}),na}var aU;function Z6(){if(aU)return ra;aU=1;var a=ra&&ra.__createBinding||(Object.create?function(o,s,u,l){l===void 0&&(l=u);var c=Object.getOwnPropertyDescriptor(s,u);(!c||("get"in c?!s.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return s[u]}}),Object.defineProperty(o,l,c)}:function(o,s,u,l){l===void 0&&(l=u),o[l]=s[u]}),e=ra&&ra.__setModuleDefault||(Object.create?function(o,s){Object.defineProperty(o,"default",{enumerable:!0,value:s})}:function(o,s){o.default=s}),t=ra&&ra.__importStar||function(o){if(o&&o.__esModule)return o;var s={};if(o!=null)for(var u in o)u!=="default"&&Object.prototype.hasOwnProperty.call(o,u)&&a(s,o,u);return e(s,o),s};Object.defineProperty(ra,"__esModule",{value:!0}),ra.EmbedFloatsResponse=void 0;const r=t($()),n=kC(),i=Er();return ra.EmbedFloatsResponse=r.serialization.object({id:r.serialization.string(),embeddings:r.serialization.list(r.serialization.list(r.serialization.number())),texts:r.serialization.list(r.serialization.string()),images:r.serialization.list(n.Image).optional(),meta:i.ApiMeta.optional()}),ra}var ia={},aa={},oU;function Q6(){if(oU)return aa;oU=1;var a=aa&&aa.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=aa&&aa.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=aa&&aa.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(aa,"__esModule",{value:!0}),aa.EmbedByTypeResponseEmbeddings=void 0;const r=t($());return aa.EmbedByTypeResponseEmbeddings=r.serialization.object({float:r.serialization.list(r.serialization.list(r.serialization.number())).optional(),int8:r.serialization.list(r.serialization.list(r.serialization.number())).optional(),uint8:r.serialization.list(r.serialization.list(r.serialization.number())).optional(),binary:r.serialization.list(r.serialization.list(r.serialization.number())).optional(),ubinary:r.serialization.list(r.serialization.list(r.serialization.number())).optional()}),aa}var sU;function Y6(){if(sU)return ia;sU=1;var a=ia&&ia.__createBinding||(Object.create?function(s,u,l,c){c===void 0&&(c=l);var f=Object.getOwnPropertyDescriptor(u,l);(!f||("get"in f?!u.__esModule:f.writable||f.configurable))&&(f={enumerable:!0,get:function(){return u[l]}}),Object.defineProperty(s,c,f)}:function(s,u,l,c){c===void 0&&(c=l),s[c]=u[l]}),e=ia&&ia.__setModuleDefault||(Object.create?function(s,u){Object.defineProperty(s,"default",{enumerable:!0,value:u})}:function(s,u){s.default=u}),t=ia&&ia.__importStar||function(s){if(s&&s.__esModule)return s;var u={};if(s!=null)for(var l in s)l!=="default"&&Object.prototype.hasOwnProperty.call(s,l)&&a(u,s,l);return e(u,s),u};Object.defineProperty(ia,"__esModule",{value:!0}),ia.EmbedByTypeResponse=void 0;const r=t($()),n=Q6(),i=kC(),o=Er();return ia.EmbedByTypeResponse=r.serialization.object({id:r.serialization.string(),embeddings:n.EmbedByTypeResponseEmbeddings,texts:r.serialization.list(r.serialization.string()),images:r.serialization.list(i.Image).optional(),meta:o.ApiMeta.optional()}),ia}var uU;function ale(){if(uU)return ta;uU=1;var a=ta&&ta.__createBinding||(Object.create?function(o,s,u,l){l===void 0&&(l=u);var c=Object.getOwnPropertyDescriptor(s,u);(!c||("get"in c?!s.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return s[u]}}),Object.defineProperty(o,l,c)}:function(o,s,u,l){l===void 0&&(l=u),o[l]=s[u]}),e=ta&&ta.__setModuleDefault||(Object.create?function(o,s){Object.defineProperty(o,"default",{enumerable:!0,value:s})}:function(o,s){o.default=s}),t=ta&&ta.__importStar||function(o){if(o&&o.__esModule)return o;var s={};if(o!=null)for(var u in o)u!=="default"&&Object.prototype.hasOwnProperty.call(o,u)&&a(s,o,u);return e(s,o),s};Object.defineProperty(ta,"__esModule",{value:!0}),ta.EmbedResponse=void 0;const r=t($()),n=Z6(),i=Y6();return ta.EmbedResponse=r.serialization.union(r.serialization.discriminant("responseType","response_type"),{embeddings_floats:n.EmbedFloatsResponse,embeddings_by_type:i.EmbedByTypeResponse}).transform({transform:o=>o,untransform:o=>o}),ta}var oa={},sa={},lU;function ek(){if(lU)return sa;lU=1;var a=sa&&sa.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=sa&&sa.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=sa&&sa.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(sa,"__esModule",{value:!0}),sa.RerankDocument=void 0;const r=t($());return sa.RerankDocument=r.serialization.record(r.serialization.string(),r.serialization.string()),sa}var cU;function tk(){if(cU)return oa;cU=1;var a=oa&&oa.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),e=oa&&oa.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),t=oa&&oa.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&a(o,i,s);return e(o,i),o};Object.defineProperty(oa,"__esModule",{value:!0}),oa.RerankRequestDocumentsItem=void 0;const r=t($()),n=ek();return oa.RerankRequestDocumentsItem=r.serialization.undiscriminatedUnion([r.serialization.string(),n.RerankDocument]),oa}var ua={},fU;function rk(){if(fU)return ua;fU=1;var a=ua&&ua.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=ua&&ua.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=ua&&ua.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(ua,"__esModule",{value:!0}),ua.RerankResponseResultsItemDocument=void 0;const r=t($());return ua.RerankResponseResultsItemDocument=r.serialization.object({text:r.serialization.string()}),ua}var la={},dU;function nk(){if(dU)return la;dU=1;var a=la&&la.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),e=la&&la.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),t=la&&la.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&a(o,i,s);return e(o,i),o};Object.defineProperty(la,"__esModule",{value:!0}),la.RerankResponseResultsItem=void 0;const r=t($()),n=rk();return la.RerankResponseResultsItem=r.serialization.object({document:n.RerankResponseResultsItemDocument.optional(),index:r.serialization.number(),relevanceScore:r.serialization.property("relevance_score",r.serialization.number())}),la}var ca={},hU;function ole(){if(hU)return ca;hU=1;var a=ca&&ca.__createBinding||(Object.create?function(o,s,u,l){l===void 0&&(l=u);var c=Object.getOwnPropertyDescriptor(s,u);(!c||("get"in c?!s.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return s[u]}}),Object.defineProperty(o,l,c)}:function(o,s,u,l){l===void 0&&(l=u),o[l]=s[u]}),e=ca&&ca.__setModuleDefault||(Object.create?function(o,s){Object.defineProperty(o,"default",{enumerable:!0,value:s})}:function(o,s){o.default=s}),t=ca&&ca.__importStar||function(o){if(o&&o.__esModule)return o;var s={};if(o!=null)for(var u in o)u!=="default"&&Object.prototype.hasOwnProperty.call(o,u)&&a(s,o,u);return e(s,o),s};Object.defineProperty(ca,"__esModule",{value:!0}),ca.RerankResponse=void 0;const r=t($()),n=nk(),i=Er();return ca.RerankResponse=r.serialization.object({id:r.serialization.string().optional(),results:r.serialization.list(n.RerankResponseResultsItem),meta:i.ApiMeta.optional()}),ca}var fa={},pU;function ik(){if(pU)return fa;pU=1;var a=fa&&fa.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=fa&&fa.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=fa&&fa.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(fa,"__esModule",{value:!0}),fa.ClassifyRequestTruncate=void 0;const r=t($());return fa.ClassifyRequestTruncate=r.serialization.enum_(["NONE","START","END"]),fa}var da={},_U;function ak(){if(_U)return da;_U=1;var a=da&&da.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=da&&da.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=da&&da.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(da,"__esModule",{value:!0}),da.ClassifyResponseClassificationsItemLabelsValue=void 0;const r=t($());return da.ClassifyResponseClassificationsItemLabelsValue=r.serialization.object({confidence:r.serialization.number().optional()}),da}var ha={},yU;function ok(){if(yU)return ha;yU=1;var a=ha&&ha.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=ha&&ha.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=ha&&ha.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(ha,"__esModule",{value:!0}),ha.ClassifyResponseClassificationsItemClassificationType=void 0;const r=t($());return ha.ClassifyResponseClassificationsItemClassificationType=r.serialization.enum_(["single-label","multi-label"]),ha}var pa={},bU;function sk(){if(bU)return pa;bU=1;var a=pa&&pa.__createBinding||(Object.create?function(o,s,u,l){l===void 0&&(l=u);var c=Object.getOwnPropertyDescriptor(s,u);(!c||("get"in c?!s.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return s[u]}}),Object.defineProperty(o,l,c)}:function(o,s,u,l){l===void 0&&(l=u),o[l]=s[u]}),e=pa&&pa.__setModuleDefault||(Object.create?function(o,s){Object.defineProperty(o,"default",{enumerable:!0,value:s})}:function(o,s){o.default=s}),t=pa&&pa.__importStar||function(o){if(o&&o.__esModule)return o;var s={};if(o!=null)for(var u in o)u!=="default"&&Object.prototype.hasOwnProperty.call(o,u)&&a(s,o,u);return e(s,o),s};Object.defineProperty(pa,"__esModule",{value:!0}),pa.ClassifyResponseClassificationsItem=void 0;const r=t($()),n=ak(),i=ok();return pa.ClassifyResponseClassificationsItem=r.serialization.object({id:r.serialization.string(),input:r.serialization.string().optional(),prediction:r.serialization.string().optional(),predictions:r.serialization.list(r.serialization.string()),confidence:r.serialization.number().optional(),confidences:r.serialization.list(r.serialization.number()),labels:r.serialization.record(r.serialization.string(),n.ClassifyResponseClassificationsItemLabelsValue),classificationType:r.serialization.property("classification_type",i.ClassifyResponseClassificationsItemClassificationType)}),pa}var _a={},mU;function sle(){if(mU)return _a;mU=1;var a=_a&&_a.__createBinding||(Object.create?function(o,s,u,l){l===void 0&&(l=u);var c=Object.getOwnPropertyDescriptor(s,u);(!c||("get"in c?!s.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return s[u]}}),Object.defineProperty(o,l,c)}:function(o,s,u,l){l===void 0&&(l=u),o[l]=s[u]}),e=_a&&_a.__setModuleDefault||(Object.create?function(o,s){Object.defineProperty(o,"default",{enumerable:!0,value:s})}:function(o,s){o.default=s}),t=_a&&_a.__importStar||function(o){if(o&&o.__esModule)return o;var s={};if(o!=null)for(var u in o)u!=="default"&&Object.prototype.hasOwnProperty.call(o,u)&&a(s,o,u);return e(s,o),s};Object.defineProperty(_a,"__esModule",{value:!0}),_a.ClassifyResponse=void 0;const r=t($()),n=sk(),i=Er();return _a.ClassifyResponse=r.serialization.object({id:r.serialization.string(),classifications:r.serialization.list(n.ClassifyResponseClassificationsItem),meta:i.ApiMeta.optional()}),_a}var ya={},gU;function uk(){if(gU)return ya;gU=1;var a=ya&&ya.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=ya&&ya.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=ya&&ya.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(ya,"__esModule",{value:!0}),ya.SummarizeRequestLength=void 0;const r=t($());return ya.SummarizeRequestLength=r.serialization.enum_(["short","medium","long"]),ya}var ba={},vU;function lk(){if(vU)return ba;vU=1;var a=ba&&ba.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=ba&&ba.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=ba&&ba.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(ba,"__esModule",{value:!0}),ba.SummarizeRequestFormat=void 0;const r=t($());return ba.SummarizeRequestFormat=r.serialization.enum_(["paragraph","bullets"]),ba}var ma={},wU;function ck(){if(wU)return ma;wU=1;var a=ma&&ma.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=ma&&ma.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=ma&&ma.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(ma,"__esModule",{value:!0}),ma.SummarizeRequestExtractiveness=void 0;const r=t($());return ma.SummarizeRequestExtractiveness=r.serialization.enum_(["low","medium","high"]),ma}var ga={},OU;function ule(){if(OU)return ga;OU=1;var a=ga&&ga.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),e=ga&&ga.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),t=ga&&ga.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&a(o,i,s);return e(o,i),o};Object.defineProperty(ga,"__esModule",{value:!0}),ga.SummarizeResponse=void 0;const r=t($()),n=Er();return ga.SummarizeResponse=r.serialization.object({id:r.serialization.string().optional(),summary:r.serialization.string().optional(),meta:n.ApiMeta.optional()}),ga}var va={},SU;function lle(){if(SU)return va;SU=1;var a=va&&va.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),e=va&&va.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),t=va&&va.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&a(o,i,s);return e(o,i),o};Object.defineProperty(va,"__esModule",{value:!0}),va.TokenizeResponse=void 0;const r=t($()),n=Er();return va.TokenizeResponse=r.serialization.object({tokens:r.serialization.list(r.serialization.number()),tokenStrings:r.serialization.property("token_strings",r.serialization.list(r.serialization.string())),meta:n.ApiMeta.optional()}),va}var wa={},EU;function cle(){if(EU)return wa;EU=1;var a=wa&&wa.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),e=wa&&wa.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),t=wa&&wa.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&a(o,i,s);return e(o,i),o};Object.defineProperty(wa,"__esModule",{value:!0}),wa.DetokenizeResponse=void 0;const r=t($()),n=Er();return wa.DetokenizeResponse=r.serialization.object({text:r.serialization.string(),meta:n.ApiMeta.optional()}),wa}var Oa={},RU;function fle(){if(RU)return Oa;RU=1;var a=Oa&&Oa.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=Oa&&Oa.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=Oa&&Oa.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(Oa,"__esModule",{value:!0}),Oa.CheckApiKeyResponse=void 0;const r=t($());return Oa.CheckApiKeyResponse=r.serialization.object({valid:r.serialization.boolean(),organizationId:r.serialization.property("organization_id",r.serialization.string().optional()),ownerId:r.serialization.property("owner_id",r.serialization.string().optional())}),Oa}var Sa={},CU;function a_(){if(CU)return Sa;CU=1;var a=Sa&&Sa.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=Sa&&Sa.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=Sa&&Sa.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(Sa,"__esModule",{value:!0}),Sa.ToolCall=void 0;const r=t($());return Sa.ToolCall=r.serialization.object({name:r.serialization.string(),parameters:r.serialization.record(r.serialization.string(),r.serialization.unknown())}),Sa}var Ea={},PU;function fk(){if(PU)return Ea;PU=1;var a=Ea&&Ea.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),e=Ea&&Ea.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),t=Ea&&Ea.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&a(o,i,s);return e(o,i),o};Object.defineProperty(Ea,"__esModule",{value:!0}),Ea.ChatMessage=void 0;const r=t($()),n=a_();return Ea.ChatMessage=r.serialization.object({message:r.serialization.string(),toolCalls:r.serialization.property("tool_calls",r.serialization.list(n.ToolCall).optional())}),Ea}var Ra={},jU;function Hb(){if(jU)return Ra;jU=1;var a=Ra&&Ra.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),e=Ra&&Ra.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),t=Ra&&Ra.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&a(o,i,s);return e(o,i),o};Object.defineProperty(Ra,"__esModule",{value:!0}),Ra.ToolResult=void 0;const r=t($()),n=a_();return Ra.ToolResult=r.serialization.object({call:n.ToolCall,outputs:r.serialization.list(r.serialization.record(r.serialization.string(),r.serialization.unknown()))}),Ra}var Ca={},TU;function dk(){if(TU)return Ca;TU=1;var a=Ca&&Ca.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),e=Ca&&Ca.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),t=Ca&&Ca.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&a(o,i,s);return e(o,i),o};Object.defineProperty(Ca,"__esModule",{value:!0}),Ca.ToolMessage=void 0;const r=t($()),n=Hb();return Ca.ToolMessage=r.serialization.object({toolResults:r.serialization.property("tool_results",r.serialization.list(n.ToolResult).optional())}),Ca}var Pa={},MU;function Wb(){if(MU)return Pa;MU=1;var a=Pa&&Pa.__createBinding||(Object.create?function(o,s,u,l){l===void 0&&(l=u);var c=Object.getOwnPropertyDescriptor(s,u);(!c||("get"in c?!s.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return s[u]}}),Object.defineProperty(o,l,c)}:function(o,s,u,l){l===void 0&&(l=u),o[l]=s[u]}),e=Pa&&Pa.__setModuleDefault||(Object.create?function(o,s){Object.defineProperty(o,"default",{enumerable:!0,value:s})}:function(o,s){o.default=s}),t=Pa&&Pa.__importStar||function(o){if(o&&o.__esModule)return o;var s={};if(o!=null)for(var u in o)u!=="default"&&Object.prototype.hasOwnProperty.call(o,u)&&a(s,o,u);return e(s,o),s};Object.defineProperty(Pa,"__esModule",{value:!0}),Pa.Message=void 0;const r=t($()),n=fk(),i=dk();return Pa.Message=r.serialization.union("role",{CHATBOT:n.ChatMessage,SYSTEM:n.ChatMessage,USER:n.ChatMessage,TOOL:i.ToolMessage}).transform({transform:o=>o,untransform:o=>o}),Pa}var ja={},AU;function HC(){if(AU)return ja;AU=1;var a=ja&&ja.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=ja&&ja.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=ja&&ja.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(ja,"__esModule",{value:!0}),ja.ChatConnector=void 0;const r=t($());return ja.ChatConnector=r.serialization.object({id:r.serialization.string(),userAccessToken:r.serialization.property("user_access_token",r.serialization.string().optional()),continueOnFailure:r.serialization.property("continue_on_failure",r.serialization.boolean().optional()),options:r.serialization.record(r.serialization.string(),r.serialization.unknown()).optional()}),ja}var Ta={},IU;function o_(){if(IU)return Ta;IU=1;var a=Ta&&Ta.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=Ta&&Ta.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=Ta&&Ta.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(Ta,"__esModule",{value:!0}),Ta.ChatDocument=void 0;const r=t($());return Ta.ChatDocument=r.serialization.record(r.serialization.string(),r.serialization.string()),Ta}var Ma={},DU;function hk(){if(DU)return Ma;DU=1;var a=Ma&&Ma.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=Ma&&Ma.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=Ma&&Ma.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(Ma,"__esModule",{value:!0}),Ma.ToolParameterDefinitionsValue=void 0;const r=t($());return Ma.ToolParameterDefinitionsValue=r.serialization.object({description:r.serialization.string().optional(),type:r.serialization.string(),required:r.serialization.boolean().optional()}),Ma}var Aa={},xU;function WC(){if(xU)return Aa;xU=1;var a=Aa&&Aa.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),e=Aa&&Aa.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),t=Aa&&Aa.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&a(o,i,s);return e(o,i),o};Object.defineProperty(Aa,"__esModule",{value:!0}),Aa.Tool=void 0;const r=t($()),n=hk();return Aa.Tool=r.serialization.object({name:r.serialization.string(),description:r.serialization.string(),parameterDefinitions:r.serialization.property("parameter_definitions",r.serialization.record(r.serialization.string(),n.ToolParameterDefinitionsValue).optional())}),Aa}var Ia={},$U;function pk(){if($U)return Ia;$U=1;var a=Ia&&Ia.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=Ia&&Ia.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=Ia&&Ia.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(Ia,"__esModule",{value:!0}),Ia.TextResponseFormat=void 0;const r=t($());return Ia.TextResponseFormat=r.serialization.object({}),Ia}var Da={},NU;function _k(){if(NU)return Da;NU=1;var a=Da&&Da.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=Da&&Da.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=Da&&Da.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(Da,"__esModule",{value:!0}),Da.JsonResponseFormat=void 0;const r=t($());return Da.JsonResponseFormat=r.serialization.object({schema:r.serialization.record(r.serialization.string(),r.serialization.unknown()).optional()}),Da}var xa={},qU;function KC(){if(qU)return xa;qU=1;var a=xa&&xa.__createBinding||(Object.create?function(o,s,u,l){l===void 0&&(l=u);var c=Object.getOwnPropertyDescriptor(s,u);(!c||("get"in c?!s.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return s[u]}}),Object.defineProperty(o,l,c)}:function(o,s,u,l){l===void 0&&(l=u),o[l]=s[u]}),e=xa&&xa.__setModuleDefault||(Object.create?function(o,s){Object.defineProperty(o,"default",{enumerable:!0,value:s})}:function(o,s){o.default=s}),t=xa&&xa.__importStar||function(o){if(o&&o.__esModule)return o;var s={};if(o!=null)for(var u in o)u!=="default"&&Object.prototype.hasOwnProperty.call(o,u)&&a(s,o,u);return e(s,o),s};Object.defineProperty(xa,"__esModule",{value:!0}),xa.ResponseFormat=void 0;const r=t($()),n=pk(),i=_k();return xa.ResponseFormat=r.serialization.union("type",{text:n.TextResponseFormat,json_object:i.JsonResponseFormat}).transform({transform:o=>o,untransform:o=>o}),xa}var $a={},zU;function yk(){if(zU)return $a;zU=1;var a=$a&&$a.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=$a&&$a.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=$a&&$a.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty($a,"__esModule",{value:!0}),$a.ChatCitationType=void 0;const r=t($());return $a.ChatCitationType=r.serialization.enum_(["TEXT_CONTENT","PLAN"]),$a}var Na={},BU;function JC(){if(BU)return Na;BU=1;var a=Na&&Na.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),e=Na&&Na.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),t=Na&&Na.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&a(o,i,s);return e(o,i),o};Object.defineProperty(Na,"__esModule",{value:!0}),Na.ChatCitation=void 0;const r=t($()),n=yk();return Na.ChatCitation=r.serialization.object({start:r.serialization.number(),end:r.serialization.number(),text:r.serialization.string(),documentIds:r.serialization.property("document_ids",r.serialization.list(r.serialization.string())),type:n.ChatCitationType.optional()}),Na}var qa={},UU;function Kb(){if(UU)return qa;UU=1;var a=qa&&qa.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=qa&&qa.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=qa&&qa.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(qa,"__esModule",{value:!0}),qa.ChatSearchQuery=void 0;const r=t($());return qa.ChatSearchQuery=r.serialization.object({text:r.serialization.string(),generationId:r.serialization.property("generation_id",r.serialization.string())}),qa}var za={},FU;function bk(){if(FU)return za;FU=1;var a=za&&za.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=za&&za.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=za&&za.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(za,"__esModule",{value:!0}),za.ChatSearchResultConnector=void 0;const r=t($());return za.ChatSearchResultConnector=r.serialization.object({id:r.serialization.string()}),za}var Ba={},LU;function XC(){if(LU)return Ba;LU=1;var a=Ba&&Ba.__createBinding||(Object.create?function(o,s,u,l){l===void 0&&(l=u);var c=Object.getOwnPropertyDescriptor(s,u);(!c||("get"in c?!s.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return s[u]}}),Object.defineProperty(o,l,c)}:function(o,s,u,l){l===void 0&&(l=u),o[l]=s[u]}),e=Ba&&Ba.__setModuleDefault||(Object.create?function(o,s){Object.defineProperty(o,"default",{enumerable:!0,value:s})}:function(o,s){o.default=s}),t=Ba&&Ba.__importStar||function(o){if(o&&o.__esModule)return o;var s={};if(o!=null)for(var u in o)u!=="default"&&Object.prototype.hasOwnProperty.call(o,u)&&a(s,o,u);return e(s,o),s};Object.defineProperty(Ba,"__esModule",{value:!0}),Ba.ChatSearchResult=void 0;const r=t($()),n=Kb(),i=bk();return Ba.ChatSearchResult=r.serialization.object({searchQuery:r.serialization.property("search_query",n.ChatSearchQuery.optional()),connector:i.ChatSearchResultConnector,documentIds:r.serialization.property("document_ids",r.serialization.list(r.serialization.string())),errorMessage:r.serialization.property("error_message",r.serialization.string().optional()),continueOnFailure:r.serialization.property("continue_on_failure",r.serialization.boolean().optional())}),Ba}var Ua={},VU;function s_(){if(VU)return Ua;VU=1;var a=Ua&&Ua.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=Ua&&Ua.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=Ua&&Ua.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(Ua,"__esModule",{value:!0}),Ua.FinishReason=void 0;const r=t($());return Ua.FinishReason=r.serialization.enum_(["COMPLETE","STOP_SEQUENCE","ERROR","ERROR_TOXIC","ERROR_LIMIT","USER_CANCEL","MAX_TOKENS"]),Ua}var Fa={},GU;function mk(){if(GU)return Fa;GU=1;var a=Fa&&Fa.__createBinding||(Object.create?function(p,h,y,d){d===void 0&&(d=y);var _=Object.getOwnPropertyDescriptor(h,y);(!_||("get"in _?!h.__esModule:_.writable||_.configurable))&&(_={enumerable:!0,get:function(){return h[y]}}),Object.defineProperty(p,d,_)}:function(p,h,y,d){d===void 0&&(d=y),p[d]=h[y]}),e=Fa&&Fa.__setModuleDefault||(Object.create?function(p,h){Object.defineProperty(p,"default",{enumerable:!0,value:h})}:function(p,h){p.default=h}),t=Fa&&Fa.__importStar||function(p){if(p&&p.__esModule)return p;var h={};if(p!=null)for(var y in p)y!=="default"&&Object.prototype.hasOwnProperty.call(p,y)&&a(h,p,y);return e(h,p),h};Object.defineProperty(Fa,"__esModule",{value:!0}),Fa.NonStreamedChatResponse=void 0;const r=t($()),n=JC(),i=o_(),o=Kb(),s=XC(),u=s_(),l=a_(),c=Wb(),f=Er();return Fa.NonStreamedChatResponse=r.serialization.object({text:r.serialization.string(),generationId:r.serialization.property("generation_id",r.serialization.string().optional()),responseId:r.serialization.property("response_id",r.serialization.string().optional()),citations:r.serialization.list(n.ChatCitation).optional(),documents:r.serialization.list(i.ChatDocument).optional(),isSearchRequired:r.serialization.property("is_search_required",r.serialization.boolean().optional()),searchQueries:r.serialization.property("search_queries",r.serialization.list(o.ChatSearchQuery).optional()),searchResults:r.serialization.property("search_results",r.serialization.list(s.ChatSearchResult).optional()),finishReason:r.serialization.property("finish_reason",u.FinishReason.optional()),toolCalls:r.serialization.property("tool_calls",r.serialization.list(l.ToolCall).optional()),chatHistory:r.serialization.property("chat_history",r.serialization.list(c.Message).optional()),prompt:r.serialization.string().optional(),meta:f.ApiMeta.optional()}),Fa}var La={},kU;function su(){if(kU)return La;kU=1;var a=La&&La.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=La&&La.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=La&&La.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(La,"__esModule",{value:!0}),La.ChatStreamEvent=void 0;const r=t($());return La.ChatStreamEvent=r.serialization.object({}),La}var Va={},HU;function gk(){if(HU)return Va;HU=1;var a=Va&&Va.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),e=Va&&Va.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),t=Va&&Va.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&a(o,i,s);return e(o,i),o};Object.defineProperty(Va,"__esModule",{value:!0}),Va.ChatStreamStartEvent=void 0;const r=t($()),n=su();return Va.ChatStreamStartEvent=r.serialization.object({generationId:r.serialization.property("generation_id",r.serialization.string())}).extend(n.ChatStreamEvent),Va}var Ga={},WU;function vk(){if(WU)return Ga;WU=1;var a=Ga&&Ga.__createBinding||(Object.create?function(o,s,u,l){l===void 0&&(l=u);var c=Object.getOwnPropertyDescriptor(s,u);(!c||("get"in c?!s.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return s[u]}}),Object.defineProperty(o,l,c)}:function(o,s,u,l){l===void 0&&(l=u),o[l]=s[u]}),e=Ga&&Ga.__setModuleDefault||(Object.create?function(o,s){Object.defineProperty(o,"default",{enumerable:!0,value:s})}:function(o,s){o.default=s}),t=Ga&&Ga.__importStar||function(o){if(o&&o.__esModule)return o;var s={};if(o!=null)for(var u in o)u!=="default"&&Object.prototype.hasOwnProperty.call(o,u)&&a(s,o,u);return e(s,o),s};Object.defineProperty(Ga,"__esModule",{value:!0}),Ga.ChatSearchQueriesGenerationEvent=void 0;const r=t($()),n=Kb(),i=su();return Ga.ChatSearchQueriesGenerationEvent=r.serialization.object({searchQueries:r.serialization.property("search_queries",r.serialization.list(n.ChatSearchQuery))}).extend(i.ChatStreamEvent),Ga}var ka={},KU;function wk(){if(KU)return ka;KU=1;var a=ka&&ka.__createBinding||(Object.create?function(s,u,l,c){c===void 0&&(c=l);var f=Object.getOwnPropertyDescriptor(u,l);(!f||("get"in f?!u.__esModule:f.writable||f.configurable))&&(f={enumerable:!0,get:function(){return u[l]}}),Object.defineProperty(s,c,f)}:function(s,u,l,c){c===void 0&&(c=l),s[c]=u[l]}),e=ka&&ka.__setModuleDefault||(Object.create?function(s,u){Object.defineProperty(s,"default",{enumerable:!0,value:u})}:function(s,u){s.default=u}),t=ka&&ka.__importStar||function(s){if(s&&s.__esModule)return s;var u={};if(s!=null)for(var l in s)l!=="default"&&Object.prototype.hasOwnProperty.call(s,l)&&a(u,s,l);return e(u,s),u};Object.defineProperty(ka,"__esModule",{value:!0}),ka.ChatSearchResultsEvent=void 0;const r=t($()),n=XC(),i=o_(),o=su();return ka.ChatSearchResultsEvent=r.serialization.object({searchResults:r.serialization.property("search_results",r.serialization.list(n.ChatSearchResult).optional()),documents:r.serialization.list(i.ChatDocument).optional()}).extend(o.ChatStreamEvent),ka}var Ha={},JU;function Ok(){if(JU)return Ha;JU=1;var a=Ha&&Ha.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),e=Ha&&Ha.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),t=Ha&&Ha.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&a(o,i,s);return e(o,i),o};Object.defineProperty(Ha,"__esModule",{value:!0}),Ha.ChatTextGenerationEvent=void 0;const r=t($()),n=su();return Ha.ChatTextGenerationEvent=r.serialization.object({text:r.serialization.string()}).extend(n.ChatStreamEvent),Ha}var Wa={},XU;function Sk(){if(XU)return Wa;XU=1;var a=Wa&&Wa.__createBinding||(Object.create?function(o,s,u,l){l===void 0&&(l=u);var c=Object.getOwnPropertyDescriptor(s,u);(!c||("get"in c?!s.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return s[u]}}),Object.defineProperty(o,l,c)}:function(o,s,u,l){l===void 0&&(l=u),o[l]=s[u]}),e=Wa&&Wa.__setModuleDefault||(Object.create?function(o,s){Object.defineProperty(o,"default",{enumerable:!0,value:s})}:function(o,s){o.default=s}),t=Wa&&Wa.__importStar||function(o){if(o&&o.__esModule)return o;var s={};if(o!=null)for(var u in o)u!=="default"&&Object.prototype.hasOwnProperty.call(o,u)&&a(s,o,u);return e(s,o),s};Object.defineProperty(Wa,"__esModule",{value:!0}),Wa.ChatCitationGenerationEvent=void 0;const r=t($()),n=JC(),i=su();return Wa.ChatCitationGenerationEvent=r.serialization.object({citations:r.serialization.list(n.ChatCitation)}).extend(i.ChatStreamEvent),Wa}var Ka={},ZU;function Ek(){if(ZU)return Ka;ZU=1;var a=Ka&&Ka.__createBinding||(Object.create?function(o,s,u,l){l===void 0&&(l=u);var c=Object.getOwnPropertyDescriptor(s,u);(!c||("get"in c?!s.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return s[u]}}),Object.defineProperty(o,l,c)}:function(o,s,u,l){l===void 0&&(l=u),o[l]=s[u]}),e=Ka&&Ka.__setModuleDefault||(Object.create?function(o,s){Object.defineProperty(o,"default",{enumerable:!0,value:s})}:function(o,s){o.default=s}),t=Ka&&Ka.__importStar||function(o){if(o&&o.__esModule)return o;var s={};if(o!=null)for(var u in o)u!=="default"&&Object.prototype.hasOwnProperty.call(o,u)&&a(s,o,u);return e(s,o),s};Object.defineProperty(Ka,"__esModule",{value:!0}),Ka.ChatToolCallsGenerationEvent=void 0;const r=t($()),n=a_(),i=su();return Ka.ChatToolCallsGenerationEvent=r.serialization.object({text:r.serialization.string().optional(),toolCalls:r.serialization.property("tool_calls",r.serialization.list(n.ToolCall))}).extend(i.ChatStreamEvent),Ka}var Ja={},QU;function Rk(){if(QU)return Ja;QU=1;var a=Ja&&Ja.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=Ja&&Ja.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=Ja&&Ja.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(Ja,"__esModule",{value:!0}),Ja.ChatStreamEndEventFinishReason=void 0;const r=t($());return Ja.ChatStreamEndEventFinishReason=r.serialization.enum_(["COMPLETE","ERROR_LIMIT","MAX_TOKENS","ERROR","ERROR_TOXIC"]),Ja}var Xa={},YU;function Ck(){if(YU)return Xa;YU=1;var a=Xa&&Xa.__createBinding||(Object.create?function(s,u,l,c){c===void 0&&(c=l);var f=Object.getOwnPropertyDescriptor(u,l);(!f||("get"in f?!u.__esModule:f.writable||f.configurable))&&(f={enumerable:!0,get:function(){return u[l]}}),Object.defineProperty(s,c,f)}:function(s,u,l,c){c===void 0&&(c=l),s[c]=u[l]}),e=Xa&&Xa.__setModuleDefault||(Object.create?function(s,u){Object.defineProperty(s,"default",{enumerable:!0,value:u})}:function(s,u){s.default=u}),t=Xa&&Xa.__importStar||function(s){if(s&&s.__esModule)return s;var u={};if(s!=null)for(var l in s)l!=="default"&&Object.prototype.hasOwnProperty.call(s,l)&&a(u,s,l);return e(u,s),u};Object.defineProperty(Xa,"__esModule",{value:!0}),Xa.ChatStreamEndEvent=void 0;const r=t($()),n=Rk(),i=mk(),o=su();return Xa.ChatStreamEndEvent=r.serialization.object({finishReason:r.serialization.property("finish_reason",n.ChatStreamEndEventFinishReason),response:i.NonStreamedChatResponse}).extend(o.ChatStreamEvent),Xa}var Za={},eF;function Pk(){if(eF)return Za;eF=1;var a=Za&&Za.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=Za&&Za.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=Za&&Za.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(Za,"__esModule",{value:!0}),Za.ToolCallDelta=void 0;const r=t($());return Za.ToolCallDelta=r.serialization.object({name:r.serialization.string().optional(),index:r.serialization.number().optional(),parameters:r.serialization.string().optional(),text:r.serialization.string().optional()}),Za}var Qa={},tF;function jk(){if(tF)return Qa;tF=1;var a=Qa&&Qa.__createBinding||(Object.create?function(o,s,u,l){l===void 0&&(l=u);var c=Object.getOwnPropertyDescriptor(s,u);(!c||("get"in c?!s.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return s[u]}}),Object.defineProperty(o,l,c)}:function(o,s,u,l){l===void 0&&(l=u),o[l]=s[u]}),e=Qa&&Qa.__setModuleDefault||(Object.create?function(o,s){Object.defineProperty(o,"default",{enumerable:!0,value:s})}:function(o,s){o.default=s}),t=Qa&&Qa.__importStar||function(o){if(o&&o.__esModule)return o;var s={};if(o!=null)for(var u in o)u!=="default"&&Object.prototype.hasOwnProperty.call(o,u)&&a(s,o,u);return e(s,o),s};Object.defineProperty(Qa,"__esModule",{value:!0}),Qa.ChatToolCallsChunkEvent=void 0;const r=t($()),n=Pk(),i=su();return Qa.ChatToolCallsChunkEvent=r.serialization.object({toolCallDelta:r.serialization.property("tool_call_delta",n.ToolCallDelta),text:r.serialization.string().optional()}).extend(i.ChatStreamEvent),Qa}var Ya={},rF;function ZC(){if(rF)return Ya;rF=1;var a=Ya&&Ya.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),e=Ya&&Ya.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),t=Ya&&Ya.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&a(o,i,s);return e(o,i),o};Object.defineProperty(Ya,"__esModule",{value:!0}),Ya.ChatDebugEvent=void 0;const r=t($()),n=su();return Ya.ChatDebugEvent=r.serialization.object({prompt:r.serialization.string().optional()}).extend(n.ChatStreamEvent),Ya}var eo={},nF;function dle(){if(nF)return eo;nF=1;var a=eo&&eo.__createBinding||(Object.create?function(h,y,d,_){_===void 0&&(_=d);var m=Object.getOwnPropertyDescriptor(y,d);(!m||("get"in m?!y.__esModule:m.writable||m.configurable))&&(m={enumerable:!0,get:function(){return y[d]}}),Object.defineProperty(h,_,m)}:function(h,y,d,_){_===void 0&&(_=d),h[_]=y[d]}),e=eo&&eo.__setModuleDefault||(Object.create?function(h,y){Object.defineProperty(h,"default",{enumerable:!0,value:y})}:function(h,y){h.default=y}),t=eo&&eo.__importStar||function(h){if(h&&h.__esModule)return h;var y={};if(h!=null)for(var d in h)d!=="default"&&Object.prototype.hasOwnProperty.call(h,d)&&a(y,h,d);return e(y,h),y};Object.defineProperty(eo,"__esModule",{value:!0}),eo.StreamedChatResponse=void 0;const r=t($()),n=gk(),i=vk(),o=wk(),s=Ok(),u=Sk(),l=Ek(),c=Ck(),f=jk(),p=ZC();return eo.StreamedChatResponse=r.serialization.union(r.serialization.discriminant("eventType","event_type"),{"stream-start":n.ChatStreamStartEvent,"search-queries-generation":i.ChatSearchQueriesGenerationEvent,"search-results":o.ChatSearchResultsEvent,"text-generation":s.ChatTextGenerationEvent,"citation-generation":u.ChatCitationGenerationEvent,"tool-calls-generation":l.ChatToolCallsGenerationEvent,"stream-end":c.ChatStreamEndEvent,"tool-calls-chunk":f.ChatToolCallsChunkEvent,debug:p.ChatDebugEvent}).transform({transform:h=>h,untransform:h=>h}),eo}var to={},iF;function QC(){if(iF)return to;iF=1;var a=to&&to.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=to&&to.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=to&&to.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(to,"__esModule",{value:!0}),to.ChatFinishReason=void 0;const r=t($());return to.ChatFinishReason=r.serialization.enum_(["COMPLETE","STOP_SEQUENCE","MAX_TOKENS","TOOL_CALL","ERROR"]),to}var ro={},aF;function Tk(){if(aF)return ro;aF=1;var a=ro&&ro.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),e=ro&&ro.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),t=ro&&ro.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&a(o,i,s);return e(o,i),o};Object.defineProperty(ro,"__esModule",{value:!0}),ro.AssistantMessageResponseContentItem=void 0;const r=t($()),n=Gf();return ro.AssistantMessageResponseContentItem=r.serialization.union("type",{text:n.TextContent}).transform({transform:i=>i,untransform:i=>i}),ro}var no={},oF;function Mk(){if(oF)return no;oF=1;var a=no&&no.__createBinding||(Object.create?function(s,u,l,c){c===void 0&&(c=l);var f=Object.getOwnPropertyDescriptor(u,l);(!f||("get"in f?!u.__esModule:f.writable||f.configurable))&&(f={enumerable:!0,get:function(){return u[l]}}),Object.defineProperty(s,c,f)}:function(s,u,l,c){c===void 0&&(c=l),s[c]=u[l]}),e=no&&no.__setModuleDefault||(Object.create?function(s,u){Object.defineProperty(s,"default",{enumerable:!0,value:u})}:function(s,u){s.default=u}),t=no&&no.__importStar||function(s){if(s&&s.__esModule)return s;var u={};if(s!=null)for(var l in s)l!=="default"&&Object.prototype.hasOwnProperty.call(s,l)&&a(u,s,l);return e(u,s),u};Object.defineProperty(no,"__esModule",{value:!0}),no.AssistantMessageResponse=void 0;const r=t($()),n=Fb(),i=Tk(),o=Lb();return no.AssistantMessageResponse=r.serialization.object({role:r.serialization.stringLiteral("assistant"),toolCalls:r.serialization.property("tool_calls",r.serialization.list(n.ToolCallV2).optional()),toolPlan:r.serialization.property("tool_plan",r.serialization.string().optional()),content:r.serialization.list(i.AssistantMessageResponseContentItem).optional(),citations:r.serialization.list(o.Citation).optional()}),no}var io={},sF;function Ak(){if(sF)return io;sF=1;var a=io&&io.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=io&&io.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=io&&io.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(io,"__esModule",{value:!0}),io.UsageBilledUnits=void 0;const r=t($());return io.UsageBilledUnits=r.serialization.object({inputTokens:r.serialization.property("input_tokens",r.serialization.number().optional()),outputTokens:r.serialization.property("output_tokens",r.serialization.number().optional()),searchUnits:r.serialization.property("search_units",r.serialization.number().optional()),classifications:r.serialization.number().optional()}),io}var ao={},uF;function Ik(){if(uF)return ao;uF=1;var a=ao&&ao.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=ao&&ao.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=ao&&ao.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(ao,"__esModule",{value:!0}),ao.UsageTokens=void 0;const r=t($());return ao.UsageTokens=r.serialization.object({inputTokens:r.serialization.property("input_tokens",r.serialization.number().optional()),outputTokens:r.serialization.property("output_tokens",r.serialization.number().optional())}),ao}var oo={},lF;function YC(){if(lF)return oo;lF=1;var a=oo&&oo.__createBinding||(Object.create?function(o,s,u,l){l===void 0&&(l=u);var c=Object.getOwnPropertyDescriptor(s,u);(!c||("get"in c?!s.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return s[u]}}),Object.defineProperty(o,l,c)}:function(o,s,u,l){l===void 0&&(l=u),o[l]=s[u]}),e=oo&&oo.__setModuleDefault||(Object.create?function(o,s){Object.defineProperty(o,"default",{enumerable:!0,value:s})}:function(o,s){o.default=s}),t=oo&&oo.__importStar||function(o){if(o&&o.__esModule)return o;var s={};if(o!=null)for(var u in o)u!=="default"&&Object.prototype.hasOwnProperty.call(o,u)&&a(s,o,u);return e(s,o),s};Object.defineProperty(oo,"__esModule",{value:!0}),oo.Usage=void 0;const r=t($()),n=Ak(),i=Ik();return oo.Usage=r.serialization.object({billedUnits:r.serialization.property("billed_units",n.UsageBilledUnits.optional()),tokens:i.UsageTokens.optional()}),oo}var so={},cF;function eP(){if(cF)return so;cF=1;var a=so&&so.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=so&&so.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=so&&so.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(so,"__esModule",{value:!0}),so.LogprobItem=void 0;const r=t($());return so.LogprobItem=r.serialization.object({text:r.serialization.string().optional(),tokenIds:r.serialization.property("token_ids",r.serialization.list(r.serialization.number())),logprobs:r.serialization.list(r.serialization.number()).optional()}),so}var uo={},fF;function hle(){if(fF)return uo;fF=1;var a=uo&&uo.__createBinding||(Object.create?function(u,l,c,f){f===void 0&&(f=c);var p=Object.getOwnPropertyDescriptor(l,c);(!p||("get"in p?!l.__esModule:p.writable||p.configurable))&&(p={enumerable:!0,get:function(){return l[c]}}),Object.defineProperty(u,f,p)}:function(u,l,c,f){f===void 0&&(f=c),u[f]=l[c]}),e=uo&&uo.__setModuleDefault||(Object.create?function(u,l){Object.defineProperty(u,"default",{enumerable:!0,value:l})}:function(u,l){u.default=l}),t=uo&&uo.__importStar||function(u){if(u&&u.__esModule)return u;var l={};if(u!=null)for(var c in u)c!=="default"&&Object.prototype.hasOwnProperty.call(u,c)&&a(l,u,c);return e(l,u),l};Object.defineProperty(uo,"__esModule",{value:!0}),uo.ChatResponse=void 0;const r=t($()),n=QC(),i=Mk(),o=YC(),s=eP();return uo.ChatResponse=r.serialization.object({id:r.serialization.string(),finishReason:r.serialization.property("finish_reason",n.ChatFinishReason),prompt:r.serialization.string().optional(),message:i.AssistantMessageResponse,usage:o.Usage.optional(),logprobs:r.serialization.list(s.LogprobItem).optional()}),uo}var lo={},dF;function xr(){if(dF)return lo;dF=1;var a=lo&&lo.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=lo&&lo.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=lo&&lo.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(lo,"__esModule",{value:!0}),lo.ChatStreamEventType=void 0;const r=t($());return lo.ChatStreamEventType=r.serialization.object({}),lo}var co={},hF;function Dk(){if(hF)return co;hF=1;var a=co&&co.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=co&&co.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=co&&co.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(co,"__esModule",{value:!0}),co.ChatMessageStartEventDeltaMessage=void 0;const r=t($());return co.ChatMessageStartEventDeltaMessage=r.serialization.object({role:r.serialization.stringLiteral("assistant").optional()}),co}var fo={},pF;function xk(){if(pF)return fo;pF=1;var a=fo&&fo.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),e=fo&&fo.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),t=fo&&fo.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&a(o,i,s);return e(o,i),o};Object.defineProperty(fo,"__esModule",{value:!0}),fo.ChatMessageStartEventDelta=void 0;const r=t($()),n=Dk();return fo.ChatMessageStartEventDelta=r.serialization.object({message:n.ChatMessageStartEventDeltaMessage.optional()}),fo}var ho={},_F;function $k(){if(_F)return ho;_F=1;var a=ho&&ho.__createBinding||(Object.create?function(o,s,u,l){l===void 0&&(l=u);var c=Object.getOwnPropertyDescriptor(s,u);(!c||("get"in c?!s.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return s[u]}}),Object.defineProperty(o,l,c)}:function(o,s,u,l){l===void 0&&(l=u),o[l]=s[u]}),e=ho&&ho.__setModuleDefault||(Object.create?function(o,s){Object.defineProperty(o,"default",{enumerable:!0,value:s})}:function(o,s){o.default=s}),t=ho&&ho.__importStar||function(o){if(o&&o.__esModule)return o;var s={};if(o!=null)for(var u in o)u!=="default"&&Object.prototype.hasOwnProperty.call(o,u)&&a(s,o,u);return e(s,o),s};Object.defineProperty(ho,"__esModule",{value:!0}),ho.ChatMessageStartEvent=void 0;const r=t($()),n=xk(),i=xr();return ho.ChatMessageStartEvent=r.serialization.object({id:r.serialization.string().optional(),delta:n.ChatMessageStartEventDelta.optional()}).extend(i.ChatStreamEventType),ho}var po={},yF;function Nk(){if(yF)return po;yF=1;var a=po&&po.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=po&&po.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=po&&po.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(po,"__esModule",{value:!0}),po.ChatContentStartEventDeltaMessageContent=void 0;const r=t($());return po.ChatContentStartEventDeltaMessageContent=r.serialization.object({text:r.serialization.string().optional(),type:r.serialization.stringLiteral("text").optional()}),po}var _o={},bF;function qk(){if(bF)return _o;bF=1;var a=_o&&_o.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),e=_o&&_o.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),t=_o&&_o.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&a(o,i,s);return e(o,i),o};Object.defineProperty(_o,"__esModule",{value:!0}),_o.ChatContentStartEventDeltaMessage=void 0;const r=t($()),n=Nk();return _o.ChatContentStartEventDeltaMessage=r.serialization.object({content:n.ChatContentStartEventDeltaMessageContent.optional()}),_o}var yo={},mF;function zk(){if(mF)return yo;mF=1;var a=yo&&yo.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),e=yo&&yo.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),t=yo&&yo.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&a(o,i,s);return e(o,i),o};Object.defineProperty(yo,"__esModule",{value:!0}),yo.ChatContentStartEventDelta=void 0;const r=t($()),n=qk();return yo.ChatContentStartEventDelta=r.serialization.object({message:n.ChatContentStartEventDeltaMessage.optional()}),yo}var bo={},gF;function Bk(){if(gF)return bo;gF=1;var a=bo&&bo.__createBinding||(Object.create?function(o,s,u,l){l===void 0&&(l=u);var c=Object.getOwnPropertyDescriptor(s,u);(!c||("get"in c?!s.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return s[u]}}),Object.defineProperty(o,l,c)}:function(o,s,u,l){l===void 0&&(l=u),o[l]=s[u]}),e=bo&&bo.__setModuleDefault||(Object.create?function(o,s){Object.defineProperty(o,"default",{enumerable:!0,value:s})}:function(o,s){o.default=s}),t=bo&&bo.__importStar||function(o){if(o&&o.__esModule)return o;var s={};if(o!=null)for(var u in o)u!=="default"&&Object.prototype.hasOwnProperty.call(o,u)&&a(s,o,u);return e(s,o),s};Object.defineProperty(bo,"__esModule",{value:!0}),bo.ChatContentStartEvent=void 0;const r=t($()),n=zk(),i=xr();return bo.ChatContentStartEvent=r.serialization.object({index:r.serialization.number().optional(),delta:n.ChatContentStartEventDelta.optional()}).extend(i.ChatStreamEventType),bo}var mo={},vF;function Uk(){if(vF)return mo;vF=1;var a=mo&&mo.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=mo&&mo.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=mo&&mo.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(mo,"__esModule",{value:!0}),mo.ChatContentDeltaEventDeltaMessageContent=void 0;const r=t($());return mo.ChatContentDeltaEventDeltaMessageContent=r.serialization.object({text:r.serialization.string().optional()}),mo}var go={},wF;function Fk(){if(wF)return go;wF=1;var a=go&&go.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),e=go&&go.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),t=go&&go.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&a(o,i,s);return e(o,i),o};Object.defineProperty(go,"__esModule",{value:!0}),go.ChatContentDeltaEventDeltaMessage=void 0;const r=t($()),n=Uk();return go.ChatContentDeltaEventDeltaMessage=r.serialization.object({content:n.ChatContentDeltaEventDeltaMessageContent.optional()}),go}var vo={},OF;function Lk(){if(OF)return vo;OF=1;var a=vo&&vo.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),e=vo&&vo.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),t=vo&&vo.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&a(o,i,s);return e(o,i),o};Object.defineProperty(vo,"__esModule",{value:!0}),vo.ChatContentDeltaEventDelta=void 0;const r=t($()),n=Fk();return vo.ChatContentDeltaEventDelta=r.serialization.object({message:n.ChatContentDeltaEventDeltaMessage.optional()}),vo}var wo={},SF;function Vk(){if(SF)return wo;SF=1;var a=wo&&wo.__createBinding||(Object.create?function(s,u,l,c){c===void 0&&(c=l);var f=Object.getOwnPropertyDescriptor(u,l);(!f||("get"in f?!u.__esModule:f.writable||f.configurable))&&(f={enumerable:!0,get:function(){return u[l]}}),Object.defineProperty(s,c,f)}:function(s,u,l,c){c===void 0&&(c=l),s[c]=u[l]}),e=wo&&wo.__setModuleDefault||(Object.create?function(s,u){Object.defineProperty(s,"default",{enumerable:!0,value:u})}:function(s,u){s.default=u}),t=wo&&wo.__importStar||function(s){if(s&&s.__esModule)return s;var u={};if(s!=null)for(var l in s)l!=="default"&&Object.prototype.hasOwnProperty.call(s,l)&&a(u,s,l);return e(u,s),u};Object.defineProperty(wo,"__esModule",{value:!0}),wo.ChatContentDeltaEvent=void 0;const r=t($()),n=Lk(),i=eP(),o=xr();return wo.ChatContentDeltaEvent=r.serialization.object({index:r.serialization.number().optional(),delta:n.ChatContentDeltaEventDelta.optional(),logprobs:i.LogprobItem.optional()}).extend(o.ChatStreamEventType),wo}var Oo={},EF;function Gk(){if(EF)return Oo;EF=1;var a=Oo&&Oo.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),e=Oo&&Oo.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),t=Oo&&Oo.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&a(o,i,s);return e(o,i),o};Object.defineProperty(Oo,"__esModule",{value:!0}),Oo.ChatContentEndEvent=void 0;const r=t($()),n=xr();return Oo.ChatContentEndEvent=r.serialization.object({index:r.serialization.number().optional()}).extend(n.ChatStreamEventType),Oo}var So={},RF;function kk(){if(RF)return So;RF=1;var a=So&&So.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=So&&So.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=So&&So.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(So,"__esModule",{value:!0}),So.ChatToolPlanDeltaEventDeltaMessage=void 0;const r=t($());return So.ChatToolPlanDeltaEventDeltaMessage=r.serialization.object({toolPlan:r.serialization.property("tool_plan",r.serialization.string().optional())}),So}var Eo={},CF;function Hk(){if(CF)return Eo;CF=1;var a=Eo&&Eo.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),e=Eo&&Eo.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),t=Eo&&Eo.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&a(o,i,s);return e(o,i),o};Object.defineProperty(Eo,"__esModule",{value:!0}),Eo.ChatToolPlanDeltaEventDelta=void 0;const r=t($()),n=kk();return Eo.ChatToolPlanDeltaEventDelta=r.serialization.object({message:n.ChatToolPlanDeltaEventDeltaMessage.optional()}),Eo}var Ro={},PF;function Wk(){if(PF)return Ro;PF=1;var a=Ro&&Ro.__createBinding||(Object.create?function(o,s,u,l){l===void 0&&(l=u);var c=Object.getOwnPropertyDescriptor(s,u);(!c||("get"in c?!s.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return s[u]}}),Object.defineProperty(o,l,c)}:function(o,s,u,l){l===void 0&&(l=u),o[l]=s[u]}),e=Ro&&Ro.__setModuleDefault||(Object.create?function(o,s){Object.defineProperty(o,"default",{enumerable:!0,value:s})}:function(o,s){o.default=s}),t=Ro&&Ro.__importStar||function(o){if(o&&o.__esModule)return o;var s={};if(o!=null)for(var u in o)u!=="default"&&Object.prototype.hasOwnProperty.call(o,u)&&a(s,o,u);return e(s,o),s};Object.defineProperty(Ro,"__esModule",{value:!0}),Ro.ChatToolPlanDeltaEvent=void 0;const r=t($()),n=Hk(),i=xr();return Ro.ChatToolPlanDeltaEvent=r.serialization.object({delta:n.ChatToolPlanDeltaEventDelta.optional()}).extend(i.ChatStreamEventType),Ro}var Co={},jF;function Kk(){if(jF)return Co;jF=1;var a=Co&&Co.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),e=Co&&Co.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),t=Co&&Co.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&a(o,i,s);return e(o,i),o};Object.defineProperty(Co,"__esModule",{value:!0}),Co.ChatToolCallStartEventDeltaMessage=void 0;const r=t($()),n=Fb();return Co.ChatToolCallStartEventDeltaMessage=r.serialization.object({toolCalls:r.serialization.property("tool_calls",n.ToolCallV2.optional())}),Co}var Po={},TF;function Jk(){if(TF)return Po;TF=1;var a=Po&&Po.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),e=Po&&Po.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),t=Po&&Po.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&a(o,i,s);return e(o,i),o};Object.defineProperty(Po,"__esModule",{value:!0}),Po.ChatToolCallStartEventDelta=void 0;const r=t($()),n=Kk();return Po.ChatToolCallStartEventDelta=r.serialization.object({message:n.ChatToolCallStartEventDeltaMessage.optional()}),Po}var jo={},MF;function Xk(){if(MF)return jo;MF=1;var a=jo&&jo.__createBinding||(Object.create?function(o,s,u,l){l===void 0&&(l=u);var c=Object.getOwnPropertyDescriptor(s,u);(!c||("get"in c?!s.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return s[u]}}),Object.defineProperty(o,l,c)}:function(o,s,u,l){l===void 0&&(l=u),o[l]=s[u]}),e=jo&&jo.__setModuleDefault||(Object.create?function(o,s){Object.defineProperty(o,"default",{enumerable:!0,value:s})}:function(o,s){o.default=s}),t=jo&&jo.__importStar||function(o){if(o&&o.__esModule)return o;var s={};if(o!=null)for(var u in o)u!=="default"&&Object.prototype.hasOwnProperty.call(o,u)&&a(s,o,u);return e(s,o),s};Object.defineProperty(jo,"__esModule",{value:!0}),jo.ChatToolCallStartEvent=void 0;const r=t($()),n=Jk(),i=xr();return jo.ChatToolCallStartEvent=r.serialization.object({index:r.serialization.number().optional(),delta:n.ChatToolCallStartEventDelta.optional()}).extend(i.ChatStreamEventType),jo}var To={},AF;function Zk(){if(AF)return To;AF=1;var a=To&&To.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=To&&To.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=To&&To.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(To,"__esModule",{value:!0}),To.ChatToolCallDeltaEventDeltaMessageToolCallsFunction=void 0;const r=t($());return To.ChatToolCallDeltaEventDeltaMessageToolCallsFunction=r.serialization.object({arguments:r.serialization.string().optional()}),To}var Mo={},IF;function Qk(){if(IF)return Mo;IF=1;var a=Mo&&Mo.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),e=Mo&&Mo.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),t=Mo&&Mo.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&a(o,i,s);return e(o,i),o};Object.defineProperty(Mo,"__esModule",{value:!0}),Mo.ChatToolCallDeltaEventDeltaMessageToolCalls=void 0;const r=t($()),n=Zk();return Mo.ChatToolCallDeltaEventDeltaMessageToolCalls=r.serialization.object({function:n.ChatToolCallDeltaEventDeltaMessageToolCallsFunction.optional()}),Mo}var Ao={},DF;function Yk(){if(DF)return Ao;DF=1;var a=Ao&&Ao.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),e=Ao&&Ao.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),t=Ao&&Ao.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&a(o,i,s);return e(o,i),o};Object.defineProperty(Ao,"__esModule",{value:!0}),Ao.ChatToolCallDeltaEventDeltaMessage=void 0;const r=t($()),n=Qk();return Ao.ChatToolCallDeltaEventDeltaMessage=r.serialization.object({toolCalls:r.serialization.property("tool_calls",n.ChatToolCallDeltaEventDeltaMessageToolCalls.optional())}),Ao}var Io={},xF;function eH(){if(xF)return Io;xF=1;var a=Io&&Io.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),e=Io&&Io.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),t=Io&&Io.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&a(o,i,s);return e(o,i),o};Object.defineProperty(Io,"__esModule",{value:!0}),Io.ChatToolCallDeltaEventDelta=void 0;const r=t($()),n=Yk();return Io.ChatToolCallDeltaEventDelta=r.serialization.object({message:n.ChatToolCallDeltaEventDeltaMessage.optional()}),Io}var Do={},$F;function tH(){if($F)return Do;$F=1;var a=Do&&Do.__createBinding||(Object.create?function(o,s,u,l){l===void 0&&(l=u);var c=Object.getOwnPropertyDescriptor(s,u);(!c||("get"in c?!s.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return s[u]}}),Object.defineProperty(o,l,c)}:function(o,s,u,l){l===void 0&&(l=u),o[l]=s[u]}),e=Do&&Do.__setModuleDefault||(Object.create?function(o,s){Object.defineProperty(o,"default",{enumerable:!0,value:s})}:function(o,s){o.default=s}),t=Do&&Do.__importStar||function(o){if(o&&o.__esModule)return o;var s={};if(o!=null)for(var u in o)u!=="default"&&Object.prototype.hasOwnProperty.call(o,u)&&a(s,o,u);return e(s,o),s};Object.defineProperty(Do,"__esModule",{value:!0}),Do.ChatToolCallDeltaEvent=void 0;const r=t($()),n=eH(),i=xr();return Do.ChatToolCallDeltaEvent=r.serialization.object({index:r.serialization.number().optional(),delta:n.ChatToolCallDeltaEventDelta.optional()}).extend(i.ChatStreamEventType),Do}var xo={},NF;function rH(){if(NF)return xo;NF=1;var a=xo&&xo.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),e=xo&&xo.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),t=xo&&xo.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&a(o,i,s);return e(o,i),o};Object.defineProperty(xo,"__esModule",{value:!0}),xo.ChatToolCallEndEvent=void 0;const r=t($()),n=xr();return xo.ChatToolCallEndEvent=r.serialization.object({index:r.serialization.number().optional()}).extend(n.ChatStreamEventType),xo}var $o={},qF;function nH(){if(qF)return $o;qF=1;var a=$o&&$o.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),e=$o&&$o.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),t=$o&&$o.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&a(o,i,s);return e(o,i),o};Object.defineProperty($o,"__esModule",{value:!0}),$o.CitationStartEventDeltaMessage=void 0;const r=t($()),n=Lb();return $o.CitationStartEventDeltaMessage=r.serialization.object({citations:n.Citation.optional()}),$o}var No={},zF;function iH(){if(zF)return No;zF=1;var a=No&&No.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),e=No&&No.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),t=No&&No.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&a(o,i,s);return e(o,i),o};Object.defineProperty(No,"__esModule",{value:!0}),No.CitationStartEventDelta=void 0;const r=t($()),n=nH();return No.CitationStartEventDelta=r.serialization.object({message:n.CitationStartEventDeltaMessage.optional()}),No}var qo={},BF;function aH(){if(BF)return qo;BF=1;var a=qo&&qo.__createBinding||(Object.create?function(o,s,u,l){l===void 0&&(l=u);var c=Object.getOwnPropertyDescriptor(s,u);(!c||("get"in c?!s.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return s[u]}}),Object.defineProperty(o,l,c)}:function(o,s,u,l){l===void 0&&(l=u),o[l]=s[u]}),e=qo&&qo.__setModuleDefault||(Object.create?function(o,s){Object.defineProperty(o,"default",{enumerable:!0,value:s})}:function(o,s){o.default=s}),t=qo&&qo.__importStar||function(o){if(o&&o.__esModule)return o;var s={};if(o!=null)for(var u in o)u!=="default"&&Object.prototype.hasOwnProperty.call(o,u)&&a(s,o,u);return e(s,o),s};Object.defineProperty(qo,"__esModule",{value:!0}),qo.CitationStartEvent=void 0;const r=t($()),n=iH(),i=xr();return qo.CitationStartEvent=r.serialization.object({index:r.serialization.number().optional(),delta:n.CitationStartEventDelta.optional()}).extend(i.ChatStreamEventType),qo}var zo={},UF;function oH(){if(UF)return zo;UF=1;var a=zo&&zo.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),e=zo&&zo.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),t=zo&&zo.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&a(o,i,s);return e(o,i),o};Object.defineProperty(zo,"__esModule",{value:!0}),zo.CitationEndEvent=void 0;const r=t($()),n=xr();return zo.CitationEndEvent=r.serialization.object({index:r.serialization.number().optional()}).extend(n.ChatStreamEventType),zo}var Bo={},FF;function sH(){if(FF)return Bo;FF=1;var a=Bo&&Bo.__createBinding||(Object.create?function(o,s,u,l){l===void 0&&(l=u);var c=Object.getOwnPropertyDescriptor(s,u);(!c||("get"in c?!s.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return s[u]}}),Object.defineProperty(o,l,c)}:function(o,s,u,l){l===void 0&&(l=u),o[l]=s[u]}),e=Bo&&Bo.__setModuleDefault||(Object.create?function(o,s){Object.defineProperty(o,"default",{enumerable:!0,value:s})}:function(o,s){o.default=s}),t=Bo&&Bo.__importStar||function(o){if(o&&o.__esModule)return o;var s={};if(o!=null)for(var u in o)u!=="default"&&Object.prototype.hasOwnProperty.call(o,u)&&a(s,o,u);return e(s,o),s};Object.defineProperty(Bo,"__esModule",{value:!0}),Bo.ChatMessageEndEventDelta=void 0;const r=t($()),n=QC(),i=YC();return Bo.ChatMessageEndEventDelta=r.serialization.object({finishReason:r.serialization.property("finish_reason",n.ChatFinishReason.optional()),usage:i.Usage.optional()}),Bo}var Uo={},LF;function uH(){if(LF)return Uo;LF=1;var a=Uo&&Uo.__createBinding||(Object.create?function(o,s,u,l){l===void 0&&(l=u);var c=Object.getOwnPropertyDescriptor(s,u);(!c||("get"in c?!s.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return s[u]}}),Object.defineProperty(o,l,c)}:function(o,s,u,l){l===void 0&&(l=u),o[l]=s[u]}),e=Uo&&Uo.__setModuleDefault||(Object.create?function(o,s){Object.defineProperty(o,"default",{enumerable:!0,value:s})}:function(o,s){o.default=s}),t=Uo&&Uo.__importStar||function(o){if(o&&o.__esModule)return o;var s={};if(o!=null)for(var u in o)u!=="default"&&Object.prototype.hasOwnProperty.call(o,u)&&a(s,o,u);return e(s,o),s};Object.defineProperty(Uo,"__esModule",{value:!0}),Uo.ChatMessageEndEvent=void 0;const r=t($()),n=sH(),i=xr();return Uo.ChatMessageEndEvent=r.serialization.object({id:r.serialization.string().optional(),delta:n.ChatMessageEndEventDelta.optional()}).extend(i.ChatStreamEventType),Uo}var Fo={},VF;function ple(){if(VF)return Fo;VF=1;var a=Fo&&Fo.__createBinding||(Object.create?function(_,m,b,g){g===void 0&&(g=b);var v=Object.getOwnPropertyDescriptor(m,b);(!v||("get"in v?!m.__esModule:v.writable||v.configurable))&&(v={enumerable:!0,get:function(){return m[b]}}),Object.defineProperty(_,g,v)}:function(_,m,b,g){g===void 0&&(g=b),_[g]=m[b]}),e=Fo&&Fo.__setModuleDefault||(Object.create?function(_,m){Object.defineProperty(_,"default",{enumerable:!0,value:m})}:function(_,m){_.default=m}),t=Fo&&Fo.__importStar||function(_){if(_&&_.__esModule)return _;var m={};if(_!=null)for(var b in _)b!=="default"&&Object.prototype.hasOwnProperty.call(_,b)&&a(m,_,b);return e(m,_),m};Object.defineProperty(Fo,"__esModule",{value:!0}),Fo.StreamedChatResponseV2=void 0;const r=t($()),n=$k(),i=Bk(),o=Vk(),s=Gk(),u=Wk(),l=Xk(),c=tH(),f=rH(),p=aH(),h=oH(),y=uH(),d=ZC();return Fo.StreamedChatResponseV2=r.serialization.union("type",{"message-start":n.ChatMessageStartEvent,"content-start":i.ChatContentStartEvent,"content-delta":o.ChatContentDeltaEvent,"content-end":s.ChatContentEndEvent,"tool-plan-delta":u.ChatToolPlanDeltaEvent,"tool-call-start":l.ChatToolCallStartEvent,"tool-call-delta":c.ChatToolCallDeltaEvent,"tool-call-end":f.ChatToolCallEndEvent,"citation-start":p.CitationStartEvent,"citation-end":h.CitationEndEvent,"message-end":y.ChatMessageEndEvent,debug:d.ChatDebugEvent}).transform({transform:_=>_,untransform:_=>_}),Fo}var Lo={},GF;function lH(){if(GF)return Lo;GF=1;var a=Lo&&Lo.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=Lo&&Lo.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=Lo&&Lo.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(Lo,"__esModule",{value:!0}),Lo.SingleGenerationTokenLikelihoodsItem=void 0;const r=t($());return Lo.SingleGenerationTokenLikelihoodsItem=r.serialization.object({token:r.serialization.string(),likelihood:r.serialization.number()}),Lo}var Vo={},kF;function cH(){if(kF)return Vo;kF=1;var a=Vo&&Vo.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),e=Vo&&Vo.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),t=Vo&&Vo.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&a(o,i,s);return e(o,i),o};Object.defineProperty(Vo,"__esModule",{value:!0}),Vo.SingleGeneration=void 0;const r=t($()),n=lH();return Vo.SingleGeneration=r.serialization.object({id:r.serialization.string(),text:r.serialization.string(),index:r.serialization.number().optional(),likelihood:r.serialization.number().optional(),tokenLikelihoods:r.serialization.property("token_likelihoods",r.serialization.list(n.SingleGenerationTokenLikelihoodsItem).optional())}),Vo}var Go={},HF;function _le(){if(HF)return Go;HF=1;var a=Go&&Go.__createBinding||(Object.create?function(o,s,u,l){l===void 0&&(l=u);var c=Object.getOwnPropertyDescriptor(s,u);(!c||("get"in c?!s.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return s[u]}}),Object.defineProperty(o,l,c)}:function(o,s,u,l){l===void 0&&(l=u),o[l]=s[u]}),e=Go&&Go.__setModuleDefault||(Object.create?function(o,s){Object.defineProperty(o,"default",{enumerable:!0,value:s})}:function(o,s){o.default=s}),t=Go&&Go.__importStar||function(o){if(o&&o.__esModule)return o;var s={};if(o!=null)for(var u in o)u!=="default"&&Object.prototype.hasOwnProperty.call(o,u)&&a(s,o,u);return e(s,o),s};Object.defineProperty(Go,"__esModule",{value:!0}),Go.Generation=void 0;const r=t($()),n=cH(),i=Er();return Go.Generation=r.serialization.object({id:r.serialization.string(),prompt:r.serialization.string().optional(),generations:r.serialization.list(n.SingleGeneration),meta:i.ApiMeta.optional()}),Go}var ko={},WF;function Jb(){if(WF)return ko;WF=1;var a=ko&&ko.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=ko&&ko.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=ko&&ko.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(ko,"__esModule",{value:!0}),ko.GenerateStreamEvent=void 0;const r=t($());return ko.GenerateStreamEvent=r.serialization.object({}),ko}var Ho={},KF;function fH(){if(KF)return Ho;KF=1;var a=Ho&&Ho.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),e=Ho&&Ho.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),t=Ho&&Ho.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&a(o,i,s);return e(o,i),o};Object.defineProperty(Ho,"__esModule",{value:!0}),Ho.GenerateStreamText=void 0;const r=t($()),n=Jb();return Ho.GenerateStreamText=r.serialization.object({text:r.serialization.string(),index:r.serialization.number().optional(),isFinished:r.serialization.property("is_finished",r.serialization.boolean())}).extend(n.GenerateStreamEvent),Ho}var Wo={},JF;function dH(){if(JF)return Wo;JF=1;var a=Wo&&Wo.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),e=Wo&&Wo.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),t=Wo&&Wo.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&a(o,i,s);return e(o,i),o};Object.defineProperty(Wo,"__esModule",{value:!0}),Wo.SingleGenerationInStream=void 0;const r=t($()),n=s_();return Wo.SingleGenerationInStream=r.serialization.object({id:r.serialization.string(),text:r.serialization.string(),index:r.serialization.number().optional(),finishReason:r.serialization.property("finish_reason",n.FinishReason)}),Wo}var Ko={},XF;function hH(){if(XF)return Ko;XF=1;var a=Ko&&Ko.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),e=Ko&&Ko.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),t=Ko&&Ko.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&a(o,i,s);return e(o,i),o};Object.defineProperty(Ko,"__esModule",{value:!0}),Ko.GenerateStreamEndResponse=void 0;const r=t($()),n=dH();return Ko.GenerateStreamEndResponse=r.serialization.object({id:r.serialization.string(),prompt:r.serialization.string().optional(),generations:r.serialization.list(n.SingleGenerationInStream).optional()}),Ko}var Jo={},ZF;function pH(){if(ZF)return Jo;ZF=1;var a=Jo&&Jo.__createBinding||(Object.create?function(s,u,l,c){c===void 0&&(c=l);var f=Object.getOwnPropertyDescriptor(u,l);(!f||("get"in f?!u.__esModule:f.writable||f.configurable))&&(f={enumerable:!0,get:function(){return u[l]}}),Object.defineProperty(s,c,f)}:function(s,u,l,c){c===void 0&&(c=l),s[c]=u[l]}),e=Jo&&Jo.__setModuleDefault||(Object.create?function(s,u){Object.defineProperty(s,"default",{enumerable:!0,value:u})}:function(s,u){s.default=u}),t=Jo&&Jo.__importStar||function(s){if(s&&s.__esModule)return s;var u={};if(s!=null)for(var l in s)l!=="default"&&Object.prototype.hasOwnProperty.call(s,l)&&a(u,s,l);return e(u,s),u};Object.defineProperty(Jo,"__esModule",{value:!0}),Jo.GenerateStreamEnd=void 0;const r=t($()),n=s_(),i=hH(),o=Jb();return Jo.GenerateStreamEnd=r.serialization.object({isFinished:r.serialization.property("is_finished",r.serialization.boolean()),finishReason:r.serialization.property("finish_reason",n.FinishReason.optional()),response:i.GenerateStreamEndResponse}).extend(o.GenerateStreamEvent),Jo}var Xo={},QF;function _H(){if(QF)return Xo;QF=1;var a=Xo&&Xo.__createBinding||(Object.create?function(o,s,u,l){l===void 0&&(l=u);var c=Object.getOwnPropertyDescriptor(s,u);(!c||("get"in c?!s.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return s[u]}}),Object.defineProperty(o,l,c)}:function(o,s,u,l){l===void 0&&(l=u),o[l]=s[u]}),e=Xo&&Xo.__setModuleDefault||(Object.create?function(o,s){Object.defineProperty(o,"default",{enumerable:!0,value:s})}:function(o,s){o.default=s}),t=Xo&&Xo.__importStar||function(o){if(o&&o.__esModule)return o;var s={};if(o!=null)for(var u in o)u!=="default"&&Object.prototype.hasOwnProperty.call(o,u)&&a(s,o,u);return e(s,o),s};Object.defineProperty(Xo,"__esModule",{value:!0}),Xo.GenerateStreamError=void 0;const r=t($()),n=s_(),i=Jb();return Xo.GenerateStreamError=r.serialization.object({index:r.serialization.number().optional(),isFinished:r.serialization.property("is_finished",r.serialization.boolean()),finishReason:r.serialization.property("finish_reason",n.FinishReason),err:r.serialization.string()}).extend(i.GenerateStreamEvent),Xo}var Zo={},YF;function yle(){if(YF)return Zo;YF=1;var a=Zo&&Zo.__createBinding||(Object.create?function(s,u,l,c){c===void 0&&(c=l);var f=Object.getOwnPropertyDescriptor(u,l);(!f||("get"in f?!u.__esModule:f.writable||f.configurable))&&(f={enumerable:!0,get:function(){return u[l]}}),Object.defineProperty(s,c,f)}:function(s,u,l,c){c===void 0&&(c=l),s[c]=u[l]}),e=Zo&&Zo.__setModuleDefault||(Object.create?function(s,u){Object.defineProperty(s,"default",{enumerable:!0,value:u})}:function(s,u){s.default=u}),t=Zo&&Zo.__importStar||function(s){if(s&&s.__esModule)return s;var u={};if(s!=null)for(var l in s)l!=="default"&&Object.prototype.hasOwnProperty.call(s,l)&&a(u,s,l);return e(u,s),u};Object.defineProperty(Zo,"__esModule",{value:!0}),Zo.GenerateStreamedResponse=void 0;const r=t($()),n=fH(),i=pH(),o=_H();return Zo.GenerateStreamedResponse=r.serialization.union(r.serialization.discriminant("eventType","event_type"),{"text-generation":n.GenerateStreamText,"stream-end":i.GenerateStreamEnd,"stream-error":o.GenerateStreamError}).transform({transform:s=>s,untransform:s=>s}),Zo}var Qo={},eL;function yH(){if(eL)return Qo;eL=1;var a=Qo&&Qo.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=Qo&&Qo.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=Qo&&Qo.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(Qo,"__esModule",{value:!0}),Qo.EmbedJobStatus=void 0;const r=t($());return Qo.EmbedJobStatus=r.serialization.enum_(["processing","complete","cancelling","cancelled","failed"]),Qo}var Yo={},tL;function bH(){if(tL)return Yo;tL=1;var a=Yo&&Yo.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=Yo&&Yo.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=Yo&&Yo.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(Yo,"__esModule",{value:!0}),Yo.EmbedJobTruncate=void 0;const r=t($());return Yo.EmbedJobTruncate=r.serialization.enum_(["START","END"]),Yo}var es={},rL;function mH(){if(rL)return es;rL=1;var a=es&&es.__createBinding||(Object.create?function(s,u,l,c){c===void 0&&(c=l);var f=Object.getOwnPropertyDescriptor(u,l);(!f||("get"in f?!u.__esModule:f.writable||f.configurable))&&(f={enumerable:!0,get:function(){return u[l]}}),Object.defineProperty(s,c,f)}:function(s,u,l,c){c===void 0&&(c=l),s[c]=u[l]}),e=es&&es.__setModuleDefault||(Object.create?function(s,u){Object.defineProperty(s,"default",{enumerable:!0,value:u})}:function(s,u){s.default=u}),t=es&&es.__importStar||function(s){if(s&&s.__esModule)return s;var u={};if(s!=null)for(var l in s)l!=="default"&&Object.prototype.hasOwnProperty.call(s,l)&&a(u,s,l);return e(u,s),u};Object.defineProperty(es,"__esModule",{value:!0}),es.EmbedJob=void 0;const r=t($()),n=yH(),i=bH(),o=Er();return es.EmbedJob=r.serialization.object({jobId:r.serialization.property("job_id",r.serialization.string()),name:r.serialization.string().optional(),status:n.EmbedJobStatus,createdAt:r.serialization.property("created_at",r.serialization.date()),inputDatasetId:r.serialization.property("input_dataset_id",r.serialization.string()),outputDatasetId:r.serialization.property("output_dataset_id",r.serialization.string().optional()),model:r.serialization.string(),truncate:i.EmbedJobTruncate,meta:o.ApiMeta.optional()}),es}var ts={},nL;function ble(){if(nL)return ts;nL=1;var a=ts&&ts.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),e=ts&&ts.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),t=ts&&ts.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&a(o,i,s);return e(o,i),o};Object.defineProperty(ts,"__esModule",{value:!0}),ts.ListEmbedJobResponse=void 0;const r=t($()),n=mH();return ts.ListEmbedJobResponse=r.serialization.object({embedJobs:r.serialization.property("embed_jobs",r.serialization.list(n.EmbedJob).optional())}),ts}var rs={},iL;function mle(){if(iL)return rs;iL=1;var a=rs&&rs.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),e=rs&&rs.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),t=rs&&rs.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&a(o,i,s);return e(o,i),o};Object.defineProperty(rs,"__esModule",{value:!0}),rs.CreateEmbedJobResponse=void 0;const r=t($()),n=Er();return rs.CreateEmbedJobResponse=r.serialization.object({jobId:r.serialization.property("job_id",r.serialization.string()),meta:n.ApiMeta.optional()}),rs}var ns={},aL;function gH(){if(aL)return ns;aL=1;var a=ns&&ns.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=ns&&ns.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=ns&&ns.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(ns,"__esModule",{value:!0}),ns.ClassifyExample=void 0;const r=t($());return ns.ClassifyExample=r.serialization.object({text:r.serialization.string().optional(),label:r.serialization.string().optional()}),ns}var is={},oL;function gle(){if(oL)return is;oL=1;var a=is&&is.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=is&&is.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=is&&is.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(is,"__esModule",{value:!0}),is.ParseInfo=void 0;const r=t($());return is.ParseInfo=r.serialization.object({separator:r.serialization.string().optional(),delimiter:r.serialization.string().optional()}),is}var as={},sL;function vle(){if(sL)return as;sL=1;var a=as&&as.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=as&&as.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=as&&as.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(as,"__esModule",{value:!0}),as.RerankerDataMetrics=void 0;const r=t($());return as.RerankerDataMetrics=r.serialization.object({numTrainQueries:r.serialization.property("num_train_queries",r.serialization.number().optional()),numTrainRelevantPassages:r.serialization.property("num_train_relevant_passages",r.serialization.number().optional()),numTrainHardNegatives:r.serialization.property("num_train_hard_negatives",r.serialization.number().optional()),numEvalQueries:r.serialization.property("num_eval_queries",r.serialization.number().optional()),numEvalRelevantPassages:r.serialization.property("num_eval_relevant_passages",r.serialization.number().optional()),numEvalHardNegatives:r.serialization.property("num_eval_hard_negatives",r.serialization.number().optional())}),as}var os={},uL;function wle(){if(uL)return os;uL=1;var a=os&&os.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=os&&os.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=os&&os.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(os,"__esModule",{value:!0}),os.ChatDataMetrics=void 0;const r=t($());return os.ChatDataMetrics=r.serialization.object({numTrainTurns:r.serialization.property("num_train_turns",r.serialization.number().optional()),numEvalTurns:r.serialization.property("num_eval_turns",r.serialization.number().optional()),preamble:r.serialization.string().optional()}),os}var ss={},lL;function vH(){if(lL)return ss;lL=1;var a=ss&&ss.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=ss&&ss.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=ss&&ss.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(ss,"__esModule",{value:!0}),ss.LabelMetric=void 0;const r=t($());return ss.LabelMetric=r.serialization.object({totalExamples:r.serialization.property("total_examples",r.serialization.number().optional()),label:r.serialization.string().optional(),samples:r.serialization.list(r.serialization.string()).optional()}),ss}var us={},cL;function Ole(){if(cL)return us;cL=1;var a=us&&us.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),e=us&&us.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),t=us&&us.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&a(o,i,s);return e(o,i),o};Object.defineProperty(us,"__esModule",{value:!0}),us.ClassifyDataMetrics=void 0;const r=t($()),n=vH();return us.ClassifyDataMetrics=r.serialization.object({labelMetrics:r.serialization.property("label_metrics",r.serialization.list(n.LabelMetric).optional())}),us}var ls={},fL;function wH(){if(fL)return ls;fL=1;var a=ls&&ls.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=ls&&ls.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=ls&&ls.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(ls,"__esModule",{value:!0}),ls.FinetuneDatasetMetrics=void 0;const r=t($());return ls.FinetuneDatasetMetrics=r.serialization.object({trainableTokenCount:r.serialization.property("trainable_token_count",r.serialization.number().optional()),totalExamples:r.serialization.property("total_examples",r.serialization.number().optional()),trainExamples:r.serialization.property("train_examples",r.serialization.number().optional()),trainSizeBytes:r.serialization.property("train_size_bytes",r.serialization.number().optional()),evalExamples:r.serialization.property("eval_examples",r.serialization.number().optional()),evalSizeBytes:r.serialization.property("eval_size_bytes",r.serialization.number().optional())}),ls}var cs={},dL;function OH(){if(dL)return cs;dL=1;var a=cs&&cs.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=cs&&cs.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=cs&&cs.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(cs,"__esModule",{value:!0}),cs.MetricsEmbedDataFieldsItem=void 0;const r=t($());return cs.MetricsEmbedDataFieldsItem=r.serialization.object({name:r.serialization.string().optional(),count:r.serialization.number().optional()}),cs}var fs={},hL;function SH(){if(hL)return fs;hL=1;var a=fs&&fs.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),e=fs&&fs.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),t=fs&&fs.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&a(o,i,s);return e(o,i),o};Object.defineProperty(fs,"__esModule",{value:!0}),fs.MetricsEmbedData=void 0;const r=t($()),n=OH();return fs.MetricsEmbedData=r.serialization.object({fields:r.serialization.list(n.MetricsEmbedDataFieldsItem).optional()}),fs}var ds={},pL;function Sle(){if(pL)return ds;pL=1;var a=ds&&ds.__createBinding||(Object.create?function(o,s,u,l){l===void 0&&(l=u);var c=Object.getOwnPropertyDescriptor(s,u);(!c||("get"in c?!s.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return s[u]}}),Object.defineProperty(o,l,c)}:function(o,s,u,l){l===void 0&&(l=u),o[l]=s[u]}),e=ds&&ds.__setModuleDefault||(Object.create?function(o,s){Object.defineProperty(o,"default",{enumerable:!0,value:s})}:function(o,s){o.default=s}),t=ds&&ds.__importStar||function(o){if(o&&o.__esModule)return o;var s={};if(o!=null)for(var u in o)u!=="default"&&Object.prototype.hasOwnProperty.call(o,u)&&a(s,o,u);return e(s,o),s};Object.defineProperty(ds,"__esModule",{value:!0}),ds.Metrics=void 0;const r=t($()),n=wH(),i=SH();return ds.Metrics=r.serialization.object({finetuneDatasetMetrics:r.serialization.property("finetune_dataset_metrics",n.FinetuneDatasetMetrics.optional()),embedData:r.serialization.property("embed_data",i.MetricsEmbedData.optional())}),ds}var hs={},_L;function EH(){if(_L)return hs;_L=1;var a=hs&&hs.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=hs&&hs.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=hs&&hs.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(hs,"__esModule",{value:!0}),hs.ConnectorOAuth=void 0;const r=t($());return hs.ConnectorOAuth=r.serialization.object({clientId:r.serialization.property("client_id",r.serialization.string().optional()),clientSecret:r.serialization.property("client_secret",r.serialization.string().optional()),authorizeUrl:r.serialization.property("authorize_url",r.serialization.string()),tokenUrl:r.serialization.property("token_url",r.serialization.string()),scope:r.serialization.string().optional()}),hs}var ps={},yL;function RH(){if(yL)return ps;yL=1;var a=ps&&ps.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=ps&&ps.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=ps&&ps.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(ps,"__esModule",{value:!0}),ps.ConnectorAuthStatus=void 0;const r=t($());return ps.ConnectorAuthStatus=r.serialization.enum_(["valid","expired"]),ps}var _s={},bL;function u_(){if(bL)return _s;bL=1;var a=_s&&_s.__createBinding||(Object.create?function(o,s,u,l){l===void 0&&(l=u);var c=Object.getOwnPropertyDescriptor(s,u);(!c||("get"in c?!s.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return s[u]}}),Object.defineProperty(o,l,c)}:function(o,s,u,l){l===void 0&&(l=u),o[l]=s[u]}),e=_s&&_s.__setModuleDefault||(Object.create?function(o,s){Object.defineProperty(o,"default",{enumerable:!0,value:s})}:function(o,s){o.default=s}),t=_s&&_s.__importStar||function(o){if(o&&o.__esModule)return o;var s={};if(o!=null)for(var u in o)u!=="default"&&Object.prototype.hasOwnProperty.call(o,u)&&a(s,o,u);return e(s,o),s};Object.defineProperty(_s,"__esModule",{value:!0}),_s.Connector=void 0;const r=t($()),n=EH(),i=RH();return _s.Connector=r.serialization.object({id:r.serialization.string(),organizationId:r.serialization.property("organization_id",r.serialization.string().optional()),name:r.serialization.string(),description:r.serialization.string().optional(),url:r.serialization.string().optional(),createdAt:r.serialization.property("created_at",r.serialization.date()),updatedAt:r.serialization.property("updated_at",r.serialization.date()),excludes:r.serialization.list(r.serialization.string()).optional(),authType:r.serialization.property("auth_type",r.serialization.string().optional()),oauth:n.ConnectorOAuth.optional(),authStatus:r.serialization.property("auth_status",i.ConnectorAuthStatus.optional()),active:r.serialization.boolean().optional(),continueOnFailure:r.serialization.property("continue_on_failure",r.serialization.boolean().optional())}),_s}var ys={},mL;function Ele(){if(mL)return ys;mL=1;var a=ys&&ys.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),e=ys&&ys.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),t=ys&&ys.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&a(o,i,s);return e(o,i),o};Object.defineProperty(ys,"__esModule",{value:!0}),ys.ListConnectorsResponse=void 0;const r=t($()),n=u_();return ys.ListConnectorsResponse=r.serialization.object({connectors:r.serialization.list(n.Connector),totalCount:r.serialization.property("total_count",r.serialization.number().optional())}),ys}var bs={},gL;function Rle(){if(gL)return bs;gL=1;var a=bs&&bs.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),e=bs&&bs.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),t=bs&&bs.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&a(o,i,s);return e(o,i),o};Object.defineProperty(bs,"__esModule",{value:!0}),bs.CreateConnectorResponse=void 0;const r=t($()),n=u_();return bs.CreateConnectorResponse=r.serialization.object({connector:n.Connector}),bs}var ms={},vL;function Cle(){if(vL)return ms;vL=1;var a=ms&&ms.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),e=ms&&ms.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),t=ms&&ms.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&a(o,i,s);return e(o,i),o};Object.defineProperty(ms,"__esModule",{value:!0}),ms.GetConnectorResponse=void 0;const r=t($()),n=u_();return ms.GetConnectorResponse=r.serialization.object({connector:n.Connector}),ms}var gs={},wL;function Ple(){if(wL)return gs;wL=1;var a=gs&&gs.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=gs&&gs.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=gs&&gs.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(gs,"__esModule",{value:!0}),gs.DeleteConnectorResponse=void 0;const r=t($());return gs.DeleteConnectorResponse=r.serialization.record(r.serialization.string(),r.serialization.unknown()),gs}var vs={},OL;function jle(){if(OL)return vs;OL=1;var a=vs&&vs.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),e=vs&&vs.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),t=vs&&vs.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&a(o,i,s);return e(o,i),o};Object.defineProperty(vs,"__esModule",{value:!0}),vs.UpdateConnectorResponse=void 0;const r=t($()),n=u_();return vs.UpdateConnectorResponse=r.serialization.object({connector:n.Connector}),vs}var ws={},SL;function Tle(){if(SL)return ws;SL=1;var a=ws&&ws.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=ws&&ws.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=ws&&ws.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(ws,"__esModule",{value:!0}),ws.OAuthAuthorizeResponse=void 0;const r=t($());return ws.OAuthAuthorizeResponse=r.serialization.object({redirectUrl:r.serialization.property("redirect_url",r.serialization.string().optional())}),ws}var Os={},EL;function CH(){if(EL)return Os;EL=1;var a=Os&&Os.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=Os&&Os.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=Os&&Os.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(Os,"__esModule",{value:!0}),Os.CompatibleEndpoint=void 0;const r=t($());return Os.CompatibleEndpoint=r.serialization.enum_(["chat","embed","classify","summarize","rerank","rate","generate"]),Os}var Ss={},RL;function PH(){if(RL)return Ss;RL=1;var a=Ss&&Ss.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),e=Ss&&Ss.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),t=Ss&&Ss.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&a(o,i,s);return e(o,i),o};Object.defineProperty(Ss,"__esModule",{value:!0}),Ss.GetModelResponse=void 0;const r=t($()),n=CH();return Ss.GetModelResponse=r.serialization.object({name:r.serialization.string().optional(),endpoints:r.serialization.list(n.CompatibleEndpoint).optional(),finetuned:r.serialization.boolean().optional(),contextLength:r.serialization.property("context_length",r.serialization.number().optional()),tokenizerUrl:r.serialization.property("tokenizer_url",r.serialization.string().optional()),supportsVision:r.serialization.property("supports_vision",r.serialization.boolean().optional()),defaultEndpoints:r.serialization.property("default_endpoints",r.serialization.list(n.CompatibleEndpoint).optional())}),Ss}var Es={},CL;function Mle(){if(CL)return Es;CL=1;var a=Es&&Es.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),e=Es&&Es.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),t=Es&&Es.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&a(o,i,s);return e(o,i),o};Object.defineProperty(Es,"__esModule",{value:!0}),Es.ListModelsResponse=void 0;const r=t($()),n=PH();return Es.ListModelsResponse=r.serialization.object({models:r.serialization.list(n.GetModelResponse),nextPageToken:r.serialization.property("next_page_token",r.serialization.string().optional())}),Es}var PL;function Ale(){return PL||(PL=1,function(a){var e=dc&&dc.__createBinding||(Object.create?function(r,n,i,o){o===void 0&&(o=i);var s=Object.getOwnPropertyDescriptor(n,i);(!s||("get"in s?!n.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(r,o,s)}:function(r,n,i,o){o===void 0&&(o=i),r[o]=n[i]}),t=dc&&dc.__exportStar||function(r,n){for(var i in r)i!=="default"&&!Object.prototype.hasOwnProperty.call(n,i)&&e(n,r,i)};Object.defineProperty(a,"__esModule",{value:!0}),t(U6(),a),t(F6(),a),t(nle(),a),t(L6(),a),t(V6(),a),t(G6(),a),t(ile(),a),t(k6(),a),t(H6(),a),t(W6(),a),t(K6(),a),t(J6(),a),t(X6(),a),t(ale(),a),t(tk(),a),t(rk(),a),t(nk(),a),t(ole(),a),t(ik(),a),t(ak(),a),t(ok(),a),t(sk(),a),t(sle(),a),t(uk(),a),t(lk(),a),t(ck(),a),t(ule(),a),t(lle(),a),t(cle(),a),t(fle(),a),t(a_(),a),t(fk(),a),t(Hb(),a),t(dk(),a),t(Wb(),a),t(HC(),a),t(o_(),a),t(hk(),a),t(WC(),a),t(pk(),a),t(_k(),a),t(KC(),a),t(yk(),a),t(JC(),a),t(Kb(),a),t(bk(),a),t(XC(),a),t(s_(),a),t(kG(),a),t(HG(),a),t(WG(),a),t(Er(),a),t(mk(),a),t(su(),a),t(gk(),a),t(vk(),a),t(wk(),a),t(Ok(),a),t(Sk(),a),t(Ek(),a),t(Rk(),a),t(Ck(),a),t(Pk(),a),t(jk(),a),t(ZC(),a),t(dle(),a),t(Gf(),a),t(JG(),a),t(XG(),a),t(ZG(),a),t(QG(),a),t(YG(),a),t(e6(),a),t(Fb(),a),t(n6(),a),t(i6(),a),t(a6(),a),t(o6(),a),t(Lb(),a),t(t6(),a),t(r6(),a),t(s6(),a),t(u6(),a),t(l6(),a),t(c6(),a),t(Ub(),a),t(f6(),a),t(d6(),a),t(h6(),a),t(p6(),a),t(_6(),a),t(qC(),a),t(y6(),a),t(zC(),a),t(b6(),a),t(BC(),a),t(m6(),a),t(g6(),a),t(UC(),a),t(QC(),a),t(Tk(),a),t(Mk(),a),t(Ak(),a),t(Ik(),a),t(YC(),a),t(eP(),a),t(hle(),a),t(xr(),a),t(Dk(),a),t(xk(),a),t($k(),a),t(Nk(),a),t(qk(),a),t(zk(),a),t(Bk(),a),t(Uk(),a),t(Fk(),a),t(Lk(),a),t(Vk(),a),t(Gk(),a),t(kk(),a),t(Hk(),a),t(Wk(),a),t(Kk(),a),t(Jk(),a),t(Xk(),a),t(Zk(),a),t(Qk(),a),t(Yk(),a),t(eH(),a),t(tH(),a),t(rH(),a),t(nH(),a),t(iH(),a),t(aH(),a),t(oH(),a),t(sH(),a),t(uH(),a),t(ple(),a),t(lH(),a),t(cH(),a),t(_le(),a),t(Jb(),a),t(fH(),a),t(dH(),a),t(hH(),a),t(pH(),a),t(_H(),a),t(yle(),a),t(Vb(),a),t(Gb(),a),t(kC(),a),t(Z6(),a),t(Q6(),a),t(Y6(),a),t(yH(),a),t(bH(),a),t(mH(),a),t(ble(),a),t(mle(),a),t(ek(),a),t(gH(),a),t(R6(),a),t(E6(),a),t(C6(),a),t(gle(),a),t(vle(),a),t(wle(),a),t(vH(),a),t(Ole(),a),t(wH(),a),t(OH(),a),t(SH(),a),t(Sle(),a),t(FC(),a),t(EH(),a),t(RH(),a),t(u_(),a),t(Ele(),a),t(VC(),a),t(z6(),a),t(GC(),a),t(Rle(),a),t(Cle(),a),t(Ple(),a),t(jle(),a),t(Tle(),a),t(CH(),a),t(PH(),a),t(Mle(),a)}(dc)),dc}var hc={},lE={},Rs={},jL;function Ile(){if(jL)return Rs;jL=1;var a=Rs&&Rs.__createBinding||(Object.create?function(h,y,d,_){_===void 0&&(_=d);var m=Object.getOwnPropertyDescriptor(y,d);(!m||("get"in m?!y.__esModule:m.writable||m.configurable))&&(m={enumerable:!0,get:function(){return y[d]}}),Object.defineProperty(h,_,m)}:function(h,y,d,_){_===void 0&&(_=d),h[_]=y[d]}),e=Rs&&Rs.__setModuleDefault||(Object.create?function(h,y){Object.defineProperty(h,"default",{enumerable:!0,value:y})}:function(h,y){h.default=y}),t=Rs&&Rs.__importStar||function(h){if(h&&h.__esModule)return h;var y={};if(h!=null)for(var d in h)d!=="default"&&Object.prototype.hasOwnProperty.call(h,d)&&a(y,h,d);return e(y,h),y};Object.defineProperty(Rs,"__esModule",{value:!0}),Rs.ChatStreamRequest=void 0;const r=t($()),n=Wb(),i=U6(),o=HC(),s=o_(),u=F6(),l=WC(),c=Hb(),f=KC(),p=L6();return Rs.ChatStreamRequest=r.serialization.object({message:r.serialization.string(),model:r.serialization.string().optional(),preamble:r.serialization.string().optional(),chatHistory:r.serialization.property("chat_history",r.serialization.list(n.Message).optional()),conversationId:r.serialization.property("conversation_id",r.serialization.string().optional()),promptTruncation:r.serialization.property("prompt_truncation",i.ChatStreamRequestPromptTruncation.optional()),connectors:r.serialization.list(o.ChatConnector).optional(),searchQueriesOnly:r.serialization.property("search_queries_only",r.serialization.boolean().optional()),documents:r.serialization.list(s.ChatDocument).optional(),citationQuality:r.serialization.property("citation_quality",u.ChatStreamRequestCitationQuality.optional()),temperature:r.serialization.number().optional(),maxTokens:r.serialization.property("max_tokens",r.serialization.number().optional()),maxInputTokens:r.serialization.property("max_input_tokens",r.serialization.number().optional()),k:r.serialization.number().optional(),p:r.serialization.number().optional(),seed:r.serialization.number().optional(),stopSequences:r.serialization.property("stop_sequences",r.serialization.list(r.serialization.string()).optional()),frequencyPenalty:r.serialization.property("frequency_penalty",r.serialization.number().optional()),presencePenalty:r.serialization.property("presence_penalty",r.serialization.number().optional()),rawPrompting:r.serialization.property("raw_prompting",r.serialization.boolean().optional()),returnPrompt:r.serialization.property("return_prompt",r.serialization.boolean().optional()),tools:r.serialization.list(l.Tool).optional(),toolResults:r.serialization.property("tool_results",r.serialization.list(c.ToolResult).optional()),forceSingleStep:r.serialization.property("force_single_step",r.serialization.boolean().optional()),responseFormat:r.serialization.property("response_format",f.ResponseFormat.optional()),safetyMode:r.serialization.property("safety_mode",p.ChatStreamRequestSafetyMode.optional())}),Rs}var Cs={},TL;function Dle(){if(TL)return Cs;TL=1;var a=Cs&&Cs.__createBinding||(Object.create?function(h,y,d,_){_===void 0&&(_=d);var m=Object.getOwnPropertyDescriptor(y,d);(!m||("get"in m?!y.__esModule:m.writable||m.configurable))&&(m={enumerable:!0,get:function(){return y[d]}}),Object.defineProperty(h,_,m)}:function(h,y,d,_){_===void 0&&(_=d),h[_]=y[d]}),e=Cs&&Cs.__setModuleDefault||(Object.create?function(h,y){Object.defineProperty(h,"default",{enumerable:!0,value:y})}:function(h,y){h.default=y}),t=Cs&&Cs.__importStar||function(h){if(h&&h.__esModule)return h;var y={};if(h!=null)for(var d in h)d!=="default"&&Object.prototype.hasOwnProperty.call(h,d)&&a(y,h,d);return e(y,h),y};Object.defineProperty(Cs,"__esModule",{value:!0}),Cs.ChatRequest=void 0;const r=t($()),n=Wb(),i=V6(),o=HC(),s=o_(),u=G6(),l=WC(),c=Hb(),f=KC(),p=k6();return Cs.ChatRequest=r.serialization.object({message:r.serialization.string(),model:r.serialization.string().optional(),preamble:r.serialization.string().optional(),chatHistory:r.serialization.property("chat_history",r.serialization.list(n.Message).optional()),conversationId:r.serialization.property("conversation_id",r.serialization.string().optional()),promptTruncation:r.serialization.property("prompt_truncation",i.ChatRequestPromptTruncation.optional()),connectors:r.serialization.list(o.ChatConnector).optional(),searchQueriesOnly:r.serialization.property("search_queries_only",r.serialization.boolean().optional()),documents:r.serialization.list(s.ChatDocument).optional(),citationQuality:r.serialization.property("citation_quality",u.ChatRequestCitationQuality.optional()),temperature:r.serialization.number().optional(),maxTokens:r.serialization.property("max_tokens",r.serialization.number().optional()),maxInputTokens:r.serialization.property("max_input_tokens",r.serialization.number().optional()),k:r.serialization.number().optional(),p:r.serialization.number().optional(),seed:r.serialization.number().optional(),stopSequences:r.serialization.property("stop_sequences",r.serialization.list(r.serialization.string()).optional()),frequencyPenalty:r.serialization.property("frequency_penalty",r.serialization.number().optional()),presencePenalty:r.serialization.property("presence_penalty",r.serialization.number().optional()),rawPrompting:r.serialization.property("raw_prompting",r.serialization.boolean().optional()),returnPrompt:r.serialization.property("return_prompt",r.serialization.boolean().optional()),tools:r.serialization.list(l.Tool).optional(),toolResults:r.serialization.property("tool_results",r.serialization.list(c.ToolResult).optional()),forceSingleStep:r.serialization.property("force_single_step",r.serialization.boolean().optional()),responseFormat:r.serialization.property("response_format",f.ResponseFormat.optional()),safetyMode:r.serialization.property("safety_mode",p.ChatRequestSafetyMode.optional())}),Cs}var Ps={},ML;function xle(){if(ML)return Ps;ML=1;var a=Ps&&Ps.__createBinding||(Object.create?function(o,s,u,l){l===void 0&&(l=u);var c=Object.getOwnPropertyDescriptor(s,u);(!c||("get"in c?!s.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return s[u]}}),Object.defineProperty(o,l,c)}:function(o,s,u,l){l===void 0&&(l=u),o[l]=s[u]}),e=Ps&&Ps.__setModuleDefault||(Object.create?function(o,s){Object.defineProperty(o,"default",{enumerable:!0,value:s})}:function(o,s){o.default=s}),t=Ps&&Ps.__importStar||function(o){if(o&&o.__esModule)return o;var s={};if(o!=null)for(var u in o)u!=="default"&&Object.prototype.hasOwnProperty.call(o,u)&&a(s,o,u);return e(s,o),s};Object.defineProperty(Ps,"__esModule",{value:!0}),Ps.GenerateStreamRequest=void 0;const r=t($()),n=H6(),i=W6();return Ps.GenerateStreamRequest=r.serialization.object({prompt:r.serialization.string(),model:r.serialization.string().optional(),numGenerations:r.serialization.property("num_generations",r.serialization.number().optional()),maxTokens:r.serialization.property("max_tokens",r.serialization.number().optional()),truncate:n.GenerateStreamRequestTruncate.optional(),temperature:r.serialization.number().optional(),seed:r.serialization.number().optional(),preset:r.serialization.string().optional(),endSequences:r.serialization.property("end_sequences",r.serialization.list(r.serialization.string()).optional()),stopSequences:r.serialization.property("stop_sequences",r.serialization.list(r.serialization.string()).optional()),k:r.serialization.number().optional(),p:r.serialization.number().optional(),frequencyPenalty:r.serialization.property("frequency_penalty",r.serialization.number().optional()),presencePenalty:r.serialization.property("presence_penalty",r.serialization.number().optional()),returnLikelihoods:r.serialization.property("return_likelihoods",i.GenerateStreamRequestReturnLikelihoods.optional()),rawPrompting:r.serialization.property("raw_prompting",r.serialization.boolean().optional())}),Ps}var js={},AL;function $le(){if(AL)return js;AL=1;var a=js&&js.__createBinding||(Object.create?function(o,s,u,l){l===void 0&&(l=u);var c=Object.getOwnPropertyDescriptor(s,u);(!c||("get"in c?!s.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return s[u]}}),Object.defineProperty(o,l,c)}:function(o,s,u,l){l===void 0&&(l=u),o[l]=s[u]}),e=js&&js.__setModuleDefault||(Object.create?function(o,s){Object.defineProperty(o,"default",{enumerable:!0,value:s})}:function(o,s){o.default=s}),t=js&&js.__importStar||function(o){if(o&&o.__esModule)return o;var s={};if(o!=null)for(var u in o)u!=="default"&&Object.prototype.hasOwnProperty.call(o,u)&&a(s,o,u);return e(s,o),s};Object.defineProperty(js,"__esModule",{value:!0}),js.GenerateRequest=void 0;const r=t($()),n=K6(),i=J6();return js.GenerateRequest=r.serialization.object({prompt:r.serialization.string(),model:r.serialization.string().optional(),numGenerations:r.serialization.property("num_generations",r.serialization.number().optional()),maxTokens:r.serialization.property("max_tokens",r.serialization.number().optional()),truncate:n.GenerateRequestTruncate.optional(),temperature:r.serialization.number().optional(),seed:r.serialization.number().optional(),preset:r.serialization.string().optional(),endSequences:r.serialization.property("end_sequences",r.serialization.list(r.serialization.string()).optional()),stopSequences:r.serialization.property("stop_sequences",r.serialization.list(r.serialization.string()).optional()),k:r.serialization.number().optional(),p:r.serialization.number().optional(),frequencyPenalty:r.serialization.property("frequency_penalty",r.serialization.number().optional()),presencePenalty:r.serialization.property("presence_penalty",r.serialization.number().optional()),returnLikelihoods:r.serialization.property("return_likelihoods",i.GenerateRequestReturnLikelihoods.optional()),rawPrompting:r.serialization.property("raw_prompting",r.serialization.boolean().optional())}),js}var Ts={},IL;function Nle(){if(IL)return Ts;IL=1;var a=Ts&&Ts.__createBinding||(Object.create?function(s,u,l,c){c===void 0&&(c=l);var f=Object.getOwnPropertyDescriptor(u,l);(!f||("get"in f?!u.__esModule:f.writable||f.configurable))&&(f={enumerable:!0,get:function(){return u[l]}}),Object.defineProperty(s,c,f)}:function(s,u,l,c){c===void 0&&(c=l),s[c]=u[l]}),e=Ts&&Ts.__setModuleDefault||(Object.create?function(s,u){Object.defineProperty(s,"default",{enumerable:!0,value:u})}:function(s,u){s.default=u}),t=Ts&&Ts.__importStar||function(s){if(s&&s.__esModule)return s;var u={};if(s!=null)for(var l in s)l!=="default"&&Object.prototype.hasOwnProperty.call(s,l)&&a(u,s,l);return e(u,s),u};Object.defineProperty(Ts,"__esModule",{value:!0}),Ts.EmbedRequest=void 0;const r=t($()),n=Vb(),i=Gb(),o=X6();return Ts.EmbedRequest=r.serialization.object({texts:r.serialization.list(r.serialization.string()).optional(),images:r.serialization.list(r.serialization.string()).optional(),model:r.serialization.string().optional(),inputType:r.serialization.property("input_type",n.EmbedInputType.optional()),embeddingTypes:r.serialization.property("embedding_types",r.serialization.list(i.EmbeddingType).optional()),truncate:o.EmbedRequestTruncate.optional()}),Ts}var Ms={},DL;function qle(){if(DL)return Ms;DL=1;var a=Ms&&Ms.__createBinding||(Object.create?function(i,o,s,u){u===void 0&&(u=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,u,l)}:function(i,o,s,u){u===void 0&&(u=s),i[u]=o[s]}),e=Ms&&Ms.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),t=Ms&&Ms.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&a(o,i,s);return e(o,i),o};Object.defineProperty(Ms,"__esModule",{value:!0}),Ms.RerankRequest=void 0;const r=t($()),n=tk();return Ms.RerankRequest=r.serialization.object({model:r.serialization.string().optional(),query:r.serialization.string(),documents:r.serialization.list(n.RerankRequestDocumentsItem),topN:r.serialization.property("top_n",r.serialization.number().optional()),rankFields:r.serialization.property("rank_fields",r.serialization.list(r.serialization.string()).optional()),returnDocuments:r.serialization.property("return_documents",r.serialization.boolean().optional()),maxChunksPerDoc:r.serialization.property("max_chunks_per_doc",r.serialization.number().optional())}),Ms}var As={},xL;function zle(){if(xL)return As;xL=1;var a=As&&As.__createBinding||(Object.create?function(o,s,u,l){l===void 0&&(l=u);var c=Object.getOwnPropertyDescriptor(s,u);(!c||("get"in c?!s.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return s[u]}}),Object.defineProperty(o,l,c)}:function(o,s,u,l){l===void 0&&(l=u),o[l]=s[u]}),e=As&&As.__setModuleDefault||(Object.create?function(o,s){Object.defineProperty(o,"default",{enumerable:!0,value:s})}:function(o,s){o.default=s}),t=As&&As.__importStar||function(o){if(o&&o.__esModule)return o;var s={};if(o!=null)for(var u in o)u!=="default"&&Object.prototype.hasOwnProperty.call(o,u)&&a(s,o,u);return e(s,o),s};Object.defineProperty(As,"__esModule",{value:!0}),As.ClassifyRequest=void 0;const r=t($()),n=gH(),i=ik();return As.ClassifyRequest=r.serialization.object({inputs:r.serialization.list(r.serialization.string()),examples:r.serialization.list(n.ClassifyExample).optional(),model:r.serialization.string().optional(),preset:r.serialization.string().optional(),truncate:i.ClassifyRequestTruncate.optional()}),As}var Is={},$L;function Ble(){if($L)return Is;$L=1;var a=Is&&Is.__createBinding||(Object.create?function(s,u,l,c){c===void 0&&(c=l);var f=Object.getOwnPropertyDescriptor(u,l);(!f||("get"in f?!u.__esModule:f.writable||f.configurable))&&(f={enumerable:!0,get:function(){return u[l]}}),Object.defineProperty(s,c,f)}:function(s,u,l,c){c===void 0&&(c=l),s[c]=u[l]}),e=Is&&Is.__setModuleDefault||(Object.create?function(s,u){Object.defineProperty(s,"default",{enumerable:!0,value:u})}:function(s,u){s.default=u}),t=Is&&Is.__importStar||function(s){if(s&&s.__esModule)return s;var u={};if(s!=null)for(var l in s)l!=="default"&&Object.prototype.hasOwnProperty.call(s,l)&&a(u,s,l);return e(u,s),u};Object.defineProperty(Is,"__esModule",{value:!0}),Is.SummarizeRequest=void 0;const r=t($()),n=uk(),i=lk(),o=ck();return Is.SummarizeRequest=r.serialization.object({text:r.serialization.string(),length:n.SummarizeRequestLength.optional(),format:i.SummarizeRequestFormat.optional(),model:r.serialization.string().optional(),extractiveness:o.SummarizeRequestExtractiveness.optional(),temperature:r.serialization.number().optional(),additionalCommand:r.serialization.property("additional_command",r.serialization.string().optional())}),Is}var Ds={},NL;function Ule(){if(NL)return Ds;NL=1;var a=Ds&&Ds.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=Ds&&Ds.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=Ds&&Ds.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(Ds,"__esModule",{value:!0}),Ds.TokenizeRequest=void 0;const r=t($());return Ds.TokenizeRequest=r.serialization.object({text:r.serialization.string(),model:r.serialization.string()}),Ds}var xs={},qL;function Fle(){if(qL)return xs;qL=1;var a=xs&&xs.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(i,o);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(n,s,u)}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),e=xs&&xs.__setModuleDefault||(Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i}),t=xs&&xs.__importStar||function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&a(i,n,o);return e(i,n),i};Object.defineProperty(xs,"__esModule",{value:!0}),xs.DetokenizeRequest=void 0;const r=t($());return xs.DetokenizeRequest=r.serialization.object({tokens:r.serialization.list(r.serialization.number()),model:r.serialization.string()}),xs}var zL;function Lle(){return zL||(zL=1,function(a){Object.defineProperty(a,"__esModule",{value:!0}),a.DetokenizeRequest=a.TokenizeRequest=a.SummarizeRequest=a.ClassifyRequest=a.RerankRequest=a.EmbedRequest=a.GenerateRequest=a.GenerateStreamRequest=a.ChatRequest=a.ChatStreamRequest=void 0;var e=Ile();Object.defineProperty(a,"ChatStreamRequest",{enumerable:!0,get:function(){return e.ChatStreamRequest}});var t=Dle();Object.defineProperty(a,"ChatRequest",{enumerable:!0,get:function(){return t.ChatRequest}});var r=xle();Object.defineProperty(a,"GenerateStreamRequest",{enumerable:!0,get:function(){return r.GenerateStreamRequest}});var n=$le();Object.defineProperty(a,"GenerateRequest",{enumerable:!0,get:function(){return n.GenerateRequest}});var i=Nle();Object.defineProperty(a,"EmbedRequest",{enumerable:!0,get:function(){return i.EmbedRequest}});var o=qle();Object.defineProperty(a,"RerankRequest",{enumerable:!0,get:function(){return o.RerankRequest}});var s=zle();Object.defineProperty(a,"ClassifyRequest",{enumerable:!0,get:function(){return s.ClassifyRequest}});var u=Ble();Object.defineProperty(a,"SummarizeRequest",{enumerable:!0,get:function(){return u.SummarizeRequest}});var l=Ule();Object.defineProperty(a,"TokenizeRequest",{enumerable:!0,get:function(){return l.TokenizeRequest}});var c=Fle();Object.defineProperty(a,"DetokenizeRequest",{enumerable:!0,get:function(){return c.DetokenizeRequest}})}(lE)),lE}var BL;function Vle(){return BL||(BL=1,function(a){var e=hc&&hc.__createBinding||(Object.create?function(r,n,i,o){o===void 0&&(o=i);var s=Object.getOwnPropertyDescriptor(n,i);(!s||("get"in s?!n.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(r,o,s)}:function(r,n,i,o){o===void 0&&(o=i),r[o]=n[i]}),t=hc&&hc.__exportStar||function(r,n){for(var i in r)i!=="default"&&!Object.prototype.hasOwnProperty.call(n,i)&&e(n,r,i)};Object.defineProperty(a,"__esModule",{value:!0}),t(Lle(),a)}(hc)),hc}var UL;function al(){return UL||(UL=1,function(a){var e=Zl&&Zl.__createBinding||(Object.create?function(r,n,i,o){o===void 0&&(o=i);var s=Object.getOwnPropertyDescriptor(n,i);(!s||("get"in s?!n.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(r,o,s)}:function(r,n,i,o){o===void 0&&(o=i),r[o]=n[i]}),t=Zl&&Zl.__exportStar||function(r,n){for(var i in r)i!=="default"&&!Object.prototype.hasOwnProperty.call(n,i)&&e(n,r,i)};Object.defineProperty(a,"__esModule",{value:!0}),t(rle(),a),t(Ale(),a),t(Vle(),a)}(Zl)),Zl}var FL;function jH(){return FL||(FL=1,function(a){var e={},t=cr&&cr.__createBinding||(Object.create?function(C,T,M,K){K===void 0&&(K=M);var q=Object.getOwnPropertyDescriptor(T,M);(!q||("get"in q?!T.__esModule:q.writable||q.configurable))&&(q={enumerable:!0,get:function(){return T[M]}}),Object.defineProperty(C,K,q)}:function(C,T,M,K){K===void 0&&(K=M),C[K]=T[M]}),r=cr&&cr.__setModuleDefault||(Object.create?function(C,T){Object.defineProperty(C,"default",{enumerable:!0,value:T})}:function(C,T){C.default=T}),n=cr&&cr.__importStar||function(C){if(C&&C.__esModule)return C;var T={};if(C!=null)for(var M in C)M!=="default"&&Object.prototype.hasOwnProperty.call(C,M)&&t(T,C,M);return r(T,C),T},i=cr&&cr.__awaiter||function(C,T,M,K){function q(B){return B instanceof M?B:new M(function(H){H(B)})}return new(M||(M=Promise))(function(B,H){function Q(ee){try{F(K.next(ee))}catch(A){H(A)}}function se(ee){try{F(K.throw(ee))}catch(A){H(A)}}function F(ee){ee.done?B(ee.value):q(ee.value).then(Q,se)}F((K=K.apply(C,T||[])).next())})},o=cr&&cr.__asyncValues||function(C){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var T=C[Symbol.asyncIterator],M;return T?T.call(C):(C=typeof __values=="function"?__values(C):C[Symbol.iterator](),M={},K("next"),K("throw"),K("return"),M[Symbol.asyncIterator]=function(){return this},M);function K(B){M[B]=C[B]&&function(H){return new Promise(function(Q,se){H=C[B](H),q(Q,se,H.done,H.value)})}}function q(B,H,Q,se){Promise.resolve(se).then(function(F){B({value:F,done:Q})},H)}};Object.defineProperty(a,"__esModule",{value:!0}),a.fetchOverride=a.parseAWSEvent=a.getAuthHeaders=a.getUrl=a.mapResponseFromBedrock=void 0;const s=eie,u=lae,l=yae,c=Ioe,f=by(),p=$(),h=wG(),y=wue(),d=n(al()),_=(C,T)=>i(void 0,void 0,void 0,function*(){const M=Object.assign({},e);try{return C(),yield T()}finally{e=M}}),m={1:{chat:d.StreamedChatResponse,generate:d.GenerateStreamedResponse},2:{chat:d.StreamedChatResponseV2,generate:d.GenerateStreamedResponse}},b={1:{chat:d.NonStreamedChatResponse,embed:d.EmbedResponse,generate:d.Generation,rerank:d.RerankResponse},2:{chat:d.ChatResponse,embed:d.EmbedByTypeResponse,generate:d.Generation,rerank:d.V2RerankResponse}},g=(C,T,M,K)=>i(void 0,void 0,void 0,function*(){const q=C?m[M][T]:b[M][T],B={unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0,skipValidation:!0,breadcrumbsPrefix:["response"]},H=yield q.parseOrThrow(K,B);return q.jsonOrThrow(H,B)});a.mapResponseFromBedrock=g;const v=(C,T,M,K)=>{const q={bedrock:K?"invoke-with-response-stream":"invoke",sagemaker:K?"invocations-response-stream":"invocations"}[C];return{bedrock:`https://${C}-runtime.${T}.amazonaws.com/model/${M}/${q}`,sagemaker:`https://runtime.sagemaker.${T}.amazonaws.com/endpoints/${M}/${q}`}[C]};a.getUrl=v;const w=(C,T,M,K,q,B)=>i(void 0,void 0,void 0,function*(){const H=(0,u.fromNodeProviderChain)(),Q=yield _(()=>{B.awsAccessKey&&(e.AWS_ACCESS_KEY_ID=B.awsAccessKey),B.awsSecretKey&&(e.AWS_SECRET_ACCESS_KEY=B.awsSecretKey),B.awsSessionToken&&(e.AWS_SESSION_TOKEN=B.awsSessionToken)},()=>H()),se=new c.SignatureV4({service:q,region:B.awsRegion,credentials:Q,sha256:s.Sha256});delete M.connection,M.host=C.hostname;const F=new l.HttpRequest({method:T.toUpperCase(),protocol:C.protocol,path:C.pathname,headers:M,body:K});return(yield se.sign(F)).headers});a.getAuthHeaders=w;const S=C=>{const T=/{[^\}]*}/,M=C.match(T);if(M!=null&&M[0]){const K=JSON.parse(M[0]);if(K.bytes){const q=Buffer.from(K.bytes,"base64").toString("utf-8"),B=JSON.parse(q);if(B.event_type)return B}}};a.parseAWSEvent=S;const R=C=>({v1:1,v2:2})[C]||1,P=(C,{awsRegion:T,awsAccessKey:M,awsSecretKey:K,awsSessionToken:q})=>B=>i(void 0,void 0,void 0,function*(){var H,Q;const se=B.url.split("/"),F=se.pop(),ee=R(se.pop()),A=B.body;console.assert(A.model,"model is required");const J=!!A.stream,te=(0,a.getUrl)(C,T,A.model,J);F==="rerank"&&(A.api_version=ee),delete A.stream,delete A.model,delete B.headers.Authorization,B.headers.Host=new URL(te).hostname;const Z=yield(0,a.getAuthHeaders)(new URL(te),B.method,B.headers,JSON.stringify(A),C,{awsRegion:T,awsAccessKey:M,awsSecretKey:K,awsSessionToken:q});B.url=te,B.headers=Z;const he=yield(0,p.fetcher)(B);if(!he.ok)return he;try{if(J){const W=(0,h.readableStreamAsyncIterable)(he.body),U=new y.LineDecoder,N=new f.PassThrough;try{for(var ye=o(W),ve;ve=yield ye.next(),!ve.done;){const k=ve.value;for(const ie of U.decode(k)){const ue=(0,a.parseAWSEvent)(ie);if(ue){const z=yield(0,a.mapResponseFromBedrock)(J,F,ee,ue);N.push(JSON.stringify(z)+`
`)}}}}catch(k){H={error:k}}finally{try{ve&&!ve.done&&(Q=ye.return)&&(yield Q.call(ye))}finally{if(H)throw H.error}}for(const k of U.flush()){const ie=(0,a.parseAWSEvent)(k);if(ie){const ue=yield(0,a.mapResponseFromBedrock)(J,F,ee,ie);N.push(JSON.stringify(ue)+`
`)}}return N.end(),{ok:!0,body:N}}else{const W=yield he.body;return{ok:!0,body:yield(0,a.mapResponseFromBedrock)(J,F,ee,W)}}}catch(W){throw W}});a.fetchOverride=P}(cr)),cr}var $h={},Rt={},Nh={},LL;function ol(){return LL||(LL=1,Object.defineProperty(Nh,"__esModule",{value:!0}),Nh.CohereEnvironment=void 0,Nh.CohereEnvironment={Production:"https://api.cohere.com"}),Nh}var gy={exports:{}},Gle=gy.exports,VL;function Dc(){return VL||(VL=1,function(a){(function(e,t,r){a.exports?a.exports=r():t[e]=r()})("urljoin",Gle,function(){function e(t){var r=[];if(t.length===0)return"";if(typeof t[0]!="string")throw new TypeError("Url must be a string. Received "+t[0]);if(t[0].match(/^[^/:]+:\/*$/)&&t.length>1){var n=t.shift();t[0]=n+t[0]}t[0].match(/^file:\/\/\//)?t[0]=t[0].replace(/^([^/:]+):\/*/,"$1:///"):t[0]=t[0].replace(/^([^/:]+):\/*/,"$1://");for(var i=0;i<t.length;i++){var o=t[i];if(typeof o!="string")throw new TypeError("Url must be a string. Received "+o);o!==""&&(i>0&&(o=o.replace(/^[\/]+/,"")),i<t.length-1?o=o.replace(/[\/]+$/,""):o=o.replace(/[\/]+$/,"/"),r.push(o))}var s=r.join("/");s=s.replace(/\/(\?|&|#[^!])/g,"$1");var u=s.split("?");return s=u.shift()+(u.length>0?"?":"")+u.join("&"),s}return function(){var t;return typeof arguments[0]=="object"?t=arguments[0]:t=[].slice.call(arguments),e(t)}})}(gy)),gy.exports}var Lt={},GL;function TH(){if(GL)return Lt;GL=1;var a={},e=Lt&&Lt.__createBinding||(Object.create?function(h,y,d,_){_===void 0&&(_=d);var m=Object.getOwnPropertyDescriptor(y,d);(!m||("get"in m?!y.__esModule:m.writable||m.configurable))&&(m={enumerable:!0,get:function(){return y[d]}}),Object.defineProperty(h,_,m)}:function(h,y,d,_){_===void 0&&(_=d),h[_]=y[d]}),t=Lt&&Lt.__setModuleDefault||(Object.create?function(h,y){Object.defineProperty(h,"default",{enumerable:!0,value:y})}:function(h,y){h.default=y}),r=Lt&&Lt.__importStar||function(h){if(h&&h.__esModule)return h;var y={};if(h!=null)for(var d in h)d!=="default"&&Object.prototype.hasOwnProperty.call(h,d)&&e(y,h,d);return t(y,h),y},n=Lt&&Lt.__awaiter||function(h,y,d,_){function m(b){return b instanceof d?b:new d(function(g){g(b)})}return new(d||(d=Promise))(function(b,g){function v(R){try{S(_.next(R))}catch(P){g(P)}}function w(R){try{S(_.throw(R))}catch(P){g(P)}}function S(R){R.done?b(R.value):m(R.value).then(v,w)}S((_=_.apply(h,y||[])).next())})},i=Lt&&Lt.__importDefault||function(h){return h&&h.__esModule?h:{default:h}};Object.defineProperty(Lt,"__esModule",{value:!0}),Lt.V2=void 0;const o=r(ol()),s=r($()),u=r(tl()),l=r(al()),c=i(Dc()),f=r(dt());class p{constructor(y={}){this._options=y}chatStream(y,d){var _,m;return n(this,void 0,void 0,function*(){const b=yield((_=this._options.fetcher)!==null&&_!==void 0?_:s.fetcher)({url:(0,c.default)((m=yield s.Supplier.get(this._options.environment))!==null&&m!==void 0?m:o.CohereEnvironment.Production,"v2/chat"),method:"POST",headers:Object.assign({Authorization:yield this._getAuthorizationHeader(),"X-Client-Name":(yield s.Supplier.get(this._options.clientName))!=null?yield s.Supplier.get(this._options.clientName):void 0,"X-Fern-Language":"JavaScript","X-Fern-SDK-Name":"cohere-ai","X-Fern-SDK-Version":"7.16.0","User-Agent":"cohere-ai/7.16.0","X-Fern-Runtime":s.RUNTIME.type,"X-Fern-Runtime-Version":s.RUNTIME.version},d==null?void 0:d.headers),contentType:"application/json",requestType:"json",body:Object.assign(Object.assign({},l.V2ChatStreamRequest.jsonOrThrow(y,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0})),{stream:!0}),responseType:"sse",timeoutMs:(d==null?void 0:d.timeoutInSeconds)!=null?d.timeoutInSeconds*1e3:3e5,maxRetries:d==null?void 0:d.maxRetries,abortSignal:d==null?void 0:d.abortSignal});if(b.ok)return new s.Stream({stream:b.body,parse:g=>n(this,void 0,void 0,function*(){return l.StreamedChatResponseV2.parseOrThrow(g,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0,skipValidation:!0,breadcrumbsPrefix:["response"]})}),signal:d==null?void 0:d.abortSignal,eventShape:{type:"sse",streamTerminator:"[DONE]"}});if(b.error.reason==="status-code")switch(b.error.statusCode){case 400:throw new u.BadRequestError(b.error.body);case 401:throw new u.UnauthorizedError(b.error.body);case 403:throw new u.ForbiddenError(b.error.body);case 404:throw new u.NotFoundError(b.error.body);case 422:throw new u.UnprocessableEntityError(b.error.body);case 429:throw new u.TooManyRequestsError(b.error.body);case 498:throw new u.InvalidTokenError(b.error.body);case 499:throw new u.ClientClosedRequestError(b.error.body);case 500:throw new u.InternalServerError(b.error.body);case 501:throw new u.NotImplementedError(b.error.body);case 503:throw new u.ServiceUnavailableError(b.error.body);case 504:throw new u.GatewayTimeoutError(b.error.body);default:throw new f.CohereError({statusCode:b.error.statusCode,body:b.error.body})}switch(b.error.reason){case"non-json":throw new f.CohereError({statusCode:b.error.statusCode,body:b.error.rawBody});case"timeout":throw new f.CohereTimeoutError("Timeout exceeded when calling POST /v2/chat.");case"unknown":throw new f.CohereError({message:b.error.errorMessage})}})}chat(y,d){var _,m;return n(this,void 0,void 0,function*(){const b=yield((_=this._options.fetcher)!==null&&_!==void 0?_:s.fetcher)({url:(0,c.default)((m=yield s.Supplier.get(this._options.environment))!==null&&m!==void 0?m:o.CohereEnvironment.Production,"v2/chat"),method:"POST",headers:Object.assign({Authorization:yield this._getAuthorizationHeader(),"X-Client-Name":(yield s.Supplier.get(this._options.clientName))!=null?yield s.Supplier.get(this._options.clientName):void 0,"X-Fern-Language":"JavaScript","X-Fern-SDK-Name":"cohere-ai","X-Fern-SDK-Version":"7.16.0","User-Agent":"cohere-ai/7.16.0","X-Fern-Runtime":s.RUNTIME.type,"X-Fern-Runtime-Version":s.RUNTIME.version},d==null?void 0:d.headers),contentType:"application/json",requestType:"json",body:Object.assign(Object.assign({},l.V2ChatRequest.jsonOrThrow(y,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0})),{stream:!1}),timeoutMs:(d==null?void 0:d.timeoutInSeconds)!=null?d.timeoutInSeconds*1e3:3e5,maxRetries:d==null?void 0:d.maxRetries,abortSignal:d==null?void 0:d.abortSignal});if(b.ok)return l.ChatResponse.parseOrThrow(b.body,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0,skipValidation:!0,breadcrumbsPrefix:["response"]});if(b.error.reason==="status-code")switch(b.error.statusCode){case 400:throw new u.BadRequestError(b.error.body);case 401:throw new u.UnauthorizedError(b.error.body);case 403:throw new u.ForbiddenError(b.error.body);case 404:throw new u.NotFoundError(b.error.body);case 422:throw new u.UnprocessableEntityError(b.error.body);case 429:throw new u.TooManyRequestsError(b.error.body);case 498:throw new u.InvalidTokenError(b.error.body);case 499:throw new u.ClientClosedRequestError(b.error.body);case 500:throw new u.InternalServerError(b.error.body);case 501:throw new u.NotImplementedError(b.error.body);case 503:throw new u.ServiceUnavailableError(b.error.body);case 504:throw new u.GatewayTimeoutError(b.error.body);default:throw new f.CohereError({statusCode:b.error.statusCode,body:b.error.body})}switch(b.error.reason){case"non-json":throw new f.CohereError({statusCode:b.error.statusCode,body:b.error.rawBody});case"timeout":throw new f.CohereTimeoutError("Timeout exceeded when calling POST /v2/chat.");case"unknown":throw new f.CohereError({message:b.error.errorMessage})}})}embed(y,d){var _,m;return n(this,void 0,void 0,function*(){const b=yield((_=this._options.fetcher)!==null&&_!==void 0?_:s.fetcher)({url:(0,c.default)((m=yield s.Supplier.get(this._options.environment))!==null&&m!==void 0?m:o.CohereEnvironment.Production,"v2/embed"),method:"POST",headers:Object.assign({Authorization:yield this._getAuthorizationHeader(),"X-Client-Name":(yield s.Supplier.get(this._options.clientName))!=null?yield s.Supplier.get(this._options.clientName):void 0,"X-Fern-Language":"JavaScript","X-Fern-SDK-Name":"cohere-ai","X-Fern-SDK-Version":"7.16.0","User-Agent":"cohere-ai/7.16.0","X-Fern-Runtime":s.RUNTIME.type,"X-Fern-Runtime-Version":s.RUNTIME.version},d==null?void 0:d.headers),contentType:"application/json",requestType:"json",body:l.V2EmbedRequest.jsonOrThrow(y,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0}),timeoutMs:(d==null?void 0:d.timeoutInSeconds)!=null?d.timeoutInSeconds*1e3:3e5,maxRetries:d==null?void 0:d.maxRetries,abortSignal:d==null?void 0:d.abortSignal});if(b.ok)return l.EmbedByTypeResponse.parseOrThrow(b.body,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0,skipValidation:!0,breadcrumbsPrefix:["response"]});if(b.error.reason==="status-code")switch(b.error.statusCode){case 400:throw new u.BadRequestError(b.error.body);case 401:throw new u.UnauthorizedError(b.error.body);case 403:throw new u.ForbiddenError(b.error.body);case 404:throw new u.NotFoundError(b.error.body);case 422:throw new u.UnprocessableEntityError(b.error.body);case 429:throw new u.TooManyRequestsError(b.error.body);case 498:throw new u.InvalidTokenError(b.error.body);case 499:throw new u.ClientClosedRequestError(b.error.body);case 500:throw new u.InternalServerError(b.error.body);case 501:throw new u.NotImplementedError(b.error.body);case 503:throw new u.ServiceUnavailableError(b.error.body);case 504:throw new u.GatewayTimeoutError(b.error.body);default:throw new f.CohereError({statusCode:b.error.statusCode,body:b.error.body})}switch(b.error.reason){case"non-json":throw new f.CohereError({statusCode:b.error.statusCode,body:b.error.rawBody});case"timeout":throw new f.CohereTimeoutError("Timeout exceeded when calling POST /v2/embed.");case"unknown":throw new f.CohereError({message:b.error.errorMessage})}})}rerank(y,d){var _,m;return n(this,void 0,void 0,function*(){const b=yield((_=this._options.fetcher)!==null&&_!==void 0?_:s.fetcher)({url:(0,c.default)((m=yield s.Supplier.get(this._options.environment))!==null&&m!==void 0?m:o.CohereEnvironment.Production,"v2/rerank"),method:"POST",headers:Object.assign({Authorization:yield this._getAuthorizationHeader(),"X-Client-Name":(yield s.Supplier.get(this._options.clientName))!=null?yield s.Supplier.get(this._options.clientName):void 0,"X-Fern-Language":"JavaScript","X-Fern-SDK-Name":"cohere-ai","X-Fern-SDK-Version":"7.16.0","User-Agent":"cohere-ai/7.16.0","X-Fern-Runtime":s.RUNTIME.type,"X-Fern-Runtime-Version":s.RUNTIME.version},d==null?void 0:d.headers),contentType:"application/json",requestType:"json",body:l.V2RerankRequest.jsonOrThrow(y,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0}),timeoutMs:(d==null?void 0:d.timeoutInSeconds)!=null?d.timeoutInSeconds*1e3:3e5,maxRetries:d==null?void 0:d.maxRetries,abortSignal:d==null?void 0:d.abortSignal});if(b.ok)return l.V2RerankResponse.parseOrThrow(b.body,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0,skipValidation:!0,breadcrumbsPrefix:["response"]});if(b.error.reason==="status-code")switch(b.error.statusCode){case 400:throw new u.BadRequestError(b.error.body);case 401:throw new u.UnauthorizedError(b.error.body);case 403:throw new u.ForbiddenError(b.error.body);case 404:throw new u.NotFoundError(b.error.body);case 422:throw new u.UnprocessableEntityError(b.error.body);case 429:throw new u.TooManyRequestsError(b.error.body);case 498:throw new u.InvalidTokenError(b.error.body);case 499:throw new u.ClientClosedRequestError(b.error.body);case 500:throw new u.InternalServerError(b.error.body);case 501:throw new u.NotImplementedError(b.error.body);case 503:throw new u.ServiceUnavailableError(b.error.body);case 504:throw new u.GatewayTimeoutError(b.error.body);default:throw new f.CohereError({statusCode:b.error.statusCode,body:b.error.body})}switch(b.error.reason){case"non-json":throw new f.CohereError({statusCode:b.error.statusCode,body:b.error.rawBody});case"timeout":throw new f.CohereTimeoutError("Timeout exceeded when calling POST /v2/rerank.");case"unknown":throw new f.CohereError({message:b.error.errorMessage})}})}_getAuthorizationHeader(){var y;return n(this,void 0,void 0,function*(){const d=(y=yield s.Supplier.get(this._options.token))!==null&&y!==void 0?y:process==null?void 0:a.CO_API_KEY;if(d==null)throw new f.CohereError({message:"Please specify CO_API_KEY when instantiating the client."});return`Bearer ${d}`})}}return Lt.V2=p,Lt}var Vt={},kL;function kle(){if(kL)return Vt;kL=1;var a={},e=Vt&&Vt.__createBinding||(Object.create?function(h,y,d,_){_===void 0&&(_=d);var m=Object.getOwnPropertyDescriptor(y,d);(!m||("get"in m?!y.__esModule:m.writable||m.configurable))&&(m={enumerable:!0,get:function(){return y[d]}}),Object.defineProperty(h,_,m)}:function(h,y,d,_){_===void 0&&(_=d),h[_]=y[d]}),t=Vt&&Vt.__setModuleDefault||(Object.create?function(h,y){Object.defineProperty(h,"default",{enumerable:!0,value:y})}:function(h,y){h.default=y}),r=Vt&&Vt.__importStar||function(h){if(h&&h.__esModule)return h;var y={};if(h!=null)for(var d in h)d!=="default"&&Object.prototype.hasOwnProperty.call(h,d)&&e(y,h,d);return t(y,h),y},n=Vt&&Vt.__awaiter||function(h,y,d,_){function m(b){return b instanceof d?b:new d(function(g){g(b)})}return new(d||(d=Promise))(function(b,g){function v(R){try{S(_.next(R))}catch(P){g(P)}}function w(R){try{S(_.throw(R))}catch(P){g(P)}}function S(R){R.done?b(R.value):m(R.value).then(v,w)}S((_=_.apply(h,y||[])).next())})},i=Vt&&Vt.__importDefault||function(h){return h&&h.__esModule?h:{default:h}};Object.defineProperty(Vt,"__esModule",{value:!0}),Vt.EmbedJobs=void 0;const o=r(ol()),s=r($()),u=r(tl()),l=i(Dc()),c=r(al()),f=r(dt());class p{constructor(y={}){this._options=y}list(y){var d,_;return n(this,void 0,void 0,function*(){const m=yield((d=this._options.fetcher)!==null&&d!==void 0?d:s.fetcher)({url:(0,l.default)((_=yield s.Supplier.get(this._options.environment))!==null&&_!==void 0?_:o.CohereEnvironment.Production,"v1/embed-jobs"),method:"GET",headers:Object.assign({Authorization:yield this._getAuthorizationHeader(),"X-Client-Name":(yield s.Supplier.get(this._options.clientName))!=null?yield s.Supplier.get(this._options.clientName):void 0,"X-Fern-Language":"JavaScript","X-Fern-SDK-Name":"cohere-ai","X-Fern-SDK-Version":"7.16.0","User-Agent":"cohere-ai/7.16.0","X-Fern-Runtime":s.RUNTIME.type,"X-Fern-Runtime-Version":s.RUNTIME.version},y==null?void 0:y.headers),contentType:"application/json",requestType:"json",timeoutMs:(y==null?void 0:y.timeoutInSeconds)!=null?y.timeoutInSeconds*1e3:3e5,maxRetries:y==null?void 0:y.maxRetries,abortSignal:y==null?void 0:y.abortSignal});if(m.ok)return c.ListEmbedJobResponse.parseOrThrow(m.body,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0,skipValidation:!0,breadcrumbsPrefix:["response"]});if(m.error.reason==="status-code")switch(m.error.statusCode){case 400:throw new u.BadRequestError(m.error.body);case 401:throw new u.UnauthorizedError(m.error.body);case 403:throw new u.ForbiddenError(m.error.body);case 404:throw new u.NotFoundError(m.error.body);case 422:throw new u.UnprocessableEntityError(m.error.body);case 429:throw new u.TooManyRequestsError(m.error.body);case 498:throw new u.InvalidTokenError(m.error.body);case 499:throw new u.ClientClosedRequestError(m.error.body);case 500:throw new u.InternalServerError(m.error.body);case 501:throw new u.NotImplementedError(m.error.body);case 503:throw new u.ServiceUnavailableError(m.error.body);case 504:throw new u.GatewayTimeoutError(m.error.body);default:throw new f.CohereError({statusCode:m.error.statusCode,body:m.error.body})}switch(m.error.reason){case"non-json":throw new f.CohereError({statusCode:m.error.statusCode,body:m.error.rawBody});case"timeout":throw new f.CohereTimeoutError("Timeout exceeded when calling GET /v1/embed-jobs.");case"unknown":throw new f.CohereError({message:m.error.errorMessage})}})}create(y,d){var _,m;return n(this,void 0,void 0,function*(){const b=yield((_=this._options.fetcher)!==null&&_!==void 0?_:s.fetcher)({url:(0,l.default)((m=yield s.Supplier.get(this._options.environment))!==null&&m!==void 0?m:o.CohereEnvironment.Production,"v1/embed-jobs"),method:"POST",headers:Object.assign({Authorization:yield this._getAuthorizationHeader(),"X-Client-Name":(yield s.Supplier.get(this._options.clientName))!=null?yield s.Supplier.get(this._options.clientName):void 0,"X-Fern-Language":"JavaScript","X-Fern-SDK-Name":"cohere-ai","X-Fern-SDK-Version":"7.16.0","User-Agent":"cohere-ai/7.16.0","X-Fern-Runtime":s.RUNTIME.type,"X-Fern-Runtime-Version":s.RUNTIME.version},d==null?void 0:d.headers),contentType:"application/json",requestType:"json",body:c.CreateEmbedJobRequest.jsonOrThrow(y,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0}),timeoutMs:(d==null?void 0:d.timeoutInSeconds)!=null?d.timeoutInSeconds*1e3:3e5,maxRetries:d==null?void 0:d.maxRetries,abortSignal:d==null?void 0:d.abortSignal});if(b.ok)return c.CreateEmbedJobResponse.parseOrThrow(b.body,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0,skipValidation:!0,breadcrumbsPrefix:["response"]});if(b.error.reason==="status-code")switch(b.error.statusCode){case 400:throw new u.BadRequestError(b.error.body);case 401:throw new u.UnauthorizedError(b.error.body);case 403:throw new u.ForbiddenError(b.error.body);case 404:throw new u.NotFoundError(b.error.body);case 422:throw new u.UnprocessableEntityError(b.error.body);case 429:throw new u.TooManyRequestsError(b.error.body);case 498:throw new u.InvalidTokenError(b.error.body);case 499:throw new u.ClientClosedRequestError(b.error.body);case 500:throw new u.InternalServerError(b.error.body);case 501:throw new u.NotImplementedError(b.error.body);case 503:throw new u.ServiceUnavailableError(b.error.body);case 504:throw new u.GatewayTimeoutError(b.error.body);default:throw new f.CohereError({statusCode:b.error.statusCode,body:b.error.body})}switch(b.error.reason){case"non-json":throw new f.CohereError({statusCode:b.error.statusCode,body:b.error.rawBody});case"timeout":throw new f.CohereTimeoutError("Timeout exceeded when calling POST /v1/embed-jobs.");case"unknown":throw new f.CohereError({message:b.error.errorMessage})}})}get(y,d){var _,m;return n(this,void 0,void 0,function*(){const b=yield((_=this._options.fetcher)!==null&&_!==void 0?_:s.fetcher)({url:(0,l.default)((m=yield s.Supplier.get(this._options.environment))!==null&&m!==void 0?m:o.CohereEnvironment.Production,`v1/embed-jobs/${encodeURIComponent(y)}`),method:"GET",headers:Object.assign({Authorization:yield this._getAuthorizationHeader(),"X-Client-Name":(yield s.Supplier.get(this._options.clientName))!=null?yield s.Supplier.get(this._options.clientName):void 0,"X-Fern-Language":"JavaScript","X-Fern-SDK-Name":"cohere-ai","X-Fern-SDK-Version":"7.16.0","User-Agent":"cohere-ai/7.16.0","X-Fern-Runtime":s.RUNTIME.type,"X-Fern-Runtime-Version":s.RUNTIME.version},d==null?void 0:d.headers),contentType:"application/json",requestType:"json",timeoutMs:(d==null?void 0:d.timeoutInSeconds)!=null?d.timeoutInSeconds*1e3:3e5,maxRetries:d==null?void 0:d.maxRetries,abortSignal:d==null?void 0:d.abortSignal});if(b.ok)return c.EmbedJob.parseOrThrow(b.body,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0,skipValidation:!0,breadcrumbsPrefix:["response"]});if(b.error.reason==="status-code")switch(b.error.statusCode){case 400:throw new u.BadRequestError(b.error.body);case 401:throw new u.UnauthorizedError(b.error.body);case 403:throw new u.ForbiddenError(b.error.body);case 404:throw new u.NotFoundError(b.error.body);case 422:throw new u.UnprocessableEntityError(b.error.body);case 429:throw new u.TooManyRequestsError(b.error.body);case 498:throw new u.InvalidTokenError(b.error.body);case 499:throw new u.ClientClosedRequestError(b.error.body);case 500:throw new u.InternalServerError(b.error.body);case 501:throw new u.NotImplementedError(b.error.body);case 503:throw new u.ServiceUnavailableError(b.error.body);case 504:throw new u.GatewayTimeoutError(b.error.body);default:throw new f.CohereError({statusCode:b.error.statusCode,body:b.error.body})}switch(b.error.reason){case"non-json":throw new f.CohereError({statusCode:b.error.statusCode,body:b.error.rawBody});case"timeout":throw new f.CohereTimeoutError("Timeout exceeded when calling GET /v1/embed-jobs/{id}.");case"unknown":throw new f.CohereError({message:b.error.errorMessage})}})}cancel(y,d){var _,m;return n(this,void 0,void 0,function*(){const b=yield((_=this._options.fetcher)!==null&&_!==void 0?_:s.fetcher)({url:(0,l.default)((m=yield s.Supplier.get(this._options.environment))!==null&&m!==void 0?m:o.CohereEnvironment.Production,`v1/embed-jobs/${encodeURIComponent(y)}/cancel`),method:"POST",headers:Object.assign({Authorization:yield this._getAuthorizationHeader(),"X-Client-Name":(yield s.Supplier.get(this._options.clientName))!=null?yield s.Supplier.get(this._options.clientName):void 0,"X-Fern-Language":"JavaScript","X-Fern-SDK-Name":"cohere-ai","X-Fern-SDK-Version":"7.16.0","User-Agent":"cohere-ai/7.16.0","X-Fern-Runtime":s.RUNTIME.type,"X-Fern-Runtime-Version":s.RUNTIME.version},d==null?void 0:d.headers),contentType:"application/json",requestType:"json",timeoutMs:(d==null?void 0:d.timeoutInSeconds)!=null?d.timeoutInSeconds*1e3:3e5,maxRetries:d==null?void 0:d.maxRetries,abortSignal:d==null?void 0:d.abortSignal});if(!b.ok){if(b.error.reason==="status-code")switch(b.error.statusCode){case 400:throw new u.BadRequestError(b.error.body);case 401:throw new u.UnauthorizedError(b.error.body);case 403:throw new u.ForbiddenError(b.error.body);case 404:throw new u.NotFoundError(b.error.body);case 422:throw new u.UnprocessableEntityError(b.error.body);case 429:throw new u.TooManyRequestsError(b.error.body);case 498:throw new u.InvalidTokenError(b.error.body);case 499:throw new u.ClientClosedRequestError(b.error.body);case 500:throw new u.InternalServerError(b.error.body);case 501:throw new u.NotImplementedError(b.error.body);case 503:throw new u.ServiceUnavailableError(b.error.body);case 504:throw new u.GatewayTimeoutError(b.error.body);default:throw new f.CohereError({statusCode:b.error.statusCode,body:b.error.body})}switch(b.error.reason){case"non-json":throw new f.CohereError({statusCode:b.error.statusCode,body:b.error.rawBody});case"timeout":throw new f.CohereTimeoutError("Timeout exceeded when calling POST /v1/embed-jobs/{id}/cancel.");case"unknown":throw new f.CohereError({message:b.error.errorMessage})}}})}_getAuthorizationHeader(){var y;return n(this,void 0,void 0,function*(){const d=(y=yield s.Supplier.get(this._options.token))!==null&&y!==void 0?y:process==null?void 0:a.CO_API_KEY;if(d==null)throw new f.CohereError({message:"Please specify CO_API_KEY when instantiating the client."});return`Bearer ${d}`})}}return Vt.EmbedJobs=p,Vt}var Gt={},HL;function Hle(){if(HL)return Gt;HL=1;var a={},e=Gt&&Gt.__createBinding||(Object.create?function(h,y,d,_){_===void 0&&(_=d);var m=Object.getOwnPropertyDescriptor(y,d);(!m||("get"in m?!y.__esModule:m.writable||m.configurable))&&(m={enumerable:!0,get:function(){return y[d]}}),Object.defineProperty(h,_,m)}:function(h,y,d,_){_===void 0&&(_=d),h[_]=y[d]}),t=Gt&&Gt.__setModuleDefault||(Object.create?function(h,y){Object.defineProperty(h,"default",{enumerable:!0,value:y})}:function(h,y){h.default=y}),r=Gt&&Gt.__importStar||function(h){if(h&&h.__esModule)return h;var y={};if(h!=null)for(var d in h)d!=="default"&&Object.prototype.hasOwnProperty.call(h,d)&&e(y,h,d);return t(y,h),y},n=Gt&&Gt.__awaiter||function(h,y,d,_){function m(b){return b instanceof d?b:new d(function(g){g(b)})}return new(d||(d=Promise))(function(b,g){function v(R){try{S(_.next(R))}catch(P){g(P)}}function w(R){try{S(_.throw(R))}catch(P){g(P)}}function S(R){R.done?b(R.value):m(R.value).then(v,w)}S((_=_.apply(h,y||[])).next())})},i=Gt&&Gt.__importDefault||function(h){return h&&h.__esModule?h:{default:h}};Object.defineProperty(Gt,"__esModule",{value:!0}),Gt.Datasets=void 0;const o=r(ol()),s=r($()),u=r(tl()),l=i(Dc()),c=r(al()),f=r(dt());class p{constructor(y={}){this._options=y}list(y={},d){var _,m;return n(this,void 0,void 0,function*(){const{datasetType:b,before:g,after:v,limit:w,offset:S,validationStatus:R}=y,P={};b!=null&&(P.datasetType=b),g!=null&&(P.before=g.toISOString()),v!=null&&(P.after=v.toISOString()),w!=null&&(P.limit=w.toString()),S!=null&&(P.offset=S.toString()),R!=null&&(P.validationStatus=R);const C=yield((_=this._options.fetcher)!==null&&_!==void 0?_:s.fetcher)({url:(0,l.default)((m=yield s.Supplier.get(this._options.environment))!==null&&m!==void 0?m:o.CohereEnvironment.Production,"v1/datasets"),method:"GET",headers:Object.assign({Authorization:yield this._getAuthorizationHeader(),"X-Client-Name":(yield s.Supplier.get(this._options.clientName))!=null?yield s.Supplier.get(this._options.clientName):void 0,"X-Fern-Language":"JavaScript","X-Fern-SDK-Name":"cohere-ai","X-Fern-SDK-Version":"7.16.0","User-Agent":"cohere-ai/7.16.0","X-Fern-Runtime":s.RUNTIME.type,"X-Fern-Runtime-Version":s.RUNTIME.version},d==null?void 0:d.headers),contentType:"application/json",queryParameters:P,requestType:"json",timeoutMs:(d==null?void 0:d.timeoutInSeconds)!=null?d.timeoutInSeconds*1e3:3e5,maxRetries:d==null?void 0:d.maxRetries,abortSignal:d==null?void 0:d.abortSignal});if(C.ok)return c.DatasetsListResponse.parseOrThrow(C.body,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0,skipValidation:!0,breadcrumbsPrefix:["response"]});if(C.error.reason==="status-code")switch(C.error.statusCode){case 400:throw new u.BadRequestError(C.error.body);case 401:throw new u.UnauthorizedError(C.error.body);case 403:throw new u.ForbiddenError(C.error.body);case 404:throw new u.NotFoundError(C.error.body);case 422:throw new u.UnprocessableEntityError(C.error.body);case 429:throw new u.TooManyRequestsError(C.error.body);case 498:throw new u.InvalidTokenError(C.error.body);case 499:throw new u.ClientClosedRequestError(C.error.body);case 500:throw new u.InternalServerError(C.error.body);case 501:throw new u.NotImplementedError(C.error.body);case 503:throw new u.ServiceUnavailableError(C.error.body);case 504:throw new u.GatewayTimeoutError(C.error.body);default:throw new f.CohereError({statusCode:C.error.statusCode,body:C.error.body})}switch(C.error.reason){case"non-json":throw new f.CohereError({statusCode:C.error.statusCode,body:C.error.rawBody});case"timeout":throw new f.CohereTimeoutError("Timeout exceeded when calling GET /v1/datasets.");case"unknown":throw new f.CohereError({message:C.error.errorMessage})}})}create(y,d,_,m){var b,g;return n(this,void 0,void 0,function*(){const v={};v.name=_.name,v.type=_.type,_.keepOriginalFile!=null&&(v.keep_original_file=_.keepOriginalFile.toString()),_.skipMalformedInput!=null&&(v.skip_malformed_input=_.skipMalformedInput.toString()),_.keepFields!=null&&(Array.isArray(_.keepFields)?v.keep_fields=_.keepFields.map(P=>P):v.keep_fields=_.keepFields),_.optionalFields!=null&&(Array.isArray(_.optionalFields)?v.optional_fields=_.optionalFields.map(P=>P):v.optional_fields=_.optionalFields),_.textSeparator!=null&&(v.text_separator=_.textSeparator),_.csvDelimiter!=null&&(v.csv_delimiter=_.csvDelimiter),_.dryRun!=null&&(v.dry_run=_.dryRun.toString());const w=yield s.newFormData();yield w.appendFile("data",y),d!=null&&(yield w.appendFile("eval_data",d));const S=yield w.getRequest(),R=yield((b=this._options.fetcher)!==null&&b!==void 0?b:s.fetcher)({url:(0,l.default)((g=yield s.Supplier.get(this._options.environment))!==null&&g!==void 0?g:o.CohereEnvironment.Production,"v1/datasets"),method:"POST",headers:Object.assign(Object.assign({Authorization:yield this._getAuthorizationHeader(),"X-Client-Name":(yield s.Supplier.get(this._options.clientName))!=null?yield s.Supplier.get(this._options.clientName):void 0,"X-Fern-Language":"JavaScript","X-Fern-SDK-Name":"cohere-ai","X-Fern-SDK-Version":"7.16.0","User-Agent":"cohere-ai/7.16.0","X-Fern-Runtime":s.RUNTIME.type,"X-Fern-Runtime-Version":s.RUNTIME.version},S.headers),m==null?void 0:m.headers),queryParameters:v,requestType:"file",duplex:S.duplex,body:S.body,timeoutMs:(m==null?void 0:m.timeoutInSeconds)!=null?m.timeoutInSeconds*1e3:3e5,maxRetries:m==null?void 0:m.maxRetries,abortSignal:m==null?void 0:m.abortSignal});if(R.ok)return c.DatasetsCreateResponse.parseOrThrow(R.body,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0,skipValidation:!0,breadcrumbsPrefix:["response"]});if(R.error.reason==="status-code")switch(R.error.statusCode){case 400:throw new u.BadRequestError(R.error.body);case 401:throw new u.UnauthorizedError(R.error.body);case 403:throw new u.ForbiddenError(R.error.body);case 404:throw new u.NotFoundError(R.error.body);case 422:throw new u.UnprocessableEntityError(R.error.body);case 429:throw new u.TooManyRequestsError(R.error.body);case 498:throw new u.InvalidTokenError(R.error.body);case 499:throw new u.ClientClosedRequestError(R.error.body);case 500:throw new u.InternalServerError(R.error.body);case 501:throw new u.NotImplementedError(R.error.body);case 503:throw new u.ServiceUnavailableError(R.error.body);case 504:throw new u.GatewayTimeoutError(R.error.body);default:throw new f.CohereError({statusCode:R.error.statusCode,body:R.error.body})}switch(R.error.reason){case"non-json":throw new f.CohereError({statusCode:R.error.statusCode,body:R.error.rawBody});case"timeout":throw new f.CohereTimeoutError("Timeout exceeded when calling POST /v1/datasets.");case"unknown":throw new f.CohereError({message:R.error.errorMessage})}})}getUsage(y){var d,_;return n(this,void 0,void 0,function*(){const m=yield((d=this._options.fetcher)!==null&&d!==void 0?d:s.fetcher)({url:(0,l.default)((_=yield s.Supplier.get(this._options.environment))!==null&&_!==void 0?_:o.CohereEnvironment.Production,"v1/datasets/usage"),method:"GET",headers:Object.assign({Authorization:yield this._getAuthorizationHeader(),"X-Client-Name":(yield s.Supplier.get(this._options.clientName))!=null?yield s.Supplier.get(this._options.clientName):void 0,"X-Fern-Language":"JavaScript","X-Fern-SDK-Name":"cohere-ai","X-Fern-SDK-Version":"7.16.0","User-Agent":"cohere-ai/7.16.0","X-Fern-Runtime":s.RUNTIME.type,"X-Fern-Runtime-Version":s.RUNTIME.version},y==null?void 0:y.headers),contentType:"application/json",requestType:"json",timeoutMs:(y==null?void 0:y.timeoutInSeconds)!=null?y.timeoutInSeconds*1e3:3e5,maxRetries:y==null?void 0:y.maxRetries,abortSignal:y==null?void 0:y.abortSignal});if(m.ok)return c.DatasetsGetUsageResponse.parseOrThrow(m.body,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0,skipValidation:!0,breadcrumbsPrefix:["response"]});if(m.error.reason==="status-code")switch(m.error.statusCode){case 400:throw new u.BadRequestError(m.error.body);case 401:throw new u.UnauthorizedError(m.error.body);case 403:throw new u.ForbiddenError(m.error.body);case 404:throw new u.NotFoundError(m.error.body);case 422:throw new u.UnprocessableEntityError(m.error.body);case 429:throw new u.TooManyRequestsError(m.error.body);case 498:throw new u.InvalidTokenError(m.error.body);case 499:throw new u.ClientClosedRequestError(m.error.body);case 500:throw new u.InternalServerError(m.error.body);case 501:throw new u.NotImplementedError(m.error.body);case 503:throw new u.ServiceUnavailableError(m.error.body);case 504:throw new u.GatewayTimeoutError(m.error.body);default:throw new f.CohereError({statusCode:m.error.statusCode,body:m.error.body})}switch(m.error.reason){case"non-json":throw new f.CohereError({statusCode:m.error.statusCode,body:m.error.rawBody});case"timeout":throw new f.CohereTimeoutError("Timeout exceeded when calling GET /v1/datasets/usage.");case"unknown":throw new f.CohereError({message:m.error.errorMessage})}})}get(y,d){var _,m;return n(this,void 0,void 0,function*(){const b=yield((_=this._options.fetcher)!==null&&_!==void 0?_:s.fetcher)({url:(0,l.default)((m=yield s.Supplier.get(this._options.environment))!==null&&m!==void 0?m:o.CohereEnvironment.Production,`v1/datasets/${encodeURIComponent(y)}`),method:"GET",headers:Object.assign({Authorization:yield this._getAuthorizationHeader(),"X-Client-Name":(yield s.Supplier.get(this._options.clientName))!=null?yield s.Supplier.get(this._options.clientName):void 0,"X-Fern-Language":"JavaScript","X-Fern-SDK-Name":"cohere-ai","X-Fern-SDK-Version":"7.16.0","User-Agent":"cohere-ai/7.16.0","X-Fern-Runtime":s.RUNTIME.type,"X-Fern-Runtime-Version":s.RUNTIME.version},d==null?void 0:d.headers),contentType:"application/json",requestType:"json",timeoutMs:(d==null?void 0:d.timeoutInSeconds)!=null?d.timeoutInSeconds*1e3:3e5,maxRetries:d==null?void 0:d.maxRetries,abortSignal:d==null?void 0:d.abortSignal});if(b.ok)return c.DatasetsGetResponse.parseOrThrow(b.body,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0,skipValidation:!0,breadcrumbsPrefix:["response"]});if(b.error.reason==="status-code")switch(b.error.statusCode){case 400:throw new u.BadRequestError(b.error.body);case 401:throw new u.UnauthorizedError(b.error.body);case 403:throw new u.ForbiddenError(b.error.body);case 404:throw new u.NotFoundError(b.error.body);case 422:throw new u.UnprocessableEntityError(b.error.body);case 429:throw new u.TooManyRequestsError(b.error.body);case 498:throw new u.InvalidTokenError(b.error.body);case 499:throw new u.ClientClosedRequestError(b.error.body);case 500:throw new u.InternalServerError(b.error.body);case 501:throw new u.NotImplementedError(b.error.body);case 503:throw new u.ServiceUnavailableError(b.error.body);case 504:throw new u.GatewayTimeoutError(b.error.body);default:throw new f.CohereError({statusCode:b.error.statusCode,body:b.error.body})}switch(b.error.reason){case"non-json":throw new f.CohereError({statusCode:b.error.statusCode,body:b.error.rawBody});case"timeout":throw new f.CohereTimeoutError("Timeout exceeded when calling GET /v1/datasets/{id}.");case"unknown":throw new f.CohereError({message:b.error.errorMessage})}})}delete(y,d){var _,m;return n(this,void 0,void 0,function*(){const b=yield((_=this._options.fetcher)!==null&&_!==void 0?_:s.fetcher)({url:(0,l.default)((m=yield s.Supplier.get(this._options.environment))!==null&&m!==void 0?m:o.CohereEnvironment.Production,`v1/datasets/${encodeURIComponent(y)}`),method:"DELETE",headers:Object.assign({Authorization:yield this._getAuthorizationHeader(),"X-Client-Name":(yield s.Supplier.get(this._options.clientName))!=null?yield s.Supplier.get(this._options.clientName):void 0,"X-Fern-Language":"JavaScript","X-Fern-SDK-Name":"cohere-ai","X-Fern-SDK-Version":"7.16.0","User-Agent":"cohere-ai/7.16.0","X-Fern-Runtime":s.RUNTIME.type,"X-Fern-Runtime-Version":s.RUNTIME.version},d==null?void 0:d.headers),contentType:"application/json",requestType:"json",timeoutMs:(d==null?void 0:d.timeoutInSeconds)!=null?d.timeoutInSeconds*1e3:3e5,maxRetries:d==null?void 0:d.maxRetries,abortSignal:d==null?void 0:d.abortSignal});if(b.ok)return c.datasets.delete.Response.parseOrThrow(b.body,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0,skipValidation:!0,breadcrumbsPrefix:["response"]});if(b.error.reason==="status-code")switch(b.error.statusCode){case 400:throw new u.BadRequestError(b.error.body);case 401:throw new u.UnauthorizedError(b.error.body);case 403:throw new u.ForbiddenError(b.error.body);case 404:throw new u.NotFoundError(b.error.body);case 422:throw new u.UnprocessableEntityError(b.error.body);case 429:throw new u.TooManyRequestsError(b.error.body);case 498:throw new u.InvalidTokenError(b.error.body);case 499:throw new u.ClientClosedRequestError(b.error.body);case 500:throw new u.InternalServerError(b.error.body);case 501:throw new u.NotImplementedError(b.error.body);case 503:throw new u.ServiceUnavailableError(b.error.body);case 504:throw new u.GatewayTimeoutError(b.error.body);default:throw new f.CohereError({statusCode:b.error.statusCode,body:b.error.body})}switch(b.error.reason){case"non-json":throw new f.CohereError({statusCode:b.error.statusCode,body:b.error.rawBody});case"timeout":throw new f.CohereTimeoutError("Timeout exceeded when calling DELETE /v1/datasets/{id}.");case"unknown":throw new f.CohereError({message:b.error.errorMessage})}})}_getAuthorizationHeader(){var y;return n(this,void 0,void 0,function*(){const d=(y=yield s.Supplier.get(this._options.token))!==null&&y!==void 0?y:process==null?void 0:a.CO_API_KEY;if(d==null)throw new f.CohereError({message:"Please specify CO_API_KEY when instantiating the client."});return`Bearer ${d}`})}}return Gt.Datasets=p,Gt}var kt={},WL;function Wle(){if(WL)return kt;WL=1;var a={},e=kt&&kt.__createBinding||(Object.create?function(h,y,d,_){_===void 0&&(_=d);var m=Object.getOwnPropertyDescriptor(y,d);(!m||("get"in m?!y.__esModule:m.writable||m.configurable))&&(m={enumerable:!0,get:function(){return y[d]}}),Object.defineProperty(h,_,m)}:function(h,y,d,_){_===void 0&&(_=d),h[_]=y[d]}),t=kt&&kt.__setModuleDefault||(Object.create?function(h,y){Object.defineProperty(h,"default",{enumerable:!0,value:y})}:function(h,y){h.default=y}),r=kt&&kt.__importStar||function(h){if(h&&h.__esModule)return h;var y={};if(h!=null)for(var d in h)d!=="default"&&Object.prototype.hasOwnProperty.call(h,d)&&e(y,h,d);return t(y,h),y},n=kt&&kt.__awaiter||function(h,y,d,_){function m(b){return b instanceof d?b:new d(function(g){g(b)})}return new(d||(d=Promise))(function(b,g){function v(R){try{S(_.next(R))}catch(P){g(P)}}function w(R){try{S(_.throw(R))}catch(P){g(P)}}function S(R){R.done?b(R.value):m(R.value).then(v,w)}S((_=_.apply(h,y||[])).next())})},i=kt&&kt.__importDefault||function(h){return h&&h.__esModule?h:{default:h}};Object.defineProperty(kt,"__esModule",{value:!0}),kt.Connectors=void 0;const o=r(ol()),s=r($()),u=r(tl()),l=i(Dc()),c=r(al()),f=r(dt());class p{constructor(y={}){this._options=y}list(y={},d){var _,m;return n(this,void 0,void 0,function*(){const{limit:b,offset:g}=y,v={};b!=null&&(v.limit=b.toString()),g!=null&&(v.offset=g.toString());const w=yield((_=this._options.fetcher)!==null&&_!==void 0?_:s.fetcher)({url:(0,l.default)((m=yield s.Supplier.get(this._options.environment))!==null&&m!==void 0?m:o.CohereEnvironment.Production,"v1/connectors"),method:"GET",headers:Object.assign({Authorization:yield this._getAuthorizationHeader(),"X-Client-Name":(yield s.Supplier.get(this._options.clientName))!=null?yield s.Supplier.get(this._options.clientName):void 0,"X-Fern-Language":"JavaScript","X-Fern-SDK-Name":"cohere-ai","X-Fern-SDK-Version":"7.16.0","User-Agent":"cohere-ai/7.16.0","X-Fern-Runtime":s.RUNTIME.type,"X-Fern-Runtime-Version":s.RUNTIME.version},d==null?void 0:d.headers),contentType:"application/json",queryParameters:v,requestType:"json",timeoutMs:(d==null?void 0:d.timeoutInSeconds)!=null?d.timeoutInSeconds*1e3:3e5,maxRetries:d==null?void 0:d.maxRetries,abortSignal:d==null?void 0:d.abortSignal});if(w.ok)return c.ListConnectorsResponse.parseOrThrow(w.body,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0,skipValidation:!0,breadcrumbsPrefix:["response"]});if(w.error.reason==="status-code")switch(w.error.statusCode){case 400:throw new u.BadRequestError(w.error.body);case 401:throw new u.UnauthorizedError(w.error.body);case 403:throw new u.ForbiddenError(w.error.body);case 404:throw new u.NotFoundError(w.error.body);case 422:throw new u.UnprocessableEntityError(w.error.body);case 429:throw new u.TooManyRequestsError(w.error.body);case 498:throw new u.InvalidTokenError(w.error.body);case 499:throw new u.ClientClosedRequestError(w.error.body);case 500:throw new u.InternalServerError(w.error.body);case 501:throw new u.NotImplementedError(w.error.body);case 503:throw new u.ServiceUnavailableError(w.error.body);case 504:throw new u.GatewayTimeoutError(w.error.body);default:throw new f.CohereError({statusCode:w.error.statusCode,body:w.error.body})}switch(w.error.reason){case"non-json":throw new f.CohereError({statusCode:w.error.statusCode,body:w.error.rawBody});case"timeout":throw new f.CohereTimeoutError("Timeout exceeded when calling GET /v1/connectors.");case"unknown":throw new f.CohereError({message:w.error.errorMessage})}})}create(y,d){var _,m;return n(this,void 0,void 0,function*(){const b=yield((_=this._options.fetcher)!==null&&_!==void 0?_:s.fetcher)({url:(0,l.default)((m=yield s.Supplier.get(this._options.environment))!==null&&m!==void 0?m:o.CohereEnvironment.Production,"v1/connectors"),method:"POST",headers:Object.assign({Authorization:yield this._getAuthorizationHeader(),"X-Client-Name":(yield s.Supplier.get(this._options.clientName))!=null?yield s.Supplier.get(this._options.clientName):void 0,"X-Fern-Language":"JavaScript","X-Fern-SDK-Name":"cohere-ai","X-Fern-SDK-Version":"7.16.0","User-Agent":"cohere-ai/7.16.0","X-Fern-Runtime":s.RUNTIME.type,"X-Fern-Runtime-Version":s.RUNTIME.version},d==null?void 0:d.headers),contentType:"application/json",requestType:"json",body:c.CreateConnectorRequest.jsonOrThrow(y,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0}),timeoutMs:(d==null?void 0:d.timeoutInSeconds)!=null?d.timeoutInSeconds*1e3:3e5,maxRetries:d==null?void 0:d.maxRetries,abortSignal:d==null?void 0:d.abortSignal});if(b.ok)return c.CreateConnectorResponse.parseOrThrow(b.body,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0,skipValidation:!0,breadcrumbsPrefix:["response"]});if(b.error.reason==="status-code")switch(b.error.statusCode){case 400:throw new u.BadRequestError(b.error.body);case 401:throw new u.UnauthorizedError(b.error.body);case 403:throw new u.ForbiddenError(b.error.body);case 404:throw new u.NotFoundError(b.error.body);case 422:throw new u.UnprocessableEntityError(b.error.body);case 429:throw new u.TooManyRequestsError(b.error.body);case 498:throw new u.InvalidTokenError(b.error.body);case 499:throw new u.ClientClosedRequestError(b.error.body);case 500:throw new u.InternalServerError(b.error.body);case 501:throw new u.NotImplementedError(b.error.body);case 503:throw new u.ServiceUnavailableError(b.error.body);case 504:throw new u.GatewayTimeoutError(b.error.body);default:throw new f.CohereError({statusCode:b.error.statusCode,body:b.error.body})}switch(b.error.reason){case"non-json":throw new f.CohereError({statusCode:b.error.statusCode,body:b.error.rawBody});case"timeout":throw new f.CohereTimeoutError("Timeout exceeded when calling POST /v1/connectors.");case"unknown":throw new f.CohereError({message:b.error.errorMessage})}})}get(y,d){var _,m;return n(this,void 0,void 0,function*(){const b=yield((_=this._options.fetcher)!==null&&_!==void 0?_:s.fetcher)({url:(0,l.default)((m=yield s.Supplier.get(this._options.environment))!==null&&m!==void 0?m:o.CohereEnvironment.Production,`v1/connectors/${encodeURIComponent(y)}`),method:"GET",headers:Object.assign({Authorization:yield this._getAuthorizationHeader(),"X-Client-Name":(yield s.Supplier.get(this._options.clientName))!=null?yield s.Supplier.get(this._options.clientName):void 0,"X-Fern-Language":"JavaScript","X-Fern-SDK-Name":"cohere-ai","X-Fern-SDK-Version":"7.16.0","User-Agent":"cohere-ai/7.16.0","X-Fern-Runtime":s.RUNTIME.type,"X-Fern-Runtime-Version":s.RUNTIME.version},d==null?void 0:d.headers),contentType:"application/json",requestType:"json",timeoutMs:(d==null?void 0:d.timeoutInSeconds)!=null?d.timeoutInSeconds*1e3:3e5,maxRetries:d==null?void 0:d.maxRetries,abortSignal:d==null?void 0:d.abortSignal});if(b.ok)return c.GetConnectorResponse.parseOrThrow(b.body,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0,skipValidation:!0,breadcrumbsPrefix:["response"]});if(b.error.reason==="status-code")switch(b.error.statusCode){case 400:throw new u.BadRequestError(b.error.body);case 401:throw new u.UnauthorizedError(b.error.body);case 403:throw new u.ForbiddenError(b.error.body);case 404:throw new u.NotFoundError(b.error.body);case 422:throw new u.UnprocessableEntityError(b.error.body);case 429:throw new u.TooManyRequestsError(b.error.body);case 498:throw new u.InvalidTokenError(b.error.body);case 499:throw new u.ClientClosedRequestError(b.error.body);case 500:throw new u.InternalServerError(b.error.body);case 501:throw new u.NotImplementedError(b.error.body);case 503:throw new u.ServiceUnavailableError(b.error.body);case 504:throw new u.GatewayTimeoutError(b.error.body);default:throw new f.CohereError({statusCode:b.error.statusCode,body:b.error.body})}switch(b.error.reason){case"non-json":throw new f.CohereError({statusCode:b.error.statusCode,body:b.error.rawBody});case"timeout":throw new f.CohereTimeoutError("Timeout exceeded when calling GET /v1/connectors/{id}.");case"unknown":throw new f.CohereError({message:b.error.errorMessage})}})}delete(y,d){var _,m;return n(this,void 0,void 0,function*(){const b=yield((_=this._options.fetcher)!==null&&_!==void 0?_:s.fetcher)({url:(0,l.default)((m=yield s.Supplier.get(this._options.environment))!==null&&m!==void 0?m:o.CohereEnvironment.Production,`v1/connectors/${encodeURIComponent(y)}`),method:"DELETE",headers:Object.assign({Authorization:yield this._getAuthorizationHeader(),"X-Client-Name":(yield s.Supplier.get(this._options.clientName))!=null?yield s.Supplier.get(this._options.clientName):void 0,"X-Fern-Language":"JavaScript","X-Fern-SDK-Name":"cohere-ai","X-Fern-SDK-Version":"7.16.0","User-Agent":"cohere-ai/7.16.0","X-Fern-Runtime":s.RUNTIME.type,"X-Fern-Runtime-Version":s.RUNTIME.version},d==null?void 0:d.headers),contentType:"application/json",requestType:"json",timeoutMs:(d==null?void 0:d.timeoutInSeconds)!=null?d.timeoutInSeconds*1e3:3e5,maxRetries:d==null?void 0:d.maxRetries,abortSignal:d==null?void 0:d.abortSignal});if(b.ok)return c.DeleteConnectorResponse.parseOrThrow(b.body,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0,skipValidation:!0,breadcrumbsPrefix:["response"]});if(b.error.reason==="status-code")switch(b.error.statusCode){case 400:throw new u.BadRequestError(b.error.body);case 401:throw new u.UnauthorizedError(b.error.body);case 403:throw new u.ForbiddenError(b.error.body);case 404:throw new u.NotFoundError(b.error.body);case 422:throw new u.UnprocessableEntityError(b.error.body);case 429:throw new u.TooManyRequestsError(b.error.body);case 498:throw new u.InvalidTokenError(b.error.body);case 499:throw new u.ClientClosedRequestError(b.error.body);case 500:throw new u.InternalServerError(b.error.body);case 501:throw new u.NotImplementedError(b.error.body);case 503:throw new u.ServiceUnavailableError(b.error.body);case 504:throw new u.GatewayTimeoutError(b.error.body);default:throw new f.CohereError({statusCode:b.error.statusCode,body:b.error.body})}switch(b.error.reason){case"non-json":throw new f.CohereError({statusCode:b.error.statusCode,body:b.error.rawBody});case"timeout":throw new f.CohereTimeoutError("Timeout exceeded when calling DELETE /v1/connectors/{id}.");case"unknown":throw new f.CohereError({message:b.error.errorMessage})}})}update(y,d={},_){var m,b;return n(this,void 0,void 0,function*(){const g=yield((m=this._options.fetcher)!==null&&m!==void 0?m:s.fetcher)({url:(0,l.default)((b=yield s.Supplier.get(this._options.environment))!==null&&b!==void 0?b:o.CohereEnvironment.Production,`v1/connectors/${encodeURIComponent(y)}`),method:"PATCH",headers:Object.assign({Authorization:yield this._getAuthorizationHeader(),"X-Client-Name":(yield s.Supplier.get(this._options.clientName))!=null?yield s.Supplier.get(this._options.clientName):void 0,"X-Fern-Language":"JavaScript","X-Fern-SDK-Name":"cohere-ai","X-Fern-SDK-Version":"7.16.0","User-Agent":"cohere-ai/7.16.0","X-Fern-Runtime":s.RUNTIME.type,"X-Fern-Runtime-Version":s.RUNTIME.version},_==null?void 0:_.headers),contentType:"application/json",requestType:"json",body:c.UpdateConnectorRequest.jsonOrThrow(d,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0}),timeoutMs:(_==null?void 0:_.timeoutInSeconds)!=null?_.timeoutInSeconds*1e3:3e5,maxRetries:_==null?void 0:_.maxRetries,abortSignal:_==null?void 0:_.abortSignal});if(g.ok)return c.UpdateConnectorResponse.parseOrThrow(g.body,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0,skipValidation:!0,breadcrumbsPrefix:["response"]});if(g.error.reason==="status-code")switch(g.error.statusCode){case 400:throw new u.BadRequestError(g.error.body);case 401:throw new u.UnauthorizedError(g.error.body);case 403:throw new u.ForbiddenError(g.error.body);case 404:throw new u.NotFoundError(g.error.body);case 422:throw new u.UnprocessableEntityError(g.error.body);case 429:throw new u.TooManyRequestsError(g.error.body);case 498:throw new u.InvalidTokenError(g.error.body);case 499:throw new u.ClientClosedRequestError(g.error.body);case 500:throw new u.InternalServerError(g.error.body);case 501:throw new u.NotImplementedError(g.error.body);case 503:throw new u.ServiceUnavailableError(g.error.body);case 504:throw new u.GatewayTimeoutError(g.error.body);default:throw new f.CohereError({statusCode:g.error.statusCode,body:g.error.body})}switch(g.error.reason){case"non-json":throw new f.CohereError({statusCode:g.error.statusCode,body:g.error.rawBody});case"timeout":throw new f.CohereTimeoutError("Timeout exceeded when calling PATCH /v1/connectors/{id}.");case"unknown":throw new f.CohereError({message:g.error.errorMessage})}})}oAuthAuthorize(y,d={},_){var m,b;return n(this,void 0,void 0,function*(){const{afterTokenRedirect:g}=d,v={};g!=null&&(v.after_token_redirect=g);const w=yield((m=this._options.fetcher)!==null&&m!==void 0?m:s.fetcher)({url:(0,l.default)((b=yield s.Supplier.get(this._options.environment))!==null&&b!==void 0?b:o.CohereEnvironment.Production,`v1/connectors/${encodeURIComponent(y)}/oauth/authorize`),method:"POST",headers:Object.assign({Authorization:yield this._getAuthorizationHeader(),"X-Client-Name":(yield s.Supplier.get(this._options.clientName))!=null?yield s.Supplier.get(this._options.clientName):void 0,"X-Fern-Language":"JavaScript","X-Fern-SDK-Name":"cohere-ai","X-Fern-SDK-Version":"7.16.0","User-Agent":"cohere-ai/7.16.0","X-Fern-Runtime":s.RUNTIME.type,"X-Fern-Runtime-Version":s.RUNTIME.version},_==null?void 0:_.headers),contentType:"application/json",queryParameters:v,requestType:"json",timeoutMs:(_==null?void 0:_.timeoutInSeconds)!=null?_.timeoutInSeconds*1e3:3e5,maxRetries:_==null?void 0:_.maxRetries,abortSignal:_==null?void 0:_.abortSignal});if(w.ok)return c.OAuthAuthorizeResponse.parseOrThrow(w.body,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0,skipValidation:!0,breadcrumbsPrefix:["response"]});if(w.error.reason==="status-code")switch(w.error.statusCode){case 400:throw new u.BadRequestError(w.error.body);case 401:throw new u.UnauthorizedError(w.error.body);case 403:throw new u.ForbiddenError(w.error.body);case 404:throw new u.NotFoundError(w.error.body);case 422:throw new u.UnprocessableEntityError(w.error.body);case 429:throw new u.TooManyRequestsError(w.error.body);case 498:throw new u.InvalidTokenError(w.error.body);case 499:throw new u.ClientClosedRequestError(w.error.body);case 500:throw new u.InternalServerError(w.error.body);case 501:throw new u.NotImplementedError(w.error.body);case 503:throw new u.ServiceUnavailableError(w.error.body);case 504:throw new u.GatewayTimeoutError(w.error.body);default:throw new f.CohereError({statusCode:w.error.statusCode,body:w.error.body})}switch(w.error.reason){case"non-json":throw new f.CohereError({statusCode:w.error.statusCode,body:w.error.rawBody});case"timeout":throw new f.CohereTimeoutError("Timeout exceeded when calling POST /v1/connectors/{id}/oauth/authorize.");case"unknown":throw new f.CohereError({message:w.error.errorMessage})}})}_getAuthorizationHeader(){var y;return n(this,void 0,void 0,function*(){const d=(y=yield s.Supplier.get(this._options.token))!==null&&y!==void 0?y:process==null?void 0:a.CO_API_KEY;if(d==null)throw new f.CohereError({message:"Please specify CO_API_KEY when instantiating the client."});return`Bearer ${d}`})}}return kt.Connectors=p,kt}var Ht={},KL;function Kle(){if(KL)return Ht;KL=1;var a={},e=Ht&&Ht.__createBinding||(Object.create?function(h,y,d,_){_===void 0&&(_=d);var m=Object.getOwnPropertyDescriptor(y,d);(!m||("get"in m?!y.__esModule:m.writable||m.configurable))&&(m={enumerable:!0,get:function(){return y[d]}}),Object.defineProperty(h,_,m)}:function(h,y,d,_){_===void 0&&(_=d),h[_]=y[d]}),t=Ht&&Ht.__setModuleDefault||(Object.create?function(h,y){Object.defineProperty(h,"default",{enumerable:!0,value:y})}:function(h,y){h.default=y}),r=Ht&&Ht.__importStar||function(h){if(h&&h.__esModule)return h;var y={};if(h!=null)for(var d in h)d!=="default"&&Object.prototype.hasOwnProperty.call(h,d)&&e(y,h,d);return t(y,h),y},n=Ht&&Ht.__awaiter||function(h,y,d,_){function m(b){return b instanceof d?b:new d(function(g){g(b)})}return new(d||(d=Promise))(function(b,g){function v(R){try{S(_.next(R))}catch(P){g(P)}}function w(R){try{S(_.throw(R))}catch(P){g(P)}}function S(R){R.done?b(R.value):m(R.value).then(v,w)}S((_=_.apply(h,y||[])).next())})},i=Ht&&Ht.__importDefault||function(h){return h&&h.__esModule?h:{default:h}};Object.defineProperty(Ht,"__esModule",{value:!0}),Ht.Models=void 0;const o=r(ol()),s=r($()),u=r(tl()),l=i(Dc()),c=r(al()),f=r(dt());class p{constructor(y={}){this._options=y}get(y,d){var _,m;return n(this,void 0,void 0,function*(){const b=yield((_=this._options.fetcher)!==null&&_!==void 0?_:s.fetcher)({url:(0,l.default)((m=yield s.Supplier.get(this._options.environment))!==null&&m!==void 0?m:o.CohereEnvironment.Production,`v1/models/${encodeURIComponent(y)}`),method:"GET",headers:Object.assign({Authorization:yield this._getAuthorizationHeader(),"X-Client-Name":(yield s.Supplier.get(this._options.clientName))!=null?yield s.Supplier.get(this._options.clientName):void 0,"X-Fern-Language":"JavaScript","X-Fern-SDK-Name":"cohere-ai","X-Fern-SDK-Version":"7.16.0","User-Agent":"cohere-ai/7.16.0","X-Fern-Runtime":s.RUNTIME.type,"X-Fern-Runtime-Version":s.RUNTIME.version},d==null?void 0:d.headers),contentType:"application/json",requestType:"json",timeoutMs:(d==null?void 0:d.timeoutInSeconds)!=null?d.timeoutInSeconds*1e3:3e5,maxRetries:d==null?void 0:d.maxRetries,abortSignal:d==null?void 0:d.abortSignal});if(b.ok)return c.GetModelResponse.parseOrThrow(b.body,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0,skipValidation:!0,breadcrumbsPrefix:["response"]});if(b.error.reason==="status-code")switch(b.error.statusCode){case 400:throw new u.BadRequestError(b.error.body);case 401:throw new u.UnauthorizedError(b.error.body);case 403:throw new u.ForbiddenError(b.error.body);case 404:throw new u.NotFoundError(b.error.body);case 422:throw new u.UnprocessableEntityError(b.error.body);case 429:throw new u.TooManyRequestsError(b.error.body);case 498:throw new u.InvalidTokenError(b.error.body);case 499:throw new u.ClientClosedRequestError(b.error.body);case 500:throw new u.InternalServerError(b.error.body);case 501:throw new u.NotImplementedError(b.error.body);case 503:throw new u.ServiceUnavailableError(b.error.body);case 504:throw new u.GatewayTimeoutError(b.error.body);default:throw new f.CohereError({statusCode:b.error.statusCode,body:b.error.body})}switch(b.error.reason){case"non-json":throw new f.CohereError({statusCode:b.error.statusCode,body:b.error.rawBody});case"timeout":throw new f.CohereTimeoutError("Timeout exceeded when calling GET /v1/models/{model}.");case"unknown":throw new f.CohereError({message:b.error.errorMessage})}})}list(y={},d){var _,m;return n(this,void 0,void 0,function*(){const{pageSize:b,pageToken:g,endpoint:v,defaultOnly:w}=y,S={};b!=null&&(S.page_size=b.toString()),g!=null&&(S.page_token=g),v!=null&&(S.endpoint=v),w!=null&&(S.default_only=w.toString());const R=yield((_=this._options.fetcher)!==null&&_!==void 0?_:s.fetcher)({url:(0,l.default)((m=yield s.Supplier.get(this._options.environment))!==null&&m!==void 0?m:o.CohereEnvironment.Production,"v1/models"),method:"GET",headers:Object.assign({Authorization:yield this._getAuthorizationHeader(),"X-Client-Name":(yield s.Supplier.get(this._options.clientName))!=null?yield s.Supplier.get(this._options.clientName):void 0,"X-Fern-Language":"JavaScript","X-Fern-SDK-Name":"cohere-ai","X-Fern-SDK-Version":"7.16.0","User-Agent":"cohere-ai/7.16.0","X-Fern-Runtime":s.RUNTIME.type,"X-Fern-Runtime-Version":s.RUNTIME.version},d==null?void 0:d.headers),contentType:"application/json",queryParameters:S,requestType:"json",timeoutMs:(d==null?void 0:d.timeoutInSeconds)!=null?d.timeoutInSeconds*1e3:3e5,maxRetries:d==null?void 0:d.maxRetries,abortSignal:d==null?void 0:d.abortSignal});if(R.ok)return c.ListModelsResponse.parseOrThrow(R.body,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0,skipValidation:!0,breadcrumbsPrefix:["response"]});if(R.error.reason==="status-code")switch(R.error.statusCode){case 400:throw new u.BadRequestError(R.error.body);case 401:throw new u.UnauthorizedError(R.error.body);case 403:throw new u.ForbiddenError(R.error.body);case 404:throw new u.NotFoundError(R.error.body);case 422:throw new u.UnprocessableEntityError(R.error.body);case 429:throw new u.TooManyRequestsError(R.error.body);case 498:throw new u.InvalidTokenError(R.error.body);case 499:throw new u.ClientClosedRequestError(R.error.body);case 500:throw new u.InternalServerError(R.error.body);case 501:throw new u.NotImplementedError(R.error.body);case 503:throw new u.ServiceUnavailableError(R.error.body);case 504:throw new u.GatewayTimeoutError(R.error.body);default:throw new f.CohereError({statusCode:R.error.statusCode,body:R.error.body})}switch(R.error.reason){case"non-json":throw new f.CohereError({statusCode:R.error.statusCode,body:R.error.rawBody});case"timeout":throw new f.CohereTimeoutError("Timeout exceeded when calling GET /v1/models.");case"unknown":throw new f.CohereError({message:R.error.errorMessage})}})}_getAuthorizationHeader(){var y;return n(this,void 0,void 0,function*(){const d=(y=yield s.Supplier.get(this._options.token))!==null&&y!==void 0?y:process==null?void 0:a.CO_API_KEY;if(d==null)throw new f.CohereError({message:"Please specify CO_API_KEY when instantiating the client."});return`Bearer ${d}`})}}return Ht.Models=p,Ht}var Wt={},JL;function Jle(){if(JL)return Wt;JL=1;var a={},e=Wt&&Wt.__createBinding||(Object.create?function(h,y,d,_){_===void 0&&(_=d);var m=Object.getOwnPropertyDescriptor(y,d);(!m||("get"in m?!y.__esModule:m.writable||m.configurable))&&(m={enumerable:!0,get:function(){return y[d]}}),Object.defineProperty(h,_,m)}:function(h,y,d,_){_===void 0&&(_=d),h[_]=y[d]}),t=Wt&&Wt.__setModuleDefault||(Object.create?function(h,y){Object.defineProperty(h,"default",{enumerable:!0,value:y})}:function(h,y){h.default=y}),r=Wt&&Wt.__importStar||function(h){if(h&&h.__esModule)return h;var y={};if(h!=null)for(var d in h)d!=="default"&&Object.prototype.hasOwnProperty.call(h,d)&&e(y,h,d);return t(y,h),y},n=Wt&&Wt.__awaiter||function(h,y,d,_){function m(b){return b instanceof d?b:new d(function(g){g(b)})}return new(d||(d=Promise))(function(b,g){function v(R){try{S(_.next(R))}catch(P){g(P)}}function w(R){try{S(_.throw(R))}catch(P){g(P)}}function S(R){R.done?b(R.value):m(R.value).then(v,w)}S((_=_.apply(h,y||[])).next())})},i=Wt&&Wt.__importDefault||function(h){return h&&h.__esModule?h:{default:h}};Object.defineProperty(Wt,"__esModule",{value:!0}),Wt.Finetuning=void 0;const o=r(ol()),s=r($()),u=r(tl()),l=i(Dc()),c=r(al()),f=r(dt());class p{constructor(y={}){this._options=y}listFinetunedModels(y={},d){var _,m;return n(this,void 0,void 0,function*(){const{pageSize:b,pageToken:g,orderBy:v}=y,w={};b!=null&&(w.page_size=b.toString()),g!=null&&(w.page_token=g),v!=null&&(w.order_by=v);const S=yield((_=this._options.fetcher)!==null&&_!==void 0?_:s.fetcher)({url:(0,l.default)((m=yield s.Supplier.get(this._options.environment))!==null&&m!==void 0?m:o.CohereEnvironment.Production,"v1/finetuning/finetuned-models"),method:"GET",headers:Object.assign({Authorization:yield this._getAuthorizationHeader(),"X-Client-Name":(yield s.Supplier.get(this._options.clientName))!=null?yield s.Supplier.get(this._options.clientName):void 0,"X-Fern-Language":"JavaScript","X-Fern-SDK-Name":"cohere-ai","X-Fern-SDK-Version":"7.16.0","User-Agent":"cohere-ai/7.16.0","X-Fern-Runtime":s.RUNTIME.type,"X-Fern-Runtime-Version":s.RUNTIME.version},d==null?void 0:d.headers),contentType:"application/json",queryParameters:w,requestType:"json",timeoutMs:(d==null?void 0:d.timeoutInSeconds)!=null?d.timeoutInSeconds*1e3:3e5,maxRetries:d==null?void 0:d.maxRetries,abortSignal:d==null?void 0:d.abortSignal});if(S.ok)return c.finetuning.ListFinetunedModelsResponse.parseOrThrow(S.body,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0,skipValidation:!0,breadcrumbsPrefix:["response"]});if(S.error.reason==="status-code")switch(S.error.statusCode){case 400:throw new u.BadRequestError(S.error.body);case 401:throw new u.UnauthorizedError(S.error.body);case 403:throw new u.ForbiddenError(S.error.body);case 404:throw new u.NotFoundError(S.error.body);case 500:throw new u.InternalServerError(S.error.body);case 503:throw new u.ServiceUnavailableError(S.error.body);default:throw new f.CohereError({statusCode:S.error.statusCode,body:S.error.body})}switch(S.error.reason){case"non-json":throw new f.CohereError({statusCode:S.error.statusCode,body:S.error.rawBody});case"timeout":throw new f.CohereTimeoutError("Timeout exceeded when calling GET /v1/finetuning/finetuned-models.");case"unknown":throw new f.CohereError({message:S.error.errorMessage})}})}createFinetunedModel(y,d){var _,m;return n(this,void 0,void 0,function*(){const b=yield((_=this._options.fetcher)!==null&&_!==void 0?_:s.fetcher)({url:(0,l.default)((m=yield s.Supplier.get(this._options.environment))!==null&&m!==void 0?m:o.CohereEnvironment.Production,"v1/finetuning/finetuned-models"),method:"POST",headers:Object.assign({Authorization:yield this._getAuthorizationHeader(),"X-Client-Name":(yield s.Supplier.get(this._options.clientName))!=null?yield s.Supplier.get(this._options.clientName):void 0,"X-Fern-Language":"JavaScript","X-Fern-SDK-Name":"cohere-ai","X-Fern-SDK-Version":"7.16.0","User-Agent":"cohere-ai/7.16.0","X-Fern-Runtime":s.RUNTIME.type,"X-Fern-Runtime-Version":s.RUNTIME.version},d==null?void 0:d.headers),contentType:"application/json",requestType:"json",body:c.finetuning.FinetunedModel.jsonOrThrow(y,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0}),timeoutMs:(d==null?void 0:d.timeoutInSeconds)!=null?d.timeoutInSeconds*1e3:3e5,maxRetries:d==null?void 0:d.maxRetries,abortSignal:d==null?void 0:d.abortSignal});if(b.ok)return c.finetuning.CreateFinetunedModelResponse.parseOrThrow(b.body,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0,skipValidation:!0,breadcrumbsPrefix:["response"]});if(b.error.reason==="status-code")switch(b.error.statusCode){case 400:throw new u.BadRequestError(b.error.body);case 401:throw new u.UnauthorizedError(b.error.body);case 403:throw new u.ForbiddenError(b.error.body);case 404:throw new u.NotFoundError(b.error.body);case 500:throw new u.InternalServerError(b.error.body);case 503:throw new u.ServiceUnavailableError(b.error.body);default:throw new f.CohereError({statusCode:b.error.statusCode,body:b.error.body})}switch(b.error.reason){case"non-json":throw new f.CohereError({statusCode:b.error.statusCode,body:b.error.rawBody});case"timeout":throw new f.CohereTimeoutError("Timeout exceeded when calling POST /v1/finetuning/finetuned-models.");case"unknown":throw new f.CohereError({message:b.error.errorMessage})}})}getFinetunedModel(y,d){var _,m;return n(this,void 0,void 0,function*(){const b=yield((_=this._options.fetcher)!==null&&_!==void 0?_:s.fetcher)({url:(0,l.default)((m=yield s.Supplier.get(this._options.environment))!==null&&m!==void 0?m:o.CohereEnvironment.Production,`v1/finetuning/finetuned-models/${encodeURIComponent(y)}`),method:"GET",headers:Object.assign({Authorization:yield this._getAuthorizationHeader(),"X-Client-Name":(yield s.Supplier.get(this._options.clientName))!=null?yield s.Supplier.get(this._options.clientName):void 0,"X-Fern-Language":"JavaScript","X-Fern-SDK-Name":"cohere-ai","X-Fern-SDK-Version":"7.16.0","User-Agent":"cohere-ai/7.16.0","X-Fern-Runtime":s.RUNTIME.type,"X-Fern-Runtime-Version":s.RUNTIME.version},d==null?void 0:d.headers),contentType:"application/json",requestType:"json",timeoutMs:(d==null?void 0:d.timeoutInSeconds)!=null?d.timeoutInSeconds*1e3:3e5,maxRetries:d==null?void 0:d.maxRetries,abortSignal:d==null?void 0:d.abortSignal});if(b.ok)return c.finetuning.GetFinetunedModelResponse.parseOrThrow(b.body,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0,skipValidation:!0,breadcrumbsPrefix:["response"]});if(b.error.reason==="status-code")switch(b.error.statusCode){case 400:throw new u.BadRequestError(b.error.body);case 401:throw new u.UnauthorizedError(b.error.body);case 403:throw new u.ForbiddenError(b.error.body);case 404:throw new u.NotFoundError(b.error.body);case 500:throw new u.InternalServerError(b.error.body);case 503:throw new u.ServiceUnavailableError(b.error.body);default:throw new f.CohereError({statusCode:b.error.statusCode,body:b.error.body})}switch(b.error.reason){case"non-json":throw new f.CohereError({statusCode:b.error.statusCode,body:b.error.rawBody});case"timeout":throw new f.CohereTimeoutError("Timeout exceeded when calling GET /v1/finetuning/finetuned-models/{id}.");case"unknown":throw new f.CohereError({message:b.error.errorMessage})}})}deleteFinetunedModel(y,d){var _,m;return n(this,void 0,void 0,function*(){const b=yield((_=this._options.fetcher)!==null&&_!==void 0?_:s.fetcher)({url:(0,l.default)((m=yield s.Supplier.get(this._options.environment))!==null&&m!==void 0?m:o.CohereEnvironment.Production,`v1/finetuning/finetuned-models/${encodeURIComponent(y)}`),method:"DELETE",headers:Object.assign({Authorization:yield this._getAuthorizationHeader(),"X-Client-Name":(yield s.Supplier.get(this._options.clientName))!=null?yield s.Supplier.get(this._options.clientName):void 0,"X-Fern-Language":"JavaScript","X-Fern-SDK-Name":"cohere-ai","X-Fern-SDK-Version":"7.16.0","User-Agent":"cohere-ai/7.16.0","X-Fern-Runtime":s.RUNTIME.type,"X-Fern-Runtime-Version":s.RUNTIME.version},d==null?void 0:d.headers),contentType:"application/json",requestType:"json",timeoutMs:(d==null?void 0:d.timeoutInSeconds)!=null?d.timeoutInSeconds*1e3:3e5,maxRetries:d==null?void 0:d.maxRetries,abortSignal:d==null?void 0:d.abortSignal});if(b.ok)return c.finetuning.DeleteFinetunedModelResponse.parseOrThrow(b.body,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0,skipValidation:!0,breadcrumbsPrefix:["response"]});if(b.error.reason==="status-code")switch(b.error.statusCode){case 400:throw new u.BadRequestError(b.error.body);case 401:throw new u.UnauthorizedError(b.error.body);case 403:throw new u.ForbiddenError(b.error.body);case 404:throw new u.NotFoundError(b.error.body);case 500:throw new u.InternalServerError(b.error.body);case 503:throw new u.ServiceUnavailableError(b.error.body);default:throw new f.CohereError({statusCode:b.error.statusCode,body:b.error.body})}switch(b.error.reason){case"non-json":throw new f.CohereError({statusCode:b.error.statusCode,body:b.error.rawBody});case"timeout":throw new f.CohereTimeoutError("Timeout exceeded when calling DELETE /v1/finetuning/finetuned-models/{id}.");case"unknown":throw new f.CohereError({message:b.error.errorMessage})}})}updateFinetunedModel(y,d,_){var m,b;return n(this,void 0,void 0,function*(){const g=yield((m=this._options.fetcher)!==null&&m!==void 0?m:s.fetcher)({url:(0,l.default)((b=yield s.Supplier.get(this._options.environment))!==null&&b!==void 0?b:o.CohereEnvironment.Production,`v1/finetuning/finetuned-models/${encodeURIComponent(y)}`),method:"PATCH",headers:Object.assign({Authorization:yield this._getAuthorizationHeader(),"X-Client-Name":(yield s.Supplier.get(this._options.clientName))!=null?yield s.Supplier.get(this._options.clientName):void 0,"X-Fern-Language":"JavaScript","X-Fern-SDK-Name":"cohere-ai","X-Fern-SDK-Version":"7.16.0","User-Agent":"cohere-ai/7.16.0","X-Fern-Runtime":s.RUNTIME.type,"X-Fern-Runtime-Version":s.RUNTIME.version},_==null?void 0:_.headers),contentType:"application/json",requestType:"json",body:c.FinetuningUpdateFinetunedModelRequest.jsonOrThrow(d,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0}),timeoutMs:(_==null?void 0:_.timeoutInSeconds)!=null?_.timeoutInSeconds*1e3:3e5,maxRetries:_==null?void 0:_.maxRetries,abortSignal:_==null?void 0:_.abortSignal});if(g.ok)return c.finetuning.UpdateFinetunedModelResponse.parseOrThrow(g.body,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0,skipValidation:!0,breadcrumbsPrefix:["response"]});if(g.error.reason==="status-code")switch(g.error.statusCode){case 400:throw new u.BadRequestError(g.error.body);case 401:throw new u.UnauthorizedError(g.error.body);case 403:throw new u.ForbiddenError(g.error.body);case 404:throw new u.NotFoundError(g.error.body);case 500:throw new u.InternalServerError(g.error.body);case 503:throw new u.ServiceUnavailableError(g.error.body);default:throw new f.CohereError({statusCode:g.error.statusCode,body:g.error.body})}switch(g.error.reason){case"non-json":throw new f.CohereError({statusCode:g.error.statusCode,body:g.error.rawBody});case"timeout":throw new f.CohereTimeoutError("Timeout exceeded when calling PATCH /v1/finetuning/finetuned-models/{id}.");case"unknown":throw new f.CohereError({message:g.error.errorMessage})}})}listEvents(y,d={},_){var m,b;return n(this,void 0,void 0,function*(){const{pageSize:g,pageToken:v,orderBy:w}=d,S={};g!=null&&(S.page_size=g.toString()),v!=null&&(S.page_token=v),w!=null&&(S.order_by=w);const R=yield((m=this._options.fetcher)!==null&&m!==void 0?m:s.fetcher)({url:(0,l.default)((b=yield s.Supplier.get(this._options.environment))!==null&&b!==void 0?b:o.CohereEnvironment.Production,`v1/finetuning/finetuned-models/${encodeURIComponent(y)}/events`),method:"GET",headers:Object.assign({Authorization:yield this._getAuthorizationHeader(),"X-Client-Name":(yield s.Supplier.get(this._options.clientName))!=null?yield s.Supplier.get(this._options.clientName):void 0,"X-Fern-Language":"JavaScript","X-Fern-SDK-Name":"cohere-ai","X-Fern-SDK-Version":"7.16.0","User-Agent":"cohere-ai/7.16.0","X-Fern-Runtime":s.RUNTIME.type,"X-Fern-Runtime-Version":s.RUNTIME.version},_==null?void 0:_.headers),contentType:"application/json",queryParameters:S,requestType:"json",timeoutMs:(_==null?void 0:_.timeoutInSeconds)!=null?_.timeoutInSeconds*1e3:3e5,maxRetries:_==null?void 0:_.maxRetries,abortSignal:_==null?void 0:_.abortSignal});if(R.ok)return c.finetuning.ListEventsResponse.parseOrThrow(R.body,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0,skipValidation:!0,breadcrumbsPrefix:["response"]});if(R.error.reason==="status-code")switch(R.error.statusCode){case 400:throw new u.BadRequestError(R.error.body);case 401:throw new u.UnauthorizedError(R.error.body);case 403:throw new u.ForbiddenError(R.error.body);case 404:throw new u.NotFoundError(R.error.body);case 500:throw new u.InternalServerError(R.error.body);case 503:throw new u.ServiceUnavailableError(R.error.body);default:throw new f.CohereError({statusCode:R.error.statusCode,body:R.error.body})}switch(R.error.reason){case"non-json":throw new f.CohereError({statusCode:R.error.statusCode,body:R.error.rawBody});case"timeout":throw new f.CohereTimeoutError("Timeout exceeded when calling GET /v1/finetuning/finetuned-models/{finetuned_model_id}/events.");case"unknown":throw new f.CohereError({message:R.error.errorMessage})}})}listTrainingStepMetrics(y,d={},_){var m,b;return n(this,void 0,void 0,function*(){const{pageSize:g,pageToken:v}=d,w={};g!=null&&(w.page_size=g.toString()),v!=null&&(w.page_token=v);const S=yield((m=this._options.fetcher)!==null&&m!==void 0?m:s.fetcher)({url:(0,l.default)((b=yield s.Supplier.get(this._options.environment))!==null&&b!==void 0?b:o.CohereEnvironment.Production,`v1/finetuning/finetuned-models/${encodeURIComponent(y)}/training-step-metrics`),method:"GET",headers:Object.assign({Authorization:yield this._getAuthorizationHeader(),"X-Client-Name":(yield s.Supplier.get(this._options.clientName))!=null?yield s.Supplier.get(this._options.clientName):void 0,"X-Fern-Language":"JavaScript","X-Fern-SDK-Name":"cohere-ai","X-Fern-SDK-Version":"7.16.0","User-Agent":"cohere-ai/7.16.0","X-Fern-Runtime":s.RUNTIME.type,"X-Fern-Runtime-Version":s.RUNTIME.version},_==null?void 0:_.headers),contentType:"application/json",queryParameters:w,requestType:"json",timeoutMs:(_==null?void 0:_.timeoutInSeconds)!=null?_.timeoutInSeconds*1e3:3e5,maxRetries:_==null?void 0:_.maxRetries,abortSignal:_==null?void 0:_.abortSignal});if(S.ok)return c.finetuning.ListTrainingStepMetricsResponse.parseOrThrow(S.body,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0,skipValidation:!0,breadcrumbsPrefix:["response"]});if(S.error.reason==="status-code")switch(S.error.statusCode){case 400:throw new u.BadRequestError(S.error.body);case 401:throw new u.UnauthorizedError(S.error.body);case 403:throw new u.ForbiddenError(S.error.body);case 404:throw new u.NotFoundError(S.error.body);case 500:throw new u.InternalServerError(S.error.body);case 503:throw new u.ServiceUnavailableError(S.error.body);default:throw new f.CohereError({statusCode:S.error.statusCode,body:S.error.body})}switch(S.error.reason){case"non-json":throw new f.CohereError({statusCode:S.error.statusCode,body:S.error.rawBody});case"timeout":throw new f.CohereTimeoutError("Timeout exceeded when calling GET /v1/finetuning/finetuned-models/{finetuned_model_id}/training-step-metrics.");case"unknown":throw new f.CohereError({message:S.error.errorMessage})}})}_getAuthorizationHeader(){var y;return n(this,void 0,void 0,function*(){const d=(y=yield s.Supplier.get(this._options.token))!==null&&y!==void 0?y:process==null?void 0:a.CO_API_KEY;if(d==null)throw new f.CohereError({message:"Please specify CO_API_KEY when instantiating the client."});return`Bearer ${d}`})}}return Wt.Finetuning=p,Wt}var XL;function tP(){if(XL)return Rt;XL=1;var a={},e=Rt&&Rt.__createBinding||(Object.create?function(v,w,S,R){R===void 0&&(R=S);var P=Object.getOwnPropertyDescriptor(w,S);(!P||("get"in P?!w.__esModule:P.writable||P.configurable))&&(P={enumerable:!0,get:function(){return w[S]}}),Object.defineProperty(v,R,P)}:function(v,w,S,R){R===void 0&&(R=S),v[R]=w[S]}),t=Rt&&Rt.__setModuleDefault||(Object.create?function(v,w){Object.defineProperty(v,"default",{enumerable:!0,value:w})}:function(v,w){v.default=w}),r=Rt&&Rt.__importStar||function(v){if(v&&v.__esModule)return v;var w={};if(v!=null)for(var S in v)S!=="default"&&Object.prototype.hasOwnProperty.call(v,S)&&e(w,v,S);return t(w,v),w},n=Rt&&Rt.__awaiter||function(v,w,S,R){function P(C){return C instanceof S?C:new S(function(T){T(C)})}return new(S||(S=Promise))(function(C,T){function M(B){try{q(R.next(B))}catch(H){T(H)}}function K(B){try{q(R.throw(B))}catch(H){T(H)}}function q(B){B.done?C(B.value):P(B.value).then(M,K)}q((R=R.apply(v,w||[])).next())})},i=Rt&&Rt.__rest||function(v,w){var S={};for(var R in v)Object.prototype.hasOwnProperty.call(v,R)&&w.indexOf(R)<0&&(S[R]=v[R]);if(v!=null&&typeof Object.getOwnPropertySymbols=="function")for(var P=0,R=Object.getOwnPropertySymbols(v);P<R.length;P++)w.indexOf(R[P])<0&&Object.prototype.propertyIsEnumerable.call(v,R[P])&&(S[R[P]]=v[R[P]]);return S},o=Rt&&Rt.__importDefault||function(v){return v&&v.__esModule?v:{default:v}};Object.defineProperty(Rt,"__esModule",{value:!0}),Rt.CohereClient=void 0;const s=r(ol()),u=r($()),l=r(tl()),c=r(al()),f=o(Dc()),p=r(dt()),h=TH(),y=kle(),d=Hle(),_=Wle(),m=Kle(),b=Jle();class g{constructor(w={}){this._options=w}get v2(){var w;return(w=this._v2)!==null&&w!==void 0?w:this._v2=new h.V2(this._options)}get embedJobs(){var w;return(w=this._embedJobs)!==null&&w!==void 0?w:this._embedJobs=new y.EmbedJobs(this._options)}get datasets(){var w;return(w=this._datasets)!==null&&w!==void 0?w:this._datasets=new d.Datasets(this._options)}get connectors(){var w;return(w=this._connectors)!==null&&w!==void 0?w:this._connectors=new _.Connectors(this._options)}get models(){var w;return(w=this._models)!==null&&w!==void 0?w:this._models=new m.Models(this._options)}get finetuning(){var w;return(w=this._finetuning)!==null&&w!==void 0?w:this._finetuning=new b.Finetuning(this._options)}chatStream(w,S){var R,P;return n(this,void 0,void 0,function*(){const{accepts:C}=w,T=i(w,["accepts"]),M=yield((R=this._options.fetcher)!==null&&R!==void 0?R:u.fetcher)({url:(0,f.default)((P=yield u.Supplier.get(this._options.environment))!==null&&P!==void 0?P:s.CohereEnvironment.Production,"v1/chat"),method:"POST",headers:Object.assign({Authorization:yield this._getAuthorizationHeader(),"X-Client-Name":(yield u.Supplier.get(this._options.clientName))!=null?yield u.Supplier.get(this._options.clientName):void 0,"X-Fern-Language":"JavaScript","X-Fern-SDK-Name":"cohere-ai","X-Fern-SDK-Version":"7.16.0","User-Agent":"cohere-ai/7.16.0","X-Fern-Runtime":u.RUNTIME.type,"X-Fern-Runtime-Version":u.RUNTIME.version,Accepts:C??void 0},S==null?void 0:S.headers),contentType:"application/json",requestType:"json",body:Object.assign(Object.assign({},c.ChatStreamRequest.jsonOrThrow(T,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0})),{stream:!0}),responseType:"sse",timeoutMs:(S==null?void 0:S.timeoutInSeconds)!=null?S.timeoutInSeconds*1e3:3e5,maxRetries:S==null?void 0:S.maxRetries,abortSignal:S==null?void 0:S.abortSignal});if(M.ok)return new u.Stream({stream:M.body,parse:K=>n(this,void 0,void 0,function*(){return c.StreamedChatResponse.parseOrThrow(K,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0,skipValidation:!0,breadcrumbsPrefix:["response"]})}),signal:S==null?void 0:S.abortSignal,eventShape:{type:"json",messageTerminator:`
`}});if(M.error.reason==="status-code")switch(M.error.statusCode){case 400:throw new l.BadRequestError(M.error.body);case 401:throw new l.UnauthorizedError(M.error.body);case 403:throw new l.ForbiddenError(M.error.body);case 404:throw new l.NotFoundError(M.error.body);case 422:throw new l.UnprocessableEntityError(M.error.body);case 429:throw new l.TooManyRequestsError(M.error.body);case 498:throw new l.InvalidTokenError(M.error.body);case 499:throw new l.ClientClosedRequestError(M.error.body);case 500:throw new l.InternalServerError(M.error.body);case 501:throw new l.NotImplementedError(M.error.body);case 503:throw new l.ServiceUnavailableError(M.error.body);case 504:throw new l.GatewayTimeoutError(M.error.body);default:throw new p.CohereError({statusCode:M.error.statusCode,body:M.error.body})}switch(M.error.reason){case"non-json":throw new p.CohereError({statusCode:M.error.statusCode,body:M.error.rawBody});case"timeout":throw new p.CohereTimeoutError("Timeout exceeded when calling POST /v1/chat.");case"unknown":throw new p.CohereError({message:M.error.errorMessage})}})}chat(w,S){var R,P;return n(this,void 0,void 0,function*(){const{accepts:C}=w,T=i(w,["accepts"]),M=yield((R=this._options.fetcher)!==null&&R!==void 0?R:u.fetcher)({url:(0,f.default)((P=yield u.Supplier.get(this._options.environment))!==null&&P!==void 0?P:s.CohereEnvironment.Production,"v1/chat"),method:"POST",headers:Object.assign({Authorization:yield this._getAuthorizationHeader(),"X-Client-Name":(yield u.Supplier.get(this._options.clientName))!=null?yield u.Supplier.get(this._options.clientName):void 0,"X-Fern-Language":"JavaScript","X-Fern-SDK-Name":"cohere-ai","X-Fern-SDK-Version":"7.16.0","User-Agent":"cohere-ai/7.16.0","X-Fern-Runtime":u.RUNTIME.type,"X-Fern-Runtime-Version":u.RUNTIME.version,Accepts:C??void 0},S==null?void 0:S.headers),contentType:"application/json",requestType:"json",body:Object.assign(Object.assign({},c.ChatRequest.jsonOrThrow(T,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0})),{stream:!1}),timeoutMs:(S==null?void 0:S.timeoutInSeconds)!=null?S.timeoutInSeconds*1e3:3e5,maxRetries:S==null?void 0:S.maxRetries,abortSignal:S==null?void 0:S.abortSignal});if(M.ok)return c.NonStreamedChatResponse.parseOrThrow(M.body,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0,skipValidation:!0,breadcrumbsPrefix:["response"]});if(M.error.reason==="status-code")switch(M.error.statusCode){case 400:throw new l.BadRequestError(M.error.body);case 401:throw new l.UnauthorizedError(M.error.body);case 403:throw new l.ForbiddenError(M.error.body);case 404:throw new l.NotFoundError(M.error.body);case 422:throw new l.UnprocessableEntityError(M.error.body);case 429:throw new l.TooManyRequestsError(M.error.body);case 498:throw new l.InvalidTokenError(M.error.body);case 499:throw new l.ClientClosedRequestError(M.error.body);case 500:throw new l.InternalServerError(M.error.body);case 501:throw new l.NotImplementedError(M.error.body);case 503:throw new l.ServiceUnavailableError(M.error.body);case 504:throw new l.GatewayTimeoutError(M.error.body);default:throw new p.CohereError({statusCode:M.error.statusCode,body:M.error.body})}switch(M.error.reason){case"non-json":throw new p.CohereError({statusCode:M.error.statusCode,body:M.error.rawBody});case"timeout":throw new p.CohereTimeoutError("Timeout exceeded when calling POST /v1/chat.");case"unknown":throw new p.CohereError({message:M.error.errorMessage})}})}generateStream(w,S){var R,P;return n(this,void 0,void 0,function*(){const C=yield((R=this._options.fetcher)!==null&&R!==void 0?R:u.fetcher)({url:(0,f.default)((P=yield u.Supplier.get(this._options.environment))!==null&&P!==void 0?P:s.CohereEnvironment.Production,"v1/generate"),method:"POST",headers:Object.assign({Authorization:yield this._getAuthorizationHeader(),"X-Client-Name":(yield u.Supplier.get(this._options.clientName))!=null?yield u.Supplier.get(this._options.clientName):void 0,"X-Fern-Language":"JavaScript","X-Fern-SDK-Name":"cohere-ai","X-Fern-SDK-Version":"7.16.0","User-Agent":"cohere-ai/7.16.0","X-Fern-Runtime":u.RUNTIME.type,"X-Fern-Runtime-Version":u.RUNTIME.version},S==null?void 0:S.headers),contentType:"application/json",requestType:"json",body:Object.assign(Object.assign({},c.GenerateStreamRequest.jsonOrThrow(w,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0})),{stream:!0}),responseType:"sse",timeoutMs:(S==null?void 0:S.timeoutInSeconds)!=null?S.timeoutInSeconds*1e3:3e5,maxRetries:S==null?void 0:S.maxRetries,abortSignal:S==null?void 0:S.abortSignal});if(C.ok)return new u.Stream({stream:C.body,parse:T=>n(this,void 0,void 0,function*(){return c.GenerateStreamedResponse.parseOrThrow(T,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0,skipValidation:!0,breadcrumbsPrefix:["response"]})}),signal:S==null?void 0:S.abortSignal,eventShape:{type:"json",messageTerminator:`
`}});if(C.error.reason==="status-code")switch(C.error.statusCode){case 400:throw new l.BadRequestError(C.error.body);case 401:throw new l.UnauthorizedError(C.error.body);case 403:throw new l.ForbiddenError(C.error.body);case 404:throw new l.NotFoundError(C.error.body);case 422:throw new l.UnprocessableEntityError(C.error.body);case 429:throw new l.TooManyRequestsError(C.error.body);case 498:throw new l.InvalidTokenError(C.error.body);case 499:throw new l.ClientClosedRequestError(C.error.body);case 500:throw new l.InternalServerError(C.error.body);case 501:throw new l.NotImplementedError(C.error.body);case 503:throw new l.ServiceUnavailableError(C.error.body);case 504:throw new l.GatewayTimeoutError(C.error.body);default:throw new p.CohereError({statusCode:C.error.statusCode,body:C.error.body})}switch(C.error.reason){case"non-json":throw new p.CohereError({statusCode:C.error.statusCode,body:C.error.rawBody});case"timeout":throw new p.CohereTimeoutError("Timeout exceeded when calling POST /v1/generate.");case"unknown":throw new p.CohereError({message:C.error.errorMessage})}})}generate(w,S){var R,P;return n(this,void 0,void 0,function*(){const C=yield((R=this._options.fetcher)!==null&&R!==void 0?R:u.fetcher)({url:(0,f.default)((P=yield u.Supplier.get(this._options.environment))!==null&&P!==void 0?P:s.CohereEnvironment.Production,"v1/generate"),method:"POST",headers:Object.assign({Authorization:yield this._getAuthorizationHeader(),"X-Client-Name":(yield u.Supplier.get(this._options.clientName))!=null?yield u.Supplier.get(this._options.clientName):void 0,"X-Fern-Language":"JavaScript","X-Fern-SDK-Name":"cohere-ai","X-Fern-SDK-Version":"7.16.0","User-Agent":"cohere-ai/7.16.0","X-Fern-Runtime":u.RUNTIME.type,"X-Fern-Runtime-Version":u.RUNTIME.version},S==null?void 0:S.headers),contentType:"application/json",requestType:"json",body:Object.assign(Object.assign({},c.GenerateRequest.jsonOrThrow(w,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0})),{stream:!1}),timeoutMs:(S==null?void 0:S.timeoutInSeconds)!=null?S.timeoutInSeconds*1e3:3e5,maxRetries:S==null?void 0:S.maxRetries,abortSignal:S==null?void 0:S.abortSignal});if(C.ok)return c.Generation.parseOrThrow(C.body,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0,skipValidation:!0,breadcrumbsPrefix:["response"]});if(C.error.reason==="status-code")switch(C.error.statusCode){case 400:throw new l.BadRequestError(C.error.body);case 401:throw new l.UnauthorizedError(C.error.body);case 403:throw new l.ForbiddenError(C.error.body);case 404:throw new l.NotFoundError(C.error.body);case 422:throw new l.UnprocessableEntityError(C.error.body);case 429:throw new l.TooManyRequestsError(C.error.body);case 498:throw new l.InvalidTokenError(C.error.body);case 499:throw new l.ClientClosedRequestError(C.error.body);case 500:throw new l.InternalServerError(C.error.body);case 501:throw new l.NotImplementedError(C.error.body);case 503:throw new l.ServiceUnavailableError(C.error.body);case 504:throw new l.GatewayTimeoutError(C.error.body);default:throw new p.CohereError({statusCode:C.error.statusCode,body:C.error.body})}switch(C.error.reason){case"non-json":throw new p.CohereError({statusCode:C.error.statusCode,body:C.error.rawBody});case"timeout":throw new p.CohereTimeoutError("Timeout exceeded when calling POST /v1/generate.");case"unknown":throw new p.CohereError({message:C.error.errorMessage})}})}embed(w={},S){var R,P;return n(this,void 0,void 0,function*(){const C=yield((R=this._options.fetcher)!==null&&R!==void 0?R:u.fetcher)({url:(0,f.default)((P=yield u.Supplier.get(this._options.environment))!==null&&P!==void 0?P:s.CohereEnvironment.Production,"v1/embed"),method:"POST",headers:Object.assign({Authorization:yield this._getAuthorizationHeader(),"X-Client-Name":(yield u.Supplier.get(this._options.clientName))!=null?yield u.Supplier.get(this._options.clientName):void 0,"X-Fern-Language":"JavaScript","X-Fern-SDK-Name":"cohere-ai","X-Fern-SDK-Version":"7.16.0","User-Agent":"cohere-ai/7.16.0","X-Fern-Runtime":u.RUNTIME.type,"X-Fern-Runtime-Version":u.RUNTIME.version},S==null?void 0:S.headers),contentType:"application/json",requestType:"json",body:c.EmbedRequest.jsonOrThrow(w,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0}),timeoutMs:(S==null?void 0:S.timeoutInSeconds)!=null?S.timeoutInSeconds*1e3:3e5,maxRetries:S==null?void 0:S.maxRetries,abortSignal:S==null?void 0:S.abortSignal});if(C.ok)return c.EmbedResponse.parseOrThrow(C.body,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0,skipValidation:!0,breadcrumbsPrefix:["response"]});if(C.error.reason==="status-code")switch(C.error.statusCode){case 400:throw new l.BadRequestError(C.error.body);case 401:throw new l.UnauthorizedError(C.error.body);case 403:throw new l.ForbiddenError(C.error.body);case 404:throw new l.NotFoundError(C.error.body);case 422:throw new l.UnprocessableEntityError(C.error.body);case 429:throw new l.TooManyRequestsError(C.error.body);case 498:throw new l.InvalidTokenError(C.error.body);case 499:throw new l.ClientClosedRequestError(C.error.body);case 500:throw new l.InternalServerError(C.error.body);case 501:throw new l.NotImplementedError(C.error.body);case 503:throw new l.ServiceUnavailableError(C.error.body);case 504:throw new l.GatewayTimeoutError(C.error.body);default:throw new p.CohereError({statusCode:C.error.statusCode,body:C.error.body})}switch(C.error.reason){case"non-json":throw new p.CohereError({statusCode:C.error.statusCode,body:C.error.rawBody});case"timeout":throw new p.CohereTimeoutError("Timeout exceeded when calling POST /v1/embed.");case"unknown":throw new p.CohereError({message:C.error.errorMessage})}})}rerank(w,S){var R,P;return n(this,void 0,void 0,function*(){const C=yield((R=this._options.fetcher)!==null&&R!==void 0?R:u.fetcher)({url:(0,f.default)((P=yield u.Supplier.get(this._options.environment))!==null&&P!==void 0?P:s.CohereEnvironment.Production,"v1/rerank"),method:"POST",headers:Object.assign({Authorization:yield this._getAuthorizationHeader(),"X-Client-Name":(yield u.Supplier.get(this._options.clientName))!=null?yield u.Supplier.get(this._options.clientName):void 0,"X-Fern-Language":"JavaScript","X-Fern-SDK-Name":"cohere-ai","X-Fern-SDK-Version":"7.16.0","User-Agent":"cohere-ai/7.16.0","X-Fern-Runtime":u.RUNTIME.type,"X-Fern-Runtime-Version":u.RUNTIME.version},S==null?void 0:S.headers),contentType:"application/json",requestType:"json",body:c.RerankRequest.jsonOrThrow(w,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0}),timeoutMs:(S==null?void 0:S.timeoutInSeconds)!=null?S.timeoutInSeconds*1e3:3e5,maxRetries:S==null?void 0:S.maxRetries,abortSignal:S==null?void 0:S.abortSignal});if(C.ok)return c.RerankResponse.parseOrThrow(C.body,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0,skipValidation:!0,breadcrumbsPrefix:["response"]});if(C.error.reason==="status-code")switch(C.error.statusCode){case 400:throw new l.BadRequestError(C.error.body);case 401:throw new l.UnauthorizedError(C.error.body);case 403:throw new l.ForbiddenError(C.error.body);case 404:throw new l.NotFoundError(C.error.body);case 422:throw new l.UnprocessableEntityError(C.error.body);case 429:throw new l.TooManyRequestsError(C.error.body);case 498:throw new l.InvalidTokenError(C.error.body);case 499:throw new l.ClientClosedRequestError(C.error.body);case 500:throw new l.InternalServerError(C.error.body);case 501:throw new l.NotImplementedError(C.error.body);case 503:throw new l.ServiceUnavailableError(C.error.body);case 504:throw new l.GatewayTimeoutError(C.error.body);default:throw new p.CohereError({statusCode:C.error.statusCode,body:C.error.body})}switch(C.error.reason){case"non-json":throw new p.CohereError({statusCode:C.error.statusCode,body:C.error.rawBody});case"timeout":throw new p.CohereTimeoutError("Timeout exceeded when calling POST /v1/rerank.");case"unknown":throw new p.CohereError({message:C.error.errorMessage})}})}classify(w,S){var R,P;return n(this,void 0,void 0,function*(){const C=yield((R=this._options.fetcher)!==null&&R!==void 0?R:u.fetcher)({url:(0,f.default)((P=yield u.Supplier.get(this._options.environment))!==null&&P!==void 0?P:s.CohereEnvironment.Production,"v1/classify"),method:"POST",headers:Object.assign({Authorization:yield this._getAuthorizationHeader(),"X-Client-Name":(yield u.Supplier.get(this._options.clientName))!=null?yield u.Supplier.get(this._options.clientName):void 0,"X-Fern-Language":"JavaScript","X-Fern-SDK-Name":"cohere-ai","X-Fern-SDK-Version":"7.16.0","User-Agent":"cohere-ai/7.16.0","X-Fern-Runtime":u.RUNTIME.type,"X-Fern-Runtime-Version":u.RUNTIME.version},S==null?void 0:S.headers),contentType:"application/json",requestType:"json",body:c.ClassifyRequest.jsonOrThrow(w,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0}),timeoutMs:(S==null?void 0:S.timeoutInSeconds)!=null?S.timeoutInSeconds*1e3:3e5,maxRetries:S==null?void 0:S.maxRetries,abortSignal:S==null?void 0:S.abortSignal});if(C.ok)return c.ClassifyResponse.parseOrThrow(C.body,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0,skipValidation:!0,breadcrumbsPrefix:["response"]});if(C.error.reason==="status-code")switch(C.error.statusCode){case 400:throw new l.BadRequestError(C.error.body);case 401:throw new l.UnauthorizedError(C.error.body);case 403:throw new l.ForbiddenError(C.error.body);case 404:throw new l.NotFoundError(C.error.body);case 422:throw new l.UnprocessableEntityError(C.error.body);case 429:throw new l.TooManyRequestsError(C.error.body);case 498:throw new l.InvalidTokenError(C.error.body);case 499:throw new l.ClientClosedRequestError(C.error.body);case 500:throw new l.InternalServerError(C.error.body);case 501:throw new l.NotImplementedError(C.error.body);case 503:throw new l.ServiceUnavailableError(C.error.body);case 504:throw new l.GatewayTimeoutError(C.error.body);default:throw new p.CohereError({statusCode:C.error.statusCode,body:C.error.body})}switch(C.error.reason){case"non-json":throw new p.CohereError({statusCode:C.error.statusCode,body:C.error.rawBody});case"timeout":throw new p.CohereTimeoutError("Timeout exceeded when calling POST /v1/classify.");case"unknown":throw new p.CohereError({message:C.error.errorMessage})}})}summarize(w,S){var R,P;return n(this,void 0,void 0,function*(){const C=yield((R=this._options.fetcher)!==null&&R!==void 0?R:u.fetcher)({url:(0,f.default)((P=yield u.Supplier.get(this._options.environment))!==null&&P!==void 0?P:s.CohereEnvironment.Production,"v1/summarize"),method:"POST",headers:Object.assign({Authorization:yield this._getAuthorizationHeader(),"X-Client-Name":(yield u.Supplier.get(this._options.clientName))!=null?yield u.Supplier.get(this._options.clientName):void 0,"X-Fern-Language":"JavaScript","X-Fern-SDK-Name":"cohere-ai","X-Fern-SDK-Version":"7.16.0","User-Agent":"cohere-ai/7.16.0","X-Fern-Runtime":u.RUNTIME.type,"X-Fern-Runtime-Version":u.RUNTIME.version},S==null?void 0:S.headers),contentType:"application/json",requestType:"json",body:c.SummarizeRequest.jsonOrThrow(w,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0}),timeoutMs:(S==null?void 0:S.timeoutInSeconds)!=null?S.timeoutInSeconds*1e3:3e5,maxRetries:S==null?void 0:S.maxRetries,abortSignal:S==null?void 0:S.abortSignal});if(C.ok)return c.SummarizeResponse.parseOrThrow(C.body,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0,skipValidation:!0,breadcrumbsPrefix:["response"]});if(C.error.reason==="status-code")switch(C.error.statusCode){case 400:throw new l.BadRequestError(C.error.body);case 401:throw new l.UnauthorizedError(C.error.body);case 403:throw new l.ForbiddenError(C.error.body);case 404:throw new l.NotFoundError(C.error.body);case 422:throw new l.UnprocessableEntityError(C.error.body);case 429:throw new l.TooManyRequestsError(C.error.body);case 498:throw new l.InvalidTokenError(C.error.body);case 499:throw new l.ClientClosedRequestError(C.error.body);case 500:throw new l.InternalServerError(C.error.body);case 501:throw new l.NotImplementedError(C.error.body);case 503:throw new l.ServiceUnavailableError(C.error.body);case 504:throw new l.GatewayTimeoutError(C.error.body);default:throw new p.CohereError({statusCode:C.error.statusCode,body:C.error.body})}switch(C.error.reason){case"non-json":throw new p.CohereError({statusCode:C.error.statusCode,body:C.error.rawBody});case"timeout":throw new p.CohereTimeoutError("Timeout exceeded when calling POST /v1/summarize.");case"unknown":throw new p.CohereError({message:C.error.errorMessage})}})}tokenize(w,S){var R,P;return n(this,void 0,void 0,function*(){const C=yield((R=this._options.fetcher)!==null&&R!==void 0?R:u.fetcher)({url:(0,f.default)((P=yield u.Supplier.get(this._options.environment))!==null&&P!==void 0?P:s.CohereEnvironment.Production,"v1/tokenize"),method:"POST",headers:Object.assign({Authorization:yield this._getAuthorizationHeader(),"X-Client-Name":(yield u.Supplier.get(this._options.clientName))!=null?yield u.Supplier.get(this._options.clientName):void 0,"X-Fern-Language":"JavaScript","X-Fern-SDK-Name":"cohere-ai","X-Fern-SDK-Version":"7.16.0","User-Agent":"cohere-ai/7.16.0","X-Fern-Runtime":u.RUNTIME.type,"X-Fern-Runtime-Version":u.RUNTIME.version},S==null?void 0:S.headers),contentType:"application/json",requestType:"json",body:c.TokenizeRequest.jsonOrThrow(w,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0}),timeoutMs:(S==null?void 0:S.timeoutInSeconds)!=null?S.timeoutInSeconds*1e3:3e5,maxRetries:S==null?void 0:S.maxRetries,abortSignal:S==null?void 0:S.abortSignal});if(C.ok)return c.TokenizeResponse.parseOrThrow(C.body,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0,skipValidation:!0,breadcrumbsPrefix:["response"]});if(C.error.reason==="status-code")switch(C.error.statusCode){case 400:throw new l.BadRequestError(C.error.body);case 401:throw new l.UnauthorizedError(C.error.body);case 403:throw new l.ForbiddenError(C.error.body);case 404:throw new l.NotFoundError(C.error.body);case 422:throw new l.UnprocessableEntityError(C.error.body);case 429:throw new l.TooManyRequestsError(C.error.body);case 498:throw new l.InvalidTokenError(C.error.body);case 499:throw new l.ClientClosedRequestError(C.error.body);case 500:throw new l.InternalServerError(C.error.body);case 501:throw new l.NotImplementedError(C.error.body);case 503:throw new l.ServiceUnavailableError(C.error.body);case 504:throw new l.GatewayTimeoutError(C.error.body);default:throw new p.CohereError({statusCode:C.error.statusCode,body:C.error.body})}switch(C.error.reason){case"non-json":throw new p.CohereError({statusCode:C.error.statusCode,body:C.error.rawBody});case"timeout":throw new p.CohereTimeoutError("Timeout exceeded when calling POST /v1/tokenize.");case"unknown":throw new p.CohereError({message:C.error.errorMessage})}})}detokenize(w,S){var R,P;return n(this,void 0,void 0,function*(){const C=yield((R=this._options.fetcher)!==null&&R!==void 0?R:u.fetcher)({url:(0,f.default)((P=yield u.Supplier.get(this._options.environment))!==null&&P!==void 0?P:s.CohereEnvironment.Production,"v1/detokenize"),method:"POST",headers:Object.assign({Authorization:yield this._getAuthorizationHeader(),"X-Client-Name":(yield u.Supplier.get(this._options.clientName))!=null?yield u.Supplier.get(this._options.clientName):void 0,"X-Fern-Language":"JavaScript","X-Fern-SDK-Name":"cohere-ai","X-Fern-SDK-Version":"7.16.0","User-Agent":"cohere-ai/7.16.0","X-Fern-Runtime":u.RUNTIME.type,"X-Fern-Runtime-Version":u.RUNTIME.version},S==null?void 0:S.headers),contentType:"application/json",requestType:"json",body:c.DetokenizeRequest.jsonOrThrow(w,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0}),timeoutMs:(S==null?void 0:S.timeoutInSeconds)!=null?S.timeoutInSeconds*1e3:3e5,maxRetries:S==null?void 0:S.maxRetries,abortSignal:S==null?void 0:S.abortSignal});if(C.ok)return c.DetokenizeResponse.parseOrThrow(C.body,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0,skipValidation:!0,breadcrumbsPrefix:["response"]});if(C.error.reason==="status-code")switch(C.error.statusCode){case 400:throw new l.BadRequestError(C.error.body);case 401:throw new l.UnauthorizedError(C.error.body);case 403:throw new l.ForbiddenError(C.error.body);case 404:throw new l.NotFoundError(C.error.body);case 422:throw new l.UnprocessableEntityError(C.error.body);case 429:throw new l.TooManyRequestsError(C.error.body);case 498:throw new l.InvalidTokenError(C.error.body);case 499:throw new l.ClientClosedRequestError(C.error.body);case 500:throw new l.InternalServerError(C.error.body);case 501:throw new l.NotImplementedError(C.error.body);case 503:throw new l.ServiceUnavailableError(C.error.body);case 504:throw new l.GatewayTimeoutError(C.error.body);default:throw new p.CohereError({statusCode:C.error.statusCode,body:C.error.body})}switch(C.error.reason){case"non-json":throw new p.CohereError({statusCode:C.error.statusCode,body:C.error.rawBody});case"timeout":throw new p.CohereTimeoutError("Timeout exceeded when calling POST /v1/detokenize.");case"unknown":throw new p.CohereError({message:C.error.errorMessage})}})}checkApiKey(w){var S,R;return n(this,void 0,void 0,function*(){const P=yield((S=this._options.fetcher)!==null&&S!==void 0?S:u.fetcher)({url:(0,f.default)((R=yield u.Supplier.get(this._options.environment))!==null&&R!==void 0?R:s.CohereEnvironment.Production,"v1/check-api-key"),method:"POST",headers:Object.assign({Authorization:yield this._getAuthorizationHeader(),"X-Client-Name":(yield u.Supplier.get(this._options.clientName))!=null?yield u.Supplier.get(this._options.clientName):void 0,"X-Fern-Language":"JavaScript","X-Fern-SDK-Name":"cohere-ai","X-Fern-SDK-Version":"7.16.0","User-Agent":"cohere-ai/7.16.0","X-Fern-Runtime":u.RUNTIME.type,"X-Fern-Runtime-Version":u.RUNTIME.version},w==null?void 0:w.headers),contentType:"application/json",requestType:"json",timeoutMs:(w==null?void 0:w.timeoutInSeconds)!=null?w.timeoutInSeconds*1e3:3e5,maxRetries:w==null?void 0:w.maxRetries,abortSignal:w==null?void 0:w.abortSignal});if(P.ok)return c.CheckApiKeyResponse.parseOrThrow(P.body,{unrecognizedObjectKeys:"passthrough",allowUnrecognizedUnionMembers:!0,allowUnrecognizedEnumValues:!0,skipValidation:!0,breadcrumbsPrefix:["response"]});if(P.error.reason==="status-code")switch(P.error.statusCode){case 400:throw new l.BadRequestError(P.error.body);case 401:throw new l.UnauthorizedError(P.error.body);case 403:throw new l.ForbiddenError(P.error.body);case 404:throw new l.NotFoundError(P.error.body);case 422:throw new l.UnprocessableEntityError(P.error.body);case 429:throw new l.TooManyRequestsError(P.error.body);case 498:throw new l.InvalidTokenError(P.error.body);case 499:throw new l.ClientClosedRequestError(P.error.body);case 500:throw new l.InternalServerError(P.error.body);case 501:throw new l.NotImplementedError(P.error.body);case 503:throw new l.ServiceUnavailableError(P.error.body);case 504:throw new l.GatewayTimeoutError(P.error.body);default:throw new p.CohereError({statusCode:P.error.statusCode,body:P.error.body})}switch(P.error.reason){case"non-json":throw new p.CohereError({statusCode:P.error.statusCode,body:P.error.rawBody});case"timeout":throw new p.CohereTimeoutError("Timeout exceeded when calling POST /v1/check-api-key.");case"unknown":throw new p.CohereError({message:P.error.errorMessage})}})}_getAuthorizationHeader(){var w;return n(this,void 0,void 0,function*(){const S=(w=yield u.Supplier.get(this._options.token))!==null&&w!==void 0?w:process==null?void 0:a.CO_API_KEY;if(S==null)throw new p.CohereError({message:"Please specify CO_API_KEY when instantiating the client."});return`Bearer ${S}`})}}return Rt.CohereClient=g,Rt}var ZL;function MH(){if(ZL)return $h;ZL=1,Object.defineProperty($h,"__esModule",{value:!0}),$h.AwsClient=void 0;const a=tP();let e=class extends a.CohereClient{constructor(r){r.token="n/a",super(r)}};return $h.AwsClient=e,$h}var QL;function Xle(){if(QL)return Jd;QL=1,Object.defineProperty(Jd,"__esModule",{value:!0}),Jd.BedrockClient=void 0;const a=jH(),e=MH();let t=class extends e.AwsClient{constructor(n){super(Object.assign(Object.assign({},n),{fetcher:(0,a.fetchOverride)("bedrock",n)}))}};return Jd.BedrockClient=t,Jd}var qh={},YL;function Zle(){if(YL)return qh;YL=1,Object.defineProperty(qh,"__esModule",{value:!0}),qh.CohereClientV2=void 0;const a=TH(),e=tP();class t{constructor(n){this._options=n,this.client=new e.CohereClient(this._options),this.clientV2=new a.V2(this._options),this.chat=this.clientV2.chat.bind(this.clientV2),this.chatStream=this.clientV2.chatStream.bind(this.clientV2),this.embed=this.clientV2.embed.bind(this.clientV2),this.rerank=this.clientV2.rerank.bind(this.clientV2),this.generateStream=this.client.generateStream.bind(this.clientV2),this.generate=this.client.generate.bind(this.clientV2),this.classify=this.client.classify.bind(this.clientV2),this.summarize=this.client.summarize.bind(this.clientV2),this.tokenize=this.client.tokenize.bind(this.clientV2),this.detokenize=this.client.detokenize.bind(this.clientV2),this.checkApiKey=this.client.checkApiKey.bind(this.clientV2),this.embedJobs=this.client.embedJobs,this.datasets=this.client.datasets,this.connectors=this.client.connectors,this.models=this.client.models,this.finetuning=this.client.finetuning}}return qh.CohereClientV2=t,qh}var zh={},e4;function Qle(){if(e4)return zh;e4=1,Object.defineProperty(zh,"__esModule",{value:!0}),zh.CustomClient=void 0;const a=tP();let e=class extends a.CohereClient{constructor(r={}){var n,i;try{const o=/\/v1\/?$/,s=(n=r.environment)===null||n===void 0?void 0:n.toString().replace(o,"");s!==((i=r.environment)===null||i===void 0?void 0:i.toString())&&(r.environment=s)}catch{}super(r),this._options=r}};return zh.CustomClient=e,zh}var Bh={},t4;function Yle(){if(t4)return Bh;t4=1,Object.defineProperty(Bh,"__esModule",{value:!0}),Bh.SagemakerClient=void 0;const a=MH(),e=jH();let t=class extends a.AwsClient{constructor(n){super(Object.assign(Object.assign({},n),{fetcher:(0,e.fetchOverride)("sagemaker",n)}))}};return Bh.SagemakerClient=t,Bh}var r4;function ece(){return r4||(r4=1,function(a){var e=hu&&hu.__createBinding||(Object.create?function(c,f,p,h){h===void 0&&(h=p);var y=Object.getOwnPropertyDescriptor(f,p);(!y||("get"in y?!f.__esModule:y.writable||y.configurable))&&(y={enumerable:!0,get:function(){return f[p]}}),Object.defineProperty(c,h,y)}:function(c,f,p,h){h===void 0&&(h=p),c[h]=f[p]}),t=hu&&hu.__setModuleDefault||(Object.create?function(c,f){Object.defineProperty(c,"default",{enumerable:!0,value:f})}:function(c,f){c.default=f}),r=hu&&hu.__importStar||function(c){if(c&&c.__esModule)return c;var f={};if(c!=null)for(var p in c)p!=="default"&&Object.prototype.hasOwnProperty.call(c,p)&&e(f,c,p);return t(f,c),f};Object.defineProperty(a,"__esModule",{value:!0}),a.SagemakerClient=a.CohereTimeoutError=a.CohereError=a.CohereEnvironment=a.CohereClient=a.CohereClientV2=a.BedrockClient=a.Cohere=void 0,a.Cohere=r(tl());var n=Xle();Object.defineProperty(a,"BedrockClient",{enumerable:!0,get:function(){return n.BedrockClient}});var i=Zle();Object.defineProperty(a,"CohereClientV2",{enumerable:!0,get:function(){return i.CohereClientV2}});var o=Qle();Object.defineProperty(a,"CohereClient",{enumerable:!0,get:function(){return o.CustomClient}});var s=ol();Object.defineProperty(a,"CohereEnvironment",{enumerable:!0,get:function(){return s.CohereEnvironment}});var u=dt();Object.defineProperty(a,"CohereError",{enumerable:!0,get:function(){return u.CohereError}}),Object.defineProperty(a,"CohereTimeoutError",{enumerable:!0,get:function(){return u.CohereTimeoutError}});var l=Yle();Object.defineProperty(a,"SagemakerClient",{enumerable:!0,get:function(){return l.SagemakerClient}})}(hu)),hu}var tce=ece();function AH(a){if(a!=null&&a.client)return a.client;const e=(a==null?void 0:a.apiKey)??We("COHERE_API_KEY");if(!e)throw new Error("COHERE_API_KEY must be set");return new tce.CohereClient({token:e})}function n4(a){const e=[];let t=[];typeof a=="string"?t=[{output:a}]:a instanceof Map||typeof a=="object"&&a!==null&&!Array.isArray(a)?t=[a]:Array.isArray(a)||(t=[{output:a}]);for(let r of t)!(r instanceof Map)&&(typeof r!="object"||r===null)&&(r={output:r}),e.push(r);return e}function ty(a,e){const t=i=>{switch(i){case"system":return"SYSTEM";case"human":return"USER";case"ai":return"CHATBOT";case"tool":return"TOOL";default:throw new Error(`Unknown message type: '${i}'. Accepted types: 'human', 'ai', 'system', 'tool'`)}},r=i=>{if(typeof i=="string")return i;throw new Error(`ChatCohere does not support non text message content. Received: ${JSON.stringify(i,null,2)}`)},n=i=>ru(i)&&i.tool_calls?i.tool_calls.map(o=>({name:o.name,parameters:o.args})):[];if(a._getType().toLowerCase()==="ai")return{role:t(a._getType()),message:r(a.content),toolCalls:n(a)};if(a._getType().toLowerCase()==="tool")return{role:t(a._getType()),message:r(a.content),toolResults:e};if(a._getType().toLowerCase()==="human"||a._getType().toLowerCase()==="system")return{role:t(a._getType()),message:r(a.content)};throw new Error("Got unknown message type. Supported types are AIMessage, ToolMessage, HumanMessage, and SystemMessage")}function rce(a){return"name"in a&&"description"in a&&"parameterDefinitions"in a}function i4(a){return a._getType()==="tool"}function a4(a){const e="properties"in a?a.properties:{};let t="required"in a?a.required:[];const r={};return Object.keys(e).forEach(n=>{r[n]=e[n],t===void 0&&(t=[]),r[n].required=t.includes(n)}),r}function nce(a){if(a){if(a.every(rce))return a;if(a.every(Zp))return a.map(e=>({name:e.function.name,description:e.function.description??"",parameterDefinitions:a4(e.function.parameters)}));if(a.every(Uf))return a.map(e=>{const t=au(e.schema);return{name:e.name,description:e.description??"",parameterDefinitions:a4(t)}});throw new Error("Can not pass in a mix of tool schema types to ChatCohere.")}else return}class ice extends Ar{static lc_name(){return"ChatCohere"}constructor(e){super(e??{}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"model",{enumerable:!0,configurable:!0,writable:!0,value:"command-r-plus"}),Object.defineProperty(this,"temperature",{enumerable:!0,configurable:!0,writable:!0,value:.3}),Object.defineProperty(this,"streaming",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"streamUsage",{enumerable:!0,configurable:!0,writable:!0,value:!0}),this.client=AH(e),this.model=(e==null?void 0:e.model)??this.model,this.temperature=(e==null?void 0:e.temperature)??this.temperature,this.streaming=(e==null?void 0:e.streaming)??this.streaming,this.streamUsage=(e==null?void 0:e.streamUsage)??this.streamUsage}getLsParams(e){const t=this.invocationParams(e);return{ls_provider:"cohere",ls_model_name:this.model,ls_model_type:"chat",ls_temperature:this.temperature??void 0,ls_max_tokens:typeof t.maxTokens=="number"?t.maxTokens:void 0,ls_stop:Array.isArray(t.stopSequences)?t.stopSequences:void 0}}_llmType(){return"cohere"}invocationParams(e){if(e.tool_choice)throw new Error("'tool_choice' call option is not supported by ChatCohere.");const t={model:this.model,preamble:e.preamble,conversationId:e.conversationId,promptTruncation:e.promptTruncation,connectors:e.connectors,searchQueriesOnly:e.searchQueriesOnly,documents:e.documents,temperature:e.temperature??this.temperature,forceSingleStep:e.forceSingleStep,tools:e.tools};return Object.fromEntries(Object.entries(t).filter(([,r])=>r!==void 0))}bindTools(e,t){return this.bind({tools:nce(e),...t})}_getChatRequest(e,t){const r=this.invocationParams(t),n=this._messagesToCohereToolResultsCurrChatTurn(e),i=[];let o="",s=[];if(r.forceSingleStep){o="";for(let l=0;l<e.length-1;l+=1){const c=e[l];if(!(ru(c)&&c.tool_calls))if(c._getType().toLowerCase()==="tool"){if(s=s.concat(this._messageToCohereToolResults(e,l)),l===e.length-1||e[l+1]._getType().toLowerCase()!=="tool"){const f=ty(c,s);i.push(f),s=[]}}else i.push(ty(c,[]))}for(let l=e.length-1;l>=0;l-=1){const c=e[l];if(c._getType().toLowerCase()==="human"&&c.content){o=c.content.toString();break}}}else{for(let l=0;l<e.length-1;l+=1){const c=e[l];if(c._getType().toLowerCase()==="tool"){if(s=s.concat(this._messageToCohereToolResults(e,l)),l===e.length-1||e[l+1]._getType().toLowerCase()!=="tool"){const f=ty(c,s);i.push(f),s=[]}}else i.push(ty(c,[]))}o=n.length>0?"":e[e.length-1].content.toString()}return{message:o,chatHistory:i,toolResults:n.length>0?n:void 0,...r}}_getCurrChatTurnMessages(e){const t=[];for(let r=e.length-1;r>=0;r-=1){const n=e[r];if(t.push(n),n._getType().toLowerCase()==="human")break}return t.reverse()}_messagesToCohereToolResultsCurrChatTurn(e){const t=[],r=this._getCurrChatTurnMessages(e);for(const n of r)if(i4(n)){const i=n,o=r.filter(s=>ru(s)&&s.tool_calls!==void 0);if(o.length>0){const s=o[o.length-1];s.tool_calls&&t.push(...s.tool_calls.filter(u=>u.id===i.tool_call_id).map(u=>({call:{name:u.name,parameters:u.args},outputs:n4(i.content)})))}}return t}_messageToCohereToolResults(e,t){const r=[],n=e[t];if(!i4(n))throw new Error("The message index does not correspond to an instance of ToolMessage");const o=e.slice(0,t).filter(s=>ru(s)&&s.tool_calls).slice(-1)[0];return o.tool_calls&&r.push(...o.tool_calls.filter(s=>s.id===n.tool_call_id).map(s=>({call:{name:s.name,parameters:s.args},outputs:n4(n.content)}))),r}_formatCohereToolCalls(e=null){if(!e)return[];const t=[];for(const r of e)t.push({id:xt().substring(0,32),function:{name:r.name,arguments:r.parameters},type:"function"});return t}_convertCohereToolCallToLangchain(e){return e.map(t=>({name:t.function.name,args:t.function.arguments,id:t.id,type:"tool_call"}))}async _generate(e,t,r){var c,f;const n={},i=this._getChatRequest(e,t);if(this.streaming){const p=this._streamResponseChunks(e,t,r),h={};for await(const d of p){const _=((c=d.generationInfo)==null?void 0:c.completion)??0;h[_]===void 0?h[_]=d:h[_]=h[_].concat(d)}return{generations:Object.entries(h).sort(([d],[_])=>parseInt(d,10)-parseInt(_,10)).map(([d,_])=>_),llmOutput:{estimatedTokenUsage:n}}}const o=await this.caller.callWithOptions({signal:t.signal},async()=>{let p;try{p=await this.client.chat(i)}catch(h){throw h.status=h.status??h.statusCode,h}return p});if((f=o.meta)!=null&&f.tokens){const{inputTokens:p,outputTokens:h}=o.meta.tokens;h&&(n.completionTokens=(n.completionTokens??0)+h),p&&(n.promptTokens=(n.promptTokens??0)+p),n.totalTokens=(n.totalTokens??0)+(n.promptTokens??0)+(n.completionTokens??0)}const s={...o};delete s.text,o.toolCalls&&o.toolCalls.length>0&&(s.toolCalls=this._formatCohereToolCalls(o.toolCalls));let u=[];return"toolCalls"in s&&(u=this._convertCohereToolCallToLangchain(s.toolCalls)),{generations:[{text:o.text,message:new Hs({content:o.text,additional_kwargs:s,tool_calls:u,usage_metadata:{input_tokens:n.promptTokens??0,output_tokens:n.completionTokens??0,total_tokens:n.totalTokens??0}}),generationInfo:s}],llmOutput:{estimatedTokenUsage:n}}}async*_streamResponseChunks(e,t,r){var o,s,u,l;const n=this._getChatRequest(e,t),i=await this.caller.call(async()=>{let c;try{c=await this.client.chatStream(n)}catch(f){throw f.status=f.status??f.statusCode,f}return c});for await(const c of i)if(c.eventType==="text-generation")yield new rr({text:c.text,message:new it({content:c.text})}),await(r==null?void 0:r.handleLLMNewToken(c.text));else if(c.eventType!=="stream-end")yield new rr({text:"",message:new it({content:"",additional_kwargs:{...c}}),generationInfo:{...c}});else if(c.eventType==="stream-end"&&(this.streamUsage||t.streamUsage)){const f=((s=(o=c.response.meta)==null?void 0:o.tokens)==null?void 0:s.inputTokens)??0,p=((l=(u=c.response.meta)==null?void 0:u.tokens)==null?void 0:l.outputTokens)??0,h={...c.response};c.response.toolCalls&&c.response.toolCalls.length>0&&(h.toolCalls=this._formatCohereToolCalls(c.response.toolCalls));let y=[];const d=h.toolCalls??[];d.length>0&&(y=d.map(_=>({name:_.function.name,args:_.function.arguments,id:_.id,index:_.index,type:"tool_call_chunk"}))),yield new rr({text:"",message:new it({content:"",additional_kwargs:{eventType:"stream-end"},tool_call_chunks:y,usage_metadata:{input_tokens:f,output_tokens:p,total_tokens:f+p}}),generationInfo:{eventType:"stream-end",...h}})}}_combineLLMOutput(...e){return e.reduce((t,r)=>{var n,i,o;if(r&&r.estimatedTokenUsage){let s=((n=t.estimatedTokenUsage)==null?void 0:n.completionTokens)??0,u=((i=t.estimatedTokenUsage)==null?void 0:i.promptTokens)??0,l=((o=t.estimatedTokenUsage)==null?void 0:o.totalTokens)??0;s+=r.estimatedTokenUsage.completionTokens??0,u+=r.estimatedTokenUsage.promptTokens??0,l+=r.estimatedTokenUsage.totalTokens??0,t.estimatedTokenUsage={completionTokens:s,promptTokens:u,totalTokens:l}}return t},{estimatedTokenUsage:{completionTokens:0,promptTokens:0,totalTokens:0}})}get lc_secrets(){return{apiKey:"COHERE_API_KEY",api_key:"COHERE_API_KEY"}}get lc_aliases(){return{apiKey:"cohere_api_key",api_key:"cohere_api_key"}}}class ace extends B3{constructor(e){const t={maxConcurrency:2,...e};if(super(t),Object.defineProperty(this,"model",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"batchSize",{enumerable:!0,configurable:!0,writable:!0,value:48}),Object.defineProperty(this,"embeddingTypes",{enumerable:!0,configurable:!0,writable:!0,value:["float"]}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.client=AH(t),this.model=(t==null?void 0:t.model)??this.model,!this.model)throw new Error("Model not specified for CohereEmbeddings instance. Please provide a model name from the options here: https://docs.cohere.com/reference/embed");this.batchSize=(t==null?void 0:t.batchSize)??this.batchSize,this.embeddingTypes=(t==null?void 0:t.embeddingTypes)??this.embeddingTypes}async embedDocuments(e){const t=_C(e,this.batchSize),r=t.map(o=>this.embeddingWithRetry({model:this.model,texts:o,inputType:"search_document",embeddingTypes:this.embeddingTypes})),n=await Promise.all(r),i=[];for(let o=0;o<n.length;o+=1){const s=t[o],{embeddings:u}=n[o];for(let l=0;l<s.length;l+=1)"float"in u&&u.float?i.push(u.float[l]):Array.isArray(u)&&i.push(u[l])}return i}async embedQuery(e){const{embeddings:t}=await this.embeddingWithRetry({model:this.model,texts:[e],inputType:"search_query",embeddingTypes:this.embeddingTypes});if("float"in t&&t.float)return t.float[0];if(Array.isArray(t))return t[0];throw new Error(`Invalid response from Cohere API. Received: ${JSON.stringify(t,null,2)}`)}async embed(e){const{embeddings:t}=await this.embeddingWithRetry(e);if("float"in t&&t.float)return t.float[0];if(Array.isArray(t))return t[0];throw new Error(`Invalid response from Cohere API. Received: ${JSON.stringify(t,null,2)}`)}async embeddingWithRetry(e){return this.caller.call(async()=>{let t;try{t=await this.client.embed(e)}catch(r){throw r.status=r.status??r.statusCode,r}return t})}get lc_secrets(){return{apiKey:"COHERE_API_KEY",api_key:"COHERE_API_KEY"}}get lc_aliases(){return{apiKey:"cohere_api_key",api_key:"cohere_api_key"}}}const Yc="0.5.0";let o4=!1,cp,IH,DH,fR,xH,$H,NH,qH,zH;function oce(a,e={auto:!1}){if(o4)throw new Error(`you must \`import 'groq-sdk/shims/${a.kind}'\` before importing anything else from groq-sdk`);if(cp)throw new Error(`can't \`import 'groq-sdk/shims/${a.kind}'\` after \`import 'groq-sdk/shims/${cp}'\``);o4=e.auto,cp=a.kind,IH=a.fetch,DH=a.FormData,fR=a.File,xH=a.ReadableStream,$H=a.getMultipartRequestOptions,NH=a.getDefaultAgent,qH=a.fileFromPath,zH=a.isFsReadStream}class sce{constructor(e){this.body=e}get[Symbol.toStringTag](){return"MultipartBody"}}function uce({manuallyImported:a}={}){const e=a?"You may need to use polyfills":"Add one of these imports before your first `import  from 'groq-sdk'`:\n- `import 'groq-sdk/shims/node'` (if you're running on Node)\n- `import 'groq-sdk/shims/web'` (otherwise)\n";let t,r,n,i;try{t=fetch,r=Request,n=Response,i=Headers}catch(o){throw new Error(`this environment is missing the following Web Fetch API type: ${o.message}. ${e}`)}return{kind:"web",fetch:t,Request:r,Response:n,Headers:i,FormData:typeof FormData<"u"?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${e}`)}},Blob:typeof Blob<"u"?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${e}`)}},File:typeof File<"u"?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${e}`)}},ReadableStream:typeof ReadableStream<"u"?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${e}`)}},getMultipartRequestOptions:async(o,s)=>({...s,body:new sce(o)}),getDefaultAgent:o=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/groq/groq-typescript#file-uploads")},isFsReadStream:o=>!1}}cp||oce(uce(),{auto:!0});class ks extends Error{}class qt extends ks{constructor(e,t,r,n){super(`${qt.makeMessage(e,t,r)}`),this.status=e,this.headers=n,this.error=t}static makeMessage(e,t,r){const n=t!=null&&t.message?typeof t.message=="string"?t.message:JSON.stringify(t.message):t?JSON.stringify(t):r;return e&&n?`${e} ${n}`:e?`${e} status code (no body)`:n||"(no status code or body)"}static generate(e,t,r,n){if(!e)return new Xb({cause:pR(t)});const i=t;return e===400?new UH(e,i,r,n):e===401?new FH(e,i,r,n):e===403?new LH(e,i,r,n):e===404?new VH(e,i,r,n):e===409?new GH(e,i,r,n):e===422?new kH(e,i,r,n):e===429?new HH(e,i,r,n):e>=500?new WH(e,i,r,n):new qt(e,i,r,n)}}class dR extends qt{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0),this.status=void 0}}class Xb extends qt{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),this.status=void 0,t&&(this.cause=t)}}class BH extends Xb{constructor({message:e}={}){super({message:e??"Request timed out."})}}class UH extends qt{constructor(){super(...arguments),this.status=400}}class FH extends qt{constructor(){super(...arguments),this.status=401}}class LH extends qt{constructor(){super(...arguments),this.status=403}}class VH extends qt{constructor(){super(...arguments),this.status=404}}class GH extends qt{constructor(){super(...arguments),this.status=409}}class kH extends qt{constructor(){super(...arguments),this.status=422}}class HH extends qt{constructor(){super(...arguments),this.status=429}}class WH extends qt{}class lf{constructor(e,t){this.iterator=e,this.controller=t}static fromSSEResponse(e,t){let r=!1;const n=new lce;async function*i(){if(!e.body)throw t.abort(),new ks("Attempted to iterate over a response with no body");const s=new Tc,u=s4(e.body);for await(const l of u)for(const c of s.decode(l)){const f=n.decode(c);f&&(yield f)}for(const l of s.flush()){const c=n.decode(l);c&&(yield c)}}async function*o(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let s=!1;try{for await(const u of i())if(!s){if(u.data.startsWith("[DONE]")){s=!0;continue}if(u.event===null){let l;try{l=JSON.parse(u.data)}catch(c){throw console.error("Could not parse message into JSON:",u.data),console.error("From chunk:",u.raw),c}if(l&&l.error)throw new qt(void 0,l.error,void 0,void 0);yield l}}s=!0}catch(u){if(u instanceof Error&&u.name==="AbortError")return;throw u}finally{s||t.abort()}}return new lf(o,t)}static fromReadableStream(e,t){let r=!1;async function*n(){const o=new Tc,s=s4(e);for await(const u of s)for(const l of o.decode(u))yield l;for(const u of o.flush())yield u}async function*i(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let o=!1;try{for await(const s of n())o||s&&(yield JSON.parse(s));o=!0}catch(s){if(s instanceof Error&&s.name==="AbortError")return;throw s}finally{o||t.abort()}}return new lf(i,t)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],t=[],r=this.iterator(),n=i=>({next:()=>{if(i.length===0){const o=r.next();e.push(o),t.push(o)}return i.shift()}});return[new lf(()=>n(e),this.controller),new lf(()=>n(t),this.controller)]}toReadableStream(){const e=this;let t;const r=new TextEncoder;return new xH({async start(){t=e[Symbol.asyncIterator]()},async pull(n){try{const{value:i,done:o}=await t.next();if(o)return n.close();const s=r.encode(JSON.stringify(i)+`
`);n.enqueue(s)}catch(i){n.error(i)}},async cancel(){var n;await((n=t.return)==null?void 0:n.call(t))}})}}class lce{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const i={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],i}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,r,n]=cce(e,":");return n.startsWith(" ")&&(n=n.substring(1)),t==="event"?this.event=n:t==="data"&&this.data.push(n),null}}class Tc{constructor(){this.buffer=[],this.trailingCR=!1}decode(e){let t=this.decodeText(e);if(this.trailingCR&&(t="\r"+t,this.trailingCR=!1),t.endsWith("\r")&&(this.trailingCR=!0,t=t.slice(0,-1)),!t)return[];const r=Tc.NEWLINE_CHARS.has(t[t.length-1]||"");let n=t.split(Tc.NEWLINE_REGEXP);return n.length===1&&!r?(this.buffer.push(n[0]),[]):(this.buffer.length>0&&(n=[this.buffer.join("")+n[0],...n.slice(1)],this.buffer=[]),r||(this.buffer=[n.pop()||""]),n)}decodeText(e){if(e==null)return"";if(typeof e=="string")return e;if(typeof Buffer<"u"){if(e instanceof Buffer)return e.toString();if(e instanceof Uint8Array)return Buffer.from(e).toString();throw new ks(`Unexpected: received non-Uint8Array (${e.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if(typeof TextDecoder<"u"){if(e instanceof Uint8Array||e instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(e);throw new ks(`Unexpected: received non-Uint8Array/ArrayBuffer (${e.constructor.name}) in a web platform. Please report this error.`)}throw new ks("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){if(!this.buffer.length&&!this.trailingCR)return[];const e=[this.buffer.join("")];return this.buffer=[],this.trailingCR=!1,e}}Tc.NEWLINE_CHARS=new Set([`
`,"\r","\v","\f","","","","","\u2028","\u2029"]);Tc.NEWLINE_REGEXP=/\r\n|[\n\r\x0b\x0c\x1c\x1d\x1e\x85\u2028\u2029]/g;function cce(a,e){const t=a.indexOf(e);return t!==-1?[a.substring(0,t),e,a.substring(t+e.length)]:[a,"",""]}function s4(a){if(a[Symbol.asyncIterator])return a;const e=a.getReader();return{async next(){try{const t=await e.read();return t!=null&&t.done&&e.releaseLock(),t}catch(t){throw e.releaseLock(),t}},async return(){const t=e.cancel();return e.releaseLock(),await t,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}const KH=a=>a!=null&&typeof a=="object"&&typeof a.url=="string"&&typeof a.blob=="function",JH=a=>a!=null&&typeof a=="object"&&typeof a.name=="string"&&typeof a.lastModified=="number"&&rP(a),rP=a=>a!=null&&typeof a=="object"&&typeof a.size=="number"&&typeof a.type=="string"&&typeof a.text=="function"&&typeof a.slice=="function"&&typeof a.arrayBuffer=="function",fce=a=>JH(a)||KH(a)||zH(a);async function XH(a,e,t){var n;if(a=await a,t??(t=JH(a)?{lastModified:a.lastModified,type:a.type}:{}),KH(a)){const i=await a.blob();return e||(e=new URL(a.url).pathname.split(/[\\/]/).pop()??"unknown_file"),new fR([i],e,t)}const r=await dce(a);if(e||(e=pce(a)??"unknown_file"),!t.type){const i=(n=r[0])==null?void 0:n.type;typeof i=="string"&&(t={...t,type:i})}return new fR(r,e,t)}async function dce(a){var t;let e=[];if(typeof a=="string"||ArrayBuffer.isView(a)||a instanceof ArrayBuffer)e.push(a);else if(rP(a))e.push(await a.arrayBuffer());else if(_ce(a))for await(const r of a)e.push(r);else throw new Error(`Unexpected data type: ${typeof a}; constructor: ${(t=a==null?void 0:a.constructor)==null?void 0:t.name}; props: ${hce(a)}`);return e}function hce(a){return`[${Object.getOwnPropertyNames(a).map(t=>`"${t}"`).join(", ")}]`}function pce(a){var e;return cE(a.name)||cE(a.filename)||((e=cE(a.path))==null?void 0:e.split(/[\\/]/).pop())}const cE=a=>{if(typeof a=="string")return a;if(typeof Buffer<"u"&&a instanceof Buffer)return String(a)},_ce=a=>a!=null&&typeof a=="object"&&typeof a[Symbol.asyncIterator]=="function",u4=a=>a&&typeof a=="object"&&a.body&&a[Symbol.toStringTag]==="MultipartBody",ZH=async a=>{const e=await yce(a.body);return $H(e,a)},yce=async a=>{const e=new DH;return await Promise.all(Object.entries(a||{}).map(([t,r])=>hR(e,t,r))),e},hR=async(a,e,t)=>{if(t!==void 0){if(t==null)throw new TypeError(`Received null for "${e}"; to pass null in FormData, you must use the string 'null'`);if(typeof t=="string"||typeof t=="number"||typeof t=="boolean")a.append(e,String(t));else if(fce(t)){const r=await XH(t);a.append(e,r)}else if(Array.isArray(t))await Promise.all(t.map(r=>hR(a,e+"[]",r)));else if(typeof t=="object")await Promise.all(Object.entries(t).map(([r,n])=>hR(a,`${e}[${r}]`,n)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${t} instead`)}};var mf={};async function QH(a){const{response:e}=a;if(a.options.stream)return gf("response",e.status,e.url,e.headers,e.body),a.options.__streamClass?a.options.__streamClass.fromSSEResponse(e,a.controller):lf.fromSSEResponse(e,a.controller);if(e.status===204)return null;if(a.options.__binaryResponse)return e;const t=e.headers.get("content-type");if((t==null?void 0:t.includes("application/json"))||(t==null?void 0:t.includes("application/vnd.api+json"))){const i=await e.json();return gf("response",e.status,e.url,e.headers,i),i}const n=await e.text();return gf("response",e.status,e.url,e.headers,n),n}class Zb extends Promise{constructor(e,t=QH){super(r=>{r(null)}),this.responsePromise=e,this.parseResponse=t}_thenUnwrap(e){return new Zb(this.responsePromise,async t=>e(await this.parseResponse(t)))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}class bce{constructor({baseURL:e,maxRetries:t=2,timeout:r=6e4,httpAgent:n,fetch:i}){this.baseURL=e,this.maxRetries=fE("maxRetries",t),this.timeout=fE("timeout",r),this.httpAgent=n,this.fetch=i??IH}authHeaders(e){return{}}defaultHeaders(e){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...Oce(),...this.authHeaders(e)}}validateHeaders(e,t){}defaultIdempotencyKey(){return`stainless-node-retry-${Tce()}`}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,r){return this.request(Promise.resolve(r).then(async n=>{const i=n&&rP(n==null?void 0:n.body)?new DataView(await n.body.arrayBuffer()):(n==null?void 0:n.body)instanceof DataView?n.body:(n==null?void 0:n.body)instanceof ArrayBuffer?new DataView(n.body):n&&ArrayBuffer.isView(n==null?void 0:n.body)?new DataView(n.body.buffer):n==null?void 0:n.body;return{method:e,path:t,...n,body:i}}))}getAPIList(e,t,r){return this.requestAPIList(t,{method:"get",path:e,...r})}calculateContentLength(e){if(typeof e=="string"){if(typeof Buffer<"u")return Buffer.byteLength(e,"utf8").toString();if(typeof TextEncoder<"u")return new TextEncoder().encode(e).length.toString()}else if(ArrayBuffer.isView(e))return e.byteLength.toString();return null}buildRequest(e){var y;const{method:t,path:r,query:n,headers:i={}}=e,o=ArrayBuffer.isView(e.body)||e.__binaryRequest&&typeof e.body=="string"?e.body:u4(e.body)?e.body.body:e.body?JSON.stringify(e.body,null,2):null,s=this.calculateContentLength(o),u=this.buildURL(r,n);"timeout"in e&&fE("timeout",e.timeout);const l=e.timeout??this.timeout,c=e.httpAgent??this.httpAgent??NH(u),f=l+1e3;typeof((y=c==null?void 0:c.options)==null?void 0:y.timeout)=="number"&&f>(c.options.timeout??0)&&(c.options.timeout=f),this.idempotencyHeader&&t!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),i[this.idempotencyHeader]=e.idempotencyKey);const p=this.buildHeaders({options:e,headers:i,contentLength:s});return{req:{method:t,...o&&{body:o},headers:p,...c&&{agent:c},signal:e.signal??null},url:u,timeout:l}}buildHeaders({options:e,headers:t,contentLength:r}){const n={};r&&(n["content-length"]=r);const i=this.defaultHeaders(e);return h4(n,i),h4(n,t),u4(e.body)&&cp!=="node"&&delete n["content-type"],this.validateHeaders(n,t),n}async prepareOptions(e){}async prepareRequest(e,{url:t,options:r}){}parseHeaders(e){return e?Symbol.iterator in e?Object.fromEntries(Array.from(e).map(t=>[...t])):{...e}:{}}makeStatusError(e,t,r,n){return qt.generate(e,t,r,n)}request(e,t=null){return new Zb(this.makeRequest(e,t))}async makeRequest(e,t){var c,f;const r=await e;t==null&&(t=r.maxRetries??this.maxRetries),await this.prepareOptions(r);const{req:n,url:i,timeout:o}=this.buildRequest(r);if(await this.prepareRequest(n,{url:i,options:r}),gf("request",i,r,n.headers),(c=r.signal)!=null&&c.aborted)throw new dR;const s=new AbortController,u=await this.fetchWithTimeout(i,n,o,s).catch(pR);if(u instanceof Error){if((f=r.signal)!=null&&f.aborted)throw new dR;if(t)return this.retryRequest(r,t);throw u.name==="AbortError"?new BH:new Xb({cause:u})}const l=gce(u.headers);if(!u.ok){if(t&&this.shouldRetry(u)){const m=`retrying, ${t} attempts remaining`;return gf(`response (error; ${m})`,u.status,i,l),this.retryRequest(r,t,l)}const p=await u.text().catch(m=>pR(m).message),h=Sce(p),y=h?void 0:p;throw gf(`response (error; ${t?"(error; no more retries left)":"(error; not retryable)"})`,u.status,i,l,y),this.makeStatusError(u.status,h,y,l)}return{response:u,options:r,controller:s}}requestAPIList(e,t){const r=this.makeRequest(t,null);return new mce(this,r,e)}buildURL(e,t){const r=Rce(e)?new URL(e):new URL(this.baseURL+(this.baseURL.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),n=this.defaultQuery();return Pce(n)||(t={...n,...t}),typeof t=="object"&&t&&!Array.isArray(t)&&(r.search=this.stringifyQuery(t)),r.toString()}stringifyQuery(e){return Object.entries(e).filter(([t,r])=>typeof r<"u").map(([t,r])=>{if(typeof r=="string"||typeof r=="number"||typeof r=="boolean")return`${encodeURIComponent(t)}=${encodeURIComponent(r)}`;if(r===null)return`${encodeURIComponent(t)}=`;throw new ks(`Cannot stringify type ${typeof r}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}async fetchWithTimeout(e,t,r,n){const{signal:i,...o}=t||{};i&&i.addEventListener("abort",()=>n.abort());const s=setTimeout(()=>n.abort(),r);return this.getRequestClient().fetch.call(void 0,e,{signal:n.signal,...o}).finally(()=>{clearTimeout(s)})}getRequestClient(){return{fetch:this.fetch}}shouldRetry(e){const t=e.headers.get("x-should-retry");return t==="true"?!0:t==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,t,r){let n;const i=r==null?void 0:r["retry-after-ms"];if(i){const s=parseFloat(i);Number.isNaN(s)||(n=s)}const o=r==null?void 0:r["retry-after"];if(o&&!n){const s=parseFloat(o);Number.isNaN(s)?n=Date.parse(o)-Date.now():n=s*1e3}if(!(n&&0<=n&&n<60*1e3)){const s=e.maxRetries??this.maxRetries;n=this.calculateDefaultRetryTimeoutMillis(t,s)}return await Cce(n),this.makeRequest(e,t-1)}calculateDefaultRetryTimeoutMillis(e,t){const i=t-e,o=Math.min(.5*Math.pow(2,i),8),s=1-Math.random()*.25;return o*s*1e3}getUserAgent(){return`${this.constructor.name}/JS ${Yc}`}}class mce extends Zb{constructor(e,t,r){super(t,async n=>new r(e,n.response,await QH(n),n.options))}async*[Symbol.asyncIterator](){const e=await this;for await(const t of e)yield t}}const gce=a=>new Proxy(Object.fromEntries(a.entries()),{get(e,t){const r=t.toString();return e[r.toLowerCase()]||e[r]}}),vce=()=>{var e;if(typeof Deno<"u"&&Deno.build!=null)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Yc,"X-Stainless-OS":c4(Deno.build.os),"X-Stainless-Arch":l4(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:((e=Deno.version)==null?void 0:e.deno)??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Yc,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":process.version};if(Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Yc,"X-Stainless-OS":c4(process.platform),"X-Stainless-Arch":l4(process.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":process.version};const a=wce();return a?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Yc,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${a.browser}`,"X-Stainless-Runtime-Version":a.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Yc,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function wce(){if(typeof navigator>"u"||!navigator)return null;const a=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:t}of a){const r=t.exec(navigator.userAgent);if(r){const n=r[1]||0,i=r[2]||0,o=r[3]||0;return{browser:e,version:`${n}.${i}.${o}`}}}return null}const l4=a=>a==="x32"?"x32":a==="x86_64"||a==="x64"?"x64":a==="arm"?"arm":a==="aarch64"||a==="arm64"?"arm64":a?`other:${a}`:"unknown",c4=a=>(a=a.toLowerCase(),a.includes("ios")?"iOS":a==="android"?"Android":a==="darwin"?"MacOS":a==="win32"?"Windows":a==="freebsd"?"FreeBSD":a==="openbsd"?"OpenBSD":a==="linux"?"Linux":a?`Other:${a}`:"Unknown");let f4;const Oce=()=>f4??(f4=vce()),Sce=a=>{try{return JSON.parse(a)}catch{return}},Ece=new RegExp("^(?:[a-z]+:)?//","i"),Rce=a=>Ece.test(a),Cce=a=>new Promise(e=>setTimeout(e,a)),fE=(a,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new ks(`${a} must be an integer`);if(e<0)throw new ks(`${a} must be a positive integer`);return e},pR=a=>a instanceof Error?a:new Error(a),d4=a=>{var e,t,r,n;if(typeof process<"u")return((e=mf==null?void 0:mf[a])==null?void 0:e.trim())??void 0;if(typeof Deno<"u")return(n=(r=(t=Deno.env)==null?void 0:t.get)==null?void 0:r.call(t,a))==null?void 0:n.trim()};function Pce(a){if(!a)return!0;for(const e in a)return!1;return!0}function jce(a,e){return Object.prototype.hasOwnProperty.call(a,e)}function h4(a,e){for(const t in e){if(!jce(e,t))continue;const r=t.toLowerCase();if(!r)continue;const n=e[t];n===null?delete a[r]:n!==void 0&&(a[r]=n)}}function gf(a,...e){typeof process<"u"&&(mf==null?void 0:mf.DEBUG)==="true"&&console.log(`Groq:DEBUG:${a}`,...e)}const Tce=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,a=>{const e=Math.random()*16|0;return(a==="x"?e:e&3|8).toString(16)}),Mce=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u";class sl{constructor(e){this._client=e}}class Xy extends sl{create(e,t){return this._client.post("/openai/v1/audio/transcriptions",ZH({body:e,...t}))}}Xy||(Xy={});class Zy extends sl{create(e,t){return this._client.post("/openai/v1/audio/translations",ZH({body:e,...t}))}}Zy||(Zy={});class Qy extends sl{constructor(){super(...arguments),this.transcriptions=new Xy(this._client),this.translations=new Zy(this._client)}}(function(a){a.Transcriptions=Xy,a.Translations=Zy})(Qy||(Qy={}));let Yy=class extends sl{create(e,t){return this._client.post("/openai/v1/chat/completions",{body:e,...t,stream:e.stream??!1})}};Yy||(Yy={});class eb extends sl{constructor(){super(...arguments),this.completions=new Yy(this._client)}}(function(a){a.Completions=Yy})(eb||(eb={}));class tb extends sl{}tb||(tb={});class rb extends sl{create(e,t){return this._client.post("/openai/v1/embeddings",{body:e,...t})}}rb||(rb={});class nb extends sl{retrieve(e,t){return this._client.get(`/openai/v1/models/${e}`,t)}list(e){return this._client.get("/openai/v1/models",e)}delete(e,t){return this._client.delete(`/openai/v1/models/${e}`,t)}}nb||(nb={});var YH;class pt extends bce{constructor({baseURL:e=d4("GROQ_BASE_URL"),apiKey:t=d4("GROQ_API_KEY"),...r}={}){if(t===void 0)throw new ks("The GROQ_API_KEY environment variable is missing or empty; either provide it, or instantiate the Groq client with an apiKey option, like new Groq({ apiKey: 'My API Key' }).");const n={apiKey:t,...r,baseURL:e||"https://api.groq.com"};if(!n.dangerouslyAllowBrowser&&Mce())throw new ks(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new Groq({ apiKey, dangerouslyAllowBrowser: true })`);super({baseURL:n.baseURL,timeout:n.timeout??6e4,httpAgent:n.httpAgent,maxRetries:n.maxRetries,fetch:n.fetch}),this.completions=new tb(this),this.chat=new eb(this),this.embeddings=new rb(this),this.audio=new Qy(this),this.models=new nb(this),this._options=n,this.apiKey=t}defaultQuery(){return this._options.defaultQuery}defaultHeaders(e){return{...super.defaultHeaders(e),...this._options.defaultHeaders}}authHeaders(e){return{Authorization:`Bearer ${this.apiKey}`}}}YH=pt;pt.Groq=YH;pt.GroqError=ks;pt.APIError=qt;pt.APIConnectionError=Xb;pt.APIConnectionTimeoutError=BH;pt.APIUserAbortError=dR;pt.NotFoundError=VH;pt.ConflictError=GH;pt.RateLimitError=HH;pt.BadRequestError=UH;pt.AuthenticationError=FH;pt.InternalServerError=WH;pt.PermissionDeniedError=LH;pt.UnprocessableEntityError=kH;pt.toFile=XH;pt.fileFromPath=qH;(function(a){a.Completions=tb,a.Chat=eb,a.Embeddings=rb,a.Audio=Qy,a.Models=nb})(pt||(pt={}));function Ace(a){const e=a._getType();switch(e){case"system":return"system";case"ai":return"assistant";case"human":return"user";case"function":return"function";case"tool":return"tool";default:throw new Error(`Unknown message type: ${e}`)}}function p4(a){return a.map(e=>{var r;if(typeof e.content!="string")throw new Error("Non string message content not supported");const t={role:Ace(e),content:e.content,name:e.name,function_call:e.additional_kwargs.function_call,tool_calls:e.additional_kwargs.tool_calls,tool_call_id:e.tool_call_id};return ru(e)&&((r=e.tool_calls)!=null&&r.length)?t.tool_calls=e.tool_calls.map(j3):(e.additional_kwargs.tool_calls!=null&&(t.tool_calls=e.additional_kwargs.tool_calls),e.tool_call_id!=null&&(t.tool_call_id=e.tool_call_id)),t})}function Ice(a,e){const t=a.tool_calls;switch(a.role){case"assistant":{const r=[],n=[];for(const i of t??[])try{r.push(hC(i,{returnId:!0}))}catch(o){n.push(T3(i,o.message))}return new Hs({content:a.content||"",additional_kwargs:{tool_calls:t},tool_calls:r,invalid_tool_calls:n,usage_metadata:e})}default:return new Ac(a.content||"",a.role??"unknown")}}function Dce(a,e){if(a!=null&&a.length)return a.map(t=>{var r,n;return{id:t.id,name:(r=t.function)==null?void 0:r.name,args:(n=t.function)==null?void 0:n.arguments,type:"tool_call_chunk",index:e}})}function xce(a,e,t){const{role:r}=a,n=a.content??"";let i;a.function_call?i={function_call:a.function_call}:a.tool_calls?i={tool_calls:a.tool_calls}:i={};let o,s;if(t!=null&&t.usage&&(o={input_tokens:t.usage.prompt_tokens,output_tokens:t.usage.completion_tokens,total_tokens:t.usage.total_tokens},s=t.id),r==="user")return{message:new Up({content:n})};if(r==="assistant"){const u=Dce(a.tool_calls,e);return{message:new it({content:n,additional_kwargs:i,tool_call_chunks:u?u.map(l=>({type:l.type,args:l.args,index:l.index})):void 0,usage_metadata:o,id:s}),toolCallData:u?u.map(l=>({id:l.id??"",name:l.name??"",index:l.index??e,type:"tool_call_chunk"})):void 0}}else return r==="system"?{message:new wf({content:n})}:{message:new Bp({content:n,role:r})}}class $ce extends Ar{static lc_name(){return"ChatGroq"}_llmType(){return"groq"}get lc_secrets(){return{apiKey:"GROQ_API_KEY"}}constructor(e){super(e??{}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","chat_models","groq"]}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"modelName",{enumerable:!0,configurable:!0,writable:!0,value:"mixtral-8x7b-32768"}),Object.defineProperty(this,"model",{enumerable:!0,configurable:!0,writable:!0,value:"mixtral-8x7b-32768"}),Object.defineProperty(this,"temperature",{enumerable:!0,configurable:!0,writable:!0,value:.7}),Object.defineProperty(this,"stop",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stopSequences",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxTokens",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"streaming",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0});const t=(e==null?void 0:e.apiKey)||We("GROQ_API_KEY");if(!t)throw new Error('Groq API key not found. Please set the GROQ_API_KEY environment variable or provide the key into "apiKey"');const r={"User-Agent":"langchainjs",...(e==null?void 0:e.defaultHeaders)??{}};this.client=new pt({apiKey:t,dangerouslyAllowBrowser:!0,baseURL:e==null?void 0:e.baseUrl,timeout:e==null?void 0:e.timeout,httpAgent:e==null?void 0:e.httpAgent,fetch:e==null?void 0:e.fetch,maxRetries:0,defaultHeaders:r,defaultQuery:e==null?void 0:e.defaultQuery}),this.apiKey=t,this.temperature=(e==null?void 0:e.temperature)??this.temperature,this.modelName=(e==null?void 0:e.model)??(e==null?void 0:e.modelName)??this.model,this.model=this.modelName,this.streaming=(e==null?void 0:e.streaming)??this.streaming,this.stop=(e==null?void 0:e.stopSequences)??(typeof(e==null?void 0:e.stop)=="string"?[e.stop]:e==null?void 0:e.stop)??[],this.stopSequences=this.stop,this.maxTokens=e==null?void 0:e.maxTokens}getLsParams(e){const t=this.invocationParams(e);return{ls_provider:"groq",ls_model_name:this.model,ls_model_type:"chat",ls_temperature:t.temperature??this.temperature,ls_max_tokens:t.max_tokens??this.maxTokens,ls_stop:e.stop}}async completionWithRetry(e,t){return this.caller.call(async()=>this.client.chat.completions.create(e,t))}invocationParams(e){const t=super.invocationParams(e);return e.tool_choice!==void 0&&(t.tool_choice=e.tool_choice),e.tools!==void 0&&(t.tools=e.tools),e.response_format!==void 0&&(t.response_format=e.response_format),{...t,stop:e.stop??this.stopSequences,model:this.model,temperature:this.temperature,max_tokens:this.maxTokens}}bindTools(e,t){return this.bind({tools:e.map(r=>Q7(r)),...t})}async*_streamResponseChunks(e,t,r){var c,f;const n=this.invocationParams(t),i=p4(e),o=await this.completionWithRetry({...n,messages:i,stream:!0},{signal:t==null?void 0:t.signal,headers:t==null?void 0:t.headers});let s="";const u=[];let l;for await(const p of o){l=p;const h=p==null?void 0:p.choices[0];if(!h)continue;(c=h.delta)!=null&&c.role&&(s=h.delta.role);const{message:y,toolCallData:d}=xce({...h.delta,role:s},h.index,p.x_groq);if(d){const m=d.filter(b=>u.every(g=>g.id!==b.id));u.push(...m),yield new rr({message:new it({content:"",tool_call_chunks:m}),text:""})}const _=new rr({message:y,text:h.delta.content??"",generationInfo:{finishReason:h.finish_reason}});yield _,r==null||r.handleLLMNewToken(_.text??"")}if(l&&("choices"in l&&delete l.choices,yield new rr({message:new it({content:"",response_metadata:l}),text:""})),(f=t.signal)!=null&&f.aborted)throw new Error("AbortError")}async _generate(e,t,r){var n;if(this.streaming){const i={},o=this._streamResponseChunks(e,t,r),s={};for await(const l of o){const c=((n=l.generationInfo)==null?void 0:n.completion)??0;s[c]===void 0?s[c]=l:s[c]=s[c].concat(l)}return{generations:Object.entries(s).sort(([l],[c])=>parseInt(l,10)-parseInt(c,10)).map(([l,c])=>c),llmOutput:{estimatedTokenUsage:i}}}else return this._generateNonStreaming(e,t,r)}async _generateNonStreaming(e,t,r){var l;const n={},i=this.invocationParams(t),o=p4(e),s=await this.completionWithRetry({...i,stream:!1,messages:o},{signal:t==null?void 0:t.signal,headers:t==null?void 0:t.headers});if("usage"in s&&s.usage){const{completion_tokens:c,prompt_tokens:f,total_tokens:p}=s.usage;c&&(n.completionTokens=(n.completionTokens??0)+c),f&&(n.promptTokens=(n.promptTokens??0)+f),p&&(n.totalTokens=(n.totalTokens??0)+p)}const u=[];if("choices"in s&&s.choices)for(const c of s.choices){const f=((l=c.message)==null?void 0:l.content)??"";let p;n.totalTokens!==void 0&&(p={input_tokens:n.promptTokens??0,output_tokens:n.completionTokens??0,total_tokens:n.totalTokens});const h={text:f,message:Ice(c.message??{role:"assistant"},p)};h.generationInfo={...c.finish_reason?{finish_reason:c.finish_reason}:{},...c.logprobs?{logprobs:c.logprobs}:{}},u.push(h)}return{generations:u,llmOutput:{tokenUsage:n}}}withStructuredOutput(e,t){const r=e,n=t==null?void 0:t.name,i=t==null?void 0:t.method,o=t==null?void 0:t.includeRaw;let s=n??"extract",u,l;if(i==="jsonMode")l=this.bind({response_format:{type:"json_object"}}),jf(r)?u=HE.fromZodSchema(r):u=new WE;else if(jf(r)){const h=au(r);l=this.bind({tools:[{type:"function",function:{name:s,description:h.description,parameters:h}}],tool_choice:{type:"function",function:{name:s}}}),u=new Vy({returnSingle:!0,keyName:s,zodSchema:r})}else{let h;typeof r.name=="string"&&typeof r.parameters=="object"&&r.parameters!=null?(h=r,s=r.name):(s=r.title??s,h={name:s,description:r.description??"",parameters:r}),l=this.bind({tools:[{type:"function",function:h}],tool_choice:{type:"function",function:{name:s}}}),u=new Vy({returnSingle:!0,keyName:s})}if(!o)return l.pipe(u).withConfig({runName:"ChatGroqStructuredOutput"});const c=ou.assign({parsed:(h,y)=>u.invoke(h.raw,y)}),f=ou.assign({parsed:()=>null}),p=c.withFallbacks({fallbacks:[f]});return mr.from([{raw:l},p]).withConfig({runName:"ChatGroqStructuredOutput"})}}var $s={},_4;function Nce(){if(_4)return $s;_4=1,Object.defineProperty($s,"__esModule",{value:!0}),$s.HTTPClient=void 0,$s.matchContentType=r,$s.matchStatusCode=i,$s.matchResponse=o,$s.isConnectionError=s,$s.isTimeoutError=u,$s.isAbortError=l;const a=(c,f)=>f==null?fetch(c):fetch(c,f);class e{constructor(f={}){this.options=f,this.requestHooks=[],this.requestErrorHooks=[],this.responseHooks=[],this.fetcher=f.fetcher||a}async request(f){let p=f;for(const h of this.requestHooks){const y=await h(p);y&&(p=y)}try{const h=await this.fetcher(p);for(const y of this.responseHooks)await y(h,p);return h}catch(h){for(const y of this.requestErrorHooks)await y(h,p);throw h}}addHook(...f){if(f[0]==="beforeRequest")this.requestHooks.push(f[1]);else if(f[0]==="requestError")this.requestErrorHooks.push(f[1]);else if(f[0]==="response")this.responseHooks.push(f[1]);else throw new Error(`Invalid hook type: ${f[0]}`);return this}removeHook(...f){let p;if(f[0]==="beforeRequest")p=this.requestHooks;else if(f[0]==="requestError")p=this.requestErrorHooks;else if(f[0]==="response")p=this.responseHooks;else throw new Error(`Invalid hook type: ${f[0]}`);const h=p.findIndex(y=>y===f[1]);return h>=0&&p.splice(h,1),this}clone(){const f=new e(this.options);return f.requestHooks=this.requestHooks.slice(),f.requestErrorHooks=this.requestErrorHooks.slice(),f.responseHooks=this.responseHooks.slice(),f}}$s.HTTPClient=e;const t=/\s*;\s*/g;function r(c,f){var S;if(f==="*")return!0;let p=((S=c.headers.get("content-type"))==null?void 0:S.trim())||"application/octet-stream";p=p.toLowerCase();const h=f.toLowerCase().trim().split(t),[y="",...d]=h;if(y.split("/").length!==2)return!1;const _=p.split(t),[m="",...b]=_,[g="",v=""]=m.split("/");if(!g||!v||y!=="*/*"&&m!==y&&`${g}/*`!==y&&`*/${v}`!==y||b.length<d.length)return!1;const w=new Set(b);for(const R of d)if(!w.has(R))return!1;return!0}const n=new RegExp("^[0-9]xx$","i");function i(c,f){const p=`${c.status}`,h=Array.isArray(f)?f:[f];return h.length?h.some(y=>{const d=`${y}`;if(d==="default")return!0;if(!n.test(`${d}`))return d===p;const _=d.charAt(0);if(!_)throw new Error("Invalid status code range");const m=p.charAt(0);if(!m)throw new Error(`Invalid response status code: ${p}`);return m===_}):!1}function o(c,f,p){return i(c,f)&&r(c,p)}function s(c){if(typeof c!="object"||c==null)return!1;const f=c instanceof TypeError&&c.message.toLowerCase().startsWith("failed to fetch"),p=c instanceof TypeError&&c.message.toLowerCase().startsWith("fetch failed"),h="name"in c&&c.name==="ConnectionError",y="code"in c&&typeof c.code=="string"&&c.code.toLowerCase()==="econnreset";return f||p||y||h}function u(c){if(typeof c!="object"||c==null)return!1;const f="name"in c&&c.name==="TimeoutError",p="code"in c&&c.code===23,h="code"in c&&typeof c.code=="string"&&c.code.toLowerCase()==="econnaborted";return f||p||h}function l(c){if(typeof c!="object"||c==null)return!1;const f="name"in c&&c.name==="AbortError",p="code"in c&&c.code===20,h="code"in c&&typeof c.code=="string"&&c.code.toLowerCase()==="econnaborted";return f||p||h}return $s}var qce=Nce();class zce extends z3{static lc_name(){return"MistralAI"}constructor(e){super(e??{}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","llms","mistralai"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"model",{enumerable:!0,configurable:!0,writable:!0,value:"codestral-latest"}),Object.defineProperty(this,"temperature",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"topP",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxTokens",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"randomSeed",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"streaming",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"batchSize",{enumerable:!0,configurable:!0,writable:!0,value:20}),Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"endpoint",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"serverURL",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxRetries",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxConcurrency",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"beforeRequestHooks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"requestErrorHooks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"responseHooks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"httpClient",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.model=(e==null?void 0:e.model)??this.model,this.temperature=(e==null?void 0:e.temperature)??this.temperature,this.topP=(e==null?void 0:e.topP)??this.topP,this.maxTokens=(e==null?void 0:e.maxTokens)??this.maxTokens,this.randomSeed=(e==null?void 0:e.randomSeed)??this.randomSeed,this.batchSize=(e==null?void 0:e.batchSize)??this.batchSize,this.streaming=(e==null?void 0:e.streaming)??this.streaming,this.serverURL=(e==null?void 0:e.serverURL)??this.serverURL,this.maxRetries=e==null?void 0:e.maxRetries,this.maxConcurrency=e==null?void 0:e.maxConcurrency,this.beforeRequestHooks=(e==null?void 0:e.beforeRequestHooks)??this.beforeRequestHooks,this.requestErrorHooks=(e==null?void 0:e.requestErrorHooks)??this.requestErrorHooks,this.responseHooks=(e==null?void 0:e.responseHooks)??this.responseHooks,this.httpClient=(e==null?void 0:e.httpClient)??this.httpClient;const t=(e==null?void 0:e.apiKey)??We("MISTRAL_API_KEY");if(!t)throw new Error(`MistralAI requires an API key to be set.
Either provide one via the "apiKey" field in the constructor, or set the "MISTRAL_API_KEY" environment variable.`);this.apiKey=t,this.addAllHooksToHttpClient()}get lc_secrets(){return{apiKey:"MISTRAL_API_KEY"}}get lc_aliases(){return{apiKey:"mistral_api_key"}}_llmType(){return"mistralai"}invocationParams(e){return{model:this.model,suffix:e.suffix,temperature:this.temperature,maxTokens:this.maxTokens,topP:this.topP,randomSeed:this.randomSeed,stop:e.stop}}async _call(e,t){var o;const r={...this.invocationParams(t),prompt:e},n=await this.completionWithRetry(r,t,!1);let i=((o=n==null?void 0:n.choices)==null?void 0:o[0].message.content)??"";return Array.isArray(i)&&(i=i[0].type==="text"?i[0].text:""),i}async _generate(e,t,r){const n=_C(e,this.batchSize),i=[],o=this.invocationParams(t);for(let u=0;u<n.length;u+=1){const l=await(async()=>{var c;if(this.streaming){const f=[];for(let p=0;p<n[u].length;p+=1){const h=[];let y;const d=await this.completionWithRetry({...o,prompt:n[u][p]},t,!0);for await(const{data:_}of d){y||(y={id:_.id,object:"chat.completion",created:_.created,model:_.model});for(const m of _.choices){let b=m.delta.content??"";if(Array.isArray(b)){let g="";for(const v of b)if(v.type==="text")g+=v.text;else if(v.type==="image_url"){const w=typeof v.imageUrl=="string"?v.imageUrl:v.imageUrl.url;g+=w}b=g}if(!h[m.index])h[m.index]={index:m.index,message:{role:"assistant",content:b,toolCalls:null},finishReason:m.finishReason??"length"};else{const g=h[m.index];g.message.content+=b,g.finishReason=m.finishReason??"length"}r==null||r.handleLLMNewToken(b,{prompt:m.index,completion:m.index})}}if((c=t.signal)!=null&&c.aborted)throw new Error("AbortError");f.push({...y,choices:h})}return f}else{const f=[];for(let p=0;p<n[u].length;p+=1){const h=await this.completionWithRetry({...o,prompt:n[u][p]},t,!1);f.push(h)}return f}})();i.push(...l.map(c=>c.choices??[]))}return{generations:i.map(u=>u.map(l=>{var f;let c=((f=l.message)==null?void 0:f.content)??"";return Array.isArray(c)&&(c=c[0].type==="text"?c[0].text:""),{text:c,generationInfo:{finishReason:l.finishReason}}}))}}async completionWithRetry(e,t,r){const{Mistral:n}=await this.imports(),i=new Vp({maxConcurrency:t.maxConcurrency||this.maxConcurrency,maxRetries:this.maxRetries}),o=new n({apiKey:this.apiKey,serverURL:this.serverURL,timeoutMs:t.timeout,...this.httpClient?{httpClient:this.httpClient}:{}});return i.callWithOptions({signal:t.signal},async()=>{var s,u,l;try{let c;return r?c=await o.fim.stream(e):c=await o.fim.complete(e),c}catch(c){throw((s=c.message)!=null&&s.includes("status: 400")||(u=c.message)!=null&&u.toLowerCase().includes("status 400")||(l=c.message)!=null&&l.includes("validation failed"))&&(c.status=400),c}})}async*_streamResponseChunks(e,t,r){var o;const n={...this.invocationParams(t),prompt:e},i=await this.completionWithRetry(n,t,!0);for await(const s of i){const{data:u}=s,l=u==null?void 0:u.choices[0];if(!l)continue;let c=l.delta.content??"";Array.isArray(c)&&(c=c[0].type==="text"?c[0].text:"");const f=new Ru({text:c,generationInfo:{finishReason:l.finishReason,tokenUsage:u.usage}});yield f,r==null||r.handleLLMNewToken(f.text??"")}if((o=t.signal)!=null&&o.aborted)throw new Error("AbortError")}addAllHooksToHttpClient(){var e,t,r;try{if(this.removeAllHooksFromHttpClient(),[this.beforeRequestHooks,this.requestErrorHooks,this.responseHooks].some(i=>i&&i.length>0)&&!this.httpClient&&(this.httpClient=new qce.HTTPClient),this.beforeRequestHooks)for(const i of this.beforeRequestHooks)(e=this.httpClient)==null||e.addHook("beforeRequest",i);if(this.requestErrorHooks)for(const i of this.requestErrorHooks)(t=this.httpClient)==null||t.addHook("requestError",i);if(this.responseHooks)for(const i of this.responseHooks)(r=this.httpClient)==null||r.addHook("response",i)}catch{throw new Error("Error in adding all hooks")}}removeAllHooksFromHttpClient(){var e,t,r;try{if(this.beforeRequestHooks)for(const n of this.beforeRequestHooks)(e=this.httpClient)==null||e.removeHook("beforeRequest",n);if(this.requestErrorHooks)for(const n of this.requestErrorHooks)(t=this.httpClient)==null||t.removeHook("requestError",n);if(this.responseHooks)for(const n of this.responseHooks)(r=this.httpClient)==null||r.removeHook("response",n)}catch{throw new Error("Error in removing hooks")}}removeHookFromHttpClient(e){var t,r,n;try{(t=this.httpClient)==null||t.removeHook("beforeRequest",e),(r=this.httpClient)==null||r.removeHook("requestError",e),(n=this.httpClient)==null||n.removeHook("response",e)}catch{throw new Error("Error in removing hook")}}async imports(){const{Mistral:e}=await Lu(async()=>{const{Mistral:t}=await import("./index3.js").then(r=>r.i);return{Mistral:t}},[],import.meta.url);return{Mistral:e}}}var Bce=Object.defineProperty,Uce=(a,e)=>{for(var t in e)Bce(a,t,{get:e[t],enumerable:!0})},Fce={};Uce(Fce,{audioClassification:()=>Xce,audioToAudio:()=>Yce,automaticSpeechRecognition:()=>Zce,chatCompletion:()=>mfe,chatCompletionStream:()=>gfe,documentQuestionAnswering:()=>vfe,featureExtraction:()=>sfe,fillMask:()=>ufe,imageClassification:()=>efe,imageSegmentation:()=>tfe,imageToImage:()=>afe,imageToText:()=>rfe,objectDetection:()=>nfe,questionAnswering:()=>lfe,request:()=>Ye,sentenceSimilarity:()=>cfe,streamingRequest:()=>Qb,summarization:()=>ffe,tableQuestionAnswering:()=>dfe,tabularClassification:()=>Sfe,tabularRegression:()=>Ofe,textClassification:()=>hfe,textGeneration:()=>n9,textGenerationStream:()=>pfe,textToImage:()=>ife,textToSpeech:()=>Qce,tokenClassification:()=>_fe,translation:()=>yfe,visualQuestionAnswering:()=>wfe,zeroShotClassification:()=>bfe,zeroShotImageClassification:()=>ofe});function Lce(a,e){return Object.assign({},...e.map(t=>{if(a[t]!==void 0)return{[t]:a[t]}}))}function Vce(a,e){return a.includes(e)}function Gce(a,e){const t=Array.isArray(e)?e:[e],r=Object.keys(a).filter(n=>!Vce(t,n));return Lce(a,r)}function vy(a){return/^http(s?):/.test(a)||a.startsWith("/")}var Wc=new Map,kce=10*60*1e3,Hce=1e3,e9="https://huggingface.co";async function t9(a,e,t){if(vy(a))return null;const r=`${a}:${e}`;let n=Wc.get(r);if(n&&n.date<new Date(Date.now()-kce)&&(Wc.delete(r),n=void 0),n===void 0){const i=await((t==null?void 0:t.fetch)??fetch)(`${e9}/api/models/${a}?expand[]=pipeline_tag`,{headers:e?{Authorization:`Bearer ${e}`}:{}}).then(o=>o.json()).then(o=>o.pipeline_tag).catch(()=>null);if(!i)return null;n={task:i,date:new Date},Wc.set(r,{task:i,date:new Date}),Wc.size>Hce&&Wc.delete(Wc.keys().next().value)}return n.task}var y4="https://api-inference.huggingface.co",ry=null;async function r9(a,e){const{accessToken:t,endpointUrl:r,...n}=a;let{model:i}=a;const{forceTask:o,includeCredentials:s,taskHint:u,wait_for_model:l,use_cache:c,dont_load_model:f,chatCompletion:p}=e??{},h={};if(t&&(h.Authorization=`Bearer ${t}`),!i&&!ry&&u){const b=await fetch(`${e9}/api/tasks`);b.ok&&(ry=await b.json())}if(!i&&ry&&u){const b=ry[u];b&&(i=b.models[0].id)}if(!i)throw new Error("No model provided, and no default model found for this task");const y="data"in a&&!!a.data;y||(h["Content-Type"]="application/json"),l&&(h["X-Wait-For-Model"]="true"),c===!1&&(h["X-Use-Cache"]="false"),f&&(h["X-Load-Model"]="0");let d=(()=>{if(r&&vy(i))throw new TypeError("Both model and endpointUrl cannot be URLs");return vy(i)?(console.warn("Using a model URL is deprecated, please use the `endpointUrl` parameter instead"),i):r||(o?`${y4}/pipeline/${o}/${i}`:`${y4}/models/${i}`)})();p&&!d.endsWith("/chat/completions")&&(d+="/v1/chat/completions");let _;typeof s=="string"?_=s:s===!0&&(_="include");const m={headers:h,method:"POST",body:y?a.data:JSON.stringify({...n.model&&vy(n.model)?Gce(n,"model"):n}),..._&&{credentials:_},signal:e==null?void 0:e.signal};return{url:d,info:m}}async function Ye(a,e){var i,o;const{url:t,info:r}=await r9(a,e),n=await((e==null?void 0:e.fetch)??fetch)(t,r);if((e==null?void 0:e.retry_on_error)!==!1&&n.status===503&&!(e!=null&&e.wait_for_model))return Ye(a,{...e,wait_for_model:!0});if(!n.ok){if((i=n.headers.get("Content-Type"))!=null&&i.startsWith("application/json")){const s=await n.json();if([400,422,404,500].includes(n.status)&&(e!=null&&e.chatCompletion))throw new Error(`Server ${a.model} does not seem to support chat completion. Error: ${s.error}`);if(s.error)throw new Error(JSON.stringify(s.error))}throw new Error("An error occurred while fetching the blob")}return(o=n.headers.get("Content-Type"))!=null&&o.startsWith("application/json")?await n.json():await n.blob()}function Wce(a){let e,t,r,n=!1;return function(o){e===void 0?(e=o,t=0,r=-1):e=Jce(e,o);const s=e.length;let u=0;for(;t<s;){n&&(e[t]===10&&(u=++t),n=!1);let l=-1;for(;t<s&&l===-1;++t)switch(e[t]){case 58:r===-1&&(r=t-u);break;case 13:n=!0;case 10:l=t;break}if(l===-1)break;a(e.subarray(u,l),r),u=t,r=-1}u===s?e=void 0:u!==0&&(e=e.subarray(u),t-=u)}}function Kce(a,e,t){let r=b4();const n=new TextDecoder;return function(o,s){if(o.length===0)t==null||t(r),r=b4();else if(s>0){const u=n.decode(o.subarray(0,s)),l=s+(o[s+1]===32?2:1),c=n.decode(o.subarray(l));switch(u){case"data":r.data=r.data?r.data+`
`+c:c;break;case"event":r.event=c;break;case"id":a(r.id=c);break;case"retry":const f=parseInt(c,10);isNaN(f)||e(r.retry=f);break}}}}function Jce(a,e){const t=new Uint8Array(a.length+e.length);return t.set(a),t.set(e,a.length),t}function b4(){return{data:"",event:"",id:"",retry:void 0}}async function*Qb(a,e){var l,c;const{url:t,info:r}=await r9({...a,stream:!0},e),n=await((e==null?void 0:e.fetch)??fetch)(t,r);if((e==null?void 0:e.retry_on_error)!==!1&&n.status===503&&!(e!=null&&e.wait_for_model))return yield*Qb(a,{...e,wait_for_model:!0});if(!n.ok){if((l=n.headers.get("Content-Type"))!=null&&l.startsWith("application/json")){const f=await n.json();if([400,422,404,500].includes(n.status)&&(e!=null&&e.chatCompletion))throw new Error(`Server ${a.model} does not seem to support chat completion. Error: ${f.error}`);if(f.error)throw new Error(f.error)}throw new Error(`Server response contains error: ${n.status}`)}if(!((c=n.headers.get("content-type"))!=null&&c.startsWith("text/event-stream")))throw new Error("Server does not support event stream content type, it returned "+n.headers.get("content-type"));if(!n.body)return;const i=n.body.getReader();let o=[];const u=Wce(Kce(()=>{},()=>{},f=>{o.push(f)}));try{for(;;){const{done:f,value:p}=await i.read();if(f)return;u(p);for(const h of o)if(h.data.length>0){if(h.data==="[DONE]")return;const y=JSON.parse(h.data);if(typeof y=="object"&&y!==null&&"error"in y)throw new Error(y.error);yield y}o=[]}}finally{i.releaseLock()}}var nt=class extends TypeError{constructor(a){super(`Invalid inference output: ${a}. Use the 'request' method with the same parameters to do a custom call with no type checking.`),this.name="InferenceOutputError"}};async function Xce(a,e){const t=await Ye(a,{...e,taskHint:"audio-classification"});if(!(Array.isArray(t)&&t.every(n=>typeof n.label=="string"&&typeof n.score=="number")))throw new nt("Expected Array<{label: string, score: number}>");return t}async function Zce(a,e){const t=await Ye(a,{...e,taskHint:"automatic-speech-recognition"});if(!(typeof(t==null?void 0:t.text)=="string"))throw new nt("Expected {text: string}");return t}async function Qce(a,e){const t=await Ye(a,{...e,taskHint:"text-to-speech"});if(!(t&&t instanceof Blob))throw new nt("Expected Blob");return t}async function Yce(a,e){const t=await Ye(a,{...e,taskHint:"audio-to-audio"});if(!(Array.isArray(t)&&t.every(n=>typeof n.label=="string"&&typeof n.blob=="string"&&typeof n["content-type"]=="string")))throw new nt("Expected Array<{label: string, blob: string, content-type: string}>");return t}async function efe(a,e){const t=await Ye(a,{...e,taskHint:"image-classification"});if(!(Array.isArray(t)&&t.every(n=>typeof n.label=="string"&&typeof n.score=="number")))throw new nt("Expected Array<{label: string, score: number}>");return t}async function tfe(a,e){const t=await Ye(a,{...e,taskHint:"image-segmentation"});if(!(Array.isArray(t)&&t.every(n=>typeof n.label=="string"&&typeof n.mask=="string"&&typeof n.score=="number")))throw new nt("Expected Array<{label: string, mask: string, score: number}>");return t}async function rfe(a,e){var r;const t=(r=await Ye(a,{...e,taskHint:"image-to-text"}))==null?void 0:r[0];if(typeof(t==null?void 0:t.generated_text)!="string")throw new nt("Expected {generated_text: string}");return t}async function nfe(a,e){const t=await Ye(a,{...e,taskHint:"object-detection"});if(!(Array.isArray(t)&&t.every(n=>typeof n.label=="string"&&typeof n.score=="number"&&typeof n.box.xmin=="number"&&typeof n.box.ymin=="number"&&typeof n.box.xmax=="number"&&typeof n.box.ymax=="number")))throw new nt("Expected Array<{label:string; score:number; box:{xmin:number; ymin:number; xmax:number; ymax:number}}>");return t}async function ife(a,e){const t=await Ye(a,{...e,taskHint:"text-to-image"});if(!(t&&t instanceof Blob))throw new nt("Expected Blob");return t}function Yb(a){if(globalThis.Buffer)return globalThis.Buffer.from(a).toString("base64");{const e=[];return a.forEach(t=>{e.push(String.fromCharCode(t))}),globalThis.btoa(e.join(""))}}async function afe(a,e){let t;a.parameters?t={...a,inputs:Yb(new Uint8Array(a.inputs instanceof ArrayBuffer?a.inputs:await a.inputs.arrayBuffer()))}:t={accessToken:a.accessToken,model:a.model,data:a.inputs};const r=await Ye(t,{...e,taskHint:"image-to-image"});if(!(r&&r instanceof Blob))throw new nt("Expected Blob");return r}async function ofe(a,e){const t={...a,inputs:{image:Yb(new Uint8Array(a.inputs.image instanceof ArrayBuffer?a.inputs.image:await a.inputs.image.arrayBuffer()))}},r=await Ye(t,{...e,taskHint:"zero-shot-image-classification"});if(!(Array.isArray(r)&&r.every(i=>typeof i.label=="string"&&typeof i.score=="number")))throw new nt("Expected Array<{label: string, score: number}>");return r}async function sfe(a,e){const t=a.model?await t9(a.model,a.accessToken,e):void 0,r=await Ye(a,{...e,taskHint:"feature-extraction",...t==="sentence-similarity"&&{forceTask:"feature-extraction"}});let n=!0;const i=(o,s,u=0)=>u>s?!1:o.every(l=>Array.isArray(l))?o.every(l=>i(l,s,u+1)):o.every(l=>typeof l=="number");if(n=Array.isArray(r)&&i(r,3,0),!n)throw new nt("Expected Array<number[][][] | number[][] | number[] | number>");return r}async function ufe(a,e){const t=await Ye(a,{...e,taskHint:"fill-mask"});if(!(Array.isArray(t)&&t.every(n=>typeof n.score=="number"&&typeof n.sequence=="string"&&typeof n.token=="number"&&typeof n.token_str=="string")))throw new nt("Expected Array<{score: number, sequence: string, token: number, token_str: string}>");return t}async function lfe(a,e){const t=await Ye(a,{...e,taskHint:"question-answering"});if(!(typeof t=="object"&&!!t&&typeof t.answer=="string"&&typeof t.end=="number"&&typeof t.score=="number"&&typeof t.start=="number"))throw new nt("Expected {answer: string, end: number, score: number, start: number}");return t}async function cfe(a,e){const t=a.model?await t9(a.model,a.accessToken,e):void 0,r=await Ye(a,{...e,taskHint:"sentence-similarity",...t==="feature-extraction"&&{forceTask:"sentence-similarity"}});if(!(Array.isArray(r)&&r.every(i=>typeof i=="number")))throw new nt("Expected number[]");return r}async function ffe(a,e){const t=await Ye(a,{...e,taskHint:"summarization"});if(!(Array.isArray(t)&&t.every(n=>typeof(n==null?void 0:n.summary_text)=="string")))throw new nt("Expected Array<{summary_text: string}>");return t==null?void 0:t[0]}async function dfe(a,e){const t=await Ye(a,{...e,taskHint:"table-question-answering"});if(!(typeof(t==null?void 0:t.aggregator)=="string"&&typeof t.answer=="string"&&Array.isArray(t.cells)&&t.cells.every(n=>typeof n=="string")&&Array.isArray(t.coordinates)&&t.coordinates.every(n=>Array.isArray(n)&&n.every(i=>typeof i=="number"))))throw new nt("Expected {aggregator: string, answer: string, cells: string[], coordinates: number[][]}");return t}async function hfe(a,e){var n;const t=(n=await Ye(a,{...e,taskHint:"text-classification"}))==null?void 0:n[0];if(!(Array.isArray(t)&&t.every(i=>typeof(i==null?void 0:i.label)=="string"&&typeof i.score=="number")))throw new nt("Expected Array<{label: string, score: number}>");return t}function em(a){return Array.isArray(a)?a:[a]}async function n9(a,e){const t=em(await Ye(a,{...e,taskHint:"text-generation"}));if(!(Array.isArray(t)&&t.every(n=>typeof(n==null?void 0:n.generated_text)=="string")))throw new nt("Expected Array<{generated_text: string}>");return t==null?void 0:t[0]}async function*pfe(a,e){yield*Qb(a,{...e,taskHint:"text-generation"})}async function _fe(a,e){const t=em(await Ye(a,{...e,taskHint:"token-classification"}));if(!(Array.isArray(t)&&t.every(n=>typeof n.end=="number"&&typeof n.entity_group=="string"&&typeof n.score=="number"&&typeof n.start=="number"&&typeof n.word=="string")))throw new nt("Expected Array<{end: number, entity_group: string, score: number, start: number, word: string}>");return t}async function yfe(a,e){const t=await Ye(a,{...e,taskHint:"translation"});if(!(Array.isArray(t)&&t.every(n=>typeof(n==null?void 0:n.translation_text)=="string")))throw new nt("Expected type Array<{translation_text: string}>");return(t==null?void 0:t.length)===1?t==null?void 0:t[0]:t}async function bfe(a,e){const t=em(await Ye(a,{...e,taskHint:"zero-shot-classification"}));if(!(Array.isArray(t)&&t.every(n=>Array.isArray(n.labels)&&n.labels.every(i=>typeof i=="string")&&Array.isArray(n.scores)&&n.scores.every(i=>typeof i=="number")&&typeof n.sequence=="string")))throw new nt("Expected Array<{labels: string[], scores: number[], sequence: string}>");return t}async function mfe(a,e){const t=await Ye(a,{...e,taskHint:"text-generation",chatCompletion:!0});if(!(typeof t=="object"&&Array.isArray(t==null?void 0:t.choices)&&typeof(t==null?void 0:t.created)=="number"&&typeof(t==null?void 0:t.id)=="string"&&typeof(t==null?void 0:t.model)=="string"&&typeof(t==null?void 0:t.system_fingerprint)=="string"&&typeof(t==null?void 0:t.usage)=="object"))throw new nt("Expected ChatCompletionOutput");return t}async function*gfe(a,e){yield*Qb(a,{...e,taskHint:"text-generation",chatCompletion:!0})}async function vfe(a,e){var i;const t={...a,inputs:{question:a.inputs.question,image:Yb(new Uint8Array(a.inputs.image instanceof ArrayBuffer?a.inputs.image:await a.inputs.image.arrayBuffer()))}},r=(i=em(await Ye(t,{...e,taskHint:"document-question-answering"})))==null?void 0:i[0];if(!(typeof(r==null?void 0:r.answer)=="string"&&(typeof r.end=="number"||typeof r.end>"u")&&(typeof r.score=="number"||typeof r.score>"u")&&(typeof r.start=="number"||typeof r.start>"u")))throw new nt("Expected Array<{answer: string, end?: number, score?: number, start?: number}>");return r}async function wfe(a,e){var i;const t={...a,inputs:{question:a.inputs.question,image:Yb(new Uint8Array(a.inputs.image instanceof ArrayBuffer?a.inputs.image:await a.inputs.image.arrayBuffer()))}},r=(i=await Ye(t,{...e,taskHint:"visual-question-answering"}))==null?void 0:i[0];if(!(typeof(r==null?void 0:r.answer)=="string"&&typeof r.score=="number"))throw new nt("Expected Array<{answer: string, score: number}>");return r}async function Ofe(a,e){const t=await Ye(a,{...e,taskHint:"tabular-regression"});if(!(Array.isArray(t)&&t.every(n=>typeof n=="number")))throw new nt("Expected number[]");return t}async function Sfe(a,e){const t=await Ye(a,{...e,taskHint:"tabular-classification"});if(!(Array.isArray(t)&&t.every(n=>typeof n=="number")))throw new nt("Expected number[]");return t}function Efe(){const a=document.getElementById("apiKey").value,e=document.getElementById("aiModel").value;let t,r,n=!1,i=!1;switch(e){case"OpenAI":t=new pC({model:"gpt-4o-mini",temperature:0,apiKey:a}),r=new JE({model:"text-embedding-3-small",apiKey:a});break;case"Anthropic":t=new iQ({model:"claude-3-5-sonnet-20240620",apiKey:a}),n=!0;break;case"Azure":t=new cZ({model:"gpt-4o",temperature:0,azureOpenAIApiKey:a}),r=new fZ({azureOpenAIApiEmbeddingsDeploymentName:"text-embedding-ada-002"});break;case"Google":t=new eY({model:"gemini-1.5-pro",temperature:0,apiKey:a}),n=!0;break;case"Cohere":t=new ice({model:"command-r-plus",temperature:0,apiKey:a}),r=new ace({model:"embed-english-v3.0"});break;case"FireworksAI":t=new aQ({model:"accounts/fireworks/models/llama-v3p1-70b-instruct",temperature:0,apiKey:a}),n=!0;break;case"Groq":t=new $ce({model:"mixtral-8x7b-32768",temperature:0,apiKey:a}),n=!0;break;case"MistralAI":t=new zce({model:"codestral-latest",temperature:0,apiKey:a}),n=!0;break;case"TogetherAI":t=new hQ({model:"meta-llama/Meta-Llama-3.1-8B-Instruct-Turbo",maxTokens:256,apiKey:a}),n=!0;break;case"HuggingFace":n=!0,i=!0;break;default:console.log("Invalid LLM model selected")}if(n){const o=document.getElementById("otherApiKey").value;r=new JE({model:"text-embedding-3-small",apiKey:o})}return{llm:t,embeddings:r,huggingface:i}}async function Rfe(a,e,t){try{const r=t.replace("{context}",a).replace("{query}",e);return(await n9({accessToken:document.getElementById("apiKey").value,model:document.getElementById("huggingFaceModel").value,inputs:r,parameters:{max_new_tokens:50}})).generated_text}catch(r){return console.error("Error:",r),"Error generating response with HuggingFace"}}let wu=null;async function Cfe(){const{llm:a,embeddings:e,huggingface:t}=Efe(),r=new TR(e),i=await new zy({chunkSize:1e3,chunkOverlap:100}).splitDocuments(wu);console.log("Splitted Documents:",i),await r.addDocuments(i);const o=document.getElementById("userQuery").value,s=await r.similaritySearch(o,3);console.log("Top matches:",s);const u=s.map((c,f)=>`Source ${f+1}: ${c.metadata.source}
${c.pageContent}`).join(`

`);console.log("Context:",u),console.log("Query:",o);let l="";if(t)l=await Rfe(u,o,uP);else{const c=rp.fromTemplate(uP);l=(await mr.from([c,a]).invoke({context:u,query:o})).content}return document.getElementById("response").innerText=l,l}async function Pfe(){const a=document.getElementById("sourceType").value,e=document.getElementById("githubToken").value,t=document.getElementById("sourceUrl").value;if(a==="feedAPI")console.log("Pulling data from API feed..."),wu=await VJ(wu),console.log("Contents:",wu);else try{wu=await FJ(t,a,e),console.log("Contents:",wu)}catch(r){console.log("Error loading documents:",r)}}function nP(a){wu=a}function jfe(){return console.log(wu),wu}function Tfe(a){const r=new DOMParser().parseFromString(a,"text/xml").getElementsByTagName("item"),n=[];for(let i=0;i<r.length;i++){const o=r[i],s=o.querySelector("link")?o.querySelector("link").textContent:"No link",u=o.querySelector("description")?o.querySelector("description").textContent:"No description",l=o.querySelector("pubDate")?o.querySelector("pubDate").textContent:"No date",c=o.querySelector("guid")?o.querySelector("guid").textContent:"No GUID";n.push({link:s,description:u,pubDate:l,guid:c})}console.log("Parsed RSS Items:",n),nP(n)}function Mfe(a){console.log("Making CORS request to:",a),fetch("https://cors-anywhere.herokuapp.com/"+a).then(t=>(console.log("CORS Response Status:",t.status),t.text())).then(t=>{if(console.log("CORS Response Data:",t),t.startsWith("<?xml"))console.log("Received XML data, parsing..."),Tfe(t);else try{const r=JSON.parse(t);nP(r)}catch(r){console.error("Error parsing JSON:",r)}}).catch(t=>{console.error("CORS request failed:",t)})}function Afe(a){console.log("CORS not needed URL:",a),fetch(a).then(e=>e.json()).then(e=>{console.log("Fetched data:",e),nP(e)}).catch(e=>{console.error("Data fetch failed:",e)})}function Ife(){document.getElementById("corsLink").style.display="block"}function Dfe(){document.getElementById("corsLink").style.display="none"}function m4(){const a=document.getElementById("aiModel").value,e=document.getElementById("otherApiKeyContainer"),t=["Anthropic","Google","FireworksAI","Groq","MistralAI","TogetherAI","HuggingFace"].includes(a);e.style.display=t?"block":"none"}function xfe(){const a=`https://sheets.googleapis.com/v4/spreadsheets/${g4}/values/${v4}?key=${w4}`;fetch(a).then(e=>e.json()).then(e=>{console.log("Success:",e),$fe(e.values)}).catch(e=>{console.error("Error:",e)})}function $fe(a){const e=document.getElementById("apiFeeds");e.innerHTML="";const t=document.createElement("option");t.value="none",t.textContent="Select a feed.......",e.appendChild(t),a.forEach(n=>{const i=document.createElement("option");i.value=n[0],i.textContent=n[1],e.appendChild(i)});const r=localStorage.getItem("selectedFeed");r&&(e.value=r,iP(r))}function Nfe(a){return new Promise((e,t)=>{const r=`https://sheets.googleapis.com/v4/spreadsheets/${g4}/values/${v4}?key=${w4}`;fetch(r).then(n=>n.json()).then(n=>{const i=n.values.find(o=>o[0]===a);i?e({url:i[9],cors:i[8]}):t("Feed not found")}).catch(n=>t(n))})}function iP(a){console.log(`Selected feed: ${a}`),document.getElementById("resultJson").innerHTML="",document.getElementById("resultFull").innerHTML="",localStorage.setItem("selectedFeed",a),Nfe(a).then(e=>{if(e){const{url:t,cors:r}=e;console.log(`Feed URL: ${t}, CORS Needed: ${r}`),r==="TRUE"?(console.log("CORS Needed"),Ife(),Mfe(t)):(console.log("No CORS Needed"),Dfe(),Afe(t))}}).catch(e=>{console.error("Error fetching feed details:",e)})}document.addEventListener("DOMContentLoaded",()=>{const a=document.getElementById("submitButton"),e=document.getElementById("aiModel"),t=document.getElementById("contextBtn"),r=document.getElementById("apiFeeds");t.addEventListener("click",jfe),e.addEventListener("change",m4),r.addEventListener("change",n=>iP(n.target.value)),m4(),a.addEventListener("click",async()=>{await Cfe()}),xfe()});document.addEventListener("click",function(a){a.target.id==="corsLink"&&a.target.tagName==="A"&&alert("CORS passthrough enabled. Please refresh the page.")});const aP=document.getElementById("sourceUrl");function oP(a){try{const e=new URL(a);return e.hostname==="github.com"||e.hostname.endsWith(".github.com")}catch{return!1}}function i9(a){console.log(`Processing GitHub URL: ${a}`),Pfe()}aP.addEventListener("input",function(){const a=this.value.trim();if(a===""){this.classList.remove("border-red-500","border-green-500");return}oP(a)?(this.classList.remove("border-red-500"),this.classList.add("border-green-500")):(this.classList.remove("border-green-500"),this.classList.add("border-red-500"))});aP.addEventListener("blur",function(){const a=this.value.trim();oP(a)&&i9(a)});aP.addEventListener("keydown",function(a){if(a.key==="Enter"){const e=this.value.trim();oP(e)&&i9(e)}});console.log("Application initialized");window.updateFeed=iP;export{_x as A,PE as B,px as E,PC as F,Bs as P,Zne as S,she as a,rR as b,uV as c,Tie as d,uhe as e,yie as f,dhe as g,Mie as h,yO as i,ohe as j,L8 as k,Xne as l,x8 as m,tae as n,Nce as o,fhe as p,lhe as q,nf as r,gie as s,mie as t,che as u};
